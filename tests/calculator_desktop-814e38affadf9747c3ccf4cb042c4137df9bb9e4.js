var requirejs, require, define; !function (e) { var n, r, i, t, o = {}, u = {}, f = {}, c = {}, l = Object.prototype.hasOwnProperty, s = [].slice; function p(e, n) { return l.call(e, n) } function a(e, n) { var r, i, t, o, u, c, l, s, p, a, d = n && n.split("/"), g = f.map, q = g && g["*"] || {}; if (e && "." === e.charAt(0)) if (n) { for (e = (d = d.slice(0, d.length - 1)).concat(e.split("/")), s = 0; s < e.length; s += 1)if ("." === (a = e[s])) e.splice(s, 1), s -= 1; else if (".." === a) { if (1 === s && (".." === e[2] || ".." === e[0])) break; s > 0 && (e.splice(s - 1, 2), s -= 2) } e = e.join("/") } else 0 === e.indexOf("./") && (e = e.substring(2)); if ((d || q) && g) { for (s = (r = e.split("/")).length; s > 0; s -= 1) { if (i = r.slice(0, s).join("/"), d) for (p = d.length; p > 0; p -= 1)if ((t = g[d.slice(0, p).join("/")]) && (t = t[i])) { o = t, u = s; break } if (o) break; !c && q && q[i] && (c = q[i], l = s) } !o && c && (o = c, u = l), o && (r.splice(0, u, o), e = r.join("/")) } return e } function d(n, i) { return function () { return r.apply(e, s.call(arguments, 0).concat([n, i])) } } function g(e) { return function (n) { o[e] = n } } function q(r) { if (p(u, r)) { var i = u[r]; delete u[r], c[r] = !0, n.apply(e, i) } if (!p(o, r) && !p(c, r)) throw new Error("No " + r); return o[r] } function O(e) { var n, r = e ? e.indexOf("!") : -1; return r > -1 && (n = e.substring(0, r), e = e.substring(r + 1, e.length)), [n, e] } function h(e) { return function () { return f && f.config && f.config[e] || {} } } i = function (e, n) { var r, i = O(e), t = i[0]; return e = i[1], t && (r = q(t = a(t, n))), t ? e = r && r.normalize ? r.normalize(e, function (e) { return function (n) { return a(n, e) } }(n)) : a(e, n) : (t = (i = O(e = a(e, n)))[0], e = i[1], t && (r = q(t))), { f: t ? t + "!" + e : e, n: e, pr: t, p: r } }, t = { require: function (e) { return d(e) }, exports: function (e) { var n = o[e]; return void 0 !== n ? n : o[e] = {} }, module: function (e) { return { id: e, uri: "", exports: o[e], config: h(e) } } }, n = function (n, r, f, l) { var s, a, O, h, E, j, m = []; if (l = l || n, "function" == typeof f) { for (r = !r.length && f.length ? ["require", "exports", "module"] : r, E = 0; E < r.length; E += 1)if ("require" === (a = (h = i(r[E], l)).f)) m[E] = t.require(n); else if ("exports" === a) m[E] = t.exports(n), j = !0; else if ("module" === a) s = m[E] = t.module(n); else if (p(o, a) || p(u, a) || p(c, a)) m[E] = q(a); else { if (!h.p) throw new Error(n + " missing " + a); h.p.load(h.n, d(l, !0), g(a), {}), m[E] = o[a] } O = f.apply(o[n], m), n && (s && s.exports !== e && s.exports !== o[n] ? o[n] = s.exports : O === e && j || (o[n] = O)) } else n && (o[n] = f) }, requirejs = require = r = function (o, u, c, l, s) { return "string" == typeof o ? t[o] ? t[o](u) : q(i(o, u).f) : (o.splice || (f = o, u.splice ? (o = u, u = c, c = null) : o = e), u = u || function () { }, "function" == typeof c && (c = l, l = s), l ? n(e, o, u, c) : setTimeout(function () { n(e, o, u, c) }, 4), r) }, r.config = function (e) { return (f = e).deps && r(f.deps, f.callback), r }, (define = function (e, n, r) { n.splice || (r = n, n = []), p(o, e) || p(u, e) || (u[e] = [e, n, r]) }).amd = { jQuery: !0 } }(), "undefined" != typeof ALMOND_OVERRIDES && ALMOND_OVERRIDES && (define = ALMOND_OVERRIDES.define || define, require = ALMOND_OVERRIDES.require || require, requirejs = ALMOND_OVERRIDES.requirejs || requirejs);
define("core/vendor/almond", function () { });

define('testbridge', ['require'], function (require) { var n = { ready: function () { try { window.TestBridge = n, parent.USING_SELENIUM && function () { window.consoleOverride = !0; var n = window.console.log; window.console.log = function () { for (var o = [], e = 0; e < arguments.length; e++)o.push(arguments[e]); n.apply(window.console, [].concat([o.join(" ")], o)) } }() } catch (n) { } } }; return n });
define('ipad.ghostevents', ['require'], function (require) { var e = !1, t = null; function n(t) { e && c.evtInScope(t) && (t.stopPropagation(), t.stopImmediatePropagation()) } function o(t) { e && c.evtInScope(t) && (t.preventDefault(), t.stopPropagation(), t.stopImmediatePropagation()) } var c = { isGhostEvent: function (e) { return !1 }, evtInScope: function (e) { return !1 } }; return document.addEventListener("mousedown", function (o) { c.evtInScope(o) && (t = document.activeElement, e = c.isGhostEvent(o), n(o)) }, !0), document.addEventListener("mouseup", n, !0), document.addEventListener("click", function (n) { o(n), e && document.activeElement !== t && (document.activeElement && document.activeElement.blur(), t && t.focus()), e = !1 }, !0), document.addEventListener("focus", o, !0), document.addEventListener("blur", o, !0), c });
!function (e, t) { "use strict"; "object" == typeof module && "object" == typeof module.exports ? module.exports = e.document ? t(e, !0) : function (e) { if (!e.document) throw new Error("jQuery requires a window with a document"); return t(e) } : t(e) }("undefined" != typeof window ? window : this, function (e, t) { "use strict"; var n = [], r = Object.getPrototypeOf, i = n.slice, o = n.flat ? function (e) { return n.flat.call(e) } : function (e) { return n.concat.apply([], e) }, a = n.push, s = n.indexOf, u = {}, l = u.toString, c = u.hasOwnProperty, f = c.toString, p = f.call(Object), d = {}, h = function (e) { return "function" == typeof e && "number" != typeof e.nodeType && "function" != typeof e.item }, g = function (e) { return null != e && e === e.window }, v = e.document, y = { type: !0, src: !0, nonce: !0, noModule: !0 }; function m(e, t, n) { var r, i, o = (n = n || v).createElement("script"); if (o.text = e, t) for (r in y) (i = t[r] || t.getAttribute && t.getAttribute(r)) && o.setAttribute(r, i); n.head.appendChild(o).parentNode.removeChild(o) } function x(e) { return null == e ? e + "" : "object" == typeof e || "function" == typeof e ? u[l.call(e)] || "object" : typeof e } var b = "3.6.0", w = function (e, t) { return new w.fn.init(e, t) }; function T(e) { var t = !!e && "length" in e && e.length, n = x(e); return !h(e) && !g(e) && ("array" === n || 0 === t || "number" == typeof t && t > 0 && t - 1 in e) } w.fn = w.prototype = { jquery: b, constructor: w, length: 0, toArray: function () { return i.call(this) }, get: function (e) { return null == e ? i.call(this) : e < 0 ? this[e + this.length] : this[e] }, pushStack: function (e) { var t = w.merge(this.constructor(), e); return t.prevObject = this, t }, each: function (e) { return w.each(this, e) }, map: function (e) { return this.pushStack(w.map(this, function (t, n) { return e.call(t, n, t) })) }, slice: function () { return this.pushStack(i.apply(this, arguments)) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, even: function () { return this.pushStack(w.grep(this, function (e, t) { return (t + 1) % 2 })) }, odd: function () { return this.pushStack(w.grep(this, function (e, t) { return t % 2 })) }, eq: function (e) { var t = this.length, n = +e + (e < 0 ? t : 0); return this.pushStack(n >= 0 && n < t ? [this[n]] : []) }, end: function () { return this.prevObject || this.constructor() }, push: a, sort: n.sort, splice: n.splice }, w.extend = w.fn.extend = function () { var e, t, n, r, i, o, a = arguments[0] || {}, s = 1, u = arguments.length, l = !1; for ("boolean" == typeof a && (l = a, a = arguments[s] || {}, s++), "object" == typeof a || h(a) || (a = {}), s === u && (a = this, s--); s < u; s++)if (null != (e = arguments[s])) for (t in e) r = e[t], "__proto__" !== t && a !== r && (l && r && (w.isPlainObject(r) || (i = Array.isArray(r))) ? (n = a[t], o = i && !Array.isArray(n) ? [] : i || w.isPlainObject(n) ? n : {}, i = !1, a[t] = w.extend(l, o, r)) : void 0 !== r && (a[t] = r)); return a }, w.extend({ expando: "jQuery" + (b + Math.random()).replace(/\D/g, ""), isReady: !0, error: function (e) { throw new Error(e) }, noop: function () { }, isPlainObject: function (e) { var t, n; return !(!e || "[object Object]" !== l.call(e)) && (!(t = r(e)) || "function" == typeof (n = c.call(t, "constructor") && t.constructor) && f.call(n) === p) }, isEmptyObject: function (e) { var t; for (t in e) return !1; return !0 }, globalEval: function (e, t, n) { m(e, { nonce: t && t.nonce }, n) }, each: function (e, t) { var n, r = 0; if (T(e)) for (n = e.length; r < n && !1 !== t.call(e[r], r, e[r]); r++); else for (r in e) if (!1 === t.call(e[r], r, e[r])) break; return e }, makeArray: function (e, t) { var n = t || []; return null != e && (T(Object(e)) ? w.merge(n, "string" == typeof e ? [e] : e) : a.call(n, e)), n }, inArray: function (e, t, n) { return null == t ? -1 : s.call(t, e, n) }, merge: function (e, t) { for (var n = +t.length, r = 0, i = e.length; r < n; r++)e[i++] = t[r]; return e.length = i, e }, grep: function (e, t, n) { for (var r = [], i = 0, o = e.length, a = !n; i < o; i++)!t(e[i], i) !== a && r.push(e[i]); return r }, map: function (e, t, n) { var r, i, a = 0, s = []; if (T(e)) for (r = e.length; a < r; a++)null != (i = t(e[a], a, n)) && s.push(i); else for (a in e) null != (i = t(e[a], a, n)) && s.push(i); return o(s) }, guid: 1, support: d }), "function" == typeof Symbol && (w.fn[Symbol.iterator] = n[Symbol.iterator]), w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (e, t) { u["[object " + t + "]"] = t.toLowerCase() }); var C = function (e) { var t, n, r, i, o, a, s, u, l, c, f, p, d, h, g, v, y, m, x, b = "sizzle" + 1 * new Date, w = e.document, T = 0, C = 0, E = ue(), S = ue(), k = ue(), A = ue(), N = function (e, t) { return e === t && (f = !0), 0 }, j = {}.hasOwnProperty, D = [], q = D.pop, L = D.push, H = D.push, O = D.slice, P = function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (e[n] === t) return n; return -1 }, R = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", M = "[\\x20\\t\\r\\n\\f]", I = "(?:\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+", W = "\\[[\\x20\\t\\r\\n\\f]*(" + I + ")(?:" + M + "*([*^$|!~]?=)" + M + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + I + "))|)" + M + "*\\]", F = ":(" + I + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + W + ")*)|.*)\\)|)", B = new RegExp(M + "+", "g"), $ = new RegExp("^[\\x20\\t\\r\\n\\f]+|((?:^|[^\\\\])(?:\\\\.)*)[\\x20\\t\\r\\n\\f]+$", "g"), _ = new RegExp("^[\\x20\\t\\r\\n\\f]*,[\\x20\\t\\r\\n\\f]*"), z = new RegExp("^[\\x20\\t\\r\\n\\f]*([>+~]|[\\x20\\t\\r\\n\\f])[\\x20\\t\\r\\n\\f]*"), U = new RegExp(M + "|>"), X = new RegExp(F), V = new RegExp("^" + I + "$"), G = { ID: new RegExp("^#(" + I + ")"), CLASS: new RegExp("^\\.(" + I + ")"), TAG: new RegExp("^(" + I + "|[*])"), ATTR: new RegExp("^" + W), PSEUDO: new RegExp("^" + F), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\([\\x20\\t\\r\\n\\f]*(even|odd|(([+-]|)(\\d*)n|)[\\x20\\t\\r\\n\\f]*(?:([+-]|)[\\x20\\t\\r\\n\\f]*(\\d+)|))[\\x20\\t\\r\\n\\f]*\\)|)", "i"), bool: new RegExp("^(?:" + R + ")$", "i"), needsContext: new RegExp("^[\\x20\\t\\r\\n\\f]*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\([\\x20\\t\\r\\n\\f]*((?:-\\d)?\\d*)[\\x20\\t\\r\\n\\f]*\\)|)(?=[^-]|$)", "i") }, Y = /HTML$/i, Q = /^(?:input|select|textarea|button)$/i, J = /^h\d$/i, K = /^[^{]+\{\s*\[native \w/, Z = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, ee = /[+~]/, te = new RegExp("\\\\[\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|\\\\([^\\r\\n\\f])", "g"), ne = function (e, t) { var n = "0x" + e.slice(1) - 65536; return t || (n < 0 ? String.fromCharCode(n + 65536) : String.fromCharCode(n >> 10 | 55296, 1023 & n | 56320)) }, re = /([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g, ie = function (e, t) { return t ? "\0" === e ? "ï¿½" : e.slice(0, -1) + "\\" + e.charCodeAt(e.length - 1).toString(16) + " " : "\\" + e }, oe = function () { p() }, ae = be(function (e) { return !0 === e.disabled && "fieldset" === e.nodeName.toLowerCase() }, { dir: "parentNode", next: "legend" }); try { H.apply(D = O.call(w.childNodes), w.childNodes), D[w.childNodes.length].nodeType } catch (e) { H = { apply: D.length ? function (e, t) { L.apply(e, O.call(t)) } : function (e, t) { for (var n = e.length, r = 0; e[n++] = t[r++];); e.length = n - 1 } } } function se(e, t, r, i) { var o, s, l, c, f, h, y, m = t && t.ownerDocument, w = t ? t.nodeType : 9; if (r = r || [], "string" != typeof e || !e || 1 !== w && 9 !== w && 11 !== w) return r; if (!i && (p(t), t = t || d, g)) { if (11 !== w && (f = Z.exec(e))) if (o = f[1]) { if (9 === w) { if (!(l = t.getElementById(o))) return r; if (l.id === o) return r.push(l), r } else if (m && (l = m.getElementById(o)) && x(t, l) && l.id === o) return r.push(l), r } else { if (f[2]) return H.apply(r, t.getElementsByTagName(e)), r; if ((o = f[3]) && n.getElementsByClassName && t.getElementsByClassName) return H.apply(r, t.getElementsByClassName(o)), r } if (n.qsa && !A[e + " "] && (!v || !v.test(e)) && (1 !== w || "object" !== t.nodeName.toLowerCase())) { if (y = e, m = t, 1 === w && (U.test(e) || z.test(e))) { for ((m = ee.test(e) && ye(t.parentNode) || t) === t && n.scope || ((c = t.getAttribute("id")) ? c = c.replace(re, ie) : t.setAttribute("id", c = b)), s = (h = a(e)).length; s--;)h[s] = (c ? "#" + c : ":scope") + " " + xe(h[s]); y = h.join(",") } try { return H.apply(r, m.querySelectorAll(y)), r } catch (t) { A(e, !0) } finally { c === b && t.removeAttribute("id") } } } return u(e.replace($, "$1"), t, r, i) } function ue() { var e = []; return function t(n, i) { return e.push(n + " ") > r.cacheLength && delete t[e.shift()], t[n + " "] = i } } function le(e) { return e[b] = !0, e } function ce(e) { var t = d.createElement("fieldset"); try { return !!e(t) } catch (e) { return !1 } finally { t.parentNode && t.parentNode.removeChild(t), t = null } } function fe(e, t) { for (var n = e.split("|"), i = n.length; i--;)r.attrHandle[n[i]] = t } function pe(e, t) { var n = t && e, r = n && 1 === e.nodeType && 1 === t.nodeType && e.sourceIndex - t.sourceIndex; if (r) return r; if (n) for (; n = n.nextSibling;)if (n === t) return -1; return e ? 1 : -1 } function de(e) { return function (t) { return "input" === t.nodeName.toLowerCase() && t.type === e } } function he(e) { return function (t) { var n = t.nodeName.toLowerCase(); return ("input" === n || "button" === n) && t.type === e } } function ge(e) { return function (t) { return "form" in t ? t.parentNode && !1 === t.disabled ? "label" in t ? "label" in t.parentNode ? t.parentNode.disabled === e : t.disabled === e : t.isDisabled === e || t.isDisabled !== !e && ae(t) === e : t.disabled === e : "label" in t && t.disabled === e } } function ve(e) { return le(function (t) { return t = +t, le(function (n, r) { for (var i, o = e([], n.length, t), a = o.length; a--;)n[i = o[a]] && (n[i] = !(r[i] = n[i])) }) }) } function ye(e) { return e && void 0 !== e.getElementsByTagName && e } for (t in n = se.support = {}, o = se.isXML = function (e) { var t = e && e.namespaceURI, n = e && (e.ownerDocument || e).documentElement; return !Y.test(t || n && n.nodeName || "HTML") }, p = se.setDocument = function (e) { var t, i, a = e ? e.ownerDocument || e : w; return a != d && 9 === a.nodeType && a.documentElement ? (h = (d = a).documentElement, g = !o(d), w != d && (i = d.defaultView) && i.top !== i && (i.addEventListener ? i.addEventListener("unload", oe, !1) : i.attachEvent && i.attachEvent("onunload", oe)), n.scope = ce(function (e) { return h.appendChild(e).appendChild(d.createElement("div")), void 0 !== e.querySelectorAll && !e.querySelectorAll(":scope fieldset div").length }), n.attributes = ce(function (e) { return e.className = "i", !e.getAttribute("className") }), n.getElementsByTagName = ce(function (e) { return e.appendChild(d.createComment("")), !e.getElementsByTagName("*").length }), n.getElementsByClassName = K.test(d.getElementsByClassName), n.getById = ce(function (e) { return h.appendChild(e).id = b, !d.getElementsByName || !d.getElementsByName(b).length }), n.getById ? (r.filter.ID = function (e) { var t = e.replace(te, ne); return function (e) { return e.getAttribute("id") === t } }, r.find.ID = function (e, t) { if (void 0 !== t.getElementById && g) { var n = t.getElementById(e); return n ? [n] : [] } }) : (r.filter.ID = function (e) { var t = e.replace(te, ne); return function (e) { var n = void 0 !== e.getAttributeNode && e.getAttributeNode("id"); return n && n.value === t } }, r.find.ID = function (e, t) { if (void 0 !== t.getElementById && g) { var n, r, i, o = t.getElementById(e); if (o) { if ((n = o.getAttributeNode("id")) && n.value === e) return [o]; for (i = t.getElementsByName(e), r = 0; o = i[r++];)if ((n = o.getAttributeNode("id")) && n.value === e) return [o] } return [] } }), r.find.TAG = n.getElementsByTagName ? function (e, t) { return void 0 !== t.getElementsByTagName ? t.getElementsByTagName(e) : n.qsa ? t.querySelectorAll(e) : void 0 } : function (e, t) { var n, r = [], i = 0, o = t.getElementsByTagName(e); if ("*" === e) { for (; n = o[i++];)1 === n.nodeType && r.push(n); return r } return o }, r.find.CLASS = n.getElementsByClassName && function (e, t) { if (void 0 !== t.getElementsByClassName && g) return t.getElementsByClassName(e) }, y = [], v = [], (n.qsa = K.test(d.querySelectorAll)) && (ce(function (e) { var t; h.appendChild(e).innerHTML = "<a id='" + b + "'></a><select id='" + b + "-\r\\' msallowcapture=''><option selected=''></option></select>", e.querySelectorAll("[msallowcapture^='']").length && v.push("[*^$]=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"), e.querySelectorAll("[selected]").length || v.push("\\[[\\x20\\t\\r\\n\\f]*(?:value|" + R + ")"), e.querySelectorAll("[id~=" + b + "-]").length || v.push("~="), (t = d.createElement("input")).setAttribute("name", ""), e.appendChild(t), e.querySelectorAll("[name='']").length || v.push("\\[[\\x20\\t\\r\\n\\f]*name[\\x20\\t\\r\\n\\f]*=[\\x20\\t\\r\\n\\f]*(?:''|\"\")"), e.querySelectorAll(":checked").length || v.push(":checked"), e.querySelectorAll("a#" + b + "+*").length || v.push(".#.+[+~]"), e.querySelectorAll("\\\f"), v.push("[\\r\\n\\f]") }), ce(function (e) { e.innerHTML = "<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>"; var t = d.createElement("input"); t.setAttribute("type", "hidden"), e.appendChild(t).setAttribute("name", "D"), e.querySelectorAll("[name=d]").length && v.push("name[\\x20\\t\\r\\n\\f]*[*^$|!~]?="), 2 !== e.querySelectorAll(":enabled").length && v.push(":enabled", ":disabled"), h.appendChild(e).disabled = !0, 2 !== e.querySelectorAll(":disabled").length && v.push(":enabled", ":disabled"), e.querySelectorAll("*,:x"), v.push(",.*:") })), (n.matchesSelector = K.test(m = h.matches || h.webkitMatchesSelector || h.mozMatchesSelector || h.oMatchesSelector || h.msMatchesSelector)) && ce(function (e) { n.disconnectedMatch = m.call(e, "*"), m.call(e, "[s!='']:x"), y.push("!=", F) }), v = v.length && new RegExp(v.join("|")), y = y.length && new RegExp(y.join("|")), t = K.test(h.compareDocumentPosition), x = t || K.test(h.contains) ? function (e, t) { var n = 9 === e.nodeType ? e.documentElement : e, r = t && t.parentNode; return e === r || !(!r || 1 !== r.nodeType || !(n.contains ? n.contains(r) : e.compareDocumentPosition && 16 & e.compareDocumentPosition(r))) } : function (e, t) { if (t) for (; t = t.parentNode;)if (t === e) return !0; return !1 }, N = t ? function (e, t) { if (e === t) return f = !0, 0; var r = !e.compareDocumentPosition - !t.compareDocumentPosition; return r || (1 & (r = (e.ownerDocument || e) == (t.ownerDocument || t) ? e.compareDocumentPosition(t) : 1) || !n.sortDetached && t.compareDocumentPosition(e) === r ? e == d || e.ownerDocument == w && x(w, e) ? -1 : t == d || t.ownerDocument == w && x(w, t) ? 1 : c ? P(c, e) - P(c, t) : 0 : 4 & r ? -1 : 1) } : function (e, t) { if (e === t) return f = !0, 0; var n, r = 0, i = e.parentNode, o = t.parentNode, a = [e], s = [t]; if (!i || !o) return e == d ? -1 : t == d ? 1 : i ? -1 : o ? 1 : c ? P(c, e) - P(c, t) : 0; if (i === o) return pe(e, t); for (n = e; n = n.parentNode;)a.unshift(n); for (n = t; n = n.parentNode;)s.unshift(n); for (; a[r] === s[r];)r++; return r ? pe(a[r], s[r]) : a[r] == w ? -1 : s[r] == w ? 1 : 0 }, d) : d }, se.matches = function (e, t) { return se(e, null, null, t) }, se.matchesSelector = function (e, t) { if (p(e), n.matchesSelector && g && !A[t + " "] && (!y || !y.test(t)) && (!v || !v.test(t))) try { var r = m.call(e, t); if (r || n.disconnectedMatch || e.document && 11 !== e.document.nodeType) return r } catch (e) { A(t, !0) } return se(t, d, null, [e]).length > 0 }, se.contains = function (e, t) { return (e.ownerDocument || e) != d && p(e), x(e, t) }, se.attr = function (e, t) { (e.ownerDocument || e) != d && p(e); var i = r.attrHandle[t.toLowerCase()], o = i && j.call(r.attrHandle, t.toLowerCase()) ? i(e, t, !g) : void 0; return void 0 !== o ? o : n.attributes || !g ? e.getAttribute(t) : (o = e.getAttributeNode(t)) && o.specified ? o.value : null }, se.escape = function (e) { return (e + "").replace(re, ie) }, se.error = function (e) { throw new Error("Syntax error, unrecognized expression: " + e) }, se.uniqueSort = function (e) { var t, r = [], i = 0, o = 0; if (f = !n.detectDuplicates, c = !n.sortStable && e.slice(0), e.sort(N), f) { for (; t = e[o++];)t === e[o] && (i = r.push(o)); for (; i--;)e.splice(r[i], 1) } return c = null, e }, i = se.getText = function (e) { var t, n = "", r = 0, o = e.nodeType; if (o) { if (1 === o || 9 === o || 11 === o) { if ("string" == typeof e.textContent) return e.textContent; for (e = e.firstChild; e; e = e.nextSibling)n += i(e) } else if (3 === o || 4 === o) return e.nodeValue } else for (; t = e[r++];)n += i(t); return n }, (r = se.selectors = { cacheLength: 50, createPseudo: le, match: G, attrHandle: {}, find: {}, relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } }, preFilter: { ATTR: function (e) { return e[1] = e[1].replace(te, ne), e[3] = (e[3] || e[4] || e[5] || "").replace(te, ne), "~=" === e[2] && (e[3] = " " + e[3] + " "), e.slice(0, 4) }, CHILD: function (e) { return e[1] = e[1].toLowerCase(), "nth" === e[1].slice(0, 3) ? (e[3] || se.error(e[0]), e[4] = +(e[4] ? e[5] + (e[6] || 1) : 2 * ("even" === e[3] || "odd" === e[3])), e[5] = +(e[7] + e[8] || "odd" === e[3])) : e[3] && se.error(e[0]), e }, PSEUDO: function (e) { var t, n = !e[6] && e[2]; return G.CHILD.test(e[0]) ? null : (e[3] ? e[2] = e[4] || e[5] || "" : n && X.test(n) && (t = a(n, !0)) && (t = n.indexOf(")", n.length - t) - n.length) && (e[0] = e[0].slice(0, t), e[2] = n.slice(0, t)), e.slice(0, 3)) } }, filter: { TAG: function (e) { var t = e.replace(te, ne).toLowerCase(); return "*" === e ? function () { return !0 } : function (e) { return e.nodeName && e.nodeName.toLowerCase() === t } }, CLASS: function (e) { var t = E[e + " "]; return t || (t = new RegExp("(^|[\\x20\\t\\r\\n\\f])" + e + "(" + M + "|$)")) && E(e, function (e) { return t.test("string" == typeof e.className && e.className || void 0 !== e.getAttribute && e.getAttribute("class") || "") }) }, ATTR: function (e, t, n) { return function (r) { var i = se.attr(r, e); return null == i ? "!=" === t : !t || (i += "", "=" === t ? i === n : "!=" === t ? i !== n : "^=" === t ? n && 0 === i.indexOf(n) : "*=" === t ? n && i.indexOf(n) > -1 : "$=" === t ? n && i.slice(-n.length) === n : "~=" === t ? (" " + i.replace(B, " ") + " ").indexOf(n) > -1 : "|=" === t && (i === n || i.slice(0, n.length + 1) === n + "-")) } }, CHILD: function (e, t, n, r, i) { var o = "nth" !== e.slice(0, 3), a = "last" !== e.slice(-4), s = "of-type" === t; return 1 === r && 0 === i ? function (e) { return !!e.parentNode } : function (t, n, u) { var l, c, f, p, d, h, g = o !== a ? "nextSibling" : "previousSibling", v = t.parentNode, y = s && t.nodeName.toLowerCase(), m = !u && !s, x = !1; if (v) { if (o) { for (; g;) { for (p = t; p = p[g];)if (s ? p.nodeName.toLowerCase() === y : 1 === p.nodeType) return !1; h = g = "only" === e && !h && "nextSibling" } return !0 } if (h = [a ? v.firstChild : v.lastChild], a && m) { for (x = (d = (l = (c = (f = (p = v)[b] || (p[b] = {}))[p.uniqueID] || (f[p.uniqueID] = {}))[e] || [])[0] === T && l[1]) && l[2], p = d && v.childNodes[d]; p = ++d && p && p[g] || (x = d = 0) || h.pop();)if (1 === p.nodeType && ++x && p === t) { c[e] = [T, d, x]; break } } else if (m && (x = d = (l = (c = (f = (p = t)[b] || (p[b] = {}))[p.uniqueID] || (f[p.uniqueID] = {}))[e] || [])[0] === T && l[1]), !1 === x) for (; (p = ++d && p && p[g] || (x = d = 0) || h.pop()) && ((s ? p.nodeName.toLowerCase() !== y : 1 !== p.nodeType) || !++x || (m && ((c = (f = p[b] || (p[b] = {}))[p.uniqueID] || (f[p.uniqueID] = {}))[e] = [T, x]), p !== t));); return (x -= i) === r || x % r == 0 && x / r >= 0 } } }, PSEUDO: function (e, t) { var n, i = r.pseudos[e] || r.setFilters[e.toLowerCase()] || se.error("unsupported pseudo: " + e); return i[b] ? i(t) : i.length > 1 ? (n = [e, e, "", t], r.setFilters.hasOwnProperty(e.toLowerCase()) ? le(function (e, n) { for (var r, o = i(e, t), a = o.length; a--;)e[r = P(e, o[a])] = !(n[r] = o[a]) }) : function (e) { return i(e, 0, n) }) : i } }, pseudos: { not: le(function (e) { var t = [], n = [], r = s(e.replace($, "$1")); return r[b] ? le(function (e, t, n, i) { for (var o, a = r(e, null, i, []), s = e.length; s--;)(o = a[s]) && (e[s] = !(t[s] = o)) }) : function (e, i, o) { return t[0] = e, r(t, null, o, n), t[0] = null, !n.pop() } }), has: le(function (e) { return function (t) { return se(e, t).length > 0 } }), contains: le(function (e) { return e = e.replace(te, ne), function (t) { return (t.textContent || i(t)).indexOf(e) > -1 } }), lang: le(function (e) { return V.test(e || "") || se.error("unsupported lang: " + e), e = e.replace(te, ne).toLowerCase(), function (t) { var n; do { if (n = g ? t.lang : t.getAttribute("xml:lang") || t.getAttribute("lang")) return (n = n.toLowerCase()) === e || 0 === n.indexOf(e + "-") } while ((t = t.parentNode) && 1 === t.nodeType); return !1 } }), target: function (t) { var n = e.location && e.location.hash; return n && n.slice(1) === t.id }, root: function (e) { return e === h }, focus: function (e) { return e === d.activeElement && (!d.hasFocus || d.hasFocus()) && !!(e.type || e.href || ~e.tabIndex) }, enabled: ge(!1), disabled: ge(!0), checked: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && !!e.checked || "option" === t && !!e.selected }, selected: function (e) { return e.parentNode && e.parentNode.selectedIndex, !0 === e.selected }, empty: function (e) { for (e = e.firstChild; e; e = e.nextSibling)if (e.nodeType < 6) return !1; return !0 }, parent: function (e) { return !r.pseudos.empty(e) }, header: function (e) { return J.test(e.nodeName) }, input: function (e) { return Q.test(e.nodeName) }, button: function (e) { var t = e.nodeName.toLowerCase(); return "input" === t && "button" === e.type || "button" === t }, text: function (e) { var t; return "input" === e.nodeName.toLowerCase() && "text" === e.type && (null == (t = e.getAttribute("type")) || "text" === t.toLowerCase()) }, first: ve(function () { return [0] }), last: ve(function (e, t) { return [t - 1] }), eq: ve(function (e, t, n) { return [n < 0 ? n + t : n] }), even: ve(function (e, t) { for (var n = 0; n < t; n += 2)e.push(n); return e }), odd: ve(function (e, t) { for (var n = 1; n < t; n += 2)e.push(n); return e }), lt: ve(function (e, t, n) { for (var r = n < 0 ? n + t : n > t ? t : n; --r >= 0;)e.push(r); return e }), gt: ve(function (e, t, n) { for (var r = n < 0 ? n + t : n; ++r < t;)e.push(r); return e }) } }).pseudos.nth = r.pseudos.eq, { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) r.pseudos[t] = de(t); for (t in { submit: !0, reset: !0 }) r.pseudos[t] = he(t); function me() { } function xe(e) { for (var t = 0, n = e.length, r = ""; t < n; t++)r += e[t].value; return r } function be(e, t, n) { var r = t.dir, i = t.next, o = i || r, a = n && "parentNode" === o, s = C++; return t.first ? function (t, n, i) { for (; t = t[r];)if (1 === t.nodeType || a) return e(t, n, i); return !1 } : function (t, n, u) { var l, c, f, p = [T, s]; if (u) { for (; t = t[r];)if ((1 === t.nodeType || a) && e(t, n, u)) return !0 } else for (; t = t[r];)if (1 === t.nodeType || a) if (c = (f = t[b] || (t[b] = {}))[t.uniqueID] || (f[t.uniqueID] = {}), i && i === t.nodeName.toLowerCase()) t = t[r] || t; else { if ((l = c[o]) && l[0] === T && l[1] === s) return p[2] = l[2]; if (c[o] = p, p[2] = e(t, n, u)) return !0 } return !1 } } function we(e) { return e.length > 1 ? function (t, n, r) { for (var i = e.length; i--;)if (!e[i](t, n, r)) return !1; return !0 } : e[0] } function Te(e, t, n, r, i) { for (var o, a = [], s = 0, u = e.length, l = null != t; s < u; s++)(o = e[s]) && (n && !n(o, r, i) || (a.push(o), l && t.push(s))); return a } function Ce(e, t, n, r, i, o) { return r && !r[b] && (r = Ce(r)), i && !i[b] && (i = Ce(i, o)), le(function (o, a, s, u) { var l, c, f, p = [], d = [], h = a.length, g = o || function (e, t, n) { for (var r = 0, i = t.length; r < i; r++)se(e, t[r], n); return n }(t || "*", s.nodeType ? [s] : s, []), v = !e || !o && t ? g : Te(g, p, e, s, u), y = n ? i || (o ? e : h || r) ? [] : a : v; if (n && n(v, y, s, u), r) for (l = Te(y, d), r(l, [], s, u), c = l.length; c--;)(f = l[c]) && (y[d[c]] = !(v[d[c]] = f)); if (o) { if (i || e) { if (i) { for (l = [], c = y.length; c--;)(f = y[c]) && l.push(v[c] = f); i(null, y = [], l, u) } for (c = y.length; c--;)(f = y[c]) && (l = i ? P(o, f) : p[c]) > -1 && (o[l] = !(a[l] = f)) } } else y = Te(y === a ? y.splice(h, y.length) : y), i ? i(null, a, y, u) : H.apply(a, y) }) } function Ee(e) { for (var t, n, i, o = e.length, a = r.relative[e[0].type], s = a || r.relative[" "], u = a ? 1 : 0, c = be(function (e) { return e === t }, s, !0), f = be(function (e) { return P(t, e) > -1 }, s, !0), p = [function (e, n, r) { var i = !a && (r || n !== l) || ((t = n).nodeType ? c(e, n, r) : f(e, n, r)); return t = null, i }]; u < o; u++)if (n = r.relative[e[u].type]) p = [be(we(p), n)]; else { if ((n = r.filter[e[u].type].apply(null, e[u].matches))[b]) { for (i = ++u; i < o && !r.relative[e[i].type]; i++); return Ce(u > 1 && we(p), u > 1 && xe(e.slice(0, u - 1).concat({ value: " " === e[u - 2].type ? "*" : "" })).replace($, "$1"), n, u < i && Ee(e.slice(u, i)), i < o && Ee(e = e.slice(i)), i < o && xe(e)) } p.push(n) } return we(p) } return me.prototype = r.filters = r.pseudos, r.setFilters = new me, a = se.tokenize = function (e, t) { var n, i, o, a, s, u, l, c = S[e + " "]; if (c) return t ? 0 : c.slice(0); for (s = e, u = [], l = r.preFilter; s;) { for (a in n && !(i = _.exec(s)) || (i && (s = s.slice(i[0].length) || s), u.push(o = [])), n = !1, (i = z.exec(s)) && (n = i.shift(), o.push({ value: n, type: i[0].replace($, " ") }), s = s.slice(n.length)), r.filter) !(i = G[a].exec(s)) || l[a] && !(i = l[a](i)) || (n = i.shift(), o.push({ value: n, type: a, matches: i }), s = s.slice(n.length)); if (!n) break } return t ? s.length : s ? se.error(e) : S(e, u).slice(0) }, s = se.compile = function (e, t) { var n, i = [], o = [], s = k[e + " "]; if (!s) { for (t || (t = a(e)), n = t.length; n--;)(s = Ee(t[n]))[b] ? i.push(s) : o.push(s); (s = k(e, function (e, t) { var n = t.length > 0, i = e.length > 0, o = function (o, a, s, u, c) { var f, h, v, y = 0, m = "0", x = o && [], b = [], w = l, C = o || i && r.find.TAG("*", c), E = T += null == w ? 1 : Math.random() || .1, S = C.length; for (c && (l = a == d || a || c); m !== S && null != (f = C[m]); m++) { if (i && f) { for (h = 0, a || f.ownerDocument == d || (p(f), s = !g); v = e[h++];)if (v(f, a || d, s)) { u.push(f); break } c && (T = E) } n && ((f = !v && f) && y--, o && x.push(f)) } if (y += m, n && m !== y) { for (h = 0; v = t[h++];)v(x, b, a, s); if (o) { if (y > 0) for (; m--;)x[m] || b[m] || (b[m] = q.call(u)); b = Te(b) } H.apply(u, b), c && !o && b.length > 0 && y + t.length > 1 && se.uniqueSort(u) } return c && (T = E, l = w), x }; return n ? le(o) : o }(o, i))).selector = e } return s }, u = se.select = function (e, t, n, i) { var o, u, l, c, f, p = "function" == typeof e && e, d = !i && a(e = p.selector || e); if (n = n || [], 1 === d.length) { if ((u = d[0] = d[0].slice(0)).length > 2 && "ID" === (l = u[0]).type && 9 === t.nodeType && g && r.relative[u[1].type]) { if (!(t = (r.find.ID(l.matches[0].replace(te, ne), t) || [])[0])) return n; p && (t = t.parentNode), e = e.slice(u.shift().value.length) } for (o = G.needsContext.test(e) ? 0 : u.length; o-- && (l = u[o], !r.relative[c = l.type]);)if ((f = r.find[c]) && (i = f(l.matches[0].replace(te, ne), ee.test(u[0].type) && ye(t.parentNode) || t))) { if (u.splice(o, 1), !(e = i.length && xe(u))) return H.apply(n, i), n; break } } return (p || s(e, d))(i, t, !g, n, !t || ee.test(e) && ye(t.parentNode) || t), n }, n.sortStable = b.split("").sort(N).join("") === b, n.detectDuplicates = !!f, p(), n.sortDetached = ce(function (e) { return 1 & e.compareDocumentPosition(d.createElement("fieldset")) }), ce(function (e) { return e.innerHTML = "<a href='#'></a>", "#" === e.firstChild.getAttribute("href") }) || fe("type|href|height|width", function (e, t, n) { if (!n) return e.getAttribute(t, "type" === t.toLowerCase() ? 1 : 2) }), n.attributes && ce(function (e) { return e.innerHTML = "<input/>", e.firstChild.setAttribute("value", ""), "" === e.firstChild.getAttribute("value") }) || fe("value", function (e, t, n) { if (!n && "input" === e.nodeName.toLowerCase()) return e.defaultValue }), ce(function (e) { return null == e.getAttribute("disabled") }) || fe(R, function (e, t, n) { var r; if (!n) return !0 === e[t] ? t.toLowerCase() : (r = e.getAttributeNode(t)) && r.specified ? r.value : null }), se }(e); w.find = C, w.expr = C.selectors, w.expr[":"] = w.expr.pseudos, w.uniqueSort = w.unique = C.uniqueSort, w.text = C.getText, w.isXMLDoc = C.isXML, w.contains = C.contains, w.escapeSelector = C.escape; var E = function (e, t, n) { for (var r = [], i = void 0 !== n; (e = e[t]) && 9 !== e.nodeType;)if (1 === e.nodeType) { if (i && w(e).is(n)) break; r.push(e) } return r }, S = function (e, t) { for (var n = []; e; e = e.nextSibling)1 === e.nodeType && e !== t && n.push(e); return n }, k = w.expr.match.needsContext; function A(e, t) { return e.nodeName && e.nodeName.toLowerCase() === t.toLowerCase() } var N = /^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i; function j(e, t, n) { return h(t) ? w.grep(e, function (e, r) { return !!t.call(e, r, e) !== n }) : t.nodeType ? w.grep(e, function (e) { return e === t !== n }) : "string" != typeof t ? w.grep(e, function (e) { return s.call(t, e) > -1 !== n }) : w.filter(t, e, n) } w.filter = function (e, t, n) { var r = t[0]; return n && (e = ":not(" + e + ")"), 1 === t.length && 1 === r.nodeType ? w.find.matchesSelector(r, e) ? [r] : [] : w.find.matches(e, w.grep(t, function (e) { return 1 === e.nodeType })) }, w.fn.extend({ find: function (e) { var t, n, r = this.length, i = this; if ("string" != typeof e) return this.pushStack(w(e).filter(function () { for (t = 0; t < r; t++)if (w.contains(i[t], this)) return !0 })); for (n = this.pushStack([]), t = 0; t < r; t++)w.find(e, i[t], n); return r > 1 ? w.uniqueSort(n) : n }, filter: function (e) { return this.pushStack(j(this, e || [], !1)) }, not: function (e) { return this.pushStack(j(this, e || [], !0)) }, is: function (e) { return !!j(this, "string" == typeof e && k.test(e) ? w(e) : e || [], !1).length } }); var D, q = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/; (w.fn.init = function (e, t, n) { var r, i; if (!e) return this; if (n = n || D, "string" == typeof e) { if (!(r = "<" === e[0] && ">" === e[e.length - 1] && e.length >= 3 ? [null, e, null] : q.exec(e)) || !r[1] && t) return !t || t.jquery ? (t || n).find(e) : this.constructor(t).find(e); if (r[1]) { if (t = t instanceof w ? t[0] : t, w.merge(this, w.parseHTML(r[1], t && t.nodeType ? t.ownerDocument || t : v, !0)), N.test(r[1]) && w.isPlainObject(t)) for (r in t) h(this[r]) ? this[r](t[r]) : this.attr(r, t[r]); return this } return (i = v.getElementById(r[2])) && (this[0] = i, this.length = 1), this } return e.nodeType ? (this[0] = e, this.length = 1, this) : h(e) ? void 0 !== n.ready ? n.ready(e) : e(w) : w.makeArray(e, this) }).prototype = w.fn, D = w(v); var L = /^(?:parents|prev(?:Until|All))/, H = { children: !0, contents: !0, next: !0, prev: !0 }; function O(e, t) { for (; (e = e[t]) && 1 !== e.nodeType;); return e } w.fn.extend({ has: function (e) { var t = w(e, this), n = t.length; return this.filter(function () { for (var e = 0; e < n; e++)if (w.contains(this, t[e])) return !0 }) }, closest: function (e, t) { var n, r = 0, i = this.length, o = [], a = "string" != typeof e && w(e); if (!k.test(e)) for (; r < i; r++)for (n = this[r]; n && n !== t; n = n.parentNode)if (n.nodeType < 11 && (a ? a.index(n) > -1 : 1 === n.nodeType && w.find.matchesSelector(n, e))) { o.push(n); break } return this.pushStack(o.length > 1 ? w.uniqueSort(o) : o) }, index: function (e) { return e ? "string" == typeof e ? s.call(w(e), this[0]) : s.call(this, e.jquery ? e[0] : e) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1 }, add: function (e, t) { return this.pushStack(w.uniqueSort(w.merge(this.get(), w(e, t)))) }, addBack: function (e) { return this.add(null == e ? this.prevObject : this.prevObject.filter(e)) } }), w.each({ parent: function (e) { var t = e.parentNode; return t && 11 !== t.nodeType ? t : null }, parents: function (e) { return E(e, "parentNode") }, parentsUntil: function (e, t, n) { return E(e, "parentNode", n) }, next: function (e) { return O(e, "nextSibling") }, prev: function (e) { return O(e, "previousSibling") }, nextAll: function (e) { return E(e, "nextSibling") }, prevAll: function (e) { return E(e, "previousSibling") }, nextUntil: function (e, t, n) { return E(e, "nextSibling", n) }, prevUntil: function (e, t, n) { return E(e, "previousSibling", n) }, siblings: function (e) { return S((e.parentNode || {}).firstChild, e) }, children: function (e) { return S(e.firstChild) }, contents: function (e) { return null != e.contentDocument && r(e.contentDocument) ? e.contentDocument : (A(e, "template") && (e = e.content || e), w.merge([], e.childNodes)) } }, function (e, t) { w.fn[e] = function (n, r) { var i = w.map(this, t, n); return "Until" !== e.slice(-5) && (r = n), r && "string" == typeof r && (i = w.filter(r, i)), this.length > 1 && (H[e] || w.uniqueSort(i), L.test(e) && i.reverse()), this.pushStack(i) } }); var P = /[^\x20\t\r\n\f]+/g; function R(e) { return e } function M(e) { throw e } function I(e, t, n, r) { var i; try { e && h(i = e.promise) ? i.call(e).done(t).fail(n) : e && h(i = e.then) ? i.call(e, t, n) : t.apply(void 0, [e].slice(r)) } catch (e) { n.apply(void 0, [e]) } } w.Callbacks = function (e) { e = "string" == typeof e ? function (e) { var t = {}; return w.each(e.match(P) || [], function (e, n) { t[n] = !0 }), t }(e) : w.extend({}, e); var t, n, r, i, o = [], a = [], s = -1, u = function () { for (i = i || e.once, r = t = !0; a.length; s = -1)for (n = a.shift(); ++s < o.length;)!1 === o[s].apply(n[0], n[1]) && e.stopOnFalse && (s = o.length, n = !1); e.memory || (n = !1), t = !1, i && (o = n ? [] : "") }, l = { add: function () { return o && (n && !t && (s = o.length - 1, a.push(n)), function t(n) { w.each(n, function (n, r) { h(r) ? e.unique && l.has(r) || o.push(r) : r && r.length && "string" !== x(r) && t(r) }) }(arguments), n && !t && u()), this }, remove: function () { return w.each(arguments, function (e, t) { for (var n; (n = w.inArray(t, o, n)) > -1;)o.splice(n, 1), n <= s && s-- }), this }, has: function (e) { return e ? w.inArray(e, o) > -1 : o.length > 0 }, empty: function () { return o && (o = []), this }, disable: function () { return i = a = [], o = n = "", this }, disabled: function () { return !o }, lock: function () { return i = a = [], n || t || (o = n = ""), this }, locked: function () { return !!i }, fireWith: function (e, n) { return i || (n = [e, (n = n || []).slice ? n.slice() : n], a.push(n), t || u()), this }, fire: function () { return l.fireWith(this, arguments), this }, fired: function () { return !!r } }; return l }, w.extend({ Deferred: function (t) { var n = [["notify", "progress", w.Callbacks("memory"), w.Callbacks("memory"), 2], ["resolve", "done", w.Callbacks("once memory"), w.Callbacks("once memory"), 0, "resolved"], ["reject", "fail", w.Callbacks("once memory"), w.Callbacks("once memory"), 1, "rejected"]], r = "pending", i = { state: function () { return r }, always: function () { return o.done(arguments).fail(arguments), this }, catch: function (e) { return i.then(null, e) }, pipe: function () { var e = arguments; return w.Deferred(function (t) { w.each(n, function (n, r) { var i = h(e[r[4]]) && e[r[4]]; o[r[1]](function () { var e = i && i.apply(this, arguments); e && h(e.promise) ? e.promise().progress(t.notify).done(t.resolve).fail(t.reject) : t[r[0] + "With"](this, i ? [e] : arguments) }) }), e = null }).promise() }, then: function (t, r, i) { var o = 0; function a(t, n, r, i) { return function () { var s = this, u = arguments, l = function () { var e, l; if (!(t < o)) { if ((e = r.apply(s, u)) === n.promise()) throw new TypeError("Thenable self-resolution"); l = e && ("object" == typeof e || "function" == typeof e) && e.then, h(l) ? i ? l.call(e, a(o, n, R, i), a(o, n, M, i)) : (o++, l.call(e, a(o, n, R, i), a(o, n, M, i), a(o, n, R, n.notifyWith))) : (r !== R && (s = void 0, u = [e]), (i || n.resolveWith)(s, u)) } }, c = i ? l : function () { try { l() } catch (e) { w.Deferred.exceptionHook && w.Deferred.exceptionHook(e, c.stackTrace), t + 1 >= o && (r !== M && (s = void 0, u = [e]), n.rejectWith(s, u)) } }; t ? c() : (w.Deferred.getStackHook && (c.stackTrace = w.Deferred.getStackHook()), e.setTimeout(c)) } } return w.Deferred(function (e) { n[0][3].add(a(0, e, h(i) ? i : R, e.notifyWith)), n[1][3].add(a(0, e, h(t) ? t : R)), n[2][3].add(a(0, e, h(r) ? r : M)) }).promise() }, promise: function (e) { return null != e ? w.extend(e, i) : i } }, o = {}; return w.each(n, function (e, t) { var a = t[2], s = t[5]; i[t[1]] = a.add, s && a.add(function () { r = s }, n[3 - e][2].disable, n[3 - e][3].disable, n[0][2].lock, n[0][3].lock), a.add(t[3].fire), o[t[0]] = function () { return o[t[0] + "With"](this === o ? void 0 : this, arguments), this }, o[t[0] + "With"] = a.fireWith }), i.promise(o), t && t.call(o, o), o }, when: function (e) { var t = arguments.length, n = t, r = Array(n), o = i.call(arguments), a = w.Deferred(), s = function (e) { return function (n) { r[e] = this, o[e] = arguments.length > 1 ? i.call(arguments) : n, --t || a.resolveWith(r, o) } }; if (t <= 1 && (I(e, a.done(s(n)).resolve, a.reject, !t), "pending" === a.state() || h(o[n] && o[n].then))) return a.then(); for (; n--;)I(o[n], s(n), a.reject); return a.promise() } }); var W = /^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/; w.Deferred.exceptionHook = function (t, n) { e.console && e.console.warn && t && W.test(t.name) && e.console.warn("jQuery.Deferred exception: " + t.message, t.stack, n) }, w.readyException = function (t) { e.setTimeout(function () { throw t }) }; var F = w.Deferred(); function B() { v.removeEventListener("DOMContentLoaded", B), e.removeEventListener("load", B), w.ready() } w.fn.ready = function (e) { return F.then(e).catch(function (e) { w.readyException(e) }), this }, w.extend({ isReady: !1, readyWait: 1, ready: function (e) { (!0 === e ? --w.readyWait : w.isReady) || (w.isReady = !0, !0 !== e && --w.readyWait > 0 || F.resolveWith(v, [w])) } }), w.ready.then = F.then, "complete" === v.readyState || "loading" !== v.readyState && !v.documentElement.doScroll ? e.setTimeout(w.ready) : (v.addEventListener("DOMContentLoaded", B), e.addEventListener("load", B)); var $ = function (e, t, n, r, i, o, a) { var s = 0, u = e.length, l = null == n; if ("object" === x(n)) for (s in i = !0, n) $(e, t, s, n[s], !0, o, a); else if (void 0 !== r && (i = !0, h(r) || (a = !0), l && (a ? (t.call(e, r), t = null) : (l = t, t = function (e, t, n) { return l.call(w(e), n) })), t)) for (; s < u; s++)t(e[s], n, a ? r : r.call(e[s], s, t(e[s], n))); return i ? e : l ? t.call(e) : u ? t(e[0], n) : o }, _ = /^-ms-/, z = /-([a-z])/g; function U(e, t) { return t.toUpperCase() } function X(e) { return e.replace(_, "ms-").replace(z, U) } var V = function (e) { return 1 === e.nodeType || 9 === e.nodeType || !+e.nodeType }; function G() { this.expando = w.expando + G.uid++ } G.uid = 1, G.prototype = { cache: function (e) { var t = e[this.expando]; return t || (t = {}, V(e) && (e.nodeType ? e[this.expando] = t : Object.defineProperty(e, this.expando, { value: t, configurable: !0 }))), t }, set: function (e, t, n) { var r, i = this.cache(e); if ("string" == typeof t) i[X(t)] = n; else for (r in t) i[X(r)] = t[r]; return i }, get: function (e, t) { return void 0 === t ? this.cache(e) : e[this.expando] && e[this.expando][X(t)] }, access: function (e, t, n) { return void 0 === t || t && "string" == typeof t && void 0 === n ? this.get(e, t) : (this.set(e, t, n), void 0 !== n ? n : t) }, remove: function (e, t) { var n, r = e[this.expando]; if (void 0 !== r) { if (void 0 !== t) { n = (t = Array.isArray(t) ? t.map(X) : (t = X(t)) in r ? [t] : t.match(P) || []).length; for (; n--;)delete r[t[n]] } (void 0 === t || w.isEmptyObject(r)) && (e.nodeType ? e[this.expando] = void 0 : delete e[this.expando]) } }, hasData: function (e) { var t = e[this.expando]; return void 0 !== t && !w.isEmptyObject(t) } }; var Y = new G, Q = new G, J = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, K = /[A-Z]/g; function Z(e, t, n) { var r; if (void 0 === n && 1 === e.nodeType) if (r = "data-" + t.replace(K, "-$&").toLowerCase(), "string" == typeof (n = e.getAttribute(r))) { try { n = function (e) { return "true" === e || "false" !== e && ("null" === e ? null : e === +e + "" ? +e : J.test(e) ? JSON.parse(e) : e) }(n) } catch (e) { } Q.set(e, t, n) } else n = void 0; return n } w.extend({ hasData: function (e) { return Q.hasData(e) || Y.hasData(e) }, data: function (e, t, n) { return Q.access(e, t, n) }, removeData: function (e, t) { Q.remove(e, t) }, _data: function (e, t, n) { return Y.access(e, t, n) }, _removeData: function (e, t) { Y.remove(e, t) } }), w.fn.extend({ data: function (e, t) { var n, r, i, o = this[0], a = o && o.attributes; if (void 0 === e) { if (this.length && (i = Q.get(o), 1 === o.nodeType && !Y.get(o, "hasDataAttrs"))) { for (n = a.length; n--;)a[n] && 0 === (r = a[n].name).indexOf("data-") && (r = X(r.slice(5)), Z(o, r, i[r])); Y.set(o, "hasDataAttrs", !0) } return i } return "object" == typeof e ? this.each(function () { Q.set(this, e) }) : $(this, function (t) { var n; if (o && void 0 === t) return void 0 !== (n = Q.get(o, e)) || void 0 !== (n = Z(o, e)) ? n : void 0; this.each(function () { Q.set(this, e, t) }) }, null, t, arguments.length > 1, null, !0) }, removeData: function (e) { return this.each(function () { Q.remove(this, e) }) } }), w.extend({ queue: function (e, t, n) { var r; if (e) return t = (t || "fx") + "queue", r = Y.get(e, t), n && (!r || Array.isArray(n) ? r = Y.access(e, t, w.makeArray(n)) : r.push(n)), r || [] }, dequeue: function (e, t) { t = t || "fx"; var n = w.queue(e, t), r = n.length, i = n.shift(), o = w._queueHooks(e, t); "inprogress" === i && (i = n.shift(), r--), i && ("fx" === t && n.unshift("inprogress"), delete o.stop, i.call(e, function () { w.dequeue(e, t) }, o)), !r && o && o.empty.fire() }, _queueHooks: function (e, t) { var n = t + "queueHooks"; return Y.get(e, n) || Y.access(e, n, { empty: w.Callbacks("once memory").add(function () { Y.remove(e, [t + "queue", n]) }) }) } }), w.fn.extend({ queue: function (e, t) { var n = 2; return "string" != typeof e && (t = e, e = "fx", n--), arguments.length < n ? w.queue(this[0], e) : void 0 === t ? this : this.each(function () { var n = w.queue(this, e, t); w._queueHooks(this, e), "fx" === e && "inprogress" !== n[0] && w.dequeue(this, e) }) }, dequeue: function (e) { return this.each(function () { w.dequeue(this, e) }) }, clearQueue: function (e) { return this.queue(e || "fx", []) }, promise: function (e, t) { var n, r = 1, i = w.Deferred(), o = this, a = this.length, s = function () { --r || i.resolveWith(o, [o]) }; for ("string" != typeof e && (t = e, e = void 0), e = e || "fx"; a--;)(n = Y.get(o[a], e + "queueHooks")) && n.empty && (r++, n.empty.add(s)); return s(), i.promise(t) } }); var ee = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, te = new RegExp("^(?:([+-])=|)(" + ee + ")([a-z%]*)$", "i"), ne = ["Top", "Right", "Bottom", "Left"], re = v.documentElement, ie = function (e) { return w.contains(e.ownerDocument, e) }, oe = { composed: !0 }; re.getRootNode && (ie = function (e) { return w.contains(e.ownerDocument, e) || e.getRootNode(oe) === e.ownerDocument }); var ae = function (e, t) { return "none" === (e = t || e).style.display || "" === e.style.display && ie(e) && "none" === w.css(e, "display") }; function se(e, t, n, r) { var i, o, a = 20, s = r ? function () { return r.cur() } : function () { return w.css(e, t, "") }, u = s(), l = n && n[3] || (w.cssNumber[t] ? "" : "px"), c = e.nodeType && (w.cssNumber[t] || "px" !== l && +u) && te.exec(w.css(e, t)); if (c && c[3] !== l) { for (u /= 2, l = l || c[3], c = +u || 1; a--;)w.style(e, t, c + l), (1 - o) * (1 - (o = s() / u || .5)) <= 0 && (a = 0), c /= o; c *= 2, w.style(e, t, c + l), n = n || [] } return n && (c = +c || +u || 0, i = n[1] ? c + (n[1] + 1) * n[2] : +n[2], r && (r.unit = l, r.start = c, r.end = i)), i } var ue = {}; function le(e) { var t, n = e.ownerDocument, r = e.nodeName, i = ue[r]; return i || (t = n.body.appendChild(n.createElement(r)), i = w.css(t, "display"), t.parentNode.removeChild(t), "none" === i && (i = "block"), ue[r] = i, i) } function ce(e, t) { for (var n, r, i = [], o = 0, a = e.length; o < a; o++)(r = e[o]).style && (n = r.style.display, t ? ("none" === n && (i[o] = Y.get(r, "display") || null, i[o] || (r.style.display = "")), "" === r.style.display && ae(r) && (i[o] = le(r))) : "none" !== n && (i[o] = "none", Y.set(r, "display", n))); for (o = 0; o < a; o++)null != i[o] && (e[o].style.display = i[o]); return e } w.fn.extend({ show: function () { return ce(this, !0) }, hide: function () { return ce(this) }, toggle: function (e) { return "boolean" == typeof e ? e ? this.show() : this.hide() : this.each(function () { ae(this) ? w(this).show() : w(this).hide() }) } }); var fe, pe, de = /^(?:checkbox|radio)$/i, he = /<([a-z][^\/\0>\x20\t\r\n\f]*)/i, ge = /^$|^module$|\/(?:java|ecma)script/i; fe = v.createDocumentFragment().appendChild(v.createElement("div")), (pe = v.createElement("input")).setAttribute("type", "radio"), pe.setAttribute("checked", "checked"), pe.setAttribute("name", "t"), fe.appendChild(pe), d.checkClone = fe.cloneNode(!0).cloneNode(!0).lastChild.checked, fe.innerHTML = "<textarea>x</textarea>", d.noCloneChecked = !!fe.cloneNode(!0).lastChild.defaultValue, fe.innerHTML = "<option></option>", d.option = !!fe.lastChild; var ve = { thead: [1, "<table>", "</table>"], col: [2, "<table><colgroup>", "</colgroup></table>"], tr: [2, "<table><tbody>", "</tbody></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], _default: [0, "", ""] }; function ye(e, t) { var n; return n = void 0 !== e.getElementsByTagName ? e.getElementsByTagName(t || "*") : void 0 !== e.querySelectorAll ? e.querySelectorAll(t || "*") : [], void 0 === t || t && A(e, t) ? w.merge([e], n) : n } function me(e, t) { for (var n = 0, r = e.length; n < r; n++)Y.set(e[n], "globalEval", !t || Y.get(t[n], "globalEval")) } ve.tbody = ve.tfoot = ve.colgroup = ve.caption = ve.thead, ve.th = ve.td, d.option || (ve.optgroup = ve.option = [1, "<select multiple='multiple'>", "</select>"]); var xe = /<|&#?\w+;/; function be(e, t, n, r, i) { for (var o, a, s, u, l, c, f = t.createDocumentFragment(), p = [], d = 0, h = e.length; d < h; d++)if ((o = e[d]) || 0 === o) if ("object" === x(o)) w.merge(p, o.nodeType ? [o] : o); else if (xe.test(o)) { for (a = a || f.appendChild(t.createElement("div")), s = (he.exec(o) || ["", ""])[1].toLowerCase(), u = ve[s] || ve._default, a.innerHTML = u[1] + w.htmlPrefilter(o) + u[2], c = u[0]; c--;)a = a.lastChild; w.merge(p, a.childNodes), (a = f.firstChild).textContent = "" } else p.push(t.createTextNode(o)); for (f.textContent = "", d = 0; o = p[d++];)if (r && w.inArray(o, r) > -1) i && i.push(o); else if (l = ie(o), a = ye(f.appendChild(o), "script"), l && me(a), n) for (c = 0; o = a[c++];)ge.test(o.type || "") && n.push(o); return f } var we = /^([^.]*)(?:\.(.+)|)/; function Te() { return !0 } function Ce() { return !1 } function Ee(e, t) { return e === function () { try { return v.activeElement } catch (e) { } }() == ("focus" === t) } function Se(e, t, n, r, i, o) { var a, s; if ("object" == typeof t) { for (s in "string" != typeof n && (r = r || n, n = void 0), t) Se(e, s, n, r, t[s], o); return e } if (null == r && null == i ? (i = n, r = n = void 0) : null == i && ("string" == typeof n ? (i = r, r = void 0) : (i = r, r = n, n = void 0)), !1 === i) i = Ce; else if (!i) return e; return 1 === o && (a = i, (i = function (e) { return w().off(e), a.apply(this, arguments) }).guid = a.guid || (a.guid = w.guid++)), e.each(function () { w.event.add(this, t, i, r, n) }) } function ke(e, t, n) { n ? (Y.set(e, t, !1), w.event.add(e, t, { namespace: !1, handler: function (e) { var r, o, a = Y.get(this, t); if (1 & e.isTrigger && this[t]) { if (a.length) (w.event.special[t] || {}).delegateType && e.stopPropagation(); else if (a = i.call(arguments), Y.set(this, t, a), r = n(this, t), this[t](), a !== (o = Y.get(this, t)) || r ? Y.set(this, t, !1) : o = {}, a !== o) return e.stopImmediatePropagation(), e.preventDefault(), o && o.value } else a.length && (Y.set(this, t, { value: w.event.trigger(w.extend(a[0], w.Event.prototype), a.slice(1), this) }), e.stopImmediatePropagation()) } })) : void 0 === Y.get(e, t) && w.event.add(e, t, Te) } w.event = { global: {}, add: function (e, t, n, r, i) { var o, a, s, u, l, c, f, p, d, h, g, v = Y.get(e); if (V(e)) for (n.handler && (n = (o = n).handler, i = o.selector), i && w.find.matchesSelector(re, i), n.guid || (n.guid = w.guid++), (u = v.events) || (u = v.events = Object.create(null)), (a = v.handle) || (a = v.handle = function (t) { return void 0 !== w && w.event.triggered !== t.type ? w.event.dispatch.apply(e, arguments) : void 0 }), l = (t = (t || "").match(P) || [""]).length; l--;)d = g = (s = we.exec(t[l]) || [])[1], h = (s[2] || "").split(".").sort(), d && (f = w.event.special[d] || {}, d = (i ? f.delegateType : f.bindType) || d, f = w.event.special[d] || {}, c = w.extend({ type: d, origType: g, data: r, handler: n, guid: n.guid, selector: i, needsContext: i && w.expr.match.needsContext.test(i), namespace: h.join(".") }, o), (p = u[d]) || ((p = u[d] = []).delegateCount = 0, f.setup && !1 !== f.setup.call(e, r, h, a) || e.addEventListener && e.addEventListener(d, a)), f.add && (f.add.call(e, c), c.handler.guid || (c.handler.guid = n.guid)), i ? p.splice(p.delegateCount++, 0, c) : p.push(c), w.event.global[d] = !0) }, remove: function (e, t, n, r, i) { var o, a, s, u, l, c, f, p, d, h, g, v = Y.hasData(e) && Y.get(e); if (v && (u = v.events)) { for (l = (t = (t || "").match(P) || [""]).length; l--;)if (d = g = (s = we.exec(t[l]) || [])[1], h = (s[2] || "").split(".").sort(), d) { for (f = w.event.special[d] || {}, p = u[d = (r ? f.delegateType : f.bindType) || d] || [], s = s[2] && new RegExp("(^|\\.)" + h.join("\\.(?:.*\\.|)") + "(\\.|$)"), a = o = p.length; o--;)c = p[o], !i && g !== c.origType || n && n.guid !== c.guid || s && !s.test(c.namespace) || r && r !== c.selector && ("**" !== r || !c.selector) || (p.splice(o, 1), c.selector && p.delegateCount--, f.remove && f.remove.call(e, c)); a && !p.length && (f.teardown && !1 !== f.teardown.call(e, h, v.handle) || w.removeEvent(e, d, v.handle), delete u[d]) } else for (d in u) w.event.remove(e, d + t[l], n, r, !0); w.isEmptyObject(u) && Y.remove(e, "handle events") } }, dispatch: function (e) { var t, n, r, i, o, a, s = new Array(arguments.length), u = w.event.fix(e), l = (Y.get(this, "events") || Object.create(null))[u.type] || [], c = w.event.special[u.type] || {}; for (s[0] = u, t = 1; t < arguments.length; t++)s[t] = arguments[t]; if (u.delegateTarget = this, !c.preDispatch || !1 !== c.preDispatch.call(this, u)) { for (a = w.event.handlers.call(this, u, l), t = 0; (i = a[t++]) && !u.isPropagationStopped();)for (u.currentTarget = i.elem, n = 0; (o = i.handlers[n++]) && !u.isImmediatePropagationStopped();)u.rnamespace && !1 !== o.namespace && !u.rnamespace.test(o.namespace) || (u.handleObj = o, u.data = o.data, void 0 !== (r = ((w.event.special[o.origType] || {}).handle || o.handler).apply(i.elem, s)) && !1 === (u.result = r) && (u.preventDefault(), u.stopPropagation())); return c.postDispatch && c.postDispatch.call(this, u), u.result } }, handlers: function (e, t) { var n, r, i, o, a, s = [], u = t.delegateCount, l = e.target; if (u && l.nodeType && !("click" === e.type && e.button >= 1)) for (; l !== this; l = l.parentNode || this)if (1 === l.nodeType && ("click" !== e.type || !0 !== l.disabled)) { for (o = [], a = {}, n = 0; n < u; n++)void 0 === a[i = (r = t[n]).selector + " "] && (a[i] = r.needsContext ? w(i, this).index(l) > -1 : w.find(i, this, null, [l]).length), a[i] && o.push(r); o.length && s.push({ elem: l, handlers: o }) } return l = this, u < t.length && s.push({ elem: l, handlers: t.slice(u) }), s }, addProp: function (e, t) { Object.defineProperty(w.Event.prototype, e, { enumerable: !0, configurable: !0, get: h(t) ? function () { if (this.originalEvent) return t(this.originalEvent) } : function () { if (this.originalEvent) return this.originalEvent[e] }, set: function (t) { Object.defineProperty(this, e, { enumerable: !0, configurable: !0, writable: !0, value: t }) } }) }, fix: function (e) { return e[w.expando] ? e : new w.Event(e) }, special: { load: { noBubble: !0 }, click: { setup: function (e) { var t = this || e; return de.test(t.type) && t.click && A(t, "input") && ke(t, "click", Te), !1 }, trigger: function (e) { var t = this || e; return de.test(t.type) && t.click && A(t, "input") && ke(t, "click"), !0 }, _default: function (e) { var t = e.target; return de.test(t.type) && t.click && A(t, "input") && Y.get(t, "click") || A(t, "a") } }, beforeunload: { postDispatch: function (e) { void 0 !== e.result && e.originalEvent && (e.originalEvent.returnValue = e.result) } } } }, w.removeEvent = function (e, t, n) { e.removeEventListener && e.removeEventListener(t, n) }, w.Event = function (e, t) { if (!(this instanceof w.Event)) return new w.Event(e, t); e && e.type ? (this.originalEvent = e, this.type = e.type, this.isDefaultPrevented = e.defaultPrevented || void 0 === e.defaultPrevented && !1 === e.returnValue ? Te : Ce, this.target = e.target && 3 === e.target.nodeType ? e.target.parentNode : e.target, this.currentTarget = e.currentTarget, this.relatedTarget = e.relatedTarget) : this.type = e, t && w.extend(this, t), this.timeStamp = e && e.timeStamp || Date.now(), this[w.expando] = !0 }, w.Event.prototype = { constructor: w.Event, isDefaultPrevented: Ce, isPropagationStopped: Ce, isImmediatePropagationStopped: Ce, isSimulated: !1, preventDefault: function () { var e = this.originalEvent; this.isDefaultPrevented = Te, e && !this.isSimulated && e.preventDefault() }, stopPropagation: function () { var e = this.originalEvent; this.isPropagationStopped = Te, e && !this.isSimulated && e.stopPropagation() }, stopImmediatePropagation: function () { var e = this.originalEvent; this.isImmediatePropagationStopped = Te, e && !this.isSimulated && e.stopImmediatePropagation(), this.stopPropagation() } }, w.each({ altKey: !0, bubbles: !0, cancelable: !0, changedTouches: !0, ctrlKey: !0, detail: !0, eventPhase: !0, metaKey: !0, pageX: !0, pageY: !0, shiftKey: !0, view: !0, char: !0, code: !0, charCode: !0, key: !0, keyCode: !0, button: !0, buttons: !0, clientX: !0, clientY: !0, offsetX: !0, offsetY: !0, pointerId: !0, pointerType: !0, screenX: !0, screenY: !0, targetTouches: !0, toElement: !0, touches: !0, which: !0 }, w.event.addProp), w.each({ focus: "focusin", blur: "focusout" }, function (e, t) { w.event.special[e] = { setup: function () { return ke(this, e, Ee), !1 }, trigger: function () { return ke(this, e), !0 }, _default: function () { return !0 }, delegateType: t } }), w.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function (e, t) { w.event.special[e] = { delegateType: t, bindType: t, handle: function (e) { var n, r = this, i = e.relatedTarget, o = e.handleObj; return i && (i === r || w.contains(r, i)) || (e.type = o.origType, n = o.handler.apply(this, arguments), e.type = t), n } } }), w.fn.extend({ on: function (e, t, n, r) { return Se(this, e, t, n, r) }, one: function (e, t, n, r) { return Se(this, e, t, n, r, 1) }, off: function (e, t, n) { var r, i; if (e && e.preventDefault && e.handleObj) return r = e.handleObj, w(e.delegateTarget).off(r.namespace ? r.origType + "." + r.namespace : r.origType, r.selector, r.handler), this; if ("object" == typeof e) { for (i in e) this.off(i, t, e[i]); return this } return !1 !== t && "function" != typeof t || (n = t, t = void 0), !1 === n && (n = Ce), this.each(function () { w.event.remove(this, e, n, t) }) } }); var Ae = /<script|<style|<link/i, Ne = /checked\s*(?:[^=]|=\s*.checked.)/i, je = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g; function De(e, t) { return A(e, "table") && A(11 !== t.nodeType ? t : t.firstChild, "tr") && w(e).children("tbody")[0] || e } function qe(e) { return e.type = (null !== e.getAttribute("type")) + "/" + e.type, e } function Le(e) { return "true/" === (e.type || "").slice(0, 5) ? e.type = e.type.slice(5) : e.removeAttribute("type"), e } function He(e, t) { var n, r, i, o, a, s; if (1 === t.nodeType) { if (Y.hasData(e) && (s = Y.get(e).events)) for (i in Y.remove(t, "handle events"), s) for (n = 0, r = s[i].length; n < r; n++)w.event.add(t, i, s[i][n]); Q.hasData(e) && (o = Q.access(e), a = w.extend({}, o), Q.set(t, a)) } } function Oe(e, t) { var n = t.nodeName.toLowerCase(); "input" === n && de.test(e.type) ? t.checked = e.checked : "input" !== n && "textarea" !== n || (t.defaultValue = e.defaultValue) } function Pe(e, t, n, r) { t = o(t); var i, a, s, u, l, c, f = 0, p = e.length, g = p - 1, v = t[0], y = h(v); if (y || p > 1 && "string" == typeof v && !d.checkClone && Ne.test(v)) return e.each(function (i) { var o = e.eq(i); y && (t[0] = v.call(this, i, o.html())), Pe(o, t, n, r) }); if (p && (a = (i = be(t, e[0].ownerDocument, !1, e, r)).firstChild, 1 === i.childNodes.length && (i = a), a || r)) { for (u = (s = w.map(ye(i, "script"), qe)).length; f < p; f++)l = i, f !== g && (l = w.clone(l, !0, !0), u && w.merge(s, ye(l, "script"))), n.call(e[f], l, f); if (u) for (c = s[s.length - 1].ownerDocument, w.map(s, Le), f = 0; f < u; f++)l = s[f], ge.test(l.type || "") && !Y.access(l, "globalEval") && w.contains(c, l) && (l.src && "module" !== (l.type || "").toLowerCase() ? w._evalUrl && !l.noModule && w._evalUrl(l.src, { nonce: l.nonce || l.getAttribute("nonce") }, c) : m(l.textContent.replace(je, ""), l, c)) } return e } function Re(e, t, n) { for (var r, i = t ? w.filter(t, e) : e, o = 0; null != (r = i[o]); o++)n || 1 !== r.nodeType || w.cleanData(ye(r)), r.parentNode && (n && ie(r) && me(ye(r, "script")), r.parentNode.removeChild(r)); return e } w.extend({ htmlPrefilter: function (e) { return e }, clone: function (e, t, n) { var r, i, o, a, s = e.cloneNode(!0), u = ie(e); if (!(d.noCloneChecked || 1 !== e.nodeType && 11 !== e.nodeType || w.isXMLDoc(e))) for (a = ye(s), r = 0, i = (o = ye(e)).length; r < i; r++)Oe(o[r], a[r]); if (t) if (n) for (o = o || ye(e), a = a || ye(s), r = 0, i = o.length; r < i; r++)He(o[r], a[r]); else He(e, s); return (a = ye(s, "script")).length > 0 && me(a, !u && ye(e, "script")), s }, cleanData: function (e) { for (var t, n, r, i = w.event.special, o = 0; void 0 !== (n = e[o]); o++)if (V(n)) { if (t = n[Y.expando]) { if (t.events) for (r in t.events) i[r] ? w.event.remove(n, r) : w.removeEvent(n, r, t.handle); n[Y.expando] = void 0 } n[Q.expando] && (n[Q.expando] = void 0) } } }), w.fn.extend({ detach: function (e) { return Re(this, e, !0) }, remove: function (e) { return Re(this, e) }, text: function (e) { return $(this, function (e) { return void 0 === e ? w.text(this) : this.empty().each(function () { 1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || (this.textContent = e) }) }, null, e, arguments.length) }, append: function () { return Pe(this, arguments, function (e) { 1 !== this.nodeType && 11 !== this.nodeType && 9 !== this.nodeType || De(this, e).appendChild(e) }) }, prepend: function () { return Pe(this, arguments, function (e) { if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) { var t = De(this, e); t.insertBefore(e, t.firstChild) } }) }, before: function () { return Pe(this, arguments, function (e) { this.parentNode && this.parentNode.insertBefore(e, this) }) }, after: function () { return Pe(this, arguments, function (e) { this.parentNode && this.parentNode.insertBefore(e, this.nextSibling) }) }, empty: function () { for (var e, t = 0; null != (e = this[t]); t++)1 === e.nodeType && (w.cleanData(ye(e, !1)), e.textContent = ""); return this }, clone: function (e, t) { return e = null != e && e, t = null == t ? e : t, this.map(function () { return w.clone(this, e, t) }) }, html: function (e) { return $(this, function (e) { var t = this[0] || {}, n = 0, r = this.length; if (void 0 === e && 1 === t.nodeType) return t.innerHTML; if ("string" == typeof e && !Ae.test(e) && !ve[(he.exec(e) || ["", ""])[1].toLowerCase()]) { e = w.htmlPrefilter(e); try { for (; n < r; n++)1 === (t = this[n] || {}).nodeType && (w.cleanData(ye(t, !1)), t.innerHTML = e); t = 0 } catch (e) { } } t && this.empty().append(e) }, null, e, arguments.length) }, replaceWith: function () { var e = []; return Pe(this, arguments, function (t) { var n = this.parentNode; w.inArray(this, e) < 0 && (w.cleanData(ye(this)), n && n.replaceChild(t, this)) }, e) } }), w.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (e, t) { w.fn[e] = function (e) { for (var n, r = [], i = w(e), o = i.length - 1, s = 0; s <= o; s++)n = s === o ? this : this.clone(!0), w(i[s])[t](n), a.apply(r, n.get()); return this.pushStack(r) } }); var Me = new RegExp("^(" + ee + ")(?!px)[a-z%]+$", "i"), Ie = function (t) { var n = t.ownerDocument.defaultView; return n && n.opener || (n = e), n.getComputedStyle(t) }, We = function (e, t, n) { var r, i, o = {}; for (i in t) o[i] = e.style[i], e.style[i] = t[i]; for (i in r = n.call(e), t) e.style[i] = o[i]; return r }, Fe = new RegExp(ne.join("|"), "i"); function Be(e, t, n) { var r, i, o, a, s = e.style; return (n = n || Ie(e)) && ("" !== (a = n.getPropertyValue(t) || n[t]) || ie(e) || (a = w.style(e, t)), !d.pixelBoxStyles() && Me.test(a) && Fe.test(t) && (r = s.width, i = s.minWidth, o = s.maxWidth, s.minWidth = s.maxWidth = s.width = a, a = n.width, s.width = r, s.minWidth = i, s.maxWidth = o)), void 0 !== a ? a + "" : a } function $e(e, t) { return { get: function () { if (!e()) return (this.get = t).apply(this, arguments); delete this.get } } } !function () { function t() { if (c) { l.style.cssText = "position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0", c.style.cssText = "position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%", re.appendChild(l).appendChild(c); var t = e.getComputedStyle(c); r = "1%" !== t.top, u = 12 === n(t.marginLeft), c.style.right = "60%", a = 36 === n(t.right), i = 36 === n(t.width), c.style.position = "absolute", o = 12 === n(c.offsetWidth / 3), re.removeChild(l), c = null } } function n(e) { return Math.round(parseFloat(e)) } var r, i, o, a, s, u, l = v.createElement("div"), c = v.createElement("div"); c.style && (c.style.backgroundClip = "content-box", c.cloneNode(!0).style.backgroundClip = "", d.clearCloneStyle = "content-box" === c.style.backgroundClip, w.extend(d, { boxSizingReliable: function () { return t(), i }, pixelBoxStyles: function () { return t(), a }, pixelPosition: function () { return t(), r }, reliableMarginLeft: function () { return t(), u }, scrollboxSize: function () { return t(), o }, reliableTrDimensions: function () { var t, n, r, i; return null == s && (t = v.createElement("table"), n = v.createElement("tr"), r = v.createElement("div"), t.style.cssText = "position:absolute;left:-11111px;border-collapse:separate", n.style.cssText = "border:1px solid", n.style.height = "1px", r.style.height = "9px", r.style.display = "block", re.appendChild(t).appendChild(n).appendChild(r), i = e.getComputedStyle(n), s = parseInt(i.height, 10) + parseInt(i.borderTopWidth, 10) + parseInt(i.borderBottomWidth, 10) === n.offsetHeight, re.removeChild(t)), s } })) }(); var _e = ["Webkit", "Moz", "ms"], ze = v.createElement("div").style, Ue = {}; function Xe(e) { var t = w.cssProps[e] || Ue[e]; return t || (e in ze ? e : Ue[e] = function (e) { for (var t = e[0].toUpperCase() + e.slice(1), n = _e.length; n--;)if ((e = _e[n] + t) in ze) return e }(e) || e) } var Ve = /^(none|table(?!-c[ea]).+)/, Ge = /^--/, Ye = { position: "absolute", visibility: "hidden", display: "block" }, Qe = { letterSpacing: "0", fontWeight: "400" }; function Je(e, t, n) { var r = te.exec(t); return r ? Math.max(0, r[2] - (n || 0)) + (r[3] || "px") : t } function Ke(e, t, n, r, i, o) { var a = "width" === t ? 1 : 0, s = 0, u = 0; if (n === (r ? "border" : "content")) return 0; for (; a < 4; a += 2)"margin" === n && (u += w.css(e, n + ne[a], !0, i)), r ? ("content" === n && (u -= w.css(e, "padding" + ne[a], !0, i)), "margin" !== n && (u -= w.css(e, "border" + ne[a] + "Width", !0, i))) : (u += w.css(e, "padding" + ne[a], !0, i), "padding" !== n ? u += w.css(e, "border" + ne[a] + "Width", !0, i) : s += w.css(e, "border" + ne[a] + "Width", !0, i)); return !r && o >= 0 && (u += Math.max(0, Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - o - u - s - .5)) || 0), u } function Ze(e, t, n) { var r = Ie(e), i = (!d.boxSizingReliable() || n) && "border-box" === w.css(e, "boxSizing", !1, r), o = i, a = Be(e, t, r), s = "offset" + t[0].toUpperCase() + t.slice(1); if (Me.test(a)) { if (!n) return a; a = "auto" } return (!d.boxSizingReliable() && i || !d.reliableTrDimensions() && A(e, "tr") || "auto" === a || !parseFloat(a) && "inline" === w.css(e, "display", !1, r)) && e.getClientRects().length && (i = "border-box" === w.css(e, "boxSizing", !1, r), (o = s in e) && (a = e[s])), (a = parseFloat(a) || 0) + Ke(e, t, n || (i ? "border" : "content"), o, r, a) + "px" } function et(e, t, n, r, i) { return new et.prototype.init(e, t, n, r, i) } w.extend({ cssHooks: { opacity: { get: function (e, t) { if (t) { var n = Be(e, "opacity"); return "" === n ? "1" : n } } } }, cssNumber: { animationIterationCount: !0, columnCount: !0, fillOpacity: !0, flexGrow: !0, flexShrink: !0, fontWeight: !0, gridArea: !0, gridColumn: !0, gridColumnEnd: !0, gridColumnStart: !0, gridRow: !0, gridRowEnd: !0, gridRowStart: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0 }, cssProps: {}, style: function (e, t, n, r) { if (e && 3 !== e.nodeType && 8 !== e.nodeType && e.style) { var i, o, a, s = X(t), u = Ge.test(t), l = e.style; if (u || (t = Xe(s)), a = w.cssHooks[t] || w.cssHooks[s], void 0 === n) return a && "get" in a && void 0 !== (i = a.get(e, !1, r)) ? i : l[t]; "string" === (o = typeof n) && (i = te.exec(n)) && i[1] && (n = se(e, t, i), o = "number"), null != n && n == n && ("number" !== o || u || (n += i && i[3] || (w.cssNumber[s] ? "" : "px")), d.clearCloneStyle || "" !== n || 0 !== t.indexOf("background") || (l[t] = "inherit"), a && "set" in a && void 0 === (n = a.set(e, n, r)) || (u ? l.setProperty(t, n) : l[t] = n)) } }, css: function (e, t, n, r) { var i, o, a, s = X(t); return Ge.test(t) || (t = Xe(s)), (a = w.cssHooks[t] || w.cssHooks[s]) && "get" in a && (i = a.get(e, !0, n)), void 0 === i && (i = Be(e, t, r)), "normal" === i && t in Qe && (i = Qe[t]), "" === n || n ? (o = parseFloat(i), !0 === n || isFinite(o) ? o || 0 : i) : i } }), w.each(["height", "width"], function (e, t) { w.cssHooks[t] = { get: function (e, n, r) { if (n) return !Ve.test(w.css(e, "display")) || e.getClientRects().length && e.getBoundingClientRect().width ? Ze(e, t, r) : We(e, Ye, function () { return Ze(e, t, r) }) }, set: function (e, n, r) { var i, o = Ie(e), a = !d.scrollboxSize() && "absolute" === o.position, s = (a || r) && "border-box" === w.css(e, "boxSizing", !1, o), u = r ? Ke(e, t, r, s, o) : 0; return s && a && (u -= Math.ceil(e["offset" + t[0].toUpperCase() + t.slice(1)] - parseFloat(o[t]) - Ke(e, t, "border", !1, o) - .5)), u && (i = te.exec(n)) && "px" !== (i[3] || "px") && (e.style[t] = n, n = w.css(e, t)), Je(0, n, u) } } }), w.cssHooks.marginLeft = $e(d.reliableMarginLeft, function (e, t) { if (t) return (parseFloat(Be(e, "marginLeft")) || e.getBoundingClientRect().left - We(e, { marginLeft: 0 }, function () { return e.getBoundingClientRect().left })) + "px" }), w.each({ margin: "", padding: "", border: "Width" }, function (e, t) { w.cssHooks[e + t] = { expand: function (n) { for (var r = 0, i = {}, o = "string" == typeof n ? n.split(" ") : [n]; r < 4; r++)i[e + ne[r] + t] = o[r] || o[r - 2] || o[0]; return i } }, "margin" !== e && (w.cssHooks[e + t].set = Je) }), w.fn.extend({ css: function (e, t) { return $(this, function (e, t, n) { var r, i, o = {}, a = 0; if (Array.isArray(t)) { for (r = Ie(e), i = t.length; a < i; a++)o[t[a]] = w.css(e, t[a], !1, r); return o } return void 0 !== n ? w.style(e, t, n) : w.css(e, t) }, e, t, arguments.length > 1) } }), w.Tween = et, et.prototype = { constructor: et, init: function (e, t, n, r, i, o) { this.elem = e, this.prop = n, this.easing = i || w.easing._default, this.options = t, this.start = this.now = this.cur(), this.end = r, this.unit = o || (w.cssNumber[n] ? "" : "px") }, cur: function () { var e = et.propHooks[this.prop]; return e && e.get ? e.get(this) : et.propHooks._default.get(this) }, run: function (e) { var t, n = et.propHooks[this.prop]; return this.options.duration ? this.pos = t = w.easing[this.easing](e, this.options.duration * e, 0, 1, this.options.duration) : this.pos = t = e, this.now = (this.end - this.start) * t + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), n && n.set ? n.set(this) : et.propHooks._default.set(this), this } }, et.prototype.init.prototype = et.prototype, et.propHooks = { _default: { get: function (e) { var t; return 1 !== e.elem.nodeType || null != e.elem[e.prop] && null == e.elem.style[e.prop] ? e.elem[e.prop] : (t = w.css(e.elem, e.prop, "")) && "auto" !== t ? t : 0 }, set: function (e) { w.fx.step[e.prop] ? w.fx.step[e.prop](e) : 1 !== e.elem.nodeType || !w.cssHooks[e.prop] && null == e.elem.style[Xe(e.prop)] ? e.elem[e.prop] = e.now : w.style(e.elem, e.prop, e.now + e.unit) } } }, et.propHooks.scrollTop = et.propHooks.scrollLeft = { set: function (e) { e.elem.nodeType && e.elem.parentNode && (e.elem[e.prop] = e.now) } }, w.easing = { linear: function (e) { return e }, swing: function (e) { return .5 - Math.cos(e * Math.PI) / 2 }, _default: "swing" }, w.fx = et.prototype.init, w.fx.step = {}; var tt, nt, rt = /^(?:toggle|show|hide)$/, it = /queueHooks$/; function ot() { nt && (!1 === v.hidden && e.requestAnimationFrame ? e.requestAnimationFrame(ot) : e.setTimeout(ot, w.fx.interval), w.fx.tick()) } function at() { return e.setTimeout(function () { tt = void 0 }), tt = Date.now() } function st(e, t) { var n, r = 0, i = { height: e }; for (t = t ? 1 : 0; r < 4; r += 2 - t)i["margin" + (n = ne[r])] = i["padding" + n] = e; return t && (i.opacity = i.width = e), i } function ut(e, t, n) { for (var r, i = (lt.tweeners[t] || []).concat(lt.tweeners["*"]), o = 0, a = i.length; o < a; o++)if (r = i[o].call(n, t, e)) return r } function lt(e, t, n) { var r, i, o = 0, a = lt.prefilters.length, s = w.Deferred().always(function () { delete u.elem }), u = function () { if (i) return !1; for (var t = tt || at(), n = Math.max(0, l.startTime + l.duration - t), r = 1 - (n / l.duration || 0), o = 0, a = l.tweens.length; o < a; o++)l.tweens[o].run(r); return s.notifyWith(e, [l, r, n]), r < 1 && a ? n : (a || s.notifyWith(e, [l, 1, 0]), s.resolveWith(e, [l]), !1) }, l = s.promise({ elem: e, props: w.extend({}, t), opts: w.extend(!0, { specialEasing: {}, easing: w.easing._default }, n), originalProperties: t, originalOptions: n, startTime: tt || at(), duration: n.duration, tweens: [], createTween: function (t, n) { var r = w.Tween(e, l.opts, t, n, l.opts.specialEasing[t] || l.opts.easing); return l.tweens.push(r), r }, stop: function (t) { var n = 0, r = t ? l.tweens.length : 0; if (i) return this; for (i = !0; n < r; n++)l.tweens[n].run(1); return t ? (s.notifyWith(e, [l, 1, 0]), s.resolveWith(e, [l, t])) : s.rejectWith(e, [l, t]), this } }), c = l.props; for (!function (e, t) { var n, r, i, o, a; for (n in e) if (i = t[r = X(n)], o = e[n], Array.isArray(o) && (i = o[1], o = e[n] = o[0]), n !== r && (e[r] = o, delete e[n]), (a = w.cssHooks[r]) && "expand" in a) for (n in o = a.expand(o), delete e[r], o) n in e || (e[n] = o[n], t[n] = i); else t[r] = i }(c, l.opts.specialEasing); o < a; o++)if (r = lt.prefilters[o].call(l, e, c, l.opts)) return h(r.stop) && (w._queueHooks(l.elem, l.opts.queue).stop = r.stop.bind(r)), r; return w.map(c, ut, l), h(l.opts.start) && l.opts.start.call(e, l), l.progress(l.opts.progress).done(l.opts.done, l.opts.complete).fail(l.opts.fail).always(l.opts.always), w.fx.timer(w.extend(u, { elem: e, anim: l, queue: l.opts.queue })), l } w.Animation = w.extend(lt, { tweeners: { "*": [function (e, t) { var n = this.createTween(e, t); return se(n.elem, e, te.exec(t), n), n }] }, tweener: function (e, t) { h(e) ? (t = e, e = ["*"]) : e = e.match(P); for (var n, r = 0, i = e.length; r < i; r++)n = e[r], lt.tweeners[n] = lt.tweeners[n] || [], lt.tweeners[n].unshift(t) }, prefilters: [function (e, t, n) { var r, i, o, a, s, u, l, c, f = "width" in t || "height" in t, p = this, d = {}, h = e.style, g = e.nodeType && ae(e), v = Y.get(e, "fxshow"); for (r in n.queue || (null == (a = w._queueHooks(e, "fx")).unqueued && (a.unqueued = 0, s = a.empty.fire, a.empty.fire = function () { a.unqueued || s() }), a.unqueued++, p.always(function () { p.always(function () { a.unqueued--, w.queue(e, "fx").length || a.empty.fire() }) })), t) if (i = t[r], rt.test(i)) { if (delete t[r], o = o || "toggle" === i, i === (g ? "hide" : "show")) { if ("show" !== i || !v || void 0 === v[r]) continue; g = !0 } d[r] = v && v[r] || w.style(e, r) } if ((u = !w.isEmptyObject(t)) || !w.isEmptyObject(d)) for (r in f && 1 === e.nodeType && (n.overflow = [h.overflow, h.overflowX, h.overflowY], null == (l = v && v.display) && (l = Y.get(e, "display")), "none" === (c = w.css(e, "display")) && (l ? c = l : (ce([e], !0), l = e.style.display || l, c = w.css(e, "display"), ce([e]))), ("inline" === c || "inline-block" === c && null != l) && "none" === w.css(e, "float") && (u || (p.done(function () { h.display = l }), null == l && (c = h.display, l = "none" === c ? "" : c)), h.display = "inline-block")), n.overflow && (h.overflow = "hidden", p.always(function () { h.overflow = n.overflow[0], h.overflowX = n.overflow[1], h.overflowY = n.overflow[2] })), u = !1, d) u || (v ? "hidden" in v && (g = v.hidden) : v = Y.access(e, "fxshow", { display: l }), o && (v.hidden = !g), g && ce([e], !0), p.done(function () { for (r in g || ce([e]), Y.remove(e, "fxshow"), d) w.style(e, r, d[r]) })), u = ut(g ? v[r] : 0, r, p), r in v || (v[r] = u.start, g && (u.end = u.start, u.start = 0)) }], prefilter: function (e, t) { t ? lt.prefilters.unshift(e) : lt.prefilters.push(e) } }), w.speed = function (e, t, n) { var r = e && "object" == typeof e ? w.extend({}, e) : { complete: n || !n && t || h(e) && e, duration: e, easing: n && t || t && !h(t) && t }; return w.fx.off ? r.duration = 0 : "number" != typeof r.duration && (r.duration in w.fx.speeds ? r.duration = w.fx.speeds[r.duration] : r.duration = w.fx.speeds._default), null != r.queue && !0 !== r.queue || (r.queue = "fx"), r.old = r.complete, r.complete = function () { h(r.old) && r.old.call(this), r.queue && w.dequeue(this, r.queue) }, r }, w.fn.extend({ fadeTo: function (e, t, n, r) { return this.filter(ae).css("opacity", 0).show().end().animate({ opacity: t }, e, n, r) }, animate: function (e, t, n, r) { var i = w.isEmptyObject(e), o = w.speed(t, n, r), a = function () { var t = lt(this, w.extend({}, e), o); (i || Y.get(this, "finish")) && t.stop(!0) }; return a.finish = a, i || !1 === o.queue ? this.each(a) : this.queue(o.queue, a) }, stop: function (e, t, n) { var r = function (e) { var t = e.stop; delete e.stop, t(n) }; return "string" != typeof e && (n = t, t = e, e = void 0), t && this.queue(e || "fx", []), this.each(function () { var t = !0, i = null != e && e + "queueHooks", o = w.timers, a = Y.get(this); if (i) a[i] && a[i].stop && r(a[i]); else for (i in a) a[i] && a[i].stop && it.test(i) && r(a[i]); for (i = o.length; i--;)o[i].elem !== this || null != e && o[i].queue !== e || (o[i].anim.stop(n), t = !1, o.splice(i, 1)); !t && n || w.dequeue(this, e) }) }, finish: function (e) { return !1 !== e && (e = e || "fx"), this.each(function () { var t, n = Y.get(this), r = n[e + "queue"], i = n[e + "queueHooks"], o = w.timers, a = r ? r.length : 0; for (n.finish = !0, w.queue(this, e, []), i && i.stop && i.stop.call(this, !0), t = o.length; t--;)o[t].elem === this && o[t].queue === e && (o[t].anim.stop(!0), o.splice(t, 1)); for (t = 0; t < a; t++)r[t] && r[t].finish && r[t].finish.call(this); delete n.finish }) } }), w.each(["toggle", "show", "hide"], function (e, t) { var n = w.fn[t]; w.fn[t] = function (e, r, i) { return null == e || "boolean" == typeof e ? n.apply(this, arguments) : this.animate(st(t, !0), e, r, i) } }), w.each({ slideDown: st("show"), slideUp: st("hide"), slideToggle: st("toggle"), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } }, function (e, t) { w.fn[e] = function (e, n, r) { return this.animate(t, e, n, r) } }), w.timers = [], w.fx.tick = function () { var e, t = 0, n = w.timers; for (tt = Date.now(); t < n.length; t++)(e = n[t])() || n[t] !== e || n.splice(t--, 1); n.length || w.fx.stop(), tt = void 0 }, w.fx.timer = function (e) { w.timers.push(e), w.fx.start() }, w.fx.interval = 13, w.fx.start = function () { nt || (nt = !0, ot()) }, w.fx.stop = function () { nt = null }, w.fx.speeds = { slow: 600, fast: 200, _default: 400 }, w.fn.delay = function (t, n) { return t = w.fx && w.fx.speeds[t] || t, n = n || "fx", this.queue(n, function (n, r) { var i = e.setTimeout(n, t); r.stop = function () { e.clearTimeout(i) } }) }, function () { var e = v.createElement("input"), t = v.createElement("select").appendChild(v.createElement("option")); e.type = "checkbox", d.checkOn = "" !== e.value, d.optSelected = t.selected, (e = v.createElement("input")).value = "t", e.type = "radio", d.radioValue = "t" === e.value }(); var ct, ft = w.expr.attrHandle; w.fn.extend({ attr: function (e, t) { return $(this, w.attr, e, t, arguments.length > 1) }, removeAttr: function (e) { return this.each(function () { w.removeAttr(this, e) }) } }), w.extend({ attr: function (e, t, n) { var r, i, o = e.nodeType; if (3 !== o && 8 !== o && 2 !== o) return void 0 === e.getAttribute ? w.prop(e, t, n) : (1 === o && w.isXMLDoc(e) || (i = w.attrHooks[t.toLowerCase()] || (w.expr.match.bool.test(t) ? ct : void 0)), void 0 !== n ? null === n ? void w.removeAttr(e, t) : i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : (e.setAttribute(t, n + ""), n) : i && "get" in i && null !== (r = i.get(e, t)) ? r : null == (r = w.find.attr(e, t)) ? void 0 : r) }, attrHooks: { type: { set: function (e, t) { if (!d.radioValue && "radio" === t && A(e, "input")) { var n = e.value; return e.setAttribute("type", t), n && (e.value = n), t } } } }, removeAttr: function (e, t) { var n, r = 0, i = t && t.match(P); if (i && 1 === e.nodeType) for (; n = i[r++];)e.removeAttribute(n) } }), ct = { set: function (e, t, n) { return !1 === t ? w.removeAttr(e, n) : e.setAttribute(n, n), n } }, w.each(w.expr.match.bool.source.match(/\w+/g), function (e, t) { var n = ft[t] || w.find.attr; ft[t] = function (e, t, r) { var i, o, a = t.toLowerCase(); return r || (o = ft[a], ft[a] = i, i = null != n(e, t, r) ? a : null, ft[a] = o), i } }); var pt = /^(?:input|select|textarea|button)$/i, dt = /^(?:a|area)$/i; function ht(e) { return (e.match(P) || []).join(" ") } function gt(e) { return e.getAttribute && e.getAttribute("class") || "" } function vt(e) { return Array.isArray(e) ? e : "string" == typeof e && e.match(P) || [] } w.fn.extend({ prop: function (e, t) { return $(this, w.prop, e, t, arguments.length > 1) }, removeProp: function (e) { return this.each(function () { delete this[w.propFix[e] || e] }) } }), w.extend({ prop: function (e, t, n) { var r, i, o = e.nodeType; if (3 !== o && 8 !== o && 2 !== o) return 1 === o && w.isXMLDoc(e) || (t = w.propFix[t] || t, i = w.propHooks[t]), void 0 !== n ? i && "set" in i && void 0 !== (r = i.set(e, n, t)) ? r : e[t] = n : i && "get" in i && null !== (r = i.get(e, t)) ? r : e[t] }, propHooks: { tabIndex: { get: function (e) { var t = w.find.attr(e, "tabindex"); return t ? parseInt(t, 10) : pt.test(e.nodeName) || dt.test(e.nodeName) && e.href ? 0 : -1 } } }, propFix: { for: "htmlFor", class: "className" } }), d.optSelected || (w.propHooks.selected = { get: function (e) { var t = e.parentNode; return t && t.parentNode && t.parentNode.selectedIndex, null }, set: function (e) { var t = e.parentNode; t && (t.selectedIndex, t.parentNode && t.parentNode.selectedIndex) } }), w.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () { w.propFix[this.toLowerCase()] = this }), w.fn.extend({ addClass: function (e) { var t, n, r, i, o, a, s, u = 0; if (h(e)) return this.each(function (t) { w(this).addClass(e.call(this, t, gt(this))) }); if ((t = vt(e)).length) for (; n = this[u++];)if (i = gt(n), r = 1 === n.nodeType && " " + ht(i) + " ") { for (a = 0; o = t[a++];)r.indexOf(" " + o + " ") < 0 && (r += o + " "); i !== (s = ht(r)) && n.setAttribute("class", s) } return this }, removeClass: function (e) { var t, n, r, i, o, a, s, u = 0; if (h(e)) return this.each(function (t) { w(this).removeClass(e.call(this, t, gt(this))) }); if (!arguments.length) return this.attr("class", ""); if ((t = vt(e)).length) for (; n = this[u++];)if (i = gt(n), r = 1 === n.nodeType && " " + ht(i) + " ") { for (a = 0; o = t[a++];)for (; r.indexOf(" " + o + " ") > -1;)r = r.replace(" " + o + " ", " "); i !== (s = ht(r)) && n.setAttribute("class", s) } return this }, toggleClass: function (e, t) { var n = typeof e, r = "string" === n || Array.isArray(e); return "boolean" == typeof t && r ? t ? this.addClass(e) : this.removeClass(e) : h(e) ? this.each(function (n) { w(this).toggleClass(e.call(this, n, gt(this), t), t) }) : this.each(function () { var t, i, o, a; if (r) for (i = 0, o = w(this), a = vt(e); t = a[i++];)o.hasClass(t) ? o.removeClass(t) : o.addClass(t); else void 0 !== e && "boolean" !== n || ((t = gt(this)) && Y.set(this, "__className__", t), this.setAttribute && this.setAttribute("class", t || !1 === e ? "" : Y.get(this, "__className__") || "")) }) }, hasClass: function (e) { var t, n, r = 0; for (t = " " + e + " "; n = this[r++];)if (1 === n.nodeType && (" " + ht(gt(n)) + " ").indexOf(t) > -1) return !0; return !1 } }); var yt = /\r/g; w.fn.extend({ val: function (e) { var t, n, r, i = this[0]; return arguments.length ? (r = h(e), this.each(function (n) { var i; 1 === this.nodeType && (null == (i = r ? e.call(this, n, w(this).val()) : e) ? i = "" : "number" == typeof i ? i += "" : Array.isArray(i) && (i = w.map(i, function (e) { return null == e ? "" : e + "" })), (t = w.valHooks[this.type] || w.valHooks[this.nodeName.toLowerCase()]) && "set" in t && void 0 !== t.set(this, i, "value") || (this.value = i)) })) : i ? (t = w.valHooks[i.type] || w.valHooks[i.nodeName.toLowerCase()]) && "get" in t && void 0 !== (n = t.get(i, "value")) ? n : "string" == typeof (n = i.value) ? n.replace(yt, "") : null == n ? "" : n : void 0 } }), w.extend({ valHooks: { option: { get: function (e) { var t = w.find.attr(e, "value"); return null != t ? t : ht(w.text(e)) } }, select: { get: function (e) { var t, n, r, i = e.options, o = e.selectedIndex, a = "select-one" === e.type, s = a ? null : [], u = a ? o + 1 : i.length; for (r = o < 0 ? u : a ? o : 0; r < u; r++)if (((n = i[r]).selected || r === o) && !n.disabled && (!n.parentNode.disabled || !A(n.parentNode, "optgroup"))) { if (t = w(n).val(), a) return t; s.push(t) } return s }, set: function (e, t) { for (var n, r, i = e.options, o = w.makeArray(t), a = i.length; a--;)((r = i[a]).selected = w.inArray(w.valHooks.option.get(r), o) > -1) && (n = !0); return n || (e.selectedIndex = -1), o } } } }), w.each(["radio", "checkbox"], function () { w.valHooks[this] = { set: function (e, t) { if (Array.isArray(t)) return e.checked = w.inArray(w(e).val(), t) > -1 } }, d.checkOn || (w.valHooks[this].get = function (e) { return null === e.getAttribute("value") ? "on" : e.value }) }), d.focusin = "onfocusin" in e; var mt = /^(?:focusinfocus|focusoutblur)$/, xt = function (e) { e.stopPropagation() }; w.extend(w.event, { trigger: function (t, n, r, i) { var o, a, s, u, l, f, p, d, y = [r || v], m = c.call(t, "type") ? t.type : t, x = c.call(t, "namespace") ? t.namespace.split(".") : []; if (a = d = s = r = r || v, 3 !== r.nodeType && 8 !== r.nodeType && !mt.test(m + w.event.triggered) && (m.indexOf(".") > -1 && (x = m.split("."), m = x.shift(), x.sort()), l = m.indexOf(":") < 0 && "on" + m, (t = t[w.expando] ? t : new w.Event(m, "object" == typeof t && t)).isTrigger = i ? 2 : 3, t.namespace = x.join("."), t.rnamespace = t.namespace ? new RegExp("(^|\\.)" + x.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, t.result = void 0, t.target || (t.target = r), n = null == n ? [t] : w.makeArray(n, [t]), p = w.event.special[m] || {}, i || !p.trigger || !1 !== p.trigger.apply(r, n))) { if (!i && !p.noBubble && !g(r)) { for (u = p.delegateType || m, mt.test(u + m) || (a = a.parentNode); a; a = a.parentNode)y.push(a), s = a; s === (r.ownerDocument || v) && y.push(s.defaultView || s.parentWindow || e) } for (o = 0; (a = y[o++]) && !t.isPropagationStopped();)d = a, t.type = o > 1 ? u : p.bindType || m, (f = (Y.get(a, "events") || Object.create(null))[t.type] && Y.get(a, "handle")) && f.apply(a, n), (f = l && a[l]) && f.apply && V(a) && (t.result = f.apply(a, n), !1 === t.result && t.preventDefault()); return t.type = m, i || t.isDefaultPrevented() || p._default && !1 !== p._default.apply(y.pop(), n) || !V(r) || l && h(r[m]) && !g(r) && ((s = r[l]) && (r[l] = null), w.event.triggered = m, t.isPropagationStopped() && d.addEventListener(m, xt), r[m](), t.isPropagationStopped() && d.removeEventListener(m, xt), w.event.triggered = void 0, s && (r[l] = s)), t.result } }, simulate: function (e, t, n) { var r = w.extend(new w.Event, n, { type: e, isSimulated: !0 }); w.event.trigger(r, null, t) } }), w.fn.extend({ trigger: function (e, t) { return this.each(function () { w.event.trigger(e, t, this) }) }, triggerHandler: function (e, t) { var n = this[0]; if (n) return w.event.trigger(e, t, n, !0) } }), d.focusin || w.each({ focus: "focusin", blur: "focusout" }, function (e, t) { var n = function (e) { w.event.simulate(t, e.target, w.event.fix(e)) }; w.event.special[t] = { setup: function () { var r = this.ownerDocument || this.document || this, i = Y.access(r, t); i || r.addEventListener(e, n, !0), Y.access(r, t, (i || 0) + 1) }, teardown: function () { var r = this.ownerDocument || this.document || this, i = Y.access(r, t) - 1; i ? Y.access(r, t, i) : (r.removeEventListener(e, n, !0), Y.remove(r, t)) } } }); var bt = e.location, wt = { guid: Date.now() }, Tt = /\?/; w.parseXML = function (t) { var n, r; if (!t || "string" != typeof t) return null; try { n = (new e.DOMParser).parseFromString(t, "text/xml") } catch (e) { } return r = n && n.getElementsByTagName("parsererror")[0], n && !r || w.error("Invalid XML: " + (r ? w.map(r.childNodes, function (e) { return e.textContent }).join("\n") : t)), n }; var Ct = /\[\]$/, Et = /\r?\n/g, St = /^(?:submit|button|image|reset|file)$/i, kt = /^(?:input|select|textarea|keygen)/i; function At(e, t, n, r) { var i; if (Array.isArray(t)) w.each(t, function (t, i) { n || Ct.test(e) ? r(e, i) : At(e + "[" + ("object" == typeof i && null != i ? t : "") + "]", i, n, r) }); else if (n || "object" !== x(t)) r(e, t); else for (i in t) At(e + "[" + i + "]", t[i], n, r) } w.param = function (e, t) { var n, r = [], i = function (e, t) { var n = h(t) ? t() : t; r[r.length] = encodeURIComponent(e) + "=" + encodeURIComponent(null == n ? "" : n) }; if (null == e) return ""; if (Array.isArray(e) || e.jquery && !w.isPlainObject(e)) w.each(e, function () { i(this.name, this.value) }); else for (n in e) At(n, e[n], t, i); return r.join("&") }, w.fn.extend({ serialize: function () { return w.param(this.serializeArray()) }, serializeArray: function () { return this.map(function () { var e = w.prop(this, "elements"); return e ? w.makeArray(e) : this }).filter(function () { var e = this.type; return this.name && !w(this).is(":disabled") && kt.test(this.nodeName) && !St.test(e) && (this.checked || !de.test(e)) }).map(function (e, t) { var n = w(this).val(); return null == n ? null : Array.isArray(n) ? w.map(n, function (e) { return { name: t.name, value: e.replace(Et, "\r\n") } }) : { name: t.name, value: n.replace(Et, "\r\n") } }).get() } }); var Nt = /%20/g, jt = /#.*$/, Dt = /([?&])_=[^&]*/, qt = /^(.*?):[ \t]*([^\r\n]*)$/gm, Lt = /^(?:GET|HEAD)$/, Ht = /^\/\//, Ot = {}, Pt = {}, Rt = "*/".concat("*"), Mt = v.createElement("a"); function It(e) { return function (t, n) { "string" != typeof t && (n = t, t = "*"); var r, i = 0, o = t.toLowerCase().match(P) || []; if (h(n)) for (; r = o[i++];)"+" === r[0] ? (r = r.slice(1) || "*", (e[r] = e[r] || []).unshift(n)) : (e[r] = e[r] || []).push(n) } } function Wt(e, t, n, r) { var i = {}, o = e === Pt; function a(s) { var u; return i[s] = !0, w.each(e[s] || [], function (e, s) { var l = s(t, n, r); return "string" != typeof l || o || i[l] ? o ? !(u = l) : void 0 : (t.dataTypes.unshift(l), a(l), !1) }), u } return a(t.dataTypes[0]) || !i["*"] && a("*") } function Ft(e, t) { var n, r, i = w.ajaxSettings.flatOptions || {}; for (n in t) void 0 !== t[n] && ((i[n] ? e : r || (r = {}))[n] = t[n]); return r && w.extend(!0, e, r), e } Mt.href = bt.href, w.extend({ active: 0, lastModified: {}, etag: {}, ajaxSettings: { url: bt.href, type: "GET", isLocal: /^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(bt.protocol), global: !0, processData: !0, async: !0, contentType: "application/x-www-form-urlencoded; charset=UTF-8", accepts: { "*": Rt, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript" }, contents: { xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/ }, responseFields: { xml: "responseXML", text: "responseText", json: "responseJSON" }, converters: { "* text": String, "text html": !0, "text json": JSON.parse, "text xml": w.parseXML }, flatOptions: { url: !0, context: !0 } }, ajaxSetup: function (e, t) { return t ? Ft(Ft(e, w.ajaxSettings), t) : Ft(w.ajaxSettings, e) }, ajaxPrefilter: It(Ot), ajaxTransport: It(Pt), ajax: function (t, n) { "object" == typeof t && (n = t, t = void 0), n = n || {}; var r, i, o, a, s, u, l, c, f, p, d = w.ajaxSetup({}, n), h = d.context || d, g = d.context && (h.nodeType || h.jquery) ? w(h) : w.event, y = w.Deferred(), m = w.Callbacks("once memory"), x = d.statusCode || {}, b = {}, T = {}, C = "canceled", E = { readyState: 0, getResponseHeader: function (e) { var t; if (l) { if (!a) for (a = {}; t = qt.exec(o);)a[t[1].toLowerCase() + " "] = (a[t[1].toLowerCase() + " "] || []).concat(t[2]); t = a[e.toLowerCase() + " "] } return null == t ? null : t.join(", ") }, getAllResponseHeaders: function () { return l ? o : null }, setRequestHeader: function (e, t) { return null == l && (e = T[e.toLowerCase()] = T[e.toLowerCase()] || e, b[e] = t), this }, overrideMimeType: function (e) { return null == l && (d.mimeType = e), this }, statusCode: function (e) { var t; if (e) if (l) E.always(e[E.status]); else for (t in e) x[t] = [x[t], e[t]]; return this }, abort: function (e) { var t = e || C; return r && r.abort(t), S(0, t), this } }; if (y.promise(E), d.url = ((t || d.url || bt.href) + "").replace(Ht, bt.protocol + "//"), d.type = n.method || n.type || d.method || d.type, d.dataTypes = (d.dataType || "*").toLowerCase().match(P) || [""], null == d.crossDomain) { u = v.createElement("a"); try { u.href = d.url, u.href = u.href, d.crossDomain = Mt.protocol + "//" + Mt.host != u.protocol + "//" + u.host } catch (e) { d.crossDomain = !0 } } if (d.data && d.processData && "string" != typeof d.data && (d.data = w.param(d.data, d.traditional)), Wt(Ot, d, n, E), l) return E; for (f in (c = w.event && d.global) && 0 == w.active++ && w.event.trigger("ajaxStart"), d.type = d.type.toUpperCase(), d.hasContent = !Lt.test(d.type), i = d.url.replace(jt, ""), d.hasContent ? d.data && d.processData && 0 === (d.contentType || "").indexOf("application/x-www-form-urlencoded") && (d.data = d.data.replace(Nt, "+")) : (p = d.url.slice(i.length), d.data && (d.processData || "string" == typeof d.data) && (i += (Tt.test(i) ? "&" : "?") + d.data, delete d.data), !1 === d.cache && (i = i.replace(Dt, "$1"), p = (Tt.test(i) ? "&" : "?") + "_=" + wt.guid++ + p), d.url = i + p), d.ifModified && (w.lastModified[i] && E.setRequestHeader("If-Modified-Since", w.lastModified[i]), w.etag[i] && E.setRequestHeader("If-None-Match", w.etag[i])), (d.data && d.hasContent && !1 !== d.contentType || n.contentType) && E.setRequestHeader("Content-Type", d.contentType), E.setRequestHeader("Accept", d.dataTypes[0] && d.accepts[d.dataTypes[0]] ? d.accepts[d.dataTypes[0]] + ("*" !== d.dataTypes[0] ? ", " + Rt + "; q=0.01" : "") : d.accepts["*"]), d.headers) E.setRequestHeader(f, d.headers[f]); if (d.beforeSend && (!1 === d.beforeSend.call(h, E, d) || l)) return E.abort(); if (C = "abort", m.add(d.complete), E.done(d.success), E.fail(d.error), r = Wt(Pt, d, n, E)) { if (E.readyState = 1, c && g.trigger("ajaxSend", [E, d]), l) return E; d.async && d.timeout > 0 && (s = e.setTimeout(function () { E.abort("timeout") }, d.timeout)); try { l = !1, r.send(b, S) } catch (e) { if (l) throw e; S(-1, e) } } else S(-1, "No Transport"); function S(t, n, a, u) { var f, p, v, b, T, C = n; l || (l = !0, s && e.clearTimeout(s), r = void 0, o = u || "", E.readyState = t > 0 ? 4 : 0, f = t >= 200 && t < 300 || 304 === t, a && (b = function (e, t, n) { for (var r, i, o, a, s = e.contents, u = e.dataTypes; "*" === u[0];)u.shift(), void 0 === r && (r = e.mimeType || t.getResponseHeader("Content-Type")); if (r) for (i in s) if (s[i] && s[i].test(r)) { u.unshift(i); break } if (u[0] in n) o = u[0]; else { for (i in n) { if (!u[0] || e.converters[i + " " + u[0]]) { o = i; break } a || (a = i) } o = o || a } if (o) return o !== u[0] && u.unshift(o), n[o] }(d, E, a)), !f && w.inArray("script", d.dataTypes) > -1 && w.inArray("json", d.dataTypes) < 0 && (d.converters["text script"] = function () { }), b = function (e, t, n, r) { var i, o, a, s, u, l = {}, c = e.dataTypes.slice(); if (c[1]) for (a in e.converters) l[a.toLowerCase()] = e.converters[a]; for (o = c.shift(); o;)if (e.responseFields[o] && (n[e.responseFields[o]] = t), !u && r && e.dataFilter && (t = e.dataFilter(t, e.dataType)), u = o, o = c.shift()) if ("*" === o) o = u; else if ("*" !== u && u !== o) { if (!(a = l[u + " " + o] || l["* " + o])) for (i in l) if ((s = i.split(" "))[1] === o && (a = l[u + " " + s[0]] || l["* " + s[0]])) { !0 === a ? a = l[i] : !0 !== l[i] && (o = s[0], c.unshift(s[1])); break } if (!0 !== a) if (a && e.throws) t = a(t); else try { t = a(t) } catch (e) { return { state: "parsererror", error: a ? e : "No conversion from " + u + " to " + o } } } return { state: "success", data: t } }(d, b, E, f), f ? (d.ifModified && ((T = E.getResponseHeader("Last-Modified")) && (w.lastModified[i] = T), (T = E.getResponseHeader("etag")) && (w.etag[i] = T)), 204 === t || "HEAD" === d.type ? C = "nocontent" : 304 === t ? C = "notmodified" : (C = b.state, p = b.data, f = !(v = b.error))) : (v = C, !t && C || (C = "error", t < 0 && (t = 0))), E.status = t, E.statusText = (n || C) + "", f ? y.resolveWith(h, [p, C, E]) : y.rejectWith(h, [E, C, v]), E.statusCode(x), x = void 0, c && g.trigger(f ? "ajaxSuccess" : "ajaxError", [E, d, f ? p : v]), m.fireWith(h, [E, C]), c && (g.trigger("ajaxComplete", [E, d]), --w.active || w.event.trigger("ajaxStop"))) } return E }, getJSON: function (e, t, n) { return w.get(e, t, n, "json") }, getScript: function (e, t) { return w.get(e, void 0, t, "script") } }), w.each(["get", "post"], function (e, t) { w[t] = function (e, n, r, i) { return h(n) && (i = i || r, r = n, n = void 0), w.ajax(w.extend({ url: e, type: t, dataType: i, data: n, success: r }, w.isPlainObject(e) && e)) } }), w.ajaxPrefilter(function (e) { var t; for (t in e.headers) "content-type" === t.toLowerCase() && (e.contentType = e.headers[t] || "") }), w._evalUrl = function (e, t, n) { return w.ajax({ url: e, type: "GET", dataType: "script", cache: !0, async: !1, global: !1, converters: { "text script": function () { } }, dataFilter: function (e) { w.globalEval(e, t, n) } }) }, w.fn.extend({ wrapAll: function (e) { var t; return this[0] && (h(e) && (e = e.call(this[0])), t = w(e, this[0].ownerDocument).eq(0).clone(!0), this[0].parentNode && t.insertBefore(this[0]), t.map(function () { for (var e = this; e.firstElementChild;)e = e.firstElementChild; return e }).append(this)), this }, wrapInner: function (e) { return h(e) ? this.each(function (t) { w(this).wrapInner(e.call(this, t)) }) : this.each(function () { var t = w(this), n = t.contents(); n.length ? n.wrapAll(e) : t.append(e) }) }, wrap: function (e) { var t = h(e); return this.each(function (n) { w(this).wrapAll(t ? e.call(this, n) : e) }) }, unwrap: function (e) { return this.parent(e).not("body").each(function () { w(this).replaceWith(this.childNodes) }), this } }), w.expr.pseudos.hidden = function (e) { return !w.expr.pseudos.visible(e) }, w.expr.pseudos.visible = function (e) { return !!(e.offsetWidth || e.offsetHeight || e.getClientRects().length) }, w.ajaxSettings.xhr = function () { try { return new e.XMLHttpRequest } catch (e) { } }; var Bt = { 0: 200, 1223: 204 }, $t = w.ajaxSettings.xhr(); d.cors = !!$t && "withCredentials" in $t, d.ajax = $t = !!$t, w.ajaxTransport(function (t) { var n, r; if (d.cors || $t && !t.crossDomain) return { send: function (i, o) { var a, s = t.xhr(); if (s.open(t.type, t.url, t.async, t.username, t.password), t.xhrFields) for (a in t.xhrFields) s[a] = t.xhrFields[a]; for (a in t.mimeType && s.overrideMimeType && s.overrideMimeType(t.mimeType), t.crossDomain || i["X-Requested-With"] || (i["X-Requested-With"] = "XMLHttpRequest"), i) s.setRequestHeader(a, i[a]); n = function (e) { return function () { n && (n = r = s.onload = s.onerror = s.onabort = s.ontimeout = s.onreadystatechange = null, "abort" === e ? s.abort() : "error" === e ? "number" != typeof s.status ? o(0, "error") : o(s.status, s.statusText) : o(Bt[s.status] || s.status, s.statusText, "text" !== (s.responseType || "text") || "string" != typeof s.responseText ? { binary: s.response } : { text: s.responseText }, s.getAllResponseHeaders())) } }, s.onload = n(), r = s.onerror = s.ontimeout = n("error"), void 0 !== s.onabort ? s.onabort = r : s.onreadystatechange = function () { 4 === s.readyState && e.setTimeout(function () { n && r() }) }, n = n("abort"); try { s.send(t.hasContent && t.data || null) } catch (e) { if (n) throw e } }, abort: function () { n && n() } } }), w.ajaxPrefilter(function (e) { e.crossDomain && (e.contents.script = !1) }), w.ajaxSetup({ accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" }, contents: { script: /\b(?:java|ecma)script\b/ }, converters: { "text script": function (e) { return w.globalEval(e), e } } }), w.ajaxPrefilter("script", function (e) { void 0 === e.cache && (e.cache = !1), e.crossDomain && (e.type = "GET") }), w.ajaxTransport("script", function (e) { var t, n; if (e.crossDomain || e.scriptAttrs) return { send: function (r, i) { t = w("<script>").attr(e.scriptAttrs || {}).prop({ charset: e.scriptCharset, src: e.url }).on("load error", n = function (e) { t.remove(), n = null, e && i("error" === e.type ? 404 : 200, e.type) }), v.head.appendChild(t[0]) }, abort: function () { n && n() } } }); var _t, zt = [], Ut = /(=)\?(?=&|$)|\?\?/; w.ajaxSetup({ jsonp: "callback", jsonpCallback: function () { var e = zt.pop() || w.expando + "_" + wt.guid++; return this[e] = !0, e } }), w.ajaxPrefilter("json jsonp", function (t, n, r) { var i, o, a, s = !1 !== t.jsonp && (Ut.test(t.url) ? "url" : "string" == typeof t.data && 0 === (t.contentType || "").indexOf("application/x-www-form-urlencoded") && Ut.test(t.data) && "data"); if (s || "jsonp" === t.dataTypes[0]) return i = t.jsonpCallback = h(t.jsonpCallback) ? t.jsonpCallback() : t.jsonpCallback, s ? t[s] = t[s].replace(Ut, "$1" + i) : !1 !== t.jsonp && (t.url += (Tt.test(t.url) ? "&" : "?") + t.jsonp + "=" + i), t.converters["script json"] = function () { return a || w.error(i + " was not called"), a[0] }, t.dataTypes[0] = "json", o = e[i], e[i] = function () { a = arguments }, r.always(function () { void 0 === o ? w(e).removeProp(i) : e[i] = o, t[i] && (t.jsonpCallback = n.jsonpCallback, zt.push(i)), a && h(o) && o(a[0]), a = o = void 0 }), "script" }), d.createHTMLDocument = ((_t = v.implementation.createHTMLDocument("").body).innerHTML = "<form></form><form></form>", 2 === _t.childNodes.length), w.parseHTML = function (e, t, n) { return "string" != typeof e ? [] : ("boolean" == typeof t && (n = t, t = !1), t || (d.createHTMLDocument ? ((r = (t = v.implementation.createHTMLDocument("")).createElement("base")).href = v.location.href, t.head.appendChild(r)) : t = v), o = !n && [], (i = N.exec(e)) ? [t.createElement(i[1])] : (i = be([e], t, o), o && o.length && w(o).remove(), w.merge([], i.childNodes))); var r, i, o }, w.fn.load = function (e, t, n) { var r, i, o, a = this, s = e.indexOf(" "); return s > -1 && (r = ht(e.slice(s)), e = e.slice(0, s)), h(t) ? (n = t, t = void 0) : t && "object" == typeof t && (i = "POST"), a.length > 0 && w.ajax({ url: e, type: i || "GET", dataType: "html", data: t }).done(function (e) { o = arguments, a.html(r ? w("<div>").append(w.parseHTML(e)).find(r) : e) }).always(n && function (e, t) { a.each(function () { n.apply(this, o || [e.responseText, t, e]) }) }), this }, w.expr.pseudos.animated = function (e) { return w.grep(w.timers, function (t) { return e === t.elem }).length }, w.offset = { setOffset: function (e, t, n) { var r, i, o, a, s, u, l = w.css(e, "position"), c = w(e), f = {}; "static" === l && (e.style.position = "relative"), s = c.offset(), o = w.css(e, "top"), u = w.css(e, "left"), ("absolute" === l || "fixed" === l) && (o + u).indexOf("auto") > -1 ? (a = (r = c.position()).top, i = r.left) : (a = parseFloat(o) || 0, i = parseFloat(u) || 0), h(t) && (t = t.call(e, n, w.extend({}, s))), null != t.top && (f.top = t.top - s.top + a), null != t.left && (f.left = t.left - s.left + i), "using" in t ? t.using.call(e, f) : c.css(f) } }, w.fn.extend({ offset: function (e) { if (arguments.length) return void 0 === e ? this : this.each(function (t) { w.offset.setOffset(this, e, t) }); var t, n, r = this[0]; return r ? r.getClientRects().length ? (t = r.getBoundingClientRect(), n = r.ownerDocument.defaultView, { top: t.top + n.pageYOffset, left: t.left + n.pageXOffset }) : { top: 0, left: 0 } : void 0 }, position: function () { if (this[0]) { var e, t, n, r = this[0], i = { top: 0, left: 0 }; if ("fixed" === w.css(r, "position")) t = r.getBoundingClientRect(); else { for (t = this.offset(), n = r.ownerDocument, e = r.offsetParent || n.documentElement; e && (e === n.body || e === n.documentElement) && "static" === w.css(e, "position");)e = e.parentNode; e && e !== r && 1 === e.nodeType && ((i = w(e).offset()).top += w.css(e, "borderTopWidth", !0), i.left += w.css(e, "borderLeftWidth", !0)) } return { top: t.top - i.top - w.css(r, "marginTop", !0), left: t.left - i.left - w.css(r, "marginLeft", !0) } } }, offsetParent: function () { return this.map(function () { for (var e = this.offsetParent; e && "static" === w.css(e, "position");)e = e.offsetParent; return e || re }) } }), w.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function (e, t) { var n = "pageYOffset" === t; w.fn[e] = function (r) { return $(this, function (e, r, i) { var o; if (g(e) ? o = e : 9 === e.nodeType && (o = e.defaultView), void 0 === i) return o ? o[t] : e[r]; o ? o.scrollTo(n ? o.pageXOffset : i, n ? i : o.pageYOffset) : e[r] = i }, e, r, arguments.length) } }), w.each(["top", "left"], function (e, t) { w.cssHooks[t] = $e(d.pixelPosition, function (e, n) { if (n) return n = Be(e, t), Me.test(n) ? w(e).position()[t] + "px" : n }) }), w.each({ Height: "height", Width: "width" }, function (e, t) { w.each({ padding: "inner" + e, content: t, "": "outer" + e }, function (n, r) { w.fn[r] = function (i, o) { var a = arguments.length && (n || "boolean" != typeof i), s = n || (!0 === i || !0 === o ? "margin" : "border"); return $(this, function (t, n, i) { var o; return g(t) ? 0 === r.indexOf("outer") ? t["inner" + e] : t.document.documentElement["client" + e] : 9 === t.nodeType ? (o = t.documentElement, Math.max(t.body["scroll" + e], o["scroll" + e], t.body["offset" + e], o["offset" + e], o["client" + e])) : void 0 === i ? w.css(t, n, s) : w.style(t, n, i, s) }, t, a ? i : void 0, a) } }) }), w.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (e, t) { w.fn[t] = function (e) { return this.on(t, e) } }), w.fn.extend({ bind: function (e, t, n) { return this.on(e, null, t, n) }, unbind: function (e, t) { return this.off(e, null, t) }, delegate: function (e, t, n, r) { return this.on(t, e, n, r) }, undelegate: function (e, t, n) { return 1 === arguments.length ? this.off(e, "**") : this.off(t, e || "**", n) }, hover: function (e, t) { return this.mouseenter(e).mouseleave(t || e) } }), w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "), function (e, t) { w.fn[t] = function (e, n) { return arguments.length > 0 ? this.on(t, null, e, n) : this.trigger(t) } }); var Xt = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g; w.proxy = function (e, t) { var n, r, o; if ("string" == typeof t && (n = e[t], t = e, e = n), h(e)) return r = i.call(arguments, 2), (o = function () { return e.apply(t || this, r.concat(i.call(arguments))) }).guid = e.guid = e.guid || w.guid++, o }, w.holdReady = function (e) { e ? w.readyWait++ : w.ready(!0) }, w.isArray = Array.isArray, w.parseJSON = JSON.parse, w.nodeName = A, w.isFunction = h, w.isWindow = g, w.camelCase = X, w.type = x, w.now = Date.now, w.isNumeric = function (e) { var t = w.type(e); return ("number" === t || "string" === t) && !isNaN(e - parseFloat(e)) }, w.trim = function (e) { return null == e ? "" : (e + "").replace(Xt, "") }, "function" == typeof define && define.amd && define("jquery", [], function () { return w }); var Vt = e.jQuery, Gt = e.$; return w.noConflict = function (t) { return e.$ === w && (e.$ = Gt), t && e.jQuery === w && (e.jQuery = Vt), w }, void 0 === t && (e.jQuery = e.$ = w), w });
define('browser', ['require', 'jquery'], function (require) { var n, t, a, r, e, i = require("jquery"), o = { IS_IE8: null !== navigator.userAgent.match(/MSIE 8.0/i), IS_IE9: null !== navigator.userAgent.match(/MSIE 9.0/i), IS_IE: null !== navigator.userAgent.match(/MSIE/i) || null !== navigator.userAgent.match(/Trident/i) && null !== navigator.userAgent.match(/rv:11/i), IS_EDGE: null !== navigator.userAgent.match(/Edge/i), IS_IPAD: null !== navigator.userAgent.match(/iPad/i), IS_MOBILE: null !== navigator.userAgent.match(/Mobile|Android/i), IS_ANDROID: null !== navigator.userAgent.match(/Android/i), IS_IOS: null !== navigator.userAgent.match(/(iPad|iPhone|iPod)/i) || "MacIntel" === navigator.platform && navigator.maxTouchPoints > 1, IS_CHROME: null !== navigator.userAgent.match(/Chrome/i), IS_FIREFOX: null !== navigator.userAgent.match(/Firefox/i), IS_SAFARI: null !== navigator.userAgent.match(/^((?!chrome|android).)*safari/i), IS_APPLE: null !== navigator.platform.match(/(Mac|iPhone|iPod|iPad)/i), IS_WINDOWS: null !== navigator.platform.match(/(Win32)/i), IS_TOUCH: null !== navigator.userAgent.match(/Touch/i), IS_KINDLE: null !== navigator.userAgent.match(/Kindle/i) || null !== navigator.userAgent.match(/Silk/i), IS_BRAILLENOTE: null !== navigator.userAgent.match(/KeyWeb/i), IS_IN_IFRAME: window.parent !== window }; return o.IS_TABLET = o.IS_IPAD || o.IS_ANDROID || o.IS_KINDLE, o.IS_TOUCH_DEVICE = o.SHOULD_NOT_AUTOFOCUS = o.IS_IOS || o.IS_ANDROID || navigator.userAgent.match(/webOS/i) || navigator.userAgent.match(/BlackBerry/i) || navigator.userAgent.match(/Windows Phone/i), o.IOS_VERSION = (n = navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/)) ? [parseInt(n[1], 10), parseInt(n[2], 10), parseInt(n[3] || 0, 10)] : null, o.MAC_VERSION = function () { var n = navigator.appVersion.match(/OS X (\d+)_(\d+)_?(\d+)?/); return n ? [parseInt(n[1], 10), parseInt(n[2], 10), parseInt(n[3] || 0, 10)] : null }(), o.CHROME_VERSION = function () { var n = navigator.appVersion.match(/Chrom(e|ium)\/([0-9]+)\.([0-9]+)\.?([0-9]+)?/); return n ? [parseInt(n[2], 10), parseInt(n[3], 10), parseInt(n[4] || 0, 10)] : null }(), o.SUPPORTS_INPUTMODE = (t = o.IOS_VERSION, a = o.MAC_VERSION, r = o.CHROME_VERSION, t && t[0] >= 13 || o.IS_IOS && !t && a && (a[0] > 10 || 10 === a[0] && a[1] >= 15) || o.IS_ANDROID && r && r[0] >= 76), o.SUPPORTS_TRANSLATE3D = !1, i(document).ready(function () { var n, t, a = document.createElement("p"), r = { webkitTransform: "-webkit-transform", OTransform: "-o-transform", msTransform: "-ms-transform", MozTransform: "-moz-transform", transform: "transform" }; for (var e in document.body.insertBefore(a, null), r) if (void 0 !== a.style[e]) { if (a.style[e] = "translate3d(1px,1px,1px)", !(t = window.getComputedStyle(a))) return; n = t.getPropertyValue(r[e]) } document.body.removeChild(a), o.SUPPORTS_TRANSLATE3D = void 0 !== n && n.length > 0 && "none" !== n }), o.translateRule = function (n, t) { return o.SUPPORTS_TRANSLATE3D ? "translate3d(" + n + (n ? "px" : "") + "," + t + (t ? "px" : "") + ",0)" : "translate(" + n + (n ? "px" : "") + "," + t + (t ? "px" : "") + ")" }, o.SUPPORTS_CANVAS = !(!(e = document.createElement("canvas")).getContext || !e.getContext("2d")), o });
define('keys', ['require', 'browser'], function (require) { var t = require("browser"); return new function () { for (var e = { 8: this.BACKSPACE = "Backspace", 9: this.TAB = "Tab", 13: this.ENTER = "Enter", 16: this.SHIFT = "Shift", 17: this.CONTROL = "Control", 18: this.ALT = "Alt", 20: this.CAPSLOCK = "CapsLock", 27: this.ESCAPE = "Esc", 32: this.SPACEBAR = "Space", 33: this.PAGEUP = "PageUp", 34: this.PAGEDOWN = "PageDown", 35: this.END = "End", 36: this.HOME = "Home", 37: this.LEFT = "Left", 38: this.UP = "Up", 39: this.RIGHT = "Right", 40: this.DOWN = "Down", 46: this.DELETE = "Del" }, i = { Backspace: this.BACKSPACE, Tab: this.TAB, Enter: this.ENTER, Shift: this.SHIFT, Control: this.CONTROL, Alt: this.ALT, CapsLock: this.CAPSLOCK, Escape: this.ESCAPE, " ": this.SPACEBAR, PageUp: this.PAGEUP, PageDown: this.PAGEDOWN, End: this.END, Home: this.HOME, ArrowLeft: this.LEFT, ArrowUp: this.UP, ArrowRight: this.RIGHT, ArrowDown: this.DOWN, Delete: this.DELETE }, h = { UIKeyInputUpArrow: this.UP, UIKeyInputDownArrow: this.DOWN, UIKeyInputLeftArrow: this.LEFT, UIKeyInputRightArrow: this.RIGHT, UIKeyInputEscape: this.ESCAPE, UIKeyInputPageUp: this.PAGEUP, UIKeyInputPageDown: this.PAGEDOWN }, s = ["0123456789abcdefghijklmnopqrstuvwxyz", "ÂºÂ¡â¢Â£Â¢âÂ§Â¶â¢ÂªÃ¥â«Ã§â ÆÂ©Ë âËÂ¬Âµ Ã¸ÏÅÂ®Ãâ  âââÂ¥Î©", "âââ¬â¹âºï¬ï¬â¡Â°Â·ÃÄ±ÃÃÂ´ÃËÃËÃï£¿ÃÃËÃâÅâ°ÃËÂ¨ââËÃÂ¸"].map(function (t) { return t.split("") }), r = s[0], n = s[1], o = s[2], y = {}, a = {}, E = 0; E < r.length; E++) { var c = r[E]; " " !== n[E] && (y[n[E]] = c.toUpperCase()), " " !== o[E] && (a[o[E]] = c.toUpperCase()) } this.isUndo = function (t) { return !t.altKey && !t.shiftKey && (t.ctrlKey || t.metaKey) && ("z" == t.key || 90 == t.which) }, this.isRedo = function (t) { return !t.altKey && (t.ctrlKey || t.metaKey) && ("y" === t.key || 89 == t.which || t.shiftKey && ("Z" === t.key || "z" === t.key || 90 === t.which)) }, this.isSelectAll = function (t) { return !t.altKey && (t.ctrlKey || t.metaKey) && ("a" === t.key || "A" === t.key || 65 == t.which) }, this.isBacktick = function (t) { return !(t.altKey || t.ctrlKey || t.metaKey || t.shiftKey || "`" !== t.key && 192 != t.which) }, this.isHelp = function (t) { return !t.altKey && (t.ctrlKey || t.metaKey) && ("/" === t.key || 191 == t.which) }, this.lookup = function (t) { return i[t.key] || e[t.which] || h[t.key] }, this.lookupChar = function (e) { if (!e.key) return String.fromCharCode(e.which); if (t.IS_APPLE && e.altKey) { var i = e.shiftKey ? a : y; if (i[e.key]) return i[e.key] } return 1 === e.key.length ? e.key.toUpperCase() : "Enter" === e.key ? String.fromCharCode(13) : "Tab" === e.key ? String.fromCharCode(9) : void 0 } } });
define('text', { load: function (id) { throw new Error("Dynamic load not allowed: " + id); } });
!function (n, r) { "object" == typeof exports && "undefined" != typeof module ? module.exports = r() : "function" == typeof define && define.amd ? define("underscore", r) : function () { var t = n._, e = r(); n._ = e, e.noConflict = function () { return n._ = t, e } }() }(this, function () { var n = "object" == typeof self && self.self === self && self || "object" == typeof global && global.global === global && global || Function("return this")() || {}, r = Array.prototype, t = Object.prototype, e = "undefined" != typeof Symbol ? Symbol.prototype : null, u = r.push, o = r.slice, i = t.toString, a = t.hasOwnProperty, f = Array.isArray, c = Object.keys, l = Object.create, p = n.isNaN, s = n.isFinite, v = function () { }; function h(n) { return n instanceof h ? n : this instanceof h ? void (this._wrapped = n) : new h(n) } var y = h.VERSION = "1.10.2"; function g(n, r, t) { if (void 0 === r) return n; switch (null == t ? 3 : t) { case 1: return function (t) { return n.call(r, t) }; case 3: return function (t, e, u) { return n.call(r, t, e, u) }; case 4: return function (t, e, u, o) { return n.call(r, t, e, u, o) } }return function () { return n.apply(r, arguments) } } function d(n, r, t) { return null == n ? ur : Cn(n) ? g(n, r, t) : Ln(n) && !Kn(n) ? ir(n) : or(n) } function m(n, r) { return d(n, r, 1 / 0) } function b(n, r, t) { return h.iteratee !== m ? h.iteratee(n, r) : d(n, r, t) } function j(n, r) { return r = null == r ? n.length - 1 : +r, function () { for (var t = Math.max(arguments.length - r, 0), e = Array(t), u = 0; u < t; u++)e[u] = arguments[u + r]; switch (r) { case 0: return n.call(this, e); case 1: return n.call(this, arguments[0], e); case 2: return n.call(this, arguments[0], arguments[1], e) }var o = Array(r + 1); for (u = 0; u < r; u++)o[u] = arguments[u]; return o[r] = e, n.apply(this, o) } } function _(n) { if (!Ln(n)) return {}; if (l) return l(n); v.prototype = n; var r = new v; return v.prototype = null, r } function w(n) { return function (r) { return null == r ? void 0 : r[n] } } function x(n, r) { return null != n && a.call(n, r) } function S(n, r) { for (var t = r.length, e = 0; e < t; e++) { if (null == n) return; n = n[r[e]] } return t ? n : void 0 } h.iteratee = m; var A = Math.pow(2, 53) - 1, O = w("length"); function M(n) { var r = O(n); return "number" == typeof r && r >= 0 && r <= A } function E(n, r, t) { var e, u; if (r = g(r, t), M(n)) for (e = 0, u = n.length; e < u; e++)r(n[e], e, n); else { var o = Sn(n); for (e = 0, u = o.length; e < u; e++)r(n[o[e]], o[e], n) } return n } function N(n, r, t) { r = b(r, t); for (var e = !M(n) && Sn(n), u = (e || n).length, o = Array(u), i = 0; i < u; i++) { var a = e ? e[i] : i; o[i] = r(n[a], a, n) } return o } function k(n) { var r = function (r, t, e, u) { var o = !M(r) && Sn(r), i = (o || r).length, a = n > 0 ? 0 : i - 1; for (u || (e = r[o ? o[a] : a], a += n); a >= 0 && a < i; a += n) { var f = o ? o[a] : a; e = t(e, r[f], f, r) } return e }; return function (n, t, e, u) { var o = arguments.length >= 3; return r(n, g(t, u, 4), e, o) } } var I = k(1), T = k(-1); function B(n, r, t) { var e = (M(n) ? on : Tn)(n, r, t); if (void 0 !== e && -1 !== e) return n[e] } function R(n, r, t) { var e = []; return r = b(r, t), E(n, function (n, t, u) { r(n, t, u) && e.push(n) }), e } function F(n, r, t) { r = b(r, t); for (var e = !M(n) && Sn(n), u = (e || n).length, o = 0; o < u; o++) { var i = e ? e[o] : o; if (!r(n[i], i, n)) return !1 } return !0 } function q(n, r, t) { r = b(r, t); for (var e = !M(n) && Sn(n), u = (e || n).length, o = 0; o < u; o++) { var i = e ? e[o] : o; if (r(n[i], i, n)) return !0 } return !1 } function D(n, r, t, e) { return M(n) || (n = On(n)), ("number" != typeof t || e) && (t = 0), ln(n, r, t) >= 0 } var W = j(function (n, r, t) { var e, u; return Cn(r) ? u = r : Kn(r) && (e = r.slice(0, -1), r = r[r.length - 1]), N(n, function (n) { var o = u; if (!o) { if (e && e.length && (n = S(n, e)), null == n) return; o = n[r] } return null == o ? o : o.apply(n, t) }) }); function z(n, r) { return N(n, or(r)) } function P(n, r, t) { var e, u, o = -1 / 0, i = -1 / 0; if (null == r || "number" == typeof r && "object" != typeof n[0] && null != n) for (var a = 0, f = (n = M(n) ? n : On(n)).length; a < f; a++)null != (e = n[a]) && e > o && (o = e); else r = b(r, t), E(n, function (n, t, e) { ((u = r(n, t, e)) > i || u === -1 / 0 && o === -1 / 0) && (o = n, i = u) }); return o } function K(n, r, t) { if (null == r || t) return M(n) || (n = On(n)), n[ar(n.length - 1)]; var e = M(n) ? Dn(n) : On(n), u = O(e); r = Math.max(Math.min(r, u), 0); for (var o = u - 1, i = 0; i < r; i++) { var a = ar(i, o), f = e[i]; e[i] = e[a], e[a] = f } return e.slice(0, r) } function L(n, r) { return function (t, e, u) { var o = r ? [[], []] : {}; return e = b(e, u), E(t, function (r, u) { var i = e(r, u, t); n(o, r, i) }), o } } var V = L(function (n, r, t) { x(n, t) ? n[t].push(r) : n[t] = [r] }), C = L(function (n, r, t) { n[t] = r }), J = L(function (n, r, t) { x(n, t) ? n[t]++ : n[t] = 1 }), U = /[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g; var $ = L(function (n, r, t) { n[t ? 0 : 1].push(r) }, !0); function G(n, r, t) { return null == n || n.length < 1 ? null == r ? void 0 : [] : null == r || t ? n[0] : H(n, n.length - r) } function H(n, r, t) { return o.call(n, 0, Math.max(0, n.length - (null == r || t ? 1 : r))) } function Q(n, r, t) { return o.call(n, null == r || t ? 1 : r) } function X(n, r, t, e) { for (var u = (e = e || []).length, o = 0, i = O(n); o < i; o++) { var a = n[o]; if (M(a) && (Kn(a) || Vn(a))) if (r) for (var f = 0, c = a.length; f < c;)e[u++] = a[f++]; else X(a, r, t, e), u = e.length; else t || (e[u++] = a) } return e } var Y = j(function (n, r) { return rn(n, r) }); function Z(n, r, t, e) { er(r) || (e = t, t = r, r = !1), null != t && (t = b(t, e)); for (var u = [], o = [], i = 0, a = O(n); i < a; i++) { var f = n[i], c = t ? t(f, i, n) : f; r && !t ? (i && o === c || u.push(f), o = c) : t ? D(o, c) || (o.push(c), u.push(f)) : D(u, f) || u.push(f) } return u } var nn = j(function (n) { return Z(X(n, !0, !0)) }); var rn = j(function (n, r) { return r = X(r, !0, !0), R(n, function (n) { return !D(r, n) }) }); function tn(n) { for (var r = n && P(n, O).length || 0, t = Array(r), e = 0; e < r; e++)t[e] = z(n, e); return t } var en = j(tn); function un(n) { return function (r, t, e) { t = b(t, e); for (var u = O(r), o = n > 0 ? 0 : u - 1; o >= 0 && o < u; o += n)if (t(r[o], o, r)) return o; return -1 } } var on = un(1), an = un(-1); function fn(n, r, t, e) { for (var u = (t = b(t, e, 1))(r), o = 0, i = O(n); o < i;) { var a = Math.floor((o + i) / 2); t(n[a]) < u ? o = a + 1 : i = a } return o } function cn(n, r, t) { return function (e, u, i) { var a = 0, f = O(e); if ("number" == typeof i) n > 0 ? a = i >= 0 ? i : Math.max(i + f, a) : f = i >= 0 ? Math.min(i + 1, f) : i + f + 1; else if (t && i && f) return e[i = t(e, u)] === u ? i : -1; if (u != u) return (i = r(o.call(e, a, f), tr)) >= 0 ? i + a : -1; for (i = n > 0 ? a : f - 1; i >= 0 && i < f; i += n)if (e[i] === u) return i; return -1 } } var ln = cn(1, on, fn), pn = cn(-1, an); function sn(n, r, t, e, u) { if (!(e instanceof r)) return n.apply(t, u); var o = _(n.prototype), i = n.apply(o, u); return Ln(i) ? i : o } var vn = j(function (n, r, t) { if (!Cn(n)) throw new TypeError("Bind must be called on a function"); var e = j(function (u) { return sn(n, e, r, this, t.concat(u)) }); return e }), hn = j(function (n, r) { var t = hn.placeholder, e = function () { for (var u = 0, o = r.length, i = Array(o), a = 0; a < o; a++)i[a] = r[a] === t ? arguments[u++] : r[a]; for (; u < arguments.length;)i.push(arguments[u++]); return sn(n, e, this, this, i) }; return e }); hn.placeholder = h; var yn = j(function (n, r) { var t = (r = X(r, !1, !1)).length; if (t < 1) throw new Error("bindAll must be passed function names"); for (; t--;) { var e = r[t]; n[e] = vn(n[e], n) } }); var gn = j(function (n, r, t) { return setTimeout(function () { return n.apply(null, t) }, r) }), dn = hn(gn, h, 1); function mn(n) { return function () { return !n.apply(this, arguments) } } function bn(n, r) { var t; return function () { return --n > 0 && (t = r.apply(this, arguments)), n <= 1 && (r = null), t } } var jn = hn(bn, 2), _n = !{ toString: null }.propertyIsEnumerable("toString"), wn = ["valueOf", "isPrototypeOf", "toString", "propertyIsEnumerable", "hasOwnProperty", "toLocaleString"]; function xn(n, r) { var e = wn.length, u = n.constructor, o = Cn(u) && u.prototype || t, i = "constructor"; for (x(n, i) && !D(r, i) && r.push(i); e--;)(i = wn[e]) in n && n[i] !== o[i] && !D(r, i) && r.push(i) } function Sn(n) { if (!Ln(n)) return []; if (c) return c(n); var r = []; for (var t in n) x(n, t) && r.push(t); return _n && xn(n, r), r } function An(n) { if (!Ln(n)) return []; var r = []; for (var t in n) r.push(t); return _n && xn(n, r), r } function On(n) { for (var r = Sn(n), t = r.length, e = Array(t), u = 0; u < t; u++)e[u] = n[r[u]]; return e } function Mn(n) { for (var r = {}, t = Sn(n), e = 0, u = t.length; e < u; e++)r[n[t[e]]] = t[e]; return r } function En(n) { var r = []; for (var t in n) Cn(n[t]) && r.push(t); return r.sort() } function Nn(n, r) { return function (t) { var e = arguments.length; if (r && (t = Object(t)), e < 2 || null == t) return t; for (var u = 1; u < e; u++)for (var o = arguments[u], i = n(o), a = i.length, f = 0; f < a; f++) { var c = i[f]; r && void 0 !== t[c] || (t[c] = o[c]) } return t } } var kn = Nn(An), In = Nn(Sn); function Tn(n, r, t) { r = b(r, t); for (var e, u = Sn(n), o = 0, i = u.length; o < i; o++)if (r(n[e = u[o]], e, n)) return e } function Bn(n, r, t) { return r in t } var Rn = j(function (n, r) { var t = {}, e = r[0]; if (null == n) return t; Cn(e) ? (r.length > 1 && (e = g(e, r[1])), r = An(n)) : (e = Bn, r = X(r, !1, !1), n = Object(n)); for (var u = 0, o = r.length; u < o; u++) { var i = r[u], a = n[i]; e(a, i, n) && (t[i] = a) } return t }), Fn = j(function (n, r) { var t, e = r[0]; return Cn(e) ? (e = mn(e), r.length > 1 && (t = r[1])) : (r = N(X(r, !1, !1), String), e = function (n, t) { return !D(r, t) }), Rn(n, e, t) }), qn = Nn(An, !0); function Dn(n) { return Ln(n) ? Kn(n) ? n.slice() : kn({}, n) : n } function Wn(n, r) { var t = Sn(r), e = t.length; if (null == n) return !e; for (var u = Object(n), o = 0; o < e; o++) { var i = t[o]; if (r[i] !== u[i] || !(i in u)) return !1 } return !0 } function zn(n, r, t, u) { if (n === r) return 0 !== n || 1 / n == 1 / r; if (null == n || null == r) return !1; if (n != n) return r != r; var o = typeof n; return ("function" === o || "object" === o || "object" == typeof r) && function (n, r, t, u) { n instanceof h && (n = n._wrapped); r instanceof h && (r = r._wrapped); var o = i.call(n); if (o !== i.call(r)) return !1; switch (o) { case "[object RegExp]": case "[object String]": return "" + n == "" + r; case "[object Number]": return +n != +n ? +r != +r : 0 == +n ? 1 / +n == 1 / r : +n == +r; case "[object Date]": case "[object Boolean]": return +n == +r; case "[object Symbol]": return e.valueOf.call(n) === e.valueOf.call(r) }var a = "[object Array]" === o; if (!a) { if ("object" != typeof n || "object" != typeof r) return !1; var f = n.constructor, c = r.constructor; if (f !== c && !(Cn(f) && f instanceof f && Cn(c) && c instanceof c) && "constructor" in n && "constructor" in r) return !1 } u = u || []; var l = (t = t || []).length; for (; l--;)if (t[l] === n) return u[l] === r; if (t.push(n), u.push(r), a) { if ((l = n.length) !== r.length) return !1; for (; l--;)if (!zn(n[l], r[l], t, u)) return !1 } else { var p, s = Sn(n); if (l = s.length, Sn(r).length !== l) return !1; for (; l--;)if (!x(r, p = s[l]) || !zn(n[p], r[p], t, u)) return !1 } return t.pop(), u.pop(), !0 }(n, r, t, u) } function Pn(n) { return function (r) { return i.call(r) === "[object " + n + "]" } } var Kn = f || Pn("Array"); function Ln(n) { var r = typeof n; return "function" === r || "object" === r && !!n } var Vn = Pn("Arguments"), Cn = Pn("Function"), Jn = Pn("String"), Un = Pn("Number"), $n = Pn("Date"), Gn = Pn("RegExp"), Hn = Pn("Error"), Qn = Pn("Symbol"), Xn = Pn("Map"), Yn = Pn("WeakMap"), Zn = Pn("Set"), nr = Pn("WeakSet"); !function () { Vn(arguments) || (Vn = function (n) { return x(n, "callee") }) }(); var rr = n.document && n.document.childNodes; function tr(n) { return Un(n) && p(n) } function er(n) { return !0 === n || !1 === n || "[object Boolean]" === i.call(n) } function ur(n) { return n } function or(n) { return Kn(n) ? function (r) { return S(r, n) } : w(n) } function ir(n) { return n = In({}, n), function (r) { return Wn(r, n) } } function ar(n, r) { return null == r && (r = n, n = 0), n + Math.floor(Math.random() * (r - n + 1)) } "function" != typeof /./ && "object" != typeof Int8Array && "function" != typeof rr && (Cn = function (n) { return "function" == typeof n || !1 }); var fr = Date.now || function () { return (new Date).getTime() }, cr = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "`": "&#x60;" }, lr = Mn(cr); function pr(n) { var r = function (r) { return n[r] }, t = "(?:" + Sn(n).join("|") + ")", e = RegExp(t), u = RegExp(t, "g"); return function (n) { return n = null == n ? "" : "" + n, e.test(n) ? n.replace(u, r) : n } } var sr = pr(cr), vr = pr(lr); var hr = 0; var yr = h.templateSettings = { evaluate: /<%([\s\S]+?)%>/g, interpolate: /<%=([\s\S]+?)%>/g, escape: /<%-([\s\S]+?)%>/g }, gr = /(.)^/, dr = { "'": "'", "\\": "\\", "\r": "r", "\n": "n", "\u2028": "u2028", "\u2029": "u2029" }, mr = /\\|'|\r|\n|\u2028|\u2029/g, br = function (n) { return "\\" + dr[n] }; function jr(n, r) { return n._chain ? h(r).chain() : r } function _r(n) { return E(En(n), function (r) { var t = h[r] = n[r]; h.prototype[r] = function () { var n = [this._wrapped]; return u.apply(n, arguments), jr(this, t.apply(h, n)) } }), h } E(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function (n) { var t = r[n]; h.prototype[n] = function () { var r = this._wrapped; return t.apply(r, arguments), "shift" !== n && "splice" !== n || 0 !== r.length || delete r[0], jr(this, r) } }), E(["concat", "join", "slice"], function (n) { var t = r[n]; h.prototype[n] = function () { return jr(this, t.apply(this._wrapped, arguments)) } }), h.prototype.value = function () { return this._wrapped }, h.prototype.valueOf = h.prototype.toJSON = h.prototype.value, h.prototype.toString = function () { return String(this._wrapped) }; var wr = _r({ default: h, VERSION: y, iteratee: m, restArguments: j, each: E, forEach: E, map: N, collect: N, reduce: I, foldl: I, inject: I, reduceRight: T, foldr: T, find: B, detect: B, filter: R, select: R, reject: function (n, r, t) { return R(n, mn(b(r)), t) }, every: F, all: F, some: q, any: q, contains: D, includes: D, include: D, invoke: W, pluck: z, where: function (n, r) { return R(n, ir(r)) }, findWhere: function (n, r) { return B(n, ir(r)) }, max: P, min: function (n, r, t) { var e, u, o = 1 / 0, i = 1 / 0; if (null == r || "number" == typeof r && "object" != typeof n[0] && null != n) for (var a = 0, f = (n = M(n) ? n : On(n)).length; a < f; a++)null != (e = n[a]) && e < o && (o = e); else r = b(r, t), E(n, function (n, t, e) { ((u = r(n, t, e)) < i || u === 1 / 0 && o === 1 / 0) && (o = n, i = u) }); return o }, shuffle: function (n) { return K(n, 1 / 0) }, sample: K, sortBy: function (n, r, t) { var e = 0; return r = b(r, t), z(N(n, function (n, t, u) { return { value: n, index: e++, criteria: r(n, t, u) } }).sort(function (n, r) { var t = n.criteria, e = r.criteria; if (t !== e) { if (t > e || void 0 === t) return 1; if (t < e || void 0 === e) return -1 } return n.index - r.index }), "value") }, groupBy: V, indexBy: C, countBy: J, toArray: function (n) { return n ? Kn(n) ? o.call(n) : Jn(n) ? n.match(U) : M(n) ? N(n, ur) : On(n) : [] }, size: function (n) { return null == n ? 0 : M(n) ? n.length : Sn(n).length }, partition: $, first: G, head: G, take: G, initial: H, last: function (n, r, t) { return null == n || n.length < 1 ? null == r ? void 0 : [] : null == r || t ? n[n.length - 1] : Q(n, Math.max(0, n.length - r)) }, rest: Q, tail: Q, drop: Q, compact: function (n) { return R(n, Boolean) }, flatten: function (n, r) { return X(n, r, !1) }, without: Y, uniq: Z, unique: Z, union: nn, intersection: function (n) { for (var r = [], t = arguments.length, e = 0, u = O(n); e < u; e++) { var o = n[e]; if (!D(r, o)) { var i; for (i = 1; i < t && D(arguments[i], o); i++); i === t && r.push(o) } } return r }, difference: rn, unzip: tn, zip: en, object: function (n, r) { for (var t = {}, e = 0, u = O(n); e < u; e++)r ? t[n[e]] = r[e] : t[n[e][0]] = n[e][1]; return t }, findIndex: on, findLastIndex: an, sortedIndex: fn, indexOf: ln, lastIndexOf: pn, range: function (n, r, t) { null == r && (r = n || 0, n = 0), t || (t = r < n ? -1 : 1); for (var e = Math.max(Math.ceil((r - n) / t), 0), u = Array(e), o = 0; o < e; o++, n += t)u[o] = n; return u }, chunk: function (n, r) { if (null == r || r < 1) return []; for (var t = [], e = 0, u = n.length; e < u;)t.push(o.call(n, e, e += r)); return t }, bind: vn, partial: hn, bindAll: yn, memoize: function (n, r) { var t = function (e) { var u = t.cache, o = "" + (r ? r.apply(this, arguments) : e); return x(u, o) || (u[o] = n.apply(this, arguments)), u[o] }; return t.cache = {}, t }, delay: gn, defer: dn, throttle: function (n, r, t) { var e, u, o, i, a = 0; t || (t = {}); var f = function () { a = !1 === t.leading ? 0 : fr(), e = null, i = n.apply(u, o), e || (u = o = null) }, c = function () { var c = fr(); a || !1 !== t.leading || (a = c); var l = r - (c - a); return u = this, o = arguments, l <= 0 || l > r ? (e && (clearTimeout(e), e = null), a = c, i = n.apply(u, o), e || (u = o = null)) : e || !1 === t.trailing || (e = setTimeout(f, l)), i }; return c.cancel = function () { clearTimeout(e), a = 0, e = u = o = null }, c }, debounce: function (n, r, t) { var e, u, o = function (r, t) { e = null, t && (u = n.apply(r, t)) }, i = j(function (i) { if (e && clearTimeout(e), t) { var a = !e; e = setTimeout(o, r), a && (u = n.apply(this, i)) } else e = gn(o, r, this, i); return u }); return i.cancel = function () { clearTimeout(e), e = null }, i }, wrap: function (n, r) { return hn(r, n) }, negate: mn, compose: function () { var n = arguments, r = n.length - 1; return function () { for (var t = r, e = n[r].apply(this, arguments); t--;)e = n[t].call(this, e); return e } }, after: function (n, r) { return function () { if (--n < 1) return r.apply(this, arguments) } }, before: bn, once: jn, keys: Sn, allKeys: An, values: On, mapObject: function (n, r, t) { r = b(r, t); for (var e = Sn(n), u = e.length, o = {}, i = 0; i < u; i++) { var a = e[i]; o[a] = r(n[a], a, n) } return o }, pairs: function (n) { for (var r = Sn(n), t = r.length, e = Array(t), u = 0; u < t; u++)e[u] = [r[u], n[r[u]]]; return e }, invert: Mn, functions: En, methods: En, extend: kn, extendOwn: In, assign: In, findKey: Tn, pick: Rn, omit: Fn, defaults: qn, create: function (n, r) { var t = _(n); return r && In(t, r), t }, clone: Dn, tap: function (n, r) { return r(n), n }, isMatch: Wn, isEqual: function (n, r) { return zn(n, r) }, isEmpty: function (n) { return null == n || (M(n) && (Kn(n) || Jn(n) || Vn(n)) ? 0 === n.length : 0 === Sn(n).length) }, isElement: function (n) { return !(!n || 1 !== n.nodeType) }, isArray: Kn, isObject: Ln, isArguments: Vn, isFunction: Cn, isString: Jn, isNumber: Un, isDate: $n, isRegExp: Gn, isError: Hn, isSymbol: Qn, isMap: Xn, isWeakMap: Yn, isSet: Zn, isWeakSet: nr, isFinite: function (n) { return !Qn(n) && s(n) && !p(parseFloat(n)) }, isNaN: tr, isBoolean: er, isNull: function (n) { return null === n }, isUndefined: function (n) { return void 0 === n }, has: function (n, r) { if (!Kn(r)) return x(n, r); for (var t = r.length, e = 0; e < t; e++) { var u = r[e]; if (null == n || !a.call(n, u)) return !1; n = n[u] } return !!t }, identity: ur, constant: function (n) { return function () { return n } }, noop: function () { }, property: or, propertyOf: function (n) { return null == n ? function () { } : function (r) { return Kn(r) ? S(n, r) : n[r] } }, matcher: ir, matches: ir, times: function (n, r, t) { var e = Array(Math.max(0, n)); r = g(r, t, 1); for (var u = 0; u < n; u++)e[u] = r(u); return e }, random: ar, now: fr, escape: sr, unescape: vr, result: function (n, r, t) { Kn(r) || (r = [r]); var e = r.length; if (!e) return Cn(t) ? t.call(n) : t; for (var u = 0; u < e; u++) { var o = null == n ? void 0 : n[r[u]]; void 0 === o && (o = t, u = e), n = Cn(o) ? o.call(n) : o } return n }, uniqueId: function (n) { var r = ++hr + ""; return n ? n + r : r }, templateSettings: yr, template: function (n, r, t) { !r && t && (r = t), r = qn({}, r, h.templateSettings); var e, u = RegExp([(r.escape || gr).source, (r.interpolate || gr).source, (r.evaluate || gr).source].join("|") + "|$", "g"), o = 0, i = "__p+='"; n.replace(u, function (r, t, e, u, a) { return i += n.slice(o, a).replace(mr, br), o = a + r.length, t ? i += "'+\n((__t=(" + t + "))==null?'':_.escape(__t))+\n'" : e ? i += "'+\n((__t=(" + e + "))==null?'':__t)+\n'" : u && (i += "';\n" + u + "\n__p+='"), r }), i += "';\n", r.variable || (i = "with(obj||{}){\n" + i + "}\n"), i = "var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n" + i + "return __p;\n"; try { e = new Function(r.variable || "obj", "_", i) } catch (n) { throw n.source = i, n } var a = function (n) { return e.call(this, n, h) }, f = r.variable || "obj"; return a.source = "function(" + f + "){\n" + i + "}", a }, chain: function (n) { var r = h(n); return r._chain = !0, r }, mixin: _r }); return wr._ = wr, wr });
define('lib/inject-css', ['require', 'underscore'], function (require) { "use strict"; var e = require("underscore"), t = {}, n = []; return function (r, d) { var c = t[r]; if (!c) { c = document.createElement("style"), t[r] = c; var o = e.sortedIndex(n, r), i = t[n[o]]; i ? document.head.insertBefore(c, i) : document.head.appendChild(c), n.splice(o, 0, r) } c.textContent = d } });
define('vendor/css', {});
define('lib/prefix-css', ['require', 'vendor/css'], function (require) { "use strict"; var e = require("vendor/css"); function t(e, t) { return Object.assign({}, e, { rules: r(e.rules, t) }) } function r(e, t) { return e.map(function (e) { return e.rules ? Object.assign({}, e, { rules: r(e.rules, t) }) : e.selectors ? Object.assign({}, e, { selectors: s(e.selectors, t) }) : e }) } function s(e, t) { for (var r = [], s = 0; s < e.length; s++) { var n = e[s]; if ("html" === n) r.push(n); else if (/dcg(-mq)?-aria-alert/.test(n)) r.push(n); else if (/^html body( |$)/.test(n)) r.push("html" + t + " body" + n.slice("html body".length)), r.push("html body " + t + n.slice("html body".length)); else { if (/^html/.test(n)) throw new Error("Cannot correctly prefix selector " + n); r.push(t + " " + n) } } return r } return function (r, s) { if (s) { var n = "." + s; return function (e) { if (!/\.-?[_a-zA-Z]+[_a-zA-Z0-9-]*/.test(e)) throw new Error("Illegal css selector prefix " + e) }(n), function (r, s) { var n = e.parse(r), l = Object.assign({}, n, { stylesheet: t(n.stylesheet, s) }); return e.stringify(l) }(r, n) } return r } });
define('loadcss', { load: function (id) { throw new Error("Dynamic load not allowed: " + id); } });

define('loadcss!touchtracking', function () { });
define('touchtracking', ['require', 'jquery', 'ipad.ghostevents', 'keys', 'loadcss!./touchtracking'], function (require) { var e, t, n = -1 !== document.location.href.indexOf("dcgDebugTouchTracking=dcgYES"), o = require("jquery"), c = require("ipad.ghostevents"), a = require("keys"); require("loadcss!./touchtracking"), null == window._touchtracking_id_counter && (window._touchtracking_id_counter = 0), window._touchtracking_id_counter += 1; var i = "touchtracking_id_" + window._touchtracking_id_counter, r = function (e) { t && (t[0].value = "(" + Date.now() + ") " + e + "\n" + t[0].value) }; c.evtInScope = function (e) { return k(e.target) }, c.isGhostEvent = function (e) { return !window.PointerEvent && (!(g !== u && g !== d && !Y()) && (e.target !== f && ((!e.target || !o.contains(e.target, f)) && ((!f || !o.contains(f, e.target)) && (r("found ghost event"), !0))))) }; var u = 1, d = 4, g = 0, s = {}, l = {}, p = [], h = 0, v = null, f = null, m = null, E = [], y = function (e) { for (var t = []; e;)t.push(e), e = e.parentNode; return t }, b = function (e) { for (var t = [], n = 0; n < e.length; n++) { var c = e[n]; if (t.push(c), o(c).is(".dcg-tap-container, .dcg-no-touchtracking")) return o(c).is(".dcg-tap-container." + i) ? t : [] } return [] }, T = function (e, t) { f = null, r("beginMode:" + (g = e)), p = y(g === u ? t.originalEvent.touches[0].target : t.target), o(b(p)).addClass("dcg-depressed").each(function () { var e = o(this); C(e) && e.addClass("dcg-focus-by-tap") }), o(p).each(function () { var e = o(this); e.data({ originalScrollTop: e.scrollTop(), originalScrollLeft: e.scrollLeft() }) }), l = {} }, w = function (e) { return e.is('input, textarea, select, [role="textbox"]') || e.hasClass("dcg-mathquill-input-span") || e.is("[contenteditable=true]") }, k = function (e) { return !!o(e).closest(".dcg-tap-container, .dcg-no-touchtracking").is(".dcg-tap-container." + i) }, C = function (e) { return 3 !== g && !w(e) && k(e) }, x = function (e, t) { f = null, r("endMode:" + g), o(".dcg-depressed").removeClass("dcg-depressed"); var n = o(document.activeElement); if (!N(e.target) && C(n)) try { n.blur() } catch (e) { } if (o(".dcg-focus-by-tap").removeClass("dcg-focus-by-tap"), o(p).each(function () { var e = o(this), t = e.data("originalScrollTop") - e.scrollTop(), n = e.data("originalScrollLeft") - e.scrollLeft(); (t || n) && (l.scroll = !0) }), 1 === l["dcg-tapstart"] && 1 === l["dcg-tapend"] && !l["dcg-tapcancel"] && !l.scroll) { r("potential dcg-tap"); var c = t.changedTouches[0].clientX, a = t.changedTouches[0].clientY; if (e && !e.device && 0 === c && 0 === a) { var i = e.target.getBoundingClientRect(); c = (i.left + i.right) / 2, a = (i.top + i.bottom) / 2, e.device = "keyboard" } r("potential dcg-tap coords:" + c + ":" + a); for (var s = !1, m = !1, E = 0; E < p.length && !s; E++) { var y, b = o(p[E]); if ("function" == typeof b[0].getBoundingClientRect && (y = b[0].getBoundingClientRect()), "true" === b.attr("tapboundary") && (s = !0), y) { if (c < y.left || a < y.top) continue; if (c > y.right) continue; if (a > y.bottom) continue } f = b[0], m = !0, I("dcg-tap", e, { target: f, touches: t.touches, changedTouches: t.changedTouches }); break } } r("result of dcg-tap:  did_dispatch=" + m + "  did_escape=" + s), g !== u && g !== d || (v = setTimeout(function () { v = null, h = (new Date).getTime() }, 1e3)), p = [], g = 0 }, Y = function () { return v || (new Date).getTime() - h < 500 }, X = function (e) { return void 0 !== e.identifier ? e.identifier : e.pointerId }, _ = function (e) { for (var t = [], n = 0; n < e.length; n++) { var o = e[n]; t.push({ identifier: X(o), x: o.pageX, y: o.pageY, screenX: o.screenX, screenY: o.screenY, pageX: o.pageX, pageY: o.pageY, clientX: o.clientX, clientY: o.clientY }) } return t }, I = function (e, t, n) { var c = X(t), a = _(n.touches), i = _(n.changedTouches); if (r("dispatchEvent:" + e), "dcg-tapstart" === e) s[c] = { type: e, pageX: i[0].pageX, pageY: i[0].pageY }; else if ("dcg-tapmove" === e) { var p = i[0], h = s[c]; if (h && p.pageX === h.pageX && p.pageY === h.pageY) return; if ((g === u || g === d) && h && "dcg-tapstart" === h.type && Math.abs(h.pageX - p.pageX) + Math.abs(h.pageY - p.pageY) < 2) return; s[c] = { type: e, pageX: i[0].pageX, pageY: i[0].pageY } } void 0 === l[e.toLowerCase()] ? l[e.toLowerCase()] = 1 : l[e.toLowerCase()]++; var v = o.event.fix(t.originalEvent); v.type = e, v.device = g === u || g === d ? "touch" : 3 === g ? "keyboard" : "mouse", v.touches = a, v.changedTouches = i, v.target = n.target ? n.target : t.target; var f = "keyboard" !== v.device && l["dcg-longhold"] > 0; v.wasLongheld = function () { return f }, v.preventTap = function () { l["dcg-tapcancel"] = 1 }, clearTimeout(m), "dcg-tapstart" === v.type && "keyboard" !== v.device && 1 === v.touches.length && (m = setTimeout(function () { I("dcg-longhold", t, n) }, 500)), v.target && v.target.nodeName && "a" === v.target.nodeName.toLowerCase() && "dcg-tap" === v.type && "keyboard" === v.device && v.target.click && v.target.click(), r("trigger event:" + v.type), o(v.target).trigger(v) }, L = function (e) { var t = p, n = !!p.length, c = o(".dcg-tap-container." + i + " .dcg-hovered"), a = o.makeArray(c.filter(function () { return k(this) })), r = [], u = [], d = []; b(y(e)).forEach(function (e) { n && -1 === t.indexOf(e) || (-1 === a.indexOf(e) && d.push(e), r.push(e)) }); for (var g = 0; g < a.length; g++)e = a[g], -1 === r.indexOf(e) && u.push(e); o(u).removeClass("dcg-hovered").trigger("tipsyhide"), o(d).addClass("dcg-hovered").trigger("tipsyshow") }, S = function (e) { for (var t = 0; t < E.length; t++)if (E[t].pointerId === e) return !0; return !1 }, M = function (e) { for (var t = 0; t < E.length; t++)if (E[t].pointerId === e) return E.splice(t, 1)[0] }, P = function (e) { 0 === g && T(d, e), L(null), E.push(e.originalEvent), I("dcg-tapstart", e, { touches: E, changedTouches: [e.originalEvent] }) }, R = function (e) { M(e.originalEvent.pointerId); var t = { touches: E, changedTouches: [e.originalEvent] }; I("dcg-tapcancel", e, t), 0 === E.length && x(e, t) }, A = function (e) { M(e.originalEvent.pointerId); var t = { touches: E, changedTouches: [e.originalEvent] }; I("dcg-tapend", e, t), 0 === E.length && x(e, t) }, D = function (e) { return "touch" === e.originalEvent.pointerType || 2 === e.originalEvent.pointerType }; B("pointerdown MSPointerDown", function (e) { 2 !== g && g !== u && D(e) && (S(e.originalEvent.pointerId) ? r("exit. pointer id already exists: " + e.originalEvent.pointerId) : P(e)) }), B("pointermove MSPointerMove", function (e) { 2 !== g && g !== u && D(e) && (S(e.originalEvent.pointerId) || (r("pointer id already exists: " + e.originalEvent.pointerId), P(e)), M(e.originalEvent.pointerId), E.push(e.originalEvent), I("dcg-tapmove", e, { touches: E, changedTouches: [e.originalEvent] })) }), o(document).on("pointercancel MSPointerCancel", function (e) { var t; if ((r("document.on:" + e.type), g === d && D(e)) && S(e.originalEvent.pointerId)) for (R(e); t = E.pop();) { e = o.Event(t, { originalEvent: t }); R(e) } }), o(document).on("pointerup MSPointerUp", function (e) { var t; if ((r("document.on:" + e.type), g === d && D(e)) && S(e.originalEvent.pointerId)) for (A(e); t = E.pop();) { e = o.Event(t, { originalEvent: t }); A(e) } }); var O = function () { var e = !1; try { var t = Object.defineProperty({}, "passive", { get: function () { e = !0 } }); window.addEventListener("test", function () { }, t), window.removeEventListener("test", function () { }, t) } catch (e) { } return e }(); function B(e, t) { var n = O ? { passive: !1 } : void 0; document.addEventListener(e, function (e) { r("document.on:" + e.type), t(o.event.fix(e)) }, n) } function N(e) { var t = !!o(e).closest(".dcg-do-not-blur").length, n = !!o(e).closest(".dcg-do-blur").length; return !(!t || n || !k(e)) } return B("touchstart", function (e) { 2 !== g && g !== d && (0 === g && T(u, e), L(null), I("dcg-tapstart", e, { touches: e.originalEvent.touches, changedTouches: e.originalEvent.changedTouches })) }), B("touchmove", function (e) { g === u && I("dcg-tapmove", e, { touches: e.originalEvent.touches, changedTouches: e.originalEvent.changedTouches }) }), B("touchcancel", function (e) { if (g === u) { var t = { touches: e.originalEvent.touches, changedTouches: e.originalEvent.changedTouches }; I("dcg-tapcancel", e, t), 0 === e.originalEvent.touches.length && x(e, t) } }), B("touchend", function (e) { if (g === u) { var t = { touches: e.originalEvent.touches, changedTouches: e.originalEvent.changedTouches }; I("dcg-tapend", e, t), 0 === e.originalEvent.touches.length && x(e, t) } }), o(document).on("mousedown", function (e) { if (r("document.on:" + e.type), 1 !== e.button && 2 !== e.button) { if (g === u || g === d || Y()) return !o(e.target).is("input, textarea, select") && k(e.target) && e.preventDefault(), void r("abort mousedown: " + g + ":" + Y()); T(2, e), I("dcg-tapstart", e, { touches: [e], changedTouches: [e] }) } }), o(document).ready(function () { o(document).on("mousedown", function (e) { if (r("document.on:" + e.type), N(e.target)) { e.preventDefault(); try { var t = window.getSelection(); if (1 === t.rangeCount) { var n = t.getRangeAt(0); n.startContainer === n.endContainer && o(n.startContainer).closest(".dcg-text-selectable").length && t.removeAllRanges() } } catch (e) { } } }) }), o(document).on("mouseleave", function (e) { r("document.on:" + e.type), 0 === g && (Y() ? r("abort mouseleave: " + g + ":" + Y()) : L(null)) }), o(document).on("mousemove", function (e) { r("document.on:" + e.type), 1 !== e.button && 2 !== e.button && g !== u && g !== d && (Y() ? r("abort mousemove: " + g + ":" + Y()) : (L(e.target), I("dcg-tapmove", e, { touches: [e], changedTouches: [e] }))) }), o(document).on("mouseup", function (e) { if (r("document.on:" + e.type), 1 !== e.button && 2 !== e.button && 2 === g) { var t = { touches: [], changedTouches: [e] }; I("dcg-tapend", e, t), x(e, t) } }), o(document).on("keydown", function (e) { if (r("document.on:" + e.type), (a.lookup(e) === a.ENTER || a.lookup(e) === a.SPACEBAR) && k(e.target) && 3 !== g) { if (o(e.target).is('a:not([ontap]), button, input, textarea, select, [role="textbox"], [contenteditable="true"]')) return; e.preventDefault(), T(3, e), I("dcg-tapstart", e, { touches: [e], changedTouches: [e] }) } }), o(document).on("keyup", function (e) { if (r("document.on:" + e.type), (a.lookup(e) === a.ENTER || a.lookup(e) === a.SPACEBAR) && k(e.target) && 3 === g) { var t = { touches: [], changedTouches: [e] }; I("dcg-tapend", e, t), x(e, t) } }), { monitor: function (c) { o(c).addClass("dcg-tap-container"), o(c).addClass(i), n && (e && e.remove(), e = o('<div style="position:absolute;bottom:10px;right:10px;"><textarea rows="30" cols="40"></textarea><div id="dcg-touchtracking-debug-copy" class="dcg-btn-blue">COPY LOGS</div></div>'), t = e.find("textarea"), o(c).append(e), o("#dcg-touchtracking-debug-copy")[0].addEventListener("mousedown", function () { t[0].select(), document.execCommand("copy") }, !0), r("monitor touches")) }, ignore: function (e) { o(e).addClass("dcg-no-touchtracking") }, isTapActive: function () { return 0 !== g }, elIsFocusable: w } });
define('main/load_data', ['require', 'jquery'], function (require) { "use strict"; return require("jquery")("body").data("load-data") });
define('core/lib/deepCopy', ["require", "exports"], function (require, r) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.default = function r(e) { var t = e; if (t && "function" == typeof t.toJSON && (t = t.toJSON()), !t) return t; if ("object" != typeof t) return t; if (Array.isArray(t)) return t.map(r); var n = {}; for (var o in t) t.hasOwnProperty(o) && (n[o] = r(t[o])); return n } });
define('lib/parse-query-params', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getQueryParams = void 0; e.getQueryParams = function () { var e = ""; try { "?" == (e = location.search)[0] && (e = e.slice(1)) } catch (e) { } for (var r = {}, t = 0, n = e.split("&"); t < n.length; t++) { var o = n[t].split("="); 2 == o.length ? r[o[0]] = decodeURIComponent(o[1]) : r[o[0]] = !0 } return r } });
define('config', ["require", "exports", "core/lib/deepCopy", "lib/parse-query-params"], function (require, e, o, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.all = e.get = void 0; var i = {}, t = n.getQueryParams(); if ("undefined" != typeof Desmos && Desmos.config) for (var r in Desmos.config) Desmos.config.hasOwnProperty(r) && (t[r] = Desmos.config[r]); var s = function (e) { return t.hasOwnProperty(e) }, a = function (e) { i[e] = s(e) }, l = function (e) { i[e] = !s("no" + e) }; a("testing"), a("maintenance"), a("disableScrollFix"), a("nativeOnscreenKeypad"), a("hidden"), a("disableMouseInteractions"), a("advancedStyling"), a("outofdom"), t.lang && (i.language = t.lang), t.fontSize && (i.fontSize = t.fontSize), t.backgroundColor && (i.backgroundColor = "#" + t.backgroundColor), t.textColor && (i.textColor = "#" + t.textColor), i.no_navigation_warning = s("noconcat") || s("testing"), i.previewMessage = "You're previewing some new accessibility features.", i.previewFeedbackUrl = "mailto:feedback@desmos.com"; var c = location && "preview.desmos.com" === location.hostname; i.previewMode = s("previewMode") || c, a("lockViewport"), a("administerSecretFolders"), a("degreeMode"), a("clearIntoDegreeMode"), a("plaidMode"), a("editOnWeb"), a("crossOriginSaveTest"), a("showResetButtonOnGraphpaper"), a("transparentBackground"), a("forceLogModeRegressions"), l("links"), l("trace"), l("zoomFit"), a("expressionsCollapsed"), a("invertedColors"), a("projectorMode"), l("images"), l("folders"), l("settingsMenu"), l("expressionsTopbar"), l("zoomButtons"), l("keypad"), l("graphpaper"), l("expressions"), l("branding"), l("pointsOfInterest"), l("plotSingleVariableImplicitEquations"), l("plotImplicits"), l("plotInequalities"), l("notes"), l("sliders"), a("pauseWhenOffscreen"), a("worksheetSVG"), l("brailleControls"), a("audioTraceKeypad"), l("audio"), a("sciKeypad"), a("4fnKeypad"), a("ans"), s("braille") && (i.braille = !0), l("qwertyKeyboard"), a("restrictedFunctions"), a("forceEnableGeometryFunctions"), l("functionDefinition"), a("singleExpression"), a("restrictedEditing"), a("replaceCommaWith10Exp"), a("replaceRoundWithReciprocal"), s("typingAsteriskWritesTimesSymbol") && (i.typingAsteriskWritesTimesSymbol = !0), l("labels"), l("distributions"), i["4fnKeypad"] ? a("decimalToFraction") : l("decimalToFraction"), a("3d"), s("exponentButtonForSquareRoot") ? i.additionalFunctions = ["exponent"] : t.additionalFunctions && "string" == typeof t.additionalFunctions && (i.additionalFunctions = t.additionalFunctions.split(",")), s("actions") ? i.actions = !0 : s("noactions") ? i.actions = !1 : s("clickableObjects") && (i.actions = !0), e.get = function (e) { return i[e] }, e.all = function () { return o.default(i) } });

define('loadcss!print', function () { });
define('console', ['require'], function (require) { var o = function () { }, n = {}; return ["log", "info", "warn", "error", "assert", "dir", "clear", "profile", "profileEnd", "time", "timeEnd", "group", "groupCollapsed", "groupEnd", "trace"].forEach(function (e) { "undefined" != typeof window && window.console && window.console[e] ? n[e] = function () { Function.prototype.apply.call(window.console[e], window.console, arguments) } : n[e] = o }), n });
define('lib/console', ["require", "exports", "console"], function (require, e, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.warn = e.log = void 0, e.log = o.log, e.warn = o.warn });
define('lib/enabled-languages', ["require", "exports"], function (require, s) { "use strict"; Object.defineProperty(s, "__esModule", { value: !0 }), s.ENABLED_LANGUAGES = s.buildSupportedLanguagesMap = s.expandLocaleOptionsThoroughly = void 0, s.expandLocaleOptionsThoroughly = function (e) { for (var o = [], a = 0, d = e; a < d.length; a++) { var m = d[a]; if (m && "string" == typeof m) { var u = m.split("-")[0]; for (var t in o.push(m), o.push(u), s.ENABLED_LANGUAGES) { var i = s.ENABLED_LANGUAGES[t]; t.split("-")[0] === u && i.useAsRoot && o.push(t) } } } return o }, s.buildSupportedLanguagesMap = function () { var e = {}, o = Object.keys(s.ENABLED_LANGUAGES); for (var a in o) { var d = o[a]; e[d] = { code: d, display_name: s.ENABLED_LANGUAGES[d].displayName } } return e }, s.ENABLED_LANGUAGES = { en: { displayName: "English (US)", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, es: { displayName: "EspaÃ±ol (LATAM)", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_ES-ES.pdf", useAsRoot: !0 }, et: { displayName: "Eesti", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, ru: { displayName: "Ð ÑÑÑÐºÐ¸Ð¹", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_RU.pdf", useAsRoot: !1 }, da: { displayName: "Dansk", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, de: { displayName: "Deutsch", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_DE.pdf", useAsRoot: !1 }, "pt-BR": { displayName: "PortuguÃªs (Brasil)", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !0 }, "pt-PT": { displayName: "PortuguÃªs (Portugal)", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, ca: { displayName: "CatalÃ ", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, fr: { displayName: "FranÃ§ais", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_FR.pdf", useAsRoot: !1 }, it: { displayName: "Italiano", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_IT.pdf", useAsRoot: !1 }, is: { displayName: "Ãslenska", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, nl: { displayName: "Nederlands", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, no: { displayName: "Norsk", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, "sv-SE": { displayName: "Svenska", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !0 }, hu: { displayName: "Magyar", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, cs: { displayName: "ÄeÅ¡tina", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, pl: { displayName: "Polski", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_PL.pdf", useAsRoot: !1 }, id: { displayName: "Bahasa Indonesia", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, vi: { displayName: "Tiáº¿ng Viá»t", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_VI.pdf", useAsRoot: !1 }, el: { displayName: "ÎÎ»Î»Î·Î½Î¹ÎºÎ¬", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_EL.pdf", useAsRoot: !1 }, uk: { displayName: "Ð£ÐºÑÐ°ÑÐ½ÑÑÐºÐ°", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, ka: { displayName: "á¥áá áá£áá", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, th: { displayName: "à¸ à¸²à¸©à¸²à¹à¸à¸¢", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, tr: { displayName: "TÃ¼rkÃ§e", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_TR.pdf", useAsRoot: !1 }, "zh-CN": { displayName: "ç®ä½ä¸­æ", useAsRoot: !0, userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-CN.pdf" }, "zh-TW": { displayName: "ç¹é«ä¸­æ", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_ZH-TW.pdf", useAsRoot: !1 }, ko: { displayName: "íêµ­ì´", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide.pdf", useAsRoot: !1 }, ja: { displayName: "æ¥æ¬èª", userGuideURL: "https://desmos.s3.amazonaws.com/Desmos_User_Guide_JA.pdf", useAsRoot: !1 } } });

define('text!l10n/all-en-strings.ftl', [], function () { return '### Strings shared among tools and homepage\n\n\n### 4915 English words, 890 English strings\n\naccount-shell-button-braille-nemeth = Nemeth\naccount-shell-button-braille-ueb = UEB\naccount-shell-button-cancel = Cancel\naccount-shell-button-clear = Clear\naccount-shell-button-confirm-delete =\n    { $count ->\n        [one] Yes, delete graph\n       *[other] Yes, delete graphs\n    }\naccount-shell-button-contact-us = Contact Us\naccount-shell-button-create-own-activity = Create your own submission activity.\naccount-shell-button-delete = Delete\naccount-shell-button-download-braille = Download Braille Equations\naccount-shell-button-download-png = Download PNG\naccount-shell-button-download-svg = Download SVG\naccount-shell-button-duplicate = Duplicate\naccount-shell-button-duplicate-mac = Duplicate or Rename (cmd+shift+s)\naccount-shell-button-duplicate-pc = Duplicate or Rename (ctrl+shift+s)\naccount-shell-button-embed = Embed\naccount-shell-button-export-image = Export Image\naccount-shell-button-hide-browser-warning = Hide this warning.\naccount-shell-button-line-medium = Medium\naccount-shell-button-line-thick = Thick\naccount-shell-button-line-thin = Thin\naccount-shell-button-log-in = Log In\naccount-shell-button-mygraphs-attempt-recovery = Attempt recovery.\naccount-shell-button-mygraphs-cancel = Cancel\naccount-shell-button-mygraphs-close-graph-list = Close Graph List\naccount-shell-button-mygraphs-close-graph-preview = Close Graph Preview\naccount-shell-button-mygraphs-delete-graph = Delete Graph\naccount-shell-button-mygraphs-delete-title = Delete { $graphTitle }\naccount-shell-button-mygraphs-offline-try-again = offline. click to try again.\naccount-shell-button-mygraphs-save = Save\naccount-shell-button-mygraphs-try-again = Try again\naccount-shell-button-open-construction = Open Construction\naccount-shell-button-open-graph = Open Graph\naccount-shell-button-print = Print\naccount-shell-button-rename = Rename\naccount-shell-button-retry-now = Retry now\naccount-shell-button-save = Save\naccount-shell-button-sign-up = Sign Up\naccount-shell-button-submit = Submit\naccount-shell-button-submit-graph = Submit This Graph\naccount-shell-button-svg-options = SVG Options\naccount-shell-error-art-contest-logged-out = You must be logged in to enter the art contest.\naccount-shell-error-change-email-logged-out = You must be logged in to change your email.\naccount-shell-error-change-name-logged-out = You must be logged in to change your name.\naccount-shell-error-changing-name = There was an error changing your user name.\naccount-shell-error-consent-error = There was an error accepting your consent.\naccount-shell-error-consent-logged-out = You must be logged in to consent to data collection.\naccount-shell-error-create-account-unexpected = Sorry, there was an error creating your account.\naccount-shell-error-delete-graph-logged-out = You must be logged in to delete graphs.\naccount-shell-error-delete-graph-logged-out-2 = You must be logged in to delete a graph.\naccount-shell-error-delete-unexpected = Sorry, there was an unexpected error deleting this graph. Error { $code }.\naccount-shell-error-deletion-error = There was an error. Try again later?\naccount-shell-error-deletion-error-2 = Error while deleting your account.\naccount-shell-error-deletion-link-not-found = We can\'t find that deletion token. Perhaps it\'s been used already?\naccount-shell-error-email-already-registered = Sorry, someone has already registered with this email address.\naccount-shell-error-email-invalid = Please enter a valid email address.\naccount-shell-error-email-password-mismatch = Sorry, your email and password did not match.\naccount-shell-error-email-too-short = Please enter an email address that is at most { $num } characters.\naccount-shell-error-feedback-empty = Please enter your feedback\naccount-shell-error-feedback-unexpected = Sorry, there was an unexpected problem sending feedback. Error { $code }.\naccount-shell-error-graph-too-large = This graph is too large to save. The maximum allowable size is 5 MB.\naccount-shell-error-invalid-deletion-link = This is not a valid deletion link.\naccount-shell-error-invalid-recovery-link = This is not a valid recovery link.\naccount-shell-error-logged-in-register = You are already logged in. You must first log out to register as a different user.\naccount-shell-error-logging-in = Error logging in.\naccount-shell-error-logging-out = Error logging out.\naccount-shell-error-missing-email = Please enter your email address.\naccount-shell-error-missing-name = Please enter your name.\naccount-shell-error-missing-new-password = Please enter your new password.\naccount-shell-error-missing-password = Please enter your password.\naccount-shell-error-mygraphs-check-connection = Check your internet connection?\naccount-shell-error-mygraphs-error-deleting = Error deleting.\naccount-shell-error-mygraphs-error-loading = Error loading graph\naccount-shell-error-name-too-long = Please enter a name that is at most { $num } characters.\naccount-shell-error-new-password-too-long = Please enter a new password that is at most { $num } characters.\naccount-shell-error-new-password-too-short = Please enter a new password that is at least { $num } characters.\naccount-shell-error-password-same-as-old = New password cannot match old password.\naccount-shell-error-password-too-long = Please enter a password that is at most { $num } characters.\naccount-shell-error-password-too-short = Please enter a password that is at least { $num } characters.\naccount-shell-error-passwords-do-not-match = The passwords that you entered did not match. Please try again.\naccount-shell-error-problem-resetting-password = Problem resetting your password. Please try again.\naccount-shell-error-recover-link-not-found = Sorry, we can\'t find that recovery link. Perhaps it\'s been used already?\naccount-shell-error-recover-password-too-short = Passwords must be at least { $num } characters long\naccount-shell-error-recover-unrecognized-email = Sorry, we could not find any users registered with this email address.\naccount-shell-error-request-error = Error while making request.\naccount-shell-error-save-art-contest = Error saving. Please try again later.\naccount-shell-error-save-graph = Sorry, there was an unexpected error saving your graph. Error { $code }.\naccount-shell-error-save-graph-logged-out = You must be logged in to save graphs.\naccount-shell-error-setting-email = Error setting new email.\naccount-shell-error-sharing-link = Sorry, there was an error generating a link to your graph. Check your internet connection.\naccount-shell-error-something-went-wrong = Something went wrong, please report this to desmos.com support. (Error { $error_num })\naccount-shell-error-submitting = Error submitting. Please try again later.\naccount-shell-error-unexpected-error = Unexpected error.\naccount-shell-error-unknown = Sorry! Something went wrong. Please try again later.\naccount-shell-error-update-account-settings-logged-out = You must be logged in to update your account settings.\naccount-shell-error-update-graph-logged-out = You must be logged in to update graphs.\naccount-shell-error-user-info-logged-out = You must be logged in to retrieve user information.\naccount-shell-error-verifying-email = Sorry, there was a problem verifying your email.\naccount-shell-error-view-graphs-logged-out = You must be logged in to view saved graphs.\naccount-shell-heading-3dcalc-page-title = Desmos | 3D Graphing Calculator\naccount-shell-heading-artist-statement = Your Artist Statement\naccount-shell-heading-birth-year = Your Birth Year\naccount-shell-heading-braille-mode = Braille Mode\naccount-shell-heading-contact-us = Contact Us\naccount-shell-heading-country = Your Country\naccount-shell-heading-download-instructions = Download Instructions\naccount-shell-heading-duplicate-construction = Duplicate This Construction\naccount-shell-heading-duplicate-graph = Duplicate This Graph\naccount-shell-heading-embossers = Tactile Graphics Embossers\naccount-shell-heading-embossing-instructions = Embossing Instructions\naccount-shell-heading-export-graph = Export Your Graph\naccount-shell-heading-export-size = Size\naccount-shell-heading-geometry-page-title = Desmos | Geometry\naccount-shell-heading-graphingcalc-page-title = Desmos | Graphing Calculator\naccount-shell-heading-line-thickness = Line Thickness\naccount-shell-heading-math-art-contest = Global Math Art Contest\naccount-shell-heading-mygraphs-examples = Examples\naccount-shell-heading-mygraphs-recovered-work = Recovered Work\naccount-shell-heading-mygraphs-saved-constructions = Saved Constructions\naccount-shell-heading-mygraphs-saved-graphs = Saved Graphs\naccount-shell-heading-name-email = Your Name & Email\naccount-shell-heading-rename-graph = Rename This Graph\naccount-shell-heading-resources = Resources\naccount-shell-heading-save-construction = Save This Construction\naccount-shell-heading-save-graph = Save This Graph\naccount-shell-heading-share-graph = Share Your Graph\naccount-shell-heading-submit-graph = Submit This Graph\naccount-shell-heading-title-mygraphs-search = Search\naccount-shell-heading-tours = Tours\naccount-shell-heading-unsupported-browser = Unsupported Browser\naccount-shell-label-account-information = Account Information\naccount-shell-label-advanced-preferences = Advanced\naccount-shell-label-age-13-14 = Age 13â14\naccount-shell-label-age-15-16 = Age 15â16\naccount-shell-label-age-17-18 = Age 17â18\naccount-shell-label-artiist-statement-description = In 2-3 sentences, describe what motivated you and/or what you learned during this project.\naccount-shell-label-artist-statement-placeholder = Tell us about your graph...\naccount-shell-label-beta = Beta\naccount-shell-label-betchacant-loading = Challenge accepted...\naccount-shell-label-birth-year-placeholder = Birth Year\naccount-shell-label-country-placeholder = Your Country\naccount-shell-label-created-days-ago = { $number } days ago\naccount-shell-label-created-hours-ago = { $number } hours ago\naccount-shell-label-created-last-week = last week\naccount-shell-label-created-minutes-ago = { $number } minutes ago\naccount-shell-label-created-on-date = on { $month } { $day }, { $year }\naccount-shell-label-created-one-hour-ago = one hour ago\naccount-shell-label-created-one-minute-ago = one minute ago\naccount-shell-label-created-seconds-ago = less than a minute ago\naccount-shell-label-created-weeks-ago = { $number } weeks ago\naccount-shell-label-created-yesterday = yesterday\naccount-shell-label-delete-graph-modal-title = Delete Graph\naccount-shell-label-email-address = Email Address\naccount-shell-label-email-placeholder = So we can write back!\naccount-shell-label-export-size-large-rectangle = Large Rectangle\naccount-shell-label-export-size-large-square = Large Square\naccount-shell-label-export-size-medium-rectangle = Medium Rectangle\naccount-shell-label-export-size-medium-square = Medium Square\naccount-shell-label-export-size-small-square = Small Square\naccount-shell-label-feature-flag-actions = Actions\naccount-shell-label-feedback-email = Email Address\naccount-shell-label-feedback-message = Questions? Feedback?\naccount-shell-label-feedback-placeholder = Write to us!\naccount-shell-label-feedback-sending = Sending...\naccount-shell-label-full-name = Full Name\naccount-shell-label-graph-actions = Graph actions\naccount-shell-label-graph-title = Title\naccount-shell-label-help = Help\naccount-shell-label-help-menu = Help Menu\naccount-shell-label-language = Language\naccount-shell-label-loading = Loading...\naccount-shell-label-math-art-contest = Global Math Art Contest\naccount-shell-label-month-apr = Apr\naccount-shell-label-month-aug = Aug\naccount-shell-label-month-dec = Dec\naccount-shell-label-month-feb = Feb\naccount-shell-label-month-jan = Jan\naccount-shell-label-month-jul = Jul\naccount-shell-label-month-jun = Jun\naccount-shell-label-month-mar = Mar\naccount-shell-label-month-may = May\naccount-shell-label-month-nov = Nov\naccount-shell-label-month-oct = Oct\naccount-shell-label-month-sep = Sep\naccount-shell-label-mygraphs-example = example\naccount-shell-label-mygraphs-last-saved = last saved: { $date }\naccount-shell-label-mygraphs-no-unsaved-changes = no unsaved changes\naccount-shell-label-mygraphs-unsaved-graph = unsaved graph\naccount-shell-label-no-unsaved-changes = No Unsaved Changes\naccount-shell-label-open-graph-mac = { $open_graph } (cmd+o)\naccount-shell-label-open-graph-pc = { $open_graph } (ctrl+o)\naccount-shell-label-privacy-policy-changed = Weâve made changes to our privacy policy!\naccount-shell-label-save-changes-mac = Save Changes (cmd+s)\naccount-shell-label-save-changes-pc = Save Changes (ctrl+s)\naccount-shell-label-saving-graph = Saving graph...\naccount-shell-label-share = share\naccount-shell-label-share-graph = Share Graph\naccount-shell-label-share-link = Share this link:\naccount-shell-label-submission-received = Submission Received!\naccount-shell-label-submitting = Submitting...\naccount-shell-label-success = Success!\naccount-shell-label-you-are-eligible = You\'re eligible to participate in the Global Math Art Contest 2021!\naccount-shell-label-zoom = Zoom: { $value }%\naccount-shell-link-account-settings = Account Settings\naccount-shell-link-download-chrome = Click here to download Google Chrome.\naccount-shell-link-email-support = Email Our Support Team\naccount-shell-link-getting-started = Getting Started\naccount-shell-link-help = Help\naccount-shell-link-help-center = Help Center\naccount-shell-link-keyboard-shortcuts = Keyboard Shortcuts\naccount-shell-link-learn-more = Learn More\naccount-shell-link-mygraphs-log-in = Log In\naccount-shell-link-mygraphs-sign-up = Sign Up\naccount-shell-link-privacy = Privacy Policy\naccount-shell-link-share-thoughts = Share your thoughts!\naccount-shell-link-sign-out = Sign Out\naccount-shell-link-terms = Terms of Service\naccount-shell-link-user-guide = Desmos User Guide\naccount-shell-link-video-tutorials = Video Tutorials\naccount-shell-narration-back = Back\naccount-shell-narration-clear-selected-country = Clear Selected Country\naccount-shell-narration-graph-preview = Graph Preview\naccount-shell-narration-image-download = Image Download\naccount-shell-narration-language-menu = Language Options Menu\naccount-shell-narration-mygraphs-open-graph = Open graph\naccount-shell-narration-share-options = Share Options\naccount-shell-narration-size-options = Size Options\naccount-shell-text-3d-confirm-leave = Are you sure you want to leave this construction? Your unsaved work will be lost.\naccount-shell-text-advanced-preferences-instructions = Try these advanced features. Feel free to send any questions or feedback to support@desmos.com.\naccount-shell-text-alt-text-art-contest = Earth with students from different countries and a red ribbon around it. Illustration.\naccount-shell-text-alt-text-success = Five people standing around and talking about an exciting piece of art in a museum. Illustration.\naccount-shell-text-art-contest-about-paragraph = Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before<1> January 15th </1>for a chance to be featured on our website and win other prizes! <2>Learn more</2>\naccount-shell-text-art-contest-congratulations = Congratulations, and keep graphing!\naccount-shell-text-art-contest-copyright-agreement = This is my original work and doesn\'t use copyrighted material.\naccount-shell-text-art-contest-notice-default = Open one of your saved graphs or create a new one!\naccount-shell-text-art-contest-notice-login = If you want to submit a graph you\'ve made, please sign in and open your graph.\naccount-shell-text-art-contest-success-paragraph = If you\'d like to revise your submission, feel free to resubmit anytime before<1> January 15th</1>{"."} We\'ll only look at the most recent submission.\naccount-shell-text-artcontest-ineligible = <1><2>Based on your age and location, we arenât able to accept a graph submission from you this year. Save it for another year, or ask your teacher to assign the art contest activity.</2><3>Keep up the awesome graphing!</3></1>\naccount-shell-text-check-recovery-link = Please check your email for a password recovery link.\naccount-shell-text-confirm-leave = Are you sure you want to leave this graph? Your unsaved work will be lost.\naccount-shell-text-construction-cleared = Construction Cleared.\naccount-shell-text-contest-submit-by-teacher = Are you a teacher looking to submit your students\' graphs?\naccount-shell-text-contest-under-16 = Under 16?\naccount-shell-text-contest-verify-eligibility = Verify your eligibility\naccount-shell-text-copy-of-title = [Copy of] { $originalTitle }\naccount-shell-text-delete-graphs-confirmation =\n    Are you sure you want to delete { $count ->\n        [one] "{ $title }"\n       *[other] the { $count } selected graphs\n    }?\naccount-shell-text-download-instructions = To download, right click on the image of the graph select "Save As." You might also be able to click and drag the image onto your desktop.\naccount-shell-text-embossing-etc-print = Set paper size to { $size }. Then click "Edit" and select File > Emboss.\naccount-shell-text-embossing-etc-save = Save this image. Open Firebird, select File > Open > Image File, and open the image.\naccount-shell-text-embossing-vpmax-print = Right click image and select "print". Set paper size to { $size }.\naccount-shell-text-embossing-vpmax-save = Right click graph image and save to desktop.\naccount-shell-text-error = error\naccount-shell-text-feature-flag-actions-description = Make graphs interactive by defining rules for responding to clicks or to the passage of time.\naccount-shell-text-feedback-sent = Thanks! We\'ll be in touch.\naccount-shell-text-geometry-confirm-leave = Are you sure you want to leave this construction? Your unsaved work will be lost.\naccount-shell-text-graph-cleared = Graph cleared.\naccount-shell-text-graph-uses-advanced-features = This graph uses advanced features.\naccount-shell-text-local-regulations-notice = Local regulations require you to submit your graph through your teacher or guardian. Share this link with them:\naccount-shell-text-logged-in = Logged in successfully!\naccount-shell-text-login-window-blocked-apple = Login window blocked. Please allow popups from desmos.com to sign in with Apple\naccount-shell-text-login-window-blocked-google = Login window blocked. Please allow popups from desmos.com to sign in with Google.\naccount-shell-text-maintenance-mode = Desmos is in Maintenance Mode.\naccount-shell-text-mygraphs-attempting-recovery = Attempting recovery...\naccount-shell-text-mygraphs-count-more = { $count } more...\naccount-shell-text-mygraphs-current-construction = Current Construction\naccount-shell-text-mygraphs-current-graph = Current Graph\naccount-shell-text-mygraphs-deleting = Deleting...\naccount-shell-text-mygraphs-loading = Loading...\naccount-shell-text-mygraphs-lost-work = Lost work?\naccount-shell-text-mygraphs-maintenance-mode = Desmos is temporarily in maintenance mode. You can open example graphs, but won\'t be able to sign in, open your graphs, or save any changes. We\'re so sorry for the inconvenience.\naccount-shell-text-mygraphs-new-blank-graph = New Blank Graph\naccount-shell-text-mygraphs-new-construction = New Construction\naccount-shell-text-mygraphs-no-examples-match-search = No examples match your search.\naccount-shell-text-mygraphs-no-saved-graphs = No saved graphs yet.\naccount-shell-text-mygraphs-no-search-results = No saved graphs match your search.\naccount-shell-text-mygraphs-no-unsaved-graphs = Couldn\'t find any unsaved graphs.\naccount-shell-text-mygraphs-opened-graph = Opened \'{ $graphTitle }\'\naccount-shell-text-mygraphs-opening = Opening...\naccount-shell-text-mygraphs-or = or\naccount-shell-text-mygraphs-search-by-title = search by title\naccount-shell-text-mygraphs-share-thoughts = Share your thoughts!\naccount-shell-text-mygraphs-slow-big-constructions = This can take a little while for big constructions...\naccount-shell-text-mygraphs-slow-big-graphs = This can take a little while for big graphs...\naccount-shell-text-mygraphs-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>\naccount-shell-text-mygraphs-synced = synced!\naccount-shell-text-mygraphs-to-save-constructions = to save your constructions!\naccount-shell-text-mygraphs-to-save-graphs = to save your graphs!\naccount-shell-text-mygraphs-updating-graphs = updating graphs...\naccount-shell-text-mygraphs-version = Version\naccount-shell-text-new-construction-created = New construction created.\naccount-shell-text-new-graph-created = New graph created.\naccount-shell-text-or = or\naccount-shell-text-saved = saved\naccount-shell-text-share-submit-to-contest = <1>Submit this graph to the <2>Global Math Art Contest!</2></1>\naccount-shell-text-unsupported-browser-android = Desmos works best on your version of Android if you use the Chrome Browser.\naccount-shell-text-untitled = Untitled\naccount-shell-text-untitled-graph = Untitled Graph\nshared-button-accept = Accept\nshared-button-cancel = Cancel\nshared-button-change-email-address = Change email address\nshared-button-change-email-and-password = Change email and password\nshared-button-close-dialog = Close Dialog\nshared-button-confirm-name = Confirm Name\nshared-button-continue-to-desmos = Continue to Desmos\nshared-button-create-account = Create Account\nshared-button-delete-account-question = Delete your Desmos account?\nshared-button-email-address-narrow = Email\nshared-button-email-address-wide = Email Address\nshared-button-external-account-narrow = External\nshared-button-external-account-wide = External Account\nshared-button-go-to-account-settings = Go to Account Settings\nshared-button-google-account-narrow = Google\nshared-button-google-account-wide = Google Account\nshared-button-i-am-not-a-teacher = I am not a teacher.\nshared-button-learn-more-capitalized = Learn More\nshared-button-login = Log in\nshared-button-login-capitalized = Log In\nshared-button-login-with-apple = Log in with Apple\nshared-button-login-with-google = Log in with Google\nshared-button-more-options-menu = More Options\nshared-button-recover-password = Recover Password\nshared-button-save = Save\nshared-button-send-delete-account-email = Send Delete Account Email\nshared-button-send-email = Send Email\nshared-button-sign-up-as-a-teacher = Sign up as a teacher.\nshared-button-try-again = Didn\'t work? Try again!\nshared-calculator-button-braille-mode-nemeth = Nemeth\nshared-calculator-button-braille-mode-ueb = UEB\nshared-calculator-button-clear = clear\nshared-calculator-button-clear-all = clear all\nshared-calculator-button-controlbar-functions = functions\nshared-calculator-button-language = Language\nshared-calculator-button-mac = Mac Shortcuts\nshared-calculator-button-print = Print\nshared-calculator-button-reverse-contrast = Reverse Contrast\nshared-calculator-button-windows-chrome = Windows / ChromeOS Shortcuts\nshared-calculator-error-action-merge-free-variable = Cannot combine an action that depends on free variable \'{ $symbol }\'.\nshared-calculator-error-add-arguments-to-definition-many = Try including \'{ $symbols }\' and \'{ $lastSymbol }\' as arguments by defining the function as \'{ $newSignature }\'.\nshared-calculator-error-add-arguments-to-definition-one = Try including \'{ $lastSymbol }\' as an argument by defining the function as \'{ $newSignature }\'.\nshared-calculator-error-add-type-error = Cannot add { $symbol1 } and { $symbol2 }.\nshared-calculator-error-adjacent-numbers = Sorry, I don\'t know what to do with adjacent numbers \'{ $left }\' and \'{ $right }\'. Try using parentheses or a \'*\' symbol.\nshared-calculator-error-and-type-error = Cannot apply { $symbol } to { $symbol1 } and { $symbol2 }.\nshared-calculator-error-ans-undefined = The previous expression didn\'t define any value for ans.\nshared-calculator-error-assignments-unsupported = This calculator does not support defining variables.\nshared-calculator-error-bad-implicit-call = Use parentheses around the argument of \'{ $symbol }\'.\nshared-calculator-error-bad-integral-bound-dependency = Integration bounds can\'t depend on integration variable \'{ $symbol }\'.\nshared-calculator-error-bad-list-comprehension-input-dependency = List comprehension input list can\'t depend on input variable \'{ $symbol }\'.\nshared-calculator-error-bad-log-exponent = Only { $form } is supported. Otherwise, use parens.\nshared-calculator-error-bad-product-bound-dependency = Product bounds can\'t depend on product index \'{ $symbol }\'.\nshared-calculator-error-bad-sample-size = Sample size must be a finite, non-negative number.\nshared-calculator-error-bad-sum-bound-dependency = Summation bounds can\'t depend on summation index \'{ $symbol }\'.\nshared-calculator-error-bad-symbol-context = You can\'t use \'{ $symbol }\' in this context.\nshared-calculator-error-bad-trig-exponent = Only { $form1 } and { $form2 } are supported. Otherwise, use parens.\nshared-calculator-error-bad-tuple-dimensions = Points may only have { $symbol } coordinates.\nshared-calculator-error-binary-operator-missing-operand = You need something on both sides of the \'{ $symbol }\' symbol.\nshared-calculator-error-blank-expression = You haven\'t written anything yet.\nshared-calculator-error-boxplot-breadth-invalid = Invalid height. Try using any number.\nshared-calculator-error-boxplot-offset-invalid = Invalid offset. Try using any number.\nshared-calculator-error-cannot-redefine = You can\'t redefine \'{ $symbol }\' because it\'s already defined.\nshared-calculator-error-cannot-redefine-root = You can\'t define \'{ $symbol }\' because \'{ $symbolRoot }\' is already defined.\nshared-calculator-error-cannot-subscript = \'{ $symbol }\' cannot have a subscript.\nshared-calculator-error-cdf-max-invalid = Invalid cdf max. Try using any number.\nshared-calculator-error-cdf-max-less-than-min = Invalid cdf limits. Min should be less than max.\nshared-calculator-error-cdf-min-invalid = Invalid cdf min. Try using any number.\nshared-calculator-error-cdf-too-many-arguments = \'cdf\' should be called on a distribution with at most two numbers. { $recommendation }\nshared-calculator-error-cdf-too-many-arguments-recommendation = For example, try typing: D.cdf(-1,1) where D=normaldist().\nshared-calculator-error-cdf-wrong-arity = \'cdf\' should be called on a distribution with at least one number. { $recommendation }\nshared-calculator-error-cdf-wrong-arity-recommendation = For example, try typing: D.cdf(x) where D=normaldist().\nshared-calculator-error-clickable-object-assignment-not-defined = "{ $symbol }" is not defined. Try using a different variable or adding a slider.\nshared-calculator-error-clickable-object-assignment-not-identifier = Invalid symbol. Try using a single letter.\nshared-calculator-error-clickable-object-invalid-expression = Can\'t evaluate this. Try a number or simple expression.\nshared-calculator-error-colon-missing-condition = The left side of a \':\' must be a condition, like \'x>1\'.\nshared-calculator-error-color-arity = \'{ $symbol }\' should be called with 3 arguments. { $recommendation }\nshared-calculator-error-color-arity-recommendation = For example, try typing: { $recommendation }.\nshared-calculator-error-color-not-assigned = To use a color, you must assign it to a variable.\nshared-calculator-error-combine-type-error = Cannot combine { $symbol1 } and { $symbol2 }.\nshared-calculator-error-comparator-type-error = Cannot compare { $symbol1 } to { $symbol2 }.\nshared-calculator-error-complicated-double-inequality = We only support solved double inequalities. Try deleting one side of the inequality.\nshared-calculator-error-complicated-polar-implicit = Polar equations must be linear in r.\nshared-calculator-error-constant-unsupported = This calculator does not support the constant \'{ $symbol }\'.\nshared-calculator-error-deeply-nested = Definitions are nested too deeply.\nshared-calculator-error-dependency-cycle = \'{ $symbols }\' and \'{ $lastSymbol }\' can\'t be defined in terms of each other.\nshared-calculator-error-derivative-missing-body = What do you want to take the derivative of?\nshared-calculator-error-derivative-type-error = Cannot take the derivative of { $symbol }.\nshared-calculator-error-derivative-variable-type-error = Cannot take derivative with respect to \'{ $symbol1 }\' because it is { $symbol2 }.\nshared-calculator-error-differential-with-superscript = Integration variable cannot have a superscript.\nshared-calculator-error-distribution-as-function = Cannot call distribution \'{ $symbol }\' as a function. Try \'{ $symbol }.pdf(x)\'.\nshared-calculator-error-divide-type-error = Cannot divide { $symbol1 } by { $symbol2 }.\nshared-calculator-error-domain-max-invalid = Invalid domain max. Try using any number.\nshared-calculator-error-domain-max-less-than-min = Invalid domain limits. Min should be less than max.\nshared-calculator-error-domain-min-invalid = Invalid domain min. Try using any number.\nshared-calculator-error-dot-lhs-type-error = Cannot call \'{ $symbol }\' on { $type }.\nshared-calculator-error-duplicate-update-rules = An action cannot specify multiple update rules for \'{ $symbol }\'.\nshared-calculator-error-empty-paren = Parentheses cannot be empty.\nshared-calculator-error-empty-pipe = Absolute value symbol cannot be empty.\nshared-calculator-error-empty-radical = Radical cannot be empty.\nshared-calculator-error-empty-radical-index = Radical index cannot be empty.\nshared-calculator-error-empty-square-bracket = Square brackets cannot be empty.\nshared-calculator-error-empty-subscript = Subscripts cannot be empty.\nshared-calculator-error-empty-superscript = Superscripts cannot be empty.\nshared-calculator-error-equation-required = Try adding an equals sign to turn this into an equation.\nshared-calculator-error-equation-required-symbol = Try adding \'{ $lhs }\' to the beginning of this equation.\nshared-calculator-error-equations-unsupported = This calculator does not support this type of equation.\nshared-calculator-error-event-handler-type-error = This should be an action. Try \'{ $example }\'.\nshared-calculator-error-exponent-type-error = Cannot raise { $symbol1 } to { $symbol2 }.\nshared-calculator-error-feature-unavailable = This feature is not available in the current calculator.\nshared-calculator-error-fraction-empty = You need a numerator and denominator for your fraction.\nshared-calculator-error-fraction-missing-denominator = You need a denominator for the bottom of your fraction.\nshared-calculator-error-fraction-missing-numerator = You need a numerator for the top of your fraction.\nshared-calculator-error-function-definition-unsupported = This calculator does not support function definitions.\nshared-calculator-error-function-not-defined = Function \'{ $dependency }\' is not defined.\nshared-calculator-error-function-type-error-1 = Function \'{ $fn }\' cannot be applied to { $arg }.\nshared-calculator-error-function-type-error-2 = Function \'{ $fn }\' cannot be applied to { $arg1 } and { $arg2 }.\nshared-calculator-error-function-type-error-many = Function \'{ $fn }\' cannot be applied to these arguments.\nshared-calculator-error-function-unsupported = This calculator does not support the \'{ $symbol }\' function.\nshared-calculator-error-heterogeneous-list = All elements of a list must have the same type.\nshared-calculator-error-identifier-as-function = \'{ $symbol }\' is a function. Try using parentheses.\nshared-calculator-error-illegal-bin-width = The second argument to \'{ $symbol }\' must be a positive number.\nshared-calculator-error-illegal-dot-call = Function \'{ $symbol }\' cannot be called with dot notation.\nshared-calculator-error-implicits-disabled = Plotting implicit equations and inequalities is disabled.\nshared-calculator-error-incorrect-list-comprehension-input = Inputs to a list comprehension must set a variable equal to a list. Try i=[1...10].\nshared-calculator-error-incorrect-product-lower-bound = Lower bound of a product must set a variable equal to a number. Try n=1.\nshared-calculator-error-incorrect-sum-lower-bound = Lower bound of a sum must set a variable equal to a number. Try n=1.\nshared-calculator-error-index-type-error = Cannot index { $symbol1 } with { $symbol2 }.\nshared-calculator-error-inequalities-disabled = Plotting inequalities is disabled.\nshared-calculator-error-inequalities-unsupported = This calculator does not support inequalities.\nshared-calculator-error-inequality-chain-too-long = Cannot chain more than 2 inequalities.\nshared-calculator-error-integral-argument-type-error = Cannot take the integral of { $symbol }.\nshared-calculator-error-integral-lower-bound-type-error = Lower bound of an integral cannot be { $symbol }.\nshared-calculator-error-integral-missing-body = What do you want to take the integral of?\nshared-calculator-error-integral-missing-bound = Integrals must have upper and lower bounds.\nshared-calculator-error-integral-missing-differential = Integrand must end with an integration variable, like dx.\nshared-calculator-error-integral-upper-bound-type-error = Upper bound of an integral cannot be { $symbol }.\nshared-calculator-error-invalid-dependent-first-table-column = This column header can\'t be defined elsewhere in the calculator.\nshared-calculator-error-invalid-double-inequality-variables = We only plot double inequalities of x and y.\nshared-calculator-error-invalid-first-table-column = First column may not be { $most } or { $last }.\nshared-calculator-error-invalid-half-empty-range = Range must have an upper and lower bound.\nshared-calculator-error-invalid-implicit-variables = We only support implicit equations of x and y.\nshared-calculator-error-invalid-inequality-variables = We only plot inequalities of x and y, or r and Î¸.\nshared-calculator-error-invalid-lhs = Sorry, you can\'t graph { $symbol } as a function of anything yet.\nshared-calculator-error-invalid-operator-name = Operator names may only contain letters.\nshared-calculator-error-invalid-regression-parameter = \'{ $symbol }\' may not be used as a regression parameter. Try using a list.\nshared-calculator-error-invalid-subscript = Subscripts may only contain letters and digits. \'{ $symbol }\' is not allowed.\nshared-calculator-error-invalid-table-entry = Table entries must be simple expressions. { $supplement }\nshared-calculator-error-invalid-table-header = Table headers must be simple expressions. { $supplement }\nshared-calculator-error-list-comprehension-input-type-error = An input to a list comprehension must be a list, but { $identifier } is { $actual }. Try { $identifier }=[1...10].\nshared-calculator-error-list-type-error = Cannot store { $symbol1 } in a list.\nshared-calculator-error-logbase-unsupported = This calculator does not support specifying the base of a logarithm. Try \'log\' or \'ln\'.\nshared-calculator-error-malformed-list = Lists are written like this: [1, 2, 3].\nshared-calculator-error-malformed-point = Points are written like this: (1, 2).\nshared-calculator-error-matrix-add-dimensions = Cannot add matrices with different dimensions.\nshared-calculator-error-matrix-assignment = This calculator does not support this type of variable definition. Try using \'New Matrix\'.\nshared-calculator-error-matrix-element-type-error = Cannot use { $arg } as an element of a matrix.\nshared-calculator-error-matrix-fractional-power = A matrix can only be raised to integer powers.\nshared-calculator-error-matrix-invalid-variable = Cannot use \'{ $symbol }\' as a variable.\nshared-calculator-error-matrix-multiply-dimensions = Cannot multiply matrices with incompatible dimensions.\nshared-calculator-error-matrix-power-dimensions = Only square matrices can be raised to a power.\nshared-calculator-error-matrix-subtract-dimensions = Cannot subtract matrices with different dimensions.\nshared-calculator-error-max-list-size = Lists may not have more than { $maxListSize } elements.\nshared-calculator-error-method-requires-list = \'{ $symbol }\' requires a list. For example, try typing: { $recommendation }.\nshared-calculator-error-mismatched-braces = Expected \'{ $symbol1 }\' to match \'{ $symbol2 }\'.\nshared-calculator-error-mismatched-double-inequality = Double inequalities must both go the same way, e.g. { $example }.\nshared-calculator-error-multiply-defined = You\'ve defined \'{ $dependency }\' in more than one place. Try deleting some of the definitions of \'{ $dependency }\'.\nshared-calculator-error-multiply-type-error = Cannot multiply { $symbol1 } by { $symbol2 }.\nshared-calculator-error-negative-type-error = Cannot negate { $symbol }.\nshared-calculator-error-non-arithmetic-range = Ranges must be arithmetic sequences.\nshared-calculator-error-non-list-double-reducer = Both arguments of \'{ $symbol }\' must be lists. For example, try typing: { $recommendation }.\nshared-calculator-error-non-list-parameterized-reducer = The first argument of \'{ $symbol }\' must be a list. For example, try typing: { $recommendation }.\nshared-calculator-error-non-singular-inverse = Singular matrices do not have an inverse.\nshared-calculator-error-non-square-determinant = Only square matrices have a determinant.\nshared-calculator-error-non-square-inverse = Only square matrices have an inverse.\nshared-calculator-error-non-square-trace = Only square matrices have a trace.\nshared-calculator-error-optimization-error = We couldn\'t find any region where this model is defined.\nshared-calculator-error-ordered-pair-access-type-error = Cannot access a coordinate of { $symbol }.\nshared-calculator-error-parameter-already-defined = You can\'t use \'{ $dependency }\' as a parameter of this function because \'{ $dependency }\' is already defined.\nshared-calculator-error-parse-error = Sorry, I don\'t understand this.\nshared-calculator-error-pdf-wrong-arity = \'pdf\' should be called on a distribution with a number. { $recommendation }\nshared-calculator-error-pdf-wrong-arity-recommendation = For example, try typing: D.pdf(x) where D=normaldist().\nshared-calculator-error-percent-missing-of = \'%\' must be used with \'of\'. Try \'25% of 12\'.\nshared-calculator-error-piecewise-branch-length-error = When a piecewise condition depends on a free variable (like "{ $symbol }") and its branches are lists, the lists must have the same length.\nshared-calculator-error-piecewise-branch-type-error = Cannot use { $symbol1 } and { $symbol2 } as the branches in a piecewise. Every branch must have the same type.\nshared-calculator-error-piecewise-condition-type-error = The condition in a piecewise expression must be { $symbol1 } but was { $symbol2 }.\nshared-calculator-error-piecewise-missing-condition = A piecewise expression must have at least one condition.\nshared-calculator-error-piecewise-part-missing-condition = Every part of a piecewise expression must have a condition except the last.\nshared-calculator-error-point-type-error = Cannot use { $symbol1 } as a coordinate of { $symbol2 }.\nshared-calculator-error-points-unsupported = This calculator does not support points.\nshared-calculator-error-polygon-list-type-error = A single argument to polygon should be a point list, not { $type }.\nshared-calculator-error-polygon-point-args-error = Some of your arguments are not points.\nshared-calculator-error-prime-without-paren = Primed function calls must use parentheses.\nshared-calculator-error-primed-function-arity = Prime notation can only be used for functions of a single argument.\nshared-calculator-error-product-argument-type-error = Cannot take the product of { $symbol }.\nshared-calculator-error-product-infinite-bound-type-error = Product bounds must be finite numbers.\nshared-calculator-error-product-lower-bound-type-error = Lower bound of a product cannot be { $symbol }.\nshared-calculator-error-product-missing-body = What do you want to take the product of?\nshared-calculator-error-product-missing-bound = Products must have upper and lower bounds.\nshared-calculator-error-product-upper-bound-type-error = Upper bound of a product cannot be { $symbol }.\nshared-calculator-error-random-arity = \'random\' should be called with no arguments, or an optional number of samples. For example, try random() or random(10).\nshared-calculator-error-random-from-broadcast-distribution = Cannot sample from a list of distributions\nshared-calculator-error-regression-type-error = Cannot regress { $symbol1 } against { $symbol2 }.\nshared-calculator-error-regressions-unsupported = This calculator does not support regressions.\nshared-calculator-error-self-referential-function = The definition of function \'{ $symbol }\' cannot depend on \'{ $symbol }\'.\nshared-calculator-error-shadowed-index = You can\'t use \'{ $symbol }\' as an index because it\'s already defined.\nshared-calculator-error-shadowed-integration-variable = You can\'t use \'{ $symbol }\' as an integration variable because it\'s already defined.\nshared-calculator-error-shadowed-list-comprehension-input = You can\'t use \'{ $symbol }\' as a list comprehension input because it\'s already defined.\nshared-calculator-error-single-variable-implicit-equations-disabled = Plotting single-variable implicit equations is disabled.\nshared-calculator-error-slider-limit-references-export = Slider limits cannot depend on the slider variable \'{ $symbol }\'.\nshared-calculator-error-slider-max-invalid = Invalid slider max. Try using any number.\nshared-calculator-error-slider-max-less-than-min = Invalid slider limits. Min should be less than max.\nshared-calculator-error-slider-min-invalid = Invalid slider min. Try using any number.\nshared-calculator-error-slider-step-invalid = Invalid slider step. Try using any number.\nshared-calculator-error-subtract-type-error = Cannot subtract { $symbol2 } from { $symbol1 }.\nshared-calculator-error-sum-argument-type-error = Cannot take the sum of { $symbol }.\nshared-calculator-error-sum-infinite-bound-type-error = Summation bounds must be finite numbers.\nshared-calculator-error-sum-lower-bound-type-error = Lower bound of a sum cannot be { $symbol }.\nshared-calculator-error-sum-missing-body = What do you want to take the sum of?\nshared-calculator-error-sum-missing-bound = Sums must have upper and lower bounds.\nshared-calculator-error-sum-upper-bound-type-error = Upper bound of a sum cannot be { $symbol }.\nshared-calculator-error-superscript-with-prime = Superscripts and primes cannot be combined.\nshared-calculator-error-table-entry-type-error = Table entry cannot be { $symbol }.\nshared-calculator-error-table-equation-supplement = Equations are not allowed.\nshared-calculator-error-table-function-definition-supplement = Function definitions are not allowed.\nshared-calculator-error-table-generic-supplement = This type of expression is not allowed.\nshared-calculator-error-table-header-type-error = Table header cannot be { $symbol }.\nshared-calculator-error-table-inequality-supplement = Inequalities are not allowed.\nshared-calculator-error-table-list-supplement = Lists are not allowed.\nshared-calculator-error-table-regression-supplement = Regressions are not allowed.\nshared-calculator-error-tdist-wrong-arity = \'tdist\' requires 1 argument. For example, try typing: tdist(1).\nshared-calculator-error-ticker-min-step-nonnegative = Min step must evaluate to a non-negative number.\nshared-calculator-error-token-with-subscript = Tokens may not have subscripts.\nshared-calculator-error-too-many-arguments = \'{ $symbol }\' accepts at most { $max } arguments.\nshared-calculator-error-too-many-variables-many-symbols = Too many variables. Try defining \'{ $variables }\' or \'{ $lastVariable }\'.\nshared-calculator-error-too-many-variables-no-symbols = Too many variables, I don\'t know what to do with this.\nshared-calculator-error-too-many-variables-one-symbol = Too many variables. Try defining \'{ $variable }\'.\nshared-calculator-error-ttest-list-too-short = Lists for \'{ $symbol }\' must have at least 2 elements.\nshared-calculator-error-two-numbers-error = Cannot make a polygon from two numbers.\nshared-calculator-error-unary-operator-missing-left = You need something before the \'{ $symbol }\' symbol.\nshared-calculator-error-unary-operator-missing-right = You need something after the \'{ $symbol }\' symbol.\nshared-calculator-error-unexpected-for-keyword = \'for\' can only be used inside a list. Try [i for i=[1...10]].\nshared-calculator-error-unexpected-inequality = Cannot use an inequality here.\nshared-calculator-error-unexpected-prime = Sorry, I don\'t understand this use of prime notation.\nshared-calculator-error-unexpected-subscript = Only functions and variables may have subscripts.\nshared-calculator-error-unexpected-symbol = Sorry, I don\'t understand the way that \'{ $symbol }\' is used here.\nshared-calculator-error-unknown = Unknown Error\nshared-calculator-error-unplottable-polar-function = We can\'t plot Î¸ as a function of r. Try plotting r(Î¸) instead.\nshared-calculator-error-unrecognized-symbol = Sorry, I don\'t understand the \'{ $symbol }\' symbol.\nshared-calculator-error-update-rule-function-lhs = \'{ $symbol }\' cannot be updated because it is a function.\nshared-calculator-error-update-rule-illegal-lhs = Variable \'{ $symbol }\' cannot be updated.\nshared-calculator-error-update-rule-local-lhs = Variable \'{ $symbol }\' cannot be updated because it is locally defined.\nshared-calculator-error-update-rule-non-identifier-lhs = The left hand side of \'{ $arrow }\' should be a variable name like \'{ $example }\'.\nshared-calculator-error-update-rule-type-error = Cannot update a variable to { $symbol }.\nshared-calculator-error-update-rule-undefined-lhs = Variable \'{ $symbol }\' must be defined to be updated.\nshared-calculator-error-variable-as-function = Variable \'{ $dependency }\' can\'t be used as a function.\nshared-calculator-error-variable-filter = List filters cannot depend on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-function-free-variable = Function \'{ $functionSymbol }\' cannot depend on free variable \'{ $variableSymbol }\'.\nshared-calculator-error-variable-length-distribution-list = The length of a list of distributions can\'t depend on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-length-product-body-depends-on-index = Can\'t take the product of a list whose length depends on product index \'{ $symbol }\'.\nshared-calculator-error-variable-length-sum-body-depends-on-index = Can\'t sum a list whose length depends on summation index \'{ $symbol }\'.\nshared-calculator-error-variable-length-top-level-list = Can\'t plot a list whose length depends on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-list-indices = List indices cannot depend on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-range = Range cannot depend on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-sample-size = Sample size cannot depend on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-seed = Random seed cannot depend on free variable \'{ $symbol }\'.\nshared-calculator-error-variable-unsupported = This calculator does not support the \'{ $symbol }\' variable.\nshared-calculator-error-variables-unsupported = This calculator does not support variables like \'{ $variable }\'.\nshared-calculator-error-wrong-arity-many-arg = Function \'{ $dependency }\' requires { $assignment_arity } arguments. { $supplement }\nshared-calculator-error-wrong-arity-single-arg-too-few = Function \'{ $dependency }\' requires an argument. { $supplement }\nshared-calculator-error-wrong-arity-single-arg-too-many = Function \'{ $dependency }\' requires only 1 argument. { $supplement }\nshared-calculator-error-wrong-arity-supplement = For example, try typing: { $recommendation }.\nshared-calculator-error-wrong-two-arg-arity = Function \'{ $symbol }\' requires 2 arguments. For example, try typing: { $recommendation }.\nshared-calculator-error-zero-arg-reducer = Function \'{ $symbol }\' requires at least one argument. For example, try typing: { $symbol }(1, 2).\nshared-calculator-heading-function-table-column-header = Function\nshared-calculator-heading-keyboard-shortcuts = Keyboard Shortcuts\nshared-calculator-heading-keyboard-shortcuts-audio-tracing = Audio Tracing\nshared-calculator-heading-keyboard-shortcuts-braille = Braille\nshared-calculator-heading-keyboard-shortcuts-common-actions = Common Actions\nshared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation = Expression Entry and Navigation\nshared-calculator-heading-keyboard-shortcuts-graphs-with-interactive-points = Graphs with Interactive Points\nshared-calculator-heading-keyboard-shortcuts-sliders = Sliders\nshared-calculator-heading-keyboard-shortcuts-symbols = Symbols\nshared-calculator-heading-keyboard-shortcuts-tables = Tables\nshared-calculator-heading-mac-table-column-header = Mac Shortcut\nshared-calculator-heading-shortcut-table-column-header = Shortcut\nshared-calculator-heading-windows-chrome-table-column-header = Windows / ChromeOS Shortcut\nshared-calculator-label-saved = Saved!\nshared-calculator-label-saving = Saving...\nshared-calculator-label-settings-display = Display\nshared-calculator-label-toast-learn-more = Learn more\nshared-calculator-label-toast-undo = Undo\nshared-calculator-label-tooltip-convert-to-decimal = Convert to decimal.\nshared-calculator-label-tooltip-convert-to-fraction = Convert to fraction.\nshared-calculator-label-value-type-action = an action\nshared-calculator-label-value-type-any = an unknown object\nshared-calculator-label-value-type-bool = a true/false value\nshared-calculator-label-value-type-color = a color\nshared-calculator-label-value-type-distribution = a distribution\nshared-calculator-label-value-type-empty-list = an empty list\nshared-calculator-label-value-type-error = an error object\nshared-calculator-label-value-type-list-of-any = a list of unknown objects\nshared-calculator-label-value-type-list-of-bool = a list of true/false values\nshared-calculator-label-value-type-list-of-colors = a list of colors\nshared-calculator-label-value-type-list-of-distributions = a list of distributions\nshared-calculator-label-value-type-list-of-numbers = a list of numbers\nshared-calculator-label-value-type-list-of-points = a list of points\nshared-calculator-label-value-type-list-of-polygons = a list of polygons\nshared-calculator-label-value-type-matrix = a matrix\nshared-calculator-label-value-type-number = a number\nshared-calculator-label-value-type-point = a point\nshared-calculator-label-value-type-polygon = a polygon\nshared-calculator-label-value-type-seed = a string\nshared-calculator-narration-braille-mode = Braille Mode\nshared-calculator-narration-braille-mode-nemeth = Braille mode Nemeth\nshared-calculator-narration-braille-mode-off = Braille mode off\nshared-calculator-narration-braille-mode-ueb = Braille mode UEB\nshared-calculator-narration-control-toggle-switch-to-default = { $toggled } selected. Press Enter to switch to { $default }.\nshared-calculator-narration-control-toggle-switch-to-toggled = { $default } selected. Press Enter to switch to { $toggled }.\nshared-calculator-narration-display-as-decimal = Displaying as fraction. Press Enter to display as Decimal\nshared-calculator-narration-display-as-fraction = Displaying as decimal. Press Enter to display as Fraction\nshared-calculator-narration-evaluation = equals { $answer }\nshared-calculator-narration-expression = Expression\nshared-calculator-narration-expression-index = Expression { $index }\nshared-calculator-narration-input-error = input has an error\nshared-calculator-narration-keypad = keypad\nshared-calculator-narration-keypad-controlbar = Control Bar\nshared-calculator-narration-keypad-key-10-n = Times ten to the power of\nshared-calculator-narration-keypad-key-abs = Absolute Value\nshared-calculator-narration-keypad-key-action-to = Set Value To\nshared-calculator-narration-keypad-key-alpha = Alpha\nshared-calculator-narration-keypad-key-ans = Answer\nshared-calculator-narration-keypad-key-arccos = Inverse Cosine\nshared-calculator-narration-keypad-key-arccot = Inverse Cotangent\nshared-calculator-narration-keypad-key-arccsc = Inverse Cosecant\nshared-calculator-narration-keypad-key-arcsec = Inverse Secant\nshared-calculator-narration-keypad-key-arcsin = Inverse Sine\nshared-calculator-narration-keypad-key-arctan = Inverse Tangent\nshared-calculator-narration-keypad-key-backspace = Backspace\nshared-calculator-narration-keypad-key-beta = Beta\nshared-calculator-narration-keypad-key-binomialdist = Binomial Distribution\nshared-calculator-narration-keypad-key-boxplot = Box Plot\nshared-calculator-narration-keypad-key-ceil = Ceiling\nshared-calculator-narration-keypad-key-corr = Correlation\nshared-calculator-narration-keypad-key-cos = Cosine\nshared-calculator-narration-keypad-key-cosh = Hyperbolic Cosine\nshared-calculator-narration-keypad-key-cot = Cotangent\nshared-calculator-narration-keypad-key-coth = Hyperbolic Cotangent\nshared-calculator-narration-keypad-key-cov = Co Variance\nshared-calculator-narration-keypad-key-covp = Population Co Variance\nshared-calculator-narration-keypad-key-csc = Cosecant\nshared-calculator-narration-keypad-key-csch = Hyperbolic Cosecant\nshared-calculator-narration-keypad-key-cubed = Cubed\nshared-calculator-narration-keypad-key-decimal = Decimal\nshared-calculator-narration-keypad-key-distance = Distance\nshared-calculator-narration-keypad-key-divide = Divide\nshared-calculator-narration-keypad-key-dotplot = Dot Plot\nshared-calculator-narration-keypad-key-enter = Enter\nshared-calculator-narration-keypad-key-erf = Error Function\nshared-calculator-narration-keypad-key-exp = Exponent\nshared-calculator-narration-keypad-key-factorial = Factorial\nshared-calculator-narration-keypad-key-floor = Floor\nshared-calculator-narration-keypad-key-fraction = A over B\nshared-calculator-narration-keypad-key-histogram = Histogram\nshared-calculator-narration-keypad-key-int = Integral\nshared-calculator-narration-keypad-key-inversecdf = Inverse CDF function\nshared-calculator-narration-keypad-key-ittest = Independent T Test\nshared-calculator-narration-keypad-key-left-arrow = Left Arrow\nshared-calculator-narration-keypad-key-left-bracket = Left Bracket\nshared-calculator-narration-keypad-key-left-paren = Left Parenthesis\nshared-calculator-narration-keypad-key-ln = Natural Log\nshared-calculator-narration-keypad-key-log = Log\nshared-calculator-narration-keypad-key-loga = Log A\nshared-calculator-narration-keypad-key-mean = Mean\nshared-calculator-narration-keypad-key-median = Median\nshared-calculator-narration-keypad-key-midpoint = Midpoint\nshared-calculator-narration-keypad-key-minus = Minus\nshared-calculator-narration-keypad-key-normaldist = Normal Distribution\nshared-calculator-narration-keypad-key-nthroot = Nth Root\nshared-calculator-narration-keypad-key-pdf = Probability Density Function\nshared-calculator-narration-keypad-key-percent-of = Percent Of\nshared-calculator-narration-keypad-key-pi = Pi\nshared-calculator-narration-keypad-key-plus = Plus\nshared-calculator-narration-keypad-key-poissondist = Poisson Distribution\nshared-calculator-narration-keypad-key-polygon = Polygon\nshared-calculator-narration-keypad-key-prime = Function derivative\nshared-calculator-narration-keypad-key-product = Product\nshared-calculator-narration-keypad-key-quantile = Quantile\nshared-calculator-narration-keypad-key-quartile = Quartile\nshared-calculator-narration-keypad-key-random = Random Number\nshared-calculator-narration-keypad-key-reciprocal = Reciprocal\nshared-calculator-narration-keypad-key-right-arrow = Right Arrow\nshared-calculator-narration-keypad-key-right-bracket = Right Bracket\nshared-calculator-narration-keypad-key-right-paren = Right Parenthesis\nshared-calculator-narration-keypad-key-round = Round\nshared-calculator-narration-keypad-key-sec = Secant\nshared-calculator-narration-keypad-key-shift = Shift\nshared-calculator-narration-keypad-key-sin = Sine\nshared-calculator-narration-keypad-key-sinh = Hyperbolic Sine\nshared-calculator-narration-keypad-key-spearman = Spearman Rank Correlation\nshared-calculator-narration-keypad-key-sqrt = Square Root\nshared-calculator-narration-keypad-key-squared = Squared\nshared-calculator-narration-keypad-key-stats = Summary statistics\nshared-calculator-narration-keypad-key-stdev = Standard Deviation\nshared-calculator-narration-keypad-key-stdevp = Standard Deviation of Population\nshared-calculator-narration-keypad-key-subscript = Subscript\nshared-calculator-narration-keypad-key-sum = Sum\nshared-calculator-narration-keypad-key-superscript = Superscript\nshared-calculator-narration-keypad-key-tan = Tangent\nshared-calculator-narration-keypad-key-tanh = Hyperbolic Tangent\nshared-calculator-narration-keypad-key-tau = Tau\nshared-calculator-narration-keypad-key-tdist = Student-t Distribution\nshared-calculator-narration-keypad-key-theta = Theta\nshared-calculator-narration-keypad-key-times = Times\nshared-calculator-narration-keypad-key-toggle-audio-trace = Toggle Audio Trace\nshared-calculator-narration-keypad-key-toggle-letters = Toggle Letters\nshared-calculator-narration-keypad-key-toggle-numbers = Toggle Numbers\nshared-calculator-narration-keypad-key-tscore = T Score\nshared-calculator-narration-keypad-key-ttest = T Test\nshared-calculator-narration-keypad-key-uniformdist = Uniform Distribution\nshared-calculator-narration-keypad-key-ythroot = Yth Root\nshared-calculator-narration-redo = redo\nshared-calculator-narration-settings-display-size = Display Size\nshared-calculator-narration-settings-display-size-default = Display size: default\nshared-calculator-narration-settings-display-size-large = Display size: large\nshared-calculator-narration-six-key-mode-off = Six Key Braille Input off\nshared-calculator-narration-six-key-mode-on = Six Key Braille Input on\nshared-calculator-narration-table-cell-coordinates = Row { $rowNumber } Column { $columnNumber }\nshared-calculator-narration-undo = undo\nshared-calculator-text-keyboard-shortcut-add-expression = Add an Expression\nshared-calculator-text-keyboard-shortcut-add-folder = Add a Folder\nshared-calculator-text-keyboard-shortcut-add-image = Add an Image\nshared-calculator-text-keyboard-shortcut-add-note = Add a Note\nshared-calculator-text-keyboard-shortcut-add-table = Add a Table\nshared-calculator-text-keyboard-shortcut-adjust-playback-speed = Adjust Playback Speed (1 = slowest, 5 = fastest)\nshared-calculator-text-keyboard-shortcut-announce-slider-animations = Announce Active Slider Animations\nshared-calculator-text-keyboard-shortcut-beginning-of-block = Beginning of Current Block\nshared-calculator-text-keyboard-shortcut-beginning-of-expression = Beginning of Current Expression\nshared-calculator-text-keyboard-shortcut-close-a-dialog = Close a Dialog (like this one!)\nshared-calculator-text-keyboard-shortcut-collapse-all-folders = Collapse All Folders\nshared-calculator-text-keyboard-shortcut-collapse-folder = Collapse Selected Folder\nshared-calculator-text-keyboard-shortcut-decrease-volume = Decrease Volume\nshared-calculator-text-keyboard-shortcut-decrease-x = Decrease X\nshared-calculator-text-keyboard-shortcut-decrease-x-larger = Decrease X by Larger Amount\nshared-calculator-text-keyboard-shortcut-decrease-y = Decrease Y\nshared-calculator-text-keyboard-shortcut-decrease-y-larger = Decrease Y by Larger Amount\nshared-calculator-text-keyboard-shortcut-delete-expression = Delete the Focused Expression\nshared-calculator-text-keyboard-shortcut-delete-selection = Delete Selection\nshared-calculator-text-keyboard-shortcut-end-of-block = End of Current Block\nshared-calculator-text-keyboard-shortcut-end-of-expression = End of Current Expression\nshared-calculator-text-keyboard-shortcut-exit-block = Exit Current Block\nshared-calculator-text-keyboard-shortcut-expand-all-folders = Expand ALL Folders\nshared-calculator-text-keyboard-shortcut-expand-folder = Expand Selected Folder\nshared-calculator-text-keyboard-shortcut-first-point = First Point\nshared-calculator-text-keyboard-shortcut-focus-expression-list = Focus the Expression List\nshared-calculator-text-keyboard-shortcut-focus-first-interactive-point = Focus First Interactive Point On Screen\nshared-calculator-text-keyboard-shortcut-hear-graph = Hear Graph\nshared-calculator-text-keyboard-shortcut-hear-specific-branch = Hear Only Branch 1 Through 10\nshared-calculator-text-keyboard-shortcut-increase-selection-left = Increase Selection Left\nshared-calculator-text-keyboard-shortcut-increase-selection-right = Increase Selection Right\nshared-calculator-text-keyboard-shortcut-increase-volume = Increase Volume\nshared-calculator-text-keyboard-shortcut-increase-x = Increase X\nshared-calculator-text-keyboard-shortcut-increase-x-larger = Increase X by Larger Amount\nshared-calculator-text-keyboard-shortcut-increase-y = Increase Y\nshared-calculator-text-keyboard-shortcut-increase-y-larger = Increase Y by Larger Amount\nshared-calculator-text-keyboard-shortcut-last-point = Last Point\nshared-calculator-text-keyboard-shortcut-move-to-denominator = Move to Denominator Within Fraction\nshared-calculator-text-keyboard-shortcut-move-to-numerator = Move to Numerator Within Fraction\nshared-calculator-text-keyboard-shortcut-move-to-origin = Move to Origin\nshared-calculator-text-keyboard-shortcut-nemeth-mode = Switch to Nemeth\nshared-calculator-text-keyboard-shortcut-next-character = Next Character\nshared-calculator-text-keyboard-shortcut-next-curve = Move to Next Curve\nshared-calculator-text-keyboard-shortcut-next-expression = Move to Next Expression\nshared-calculator-text-keyboard-shortcut-next-interactive-point = Go to Next Interactive Point\nshared-calculator-text-keyboard-shortcut-next-poi = Next Point of Interest\nshared-calculator-text-keyboard-shortcut-next-point = Next Point\nshared-calculator-text-keyboard-shortcut-open-a-graph = Open a Graph\nshared-calculator-text-keyboard-shortcut-open-expression-options = Open Options for the Focused Expression\nshared-calculator-text-keyboard-shortcut-previous-character = Previous Character\nshared-calculator-text-keyboard-shortcut-previous-curve = Move to Previous Curve\nshared-calculator-text-keyboard-shortcut-previous-expression = Move to Previous Expression\nshared-calculator-text-keyboard-shortcut-previous-interactive-point = Go to Previous Interactive Point\nshared-calculator-text-keyboard-shortcut-previous-poi = Previous Point of Interest\nshared-calculator-text-keyboard-shortcut-previous-point = Previous Point\nshared-calculator-text-keyboard-shortcut-print-a-graph = Print a Graph\nshared-calculator-text-keyboard-shortcut-print-mode = Switch to Print\nshared-calculator-text-keyboard-shortcut-redo = Redo\nshared-calculator-text-keyboard-shortcut-remove-empty-expression = Remove Selected Empty Expression\nshared-calculator-text-keyboard-shortcut-save-a-graph = Save a Graph\nshared-calculator-text-keyboard-shortcut-select-all = Select All\nshared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction = Show Answer as Decimal or Fraction\nshared-calculator-text-keyboard-shortcut-show-or-hide-expression-list = Show or Hide the Expression List\nshared-calculator-text-keyboard-shortcut-slider-decrease = Decrease Value\nshared-calculator-text-keyboard-shortcut-slider-decrease-larger = Decrease Value by Larger Increment\nshared-calculator-text-keyboard-shortcut-slider-increase = Increase Value\nshared-calculator-text-keyboard-shortcut-slider-increase-larger = Increase Value by Larger Increment\nshared-calculator-text-keyboard-shortcut-slider-maximum = Highest Value\nshared-calculator-text-keyboard-shortcut-slider-minimum = Lowest Value\nshared-calculator-text-keyboard-shortcut-slider-trace-decrease = Decrease Value of Selected Slider When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger = Decrease Value of Selected Slider by Larger Increment When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-increase = Increase Value of Selected Slider When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-increase-larger = Increase Value of Selected Slider by Larger Increment When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-maximum = Move to Highest Value of Selected Slider When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-minimum = Move to Lowest Value of Selected Slider When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-next-slider = Select Next Slider When in Slider Trace\nshared-calculator-text-keyboard-shortcut-slider-trace-previous-slider = Select Previous Slider When in Slider Trace\nshared-calculator-text-keyboard-shortcut-speak-answer = Speak Answer\nshared-calculator-text-keyboard-shortcut-speak-branch = Speak Branch\nshared-calculator-text-keyboard-shortcut-speak-color = Speak Color\nshared-calculator-text-keyboard-shortcut-speak-focused-block = Speak Focused Block\nshared-calculator-text-keyboard-shortcut-speak-label = Speak Label\nshared-calculator-text-keyboard-shortcut-speak-left-adjacent-block = Speak Left-Adjacent Block\nshared-calculator-text-keyboard-shortcut-speak-parent-block = Speak Parent Block\nshared-calculator-text-keyboard-shortcut-speak-poi-count = Speak Point of Interest Count\nshared-calculator-text-keyboard-shortcut-speak-point-type = Speak Type of Selected Point\nshared-calculator-text-keyboard-shortcut-speak-right-adjacent-block = Speak Right-Adjacent Block\nshared-calculator-text-keyboard-shortcut-speak-selection = Speak Selection\nshared-calculator-text-keyboard-shortcut-speak-x = Speak X Coordinate\nshared-calculator-text-keyboard-shortcut-speak-y = Speak Y Coordinate\nshared-calculator-text-keyboard-shortcut-summarize-graph = Summarize Graph\nshared-calculator-text-keyboard-shortcut-table-first-column = First Column in Row\nshared-calculator-text-keyboard-shortcut-table-first-row = First Row in Column\nshared-calculator-text-keyboard-shortcut-table-last-column = Last Column in Row\nshared-calculator-text-keyboard-shortcut-table-last-row = Last Row in Column\nshared-calculator-text-keyboard-shortcut-table-next-cell = Next Cell\nshared-calculator-text-keyboard-shortcut-table-next-column = Next Column\nshared-calculator-text-keyboard-shortcut-table-next-row = Next Row\nshared-calculator-text-keyboard-shortcut-table-previous-cell = Previous Cell\nshared-calculator-text-keyboard-shortcut-table-previous-column = Previous Column\nshared-calculator-text-keyboard-shortcut-table-previous-row = Previous Row\nshared-calculator-text-keyboard-shortcut-table-speak-column-header = Speak Column Header\nshared-calculator-text-keyboard-shortcut-toggle-account-menu = Open or Close the Account Menu\nshared-calculator-text-keyboard-shortcut-toggle-audio-trace = Enable or Disable Audio Trace Mode\nshared-calculator-text-keyboard-shortcut-toggle-braille-typing = Turn Braille Typing On or Off\nshared-calculator-text-keyboard-shortcut-toggle-edit-list-mode = Turn Edit List Mode On or Off\nshared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu = Open or Close the Graph Settings Menu\nshared-calculator-text-keyboard-shortcut-toggle-help-menu = Open or Close the Help Menu\nshared-calculator-text-keyboard-shortcut-toggle-language-menu = Open or Close the Language Menu\nshared-calculator-text-keyboard-shortcut-toggle-share-menu = Open or Close the Share Menu\nshared-calculator-text-keyboard-shortcut-toggle-slider-trace = Toggle Slider Trace Mode\nshared-calculator-text-keyboard-shortcut-ueb-mode = Switch to UEB\nshared-calculator-text-keyboard-shortcut-undo = Undo\nshared-calculator-text-keyboard-shortcut-usually = usually\nshared-label-email = Email\nshared-label-family-name = Last Name (optional)\nshared-label-given-name-or-nickname = First Name or Nickname\nshared-label-name = Name\nshared-label-name-or-nickname = Name or Nickname\nshared-label-new-email-address = New Email Address\nshared-label-password = Password\nshared-message-account-reactivated = You previously requested to delete your account, but because you logged back in within 30 days, we will not delete your account. Welcome back!\nshared-message-change-password-email-sent = We will send a link to your email address ({ $emailAddress }) so you can change your password.\nshared-message-check-email-for-delete-link = Please check your email ({ $emailAddress }) for the link to delete your account.\nshared-message-check-email-for-link = Please check { $emailAddress } for the Change Email link.\nshared-message-check-email-for-password-link = Please check your email ({ $emailAddress }) for the link to change your password.\nshared-message-check-email-for-password-recovery-link = Message sent. Please check your email for a password recovery link.\nshared-message-consent-delete-information = If you don\'t want Desmos to hold onto this information, you may delete your account from the Account Settings menu at any time.\nshared-message-consent-information = When you created your Desmos account, you gave us your name, email address, and password (unless you signed in with Google, in which case you gave us access to the name and email address associated with that account). You also gave us access to your saved work. To continue using your Desmos account, please consent below to the collection of this information.\nshared-message-consent-text = I agree to let Desmos store and maintain the information I provide (e.g. login credentials, saved work) in order to provide and improve its service. To withdraw consent, you may delete your account at any time.\nshared-message-cookie-notice = <1>Note:</1> Desmos uses cookies to enable persistence when you are signed in. If you do not wish to use cookies, please use Desmos without logging in. <2>Learn More.</2>\nshared-message-delete-account-notice = When you delete your account, <1>we will retain your data for 30 days.</1> You can reactivate your account at any time during those 30 days by logging back in. If there\'s something about Desmos we can improve, please <2>let us know.</2>\nshared-message-delete-account-will-send-email = We will send you a link to your email address ({ $email }) so you can delete your account.\nshared-message-email-sent = Email sent\nshared-message-email-settings-will-send-email = We will send a Change Email link to { $emailAddress }.\nshared-message-google-login-not-available = Google Login is not available on this device.\nshared-message-information-saved = Saved!\nshared-message-or-login-with-desmos = Or log in with Desmos\nshared-message-please-review-name = We tried to split your name into first and last name. Please review your name below and edit any mistakes.\nshared-message-privacy-notice = I have read, understand, and accept the <1>Terms of Service</1> and <2>Privacy Policy</2>{"."}\nshared-message-set-new-email-address = Set a new email address and password.\nshared-narration-privacy-policy-agreement = Checkbox to indicate agreement to privacy policy (desmos.com/privacy) and terms of service (desmos.com/terms).\nshared-prompt-already-have-account = Already have a Desmos account?\nshared-prompt-enter-email-for-password-recovery-link = Enter your email address to get a password recovery link.\nshared-prompt-forgot-your-password = Forgot your password?\nshared-prompt-new-to-desmos-sign-up-here = New to Desmos? <1>Sign up</1>{"."}\nshared-prompt-new-to-desmos-teacher-or-student = New to Desmos? Sign up as a <1>teacher</1> or <2>student.</2>\nshared-prompt-please-consent-to-sign-up-with-apple = Please consent above to sign up with Apple\nshared-prompt-please-consent-to-sign-up-with-google = Please consent above to sign up with Google\nshared-prompt-sign-up-with-apple = Sign up with Apple\nshared-prompt-sign-up-with-google = Sign up with Google\nshared-title-account-reactivated = Your account has been reactivated.\nshared-title-account-settings = Account Settings\nshared-title-change-email-address = Change your Desmos email address\nshared-title-change-password-narrow = Password\nshared-title-change-password-wide = Change Password\nshared-title-consent = We value your privacy\nshared-title-delete-account = Are you sure you want to delete your account?\nshared-title-email-settings = Email\nshared-title-language-menu = Language\nshared-title-login = Log In\nshared-title-profile-information-narrow = Profile\nshared-title-profile-information-wide = Profile Information\nshared-title-recover-password = Recover Password\nshared-title-signup = Sign-Up\nshared-title-teacher-signup = Teacher Sign-Up\n### Strings for the graphing calculator and other tools\n\n\n### 2499 English words, 741 English strings\n\nbasic-calculator-button-controlbar-abc = abc\nbasic-calculator-button-controlbar-clear = clear\nbasic-calculator-button-controlbar-clear-all = clear all\nbasic-calculator-button-controlbar-func = func\nbasic-calculator-button-controlbar-main = main\nbasic-calculator-button-nemeth = Nemeth\nbasic-calculator-button-turn-braille-mode-off = Turn { $mode } off\nbasic-calculator-button-ueb = UEB\nbasic-calculator-error-fractions-unavailable = Fractions are not available in the current calculator.\nbasic-calculator-heading-braille-table-type-this = Type this\nbasic-calculator-heading-braille-table-typeset = Typeset\nbasic-calculator-heading-page-title-florida = Desmos | Florida Calculator\nbasic-calculator-heading-page-title-four-function = Desmos | 4-Function Calculator\nbasic-calculator-heading-title-scientific = Desmos | Scientific Calculator\nbasic-calculator-label-answer-hint = Your answers show up on this side.\nbasic-calculator-label-braille-mode = Braille Mode\nbasic-calculator-label-controlbar-deg = deg\nbasic-calculator-label-controlbar-rad = rad\nbasic-calculator-label-convert-to-decimal = Convert to decimal.\nbasic-calculator-label-convert-to-fraction = Convert to fraction.\nbasic-calculator-label-reverse-contrast = Reverse Contrast\nbasic-calculator-label-six-key-input = Six Key Braille Input\nbasic-calculator-link-download-braille-equations = Download Braille Equations\nbasic-calculator-link-help = Help\nbasic-calculator-link-privacy-policy = Privacy Policy\nbasic-calculator-link-terms-of-service = Terms of Service\nbasic-calculator-link-view-braille-examples = View more examples\nbasic-calculator-narration-braille-mode = Braille Mode\nbasic-calculator-narration-calc-description-fourfunction = Desmos Four-Function Calculator\nbasic-calculator-narration-calc-description-scientific = Desmos Scientific Calculator\nbasic-calculator-narration-controlbar-abc = A B C\nbasic-calculator-narration-controlbar-backspace = backspace\nbasic-calculator-narration-controlbar-clear = clear\nbasic-calculator-narration-controlbar-clear-all = clear all\nbasic-calculator-narration-controlbar-degrees = Degrees\nbasic-calculator-narration-controlbar-functions = Functions\nbasic-calculator-narration-controlbar-main = main\nbasic-calculator-narration-controlbar-radians = Radians\nbasic-calculator-narration-controlbar-redo = Redo\nbasic-calculator-narration-controlbar-settings = settings\nbasic-calculator-narration-controlbar-undo = Undo\nbasic-calculator-narration-convert-to-decimal = Displaying as fraction. Press Enter to display as Decimal\nbasic-calculator-narration-convert-to-fraction = Displaying as decimal. Press Enter to display as Fraction\nbasic-calculator-narration-expression-list = Expression List\nbasic-calculator-narration-hotkey-braille-off = Braille mode off\nbasic-calculator-narration-hotkey-nemeth = Braille mode Nemeth\nbasic-calculator-narration-hotkey-six-key-input-off = Six Key Braille Input off\nbasic-calculator-narration-hotkey-six-key-input-on = Six Key Braille Input on\nbasic-calculator-narration-hotkey-ueb = Braille mode UEB\nbasic-calculator-narration-keypad = keypad\nbasic-calculator-narration-nemeth = Nemeth\nbasic-calculator-narration-reverse-contrast = Reverse Contrast\nbasic-calculator-narration-six-key-input = Six Key Braille Input\nbasic-calculator-narration-ueb = UEB\nbasic-calculator-text-4fn-page-description = A beautiful, free 4-Function Calculator from Desmos.com.\nbasic-calculator-text-braille-mode-is-on = { $mode } is on!\nbasic-calculator-text-how-to-type-braille = Use a Refreshable Braille display, or just type Braille with a keyboard.\nbasic-calculator-text-scientific-page-description = A beautiful, free online scientific calculator with advanced features for evaluating percentages, fractions, exponential functions, logarithms, trigonometry, statistics, and more.\ngeometry-label-example-construction-centroid = Centroid\ngeometry-label-example-construction-circumcenter = Circumcenter\ngeometry-label-example-construction-equilateral-triangle = Equilateral Triangle\ngeometry-label-example-construction-orthocenter = Orthocenter\ngeometry-label-example-construction-perpendicular-bisector = Perpendicular Bisector\ngeometry-label-example-construction-pythagorean-theorem = Pythagorean Theorem\ngraphing-calculator-button-audio-trace-describe-curve = Describe Curve\ngraphing-calculator-button-audio-trace-describe-curve-short = Curve\ngraphing-calculator-button-audio-trace-describe-point = Describe Point\ngraphing-calculator-button-audio-trace-describe-point-short = Point\ngraphing-calculator-button-audio-trace-hear-graph = Hear Graph\ngraphing-calculator-button-audio-trace-stop-graph = Stop Graph\ngraphing-calculator-button-change-image = Change Image\ngraphing-calculator-button-clear-graph = Delete All\ngraphing-calculator-button-done = Done\ngraphing-calculator-button-draggable = Draggable\ngraphing-calculator-button-edit-graph-on-desmos-logo = edit graph on\ngraphing-calculator-button-editable-math = Editable Math\ngraphing-calculator-button-editable-text = Editable Text\ngraphing-calculator-button-find-cdf = Find Cumulative Probability (CDF)\ngraphing-calculator-button-funcs = funcs\ngraphing-calculator-button-functions = functions\ngraphing-calculator-button-functions-menu-number-theory = Number Theory\ngraphing-calculator-button-functions-menu-special-characters = Special Characters\ngraphing-calculator-button-hide-folder-from-students = Hide this folder from students\ngraphing-calculator-button-hide-folder-from-students-2 = Hide this folder from students.\ngraphing-calculator-button-keypad-audio-trace-off = Audio Trace Off\ngraphing-calculator-button-keypad-describe-curve = Describe Curve\ngraphing-calculator-button-keypad-describe-point = Describe Point\ngraphing-calculator-button-label = Label\ngraphing-calculator-button-label-editable = Editable\ngraphing-calculator-button-label-show-on-hover = Show on hover\ngraphing-calculator-button-label-text-outline = Text outline\ngraphing-calculator-button-load-image-retry = Retry.\ngraphing-calculator-button-place-image-behind-graphs = Place behind graphs\ngraphing-calculator-button-regression-log-mode = Log Mode\ngraphing-calculator-button-regression-plot-residuals = plot\ngraphing-calculator-button-replace = Replace\ngraphing-calculator-button-reset-graph = Reset\ngraphing-calculator-button-settings-braille-mode-nemeth = Nemeth\ngraphing-calculator-button-settings-braille-mode-ueb = UEB\ngraphing-calculator-button-settings-degrees = Degrees\ngraphing-calculator-button-settings-radians = Radians\ngraphing-calculator-button-settings-zoom-square = Zoom Square\ngraphing-calculator-button-share-graph-link-copy = Copy\ngraphing-calculator-button-show-all-table-rows = Show all\ngraphing-calculator-button-slider-add-all-variables = all\ngraphing-calculator-button-visual-parameters-binned = Binned\ngraphing-calculator-button-visual-parameters-center = Center\ngraphing-calculator-button-visual-parameters-count = Count\ngraphing-calculator-button-visual-parameters-density = Density\ngraphing-calculator-button-visual-parameters-exact = Exact\ngraphing-calculator-button-visual-parameters-exclude-outliers = Exclude Outliers\ngraphing-calculator-button-visual-parameters-left = Left\ngraphing-calculator-button-visual-parameters-relative = Relative\ngraphing-calculator-error-equation-contains-unresolved-details = This equation contains fine detail that has not been fully resolved.\ngraphing-calculator-error-expression-replacement = Replacement must be a valid function or variable name.\ngraphing-calculator-error-expression-search = Can only rename a valid function or variable name.\ngraphing-calculator-error-failed-to-load-image = Failed to load image.\ngraphing-calculator-error-image-invalid-angle = Invalid angle. Try using any number.\ngraphing-calculator-error-image-invalid-center = Invalid center. Try, for example, (0,0).\ngraphing-calculator-error-image-invalid-file = The file "{ $file }" is not an image\ngraphing-calculator-error-image-invalid-height = Invalid height. Try using any number.\ngraphing-calculator-error-image-invalid-opacity = Invalid opacity. Try using any number.\ngraphing-calculator-error-image-invalid-width = Invalid width. Try using any number.\ngraphing-calculator-heading-advanced = Advanced\ngraphing-calculator-heading-audio-trace-describe = Describe\ngraphing-calculator-heading-audio-trace-navigation = Navigation\ngraphing-calculator-heading-audio-trace-screen-reader = Screen Reader\ngraphing-calculator-heading-calculus = Calculus\ngraphing-calculator-heading-clickable = Clickable\ngraphing-calculator-heading-dist-tab-distributions = Distributions\ngraphing-calculator-heading-dist-tab-visualizations = Visualizations\ngraphing-calculator-heading-drag = Drag\ngraphing-calculator-heading-fill = Fill\ngraphing-calculator-heading-geometry = Geometry\ngraphing-calculator-heading-hyperbolic-trig = Hyperbolic Trig Functions\ngraphing-calculator-heading-image-opacity = Opacity\ngraphing-calculator-heading-inverse-trig = Inverse Trig Functions\ngraphing-calculator-heading-keypad-audio-trace-point-of-interest = <1>Point</1><2>of Interest</2>\ngraphing-calculator-heading-label = Label\ngraphing-calculator-heading-label-orientation = Orientation\ngraphing-calculator-heading-lines = Lines\ngraphing-calculator-heading-lists = List Operations\ngraphing-calculator-heading-mygraphs-examples = Examples\ngraphing-calculator-heading-on-every-update = On Every Update:\ngraphing-calculator-heading-points = Points\ngraphing-calculator-heading-regression-parameters = Parameters\ngraphing-calculator-heading-regression-residuals = Residuals\ngraphing-calculator-heading-regression-statistics = Statistics\ngraphing-calculator-heading-slider-animation-mode = Animation Mode\ngraphing-calculator-heading-slider-speed = Speed\ngraphing-calculator-heading-stat-tests = Statistical Tests\ngraphing-calculator-heading-stats = Statistics\ngraphing-calculator-heading-style = Style\ngraphing-calculator-heading-title = Graphing Calculator\ngraphing-calculator-heading-title-desmos = Desmos | Graphing Calculator\ngraphing-calculator-heading-title-untitled = Untitled Graph\ngraphing-calculator-heading-trig = Trig Functions\ngraphing-calculator-heading-visual-parameters-bar-heights = Bar Heights\ngraphing-calculator-heading-visual-parameters-bin-alignment = Bin Alignment\ngraphing-calculator-heading-visual-parameters-display-properties = Display Properties\ngraphing-calculator-heading-visual-parameters-x-values = X Values\ngraphing-calculator-label-add-depressed-image-tooltip = Add Depressed Image\ngraphing-calculator-label-add-hovered-image-tooltip = Add Hovered Image\ngraphing-calculator-label-add-item-tooltip = Add Item\ngraphing-calculator-label-add-slider = add slider:\ngraphing-calculator-label-angle-tooltip = Angle\ngraphing-calculator-label-animation-properties-tooltip = Animation Properties\ngraphing-calculator-label-audio-trace-curve = Curve\ngraphing-calculator-label-audio-trace-need-screen-reader = Your Screen Reader needs to be on to hear these.\ngraphing-calculator-label-audio-trace-point = Point\ngraphing-calculator-label-audio-trace-speed = Speed\ngraphing-calculator-label-audio-trace-volume = Volume\ngraphing-calculator-label-braille-size-etc11 = ETC Romeo/Juliet (11.5 x 11 in)\ngraphing-calculator-label-braille-size-etc8 = ETC Romeo/Juliet (8.5 x 11 in)\ngraphing-calculator-label-braille-size-vpmax11 = VP Max (11.5 x 11 in)\ngraphing-calculator-label-braille-size-vpmax8 = VP Max (8.5 x 11 in)\ngraphing-calculator-label-cdf-maximum = Max:\ngraphing-calculator-label-cdf-minimum = Min:\ngraphing-calculator-label-change-depressed-image-tooltip = Change Depressed Image\ngraphing-calculator-label-change-hovered-image-tooltip = Change Hovered Image\ngraphing-calculator-label-convert-to-table-tooltip = Convert to Table\ngraphing-calculator-label-depressed = Depressed\ngraphing-calculator-label-drop-image-here = Drop Image Here\ngraphing-calculator-label-duplicate-expression-tooltip = Duplicate\ngraphing-calculator-label-edit-list-tooltip = Edit List\ngraphing-calculator-label-evaluation-list = { $count } element list\ngraphing-calculator-label-example-graph-3d-world = 3D World\ngraphing-calculator-label-example-graph-calculus-derivatives = Calculus: Derivatives\ngraphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus = Calculus: Fundamental Theorem of Calculus\ngraphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds = Calculus: Integral with adjustable bounds\ngraphing-calculator-label-example-graph-calculus-integrals = Calculus: Integrals\ngraphing-calculator-label-example-graph-calculus-secant-line = Calculus: Secant Line\ngraphing-calculator-label-example-graph-calculus-tangent-line = Calculus: Tangent Line\ngraphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x = Calculus: Taylor Expansion of sin(x)\ngraphing-calculator-label-example-graph-checkerboard-inversion = Checkerboard Inversion\ngraphing-calculator-label-example-graph-conic-sections-circle = Conic Sections: Circle\ngraphing-calculator-label-example-graph-conic-sections-ellipse-with-foci = Conic Sections: Ellipse with Foci\ngraphing-calculator-label-example-graph-conic-sections-hyperbola = Conic Sections: Hyperbola\ngraphing-calculator-label-example-graph-conic-sections-parabola-and-focus = Conic Sections: Parabola and Focus\ngraphing-calculator-label-example-graph-fastest-path-to-a-point = Fastest Path to a Point\ngraphing-calculator-label-example-graph-fireworks = Fireworks!\ngraphing-calculator-label-example-graph-fractal-valentine = Fractal Valentine\ngraphing-calculator-label-example-graph-lines-point-slope-form = Lines: Point Slope Form\ngraphing-calculator-label-example-graph-lines-slope-intercept-form = Lines: Slope Intercept Form\ngraphing-calculator-label-example-graph-lines-two-point-form = Lines: Two Point Form\ngraphing-calculator-label-example-graph-lists-curve-stitching = Lists: Curve Stitching\ngraphing-calculator-label-example-graph-lists-family-of-sin-curves = Lists: Family of sin Curves\ngraphing-calculator-label-example-graph-lists-plotting-a-list-of-points = Lists: Plotting a List of Points\ngraphing-calculator-label-example-graph-outstretched-arm = Outstretched Arm\ngraphing-calculator-label-example-graph-pac-man = Pac Man\ngraphing-calculator-label-example-graph-parabolas-standard-form = Parabolas: Standard Form\ngraphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent = Parabolas: Standard Form + Tangent\ngraphing-calculator-label-example-graph-parabolas-vertex-form = Parabolas: Vertex Form\ngraphing-calculator-label-example-graph-parametric-cycloid = Parametric: Cycloid\ngraphing-calculator-label-example-graph-parametric-introduction = Parametric: Introduction\ngraphing-calculator-label-example-graph-polar-conic-sections = Polar: Conic Sections\ngraphing-calculator-label-example-graph-polar-limacon = Polar: Limacon\ngraphing-calculator-label-example-graph-polar-logarithmic-spiral = Polar: Logarithmic Spiral\ngraphing-calculator-label-example-graph-polar-rose = Polar: Rose\ngraphing-calculator-label-example-graph-pride-flag = PRIDE flag\ngraphing-calculator-label-example-graph-regular-sine-wave = Regular Sine Wave?\ngraphing-calculator-label-example-graph-stats-anscombes-quartet = Statistics: Anscombe\'s Quartet\ngraphing-calculator-label-example-graph-stats-fourth-order-polynomial = Statistics: 4th Order Polynomial\ngraphing-calculator-label-example-graph-stats-linear-regression = Statistics: Linear Regression\ngraphing-calculator-label-example-graph-transformations-inverse-of-a-function = Transformations: Inverse of a Function\ngraphing-calculator-label-example-graph-transformations-scaling-a-function = Transformations: Scaling a Function\ngraphing-calculator-label-example-graph-transformations-translating-a-function = Transformations: Translating a Function\ngraphing-calculator-label-example-graph-trig-period-and-amplitude = Trigonometry: Period and Amplitude\ngraphing-calculator-label-example-graph-trig-phase = Trigonometry: Phase\ngraphing-calculator-label-example-graph-trig-unit-circle = Trigonometry: Unit Circle\ngraphing-calculator-label-example-graph-trig-wave-interference = Trigonometry: Wave Interference\ngraphing-calculator-label-expression = Expression\ngraphing-calculator-label-expression-delete-tooltip = Delete\ngraphing-calculator-label-expression-lowercase = expression\ngraphing-calculator-label-folder-lowercase = folder\ngraphing-calculator-label-hide-expression-list-tooltip = Hide Expression List\ngraphing-calculator-label-hide-keypad = Hide Keypad\ngraphing-calculator-label-hovered = Hovered\ngraphing-calculator-label-image-angle = Angle:\ngraphing-calculator-label-image-center = Center:\ngraphing-calculator-label-image-height = Height:\ngraphing-calculator-label-image-lowercase = image\ngraphing-calculator-label-image-opacity = Opacity:\ngraphing-calculator-label-image-width = Width:\ngraphing-calculator-label-label-size-tooltip = Label Scale Factor\ngraphing-calculator-label-line-thickness-tooltip = Line Thickness (px)\ngraphing-calculator-label-list-index = Use <1>index</1> to reference the clicked index in the list.\ngraphing-calculator-label-note-lowercase = note\ngraphing-calculator-label-opacity-tooltip = Opacity (0 to 1)\ngraphing-calculator-label-open-graph-tooltip = Open Graph (ctrl+o)\ngraphing-calculator-label-poi-unknown = unknown coordinates\ngraphing-calculator-label-point-size-tooltip = Point Size (px)\ngraphing-calculator-label-powered-by = powered by\ngraphing-calculator-label-randomize-tooltip = Randomize\ngraphing-calculator-label-redo-tooltip = Redo (ctrl+y)\ngraphing-calculator-label-regression-log-mode-help-tooltip = Log mode help\ngraphing-calculator-label-regression-parameters-not-exact = Parameters might not be exact. Click to learn more.\ngraphing-calculator-label-regression-what-is-rmse-tooltip = What is RMSE? Click to learn more.\ngraphing-calculator-label-regression-why-is-negative-tooltip = Why is this negative? Click to learn more.\ngraphing-calculator-label-remove-depressed-image = Remove depressed image\ngraphing-calculator-label-remove-hovered-image = Remove hovered image\ngraphing-calculator-label-replace-expressions = Replace with\ngraphing-calculator-label-search-expressions = Search this graph\ngraphing-calculator-label-settings-add-label = add a label\ngraphing-calculator-label-settings-arrows = Arrows\ngraphing-calculator-label-settings-axis-numbers = Axis Numbers\ngraphing-calculator-label-settings-braille-mode = Braille Mode\ngraphing-calculator-label-settings-grid = Grid\ngraphing-calculator-label-settings-lock-viewport = Lock Viewport\ngraphing-calculator-label-settings-minor-gridlines = Minor Gridlines\ngraphing-calculator-label-settings-reverse-contrast = Reverse Contrast\ngraphing-calculator-label-settings-six-key-braille = Six Key Braille Input\ngraphing-calculator-label-settings-step = Step:\ngraphing-calculator-label-settings-x-axis = X-Axis\ngraphing-calculator-label-settings-y-axis = Y-Axis\ngraphing-calculator-label-show-keypad = Show Keypad\ngraphing-calculator-label-slider-disabled-while-ticker-playing = Sliders are disabled while the ticker is running.\ngraphing-calculator-label-slider-step = Step:\ngraphing-calculator-label-table-lowercase = table\ngraphing-calculator-label-ticker-close = cancel\ngraphing-calculator-label-ticker-help-tooltip = On slow computers, this might run slower. Use local variable "dt" to capture the actual update speed.\ngraphing-calculator-label-ticker-lowercase = ticker\ngraphing-calculator-label-ticker-min-step = Min Step Time\ngraphing-calculator-label-ticker-pause = pause\ngraphing-calculator-label-ticker-play = play\ngraphing-calculator-label-tooltip-graph-settings = Graph Settings\ngraphing-calculator-label-tooltip-open-graph = Open Graph\ngraphing-calculator-label-tooltip-reset = Reset\ngraphing-calculator-label-tooltip-show-list = Show List\ngraphing-calculator-label-tooltip-zoom-default = Default Zoom\ngraphing-calculator-label-tooltip-zoom-in = Zoom In\ngraphing-calculator-label-tooltip-zoom-out = Zoom Out\ngraphing-calculator-label-undo-tooltip = Undo (ctrl+z)\ngraphing-calculator-label-update-on-click = On click:\ngraphing-calculator-link-audio-trace-keyboard-shortcuts = Keyboard Shortcuts\ngraphing-calculator-link-audio-trace-shortcuts = Shortcuts\ngraphing-calculator-link-edit-on-desmos = edit graph on\ngraphing-calculator-link-learn-more = Learn more.\ngraphing-calculator-link-view-braille-examples = View examples\ngraphing-calculator-narration-add-expression = Add expression\ngraphing-calculator-narration-add-folder = Add folder\ngraphing-calculator-narration-add-image = Add image\ngraphing-calculator-narration-add-item-menu = Add Item Menu\ngraphing-calculator-narration-add-note = Add note\ngraphing-calculator-narration-add-slider-prompt = Add slider for { $vars }\ngraphing-calculator-narration-add-table = Add table\ngraphing-calculator-narration-add-ticker = Add Ticker\ngraphing-calculator-narration-all-folders-collapsed = all folders collapsed\ngraphing-calculator-narration-all-folders-expanded = all folders expanded\ngraphing-calculator-narration-audio-instructions-enter-audio-trace-mac = Press OPTION+T for audio trace.\ngraphing-calculator-narration-audio-instructions-enter-audio-trace-windows = Press ALT+T for audio trace.\ngraphing-calculator-narration-audio-trace-branch-not-found = Branch { $branch } does not exist.\ngraphing-calculator-narration-audio-trace-cannot-change-slider-value = Unable to adjust slider\ngraphing-calculator-narration-audio-trace-description-branch-count = Branches: { $branches }.\ngraphing-calculator-narration-audio-trace-description-color = Color: { $color }.\ngraphing-calculator-narration-audio-trace-description-multiple-extrema = { $count } extrema.\ngraphing-calculator-narration-audio-trace-description-multiple-intercepts = { $count } intercepts.\ngraphing-calculator-narration-audio-trace-description-multiple-intersections = { $count } intersections.\ngraphing-calculator-narration-audio-trace-description-multiple-labels = { $count } point labels.\ngraphing-calculator-narration-audio-trace-description-multiple-roots = { $count } zero crossings.\ngraphing-calculator-narration-audio-trace-description-one-extremum = 1 extremum.\ngraphing-calculator-narration-audio-trace-description-one-intercept = 1 intercept.\ngraphing-calculator-narration-audio-trace-description-one-intersection = 1 intersection.\ngraphing-calculator-narration-audio-trace-description-one-label = 1 point label.\ngraphing-calculator-narration-audio-trace-description-one-root = 1 zero crossing.\ngraphing-calculator-narration-audio-trace-description-shading-above = Shading above.\ngraphing-calculator-narration-audio-trace-description-shading-below = Shading below.\ngraphing-calculator-narration-audio-trace-description-shading-in-regions = Shading in regions.\ngraphing-calculator-narration-audio-trace-description-shading-left = Shading on the left.\ngraphing-calculator-narration-audio-trace-description-shading-right = Shading on the right.\ngraphing-calculator-narration-audio-trace-description-unavailable = No information available.\ngraphing-calculator-narration-audio-trace-expression-with-column = Expression { $index } column { $column }\ngraphing-calculator-narration-audio-trace-first-point = First point\ngraphing-calculator-narration-audio-trace-first-slider = First slider.\ngraphing-calculator-narration-audio-trace-instructions-disable-mac = To disable audio trace, press OPTION+T.\ngraphing-calculator-narration-audio-trace-instructions-disable-windows = To disable audio trace, press ALT+T.\ngraphing-calculator-narration-audio-trace-instructions-expression-navigation-mac = To move between expressions, press COMMAND+Up-Arrow or COMMAND+Down-Arrow.\ngraphing-calculator-narration-audio-trace-instructions-expression-navigation-windows = To move between expressions, press ALT+Up-Arrow or ALT+Down-Arrow.\ngraphing-calculator-narration-audio-trace-instructions-hear-graph = To hear the graph, press H.\ngraphing-calculator-narration-audio-trace-instructions-use-arrow-keys = Use Arrow keys to navigate.\ngraphing-calculator-narration-audio-trace-last-point = Last point\ngraphing-calculator-narration-audio-trace-last-slider = Last slider.\ngraphing-calculator-narration-audio-trace-multiple-sliders-paused = { $sliders } animating sliders were paused.\ngraphing-calculator-narration-audio-trace-no-graph-selected = No graph selected.\ngraphing-calculator-narration-audio-trace-no-more-pois = No more points of interest\ngraphing-calculator-narration-audio-trace-no-sliders-paused = No animating sliders were paused.\ngraphing-calculator-narration-audio-trace-one-slider-paused = One animating slider was paused.\ngraphing-calculator-narration-audio-trace-playback-speed = Graph playback speed { $speed }\ngraphing-calculator-narration-audio-trace-poi-count = Points of interest, { $x }.\ngraphing-calculator-narration-audio-trace-point-type-definition = Definition\ngraphing-calculator-narration-audio-trace-point-type-extremum = Extremum\ngraphing-calculator-narration-audio-trace-point-type-intercept = Intercept\ngraphing-calculator-narration-audio-trace-point-type-intersection = Intersection\ngraphing-calculator-narration-audio-trace-point-type-intersection-with-curves = Intersection with { $curves }\ngraphing-calculator-narration-audio-trace-point-type-label = Label\ngraphing-calculator-narration-audio-trace-point-type-not-a-poi = Not a P O I\ngraphing-calculator-narration-audio-trace-point-type-root = Zero\ngraphing-calculator-narration-audio-trace-point-type-trace = Trace\ngraphing-calculator-narration-audio-trace-property-branch-number = Branch { $branch }.\ngraphing-calculator-narration-audio-trace-property-type-before-coordinates = { $type } at\ngraphing-calculator-narration-audio-trace-property-x = X: { $x }.\ngraphing-calculator-narration-audio-trace-property-y = Y: { $y }.\ngraphing-calculator-narration-audio-trace-secret-expression = Secret expression { $index }\ngraphing-calculator-narration-audio-trace-slider-value-unknown = Unable to determine slider value\ngraphing-calculator-narration-audio-trace-sound-effects-disabled = Sound effects have been disabled.\ngraphing-calculator-narration-audio-trace-tracing-different-expression = Tracing { $expression }.\ngraphing-calculator-narration-audio-trace-unable-to-play = Unable to play audio.\ngraphing-calculator-narration-audio-trace-unable-to-trace-this-expression = Unable to audio trace this expression.\ngraphing-calculator-narration-audio-trace-unsupported-expression = { $expression } cannot be audio traced.\ngraphing-calculator-narration-audio-trace-volume = Volume { $volume } percent\ngraphing-calculator-narration-cdf-maximum = Max\ngraphing-calculator-narration-cdf-minimum = Min\ngraphing-calculator-narration-click-action = Click Action\ngraphing-calculator-narration-clickable-image-options = Clickable Image Options\ngraphing-calculator-narration-clickable-object-description = clickable object\ngraphing-calculator-narration-collapse-folder = Collapse Folder\ngraphing-calculator-narration-color-unknown = unknown\ngraphing-calculator-narration-description-collapsed-folder = Collapsed Folder\ngraphing-calculator-narration-description-collapsed-secret-folder = Collapsed Secret Folder\ngraphing-calculator-narration-description-folder = Folder\ngraphing-calculator-narration-description-hidden-collapsed-folder = Hidden Collapsed Folder\ngraphing-calculator-narration-description-hidden-collapsed-secret-folder = Hidden Collapsed Secret Folder\ngraphing-calculator-narration-description-hidden-folder = Hidden Folder\ngraphing-calculator-narration-description-hidden-secret-folder = Hidden Secret Folder\ngraphing-calculator-narration-description-secret-folder = Secret Folder\ngraphing-calculator-narration-dist-tab-distributions = Distributions\ngraphing-calculator-narration-dist-tab-visualizations = Visualizations\ngraphing-calculator-narration-domain-maximum = domain Maximum:\ngraphing-calculator-narration-domain-minimum = domain Minimum:\ngraphing-calculator-narration-drag-mode-x = X\ngraphing-calculator-narration-drag-mode-xy = X and Y\ngraphing-calculator-narration-drag-mode-y = Y\ngraphing-calculator-narration-draggable-image-description = draggable image\ngraphing-calculator-narration-draggable-image-off-screen-prompt = { " " }not completely visible on screen\ngraphing-calculator-narration-draggable-label-description = draggable label\ngraphing-calculator-narration-edit-action = Edit Action\ngraphing-calculator-narration-edit-expression-list = Edit Expression List\ngraphing-calculator-narration-edit-graph-on-desmos = Edit graph on Desmos\ngraphing-calculator-narration-edit-list-mode-off = Edit list mode off.\ngraphing-calculator-narration-edit-list-mode-on = Edit list mode on.\ngraphing-calculator-narration-edit-on-desmos = Edit graph on Desmos\ngraphing-calculator-narration-edit-slider-variable-limits = Edit { $variable } Limits\ngraphing-calculator-narration-editable-label-mode-editable-math = Editable label mode: Editable Math\ngraphing-calculator-narration-editable-label-mode-editable-text = Editable label mode: Editable Text\ngraphing-calculator-narration-editable-point-label-at-coordinates = Editable point label at { $coordinates }\ngraphing-calculator-narration-empty-graphpaper = Empty graph paper.\ngraphing-calculator-narration-expression-audio-trace-mac = To audio trace, press OPTION+T.\ngraphing-calculator-narration-expression-audio-trace-windows = To audio trace, press ALT+T.\ngraphing-calculator-narration-expression-bar = Expression Bar\ngraphing-calculator-narration-expression-evaluation-has-graph = Has graph.\ngraphing-calculator-narration-expression-evaluation-has-graph-and-regression = Has graph and regression. To access statistics, press Tab.\ngraphing-calculator-narration-expression-evaluation-has-regression = Has regression. To access statistics, press Tab.\ngraphing-calculator-narration-expression-evaluation-is-distribution = is distribution.\ngraphing-calculator-narration-expression-evaluation-is-t-test = is T test. To access statistics, press Tab.\ngraphing-calculator-narration-expression-hidden-label = Hidden { $label }\ngraphing-calculator-narration-expression-index-table = Expression { $index } table\ngraphing-calculator-narration-expression-label = Label\ngraphing-calculator-narration-expression-list = Expression list\ngraphing-calculator-narration-expression-search-results =\n    { $count ->\n        [zero] No results\n        [one] 1 result\n       *[other] { $count } results\n    }\ngraphing-calculator-narration-fill-opacity = Fill Opacity:\ngraphing-calculator-narration-fill-visible = Fill visible\ngraphing-calculator-narration-folder-collapsed = folder collapsed\ngraphing-calculator-narration-folder-expanded = folder expanded\ngraphing-calculator-narration-folder-has-items = { $folder } has { $count } items\ngraphing-calculator-narration-functions = Functions\ngraphing-calculator-narration-graph-settings-controls = Graph Settings Controls\ngraphing-calculator-narration-graphpaper-label = graph paper\ngraphing-calculator-narration-graphpaper-multiple-graphs = Graph paper showing { $count } graphs.\ngraphing-calculator-narration-graphpaper-one-graph = Graph paper showing 1 graph.\ngraphing-calculator-narration-hide-animation-properties = Hide Animation Properties\ngraphing-calculator-narration-hide-expression = Hide Expression\ngraphing-calculator-narration-hide-expression-list = Hide expression list\ngraphing-calculator-narration-hide-folder = Hide Folder\ngraphing-calculator-narration-hide-image = Hide Image\ngraphing-calculator-narration-hide-keypad = Hide Keypad\ngraphing-calculator-narration-hide-options = Hide Options\ngraphing-calculator-narration-hide-table-column = Hide Column\ngraphing-calculator-narration-image-styles = Styles\ngraphing-calculator-narration-keypad-key-next-curve = Next Curve\ngraphing-calculator-narration-keypad-key-next-poi = Next Point of Interest\ngraphing-calculator-narration-keypad-key-next-point = Next Point\ngraphing-calculator-narration-keypad-key-previous-curve = Previous Curve\ngraphing-calculator-narration-keypad-key-previous-poi = Previous Point of Interest\ngraphing-calculator-narration-keypad-key-previous-point = Previous Point\ngraphing-calculator-narration-keypad-key-speed-down = Speed Down\ngraphing-calculator-narration-keypad-key-speed-up = Speed Up\ngraphing-calculator-narration-keypad-key-volume-down = Volume Down\ngraphing-calculator-narration-keypad-key-volume-up = Volume Up\ngraphing-calculator-narration-label-angle = Label Angle:\ngraphing-calculator-narration-label-size = Label Size:\ngraphing-calculator-narration-label-text = Label Text\ngraphing-calculator-narration-label-visible = Label visible\ngraphing-calculator-narration-line-opacity = Line Opacity:\ngraphing-calculator-narration-line-style-dashed = Dashed\ngraphing-calculator-narration-line-style-dotted = Dotted\ngraphing-calculator-narration-line-style-solid = Solid\ngraphing-calculator-narration-lines-visible = Lines visible\ngraphing-calculator-narration-main-desmos-graphing-calculator = Desmos Graphing Calculator\ngraphing-calculator-narration-make-clickable = make clickable\ngraphing-calculator-narration-menu-drag-enabled = Drag Enabled\ngraphing-calculator-narration-movable-point-description = movable point\ngraphing-calculator-narration-movable-point-off-screen-prompt = { " " }not visible on screen\ngraphing-calculator-narration-movable-point-prefix = Graph point\ngraphing-calculator-narration-movable-point-suffix-usage-instructions = { " " }is movable. Press Arrows or Shift+Arrows to adjust.\ngraphing-calculator-narration-no-interactive-points = No interactive points on screen\ngraphing-calculator-narration-open-graph = Open Graph\ngraphing-calculator-narration-options-menu = Options Menu\ngraphing-calculator-narration-options-menu-closed = Options menu closed.\ngraphing-calculator-narration-options-menu-open = Options menu open.\ngraphing-calculator-narration-pause-variable-animation = Pause { $variable } Animation\ngraphing-calculator-narration-play-variable-animation = Play { $variable } Animation\ngraphing-calculator-narration-poi-graph-point = Graph point\ngraphing-calculator-narration-point-description = point\ngraphing-calculator-narration-point-opacity = Point Opacity:\ngraphing-calculator-narration-point-size = Point Size:\ngraphing-calculator-narration-point-style-cross = Cross\ngraphing-calculator-narration-point-style-open = Open\ngraphing-calculator-narration-point-style-point = Point\ngraphing-calculator-narration-points-visible = Points visible\ngraphing-calculator-narration-powered-by-desmos = Powered by Desmos\ngraphing-calculator-narration-redo = Redo\ngraphing-calculator-narration-run-action-icon = Run Action\ngraphing-calculator-narration-settings-angle = Angle Settings\ngraphing-calculator-narration-settings-cartesian-grid = Cartesian Grid\ngraphing-calculator-narration-settings-polar-grid = Polar Grid\ngraphing-calculator-narration-settings-show-both = Show Both\ngraphing-calculator-narration-settings-show-positive = Show Positive\ngraphing-calculator-narration-settings-x-axis-label = add x-axis label\ngraphing-calculator-narration-settings-x-axis-max = X Axis Maximum:{ " " }\ngraphing-calculator-narration-settings-x-axis-min = X Axis Minimum:{ " " }\ngraphing-calculator-narration-settings-x-axis-step = X Axis Step Size:{ " " }\ngraphing-calculator-narration-settings-y-axis-label = add y-axis label\ngraphing-calculator-narration-settings-y-axis-max = Y Axis Maximum:{ " " }\ngraphing-calculator-narration-settings-y-axis-min = Y Axis Minimum:{ " " }\ngraphing-calculator-narration-settings-y-axis-step = Y Axis Step Size:{ " " }\ngraphing-calculator-narration-share-graph-link = Link to this graph\ngraphing-calculator-narration-share-graph-link-copied = Link copied\ngraphing-calculator-narration-share-graph-link-unable-to-copy = Unable to copy link\ngraphing-calculator-narration-show-animation-properties = Show Animation Properties\ngraphing-calculator-narration-show-as-decimal = Show as Decimal\ngraphing-calculator-narration-show-as-fraction = Show as Fraction\ngraphing-calculator-narration-show-expression = Show Expression\ngraphing-calculator-narration-show-expression-list = Show expression list\ngraphing-calculator-narration-show-image = Show Image\ngraphing-calculator-narration-show-keypad = Show Keypad\ngraphing-calculator-narration-show-options = Show Options\ngraphing-calculator-narration-show-table-column = Show Column\ngraphing-calculator-narration-slider-animate-faster = Animate Faster\ngraphing-calculator-narration-slider-animate-slower = Animate Slower\ngraphing-calculator-narration-slider-animating-at-speed = Animating at { $speed }x\ngraphing-calculator-narration-slider-loop-forwards-and-backwards = Loop forwards and backwards\ngraphing-calculator-narration-slider-maximum = Slider Maximum:\ngraphing-calculator-narration-slider-minimum = Slider Minimum:\ngraphing-calculator-narration-slider-play-indefinitely = Play indefinitely\ngraphing-calculator-narration-slider-play-once = Play once\ngraphing-calculator-narration-slider-repeat-one-direction = Repeat in one direction\ngraphing-calculator-narration-slider-step = Slider Step Size:\ngraphing-calculator-narration-slider-trace-no-sliders = No sliders to trace.\ngraphing-calculator-narration-slider-trace-off = Slider trace off.\ngraphing-calculator-narration-slider-trace-on = Slider trace on.\ngraphing-calculator-narration-slider-variable-paused = { $variable } paused\ngraphing-calculator-narration-slider-variable-playing = { $variable } playing\ngraphing-calculator-narration-slider-variable-restarted = { $variable } restarted\ngraphing-calculator-narration-table-column-header = Column header { $column }\ngraphing-calculator-narration-table-no-column-header = No column header\ngraphing-calculator-narration-table-row-column = Row { $row } Col { $column }\ngraphing-calculator-narration-tick-action = Tick Action\ngraphing-calculator-narration-toggle-audio-trace = Toggle Audio Trace\ngraphing-calculator-narration-toggle-letters = Toggle Letters\ngraphing-calculator-narration-unable-to-activate-account-menu = Unable to activate account menu\ngraphing-calculator-narration-unable-to-activate-help-menu = Unable to activate help menu\ngraphing-calculator-narration-unable-to-activate-language-menu = Unable to activate language menu\ngraphing-calculator-narration-unable-to-activate-share-menu = Unable to activate share menu\ngraphing-calculator-narration-unable-to-add-expression = Unable to add expression\ngraphing-calculator-narration-unable-to-add-note = Unable to add note\ngraphing-calculator-narration-unable-to-add-table = Unable to add table\ngraphing-calculator-narration-unable-to-focus-expression-list = Unable to focus expression list\ngraphing-calculator-narration-undo = Undo\ngraphing-calculator-narration-viewport-updated = Graph viewport updated.\ngraphing-calculator-narration-viewport-zoom-default = Graph zoom default\ngraphing-calculator-narration-viewport-zoom-in = Graph zoom in\ngraphing-calculator-narration-viewport-zoom-out = Graph zoom out\ngraphing-calculator-narration-viewport-zoom-square = Graph zoom square\ngraphing-calculator-narration-visual-parameters-height = Height\ngraphing-calculator-narration-visual-parameters-offset = Offset\ngraphing-calculator-narration-visual-parameters-width = Width\ngraphing-calculator-narration-zoom-default = Restore Default Zoom\ngraphing-calculator-text-add-screen-reader-label-placeholder = Add screen reader label\ngraphing-calculator-text-audio-trace-no-graph-to-trace = No graph to trace.\ngraphing-calculator-text-audio-trace-no-implicit-support = Sorry, but I can\'t trace implicit curves yet.\ngraphing-calculator-text-audio-trace-no-parametric-support = Sorry, but I can\'t trace parametric curves yet.\ngraphing-calculator-text-audio-trace-no-polar-support = Sorry, but I can\'t trace polar curves yet.\ngraphing-calculator-text-audio-trace-off = Audio trace off.\ngraphing-calculator-text-audio-trace-on = Audio trace on.\ngraphing-calculator-text-color-black = black\ngraphing-calculator-text-color-blue = blue\ngraphing-calculator-text-color-gray = gray\ngraphing-calculator-text-color-green = green\ngraphing-calculator-text-color-orange = orange\ngraphing-calculator-text-color-purple = purple\ngraphing-calculator-text-color-red = red\ngraphing-calculator-text-color-unknown = color unknown\ngraphing-calculator-text-enter-note-placeholder = Enter a note...\ngraphing-calculator-text-enter-pareneter = Enter the { $param }.\ngraphing-calculator-text-export-braille-email-accessibility = Feedback? Email <1>accessibility@desmos.com</1>{"."}\ngraphing-calculator-text-image-enter-note-placeholder = Enter a note...\ngraphing-calculator-text-label-orientation-above = Above\ngraphing-calculator-text-label-orientation-above-left = Above Left\ngraphing-calculator-text-label-orientation-above-right = Above Right\ngraphing-calculator-text-label-orientation-below = Below\ngraphing-calculator-text-label-orientation-below-left = Below Left\ngraphing-calculator-text-label-orientation-below-right = Below Right\ngraphing-calculator-text-label-orientation-default = Default\ngraphing-calculator-text-label-orientation-left = Left\ngraphing-calculator-text-label-orientation-right = Right\ngraphing-calculator-text-loading-image = Loading image...\ngraphing-calculator-text-note-placeholder = Enter a note...\ngraphing-calculator-text-page-description = Explore math with our beautiful, free online graphing calculator. Graph functions, plot points, visualize algebraic equations, add sliders, animate graphs, and more.\ngraphing-calculator-text-parameter-name-binwidth = Bin Width\ngraphing-calculator-text-parameter-name-data = Data Set\ngraphing-calculator-text-parameter-name-dof = Degrees of Freedom\ngraphing-calculator-text-parameter-name-height = Height\ngraphing-calculator-text-parameter-name-max = Maximum\ngraphing-calculator-text-parameter-name-mean = Mean\ngraphing-calculator-text-parameter-name-min = Minimum\ngraphing-calculator-text-parameter-name-offset = Offset\ngraphing-calculator-text-parameter-name-probsuccess = Success Probability\ngraphing-calculator-text-parameter-name-stddev = Standard Deviation\ngraphing-calculator-text-parameter-name-trials = Trials\ngraphing-calculator-text-refreshable-braille-display-note = Use a refreshable Braille display, or just type Braille with a keyboard.\ngraphing-calculator-text-regression-potentially-inaccurate-parameters = Some parameters may be too large or small to represent accurately.\ngraphing-calculator-text-share-graph-link = Link to this graph\ngraphing-calculator-text-table-created = Table created.\ngraphing-calculator-text-table-more-rows = { $rowCount } more rows\ngraphing-calculator-text-toast-choose-one-file = You can only choose one file as a replacement\ngraphing-calculator-text-toast-error-importing-graph = Error importing graph. Check the URL?\ngraphing-calculator-text-toast-error-no-folders = Only graphs without folders can be inserted into a folder.\ngraphing-calculator-text-toast-expression-size-limit = Maximum expression size reached.\ngraphing-calculator-text-toast-graph-cleared = Graph cleared.\ngraphing-calculator-text-toast-graph-reset = Graph reset.\ngraphing-calculator-text-toast-image-upload-failed = Image upload failed.\ngraphing-calculator-text-toast-imported-graph = Graph imported!\ngraphing-calculator-text-toast-importing-graph = Importing graph...\ngraphing-calculator-text-toast-no-file-selected = You did not select a file\ngraphing-calculator-text-toast-undo-cmd-z = Press CMD+Z to undo.\ngraphing-calculator-text-toast-undo-ctrl-z = Press CTRL+Z to undo.\ngraphing-calculator-text-toast-uploading-images = Uploading images...\ngraphing-calculator-text-toast-zoom-to-fit = We zoomed to fit your data.\ngraphing-calculator-text-zoom-fit = Zoom Fit\ngraphing-tours-heading-advanced-tables = Advanced Tables\ngraphing-tours-heading-derivatives = Derivatives\ngraphing-tours-heading-folders = Folders\ngraphing-tours-heading-lists = Lists\ngraphing-tours-heading-regressions = Regressions\ngraphing-tours-heading-restrictions = Restrictions\ngraphing-tours-heading-sliders = Sliders\ngraphing-tours-heading-tables = Tables\ngraphing-tours-label-advanced-tables-continue = Click here to continue editing this table.\ngraphing-tours-label-advanced-tables-convert = Convert this to a table.\ngraphing-tours-label-advanced-tables-create = Click here to generate a table.\ngraphing-tours-label-advanced-tables-dots = Click here to only show the dots.\ngraphing-tours-label-advanced-tables-edit-list = Click the "Edit List" button.\ngraphing-tours-label-advanced-tables-graph = Start by graphing a function.\ngraphing-tours-label-advanced-tables-new-column = Move right to add a new column.\ngraphing-tours-label-advanced-tables-options = Click and hold on this icon until the options menu opens up.\ngraphing-tours-label-advanced-tables-start = Let\'s make a function. First: click here to create a new blank expression.\ngraphing-tours-label-advanced-tables-type-function = Try typing { $sample_expression }\ngraphing-tours-label-advanced-tables-wizard = You\'re a table wizard!\ngraphing-tours-label-awesome = Awesome!\ngraphing-tours-label-brilliant = Brilliant!\ngraphing-tours-label-derivative-graph-derivative = To graph its derivative: { $equation }\ngraphing-tours-label-derivative-hint-type-derivative = Hint: To get the derivative operator, just type d/dx.\ngraphing-tours-label-derivative-one-more = Let\'s try one more: { $equation }\ngraphing-tours-label-derivative-start-function = Start with a function: { $equation }\ngraphing-tours-label-derivative-start-graph = Let\'s graph a derivative!\ngraphing-tours-label-folders-collapse = Now weâll explore some folder functionality. Click here to collapse the folder.\ngraphing-tours-label-folders-did-you-know = Did You Know...\ngraphing-tours-label-folders-grab = Now grab this equation by its left edge and drag it into the folder.\ngraphing-tours-label-folders-great-start = Thatâs a great start!\ngraphing-tours-label-folders-hide = You can hide everything in the folder with one click. Click here to try.\ngraphing-tours-label-folders-indicator = Hint: The gray line will show you if the expression is in the folder.\ngraphing-tours-label-folders-name = Give your folder a name.\ngraphing-tours-label-folders-new-equation = Let\'s make a new equation. For example, type: { $equation }\ngraphing-tours-label-folders-option = ... and select the "folder" option.\ngraphing-tours-label-folders-start = Let\'s make a folder!\ngraphing-tours-label-great-job = Great job!\ngraphing-tours-label-last-thing = Last thing!\ngraphing-tours-label-list-computation = You can do a computation on a list. For example: { $equation }\ngraphing-tours-label-lists-are-powerful = Lists are powerful. Let\'s see.\ngraphing-tours-label-lists-begin-equation = Begin by typing { $equation }\ngraphing-tours-label-lists-count-by = If you want to count by 5 instead, just write something like this: { $equation }\ngraphing-tours-label-lists-create-range = You can create lists of integers even more easily. Try this: { $equation }\ngraphing-tours-label-lists-graph-equation = Graph: { $equation }\ngraphing-tours-label-lists-graph-points = Let\'s graph a few points.\ngraphing-tours-label-lists-hint-abc = Hint: press the \'A B C\' button on the keypad to find the [ ] buttons\ngraphing-tours-label-lists-hint-plot-points = Hint: this will plot a point for each item of b.\ngraphing-tours-label-lists-hint-superscript = Hint: you can type { $suggestion1 } or use the { $suggestion2 } button on the keypad below.\ngraphing-tours-label-lists-point-equation = Try this: { $equation }\ngraphing-tours-label-lists-put-to-work = Nice. Let\'s put that list to work.\ngraphing-tours-label-new-item = Click here to add a new item.\ngraphing-tours-label-nice = Nice!\ngraphing-tours-label-regressions-better-fit = Edit this equation to find a better fit. Try, for example:<br>{ $equation }\ngraphing-tours-label-regressions-check-model = Nice. Let\'s check the model.\ngraphing-tours-label-regressions-data = First, let\'s get some data.\ngraphing-tours-label-regressions-data-2 = Let\'s start with some data!\ngraphing-tours-label-regressions-docs = Head over to Google Docs and copy and paste this { $sample_data_link }.\ngraphing-tours-label-regressions-equation = Now type: { $equation }\ngraphing-tours-label-regressions-expression-option = ... and select the "expression" option.\ngraphing-tours-label-regressions-fill-sample-data = Fill in the sample data:\ngraphing-tours-label-regressions-hint-1 = Hint #1: to get { $y_1 } type { $y1 }.\ngraphing-tours-label-regressions-hint-2 = Hint #2: { $twiddle } is in our onscreen keypad in the \'A B C\' section.\ngraphing-tours-label-regressions-keep-exploring = Nice work &ndash; Keep exploring!\ngraphing-tours-label-regressions-new-model = Now, let\'s try a new model.\ngraphing-tours-label-regressions-new-table = Click here to add a new table.\ngraphing-tours-label-regressions-own-data = Note: you can add your own data instead by clicking the { $plus_icon } button.\ngraphing-tours-label-regressions-residuals = Residuals are the difference between your data and your model. Click here to add them to your table and plot them on the graph.\ngraphing-tours-label-regressions-sample-data = sample data\ngraphing-tours-label-require-expressions-visible = Click to show the list of expressions.\ngraphing-tours-label-require-not-edit-list-mode = Click to return to your expressions.\ngraphing-tours-label-require-resources-not-open = Click to return to this graph.\ngraphing-tours-label-restrictions-abc = Hint: press the \'A B C\' button on the keypad to find the { $buttons } buttons\ngraphing-tours-label-restrictions-blank-expression = Click here to make a new blank expression.\ngraphing-tours-label-restrictions-change-equation = Change this equation to { $sample_expression }\ngraphing-tours-label-restrictions-domain = Restrict the domain of this line by adding { $sample_expression } to the end.\ngraphing-tours-label-restrictions-dont-forget = Don\'t forget the "y="!\ngraphing-tours-label-restrictions-graph-parabola = Now graph: { $sample_expression }\ngraphing-tours-label-restrictions-move-parabola = Move the parabola.\ngraphing-tours-label-restrictions-new-expression = Click here to create a new expression.\ngraphing-tours-label-restrictions-range = Now let\'s restrict the range. Add { $sample_expression } to the end.\ngraphing-tours-label-restrictions-star = You\'re a restrictions star!\ngraphing-tours-label-restrictions-start = Let\'s get started!\ngraphing-tours-label-restrictions-straight-line = Try graphing a straight line, like { $sample_expression }\ngraphing-tours-label-restrictions-type-all = Try typing all of { $sample_expression }\ngraphing-tours-label-restrictions-typing-hint = Hint: you can type { $suggestion1 }, or use the { $suggestion2 } button on the keypad below.\ngraphing-tours-label-self-destruct = This message will self-destruct in { $seconds }...\ngraphing-tours-label-sliders-add = Now click here to add the sliders.\ngraphing-tours-label-sliders-blank-expression = Click here to create a new blank expression.\ngraphing-tours-label-sliders-change-value = Type in here to change the value.\ngraphing-tours-label-sliders-drag-handle = Drag the handle to change the value.\ngraphing-tours-label-sliders-hands-free = Go "Hands-free"\ngraphing-tours-label-sliders-make-sliders = Let\'s make some sliders!\ngraphing-tours-label-sliders-press-play = Press play to animate the slider.\ngraphing-tours-label-sliders-pro = You\'re a slider pro!\ngraphing-tours-label-sliders-try-typing = Try typing { $sample_expression }\ngraphing-tours-label-tables-back = Click back to continue editing.\ngraphing-tours-label-tables-close-options = Click anywhere to close the drawing options.\ngraphing-tours-label-tables-dots = Click here to connect the dots.\ngraphing-tours-label-tables-enter = Now try pressing Enter.\ngraphing-tours-label-tables-fill-another = Just fill in one more...\ngraphing-tours-label-tables-fill-cell = Fill it in.\ngraphing-tours-label-tables-fill-row = Fill in this whole row.\ngraphing-tours-label-tables-last-trick = Last trick!\ngraphing-tours-label-tables-next-row = Go down to the next row to add more data.\ngraphing-tours-label-tables-open-options = Click and hold on this icon until the options menu opens up.\ngraphing-tours-label-tables-select-table = ... and select the "table" option.\ngraphing-tours-label-tables-start = Let\'s make a table!\ngraphing-tours-label-tables-type-number = Type any number here.\ngraphing-tours-label-tables-valid-number = Uh-oh! Type a valid number here.\ngraphing-tours-label-tables-whiz = You\'re a tables whiz!\nmatrix-calculator-button-new = New Matrix\nmatrix-calculator-button-settings = settings\nmatrix-calculator-heading-edit-matrix = Edit Matrix { $variable }\nmatrix-calculator-label-columns = Columns\nmatrix-calculator-label-rows = Rows\nmatrix-calculator-narration-add-column = Add Column\nmatrix-calculator-narration-add-row = Add Row\nmatrix-calculator-narration-evaluation = equals { $rowCount } by { $columnCount } matrix.\nmatrix-calculator-narration-evaluation-row = Row { $rowNumber }: { $values }.\nmatrix-calculator-narration-keypad-key-det = Determinant\nmatrix-calculator-narration-keypad-key-inverse = Inverse\nmatrix-calculator-narration-keypad-key-rref = Reduced row echelon form\nmatrix-calculator-narration-keypad-key-trace = Trace\nmatrix-calculator-narration-keypad-key-transpose = Transpose\nmatrix-calculator-narration-matrix-with-variable = Matrix { $variable }\nmatrix-calculator-narration-matrix-without-variable = Matrix\nmatrix-calculator-narration-new-dimensions = Matrix size: { $rows } by { $cols }\nmatrix-calculator-narration-remove-column = Remove Column\nmatrix-calculator-narration-remove-row = Remove Row\nmatrix-calculator-narration-resize-controls = Resize Matrix Controls\nmatrix-calculator-narration-settings-menu = Settings Menu\nmatrix-calculator-narration-title = Desmos Matrix Calculator\n### String for curriculum marketing\n\n\n### 966 English words, 58 English strings\n\ncurriculum-info-button-no = No\ncurriculum-info-button-request-form-submit = Request More Information\ncurriculum-info-button-yes = Yes\ncurriculum-info-error-request-form-contact-info-email = Please enter a valid email address.\ncurriculum-info-error-request-form-contact-info-first-name = Please enter your first name.\ncurriculum-info-error-request-form-contact-info-last-name = Please enter your last name.\ncurriculum-info-error-request-form-enter-role = Please enter your role.\ncurriculum-info-error-request-form-site-name = Please enter the name of your school or district.\ncurriculum-info-heading-end-of-page-info = Want to learn more?\ncurriculum-info-heading-grade-level-interest = Which grades are you interested in?\ncurriculum-info-heading-partners-logos = Some of Our Partner Schools and Districts\ncurriculum-info-heading-request-form = Request more information about the curriculum.\ncurriculum-info-heading-request-form-contact-info = Your contact information:\ncurriculum-info-heading-request-form-this-fall-interest = Are you looking to use the Desmos Curriculum this fall?\ncurriculum-info-heading-research-results = <1>What are the results?</1><2>We surveyed 70 teachers and 1,500 students who piloted our curriculum, asking them to compare it to their previous curriculum. Hereâs what they said:</2>\ncurriculum-info-heading-testimonials = What are people saying?\ncurriculum-info-heading-whats-in-the-curriculum = What\'s in the Desmos Curriculum?\ncurriculum-info-label-grade-6-interest = Grade 6\ncurriculum-info-label-grade-7-interest = Grade 7\ncurriculum-info-label-grade-8-interest = Grade 8\ncurriculum-info-label-request-form-contact-info-email = Email\ncurriculum-info-label-request-form-contact-info-first-name = First Name\ncurriculum-info-label-request-form-contact-info-last-name = Last Name\ncurriculum-info-label-request-form-enter-role = What is your role?\ncurriculum-info-label-request-form-enter-role-placeholder = Role\ncurriculum-info-label-request-form-select-role = Select your role:\ncurriculum-info-label-request-form-site-name = Name of school or district:\ncurriculum-info-label-request-form-site-name-placeholder = School or District Name\ncurriculum-info-label-role-administrator = Administrator\ncurriculum-info-label-role-coach = Math Coach\ncurriculum-info-label-role-other = Other\ncurriculum-info-label-role-teacher = Teacher\ncurriculum-info-label-try-this-activity = Try an activity!\ncurriculum-info-narration-ipad-with-student-screen = An iPad with a student screen. On the screen, the student sketches planets and explores what happens when the drawing is sent through different machines. Behind the iPad, there is a paper version of the activity where the student has sketched scaled copies of a shape on a grid.\ncurriculum-info-narration-laptop-with-student-screen = A laptop with a student screen. On the screen, the student describes what he notices and wonder while changing the scale factor of a mosaic pattern he created.\ncurriculum-info-narration-screen-with-teacher-dashboard = A computer screen with two windows open. The first window shows the teacher screen for Grade 7, Unit 5. The second window, to the right of the first, shows a teacher dashboard with square patterns created by students in the class.\ncurriculum-info-text-activity-caption-student-ideas = <1>Studentsâ ideas are the engine of our curriculum. Their sketches power simulations and their mathematical thinking powers classroom conversations. In this lesson about functions, teachers help students make connections between scenarios and the graphs that represent them. <2>Try it for free!</2></1>\ncurriculum-info-text-header-content = <1>The Desmos Math Curriculum is here!</1><2>Brought to you by the team that created the Desmos calculators and activities. Math 6â8 is available now. Algebra 1 will be available for the 2022â2023 school year. </2>\ncurriculum-info-text-join-info-session = <1>Interested in learning more? <2>Watch the info session.</2></1>\ncurriculum-info-text-questions-info-faqs-email = <1>Questions? Please check our <2>Curriculum FAQs</2> or reach out to us at <3>curriculum@desmos.com</3>{"."}</1>\ncurriculum-info-text-quote-coach-teacher-for-23-years = <1/><2>I have been a teacher for 23 years and this is the most engaged I have seen students in a mathematics classroom.</2><3><4>Rebecca Moore,</4> Math Coach, Naugatuck, CT</3>\ncurriculum-info-text-quote-facilitator-falling-in-love = <1/><2>Every lesson that I preview, I fall in love a little more â¤ thank you for this work and thank you for reflecting and listening to the feedback!</2><3><4>Jenny Ainslie,</4> Secondary Math Facilitator, Orange County, NC</3>\ncurriculum-info-text-quote-teacher-if-not-using-climbing-analogy = <1/><2>If you\'re teaching math and not utilizing Desmos, you may as well be climbing a mountain with your hands tied behind your back.</2><3><4>Mike Del Greco,</4> Math Teacher, Sudbury, MA</3>\ncurriculum-info-text-quote-teacher-saved-my-life-this-year = <1/><2>Desmos has saved my life this year. I am so grateful that we signed up. It is the perfect tool for remote learning and my students love it.</2><3><4>Brendan Smith,</4> Math Teacher, Oakland, CA</3>\ncurriculum-info-text-quote-teacher-super-intuitive-friendly = <1/><2>Your team has made this super intuitive and user friendly. Cannot say enough about how much we appreciate the frequent contacts / emails / check-ins etc.</2><3><4>Shannon Kenyon,</4> Curriculum Resource Teacher, Lewiston, ID</3>\ncurriculum-info-text-quote-teachers-exceptional-problem-solvers = <1/><2>Our students are loving Desbook and becoming exceptional problem solvers â even in this distance learning environment! I genuinely have never appreciated anything so much in my life.\'</2><3><4>Heather Staniszewski,</4> Math Teacher, Belmont-Redwood, CA</3>\ncurriculum-info-text-request-sent-coach-admin-follow-up = <1>If you have questions in the meantime, <2>learn more about the curriculum</2> or <3>set up a call</3>{"."}</1>\ncurriculum-info-text-request-sent-confirmation = Thank you, { $firstName }! An email with more information is on the way.\ncurriculum-info-text-request-sent-other-follow-up-email-subject = I have a question about the Desmos Curriculum\ncurriculum-info-text-request-sent-other-role-follow-up = <1>If you have questions, please don\'t hesitate to reach out to us directly at <2>{$v0}</2>{"."}</1>\ncurriculum-info-text-request-sent-teacher-follow-up = <1>If you have questions in the meantime, check out the <2>Desmos Math Curriculum FAQs</2>{"."}</1>\ncurriculum-info-text-section-lessons-that-express-brilliance = <1>Lessons that help students express their brilliance every day.</1><2>Every student is brilliant, but not every student <3>feels</3> brilliant in math class, particularly students from <4>historically excluded communities</4>{"."} We design our curriculum to put studentsâ ideas at its center. Our lessons pose problems that invite a variety of approaches. And our technology helps teachers celebrate and develop all of that interesting thinking in their classrooms.</2>\ncurriculum-info-text-section-paper-technology-blend = <1>A blend of paper and technology.</1><2>We apply our expertise in technology, pedagogy, and design to enhance the top-rated curriculum from <3>Illustrative Mathematics</3> and <4>Open Up Resources</4>{"."} We offer learning experiences on computers that are dynamic and interactive as well as experiences on paper that are flexible and creative.</2>\ncurriculum-info-text-section-powerful-facilitation-tools = <1>Powerful facilitation tools for teachers.</1><2>Our problem-based lessons empower students to explore new ideas, and our teacher dashboard helps teachers connect those ideas together. Whether teachers are observing student learning on our lesson summary page or guiding productive discussions with our <3>conversation toolkit</3>, our facilitation tools make teaching more effective and more fun.</2>\ncurriculum-info-text-section-results-students-enjoy-more = <1>Students enjoy math more.</1><2>We help students experience the need for new mathematical ideas, and our interactive feedback shows them the value of their own thinking.</2><3><4>The result:</4> Teachers in the pilot said their students were more engaged in the Desmos Curriculum than in their previous curriculum, and students reported enjoying math class more.</3>\ncurriculum-info-text-section-results-students-learn-more = <1>Students learn more math.</1><2>We design problem-based lessons that promote mathematical curiosity and student engagement, building on the coherence and rigor of the Illustrative Mathematics curriculum. Each unit includes student notes, skill practices, and rich assessments to help students show what they know and can do.</2><3><4>The result:</4> Students and teachers in the pilot both said that students learned more with the Desmos Curriculum than with their previous curriculum.</3>\ncurriculum-info-text-section-results-teacher-enjoy-more = <1>Teachers enjoy teaching more.</1><2>We pair your entire teaching team with a dedicated National Coach who will support your teamâs onboarding and instruction throughout the year. Additionally, we offer just-in-time lesson preview emails, unit overview webinars, and other supports to help your team succeed.</2><3><4>The result:</4> Teachers in the pilot felt happier and better supported with the Desmos Curriculum than with their previous curriculum.</3>\ncurriculum-info-text-section-tags = <1>The Desmos Curriculum is...</1><2><3>FERPA compliant</3><4>COPPA compliant</4><5>Standards aligned</5><6>Available in Spanish</6></2>\n### Strings for desmos.com homepage\n\n\n### 4702 English words, 389 English strings\n\nfrontpage-button-braille-print-examples = Print these examples\nfrontpage-button-main-join-class = Join\nfrontpage-error-something-went-wrong-try-again-later = Sorry! Something went wrong. Please try again later.\nfrontpage-heading-about-desmos-classroom = About Desmos Classroom\nfrontpage-heading-about-desmos-studio = About Desmos Studio\nfrontpage-heading-art-contest-guest-judges = Guest Judges\nfrontpage-heading-braille-examples = Braille Examples\nfrontpage-heading-braille-table-type-this = Type this\nfrontpage-heading-braille-table-typeset = Typeset\nfrontpage-heading-braille-view-examples-in = View examples in:\nfrontpage-heading-equity-as-we-do-this-work = As we do this work, we ask ourselves...\nfrontpage-heading-equity-disrupt-systemic-inequities = III.  We want to disrupt systemic inequities and conditions of marginalization in education.\nfrontpage-heading-equity-more-equitable-workplace = II. We want to work continuously towards an equitable workplace.\nfrontpage-heading-equity-next-steps = Next Steps and an Invitation\nfrontpage-heading-equity-principles = Desmos Equity Principles\nfrontpage-heading-equity-serve-all-students-and-teachers = I.  We want our products to serve all students and teachers.\nfrontpage-heading-footer-company = Company\nfrontpage-heading-footer-legal = Legal\nfrontpage-heading-footer-products = Products\nfrontpage-heading-footer-resources = Resources\nfrontpage-heading-guiding-build-for-real-classrooms = Build for Real Classrooms\nfrontpage-heading-guiding-champion-teachers = Champion Teachers\nfrontpage-heading-guiding-design-for-delight = Design for Delight\nfrontpage-heading-guiding-principles = Desmos Guiding Principles\nfrontpage-heading-guiding-works-every-time = Works Every Time\nfrontpage-heading-header-maintenance-mode = Desmos is currently undergoing scheduled maintenance, and accounts are temporarily unavailable.\nfrontpage-heading-main-global-art-contest-finalists-2020 = Global Math Art Contest 2020 Finalists\nfrontpage-heading-main-global-art-contest-finalists-2021 = Global Math Art Contest 2021 Finalists\nfrontpage-heading-main-lets-learn-together = Let\'s learn together.\nfrontpage-heading-main-our-partners = Our Partners\nfrontpage-heading-main-students = Students\nfrontpage-heading-main-teachers = Teachers\nfrontpage-heading-main-using-desmos-classroom = Using Desmos Classroom?\nfrontpage-heading-partners-accessibility-out-of-box = Accessibility Out of the Box\nfrontpage-heading-partners-anywhere-any-device = Anywhere, Any Device\nfrontpage-heading-partners-constant-improvements = Constant Improvements\nfrontpage-heading-partners-global-scale = Global Scale\nfrontpage-heading-partners-rock-solid-reliability = Rock-Solid Reliability\nfrontpage-heading-partners-want-to-embed = Want to embed the power of Desmos right into your website or app?\nfrontpage-heading-shared-contact-us = Contact Us\nfrontpage-heading-team-job-title-ceo = CEO\nfrontpage-heading-team-job-title-coaching = Coaching\nfrontpage-heading-team-job-title-copy-editing = Copy Editing\nfrontpage-heading-team-job-title-data = Data\nfrontpage-heading-team-job-title-engineering = Engineering\nfrontpage-heading-team-job-title-faculty = Faculty\nfrontpage-heading-team-job-title-interaction-developer = Interaction Developer\nfrontpage-heading-team-job-title-localization = Localization\nfrontpage-heading-team-job-title-operations = Operations\nfrontpage-heading-team-job-title-partnerships = Partnerships\nfrontpage-heading-team-job-title-product = Product\nfrontpage-heading-team-job-title-support = Support\nfrontpage-heading-team-meet-the-team = Meet the Team\nfrontpage-heading-team-partnerships-programs-and-operations = Partnerships, Programs, and Operations\nfrontpage-heading-team-product-and-engineering = Product and Engineering\nfrontpage-heading-team-teaching = Teaching\nfrontpage-heading-testmode-about-desmos-test-mode = About Desmos Test Mode\nfrontpage-heading-testmode-about-tab = About\nfrontpage-heading-testmode-android-tab = Android (Beta)\nfrontpage-heading-testmode-chromebooks-tab = Chromebooks\nfrontpage-heading-testmode-district-tab = Desmos District Test Mode\nfrontpage-heading-testmode-feedback-tab = Feedback\nfrontpage-heading-testmode-ipads-and-iphones-tab = iPads and iPhones\nfrontpage-heading-testmode-practice-tab = Practice\nfrontpage-heading-title-about = About Us\nfrontpage-heading-title-art-contest = Art Contest Finalists\nfrontpage-heading-title-curriculum = Curriculum\nfrontpage-heading-title-equity = Equity Principles\nfrontpage-heading-title-frontpage = Let\'s learn together.\nfrontpage-heading-title-guiding-principles = Guiding Principles\nfrontpage-heading-title-partners = Partners\nfrontpage-heading-title-team = Team\nfrontpage-label-about-meet-the-team = Meet the Team\nfrontpage-label-art-contest-finalists-2020 = Finalists 2020\nfrontpage-label-art-contest-finalists-2021 = Finalists 2021\nfrontpage-label-art-contest-from-artist = From the artist:\nfrontpage-label-art-contest-from-judges = From the judges:\nfrontpage-label-art-contest-photo-vernon-1st = 1st Place\nfrontpage-label-art-contest-photo-vernon-2nd = 2nd Place\nfrontpage-label-art-contest-photo-vernon-3rd = 3rd Place\nfrontpage-label-art-contest-trailblazer = Trailblazer\nfrontpage-label-main-classcode-placeholder = Code\nfrontpage-link-art-contest-2020-winners = View the 2020 winners\nfrontpage-link-art-contest-2021-winners = View the 2021 winners\nfrontpage-link-art-contest-age-range-13-14 = Ages 13-14\nfrontpage-link-art-contest-age-range-15-16 = Ages 15-16\nfrontpage-link-art-contest-age-range-17-18 = Ages 17-18\nfrontpage-link-art-contest-age-range-19 = Ages 19+\nfrontpage-link-curriculum-schedule-call = Let\'s Chat\nfrontpage-link-curriculum-try-it = Try It for Free\nfrontpage-link-footer-classroom-activities = Classroom Activities\nfrontpage-link-footer-contact-twitter = Twitter\nfrontpage-link-footer-partnerships = Partnerships\nfrontpage-link-header-classroom = Classroom\nfrontpage-link-header-math-tools = Math Tools\nfrontpage-link-header-resources = Resources\nfrontpage-link-header-team-desmos = Team Desmos\nfrontpage-link-main-browse-activities = Browse Activities\nfrontpage-link-main-for-students = For Students\nfrontpage-link-main-for-teachers = For Teachers\nfrontpage-link-main-go-to-student-homepage = Go to Student Homepage\nfrontpage-link-main-teacher-sign-up = Teacher Sign-Up\nfrontpage-link-main-view-the-winners = See all of the finalists!\nfrontpage-link-read-equity-principles = Read our Equity Principles\nfrontpage-link-read-guiding-principles = Read our Guiding Principles\nfrontpage-link-shared-about-us = About Us\nfrontpage-link-shared-accessibility = Accessibility\nfrontpage-link-shared-account-settings = Account Settings\nfrontpage-link-shared-api-documentation = API Docs\nfrontpage-link-shared-assessments = Assessments\nfrontpage-link-shared-blog = Des-Blog\nfrontpage-link-shared-careers = Careers\nfrontpage-link-shared-contact-us = Contact Us\nfrontpage-link-shared-curriculum = Desmos Curriculum\nfrontpage-link-shared-equity-principles = Equity Principles\nfrontpage-link-shared-four-function-calculator = Four Function Calculator\nfrontpage-link-shared-geometry-tool = Geometry Tool\nfrontpage-link-shared-graphing-calculator = Graphing Calculator\nfrontpage-link-shared-guiding-principles = Guiding Principles\nfrontpage-link-shared-help-center = Help Center\nfrontpage-link-shared-log-in = Log In\nfrontpage-link-shared-log-out = Log Out\nfrontpage-link-shared-matrix-calculator = Matrix Calculator\nfrontpage-link-shared-scientific-calculator = Scientific Calculator\nfrontpage-link-shared-sign-up = Sign Up\nfrontpage-link-shared-store = Desmos Store\nfrontpage-link-shared-test-practice = Test Practice\nfrontpage-link-testmode-learn-more-screen-pinning-mode = Learn more about using Screen Pinning on your Android device.\nfrontpage-narration-art-contest-image-of-graph = Image of { $graphTitle }\nfrontpage-narration-art-contest-image-of-graph-by = Image of graph by { $name }\nfrontpage-narration-art-contest-photo-boaler = Photo of Jo Boaler\nfrontpage-narration-art-contest-photo-bousso = Photo of Diarra Bousso\nfrontpage-narration-art-contest-photo-sanderson = Photo of Grant Sanderson\nfrontpage-narration-art-contest-photo-vernon = Photo of Natalie Vernon\nfrontpage-narration-art-contest-photo-woo = Photo of Eddie Woo\nfrontpage-narration-main-partner-logo = { $name } logo\nfrontpage-narration-shared-desmos-logo = Desmos Logo\nfrontpage-narration-shared-image-of-graph = Image of { $graphTitle }\nfrontpage-narration-team-collapse-biography = Collapse Biography\nfrontpage-narration-team-picture-of-name = Picture of { $name }\nfrontpage-narration-testmode-im-done-timer-ios = The I\'m Done button and timer on the iOS closing screen\nfrontpage-narration-testmode-ipad-opening-screen = The Start Test button on the iPad opening screen\nfrontpage-narration-testmode-opening-screen = The opening screen of Test Mode\nfrontpage-text-about-build-a-world = Desmos wants to build a world where every student learns math and loves learning math, where a studentâs access to the power and beauty of math doesn\'t depend on their place of birth, race, ethnicity, gender, or any other aspect of their identity.\nfrontpage-text-about-classroom = Desmos Classroom is now part of Amplify Education! <1>Learn more</1>{"."}\nfrontpage-text-about-classroom-curriculum = In 2020, we turned those experiences into <1>a core middle school math program</1>, now Amplify Math + Desmos Classroom, combining a problem-based curriculum from Illustrative Mathematics, scalable support models from Amplify, and Desmos Classroom\'s intuitive technology and humanizing pedagogy.\nfrontpage-text-about-classroom-join-us = Come join us on our journey! <1>Preview our curriculum</1>, check out <2>our free activities</2>, or join our <3>Educators Community</3>{"."}\nfrontpage-text-about-classroom-pedagogy = Desmos Classroom invites, celebrates, and develops student brilliance through <1>free digital classroom activities</1>, thoughtfully designed by teachers for teachers. Those activities are guided by our <2>our pedagogical philosophy</2> and help students to explore concepts deeply, collaborate with their peers on problem-solving, and apply knowledge creatively as mathematicians.\nfrontpage-text-about-desmos-studio-pbc = Desmos Studio is a Public Benefit Corporation with a goal of helping everyone learn math, love math, and grow with math. We believe that everyone has an inner mathematician and that some people havenât been given the opportunity, encouragement, or tools to discover theirs. So we prioritize <1>equity</1> and <2>accessibility</2> at every level of our work.\nfrontpage-text-about-math-tools = Our free suite of math tools, including our Graphing Calculator, is used annually by over 75 million people around the world. Those tools help people represent their ideas mathematically, connect different representations dynamically, make conjectures, and then develop entirely new ideas. They also result in some <1>pretty spectacular art</1>{"."}\nfrontpage-text-about-partners = We partner with the world\'s most popular curricula and learning software, and with <1>the majority of U.S. state-level assessments and digital college entrance exams</1>{"."}\nfrontpage-text-about-studio-join-us = Come join us! <1>Play with the calculator</1>, or connect with us on <2>Twitter</2>, <3>YouTube</3>, or <4>Instagram</4>{"."}\nfrontpage-text-art-contest-enter = Learn more about Desmos\'s Global Art Contest 2021\nfrontpage-text-art-contest-finalist-title = â{ $graphTitle }â by { $name }\nfrontpage-text-art-contest-page-description-2020 = Desmos\'s first Global Math Art Contest in 2020 featured over 4,000 graphs from over 100 countries around the world. Here are the winners and finalists, chosen from countless examples of incredible effort, artistry, ingenuity, and creativity.\nfrontpage-text-art-contest-page-description-2021 = More than 10,000 students from around the world participated in the second annual Global Math Art Contest! Here are the winners and finalists, chosen from countless examples of incredible effort, artistry, ingenuity, and creativity.\nfrontpage-text-braille-examples-calculator-information = Use a Braille display? You can read and write equations in the <1>Four-Function</1> <2>(www.desmos.com/fourfunction)</2>, <3>Scientific</3> <4>(www.desmos.com/scientific)</4>, and <5>Graphing</5> <6>(www.desmos.com/calculator)</6> calculators as well as <7>classroom activities</7> <8>(teacher.desmos.com)</8> using the two most common mathematical Braille codes in North America: Nemeth and Unified English Braille (UEB).\nfrontpage-text-braille-examples-page-screen-reader-information = Your screen reader should be set for Computer Braille input and output to minimize the risk of translation errors. Check out <1>the help center accessibility page.</1> for more information about using Braille in the Desmos calculators.\nfrontpage-text-description-about = Desmos is a math ed tech company building calculators, digital classroom tools, math activities, and curriculum for classrooms around the world.\nfrontpage-text-description-art-contest = The Desmos Math Art Contest is open yearly to students ages 13â ââ 18 to showcase their graphing calculator skills, creativity, and love of math.\nfrontpage-text-description-equity = Our goal is to support the development of a more equitable math education system and tech industry. We use these principles as our guide.\nfrontpage-text-description-frontpage = Desmos offers best-in-class calculators, digital math activities, and curriculum to help every student love math and love learning math.\nfrontpage-text-description-guiding-principles = Desmos has five Guiding Principles. These principles help us make tough decisions. They provide accountability for the outcomes of those decisions. And they help other people make decisions about us, by representing our values to people and organizations who are deciding if weâd be good partners in their work.\nfrontpage-text-description-partners = Desmos runs on any modern device with no downloads or installs. Partner with us to embed the power of Desmos right into your website or app.\nfrontpage-text-description-team = Our team works across 7 time zones, 2 hemispheres, and 18 states with 1 goal: to help every student learn math and love learning math.\nfrontpage-text-equity-as-a-us-based-team = As a primarily U.S.-based team, our focus for applying these principles has typically centered on injustices within our country. However, as our team, community of users, and partnerships continue to expand internationally, we seek to learn how we can apply these principles to strive for equitable math education worldwide.\nfrontpage-text-equity-everyone-understands = Our workplace should be one where everyone understands how they contribute to the companyâs mission and feels valued in their contribution. If we donât intentionally foster diversity and inclusion internally, we remain a part of the broader systemic inequities driving the need for these principles. Equally important, having a diverse group of colleagues is essential to serving a diverse external community. To do this, we must critically examine and address bias in our own processes and interactions.\nfrontpage-text-equity-goal-more-equitable-math-education-system = Our goal is to support the development of a more equitable math education system and tech industry. We use these principles as guides towards achieving this goal.\nfrontpage-text-equity-gratitude = We also want to express our gratitude to the many folks who have influenced and pushed our thinking in this area, especially but certainly not limited to <1>Lauren Baucom</1>, <2>Christelle Rocha</2>, <3>Ayanna Perry</3>, and Rochelle Gutierrez.\nfrontpage-text-equity-how-can-we-measure-impact = How can we measure the impact of our work on communities we aim to serve?\nfrontpage-text-equity-how-can-we-uphold-values = How can we uphold our values when selecting partners and services?\nfrontpage-text-equity-how-might-we-attend-to-safety = How might we attend to the mental, emotional, and physical safety of our employees?\nfrontpage-text-equity-how-might-we-continue-to-prioritize-equity = How might we continue to prioritize a drive for equity as our company changes over time?\nfrontpage-text-equity-how-might-we-examine-biases = How might we examine and reduce our individual biases?\nfrontpage-text-equity-how-might-we-share-our-thinking = How might we share our current thinking and get feedback?\nfrontpage-text-equity-how-might-we-support-access = How might we support the ACCESS and ACHIEVEMENT of the communities we serve?\nfrontpage-text-equity-how-might-we-support-identity = How might we support the IDENTITY and POWER of the communities we serve?\nfrontpage-text-equity-how-might-we-sustain-ourselves = How might we sustain ourselves in our day-to-day work at Desmos?\nfrontpage-text-equity-how-might-work-disrupt-white-supremacy = How might our work disrupt white supremacy and the oppressive results of dominant culture?\nfrontpage-text-equity-how-will-it-help = How might this work help the communities we aim to serve? How might it harm these communities?\nfrontpage-text-equity-on-a-mission = We\'re on a mission to help every student learn math and love learning math. To achieve our mission, we must acknowledge past and present injustices in our communities and take intentional action to make change.\nfrontpage-text-equity-tag-or-email = We would love to hear ways these principles may be underdeveloped or ways in which these principles shifted your thinking. If you want to respond publicly, tag us <1>@desmos</1>{"."} If you want to respond privately, feel free to email <2>equity@desmos.com</2>{"."}\nfrontpage-text-equity-we-have-a-responsibility = We have a responsibility to continuously learn about how systemic inequity is embedded in education and to use this knowledge to drive our decision-making. As we learn and put our learning into practice, we share our work with the hope that others will listen, learn, and push us further.\nfrontpage-text-equity-we-recognize-creating-adopting = We recognize that creating and adopting a set of equity principles is just one foundational step that helps us orient the work that comes next. We are also aware that our team membersâ identities, experiences, and biases limit our ability to help every student or to see ways in which our systems and structures bias some groups over others.\nfrontpage-text-equity-what-voices-can-we-amplify = What underrepresented voices can we learn from and amplify?\nfrontpage-text-equity-which-communities-to-learn-from = Which communities do we need to learn from and serve?\nfrontpage-text-equity-who-serves-harms = Who might each internal process serve? Who might this process harm?\nfrontpage-text-equity-without-taking-intentional-steps = Without taking intentional steps, our work will not serve all groups well. Therefore, we must focus on identifying and attending to the needs of marginalized and excluded communities. This means learning from and with these teachers and students, and using their needs to shape our work and measure our success.\nfrontpage-text-footer-copyright-studio = Copyright { $copyrightSign } { $year } Desmos Studio, PBC\nfrontpage-text-guiding-building-for-real-classrooms = Building for real classrooms requires listening to teachers and striving to understand the operations of their classroomsâthe features that make whole-group or small-group discussions <1>successful</1>, for example, or the way unreliable technology can ruin a lesson. Building for real classrooms also requires us to understand the inequities in the way schools are resourced. Knowing that many students and teachers operate with limited devices and connectivity motivates our team to prioritize building performant, low-bandwidth systems.\nfrontpage-text-guiding-footnote-danny-martin = <1>1</1> <2>Danny Martin</2>, for example, entreats us to consider the brilliance of Black children as an axiom, a statement that is self-evidently true.\nfrontpage-text-guiding-honor-students-brilliance = Honor Students\' Brilliance\nfrontpage-text-guiding-once-students-realize = Once students realize we are encouraging their agency and creativity, we hope they will seek delight in every corner of our work. Therefore, we\'re constantly redesigning for delight and updating to respond to all the student creativity we didnât anticipate.\nfrontpage-text-guiding-principles-gratitude = All errors in this document are our own, but we are particularly grateful to Desmos Fellows <1>Lauren Baucom</1> and <2>Christelle Rocha</2> for their feedback on earlier drafts of these principles.\nfrontpage-text-guiding-principles-introduction = Desmos has five Guiding Principles. These principles help us make tough decisions, and provide accountability for the outcomes of those decisions. And they help other people make decisions about us by representing our values to the people and organizations who are deciding if weâd be good partners in their work.\nfrontpage-text-guiding-remove-barriers = We also try to remove barriers that might prevent certain students from showcasing their brilliance by focusing on equity in our business models and accessibility in our products.\nfrontpage-text-guiding-so-we-champion = So we champion teachers. We start by listening and learning from and with teachers and researchers. We ask how we can best support each stage of a teacherâs career. We also work to oppose any effort to devalue or deprofessionalize teaching.\nfrontpage-text-guiding-there-are-a-number = There are a number of reasons that a product might not âworkâ for a user. It could just break, as technology so often does. It could be confusing for a subset of users, perhaps those who are less confident using technology. It could be that someone uses it in a way that we didnât anticipate. Whatever the reason, even a product that works 99% of the time will interrupt the learning in 1 of 3 classrooms. As a result, we prioritize reliability and usability, even at the expense of development speed. We strive for backwards compatibility, and still open graphs made in the first week of our calculatorâs launch. We also aim to design software and lessons that work for a wide variety of inputs. We believe that itâs not our job to enforce rigid syntax, but rather to interpret, as well as we can, anything a user does.\nfrontpage-text-guiding-to-honor-students = To honor studentsâ brilliance, we must first create opportunities for students to express their brilliance. We design tools and lessons that invite creativity and welcome multiple approaches. We build features to help teachers showcase student thinking, for example with our <1>dashboard tools</1> that support the <2>5 Practices</2>{"."} We seek to provide meaningful <3>task-oriented</3> feedback on studentsâ thinking.\nfrontpage-text-guiding-to-support-real-students = To support real students and real teachers, we need to design for their real and disparate environments.\nfrontpage-text-guiding-we-are-not-uncritical = We are not uncritical or passive champions. We recognize that teachers can both help and harm. We instead consider ourselves partners, supporters, and advocates in the critical work of building joyful classrooms and honoring the brilliance of every student. Excellence in teaching takes years of training and practice, and supporting such excellence is one of our most powerful levers for achieving our goals.\nfrontpage-text-guiding-we-believe-that-students = We believe that students are creative, knowledgeable, and brilliant. We recognize that students in math classes are not always treated as such, and that students of certain genders, races, or backgrounds are disproportionately affected.\nfrontpage-text-guiding-we-cant-enact = We can\'t enact any of our principles without teachers. We believe that teachers areâand should remainâan integral part of the learning process, and we know that they wield enormous power in their studentsâ learning experiences.\nfrontpage-text-guiding-we-know-that-software = We know that software will inevitably break or students will do things we donât anticipate. We believe that reliability doesn\'t come from avoiding every possible way something can go wrong, but from reacting quickly, carefully, and <1>blamelessly</1> when it does.\nfrontpage-text-guiding-we-prioritize-delight = We prioritize delight in our products even at the cost of development time. We would rather release a delightful product or lesson tomorrow than an adequate one today. We aim for delight not just in the user experience but in the learning experience as well. For example, students experience joy in "<1>being the cause</1>," so we try to create tools and lessons that respond to their interesting thinking. We relish surprises from students and try to surprise them in turn by coming along as they go off trail.\nfrontpage-text-guiding-we-reject-the-idea = We reject the idea that these students are more or less capable and recognize that we must learn from and with marginalized and excluded communities<1>1</1> in order to counter these narratives.\nfrontpage-text-guiding-we-want-to-help = We want to help all students learn math, but we see little value in their learning math if they don\'t also find something to <1>love</1> about math as well.\nfrontpage-text-header-app-links = Download our apps in the <1>Google Play Store</1> and <2>iOS App Store</2>{"."}\nfrontpage-text-main-interactive-and-creative-activities = Interactive and creative activities for your math class.\nfrontpage-text-main-join-your-classmates = Join your classmates!\nfrontpage-text-main-on-a-mission = We\'re on a mission to help every student learn math and love learning math.\nfrontpage-text-main-partners-benefits = As a partner of Desmos, you benefit from our continual work to make Desmos more powerful, faster, and easier to use. We release a new version of the API annually in April as a free upgrade for all of our partners. <1>Read our Changelog</1>{"."}\nfrontpage-text-main-partners-information = Our tools power <1>assessments</1> and major curricula. <2>Learn more</2>\nfrontpage-text-partners-accessible-api = We believe in interactive math for every student, including students who are blind or visually impaired. Desmos\'s API is WCAG 2.1 compliant at the AA level. We support fully blind students by converting graphs to sound and connecting with screen readers. <1>Learn More</1>{"."}\nfrontpage-text-partners-desmos-runs-on-modern-browser = Desmos runs on any modern browser with no downloads or installs. We also run seamlessly on iPhones, iPads, Android phones, and Windows touch devices. Chromebook attached to a Smartboard? No problem! We\'ve seen just about every combination a classroom has to offer, and we make sure our software runs on any modern browser, in nearly any configuration.\nfrontpage-text-partners-desmos-used-by-millions = Desmos is used by millions of students and teachers in nearly every country in the world and has been translated into 30 languages.\nfrontpage-text-partners-uptime = One of our values is "Works every time." This extends to our API. With greater than 99.99% uptime over the last 3 years, we provide the reliability your app or website needs. We also offer self-hosting for partners who need it.\nfrontpage-text-team-about-us = Our team works across 7 time zones, 2 hemispheres, and 18 states with 1 goal: to help every student learn math and love learning math. Want to join us? <1>We\'re hiring!</1>\nfrontpage-text-testmod-administer-test = <1>To administer a Secure Test:</1><2><3>Have students pin the app.</3><4>Tell the students not unpin the app.</4><5>At the end of the test, confirm that the screen was pinned for the entire test by checking the in-app clock.</5></2>\nfrontpage-text-testmod-feedback = We work to continuously improve our Test Mode apps, and we welcome your feedback on how we can support the best possible experience for your students and colleagues. Please email us at <1>feedback@desmos.com</1> with any questions or comments!\nfrontpage-text-testmode-android = Our <1>Android app</1> (currently in Beta testing) allows for offline practice.\nfrontpage-text-testmode-app-self-lock-mode-colors = While in App Self-Lock mode, the top bar of the calculator will change color according to the calculator in use: green for graphing, purple for scientific, blue for four function. There will also be a badge next to the Desmos logo.\nfrontpage-text-testmode-chromebooks = Our Chrome app allows for offline practice. You can download the Chrome app by visiting <1>bit.ly/desmos-test-mode-chrome-app</1> on the device. The <2>Chrome browser</2> must be installed on the device to use the Chrome Test Mode app.\nfrontpage-text-testmode-district = Desmos District Test Mode is a paid version of Test Mode that complies with specific assessment-based feature requirements and offline requirements, and allows for centralized configuration of calculators at the school or district level. Administrators can choose assessment-specific calculators ahead of testing day. This specific calculator configuration is used within a schoolâs Mobile Device Management system. A common use case for Desmos District Test Mode is Desmos calculators presented to students on secure, school-managed devices alongside paper-based state summative exams, district assessments, simulations, or other school-based assessments (<1>example</1>).\nfrontpage-text-testmode-district-features = <1>Paid features include:</1><2><3>Calculator configuration: Administrators can centrally preselect the specific calculator (e.g., Desmos Graphing Calculator) and ensure use of the correct tools on Testing Day to offer an added layer of security and mitigate any risks that students accidentally select the wrong calculator.</3><4>Customization: Proctoring is made easier through various display options, such as banners, colors, or titles, to help with quick visual verification of the correct testing tools.</4><5>Ongoing technical support: The Desmos team will work with your schoolâs technical leads to set up Desmos District Test Mode well ahead of your testing day.</5></2><6>If you are interested in purchasing Desmos District Test Mode, please reach out to <7>assessments@desmos.com</7> for more information.</6>\nfrontpage-text-testmode-enable-guided-access = <1>To enable Guided Access:</1><2><3>Go to Settings > General > Accessibility > Guided Access.</3><4>Pick a passcode that needs to be entered.</4><5>Open up the Test Mode app.</5><6>Triple-click the Side or Home button.</6></2><7>This will lock the device to that app and won\'t allow the student to leave it without a code.</7>\nfrontpage-text-testmode-enable-screen-pinning = <1>To enter Screen Pinning:</1><2><3>Disable WiFi on your phone.</3><4>Enter Airplane Mode on your phone.</4><5>A "Start Test" button will appear. Click it.</5></2>\nfrontpage-text-testmode-exit-guided-access = <1>To exit Guided Access:</1><2><3>Triple-click the Side or Home button.</3><4>Enter the passcode that you chose.</4></2>\nfrontpage-text-testmode-four-function-calculator-app-self-lock-mode-caption = Four function calculator in App Self-Lock mode with a blue top bar.\nfrontpage-text-testmode-four-function-calculator-blue-top-bar = The secure four function calculator has a blue top bar.\nfrontpage-text-testmode-four-function-calculator-caption = Four function calculator in kiosk mode with a blue top bar.\nfrontpage-text-testmode-graphing-calculator-app-self-lock-mode-caption = Graphing calculator in App Self-Lock mode with a green top bar.\nfrontpage-text-testmode-graphing-calculator-kiosk-mode-caption = Graphing calculator in kiosk mode with a green top bar.\nfrontpage-text-testmode-guided-access = For additional security, you can lock the student into the app using <1>Guided Access</1>{"."}\nfrontpage-text-testmode-ipads-and-iphones = Our <1>iPad and iPhone app</1> allows for offline practice. The app also supports additional levels of security.\nfrontpage-text-testmode-kiosk-mode = Kiosk mode provides an extra level of security by preventing other apps from being used while the calculator is open. Students will be locked into the calculator configuration they choose before pressing "Start Test". Before you sign in, click âAppsâ on the bottom bar and then select Desmos Test Mode. To exit kiosk mode, turn the Chromebook off.\nfrontpage-text-testmode-kiosk-mode-colors = While in kiosk mode, the top bar of the calculator will change color according to the calculator in use: green for graphing, purple for scientific, blue for four function. There will also be a badge next to the Desmos logo.\nfrontpage-text-testmode-learn-district = In addition to the free Test Mode apps, we offer a paid version for districts, which includes configuration and customization features. <1>Learn more about Desmos District Test Mode</1>{"."}\nfrontpage-text-testmode-levels-of-security = This page describes the various levels of security available through our apps, along with instructions for installation and usage.\nfrontpage-text-testmode-low-stakes-assessments = Each app lets you administer low-stakes, proctored assessments with security features to help enforce your school\'s or classroom\'s policies. We also partner with Mobile Device Management (MDM) companies to provide an even more secure test-day experience.\nfrontpage-text-testmode-partners = Desmos partners with high-stakes test providers in <1>over 35 states and on several national and international exams</1> to provide access to our calculators on testing day.\nfrontpage-text-testmode-practice = Students can practice using the calculators on our <1>Practice Page</1>{"."} We also provide free apps for <2>Chromebooks,</2> <3>iPads, and iPhones</3> to support practice.\nfrontpage-text-testmode-practice-apps-match-test-day = Our practice apps match the configuration that students will encounter on test day. Students can practice for a specific assessment by selecting "Choose Assessment" on the opening screen.\nfrontpage-text-testmode-scientific-calculator-app-self-lock-mode-caption = Scientific calculator in App Self-Lock mode with a purple top bar.\nfrontpage-text-testmode-scientific-calculator-caption = Scientific calculator in kiosk mode with a purple top bar.\nfrontpage-text-testmode-scientific-calculator-purple-top-bar = The secure scientific calculator has a purple top bar.\nfrontpage-text-testmode-screen-pinning-mode = Screen Pinning mode provides an extra level of security by preventing other apps from being used while the calculator is open.\nfrontpage-text-testmode-secure-graphing-calculator-green-top-bar = The secure graphing calculator has a green top bar.\nfrontpage-text-testmode-students-can-leave-app-self-lock-mode = Please note that students can leave App Self-Lock by clicking "I\'m Done" before the end of the test. You can monitor appropriate usage by looking at the log at the conclusion of the test. It will show how long the student was continuously in the application.\nfrontpage-text-testmode-students-can-leave-chromebook-app = Please note that students can leave the app by powering down their Chromebook and restarting it. You can monitor appropriate usage by looking at the log at the conclusion of the test. It will show how long the student was continuously in the application.\nfrontpage-text-testmode-students-can-opt-into-app-self-lock = Students can opt into App Self-Lock by pressing the "Start Test" button. While in App Self-Lock, students will be locked into the calculator they selected before pressing "Start Test". They will not be able to switch calculators nor leave the app until they leave App Self-Lock.\nfrontpage-text-testmode-to-help-teachers-and-students-prepare = To help students and teachers prepare for assessments, and to support ongoing instruction and formative assessment needs, Desmos has developed a suite of Test Mode apps.\npractice-button-sc-info-pdf = { $stateName } PDF\npractice-button-state-info-pdf = { $stateName } Information PDF\npractice-heading-accessibility = Accessibility\npractice-heading-is-desmos-on-test = Is Desmos on your test?\npractice-heading-national-international-assessments = National and International Assessments\npractice-heading-practice = Practice\npractice-heading-privacy = Privacy\npractice-heading-questions-and-feedback = Additional Questions and Feedback\npractice-heading-state-assessments = State Assessments\npractice-heading-title-test-mode = Test Mode\npractice-heading-title-testing = Testing\npractice-label-desmos-on-test = Desmos is on the test!\npractice-label-desmos-on-test-apply-nysed = Apply to NYSED to use Desmos!\npractice-label-desmos-on-test-partial = Desmos can be used on the test\npractice-label-desmos-on-tests = Desmos is on the tests!\npractice-label-ib-middle-years = International BaccalaureateÂ® (IB) Middle Years Programme (MYP)\npractice-label-nwea-map-growth = NWEA MAPÂ® Growthâ¢\npractice-label-sample = Sample\npractice-label-sbac = Smarter Balanced\npractice-label-state-test = State Test:\npractice-label-state-tests = State Tests:\npractice-label-states-al-four-function-grades = Grades 6-8\npractice-label-states-al-scientific-grades = Grades 6-8\npractice-label-states-az-graphing-grades = High School\npractice-label-states-az-scientific-grades = Grades 7-8\npractice-label-states-ca-four-function-grades = Grade 5 (Science, CAST), Grade 6 (Mathematics)\npractice-label-states-ca-graphing-grades = Grade 11 (Mathematics)\npractice-label-states-ca-scientific-grades = Grades 7-8 (Mathematics), Grades 8-12 (Science, CAST)\npractice-label-states-ct-four-function-grades = Grade 6\npractice-label-states-ct-scientific-grades = Grades 7-8\npractice-label-states-de-four-function-grades = Grade 6\npractice-label-states-de-graphing-grades = High School\npractice-label-states-de-scientific-grades = Grades 7-8\npractice-label-states-fl-scientific-grades = Grades 7-8\npractice-label-states-ga-four-function-grades = Grade 6\npractice-label-states-ga-graphing-grades = High School\npractice-label-states-ga-scientific-grades = Grades 7-8 & High School\npractice-label-states-hi-four-function-grades = Grade 6\npractice-label-states-hi-graphing-grades = High School\npractice-label-states-hi-scientific-grades = Grades 7-8\npractice-label-states-ia-four-function-grades = Grades 3-6 (Mathematics), Grade 5 (Science)\npractice-label-states-ia-scientific-grades = Grades 7-11 (Mathematics), Grades 8 & 10 (Science)\npractice-label-states-id-four-function-grades = Grade 6\npractice-label-states-id-graphing-grades = High School\npractice-label-states-id-scientific-grades = Grades 7-8\npractice-label-states-in-four-function-grades = Grade 6 (ILEARN and IAM)\npractice-label-states-in-graphing-grades = High School (ISTEP+)\npractice-label-states-in-scientific-grades = Grades 7-8 (ILEARN)\npractice-label-states-ky-four-function-grades = High School (Mathematics)\npractice-label-states-ky-graphing-grades = High School (Mathematics and Science)\npractice-label-states-ky-scientific-grades = High School (Mathematics)\npractice-label-states-la-graphing-grades = High School\npractice-label-states-ma-graphing-grades = Grades 8 & 10 (Mathematics)\npractice-label-states-ma-scientific-grades = High School (Introductory Physics)\npractice-label-states-md-four-function-grades = Grade 5 (Science), Grades 3-7 (Mathematics)\npractice-label-states-md-graphing-grades = High School (Mathematics)\npractice-label-states-md-scientific-grades = Grade 8 (Mathematics), Grade 8 (Science)\npractice-label-states-mi-four-function-grades = Grade 6\npractice-label-states-mi-scientific-grades = Grade 7\npractice-label-states-mo-four-function-grades = Grade 5 & 8 (Science), Grades 6-8 (Mathematics)\npractice-label-states-mo-graphing-grades = Grades 6-8 (Mathematics), Algebra I, Algebra II, Geometry, Grade 8 (Science), Physical Science, and Biology\npractice-label-states-mo-scientific-grades = Grades 6-8 (Mathematics), Grade 8 (Science)\npractice-label-states-ms-graphing-grades = Algebra 1\npractice-label-states-mt-four-function-grades = Grade 6\npractice-label-states-mt-graphing-grades = High School\npractice-label-states-mt-scientific-grades = Grades 7-8\npractice-label-states-nc-four-function-grades = Grades 3-5\npractice-label-states-nc-graphing-grades = Grade 8, Math 1, and above\npractice-label-states-nc-scientific-grades = Grades 6-8\npractice-label-states-nd-four-function-grades = Grade 6\npractice-label-states-nd-graphing-grades = High School-Grade 11\npractice-label-states-nd-scientific-grades = Grades 7-8\npractice-label-states-ne-four-function-grades = Grade 6\npractice-label-states-ne-scientific-grades = Grades 7-8\npractice-label-states-nh-four-function-grades = Grade 6\npractice-label-states-nh-graphing-grades = High School\npractice-label-states-nh-scientific-grades = Grades 7-8\npractice-label-states-nv-four-function-grades = Grade 5 (Science), Grade 6 (Mathematics)\npractice-label-states-nv-scientific-grades = Grades 7-8 (Mathematics), Grade 8, High School (Science)\npractice-label-states-ny-graphing-grades = High School (Mathematics)\npractice-label-states-oh-graphing-grades = High School\npractice-label-states-oh-scientific-grades = Grades 3-8\npractice-label-states-or-four-function-grades = Grade 6 (Mathematics), Grade 5 (Science)\npractice-label-states-or-graphing-grades = Grades 8, 11 (Science), High School (Mathematics)\npractice-label-states-or-scientific-grades = Grades 7-8 (Mathematics)\npractice-label-states-ri-graphing-grades = Grade 8 (Mathematics), Grade 11 (Science)\npractice-label-states-sc-alt-four-function-grades = Grade 6, Alternate Assessments\npractice-label-states-sc-alt-scientific-grades = Grades 7, 8, 11, Alternate Assessments\npractice-label-states-sc-std-four-function-grades = Grades 6 (Math, Science)\npractice-label-states-sc-std-graphing-grades = Grades 7-8 (Math), Algebra 1, Biology\npractice-label-states-sc-std-scientific-grades = Grades 6 (Math, Science), 7-8 (Math), Algebra 1, Biology\npractice-label-states-sd-four-function-grades = Grade 6\npractice-label-states-sd-graphing-grades = High School\npractice-label-states-sd-scientific-grades = Grades 7-8\npractice-label-states-tx-four-function-grades = Grade 8 Science, Biology\npractice-label-states-tx-graphing-grades = Grade 8 Science, Biology, Grade 8 Math, Algebra 1, Algebra 2\npractice-label-states-tx-scientific-grades = Grade 8 Science, Biology\npractice-label-states-ut-graphing-grades = Grades 9-10 (Mathematics)\npractice-label-states-ut-scientific-grades = Grades 9-10 (Science)\npractice-label-states-va-four-function-grades = Grades 4-5\npractice-label-states-va-graphing-grades = High School\npractice-label-states-va-scientific-grades = Grades 6-8\npractice-label-states-vi-four-function-grades = Grade 6\npractice-label-states-vi-graphing-grades = Grades 10-11\npractice-label-states-vi-scientific-grades = Grades 7-8\npractice-label-states-vt-four-function-grades = Grade 6\npractice-label-states-vt-graphing-grades = High School\npractice-label-states-vt-scientific-grades = Grades 7-8\npractice-label-states-wa-four-function-grades = Grade 5 (Science), Grade 6 (Mathematics)\npractice-label-states-wa-graphing-grades = High School (Mathematics)\npractice-label-states-wa-scientific-grades = Grades 7-8 (Mathematics), Grade 8 & High School (Science)\npractice-label-states-wv-four-function-grades = Grade 6\npractice-label-states-wv-graphing-grades = High School\npractice-label-states-wv-scientific-grades = Grades 7-8\npractice-label-states-wy-four-function-grades = Grade 6\npractice-label-states-wy-graphing-grades = High School\npractice-label-states-wy-scientific-grades = Grades 7-8\npractice-link-four-function = Four Function Calculator\npractice-link-graphing = Graphing Calculator\npractice-link-scientific = Scientific Calculator\npractice-narration-close-details = Close Details About { $stateName }\npractice-text-accessibility-information = Desmos is committed to helping every student love learning math. We are proud to say that the Desmos calculators are <1>WCAG 2.1 AA compliant. </1>The accessibility improvements we\'ve made ensure students who are blind or visually impaired have the same opportunities as their peers to discover the joy of learning math. Please read more about this at <2>www.desmos.com/accessibility</2>{"."}\npractice-text-calculator-note = These calculators differ from the ones on our site. You can find more information in the PDF.\npractice-text-data-privacy = Additional rules apply for data privacy when dealing with children under 13. The <1>Four-Function</1> and <2>Scientific</2> calculators, which will be used by students under the age of 13, never request student data as there is no way to log in.\npractice-text-description-test-mode = Learn how to configure Test Mode to use Desmos calculators on assessments.\npractice-text-description-testing = Is Desmos on your test? Find out if the Desmos calculators are on your state assessments.\npractice-text-different-calculators-ib = Please note that these calculators differ from the ones on our site. You can find more information in <1>our overview PDF</1>{"."} Students can practice on the sample <2>Scientific Calculator</2>{"."}\npractice-text-different-calculators-nwea = Please note that these calculators differ from the ones on our site. You can find more information in <1>our overview PDF</1>{"."} Students can practice on the sample <2>Four Function</2> or <3>Scientific Calculator</3>{"."}\npractice-text-different-calculators-sbac = Desmos calculators are available on Smarter Balanced assessments. Please note that these calculators differ from the standard ones on our site. Students who reside in a Smarter Balanced member state or U.S. territory can practice with the calculators configured for specific test settings available below.\npractice-text-more-information = Interested in learning more about Desmos calculator found on your state or national assessment? Check out our <1>professional learning and development offerings</1>{"."}\npractice-text-national-international-assessments = Desmos is now available on national and international assessments! These assessments include:\npractice-text-practice-information = To help students and teachers prepare for assessments, and to support ongoing instruction and formative assessment needs, Desmos has developed a suite of Test Mode apps. Our practice apps match the configuration that students will encounter on test day. You can learn more at <1>www.desmos.com/test-mode</1>{"."}\npractice-text-privacy = During test administrations, Desmos will not receive any data about students. Vendors will host the Desmos technology directly on their servers and will not exchange any data with Desmos\'s servers. Furthermore, students do not need to sign in or provide any personal information about themselves to be able to practice with Desmos calculators before the test.\npractice-text-questions = We know this change may prompt additional questions from teachers, parents, and administrators. Please don\'t hesitate to email questions or feedback to <1>support@desmos.com</1>{"."}\npractice-text-state-assessments = Desmos is also available on a range of state assessments! Find your state below to learn more.\npractice-text-state-not-listed = If Desmos isn\'t on your state assessment yet, and you\'re interested in changing that, <1>please let us know!</1>\npractice-text-students-create-accounts = While practicing for the test, some 11th-grade students using <1>desmos.com/calculator</1> may choose to create accounts to be able to save work for a later time. We encourage everyone to review the <2>Desmos Privacy Policy</2>, which describes what information we collect from these users who are over the age of 13 and what we do with that information.\n'; });

!function () { var t, e, n, r, o, a, i, c, u, f, l, s, p, y, d, b, _, h, v, w, m, O, j, g, P = {}; !function (t) { var e = "object" == typeof P ? P : "object" == typeof self ? self : "object" == typeof this ? this : {}; function n(t, n) { return t !== e && ("function" == typeof Object.create ? Object.defineProperty(t, "__esModule", { value: !0 }) : t.__esModule = !0), function (e, r) { return t[e] = n ? n(e, r) : r } } "function" == typeof define && define.amd ? define("tslib", ["exports"], function (r) { t(n(e, n(r))) }) : "object" == typeof module && "object" == typeof module.exports ? t(n(e, n(module.exports))) : t(n(e)) }(function (P) { var S = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) { t.__proto__ = e } || function (t, e) { for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]) }; t = function (t, e) { if ("function" != typeof e && null !== e) throw new TypeError("Class extends value " + String(e) + " is not a constructor or null"); function n() { this.constructor = t } S(t, e), t.prototype = null === e ? Object.create(e) : (n.prototype = e.prototype, new n) }, e = Object.assign || function (t) { for (var e, n = 1, r = arguments.length; n < r; n++)for (var o in e = arguments[n]) Object.prototype.hasOwnProperty.call(e, o) && (t[o] = e[o]); return t }, n = function (t, e) { var n = {}; for (var r in t) Object.prototype.hasOwnProperty.call(t, r) && e.indexOf(r) < 0 && (n[r] = t[r]); if (null != t && "function" == typeof Object.getOwnPropertySymbols) { var o = 0; for (r = Object.getOwnPropertySymbols(t); o < r.length; o++)e.indexOf(r[o]) < 0 && Object.prototype.propertyIsEnumerable.call(t, r[o]) && (n[r[o]] = t[r[o]]) } return n }, r = function (t, e, n, r) { var o, a = arguments.length, i = a < 3 ? e : null === r ? r = Object.getOwnPropertyDescriptor(e, n) : r; if ("object" == typeof Reflect && "function" == typeof Reflect.decorate) i = Reflect.decorate(t, e, n, r); else for (var c = t.length - 1; c >= 0; c--)(o = t[c]) && (i = (a < 3 ? o(i) : a > 3 ? o(e, n, i) : o(e, n)) || i); return a > 3 && i && Object.defineProperty(e, n, i), i }, o = function (t, e) { return function (n, r) { e(n, r, t) } }, a = function (t, e) { if ("object" == typeof Reflect && "function" == typeof Reflect.metadata) return Reflect.metadata(t, e) }, i = function (t, e, n, r) { return new (n || (n = Promise))(function (o, a) { function i(t) { try { u(r.next(t)) } catch (t) { a(t) } } function c(t) { try { u(r.throw(t)) } catch (t) { a(t) } } function u(t) { var e; t.done ? o(t.value) : (e = t.value, e instanceof n ? e : new n(function (t) { t(e) })).then(i, c) } u((r = r.apply(t, e || [])).next()) }) }, c = function (t, e) { var n, r, o, a, i = { label: 0, sent: function () { if (1 & o[0]) throw o[1]; return o[1] }, trys: [], ops: [] }; return a = { next: c(0), throw: c(1), return: c(2) }, "function" == typeof Symbol && (a[Symbol.iterator] = function () { return this }), a; function c(a) { return function (c) { return function (a) { if (n) throw new TypeError("Generator is already executing."); for (; i;)try { if (n = 1, r && (o = 2 & a[0] ? r.return : a[0] ? r.throw || ((o = r.return) && o.call(r), 0) : r.next) && !(o = o.call(r, a[1])).done) return o; switch (r = 0, o && (a = [2 & a[0], o.value]), a[0]) { case 0: case 1: o = a; break; case 4: return i.label++, { value: a[1], done: !1 }; case 5: i.label++, r = a[1], a = [0]; continue; case 7: a = i.ops.pop(), i.trys.pop(); continue; default: if (!(o = i.trys, (o = o.length > 0 && o[o.length - 1]) || 6 !== a[0] && 2 !== a[0])) { i = 0; continue } if (3 === a[0] && (!o || a[1] > o[0] && a[1] < o[3])) { i.label = a[1]; break } if (6 === a[0] && i.label < o[1]) { i.label = o[1], o = a; break } if (o && i.label < o[2]) { i.label = o[2], i.ops.push(a); break } o[2] && i.ops.pop(), i.trys.pop(); continue }a = e.call(t, i) } catch (t) { a = [6, t], r = 0 } finally { n = o = 0 } if (5 & a[0]) throw a[1]; return { value: a[0] ? a[1] : void 0, done: !0 } }([a, c]) } } }, u = function (t, e) { for (var n in t) "default" === n || Object.prototype.hasOwnProperty.call(e, n) || g(e, t, n) }, g = Object.create ? function (t, e, n, r) { void 0 === r && (r = n), Object.defineProperty(t, r, { enumerable: !0, get: function () { return e[n] } }) } : function (t, e, n, r) { void 0 === r && (r = n), t[r] = e[n] }, f = function (t) { var e = "function" == typeof Symbol && Symbol.iterator, n = e && t[e], r = 0; if (n) return n.call(t); if (t && "number" == typeof t.length) return { next: function () { return t && r >= t.length && (t = void 0), { value: t && t[r++], done: !t } } }; throw new TypeError(e ? "Object is not iterable." : "Symbol.iterator is not defined.") }, l = function (t, e) { var n = "function" == typeof Symbol && t[Symbol.iterator]; if (!n) return t; var r, o, a = n.call(t), i = []; try { for (; (void 0 === e || e-- > 0) && !(r = a.next()).done;)i.push(r.value) } catch (t) { o = { error: t } } finally { try { r && !r.done && (n = a.return) && n.call(a) } finally { if (o) throw o.error } } return i }, s = function () { for (var t = [], e = 0; e < arguments.length; e++)t = t.concat(l(arguments[e])); return t }, p = function () { for (var t = 0, e = 0, n = arguments.length; e < n; e++)t += arguments[e].length; var r = Array(t), o = 0; for (e = 0; e < n; e++)for (var a = arguments[e], i = 0, c = a.length; i < c; i++, o++)r[o] = a[i]; return r }, y = function (t, e) { for (var n = 0, r = e.length, o = t.length; n < r; n++, o++)t[o] = e[n]; return t }, d = function (t) { return this instanceof d ? (this.v = t, this) : new d(t) }, b = function (t, e, n) { if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined."); var r, o = n.apply(t, e || []), a = []; return r = {}, i("next"), i("throw"), i("return"), r[Symbol.asyncIterator] = function () { return this }, r; function i(t) { o[t] && (r[t] = function (e) { return new Promise(function (n, r) { a.push([t, e, n, r]) > 1 || c(t, e) }) }) } function c(t, e) { try { (n = o[t](e)).value instanceof d ? Promise.resolve(n.value.v).then(u, f) : l(a[0][2], n) } catch (t) { l(a[0][3], t) } var n } function u(t) { c("next", t) } function f(t) { c("throw", t) } function l(t, e) { t(e), a.shift(), a.length && c(a[0][0], a[0][1]) } }, _ = function (t) { var e, n; return e = {}, r("next"), r("throw", function (t) { throw t }), r("return"), e[Symbol.iterator] = function () { return this }, e; function r(r, o) { e[r] = t[r] ? function (e) { return (n = !n) ? { value: d(t[r](e)), done: "return" === r } : o ? o(e) : e } : o } }, h = function (t) { if (!Symbol.asyncIterator) throw new TypeError("Symbol.asyncIterator is not defined."); var e, n = t[Symbol.asyncIterator]; return n ? n.call(t) : (t = f(t), e = {}, r("next"), r("throw"), r("return"), e[Symbol.asyncIterator] = function () { return this }, e); function r(n) { e[n] = t[n] && function (e) { return new Promise(function (r, o) { (function (t, e, n, r) { Promise.resolve(r).then(function (e) { t({ value: e, done: n }) }, e) })(r, o, (e = t[n](e)).done, e.value) }) } } }, v = function (t, e) { return Object.defineProperty ? Object.defineProperty(t, "raw", { value: e }) : t.raw = e, t }; var x = Object.create ? function (t, e) { Object.defineProperty(t, "default", { enumerable: !0, value: e }) } : function (t, e) { t.default = e }; w = function (t) { if (t && t.__esModule) return t; var e = {}; if (null != t) for (var n in t) "default" !== n && Object.prototype.hasOwnProperty.call(t, n) && g(e, t, n); return x(e, t), e }, m = function (t) { return t && t.__esModule ? t : { default: t } }, O = function (t, e) { if (!e.has(t)) throw new TypeError("attempted to get private field on non-instance"); return e.get(t) }, j = function (t, e, n) { if (!e.has(t)) throw new TypeError("attempted to set private field on non-instance"); return e.set(t, n), n }, P("__extends", t), P("__assign", e), P("__rest", n), P("__decorate", r), P("__param", o), P("__metadata", a), P("__awaiter", i), P("__generator", c), P("__exportStar", u), P("__createBinding", g), P("__values", f), P("__read", l), P("__spread", s), P("__spreadArrays", p), P("__spreadArray", y), P("__await", d), P("__asyncGenerator", b), P("__asyncDelegator", _), P("__asyncValues", h), P("__makeTemplateObject", v), P("__importStar", w), P("__importDefault", m), P("__classPrivateFieldGet", O), P("__classPrivateFieldSet", j) }) }();
define('lib/i18n-homepage-langs', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.isHomepageLanguage = e.homepage_languages = void 0, e.homepage_languages = { ar: !0, de: !0, en: !0, es: !0, et: !0, fr: !0, id: !0, it: !0, ja: !0, ko: !0, nl: !0, pl: !0, "pt-BR": !0, ru: !0, "sv-SE": !0, th: !0, tr: !0, vi: !0, "zh-CN": !0, "zh-TW": !0 }, e.isHomepageLanguage = function (a) { return !!e.homepage_languages[a] } });
define('@fluent/bundle', ["exports"], function (r) { "use strict"; var e = "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {}; function n(r) { return r && r.__esModule && Object.prototype.hasOwnProperty.call(r, "default") ? r.default : r } function t(r) { if (r.__esModule) return r; var e = Object.defineProperty({}, "__esModule", { value: !0 }); return Object.keys(r).forEach(function (n) { var t = Object.getOwnPropertyDescriptor(r, n); Object.defineProperty(e, n, t.get ? t : { enumerable: !0, get: function () { return r[n] } }) }), e } function o(r) { return (o = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (r) { return typeof r } : function (r) { return r && "function" == typeof Symbol && r.constructor === Symbol && r !== Symbol.prototype ? "symbol" : typeof r })(r) } function i(r, e) { if (!(r instanceof e)) throw new TypeError("Cannot call a class as a function") } function a(r, e) { for (var n = 0; n < e.length; n++) { var t = e[n]; t.enumerable = t.enumerable || !1, t.configurable = !0, "value" in t && (t.writable = !0), Object.defineProperty(r, t.key, t) } } function u(r, e, n) { return e && a(r.prototype, e), n && a(r, n), r } var s = function (r) { if (!r) return []; Array.isArray(r) || (r = [r]); for (var e = {}, n = 0; n < r.length; ++n) { var t = r[n]; if (t && "object" === o(t) && (t = String(t)), "string" != typeof t) { var i = "Locales should be strings, ".concat(JSON.stringify(t), " isn't."); throw new TypeError(i) } if ("*" !== t[0]) { if (!t.split("-").every(function (r) { return /[a-z0-9]+/i.test(r) })) { var a = JSON.stringify(t), u = "The locale ".concat(a, " is not a structurally valid BCP 47 language tag."); throw new RangeError(u) } e[t] = !0 } } return Object.keys(e) }, l = function (r) { if (!r) return "cardinal"; if ("cardinal" === r || "ordinal" === r) return r; throw new RangeError("Not a valid plural type: " + JSON.stringify(r)) }; var c = Object.freeze({ __proto__: null, default: function (r, e, n) { var t = function (r) { do { if (e(r)) return r; r = r.replace(/-?[^-]*$/, "") } while (r); return null }, o = function (r) { for (var e = s(r), n = 0; n < e.length; ++n) { var o = t(e[n]); if (o) return o } return t("undefined" != typeof navigator && navigator && (navigator.userLanguage || navigator.language) || "en-US") }, a = function () { function a(n) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}; i(this, a), this._locale = o(n), this._select = e(this._locale), this._type = l(t.type), this._nf = new r("en", t) } return u(a, null, [{ key: "supportedLocalesOf", value: function (r) { return s(r).filter(t) } }]), u(a, [{ key: "resolvedOptions", value: function () { var r = this._nf.resolvedOptions(), e = r.minimumIntegerDigits, t = r.minimumFractionDigits, o = r.maximumFractionDigits, i = r.minimumSignificantDigits, a = r.maximumSignificantDigits, u = { locale: this._locale, minimumIntegerDigits: e, minimumFractionDigits: t, maximumFractionDigits: o, pluralCategories: n(this._locale, "ordinal" === this._type), type: this._type }; return "number" == typeof i && (u.minimumSignificantDigits = i, u.maximumSignificantDigits = a), u } }, { key: "select", value: function (r) { if (!(this instanceof a)) throw new TypeError("select() called on incompatible ".concat(this)); if ("number" != typeof r && (r = Number(r)), !isFinite(r)) return "other"; var e = this._nf.format(Math.abs(r)); return this._select(e, "ordinal" === this._type) } }]), a }(); return Object.defineProperty(a, "prototype", { writable: !1 }), a } }); function f(r, e) { for (var n = 0; n < e.length; n++) { var t = e[n]; t.enumerable = t.enumerable || !1, t.configurable = !0, "value" in t && (t.writable = !0), Object.defineProperty(r, t.key, t) } } var h, m, p = function () { function r(e, n) { var t = n.minimumIntegerDigits, o = n.minimumFractionDigits, i = n.maximumFractionDigits, a = n.minimumSignificantDigits, u = n.maximumSignificantDigits; !function (r, e) { if (!(r instanceof e)) throw new TypeError("Cannot call a class as a function") }(this, r), this._minID = "number" == typeof t ? t : 1, this._minFD = "number" == typeof o ? o : 0, this._maxFD = "number" == typeof i ? i : Math.max(this._minFD, 3), "number" != typeof a && "number" != typeof u || (this._minSD = "number" == typeof a ? a : 1, this._maxSD = "number" == typeof u ? u : 21) } var e, n, t; return e = r, (n = [{ key: "resolvedOptions", value: function () { var r = { minimumIntegerDigits: this._minID, minimumFractionDigits: this._minFD, maximumFractionDigits: this._maxFD }; return "number" == typeof this._minSD && (r.minimumSignificantDigits = this._minSD, r.maximumSignificantDigits = this._maxSD), r } }, { key: "format", value: function (r) { if (this._minSD) { for (var e = String(r), n = 0, t = 0; t < e.length; ++t) { var o = e[t]; o >= "0" && o <= "9" && ++n } return n < this._minSD ? r.toPrecision(this._minSD) : n > this._maxSD ? r.toPrecision(this._maxSD) : e } return this._minFD > 0 ? r.toFixed(this._minFD) : 0 === this._maxFD ? r.toFixed(0) : String(r) } }]) && f(e.prototype, n), t && f(e, t), r }(), d = t(c), y = n((function (r) { function n(r) { return r && "object" == typeof r && "default" in r ? r : { default: r } } var t = n(d), o = n(p); function i(r) { return (i = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (r) { return typeof r } : function (r) { return r && "function" == typeof Symbol && r.constructor === Symbol && r !== Symbol.prototype ? "symbol" : typeof r })(r) } function a(r) { return r && r.__esModule && Object.prototype.hasOwnProperty.call(r, "default") ? r.default : r } function u(r, e, n) { return r(n = { path: e, exports: {}, require: function (r, e) { return function () { throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs") }(null == e && n.path) } }, n.exports), n.exports } "undefined" != typeof globalThis ? globalThis : "undefined" != typeof window ? window : void 0 !== e || "undefined" != typeof self && self; var s = u(function (r, e) { function n(r, e) { return e ? "other" : 1 == r ? "one" : "other" } function t(r, e) { return e ? "other" : 0 == r || 1 == r ? "one" : "other" } function o(r, e) { var n = !String(r).split(".")[1]; return e ? "other" : 1 == r && n ? "one" : "other" } function i(r, e) { return "other" } function a(r, e) { return e ? "other" : 1 == r ? "one" : 2 == r ? "two" : "other" } !function (e, n) { Object.defineProperty(n, "__esModule", { value: !0 }), r.exports = n }(0, { _in: i, af: n, ak: t, am: function (r, e) { return e ? "other" : r >= 0 && r <= 1 ? "one" : "other" }, an: n, ar: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r && n[0].slice(-2); return e ? "other" : 0 == r ? "zero" : 1 == r ? "one" : 2 == r ? "two" : t >= 3 && t <= 10 ? "few" : t >= 11 && t <= 99 ? "many" : "other" }, ars: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r && n[0].slice(-2); return e ? "other" : 0 == r ? "zero" : 1 == r ? "one" : 2 == r ? "two" : t >= 3 && t <= 10 ? "few" : t >= 11 && t <= 99 ? "many" : "other" }, as: function (r, e) { return e ? 1 == r || 5 == r || 7 == r || 8 == r || 9 == r || 10 == r ? "one" : 2 == r || 3 == r ? "two" : 4 == r ? "few" : 6 == r ? "many" : "other" : r >= 0 && r <= 1 ? "one" : "other" }, asa: n, ast: o, az: function (r, e) { var n = String(r).split(".")[0], t = n.slice(-1), o = n.slice(-2), i = n.slice(-3); return e ? 1 == t || 2 == t || 5 == t || 7 == t || 8 == t || 20 == o || 50 == o || 70 == o || 80 == o ? "one" : 3 == t || 4 == t || 100 == i || 200 == i || 300 == i || 400 == i || 500 == i || 600 == i || 700 == i || 800 == i || 900 == i ? "few" : 0 == n || 6 == t || 40 == o || 60 == o || 90 == o ? "many" : "other" : 1 == r ? "one" : "other" }, be: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r, o = t && n[0].slice(-1), i = t && n[0].slice(-2); return e ? 2 != o && 3 != o || 12 == i || 13 == i ? "other" : "few" : 1 == o && 11 != i ? "one" : o >= 2 && o <= 4 && (i < 12 || i > 14) ? "few" : t && 0 == o || o >= 5 && o <= 9 || i >= 11 && i <= 14 ? "many" : "other" }, bem: n, bez: n, bg: n, bho: t, bm: i, bn: function (r, e) { return e ? 1 == r || 5 == r || 7 == r || 8 == r || 9 == r || 10 == r ? "one" : 2 == r || 3 == r ? "two" : 4 == r ? "few" : 6 == r ? "many" : "other" : r >= 0 && r <= 1 ? "one" : "other" }, bo: i, br: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r, o = t && n[0].slice(-1), i = t && n[0].slice(-2), a = t && n[0].slice(-6); return e ? "other" : 1 == o && 11 != i && 71 != i && 91 != i ? "one" : 2 == o && 12 != i && 72 != i && 92 != i ? "two" : (3 == o || 4 == o || 9 == o) && (i < 10 || i > 19) && (i < 70 || i > 79) && (i < 90 || i > 99) ? "few" : 0 != r && t && 0 == a ? "many" : "other" }, brx: n, bs: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = t.slice(-2), s = o.slice(-1), l = o.slice(-2); return e ? "other" : i && 1 == a && 11 != u || 1 == s && 11 != l ? "one" : i && a >= 2 && a <= 4 && (u < 12 || u > 14) || s >= 2 && s <= 4 && (l < 12 || l > 14) ? "few" : "other" }, ca: function (r, e) { var n = !String(r).split(".")[1]; return e ? 1 == r || 3 == r ? "one" : 2 == r ? "two" : 4 == r ? "few" : "other" : 1 == r && n ? "one" : "other" }, ce: n, ceb: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = o.slice(-1); return e ? "other" : i && (1 == t || 2 == t || 3 == t) || i && 4 != a && 6 != a && 9 != a || !i && 4 != u && 6 != u && 9 != u ? "one" : "other" }, cgg: n, chr: n, ckb: n, cs: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1]; return e ? "other" : 1 == r && o ? "one" : t >= 2 && t <= 4 && o ? "few" : o ? "other" : "many" }, cy: function (r, e) { return e ? 0 == r || 7 == r || 8 == r || 9 == r ? "zero" : 1 == r ? "one" : 2 == r ? "two" : 3 == r || 4 == r ? "few" : 5 == r || 6 == r ? "many" : "other" : 0 == r ? "zero" : 1 == r ? "one" : 2 == r ? "two" : 3 == r ? "few" : 6 == r ? "many" : "other" }, da: function (r, e) { var n = String(r).split("."), t = n[0], o = Number(n[0]) == r; return e || 1 != r && (o || 0 != t && 1 != t) ? "other" : "one" }, de: o, dsb: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-2), u = o.slice(-2); return e ? "other" : i && 1 == a || 1 == u ? "one" : i && 2 == a || 2 == u ? "two" : i && (3 == a || 4 == a) || 3 == u || 4 == u ? "few" : "other" }, dv: n, dz: i, ee: n, el: n, en: function (r, e) { var n = String(r).split("."), t = !n[1], o = Number(n[0]) == r, i = o && n[0].slice(-1), a = o && n[0].slice(-2); return e ? 1 == i && 11 != a ? "one" : 2 == i && 12 != a ? "two" : 3 == i && 13 != a ? "few" : "other" : 1 == r && t ? "one" : "other" }, eo: n, es: n, et: o, eu: n, fa: function (r, e) { return e ? "other" : r >= 0 && r <= 1 ? "one" : "other" }, ff: function (r, e) { return e ? "other" : r >= 0 && r < 2 ? "one" : "other" }, fi: o, fil: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = o.slice(-1); return e ? 1 == r ? "one" : "other" : i && (1 == t || 2 == t || 3 == t) || i && 4 != a && 6 != a && 9 != a || !i && 4 != u && 6 != u && 9 != u ? "one" : "other" }, fo: n, fr: function (r, e) { return e ? 1 == r ? "one" : "other" : r >= 0 && r < 2 ? "one" : "other" }, fur: n, fy: o, ga: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r; return e ? 1 == r ? "one" : "other" : 1 == r ? "one" : 2 == r ? "two" : t && r >= 3 && r <= 6 ? "few" : t && r >= 7 && r <= 10 ? "many" : "other" }, gd: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r; return e ? 1 == r || 11 == r ? "one" : 2 == r || 12 == r ? "two" : 3 == r || 13 == r ? "few" : "other" : 1 == r || 11 == r ? "one" : 2 == r || 12 == r ? "two" : t && r >= 3 && r <= 10 || t && r >= 13 && r <= 19 ? "few" : "other" }, gl: o, gsw: n, gu: function (r, e) { return e ? 1 == r ? "one" : 2 == r || 3 == r ? "two" : 4 == r ? "few" : 6 == r ? "many" : "other" : r >= 0 && r <= 1 ? "one" : "other" }, guw: t, gv: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = t.slice(-1), a = t.slice(-2); return e ? "other" : o && 1 == i ? "one" : o && 2 == i ? "two" : !o || 0 != a && 20 != a && 40 != a && 60 != a && 80 != a ? o ? "other" : "many" : "few" }, ha: n, haw: n, he: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = Number(n[0]) == r, a = i && n[0].slice(-1); return e ? "other" : 1 == r && o ? "one" : 2 == t && o ? "two" : o && (r < 0 || r > 10) && i && 0 == a ? "many" : "other" }, hi: function (r, e) { return e ? 1 == r ? "one" : 2 == r || 3 == r ? "two" : 4 == r ? "few" : 6 == r ? "many" : "other" : r >= 0 && r <= 1 ? "one" : "other" }, hr: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = t.slice(-2), s = o.slice(-1), l = o.slice(-2); return e ? "other" : i && 1 == a && 11 != u || 1 == s && 11 != l ? "one" : i && a >= 2 && a <= 4 && (u < 12 || u > 14) || s >= 2 && s <= 4 && (l < 12 || l > 14) ? "few" : "other" }, hsb: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-2), u = o.slice(-2); return e ? "other" : i && 1 == a || 1 == u ? "one" : i && 2 == a || 2 == u ? "two" : i && (3 == a || 4 == a) || 3 == u || 4 == u ? "few" : "other" }, hu: function (r, e) { return e ? 1 == r || 5 == r ? "one" : "other" : 1 == r ? "one" : "other" }, hy: function (r, e) { return e ? 1 == r ? "one" : "other" : r >= 0 && r < 2 ? "one" : "other" }, ia: o, id: i, ig: i, ii: i, io: o, is: function (r, e) { var n = String(r).split("."), t = n[0], o = Number(n[0]) == r, i = t.slice(-1), a = t.slice(-2); return e ? "other" : o && 1 == i && 11 != a || !o ? "one" : "other" }, it: function (r, e) { var n = !String(r).split(".")[1]; return e ? 11 == r || 8 == r || 80 == r || 800 == r ? "many" : "other" : 1 == r && n ? "one" : "other" }, iu: a, iw: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = Number(n[0]) == r, a = i && n[0].slice(-1); return e ? "other" : 1 == r && o ? "one" : 2 == t && o ? "two" : o && (r < 0 || r > 10) && i && 0 == a ? "many" : "other" }, ja: i, jbo: i, jgo: n, ji: o, jmc: n, jv: i, jw: i, ka: function (r, e) { var n = String(r).split(".")[0], t = n.slice(-2); return e ? 1 == n ? "one" : 0 == n || t >= 2 && t <= 20 || 40 == t || 60 == t || 80 == t ? "many" : "other" : 1 == r ? "one" : "other" }, kab: function (r, e) { return e ? "other" : r >= 0 && r < 2 ? "one" : "other" }, kaj: n, kcg: n, kde: i, kea: i, kk: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r, o = t && n[0].slice(-1); return e ? 6 == o || 9 == o || t && 0 == o && 0 != r ? "many" : "other" : 1 == r ? "one" : "other" }, kkj: n, kl: n, km: i, kn: function (r, e) { return e ? "other" : r >= 0 && r <= 1 ? "one" : "other" }, ko: i, ks: n, ksb: n, ksh: function (r, e) { return e ? "other" : 0 == r ? "zero" : 1 == r ? "one" : "other" }, ku: n, kw: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r, o = t && n[0].slice(-2), i = t && n[0].slice(-3), a = t && n[0].slice(-5), u = t && n[0].slice(-6); return e ? t && r >= 1 && r <= 4 || o >= 1 && o <= 4 || o >= 21 && o <= 24 || o >= 41 && o <= 44 || o >= 61 && o <= 64 || o >= 81 && o <= 84 ? "one" : 5 == r || 5 == o ? "many" : "other" : 0 == r ? "zero" : 1 == r ? "one" : 2 == o || 22 == o || 42 == o || 62 == o || 82 == o || t && 0 == i && (a >= 1e3 && a <= 2e4 || 4e4 == a || 6e4 == a || 8e4 == a) || 0 != r && 1e5 == u ? "two" : 3 == o || 23 == o || 43 == o || 63 == o || 83 == o ? "few" : 1 == r || 1 != o && 21 != o && 41 != o && 61 != o && 81 != o ? "other" : "many" }, ky: n, lag: function (r, e) { var n = String(r).split(".")[0]; return e ? "other" : 0 == r ? "zero" : 0 != n && 1 != n || 0 == r ? "other" : "one" }, lb: n, lg: n, lkt: i, ln: t, lo: function (r, e) { return e && 1 == r ? "one" : "other" }, lt: function (r, e) { var n = String(r).split("."), t = n[1] || "", o = Number(n[0]) == r, i = o && n[0].slice(-1), a = o && n[0].slice(-2); return e ? "other" : 1 == i && (a < 11 || a > 19) ? "one" : i >= 2 && i <= 9 && (a < 11 || a > 19) ? "few" : 0 != t ? "many" : "other" }, lv: function (r, e) { var n = String(r).split("."), t = n[1] || "", o = t.length, i = Number(n[0]) == r, a = i && n[0].slice(-1), u = i && n[0].slice(-2), s = t.slice(-2), l = t.slice(-1); return e ? "other" : i && 0 == a || u >= 11 && u <= 19 || 2 == o && s >= 11 && s <= 19 ? "zero" : 1 == a && 11 != u || 2 == o && 1 == l && 11 != s || 2 != o && 1 == l ? "one" : "other" }, mas: n, mg: t, mgo: n, mk: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = t.slice(-2), s = o.slice(-1), l = o.slice(-2); return e ? 1 == a && 11 != u ? "one" : 2 == a && 12 != u ? "two" : 7 != a && 8 != a || 17 == u || 18 == u ? "other" : "many" : i && 1 == a && 11 != u || 1 == s && 11 != l ? "one" : "other" }, ml: n, mn: n, mo: function (r, e) { var n = String(r).split("."), t = !n[1], o = Number(n[0]) == r && n[0].slice(-2); return e ? 1 == r ? "one" : "other" : 1 == r && t ? "one" : !t || 0 == r || o >= 2 && o <= 19 ? "few" : "other" }, mr: function (r, e) { return e ? 1 == r ? "one" : 2 == r || 3 == r ? "two" : 4 == r ? "few" : "other" : 1 == r ? "one" : "other" }, ms: function (r, e) { return e && 1 == r ? "one" : "other" }, mt: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r && n[0].slice(-2); return e ? "other" : 1 == r ? "one" : 0 == r || t >= 2 && t <= 10 ? "few" : t >= 11 && t <= 19 ? "many" : "other" }, my: i, nah: n, naq: a, nb: n, nd: n, ne: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r; return e ? t && r >= 1 && r <= 4 ? "one" : "other" : 1 == r ? "one" : "other" }, nl: o, nn: n, nnh: n, no: n, nqo: i, nr: n, nso: t, ny: n, nyn: n, om: n, or: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r; return e ? 1 == r || 5 == r || t && r >= 7 && r <= 9 ? "one" : 2 == r || 3 == r ? "two" : 4 == r ? "few" : 6 == r ? "many" : "other" : 1 == r ? "one" : "other" }, os: n, osa: i, pa: t, pap: n, pl: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = t.slice(-1), a = t.slice(-2); return e ? "other" : 1 == r && o ? "one" : o && i >= 2 && i <= 4 && (a < 12 || a > 14) ? "few" : o && 1 != t && (0 == i || 1 == i) || o && i >= 5 && i <= 9 || o && a >= 12 && a <= 14 ? "many" : "other" }, prg: function (r, e) { var n = String(r).split("."), t = n[1] || "", o = t.length, i = Number(n[0]) == r, a = i && n[0].slice(-1), u = i && n[0].slice(-2), s = t.slice(-2), l = t.slice(-1); return e ? "other" : i && 0 == a || u >= 11 && u <= 19 || 2 == o && s >= 11 && s <= 19 ? "zero" : 1 == a && 11 != u || 2 == o && 1 == l && 11 != s || 2 != o && 1 == l ? "one" : "other" }, ps: n, pt: function (r, e) { var n = String(r).split(".")[0]; return e ? "other" : 0 == n || 1 == n ? "one" : "other" }, pt_PT: o, rm: n, ro: function (r, e) { var n = String(r).split("."), t = !n[1], o = Number(n[0]) == r && n[0].slice(-2); return e ? 1 == r ? "one" : "other" : 1 == r && t ? "one" : !t || 0 == r || o >= 2 && o <= 19 ? "few" : "other" }, rof: n, root: i, ru: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = t.slice(-1), a = t.slice(-2); return e ? "other" : o && 1 == i && 11 != a ? "one" : o && i >= 2 && i <= 4 && (a < 12 || a > 14) ? "few" : o && 0 == i || o && i >= 5 && i <= 9 || o && a >= 11 && a <= 14 ? "many" : "other" }, rwk: n, sah: i, saq: n, sc: function (r, e) { var n = !String(r).split(".")[1]; return e ? 11 == r || 8 == r || 80 == r || 800 == r ? "many" : "other" : 1 == r && n ? "one" : "other" }, scn: function (r, e) { var n = !String(r).split(".")[1]; return e ? 11 == r || 8 == r || 80 == r || 800 == r ? "many" : "other" : 1 == r && n ? "one" : "other" }, sd: n, sdh: n, se: a, seh: n, ses: i, sg: i, sh: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = t.slice(-2), s = o.slice(-1), l = o.slice(-2); return e ? "other" : i && 1 == a && 11 != u || 1 == s && 11 != l ? "one" : i && a >= 2 && a <= 4 && (u < 12 || u > 14) || s >= 2 && s <= 4 && (l < 12 || l > 14) ? "few" : "other" }, shi: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r; return e ? "other" : r >= 0 && r <= 1 ? "one" : t && r >= 2 && r <= 10 ? "few" : "other" }, si: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || ""; return e ? "other" : 0 == r || 1 == r || 0 == t && 1 == o ? "one" : "other" }, sk: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1]; return e ? "other" : 1 == r && o ? "one" : t >= 2 && t <= 4 && o ? "few" : o ? "other" : "many" }, sl: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = t.slice(-2); return e ? "other" : o && 1 == i ? "one" : o && 2 == i ? "two" : o && (3 == i || 4 == i) || !o ? "few" : "other" }, sma: a, smi: a, smj: a, smn: a, sms: a, sn: n, so: n, sq: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r, o = t && n[0].slice(-1), i = t && n[0].slice(-2); return e ? 1 == r ? "one" : 4 == o && 14 != i ? "many" : "other" : 1 == r ? "one" : "other" }, sr: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = t.slice(-2), s = o.slice(-1), l = o.slice(-2); return e ? "other" : i && 1 == a && 11 != u || 1 == s && 11 != l ? "one" : i && a >= 2 && a <= 4 && (u < 12 || u > 14) || s >= 2 && s <= 4 && (l < 12 || l > 14) ? "few" : "other" }, ss: n, ssy: n, st: n, su: i, sv: function (r, e) { var n = String(r).split("."), t = !n[1], o = Number(n[0]) == r, i = o && n[0].slice(-1), a = o && n[0].slice(-2); return e ? 1 != i && 2 != i || 11 == a || 12 == a ? "other" : "one" : 1 == r && t ? "one" : "other" }, sw: o, syr: n, ta: n, te: n, teo: n, th: i, ti: t, tig: n, tk: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r && n[0].slice(-1); return e ? 6 == t || 9 == t || 10 == r ? "few" : "other" : 1 == r ? "one" : "other" }, tl: function (r, e) { var n = String(r).split("."), t = n[0], o = n[1] || "", i = !n[1], a = t.slice(-1), u = o.slice(-1); return e ? 1 == r ? "one" : "other" : i && (1 == t || 2 == t || 3 == t) || i && 4 != a && 6 != a && 9 != a || !i && 4 != u && 6 != u && 9 != u ? "one" : "other" }, tn: n, to: i, tr: n, ts: n, tzm: function (r, e) { var n = String(r).split("."), t = Number(n[0]) == r; return e ? "other" : 0 == r || 1 == r || t && r >= 11 && r <= 99 ? "one" : "other" }, ug: n, uk: function (r, e) { var n = String(r).split("."), t = n[0], o = !n[1], i = Number(n[0]) == r, a = i && n[0].slice(-1), u = i && n[0].slice(-2), s = t.slice(-1), l = t.slice(-2); return e ? 3 == a && 13 != u ? "few" : "other" : o && 1 == s && 11 != l ? "one" : o && s >= 2 && s <= 4 && (l < 12 || l > 14) ? "few" : o && 0 == s || o && s >= 5 && s <= 9 || o && l >= 11 && l <= 14 ? "many" : "other" }, ur: o, uz: n, ve: n, vi: function (r, e) { return e && 1 == r ? "one" : "other" }, vo: n, vun: n, wa: t, wae: n, wo: i, xh: n, xog: n, yi: o, yo: i, yue: i, zh: i, zu: function (r, e) { return e ? "other" : r >= 0 && r <= 1 ? "one" : "other" } }) }), l = a(s), c = Object.freeze(Object.assign(Object.create(null), s, { default: l })), f = u(function (r, e) { var n = "zero", t = "one", o = "two", i = "few", a = "many", u = "other", s = { cardinal: [t, u], ordinal: [u] }, l = { cardinal: [u], ordinal: [u] }, c = { cardinal: [t, i, a, u], ordinal: [u] }, f = { cardinal: [t, u], ordinal: [t, u] }, h = { cardinal: [t, o, u], ordinal: [u] }; !function (e, n) { Object.defineProperty(n, "__esModule", { value: !0 }), r.exports = n }(0, { _in: l, af: s, ak: s, am: s, an: s, ar: { cardinal: [n, t, o, i, a, u], ordinal: [u] }, ars: { cardinal: [n, t, o, i, a, u], ordinal: [u] }, as: { cardinal: [t, u], ordinal: [t, o, i, a, u] }, asa: s, ast: s, az: { cardinal: [t, u], ordinal: [t, i, a, u] }, be: { cardinal: [t, i, a, u], ordinal: [i, u] }, bem: s, bez: s, bg: s, bho: s, bm: l, bn: { cardinal: [t, u], ordinal: [t, o, i, a, u] }, bo: l, br: { cardinal: [t, o, i, a, u], ordinal: [u] }, brx: s, bs: { cardinal: [t, i, u], ordinal: [u] }, ca: { cardinal: [t, u], ordinal: [t, o, i, u] }, ce: s, ceb: s, cgg: s, chr: s, ckb: s, cs: c, cy: { cardinal: [n, t, o, i, a, u], ordinal: [n, t, o, i, a, u] }, da: s, de: s, dsb: { cardinal: [t, o, i, u], ordinal: [u] }, dv: s, dz: l, ee: s, el: s, en: { cardinal: [t, u], ordinal: [t, o, i, u] }, eo: s, es: s, et: s, eu: s, fa: s, ff: s, fi: s, fil: f, fo: s, fr: f, fur: s, fy: s, ga: { cardinal: [t, o, i, a, u], ordinal: [t, u] }, gd: { cardinal: [t, o, i, u], ordinal: [t, o, i, u] }, gl: s, gsw: s, gu: { cardinal: [t, u], ordinal: [t, o, i, a, u] }, guw: s, gv: { cardinal: [t, o, i, a, u], ordinal: [u] }, ha: s, haw: s, he: { cardinal: [t, o, a, u], ordinal: [u] }, hi: { cardinal: [t, u], ordinal: [t, o, i, a, u] }, hr: { cardinal: [t, i, u], ordinal: [u] }, hsb: { cardinal: [t, o, i, u], ordinal: [u] }, hu: f, hy: f, ia: s, id: l, ig: l, ii: l, io: s, is: s, it: { cardinal: [t, u], ordinal: [a, u] }, iu: h, iw: { cardinal: [t, o, a, u], ordinal: [u] }, ja: l, jbo: l, jgo: s, ji: s, jmc: s, jv: l, jw: l, ka: { cardinal: [t, u], ordinal: [t, a, u] }, kab: s, kaj: s, kcg: s, kde: l, kea: l, kk: { cardinal: [t, u], ordinal: [a, u] }, kkj: s, kl: s, km: l, kn: s, ko: l, ks: s, ksb: s, ksh: { cardinal: [n, t, u], ordinal: [u] }, ku: s, kw: { cardinal: [n, t, o, i, a, u], ordinal: [t, a, u] }, ky: s, lag: { cardinal: [n, t, u], ordinal: [u] }, lb: s, lg: s, lkt: l, ln: s, lo: { cardinal: [u], ordinal: [t, u] }, lt: c, lv: { cardinal: [n, t, u], ordinal: [u] }, mas: s, mg: s, mgo: s, mk: { cardinal: [t, u], ordinal: [t, o, a, u] }, ml: s, mn: s, mo: { cardinal: [t, i, u], ordinal: [t, u] }, mr: { cardinal: [t, u], ordinal: [t, o, i, u] }, ms: { cardinal: [u], ordinal: [t, u] }, mt: c, my: l, nah: s, naq: h, nb: s, nd: s, ne: f, nl: s, nn: s, nnh: s, no: s, nqo: l, nr: s, nso: s, ny: s, nyn: s, om: s, or: { cardinal: [t, u], ordinal: [t, o, i, a, u] }, os: s, osa: l, pa: s, pap: s, pl: c, prg: { cardinal: [n, t, u], ordinal: [u] }, ps: s, pt: s, pt_PT: s, rm: s, ro: { cardinal: [t, i, u], ordinal: [t, u] }, rof: s, root: l, ru: c, rwk: s, sah: l, saq: s, sc: { cardinal: [t, u], ordinal: [a, u] }, scn: { cardinal: [t, u], ordinal: [a, u] }, sd: s, sdh: s, se: h, seh: s, ses: l, sg: l, sh: { cardinal: [t, i, u], ordinal: [u] }, shi: { cardinal: [t, i, u], ordinal: [u] }, si: s, sk: c, sl: { cardinal: [t, o, i, u], ordinal: [u] }, sma: h, smi: h, smj: h, smn: h, sms: h, sn: s, so: s, sq: { cardinal: [t, u], ordinal: [t, a, u] }, sr: { cardinal: [t, i, u], ordinal: [u] }, ss: s, ssy: s, st: s, su: l, sv: f, sw: s, syr: s, ta: s, te: s, teo: s, th: l, ti: s, tig: s, tk: { cardinal: [t, u], ordinal: [i, u] }, tl: f, tn: s, to: l, tr: s, ts: s, tzm: s, ug: s, uk: { cardinal: [t, i, a, u], ordinal: [i, u] }, ur: s, uz: s, ve: s, vi: { cardinal: [u], ordinal: [t, u] }, vo: s, vun: s, wa: s, wae: s, wo: l, xh: s, xog: s, yi: s, yo: l, yue: l, zh: l, zu: s }) }), h = a(f), m = l || c, y = h || Object.freeze(Object.assign(Object.create(null), f, { default: h })), g = "object" === ("undefined" == typeof Intl ? "undefined" : i(Intl)) && Intl.NumberFormat || o.default, v = function (r) { return "in" === r ? "_in" : "pt-PT" === r ? "pt_PT" : r }, w = t.default(g, function (r) { return m[v(r)] }, function (r, e) { return y[v(r)][e ? "ordinal" : "cardinal"] }); r.exports = w }(m = { path: h, exports: {}, require: function (r, e) { return function () { throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs") }(null == e && m.path) } }, m.exports), m.exports)), g = Intl.PluralRules || y, v = function (r) { this.value = r }; v.prototype.valueOf = function () { return this.value }; var w = function (r) { function e(e) { void 0 === e && (e = "???"), r.call(this, e) } return r && (e.__proto__ = r), e.prototype = Object.create(r && r.prototype), e.prototype.constructor = e, e.prototype.toString = function (r) { return "{" + this.value + "}" }, e }(v), b = function (r) { function e(e, n) { void 0 === n && (n = {}), r.call(this, e), this.opts = n } return r && (e.__proto__ = r), e.prototype = Object.create(r && r.prototype), e.prototype.constructor = e, e.prototype.toString = function (r) { try { return r.memoizeIntlObject(Intl.NumberFormat, this.opts).format(this.value) } catch (e) { return r.reportError(e), this.value.toString(10) } }, e }(v), S = function (r) { function e(e, n) { void 0 === n && (n = {}), r.call(this, e), this.opts = n } return r && (e.__proto__ = r), e.prototype = Object.create(r && r.prototype), e.prototype.constructor = e, e.prototype.toString = function (r) { try { return r.memoizeIntlObject(Intl.DateTimeFormat, this.opts).format(this.value) } catch (e) { return r.reportError(e), new Date(this.value).toISOString() } }, e }(v); function _(r, e, n) { if (n === e) return !0; if (n instanceof b && e instanceof b && n.value === e.value) return !0; if (e instanceof b && "string" == typeof n && n === r.memoizeIntlObject(g, e.opts).select(e.value)) return !0; return !1 } function k(r, e, n) { return e[n] ? D(r, e[n].value) : (r.reportError(new RangeError("No default")), new w) } function x(r, e) { for (var n = [], t = Object.create(null), o = 0, i = e; o < i.length; o += 1) { var a = i[o]; "narg" === a.type ? t[a.name] = E(r, a.value) : n.push(E(r, a)) } return { positional: n, named: t } } function E(r, e) { switch (e.type) { case "str": return e.value; case "num": return new b(e.value, { minimumFractionDigits: e.precision }); case "var": return function (r, e) { var n, t = e.name; if (r.params) { if (!Object.prototype.hasOwnProperty.call(r.params, t)) return new w("$" + t); n = r.params[t] } else { if (!r.args || !Object.prototype.hasOwnProperty.call(r.args, t)) return r.reportError(new ReferenceError("Unknown variable: $" + t)), new w("$" + t); n = r.args[t] } if (n instanceof v) return n; switch (typeof n) { case "string": return n; case "number": return new b(n); case "object": if (n instanceof Date) return new S(n.getTime()); default: return r.reportError(new TypeError("Variable type not supported: $" + t + ", " + typeof n)), new w("$" + t) } }(r, e); case "mesg": return function (r, e) { var n = e.name, t = e.attr, o = r.bundle._messages.get(n); if (!o) return r.reportError(new ReferenceError("Unknown message: " + n)), new w(n); if (t) { var i = o.attributes[t]; return i ? D(r, i) : (r.reportError(new ReferenceError("Unknown attribute: " + t)), new w(n + "." + t)) } if (o.value) return D(r, o.value); return r.reportError(new ReferenceError("No value: " + n)), new w(n) }(r, e); case "term": return function (r, e) { var n = e.name, t = e.attr, o = e.args, i = "-" + n, a = r.bundle._terms.get(i); if (!a) return r.reportError(new ReferenceError("Unknown term: " + i)), new w(i); if (t) { var u = a.attributes[t]; if (u) { r.params = x(r, o).named; var s = D(r, u); return r.params = null, s } return r.reportError(new ReferenceError("Unknown attribute: " + t)), new w(i + "." + t) } r.params = x(r, o).named; var l = D(r, a.value); return r.params = null, l }(r, e); case "func": return function (r, e) { var n = e.name, t = e.args, o = r.bundle._functions[n]; if (!o) return r.reportError(new ReferenceError("Unknown function: " + n + "()")), new w(n + "()"); if ("function" != typeof o) return r.reportError(new TypeError("Function " + n + "() is not callable")), new w(n + "()"); try { var i = x(r, t); return o(i.positional, i.named) } catch (e) { return r.reportError(e), new w(n + "()") } }(r, e); case "select": return function (r, e) { var n = e.selector, t = e.variants, o = e.star, i = E(r, n); if (i instanceof w) return k(r, t, o); for (var a = 0, u = t; a < u.length; a += 1) { var s = u[a]; if (_(r, i, E(r, s.key))) return D(r, s.value) } return k(r, t, o) }(r, e); default: return new w } } function j(r, e) { if (r.dirty.has(e)) return r.reportError(new RangeError("Cyclic reference")), new w; r.dirty.add(e); for (var n = [], t = r.bundle._useIsolating && e.length > 1, o = 0, i = e; o < i.length; o += 1) { var a = i[o]; if ("string" != typeof a) { if (r.placeables++, r.placeables > 100) throw r.dirty.delete(e), new RangeError("Too many placeables expanded: " + r.placeables + ", max allowed is 100"); t && n.push("â¨"), n.push(E(r, a).toString(r)), t && n.push("â©") } else n.push(r.bundle._transform(a)) } return r.dirty.delete(e), n.join("") } function D(r, e) { return "string" == typeof e ? r.bundle._transform(e) : j(r, e) } var O = function (r, e, n) { this.dirty = new WeakSet, this.params = null, this.placeables = 0, this.bundle = r, this.errors = e, this.args = n }; function N(r, e) { for (var n = Object.create(null), t = 0, o = Object.entries(r); t < o.length; t += 1) { var i = o[t], a = i[0], u = i[1]; e.includes(a) && (n[a] = u.valueOf()) } return n } O.prototype.reportError = function (r) { if (!this.errors) throw r; this.errors.push(r) }, O.prototype.memoizeIntlObject = function (r, e) { var n = this.bundle._intls.get(r); n || (n = {}, this.bundle._intls.set(r, n)); var t = JSON.stringify(e); return n[t] || (n[t] = new r(this.bundle.locales, e)), n[t] }; var z = ["unitDisplay", "currencyDisplay", "useGrouping", "minimumIntegerDigits", "minimumFractionDigits", "maximumFractionDigits", "minimumSignificantDigits", "maximumSignificantDigits"]; function F(r, e) { var n = r[0]; if (n instanceof w) return new w("NUMBER(" + n.valueOf() + ")"); if (n instanceof b || n instanceof S) return new b(n.valueOf(), Object.assign({}, n.opts, N(e, z))); throw new TypeError("Invalid argument to NUMBER") } var I = ["dateStyle", "timeStyle", "fractionalSecondDigits", "dayPeriod", "hour12", "weekday", "era", "year", "month", "day", "hour", "minute", "second", "timeZoneName"]; function T(r, e) { var n = r[0]; if (n instanceof w) return new w("DATETIME(" + n.valueOf() + ")"); if (n instanceof b || n instanceof S) return new S(n.valueOf(), Object.assign({}, n.opts, N(e, I))); throw new TypeError("Invalid argument to DATETIME") } var P = function (r, e) { void 0 === e && (e = {}); var n = e.functions, t = e.useIsolating; void 0 === t && (t = !0); var o = e.transform; void 0 === o && (o = function (r) { return r }), this._terms = new Map, this._messages = new Map, this._intls = new WeakMap, this.locales = Array.isArray(r) ? r : [r], this._functions = Object.assign({}, { NUMBER: F, DATETIME: T }, n), this._useIsolating = t, this._transform = o }; P.prototype.hasMessage = function (r) { return this._messages.has(r) }, P.prototype.getMessage = function (r) { return this._messages.get(r) }, P.prototype.addResource = function (r, e) { void 0 === e && (e = {}); var n = e.allowOverrides; void 0 === n && (n = !1); for (var t = [], o = 0; o < r.body.length; o++) { var i = r.body[o]; if (i.id.startsWith("-")) { if (!1 === n && this._terms.has(i.id)) { t.push(new Error('Attempt to override an existing term: "' + i.id + '"')); continue } this._terms.set(i.id, i) } else { if (!1 === n && this._messages.has(i.id)) { t.push(new Error('Attempt to override an existing message: "' + i.id + '"')); continue } this._messages.set(i.id, i) } } return t }, P.prototype.formatPattern = function (r, e, n) { if (void 0 === e && (e = null), void 0 === n && (n = null), "string" == typeof r) return this._transform(r); var t = new O(this, n, e); try { return j(t, r).toString(t) } catch (r) { if (t.errors) return t.errors.push(r), (new w).toString(t); throw r } }; var M = /^(-?[a-zA-Z][\w-]*) *= */gm, A = /\.([a-zA-Z][\w-]*) *= */y, R = /\*?\[/y, U = /(-?[0-9]+(?:\.([0-9]+))?)/y, q = /([a-zA-Z][\w-]*)/y, $ = /([$-])?([a-zA-Z][\w-]*)(?:\.([a-zA-Z][\w-]*))?/y, Z = /^[A-Z][A-Z0-9_-]*$/, C = /([^{}\n\r]+)/y, B = /([^\\"\n\r]*)/y, J = /\\([\\"])/y, L = /\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{6})/y, W = /^\n+/, G = / +$/, V = / *\r?\n/g, H = /( *)$/, K = /{\s*/y, Q = /\s*}/y, X = /\[\s*/y, Y = /\s*] */y, rr = /\s*\(\s*/y, er = /\s*->\s*/y, nr = /\s*:\s*/y, tr = /\s*,?\s*/y, or = /\s+/y, ir = function (r, e) { this.value = r, this.length = e }; r.FluentBundle = P, r.FluentDateTime = S, r.FluentNumber = b, r.FluentResource = function (r) { this.body = [], M.lastIndex = 0; for (var e = 0; ;) { var n = M.exec(r); if (null === n) break; e = M.lastIndex; try { this.body.push(s(n[1])) } catch (r) { if (r instanceof SyntaxError) continue; throw r } } function t(n) { return n.lastIndex = e, n.test(r) } function o(n, t) { if (r[e] === n) return e++, !0; if (t) throw new t("Expected " + n); return !1 } function i(r, n) { if (t(r)) return e = r.lastIndex, !0; if (n) throw new n("Expected " + r.toString()); return !1 } function a(n) { n.lastIndex = e; var t = n.exec(r); if (null === t) throw new SyntaxError("Expected " + n.toString()); return e = n.lastIndex, t } function u(r) { return a(r)[1] } function s(r) { var e = l(), n = function () { var r = Object.create(null); for (; t(A);) { var e = u(A), n = l(); if (null === n) throw new SyntaxError("Expected attribute value"); r[e] = n } return r }(); if (null === e && 0 === Object.keys(n).length) throw new SyntaxError("Expected message value or attributes"); return { id: r, value: e, attributes: n } } function l() { var n; if (t(C) && (n = u(C)), "{" === r[e] || "}" === r[e]) return c(n ? [n] : [], 1 / 0); var o = v(); return o ? n ? c([n, o], o.length) : (o.value = w(o.value, W), c([o], o.length)) : n ? w(n, G) : null } function c(n, o) { for (void 0 === n && (n = []); ;)if (t(C)) n.push(u(C)); else if ("{" !== r[e]) { if ("}" === r[e]) throw new SyntaxError("Unbalanced closing brace"); var i = v(); if (!i) break; n.push(i), o = Math.min(o, i.length) } else n.push(f()); var a = n.length - 1, s = n[a]; "string" == typeof s && (n[a] = w(s, G)); for (var l = [], c = 0, h = n; c < h.length; c += 1) { var m = h[c]; m instanceof ir && (m = m.value.slice(0, m.value.length - o)), m && l.push(m) } return l } function f() { i(K, SyntaxError); var r = h(); if (i(Q)) return r; if (i(er)) { var e = function () { var r, e = [], n = 0; for (; t(R);) { o("*") && (r = n); var i = p(), a = l(); if (null === a) throw new SyntaxError("Expected variant value"); e[n++] = { key: i, value: a } } if (0 === n) return null; if (void 0 === r) throw new SyntaxError("Expected default variant"); return { variants: e, star: r } }(); return i(Q, SyntaxError), Object.assign({}, { type: "select", selector: r }, e) } throw new SyntaxError("Unclosed placeable") } function h() { if ("{" === r[e]) return f(); if (t($)) { var n = a($), o = n[1], u = n[2], s = n[3]; if (void 0 === s && (s = null), "$" === o) return { type: "var", name: u }; if (i(rr)) { var l = function () { var n = []; for (; ;) { switch (r[e]) { case ")": return e++, n; case void 0: throw new SyntaxError("Unclosed argument list") }n.push(m()), i(tr) } }(); if ("-" === o) return { type: "term", name: u, attr: s, args: l }; if (Z.test(u)) return { type: "func", name: u, args: l }; throw new SyntaxError("Function names must be all upper-case") } return "-" === o ? { type: "term", name: u, attr: s, args: [] } : { type: "mesg", name: u, attr: s } } return d() } function m() { var r = h(); return "mesg" !== r.type ? r : i(nr) ? { type: "narg", name: r.name, value: d() } : r } function p() { var r; return i(X, SyntaxError), r = t(U) ? y() : { type: "str", value: u(q) }, i(Y, SyntaxError), r } function d() { if (t(U)) return y(); if ('"' === r[e]) return function () { o('"', SyntaxError); var n = ""; for (; ;) { if (n += u(B), "\\" !== r[e]) { if (o('"')) return { type: "str", value: n }; throw new SyntaxError("Unclosed string literal") } n += g() } }(); throw new SyntaxError("Invalid expression") } function y() { var r = a(U), e = r[1], n = r[2]; void 0 === n && (n = ""); var t = n.length; return { type: "num", value: parseFloat(e), precision: t } } function g() { if (t(J)) return u(J); if (t(L)) { var r = a(L), e = r[1], n = r[2], o = parseInt(e || n, 16); return o <= 55295 || 57344 <= o ? String.fromCodePoint(o) : "ï¿½" } throw new SyntaxError("Unknown escape sequence") } function v() { var n = e; switch (i(or), r[e]) { case ".": case "[": case "*": case "}": case void 0: return !1; case "{": return b(r.slice(n, e)) }return " " === r[e - 1] && b(r.slice(n, e)) } function w(r, e) { return r.replace(e, "") } function b(r) { var e = r.replace(V, "\n"), n = H.exec(r)[1].length; return new ir(e, n) } }, r.FluentType = v, Object.defineProperty(r, "__esModule", { value: !0 }) });
define('lib/fluent-bundle-sequence', ["require", "exports", "tslib", "@fluent/bundle"], function (require, e, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.FluentBundleSequence = e.LocalizableNumericValue = e.RTL_LANGUAGES = void 0, e.RTL_LANGUAGES = ["ae", "ar", "arc", "bcc", "bqi", "ckb", "dv", "fa", "glk", "he", "ku", "mzn", "nqo", "pnb", "ps", "sd", "ug", "ur", "yi"]; var t = function (e) { this.value = e }; e.LocalizableNumericValue = t; var o = function () { function o(e, n) { this.bundles = e, this.onError = n } return o.fromSources = function (t, a, i) { for (var u = [], l = 0, s = t; l < s.length; l++) { var c = s[l], d = c.lang, f = c.source, h = d.split("-")[0], m = new r.FluentBundle(d, n.__assign(n.__assign({}, i), { useIsolating: e.RTL_LANGUAGES.indexOf(h) >= 0 })); m.addResource(new r.FluentResource(f), { allowOverrides: !1 }), m.addResource(new r.FluentResource('\nl10n-internal-date-day-month-year = {DATETIME($d, month: "short", day: "numeric", year: "numeric")}\nl10n-internal-date-day-month = {DATETIME($d, month: "short", day: "numeric")}\nl10n-internal-time = {DATETIME($d, minute: "numeric", hour: "numeric")}\n      '), { allowOverrides: !1 }), u.push(m) } return new o(u, a) }, o.prototype.format = function (e, n) { for (var r = 0, t = this.bundles; r < t.length; r++) { var o = t[r]; if (o.hasMessage(e)) { var a = o.getMessage(e); if (!(null == a ? void 0 : a.value)) return; for (var i = [], u = o.formatPattern(a.value, this.coerceNumericVariables(n), i), l = 0, s = i; l < s.length; l++) { var c = s[l]; this.onError("Error formatting " + e + " for locale " + o.locales.join(",") + ": " + c) } return u } } this.onError("Couldn't find message for key " + e + " for locales " + this.getLocales().join(",")) }, o.prototype.formatDate = function (e, n) { return n.showYear ? this.format("l10n-internal-date-day-month-year", { d: e }) : this.format("l10n-internal-date-day-month", { d: e }) }, o.prototype.formatTime = function (e) { var n = this.format("l10n-internal-time", { d: e }); return "en" === this.getLocales()[0] ? null == n ? void 0 : n.toLowerCase() : n }, o.prototype.hasTranslation = function (e, n) { for (var r = 0, t = this.bundles; r < t.length; r++) { var o = t[r]; if (o.locales.indexOf(n) >= 0) return o.hasMessage(e) } return !1 }, o.prototype.coerceNumericVariables = function (e) { var n = {}; for (var r in e) { var o = e[r]; n[r] = o instanceof t ? o.value : "number" == typeof o ? "" + o : o } return n }, o.prototype.getLocales = function () { return this.bundles.reduce(function (e, n) { return e.concat(n.locales) }, []) }, o }(); e.FluentBundleSequence = o });
define('lib/i18n-core', ["require", "exports", "text!l10n/all-en-strings.ftl", "tslib", "underscore", "lib/console", "./i18n-homepage-langs", "./enabled-languages", "./fluent-bundle-sequence"], function (require, n, r, e, t, a, u, o, i) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.unpack = n.isSupportedLanguage = n.currentLanguage = n.formatWithFluent = n.createDictionaryLookupFunction = n.s = n.raw = n.hasTranslation = n.restrictToHomepageLanguages = n.initFluentData = n.setLanguage = n.locale_dict = void 0; var l = ""; n.locale_dict = {}; var c = {}, s = {}, f = ["ar", "hy-AM", "hi", "tr", "xx-XX"]; function g(n, r, e) { return p(n, null != r ? r : {}, null != e ? e : l) } function p(n, r, e) { var t = d(e).format(n, function (n) { var r = {}; for (var e in n) { var t = n[e]; void 0 !== t && (r[e] = t) } return r }(r)); return null == t ? (a.warn("Could not format string " + n), "") : t } function d(t) { var u = s[t]; if (!u) { n.locale_dict[t] || (n.locale_dict[t] = o.expandLocaleOptionsThoroughly([t])); for (var l = [], f = 0, g = n.locale_dict[t]; f < g.length; f++) { var p = g[f], d = c[p]; d && l.push({ lang: p, source: d }) } var v = {}; "xx-XX" === t && (v.transform = function (n) { return n.replace(/[a-z]/gi, "â¦") }), u = s[t] = i.FluentBundleSequence.fromSources(e.__spreadArray(e.__spreadArray([], l), [{ lang: "en", source: r }]), function (n) { a.warn(n) }, v) } return u } n.setLanguage = function (n) { l = n || "" }, n.initFluentData = function (n) { for (var r in n) delete s[r], c[r] = n[r] }, n.restrictToHomepageLanguages = function () { for (var n in o.ENABLED_LANGUAGES) u.isHomepageLanguage(n) || delete o.ENABLED_LANGUAGES[n] }, n.hasTranslation = function (n, r) { var e = null != r ? r : l; return d(e).hasTranslation(n, e) }, n.raw = function (n, r) { if (r) for (var e in r) r.hasOwnProperty(e) && (n = n.split("__" + e + "__").join(r[e])); return n }, n.s = g, n.createDictionaryLookupFunction = function (n) { return function (r, e) { return p(r, null != e ? e : {}, n()) } }, n.formatWithFluent = p, n.currentLanguage = function () { return l }, n.isSupportedLanguage = function (n) { return o.ENABLED_LANGUAGES.hasOwnProperty(n) || t.contains(f, n) }, n.unpack = function n(r, e) { if (null == r) return ""; if ("string" == typeof r) return r; if ("number" == typeof r) return "" + r; var t, a = r.vars; if (a) for (var u in t = {}, a) a.hasOwnProperty(u) && (t[u] = n(a[u], e)); return g(r.key, t, e) } });
define('lib/i18n', ["require", "exports", "config", "jquery", "lib/console", "./enabled-languages", "./i18n-core", "./i18n-core"], function (require, e, a, n, t, r, o, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.fetchLanguage = e.detectLanguage = e.locale_dict = e.unpack = e.currentLanguage = e.createDictionaryLookupFunction = e.s = e.raw = e.hasTranslation = e.restrictToHomepageLanguages = void 0, Object.defineProperty(e, "restrictToHomepageLanguages", { enumerable: !0, get: function () { return u.restrictToHomepageLanguages } }), Object.defineProperty(e, "hasTranslation", { enumerable: !0, get: function () { return u.hasTranslation } }), Object.defineProperty(e, "raw", { enumerable: !0, get: function () { return u.raw } }), Object.defineProperty(e, "s", { enumerable: !0, get: function () { return u.s } }), Object.defineProperty(e, "createDictionaryLookupFunction", { enumerable: !0, get: function () { return u.createDictionaryLookupFunction } }), Object.defineProperty(e, "currentLanguage", { enumerable: !0, get: function () { return u.currentLanguage } }), Object.defineProperty(e, "unpack", { enumerable: !0, get: function () { return u.unpack } }); var s = "undefined" != typeof Desmos && Desmos.localeData ? Desmos.localeData : {}; function i() { for (var e = r.expandLocaleOptionsThoroughly([a.get("language"), navigator.userLanguage, navigator.language]), n = 0; n < e.length; n++) { var t = e[n]; if (o.isSupportedLanguage(t)) return t } return "en" } e.locale_dict = {}, e.detectLanguage = i, e.fetchLanguage = function (e) { var a = n.Deferred(); if ("undefined" == typeof Desmos) return a.reject(), a.promise(); if (Desmos.supportedLanguages || (Desmos.supportedLanguages = []), Desmos.supportedLanguages.indexOf(e) >= 0 || "en" === e || "xx-XX" === e) return o.setLanguage(e), a.resolve(!0), a.promise(); if (!o.isSupportedLanguage(e)) { var u = -1 !== e.indexOf("-") ? e.split("-")[0] : e; for (var s in r.ENABLED_LANGUAGES) if (u === s.split("-")[0] && r.ENABLED_LANGUAGES[s].useAsRoot) { e = s; break } } return n.get("/api/v1/calculator/language/" + e + ".ftl", function (n) { Desmos.localeData || (Desmos.localeData = {}), Desmos.supportedLanguages || (Desmos.supportedLanguages = []), Desmos.localeData[e] = n[e], Desmos.supportedLanguages.push(e), o.initFluentData(Desmos.localeData), o.setLanguage(e), a.resolve(!0) }).fail(function (n) { 404 === n.status && t.warn(e + " is not an available language."), a.reject() }), a.promise() }, o.initFluentData(s), o.setLanguage(i()) });
define("pjs", [], function () { return function (n, t, o) { function r(n) { return "object" == typeof n } function e(n) { return "function" == typeof n } function i() { } return function n(o, p) { function u() { var n = new c; return e(n.init) && n.init.apply(n, arguments), n } function c() { } undefined === p && (p = o, o = Object), u.Bare = c; var f, y = i.prototype = o.prototype, a = c.prototype = u.prototype = new i; return a.constructor = u, u.mixin = function (t) { return c.prototype = u.prototype = n(u, t).prototype, u }, (u.open = function (n) { if (f = {}, e(n) ? f = n.call(u, a, y, u, o) : r(n) && (f = n), r(f)) for (var i in f) t.call(f, i) && (a[i] = f[i]); return e(a.init) || (a.init = o), u })(p) } }(0, {}.hasOwnProperty) });
define('underscore_model', ['require', 'underscore', 'pjs'], function (require) { var e = require("underscore"); return { UnderscoreModel: require("pjs")(function (r) { var t = 0, s = "guid_" + Math.round(1e6 * Math.random()) + "_" + (new Date).getTime() + "_"; r.init = function () { this.__observers = {}, this.__eventObservers = {}, this.__oldProperties = {}, this.__propertyComparators = {}, this.guid = s + ++t }, r.unobserveAll = function () { this.__observers = {}, this.__eventObservers = {} }, r.getProperty = function (e) { return this[e] }, r.getOldProperty = function (e) { return this.__oldProperties[e] }, r.setProperty = function (r, t) { var s = this[r]; this[r] = t; var i = this.__propertyComparators[r]; if (i) { if (i(s, t)) return } else if (e.isEqual(s, t)) return; this.__oldProperties[r] = s, this.notifyPropertyChange(r) }, r.setProperties = function (e) { for (var r in e) e.hasOwnProperty(r) && this.setProperty(r, e[r]) }, r.setPropertyComparator = function (e, r) { this.__propertyComparators[e] = r }, r.notifyPropertyChange = function (e) { this.__callObservers(this.__observers, e, this) }, r.observe = function (e, r) { this.__addObservers(this.__observers, e, r) }, r.unobserve = function (e) { this.__removeObservers(this.__observers, e) }, r.observeAndSync = function (e, r) { this.observe(e, r); for (var t = e.split(" "), s = 0; s < t.length; s++) { var i = t[s].split(".")[0]; this.hasOwnProperty(i) && r(i, this) } }, r.triggerEvent = function (e, r) { this.__callObservers(this.__eventObservers, e, r) }, r.observeEvent = function (e, r) { this.__addObservers(this.__eventObservers, e, r) }, r.unobserveEvent = function (e) { this.__removeObservers(this.__eventObservers, e) }, r.__callObservers = function (e, r, t) { var s = e[r]; if (s) for (var i = 0; i < s.length; i++)s[i].callback(r, t) }, r.__removeObservers = function (e, r) { for (var t = r.split(" "), s = 0; s < t.length; s++) { var i = t[s].split("."), o = i[0], n = i[1]; if (o && n) { var v = e[o], _ = []; if (!v) continue; for (var a = 0; a < v.length; a++) { var h = v[a]; h.namespace !== n && _.push(h) } e[o] = _ } else if (o) delete e[o]; else if (n) for (o in e) e.hasOwnProperty(o) && this.__removeObservers(e, o + "." + n) } }, r.__addObservers = function (e, r, t) { for (var s = r.split(" "), i = 0; i < s.length; i++) { var o = s[i].split("."), n = o[0]; if (!n) throw "Must supply a property to observe"; var v = { namespace: o[1], callback: t }, _ = e[n]; _ ? _.push(v) : e[n] = [v] } } }) } });
define('core/lib/worker-i18n', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.s = void 0, e.s = function (e, r) { return { key: e, vars: r } } });
define('main/backend', ["require", "exports", "jquery"], function (require, e, t) { "use strict"; function r(e) { return function (t) { if (t && t.responseJSON && (t = t.responseJSON), !0 === t.success) e.resolve(); else { var r = (t && t.errors || []).map(function (e) { return e.message }); e.reject(r[0] || "Internal Server Error") } } } function n(e) { if (e && e.routeDeprecated) { e.js && new Function(e.js)(); var r = t.Deferred(); return r.reject(e), r.promise() } return e } function o(r, o) { return t.ajax({ dataType: "json", url: e.baseURL + r, xhrFields: { withCredentials: !0 }, data: o }).then(n) } Object.defineProperty(e, "__esModule", { value: !0 }), e.getJSON = e.postJSON = e.post = e.handleDeprecatedRoute = e.exchangeAppleAuth = e.exchangeGoogleAuthCode = e.getAppleLoginURL = e.getGoogleLoginURL = e.baseURL = void 0, e.baseURL = "", e.getGoogleLoginURL = function (t) { void 0 === t && (t = {}); var r = "?source=" + (t.fromUI || ""); return t.teacher && (r += "&teacher=true"), e.baseURL + "/drive_api/calculator/login" + r }, e.getAppleLoginURL = function (t) { void 0 === t && (t = {}); var r = "?source=" + (t.fromUI || ""); return t.teacher && (r += "&teacher=true"), e.baseURL + "/apple_api/calculator/login" + r }, e.exchangeGoogleAuthCode = function (e) { var n = t.Deferred(); return e ? o("/account/google_auth?code=" + e).always(r(n)) : setTimeout(function () { n.reject("no auth code") }, 1), n.promise() }, e.exchangeAppleAuth = function (e) { var n = t.Deferred(), a = e && e.jwt, c = e && e.name || ""; return e && a ? o("/account/apple_auth?name=" + encodeURIComponent(c) + "&jwt=" + encodeURIComponent(a)).always(r(n)) : setTimeout(function () { n.reject("no auth code") }, 1), n.promise() }, e.handleDeprecatedRoute = n, e.post = function (r, o) { return t.ajax({ type: "POST", url: e.baseURL + r, headers: { Accept: "application/json, text/javascript, */*; q=0.01" }, data: o, xhrFields: { withCredentials: !0 } }).then(n) }, e.postJSON = function (r, o) { return t.ajax({ type: "POST", contentType: "application/json", url: e.baseURL + r, headers: { Accept: "application/json, text/javascript, */*; q=0.01" }, data: JSON.stringify(o || null), xhrFields: { withCredentials: !0 } }).then(n) }, e.getJSON = o });
define('main/graph', ['require', 'pjs', 'underscore_model', 'core/lib/worker-i18n', 'main/backend'], function (require) { "use strict"; var e = require("pjs"), t = require("underscore_model").UnderscoreModel, a = require("core/lib/worker-i18n"), r = require("main/backend"), s = e(t, function (e, t) { var l = ["title", "thumbURL", "stateURL", "hash", "parentHash", "recovery", "recoveryParentHash", "graphData", "access", "created", "example", "draft", "easterEgg"]; e.init = function (e) { t.init.call(this); var a = this; e && l.forEach(function (t) { e.hasOwnProperty(t) && a.setProperty(t, e[t]) }), this.access || this.setProperty("access", "all"), this.example || this.setProperty("example", !1), this.draft || this.setProperty("draft", !1), this.now = new Date }, e.copy = function () { return s(this) }, e.getCollectionKey = function () { var e = ""; return this.example ? e = "example-" : this.draft && (e = "draft-"), e + this.hash }, e.displayDate = function () { var e = (Date.now() - this.created) / 1e3 / 60, t = e / 60, r = t / 24, s = r / 7, l = [a.s("account-shell-label-month-jan"), a.s("account-shell-label-month-feb"), a.s("account-shell-label-month-mar"), a.s("account-shell-label-month-apr"), a.s("account-shell-label-month-may"), a.s("account-shell-label-month-jun"), a.s("account-shell-label-month-jul"), a.s("account-shell-label-month-aug"), a.s("account-shell-label-month-sep"), a.s("account-shell-label-month-oct"), a.s("account-shell-label-month-nov"), a.s("account-shell-label-month-dec")]; return s >= 5 ? a.s("account-shell-label-created-on-date", { month: l[this.created.getMonth()], day: this.created.getDate(), year: this.created.getFullYear() }) : s >= 2 ? a.s("account-shell-label-created-weeks-ago", { number: String(Math.floor(s)) }) : r >= 7 ? a.s("account-shell-label-created-last-week") : r >= 2 ? a.s("account-shell-label-created-days-ago", { number: String(Math.floor(r)) }) : t >= 24 ? a.s("account-shell-label-created-yesterday") : t >= 2 ? a.s("account-shell-label-created-hours-ago", { number: String(Math.floor(t)) }) : e >= 60 ? a.s("account-shell-label-created-one-hour-ago") : e >= 2 ? a.s("account-shell-label-created-minutes-ago", { number: String(Math.floor(e)) }) : e >= 1 ? a.s("account-shell-label-created-one-minute-ago") : a.s("account-shell-label-created-seconds-ago") }, e.plainObject = function () { var e = {}, t = this; return l.forEach(function (a) { e[a] = t[a] }), e }, e.getURL = function () { var e; if ("file:" === window.location.protocol) { var t = "/calculator"; if (!r.baseURL) return t; e = r.baseURL + t } else { var a = "/" + document.location.pathname.split("/")[1]; e = window.location.href.split(a)[0] + a } return e + (this.hash && !this.recovery ? "/" + this.hash : "") } }); return s.fromAjax = function (e) { return s({ title: e.title, thumbURL: e.thumbUrl, stateURL: e.stateUrl, graphData: e.state, hash: e.hash, parentHash: e.parent_hash, recoveryParentHash: e.recovery_parent_hash, access: e.access, created: new Date(e.created), example: !!e.example, draft: !!e.draft, easterEgg: e.easterEgg }) }, s.toAjax = function (e) { return { title: e.title, thumbUrl: e.thumbURL, stateUrl: e.stateURL, state: e.graphData, hash: e.hash, parent_hash: e.parentHash, recovery_parent_hash: e.recoveryParentHash, access: e.access, created: e.created.toString() } }, s.updateFromSync = function (e, t) { e.setProperty("title", t.title), e.setProperty("hash", t.hash), e.setProperty("parentHash", t.parent_hash), e.setProperty("recoveryParentHash", t.recovery_parent_hash), e.setProperty("graphData", e.graphData), e.setProperty("thumbURL", t.thumbUrl), e.setProperty("stateURL", t.stateUrl), e.setProperty("created", new Date(t.created)) }, s });

define('text!example_graphs', [], function () { return '[{"hash":"2rnqgoa6a4","parent_hash":"89ndqgh5id","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/2rnqgoa6a4.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/2rnqgoa6a4","title":"graphing-calculator-label-example-graph-lines-slope-intercept-form","access":"all","created":"Tue, 18 Aug 2015 19:24:05 GMT","example":true},{"hash":"onfy0dzx2o","parent_hash":"kha6fgxhaf","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/onfy0dzx2o.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/onfy0dzx2o","title":"graphing-calculator-label-example-graph-lines-point-slope-form","access":"all","created":"Tue, 18 Aug 2015 20:21:16 GMT","example":true},{"hash":"md6buy4efz","parent_hash":"fi71u8ej0q","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/md6buy4efz.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/md6buy4efz","title":"graphing-calculator-label-example-graph-lines-two-point-form","access":"all","created":"Tue, 18 Aug 2015 20:21:39 GMT","example":true},{"hash":"zukjgk9iry","parent_hash":"jv9fmw2qz8","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zukjgk9iry.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zukjgk9iry","title":"graphing-calculator-label-example-graph-parabolas-standard-form","access":"all","created":"Tue, 18 Aug 2015 20:22:02 GMT","example":true},{"hash":"8keeh1pt5l","parent_hash":"klodq5d0ph","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8keeh1pt5l.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8keeh1pt5l","title":"graphing-calculator-label-example-graph-parabolas-vertex-form","access":"all","created":"Tue, 18 Aug 2015 20:22:22 GMT","example":true},{"hash":"dxkknajdqb","parent_hash":"t6auzqijzl","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/dxkknajdqb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/dxkknajdqb","title":"graphing-calculator-label-example-graph-parabolas-standard-form-plus-tangent","access":"all","created":"Tue, 18 Aug 2015 20:24:05 GMT","example":true},{"hash":"kihjluohq9","parent_hash":"vpnnmvncdb","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/kihjluohq9.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/kihjluohq9","title":"graphing-calculator-label-example-graph-trig-period-and-amplitude","access":"all","created":"Tue, 18 Aug 2015 20:24:32 GMT","example":true},{"hash":"l3u8133jwj","parent_hash":"51d9lso1ia","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/l3u8133jwj.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/l3u8133jwj","title":"graphing-calculator-label-example-graph-trig-phase","access":"all","created":"Tue, 18 Aug 2015 20:24:53 GMT","example":true},{"hash":"7eeumgl7it","parent_hash":"7rnv0erick","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/7eeumgl7it.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/7eeumgl7it","title":"graphing-calculator-label-example-graph-trig-wave-interference","access":"link","created":"Tue, 03 Dec 2019 18:14:54 GMT","example":true},{"hash":"qmzx2skkzy","parent_hash":"s9myfmvujr","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qmzx2skkzy.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qmzx2skkzy","title":"graphing-calculator-label-example-graph-trig-unit-circle","access":"all","created":"Tue, 18 Aug 2015 20:26:18 GMT","example":true},{"hash":"ivud1auwvw","parent_hash":"8dsmqe5ycc","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ivud1auwvw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ivud1auwvw","title":"graphing-calculator-label-example-graph-conic-sections-circle","access":"all","created":"Tue, 18 Aug 2015 20:27:04 GMT","example":true},{"hash":"djcrjdfiif","parent_hash":"0jwlvn9hcs","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/djcrjdfiif.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/djcrjdfiif","title":"graphing-calculator-label-example-graph-conic-sections-parabola-and-focus","access":"all","created":"Tue, 18 Aug 2015 20:27:50 GMT","example":true},{"hash":"afja7ee9mh","parent_hash":"duajwxdopa","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/afja7ee9mh.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/afja7ee9mh","title":"graphing-calculator-label-example-graph-conic-sections-ellipse-with-foci","access":"all","created":"Tue, 18 Aug 2015 20:28:08 GMT","example":true},{"hash":"vgfqbejegx","parent_hash":"k6xcbueze5","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/vgfqbejegx.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/vgfqbejegx","title":"graphing-calculator-label-example-graph-conic-sections-hyperbola","access":"all","created":"Tue, 18 Aug 2015 20:28:27 GMT","example":true},{"hash":"0ovfwwmfrb","parent_hash":"scuci1750d","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/0ovfwwmfrb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/0ovfwwmfrb","title":"graphing-calculator-label-example-graph-polar-rose","access":"all","created":"Tue, 18 Aug 2015 20:28:48 GMT","example":true},{"hash":"qlbdlxyrza","parent_hash":"nicremwert","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qlbdlxyrza.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qlbdlxyrza","title":"graphing-calculator-label-example-graph-polar-logarithmic-spiral","access":"all","created":"Tue, 18 Aug 2015 20:29:08 GMT","example":true},{"hash":"rayzacuktw","parent_hash":"21pbohd07u","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/rayzacuktw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/rayzacuktw","title":"graphing-calculator-label-example-graph-polar-limacon","access":"all","created":"Tue, 18 Aug 2015 20:29:25 GMT","example":true},{"hash":"gxnu7fbgks","parent_hash":"kk3axf8oon","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/gxnu7fbgks.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/gxnu7fbgks","title":"graphing-calculator-label-example-graph-polar-conic-sections","access":"link","created":"Tue, 18 Aug 2015 20:29:42 GMT","example":true},{"hash":"rnyjcjpouf","parent_hash":"ogvj2tzgjj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/rnyjcjpouf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/rnyjcjpouf","title":"graphing-calculator-label-example-graph-parametric-introduction","access":"all","created":"Tue, 18 Aug 2015 20:30:31 GMT","example":true},{"hash":"eg5he4xpg9","parent_hash":"pwjl3pe4da","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/eg5he4xpg9.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/eg5he4xpg9","title":"graphing-calculator-label-example-graph-parametric-cycloid","access":"link","created":"Tue, 18 Aug 2015 20:30:46 GMT","example":true},{"hash":"nyterjs0uf","parent_hash":"nqxx2mhknn","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/nyterjs0uf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/nyterjs0uf","title":"graphing-calculator-label-example-graph-transformations-translating-a-function","access":"link","created":"Fri, 29 Sep 2017 00:47:36 GMT","example":true},{"hash":"vdkjrpznnu","parent_hash":"doxva7ciht","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/vdkjrpznnu.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/vdkjrpznnu","title":"graphing-calculator-label-example-graph-transformations-scaling-a-function","access":"link","created":"Tue, 18 Aug 2015 21:23:20 GMT","example":true},{"hash":"fcjhdt1xdw","parent_hash":"tif5liedlj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/fcjhdt1xdw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/fcjhdt1xdw","title":"graphing-calculator-label-example-graph-transformations-inverse-of-a-function","access":"link","created":"Tue, 18 Aug 2015 21:23:36 GMT","example":true},{"hash":"jwquvmikhr","parent_hash":"2l0r87hkmq","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/jwquvmikhr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/jwquvmikhr","title":"graphing-calculator-label-example-graph-stats-linear-regression","access":"link","created":"Tue, 18 Aug 2015 21:24:01 GMT","example":true},{"hash":"qrdbrcfnsl","parent_hash":"paknt6oneh","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qrdbrcfnsl.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qrdbrcfnsl","title":"graphing-calculator-label-example-graph-stats-anscombes-quartet","access":"link","created":"Mon, 13 Jul 2020 20:40:16 GMT","example":true},{"hash":"sanlujpfmc","parent_hash":"tyszvsmelo","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/sanlujpfmc.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/sanlujpfmc","title":"graphing-calculator-label-example-graph-stats-fourth-order-polynomial","access":"all","created":"Tue, 18 Aug 2015 21:25:02 GMT","example":true},{"hash":"iwfjdrhdyr","parent_hash":"4n11jtzki0","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/iwfjdrhdyr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/iwfjdrhdyr","title":"graphing-calculator-label-example-graph-lists-family-of-sin-curves","access":"link","created":"Tue, 18 Aug 2015 21:25:30 GMT","example":true},{"hash":"ib4qkln029","parent_hash":"1flkupc1yt","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ib4qkln029.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ib4qkln029","title":"graphing-calculator-label-example-graph-lists-curve-stitching","access":"link","created":"Thu, 05 May 2016 06:33:59 GMT","example":true},{"hash":"zdv2kras4n","parent_hash":"fqhp5hq3ka","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zdv2kras4n.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zdv2kras4n","title":"graphing-calculator-label-example-graph-lists-plotting-a-list-of-points","access":"link","created":"Tue, 18 Aug 2015 21:27:01 GMT","example":true},{"hash":"qtzamwcdrk","parent_hash":"aqgbwm3qfd","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qtzamwcdrk.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qtzamwcdrk","title":"graphing-calculator-label-example-graph-calculus-derivatives","access":"link","created":"Tue, 18 Aug 2015 21:27:17 GMT","example":true},{"hash":"mekfho0w38","parent_hash":"irip8pnpdf","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/mekfho0w38.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/mekfho0w38","title":"graphing-calculator-label-example-graph-calculus-secant-line","access":"link","created":"Tue, 18 Aug 2015 21:27:32 GMT","example":true},{"hash":"fs3lx8gptb","parent_hash":"dlzhsldcgo","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/fs3lx8gptb.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/fs3lx8gptb","title":"graphing-calculator-label-example-graph-calculus-tangent-line","access":"link","created":"Tue, 18 Aug 2015 21:27:46 GMT","example":true},{"hash":"noanuckuli","parent_hash":"gkjridbqfj","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/noanuckuli.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/noanuckuli","title":"graphing-calculator-label-example-graph-calculus-taylor-expansion-of-sin-x","access":"link","created":"Tue, 18 Aug 2015 21:28:02 GMT","example":true},{"hash":"qigfpckugc","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qigfpckugc.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qigfpckugc","title":"graphing-calculator-label-example-graph-calculus-integrals","access":"link","created":"Tue, 19 Apr 2016 14:03:33 GMT","example":true},{"hash":"u2qz73ufju","parent_hash":"o3pwn3vkgh","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/u2qz73ufju.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/u2qz73ufju","title":"graphing-calculator-label-example-graph-calculus-integral-with-adjustable-bounds","access":"link","created":"Tue, 19 Apr 2016 14:12:40 GMT","example":true},{"hash":"gaa5aqyb5s","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/gaa5aqyb5s.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/gaa5aqyb5s","title":"graphing-calculator-label-example-graph-calculus-fundamental-theorem-of-calculus","access":"link","created":"Tue, 19 Apr 2016 14:15:45 GMT","example":true},{"hash":"8hxtdephtf","parent_hash":"xova2bfhj5","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8hxtdephtf.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8hxtdephtf","title":"graphing-calculator-label-example-graph-pac-man","access":"link","created":"Mon, 20 Apr 2015 14:47:01 GMT","example":true,"easterEgg":"betchacant"},{"hash":"qbaliml2om","parent_hash":"8mmk4hrmqg","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/qbaliml2om.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/qbaliml2om","title":"graphing-calculator-label-example-graph-pride-flag","access":"link","created":"Wed, 02 Jun 2021 01:46:57 GMT","example":true,"easterEgg":"pride"},{"hash":"ieellz6qbr","parent_hash":"velayq9vsr","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/ieellz6qbr.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/ieellz6qbr","title":"graphing-calculator-label-example-graph-pride-flag","access":"link","created":"Wed, 02 Jun 2021 01:51:23 GMT","example":true,"easterEgg":"pride"},{"hash":"dhzndt8brx","parent_hash":"brei8peg52","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/dhzndt8brx.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/dhzndt8brx","title":"graphing-calculator-label-example-graph-3d-world","access":"link","created":"Fri, 03 Jun 2016 01:50:06 GMT","example":true,"easterEgg":"betchacant"},{"hash":"zzhx3zzlns","parent_hash":"ccmfndxptv","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/zzhx3zzlns.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/zzhx3zzlns","title":"graphing-calculator-label-example-graph-checkerboard-inversion","access":"link","created":"Thu, 02 Jun 2016 22:06:08 GMT","example":true,"easterEgg":"betchacant"},{"hash":"c1u72uowae","parent_hash":null,"thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/c1u72uowae.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/c1u72uowae","title":"graphing-calculator-label-example-graph-regular-sine-wave","access":"link","created":"Sun, 18 Aug 2013 06:25:20 GMT","example":true,"easterEgg":"betchacant"},{"hash":"2mwse3jtff","parent_hash":"msmdonti4c","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/2mwse3jtff.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/2mwse3jtff","title":"graphing-calculator-label-example-graph-fastest-path-to-a-point","access":"link","created":"Thu, 02 Jun 2016 22:02:44 GMT","example":true,"easterEgg":"betchacant"},{"hash":"8ytrg3nyln","parent_hash":"d7qrsg2hxg","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/8ytrg3nyln.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/8ytrg3nyln","title":"graphing-calculator-label-example-graph-fireworks","access":"link","created":"Fri, 03 Jun 2016 01:50:52 GMT","example":true,"easterEgg":"betchacant"},{"hash":"9ed6k6wexp","parent_hash":"9ed6k6wexp","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/9qixqdozzh.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/9ed6k6wexp","title":"graphing-calculator-label-example-graph-fractal-valentine","access":"link","created":"Sat, 14 Feb 2015 18:42:18 GMT","example":true,"easterEgg":"betchacant"},{"hash":"am6ab20tmw","parent_hash":"hvycjwscfq","thumbUrl":"https://saved-work.desmos.com/calc_thumbs/production/am6ab20tmw.png","stateUrl":"https://saved-work.desmos.com/calc-states/production/am6ab20tmw","title":"graphing-calculator-label-example-graph-outstretched-arm","access":"link","created":"Fri, 03 Jun 2016 01:45:50 GMT","example":true,"easterEgg":"betchacant"}]\n'; });

var __extends = this && this.__extends || function () { var t = function (e, n) { return (t = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) { t.__proto__ = e } || function (t, e) { for (var n in e) Object.prototype.hasOwnProperty.call(e, n) && (t[n] = e[n]) })(e, n) }; return function (e, n) { if ("function" != typeof n && null !== n) throw new TypeError("Class extends value " + String(n) + " is not a constructor or null"); function r() { this.constructor = e } t(e, n), e.prototype = null === n ? Object.create(n) : (r.prototype = n.prototype, new r) } }(), __assign = this && this.__assign || function () { return (__assign = Object.assign || function (t) { for (var e, n = 1, r = arguments.length; n < r; n++)for (var i in e = arguments[n]) Object.prototype.hasOwnProperty.call(e, i) && (t[i] = e[i]); return t }).apply(this, arguments) }; !function () { var t = -1, e = Math.min, n = Math.max; function r() { } function i(t, e) { if (!e) throw new Error("prayer failed: " + t) } function o(e) { i("a direction was passed", e === t || 1 === e) } new URLSearchParams(window.location.search); function s(t) { var e = document.implementation.createHTMLDocument(""); if (e.body.innerHTML = t, 1 === e.body.children.length) return e.body.children[0]; for (var n = document.createDocumentFragment(); e.body.firstChild;)n.appendChild(e.body.firstChild); return n } var a = function (t, e, n) { var r; switch (t) { case "svg": case "path": r = document.createElementNS("http://www.w3.org/2000/svg", t); break; default: r = document.createElement(t) }for (var i in e) { var o = e[i]; void 0 !== o && r.setAttribute(i, "string" == typeof o ? o : String(o)) } if (n) for (var s = 0; s < n.length; s++)r.appendChild(n[s]); return r }; function c(t, e) { var n, r, i; if ("function" == typeof (null === (n = t) || void 0 === n ? void 0 : n.closest)) return t.closest(e); if (!(t instanceof HTMLElement)) return null; var o = Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector, s = t; do { if (o.call(s, e)) return s; s = null !== (i = null !== (r = null == s ? void 0 : s.parentElement) && void 0 !== r ? r : null == s ? void 0 : s.parentNode) && void 0 !== i ? i : null } while (null !== s && 1 === s.nodeType); return null } a.text = function (t) { return document.createTextNode(t) }, a.block = function (t, e, n) { var r = a(t, e, [n.html()]); return n.setDOM(r), w.linkElementByBlockNode(r, n), r }, a.entityText = function (t) { var e = s(t); return i("entity parses to a single text node", e instanceof DocumentFragment && 1 === e.childNodes.length && e.childNodes[0] instanceof Text), e.childNodes[0] }; var l = "â"; function u(t) { return t.getClientRects().length ? t.getBoundingClientRect() : { top: 0, left: 0, height: 0, width: 0, x: 0, y: 0, bottom: 0, right: 0 } } var p, h, d = ("function" == typeof requestAnimationFrame && "function" == typeof cancelAnimationFrame ? (p = requestAnimationFrame, h = cancelAnimationFrame) : (p = function (t) { return setTimeout(t, 13) }, h = clearTimeout), function (t, e) { var n, r = Date.now(), i = 0; function o() { var n = (Date.now() - r) / t; n <= i ? a() : i = n, e(i, a, s) } function s() { void 0 !== n && h(n), n = void 0 } function a() { s(), n = p(o) } e(t <= 0 ? 1 : 0, a, s) }), f = function () { function e(t) { this.span = a("span", { class: "dcg-mq-aria-alert", "aria-live": "assertive", "aria-atomic": "true" }), this.msg = "", this.items = [], this.controller = t } return e.prototype.attach = function () { var t = this.controller.container; this.span.parentNode !== t && m(t).prepend(m(this.span)) }, e.prototype.queue = function (t, e) { void 0 === e && (e = !1); var n = ""; if (t instanceof K) { var r = t.mathspeak({ ignoreShorthand: !0 }); e && (t.parent && t.parent.ariaLabel && "block" === t.ariaLabel ? n = t.parent.ariaLabel + " " + r : t.ariaLabel && (n = t.ariaLabel + " " + r)), "" === n && (n = r) } else n = t || ""; return this.items.push(n), this }, e.prototype.queueDirOf = function (e) { return o(e), this.queue(e === t ? "before" : "after") }, e.prototype.queueDirEndOf = function (e) { return o(e), this.queue(e === t ? "beginning of" : "end of") }, e.prototype.alert = function (t) { return this.attach(), t && this.queue(t), this.items.length && (this.msg = this.items.join(" ").replace(/ +(?= )/g, "").trim(), this.controller.containerHasFocus() && (this.span.textContent = this.msg)), this.clear() }, e.prototype.clear = function () { return this.items.length = 0, this }, e }(), m = function () { function e(e, n) { var r; 1 === arguments.length && (n = e), e && n && (this.ends = ((r = {})[t] = e, r[1] = n, r)) } return e.create = function (t, n) { 1 === arguments.length && (n = t), i("No half-empty DOMFragments", !!t == !!n); var r = new e(t, n); return i("last is a forward sibling of first", r.isValid()), r }, e.prototype.isEmpty = function () { return void 0 === this.ends }, e.prototype.isOneNode = function () { return !(!this.ends || this.ends[t] !== this.ends[1]) }, e.prototype.isValid = function () { return !this.ends || (this.ends[t] === this.ends[1] || (this.eachNode(function (t) { return e = t }), e === this.ends[1])); var e }, e.prototype.firstNode = function () { return i("Fragment is not empty", this.ends), this.ends[t] }, e.prototype.lastNode = function () { return i("Fragment is not empty", this.ends), this.ends[1] }, e.prototype.children = function () { var t = this.oneNode(), n = t.firstChild, r = t.lastChild; return n && r ? new e(n, r) : new e }, e.prototype.join = function (n) { if (!this.ends) return n; if (!n.ends) return this; for (var r = !1, o = this.ends[1].nextSibling; o;) { if (o === n.ends[t]) { r = !0; break } o = o.nextSibling } return i("sibling must be a forward DOM sibling of this fragment", r), new e(this.ends[t], n.ends[1]) }, e.prototype.oneNode = function () { return i("Fragment has a single node", this.ends && this.ends[t] === this.ends[1]), this.ends[t] }, e.prototype.oneElement = function () { var t = this.oneNode(); return i("Node is an Element", t.nodeType === Node.ELEMENT_NODE), t }, e.prototype.oneText = function () { var t = this.oneNode(); return i("Node is Text", t.nodeType === Node.TEXT_NODE), t }, e.prototype.eachNode = function (e) { if (!this.ends) return this; for (var n = this.ends[1], r = this.ends[t], i = void 0; r && (i = r.nextSibling, e(r), r !== n); r = i); return this }, e.prototype.eachElement = function (t) { return this.eachNode(function (e) { e.nodeType === Node.ELEMENT_NODE && t(e) }), this }, e.prototype.text = function () { var t = ""; return this.eachNode(function (e) { t += e.textContent || "" }), t }, e.prototype.toNodeArray = function () { var t = []; return this.eachNode(function (e) { return t.push(e) }), t }, e.prototype.toElementArray = function () { var t = []; return this.eachElement(function (e) { return t.push(e) }), t }, e.prototype.toDocumentFragment = function () { var t = document.createDocumentFragment(); return this.eachNode(function (e) { return t.appendChild(e) }), t }, e.prototype.insertBefore = function (e) { return this.insDirOf(t, e) }, e.prototype.insertAfter = function (t) { return this.insDirOf(1, t) }, e.prototype.append = function (t) { return t.appendTo(this.oneElement()), this }, e.prototype.prepend = function (t) { return t.prependTo(this.oneElement()), this }, e.prototype.appendTo = function (t) { return this.insAtDirEnd(1, t) }, e.prototype.prependTo = function (e) { return this.insAtDirEnd(t, e) }, e.prototype.parent = function () { if (!this.ends) return this; var n = this.ends[t].parentNode; return n ? new e(n) : new e }, e.prototype.wrapAll = function (e) { if (e.textContent = "", !this.ends) return this; var n = this.ends[t].parentNode, r = this.ends[1].nextSibling; return this.appendTo(e), n && n.insertBefore(e, r), this }, e.prototype.replaceWith = function (t) { var e, n = null === (e = this.ends) || void 0 === e ? void 0 : e[1], r = null == n ? void 0 : n.parentNode, i = null == n ? void 0 : n.nextSibling; this.detach(); var o = t.toDocumentFragment(); return n && r ? (r.insertBefore(o, i || null), this) : this }, e.prototype.nthElement = function (e) { if (this.ends && !(e < 0 || e !== Math.floor(e))) for (var n = this.ends[t]; n;) { if (n.nodeType === Node.ELEMENT_NODE) { if (e <= 0) return n; e -= 1 } if (n === this.ends[1]) return; n = n.nextSibling } }, e.prototype.firstElement = function () { return this.nthElement(0) }, e.prototype.lastElement = function () { if (this.ends) for (var e = this.ends[1]; e;) { if (e.nodeType === Node.ELEMENT_NODE) return e; if (e === this.ends[t]) return; e = e.previousSibling } }, e.prototype.first = function () { return new e(this.firstElement()) }, e.prototype.last = function () { return new e(this.lastElement()) }, e.prototype.eq = function (t) { return new e(this.nthElement(t)) }, e.prototype.slice = function (t) { if (!this.ends) return this; var n = this.nthElement(t); return n ? new e(n, this.ends[1]) : new e }, e.prototype.next = function () { for (var t = this.oneNode(); t;)if ((t = t.nextSibling) && t.nodeType === Node.ELEMENT_NODE) return new e(t); return new e }, e.prototype.prev = function () { for (var t = this.oneNode(); t;)if ((t = t.previousSibling) && t.nodeType === Node.ELEMENT_NODE) return new e(t); return new e }, e.prototype.empty = function () { return this.eachElement(function (t) { t.textContent = "" }), this }, e.prototype.remove = function () { return this.toDocumentFragment(), this }, e.prototype.detach = function () { return this.remove() }, e.prototype.insDirOf = function (e, n) { var r; if (!this.ends) return this; var i = null === (r = n.ends) || void 0 === r ? void 0 : r[e]; return i && i.parentNode ? (function (e, n, r, i) { n.insertBefore(r, e === t ? i : i.nextSibling) }(e, i.parentNode, this.toDocumentFragment(), i), this) : this.detach() }, e.prototype.insAtDirEnd = function (e, n) { return this.ends ? (function (e, n, r) { e === t ? r.insertBefore(n, r.firstChild) : r.appendChild(n) }(e, this.toDocumentFragment(), n), this) : this }, e.prototype.hasClass = function (t) { var e = !1; return this.eachElement(function (n) { n.classList.contains(t) && (e = !0) }), e }, e.prototype.addClass = function (t) { for (var e = function (t) { if (!t) return "continue"; n.eachElement(function (e) { e.classList.add(t) }) }, n = this, r = 0, i = t.split(/\s+/); r < i.length; r++) { e(i[r]) } return this }, e.prototype.removeClass = function (t) { for (var e = function (t) { if (!t) return "continue"; n.eachElement(function (e) { e.classList.remove(t) }) }, n = this, r = 0, i = t.split(/\s+/); r < i.length; r++) { e(i[r]) } return this }, e.prototype.toggleClass = function (t, e) { if (!0 === e) return this.addClass(t); if (!1 === e) return this.removeClass(t); for (var n = function (t) { if (!t) return "continue"; r.eachElement(function (e) { e.classList.toggle(t) }) }, r = this, i = 0, o = t.split(/\s+/); i < o.length; i++) { n(o[i]) } return this }, e }().create; var g = function () { function e(t, e, n) { this.init(t, e, n) } return e.prototype.init = function (e, n, r) { this.parent = e, this[t] = n, this[1] = r }, e.copy = function (n) { return new e(n.parent, n[t], n[1]) }, e }(); function v(e, n) { var r = e[t]; if (r) { var i = e[1]; if (i) for (i = i[1]; r !== i; r = r[1]) { if (!1 === n(r)) break } } } function y(e, n, r) { var i = e[t]; if (!i) return n; var o = e[1]; if (!o) return n; for (o = o[1]; i !== o; i = i[1])n = r(n, i); return n } var w = function () { function e() { var i; this[n] = 0, this[r] = 0, this.parent = 0, this.ends = ((i = {})[t] = 0, i[1] = 0, i), this.id = e.uniqueNodeId() } var n, r; return e.uniqueNodeId = function () { return e.idCounter += 1 }, e.getNodeOfElement = function (t) { if (t) { if (!t.nodeType) throw new Error("must pass an Element to NodeBase.getNodeOfElement"); var e = t; return e.mqBlockNode || e.mqCmdNode } }, e.linkElementByBlockNode = function (t, e) { t.mqBlockNode = e }, e.linkElementByCmdNode = function (t, e) { t.mqCmdNode = e }, e.prototype.setEnds = function (e) { this.ends = e, i("No half-empty node ends", !!this.ends[t] == !!this.ends[1]) }, e.prototype.getEnd = function (t) { return this.ends[t] }, e.prototype.toString = function () { return "{{ MathQuill Node #" + this.id + " }}" }, e.prototype.setDOM = function (t) { return t && i("DOM is an element or a text node", t.nodeType === Node.ELEMENT_NODE || t.nodeType === Node.TEXT_NODE), this._el = t, this }, e.prototype.domFrag = function () { return m(this._el) }, e.prototype.createDir = function (e, n) { o(e); var r = this; return r.html(), r.domFrag().insDirOf(e, n.domFrag()), n[e] = r.adopt(n.parent, n[t], n[1]), r }, e.prototype.createLeftOf = function (e) { this.createDir(t, e) }, e.prototype.selectChildren = function (t, e) { return new O(t, e) }, e.prototype.bubble = function (t) { for (var e = this.getSelfNode(); e; e = e.parent) { if (!1 === t(e)) break } return this }, e.prototype.postOrder = function (t) { var e = this.getSelfNode(); return function e(n) { return !!n && (n.eachChild(e), t(n), !0) }(e), e }, e.prototype.isEmpty = function () { return 0 === this.ends[t] && 0 === this.ends[1] }, e.prototype.isQuietEmptyDelimiter = function (t) { if (!this.isEmpty()) return !1; if (!t) return !1; if (!this.parent || void 0 === this.parent.ctrlSeq) return !1; var e = this.parent.ctrlSeq.replace(/^\\(left|right)?/, ""); return t.hasOwnProperty(e) }, e.prototype.isStyleBlock = function () { return !1 }, e.prototype.isTextBlock = function () { return !1 }, e.prototype.children = function () { return new x(this.getEnd(t), this.getEnd(1)) }, e.prototype.eachChild = function (t) { return v(this.ends, t), this }, e.prototype.foldChildren = function (t, e) { return y(this.ends, t, e) }, e.prototype.withDirAdopt = function (t, e, n, r) { var i = this.getSelfNode(); return new x(i, i).withDirAdopt(t, e, n, r), this }, e.prototype.adopt = function (t, e, n) { var r = this.getSelfNode(); return new x(r, r).adopt(t, e, n), this.getSelfNode() }, e.prototype.disown = function () { var t = this.getSelfNode(); return new x(t, t).disown(), this }, e.prototype.remove = function () { return this.domFrag().remove(), this.disown() }, e.prototype.shouldIgnoreSubstitutionInSimpleSubscript = function (t) { return !!t.disableAutoSubstitutionInSubscripts && (!!this.parent && (this.parent.parent instanceof Pt && !!this.parent.domFrag().hasClass("dcg-mq-sub"))) }, e.prototype.getSelfNode = function () { return this }, e.prototype.parser = function () { i("Abstract parser() method is never called", !1) }, e.prototype.html = function () { throw new Error("html() unimplemented in NodeBase") }, e.prototype.text = function () { return "" }, e.prototype.latex = function () { var t = { latex: "", startIndex: -1, endIndex: -1 }; return this.latexRecursive(t), t.latex }, e.prototype.latexRecursive = function (t) { }, e.prototype.checkCursorContextOpen = function (t) { t.startSelectionBefore === this && (t.startIndex = t.latex.length), t.endSelectionBefore === this && (t.endIndex = t.latex.length) }, e.prototype.checkCursorContextClose = function (t) { t.startSelectionAfter === this && (t.startIndex = t.latex.length), t.endSelectionAfter === this && (t.endIndex = t.latex.length) }, e.prototype.finalizeTree = function (t, e) { }, e.prototype.contactWeld = function (t, e) { }, e.prototype.blur = function (t) { }, e.prototype.focus = function () { }, e.prototype.intentionalBlur = function () { }, e.prototype.reflow = function () { }, e.prototype.registerInnerField = function (t, e) { }, e.prototype.chToCmd = function (t, e) { i("Abstract chToCmd() method is never called", !1) }, e.prototype.mathspeak = function (t) { return "" }, e.prototype.seek = function (t, e) { }, e.prototype.siblingDeleted = function (t, e) { }, e.prototype.siblingCreated = function (t, e) { }, e.prototype.finalizeInsert = function (t, e) { }, e.prototype.fixDigitGrouping = function (t) { }, e.prototype.writeLatex = function (t, e) { }, e.prototype.write = function (t, e) { }, n = t, r = 1, e.idCounter = 0, e }(); function b(e, n, r) { i("a parent is always present", e), i("leftward is properly set up", n ? n[1] === r && n.parent === e : e.getEnd(t) === r), i("rightward is properly set up", r ? r[t] === n && r.parent === e : e.getEnd(1) === n) } var x = function () { function e(e, n, r) { var s, a; if (this.disowned = !1, void 0 === r && (r = t), o(r), i("no half-empty fragments", !e == !n), e && n) { i("withDir is passed to Fragment", e instanceof K), i("oppDir is passed to Fragment", n instanceof K), i("withDir and oppDir have the same parent", e.parent === n.parent); var c = ((a = {})[r] = e, a[-r] = n, a); this.setEnds(c); var l = 0; this.each(function (t) { l = t }), i("following direction siblings from start reaches end", l === c[1]) } else this.setEnds(((s = {})[t] = 0, s[1] = 0, s)) } return e.prototype.getDOMFragFromEnds = function () { var e = this.ends[t], n = this.ends[1]; return 0 === e || 0 === n ? m() : e === n ? e.domFrag() : e.domFrag().join(n.domFrag()) }, e.prototype.setEnds = function (t) { this.ends = t }, e.prototype.getEnd = function (t) { return this.ends ? this.ends[t] : 0 }, e.prototype.domFrag = function () { return this.getDOMFragFromEnds() }, e.prototype.withDirAdopt = function (e, n, r, i) { return e === t ? this.adopt(n, r, i) : this.adopt(n, i, r) }, e.prototype.adopt = function (e, n, r) { var i; b(e, n, r); var o = this; this.disowned = !1; var s = o.ends[t]; if (!s) return this; var a = o.ends[1]; if (!a) return this; var c = ((i = {})[t] = e.getEnd(t), i[1] = e.getEnd(1), i); return n || (c[t] = s), r ? r[t] = a : c[1] = a, e.setEnds(c), a[1] = r, o.each(function (r) { return r[t] = n, r.parent = e, n && (n[1] = r), n = r, !0 }), o }, e.prototype.disown = function () { var e, n = this, r = n.ends[t]; if (!r || n.disowned) return n; this.disowned = !0; var i = n.ends[1]; if (!i) return n; var o = r.parent; b(o, r[t], r), b(o, i, i[1]); var s = ((e = {})[t] = o.getEnd(t), e[1] = o.getEnd(1), e); r[t] ? r[t][1] = i[1] : s[t] = i[1]; i[1] ? i[1][t] = r[t] : s[1] = r[t]; return s[t] && s[1] ? o.setEnds(s) : o.ends = s, n }, e.prototype.remove = function () { return this.domFrag().remove(), this.disown() }, e.prototype.each = function (t) { return v(this.ends, t), this }, e.prototype.fold = function (t, e) { return y(this.ends, t, e) }, e }(), E = {}, k = {}; function q(t) { return t && t.prototype instanceof K } var _, L = function (e) { function n(t, n, r) { var i = e.call(this, t, n, r) || this; return i.ancestors = {}, i } return __extends(n, e), n.fromCursor = function (e) { return new n(e.parent, e[t], e[1]) }, n }(g), S = function (e) { function n(t, n, r) { var i = e.call(this, t, 0, 0) || this; return i.upDownCache = {}, i.cursorElement = a("span", { class: "dcg-mq-cursor" }, [a.text(l)]), i._domFrag = m(), i.controller = r, i.options = n, i.setDOMFrag(m(i.cursorElement)), i.blink = function () { m(i.cursorElement).toggleClass("dcg-mq-blink") }, i } return __extends(n, e), n.prototype.setDOMFrag = function (t) { return this._domFrag = t, this }, n.prototype.domFrag = function () { return this._domFrag }, n.prototype.show = function () { if (m(this.cursorElement).removeClass("dcg-mq-blink"), this.setDOMFrag(m(this.cursorElement)), this.intervalId) clearInterval(this.intervalId); else { var e = this[1]; if (e) { var n = this.selection; n && n.getEnd(t)[t] === this[t] ? this.domFrag().insertBefore(n.domFrag()) : this.domFrag().insertBefore(e.domFrag()) } else this.domFrag().appendTo(this.parent.domFrag().oneElement()); this.parent.focus() } return this.intervalId = setInterval(this.blink, 500), this }, n.prototype.hide = function () { return this.intervalId && clearInterval(this.intervalId), this.intervalId = 0, this.domFrag().detach(), this.setDOMFrag(m()), this }, n.prototype.withDirInsertAt = function (t, e, n, r) { var i = this.parent; this.parent = e, this[t] = n, this[-t] = r, i !== e && i.blur && i.blur(this) }, n.prototype.insDirOf = function (t, e) { return o(t), this.domFrag().insDirOf(t, e.domFrag()), this.withDirInsertAt(t, e.parent, e[t], e), this.parent.domFrag().addClass("dcg-mq-hasCursor"), this }, n.prototype.insLeftOf = function (e) { return this.insDirOf(t, e) }, n.prototype.insRightOf = function (t) { return this.insDirOf(1, t) }, n.prototype.insAtDirEnd = function (t, e) { return o(t), this.domFrag().insAtDirEnd(t, e.domFrag().oneElement()), this.withDirInsertAt(t, e, 0, e.getEnd(t)), e.focus(), this }, n.prototype.insAtLeftEnd = function (e) { return this.insAtDirEnd(t, e) }, n.prototype.insAtRightEnd = function (t) { return this.insAtDirEnd(1, t) }, n.prototype.jumpUpDown = function (t, e) { var n = this; n.upDownCache[t.id] = g.copy(n); var r = n.upDownCache[e.id]; if (r) { var i = r[1]; i ? n.insLeftOf(i) : n.insAtRightEnd(r.parent) } else { var o = n.getBoundingClientRectWithoutMargin().left; e.seek(o, n) } n.controller.aria.queue(e, !0) }, n.prototype.getBoundingClientRectWithoutMargin = function () { var t = this.domFrag(); t.removeClass("dcg-mq-cursor"); var e = u(t.oneElement()), n = e.left, r = e.right; return t.addClass("dcg-mq-cursor"), { left: n, right: r } }, n.prototype.unwrapGramp = function () { var e = this.parent.parent, n = e.parent, r = e[1], i = e[t]; if (e.disown().eachChild(function (t) { return t.isEmpty() || (t.children().adopt(n, i, r).each(function (t) { return t.domFrag().insertBefore(e.domFrag()), !0 }), i = t.getEnd(1)), !0 }), !this[1]) { var o = this[t]; if (o) this[1] = o[1]; else for (; !this[1];) { var s = this.parent[1]; if (!s) { this[1] = e[1], this.parent = n; break } this.parent = s, this[1] = s.getEnd(t) } } var a = this[1]; a ? this.insLeftOf(a) : this.insAtRightEnd(n), e.domFrag().remove(); var c = e[t], l = e[1]; c && c.siblingDeleted(this.options, 1), l && l.siblingDeleted(this.options, t) }, n.prototype.startSelection = function () { for (var t = this.anticursor = L.fromCursor(this), e = t.ancestors, n = t; n.parent; n = n.parent)e[n.parent.id] = n }, n.prototype.endSelection = function () { delete this.anticursor }, n.prototype.select = function () { var e, n = this.anticursor; if (this[t] === n[t] && this.parent === n.parent) return !1; for (var r = this; r.parent; r = r.parent)if (r.parent.id in n.ancestors) { e = r.parent; break } i("cursor and anticursor in the same tree", e); var o, s, a = e, c = n.ancestors[a.id], l = 1; if (r[t] !== c) for (var u = r; u; u = u[1])if (u[1] === c[1]) { l = t, o = r, s = c; break } 1 === l && (o = c, s = r), o instanceof g && (o = o[1]), s instanceof g && (s = s[t]), this.hide().selection = a.selectChildren(o, s); var p = this.selection.getEnd(l); return this.insDirOf(l, p), this.selectionChanged(), !0 }, n.prototype.resetToEnd = function (e) { this.clearSelection(); var n = e.root; this[1] = 0, this[t] = n.getEnd(1), this.parent = n }, n.prototype.clearSelection = function () { return this.selection && (this.selection.clear(), delete this.selection, this.selectionChanged()), this }, n.prototype.deleteSelection = function () { var e = this.selection; e && (this[t] = e.getEnd(t)[t], this[1] = e.getEnd(1)[1], e.remove(), this.selectionChanged(), delete this.selection) }, n.prototype.replaceSelection = function () { var e = this.selection; return e && (this[t] = e.getEnd(t)[t], this[1] = e.getEnd(1)[1], delete this.selection), e }, n.prototype.depth = function () { for (var t = this, e = 0; t = t.parent;)e += t instanceof ht ? 1 : 0; return e }, n.prototype.isTooDeep = function (t) { return void 0 !== this.options.maxDepth && this.depth() + (t || 0) > this.options.maxDepth }, n.prototype.selectionChanged = function () { }, n }(g), O = function (e) { function n(t, n, r) { var i = e.call(this, t, n, r) || this; return i._el = a("span", { class: "dcg-mq-selection" }), i.getDOMFragFromEnds().wrapAll(i._el), i } return __extends(n, e), n.prototype.isCleared = function () { return void 0 === this._el }, n.prototype.domFrag = function () { return this.isCleared() ? this.getDOMFragFromEnds() : m(this._el) }, n.prototype.setEnds = function (e) { i("Selection ends are never empty", e[t] && e[1]), this.ends = e }, n.prototype.getEnd = function (t) { return this.ends[t] }, n.prototype.adopt = function (t, n, r) { return this.clear(), e.prototype.adopt.call(this, t, n, r) }, n.prototype.clear = function () { var t = this.getDOMFragFromEnds(); return this.domFrag().replaceWith(t), this._el = void 0, this }, n.prototype.join = function (t, e) { return void 0 === e && (e = ""), this.fold("", function (n, r) { return n + e + r[t]() }) }, n }(x), T = function () { function e(t, e, n) { this.textareaEventListeners = {}, this.id = t.id, this.data = {}, this.root = t, this.container = e, this.options = n, this.aria = new f(this.getControllerSelf()), this.ariaLabel = "Math Input", this.ariaPostLabel = "", t.controller = this.getControllerSelf(), this.cursor = t.cursor = new S(t, n, this.getControllerSelf()) } return e.prototype.getControllerSelf = function () { return this }, e.prototype.handle = function (e, n) { var r, o = this.options.handlers, s = null === (r = this.options.handlers) || void 0 === r ? void 0 : r.fns[e]; if (s) { var a = null == o ? void 0 : o.APIClasses[this.KIND_OF_MQ]; i("APIClass is defined", a); var c = new a(this); n === t || 1 === n ? s(n, c) : s(c) } }, e.onNotify = function (t) { e.notifyees.push(t) }, e.prototype.notify = function (t) { for (var n = 0; n < e.notifyees.length; n += 1)e.notifyees[n](this.cursor, t); return this }, e.prototype.setAriaLabel = function (t) { var e = this.getAriaLabel(); return t && "string" == typeof t && "" !== t ? this.ariaLabel = t : this.editable ? this.ariaLabel = "Math Input" : this.ariaLabel = "", this.ariaLabel === e || this.containerHasFocus() || this.updateMathspeak(), this }, e.prototype.getAriaLabel = function () { return "Math Input" !== this.ariaLabel ? this.ariaLabel : this.editable ? "Math Input" : "" }, e.prototype.setAriaPostLabel = function (t, e) { var n = this; return t && "string" == typeof t && "" !== t ? (t !== this.ariaPostLabel && "number" == typeof e && (this._ariaAlertTimeout && clearTimeout(this._ariaAlertTimeout), this._ariaAlertTimeout = setTimeout(function () { n.containerHasFocus() ? n.aria.alert(n.root.mathspeak().trim() + " " + t.trim()) : n.updateMathspeak() }, e)), this.ariaPostLabel = t) : (this._ariaAlertTimeout && clearTimeout(this._ariaAlertTimeout), this.ariaPostLabel = ""), this }, e.prototype.getAriaPostLabel = function () { return this.ariaPostLabel || "" }, e.prototype.containerHasFocus = function () { return document.activeElement && this.container.contains(document.activeElement) }, e.prototype.getTextareaOrThrow = function () { var t = this.textarea; if (!t) throw new Error("expected a textarea"); return t }, e.prototype.getTextareaSpanOrThrow = function () { var t = this.textareaSpan; if (!t) throw new Error("expected a textareaSpan"); return t }, e.prototype.addTextareaEventListeners = function (t) { if (this.textarea) for (var e in t) { var n = e; this.removeTextareaEventListener(n), this.textarea.addEventListener(n, t[n]) } }, e.prototype.removeTextareaEventListener = function (t) { if (this.textarea) { var e = this.textareaEventListeners[t]; e && this.textarea.removeEventListener(t, e) } }, e.prototype.exportMathSpeak = function () { return this.root.mathspeak() }, e.prototype.updateMathspeak = function () { }, e.prototype.scrollHoriz = function () { }, e.prototype.selectionChanged = function () { }, e.prototype.setOverflowClasses = function () { }, e.notifyees = [], e }(), C = {}, F = {}, D = {}, A = function () { function t(t) { this.version = t } return t.prototype.assertJquery = function () { return i("Interface versions > 2 do not depend on JQuery", this.version <= 2), i("JQuery is set for interface v < 3", this.jQuery), this.jQuery }, t }(), M = function () { }, N = function () { window.console && console.warn('You are using the MathQuill API without specifying an interface version, which will fail in v1.0.0. Easiest fix is to do the following before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014â2015) â v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide') }; function I(t) { return N(), _ || (_ = z(1)), _(t) } I.prototype = M.prototype, I.VERSION = "v0.10.1", I.interfaceVersion = function (t) { if (1 !== t) throw "Only interface version 1 supported. You specified: " + t; return (N = function () { window.console && console.warn('You called MathQuill.interfaceVersion(1); to specify the interface version, which will fail in v1.0.0. You can fix this easily by doing this before doing anything else:\n\n    MathQuill = MathQuill.getInterface(1);\n    // now MathQuill.MathField() works like it used to\n\nSee also the "`dev` branch (2014â2015) â v0.10.0 Migration Guide" at\n  https://github.com/mathquill/mathquill/wiki/%60dev%60-branch-(2014%E2%80%932015)-%E2%86%92-v0.10.0-Migration-Guide') })(), I }, I.getInterface = z; var B = z.MIN = 1, R = z.MAX = 3; function z(e) { if (1 !== e && 2 !== e && 3 !== e) throw "Only interface versions between " + B + " and " + R + " supported. You specified: " + e; var n = e; if (n < 3) { var r = window.jQuery; if (!r) throw "MathQuill interface version ".concat(n, " requires jQuery 1.5.2+ to be loaded first"); A.prototype.jQuery = r } var o = __assign(__assign({}, D), { handlers: function (t) { return { fns: t || {}, APIClasses: p } } }); function s(t, e) { for (var r in e) if (e.hasOwnProperty(r)) { if ("substituteKeyboardEvents" === r && n >= 3) throw new Error(["As of interface version 3, the 'substituteKeyboardEvents'", "option is no longer supported. Use 'overrideTypedText' and", "'overrideKeystroke' instead."].join(" ")); var i = e[r], s = o[r]; t[r] = s ? s(i) : i } } var c = n < 3 ? A : function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e }(A), l = function (t) { function e(e) { var n = t.call(this) || this; return n.__controller = e, n.__options = e.options, n.id = e.id, n.data = e.data, n } return __extends(e, t), e.prototype.mathquillify = function (t) { var e = this.__controller, r = e.root, i = e.container; e.createTextarea(); var o = m(i).addClass(t).children().detach(); r.setDOM(m(a("span", { class: "dcg-mq-root-block", "aria-hidden": !0 })).appendTo(i).oneElement()), w.linkElementByBlockNode(r.domFrag().oneElement(), r), this.latex(o.text()), this.revert = function () { return e.removeMouseEventListener(), m(i).removeClass("dcg-mq-editable-field dcg-mq-math-mode dcg-mq-text-mode").empty().append(o), n < 3 ? this.__options.assertJquery()(i) : i } }, e.prototype.setAriaLabel = function (t) { return this.__controller.setAriaLabel(t), this }, e.prototype.getAriaLabel = function () { return this.__controller.getAriaLabel() }, e.prototype.config = function (t) { return s(this.__options, t), this }, e.prototype.el = function () { return this.__controller.container }, e.prototype.text = function () { return this.__controller.exportText() }, e.prototype.mathspeak = function () { return this.__controller.exportMathSpeak() }, e.prototype.latex = function (t) { if (arguments.length > 0) { this.__controller.renderLatexMath(t); var e = this.__controller.cursor; return this.__controller.blurred && e.hide().parent.blur(e), this } return this.__controller.exportLatex() }, e.prototype.selection = function () { return this.__controller.exportLatexSelection() }, e.prototype.html = function () { return this.__controller.root.domFrag().oneElement().innerHTML.replace(/ jQuery\d+="(?:\d+|null)"/g, "").replace(/ mathquill-(?:command|block)-id="?\d+"?/g, "").replace(/<span class="?dcg-mq-cursor( dcg-mq-blink)?"?>.?<\/span>/i, "").replace(/ dcg-mq-hasCursor|dcg-mq-hasCursor ?/, "").replace(/ class=(""|(?= |>))/g, "") }, e.prototype.reflow = function () { return this.__controller.root.postOrder(function (t) { t.reflow() }), this }, e }(M), u = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.mathquillify = function (t) { return e.prototype.mathquillify.call(this, t), this.__controller.editable = !0, this.__controller.addMouseEventListener(), this.__controller.editablesTextareaEvents(), this }, n.prototype.focus = function () { return this.__controller.getTextareaOrThrow().focus(), this.__controller.scrollHoriz(), this }, n.prototype.blur = function () { return this.__controller.getTextareaOrThrow().blur(), this }, n.prototype.write = function (t) { this.__controller.writeLatex(t), this.__controller.scrollHoriz(); var e = this.__controller.cursor; return this.__controller.blurred && e.hide().parent.blur(e), this }, n.prototype.empty = function () { var e, n = this.__controller.root, r = this.__controller.cursor; return n.setEnds(((e = {})[t] = 0, e[1] = 0, e)), n.domFrag().empty(), delete r.selection, r.insAtRightEnd(n), this }, n.prototype.cmd = function (t) { var e = this.__controller.notify(void 0), n = e.cursor; if (/^\\[a-z]+$/i.test(t) && !n.isTooDeep()) { t = t.slice(1); var r, i = E[t]; i && (r = i.constructor ? new i(t) : i(t), n.selection && r.replaces(n.replaceSelection()), r.createLeftOf(n.show())) } else n.parent.write(n, t); return e.scrollHoriz(), e.blurred && n.hide().parent.blur(n), this }, n.prototype.select = function () { return this.__controller.selectAll(), this }, n.prototype.clearSelection = function () { return this.__controller.cursor.clearSelection(), this }, n.prototype.moveToDirEnd = function (t) { return this.__controller.notify("move").cursor.insAtDirEnd(t, this.__controller.root), this }, n.prototype.moveToLeftEnd = function () { return this.moveToDirEnd(t) }, n.prototype.moveToRightEnd = function () { return this.moveToDirEnd(1) }, n.prototype.keystroke = function (t, e) { for (var n = t.replace(/^\s+|\s+$/g, "").split(/\s+/), r = 0; r < n.length; r += 1)this.__controller.keystroke(n[r], e); return this }, n.prototype.typedText = function (t) { for (var e = 0; e < t.length; e += 1)this.__controller.typedText(t.charAt(e)); return this }, n.prototype.dropEmbedded = function (t, e, n) { var r = t - (void 0 !== window.pageXOffset ? window.pageXOffset : (document.documentElement || document.body.parentNode || document.body).scrollLeft), i = e - (void 0 !== window.pageYOffset ? window.pageYOffset : (document.documentElement || document.body.parentNode || document.body).scrollTop), o = document.elementFromPoint(r, i); this.__controller.seek(o, r, i), (new se).setOptions(n).createLeftOf(this.__controller.cursor) }, n.prototype.setAriaPostLabel = function (t, e) { return this.__controller.setAriaPostLabel(t, e), this }, n.prototype.getAriaPostLabel = function () { return this.__controller.getAriaPostLabel() }, n.prototype.clickAt = function (t, e, n) { n = n || document.elementFromPoint(t, e); var r = this.__controller, i = r.root.domFrag().oneElement(); return i.contains(n) || (n = i), r.seek(n, t, e), r.blurred && this.focus(), this }, n.prototype.ignoreNextMousedown = function (t) { return this.__controller.cursor.options.ignoreNextMousedown = t, this }, n }(l), p = { AbstractMathQuill: l, EditableField: u }; i("API.StaticMath defined", C.StaticMath), p.StaticMath = C.StaticMath(p), i("API.MathField defined", C.MathField), p.MathField = C.MathField(p), i("API.InnerMathField defined", C.InnerMathField), p.InnerMathField = C.InnerMathField(p), C.TextField && (p.TextField = C.TextField(p)); var h = function (t) { if (!t || !t.nodeType) return null; for (var e, n = 0, r = m(t).children().toElementArray(); n < r.length; n++) { var i = r[n]; if (i.classList.contains("dcg-mq-root-block")) { e = i; break } } var o = w.getNodeOfElement(e), s = o && o.controller, a = s && p[s.KIND_OF_MQ]; return s && a ? new a(s) : null }; function d(t, e) { function r(r, i) { if (!r || !r.nodeType) return null; var o = h(r); if (o instanceof e) return o; var s = new rt(new e.RootBlock, r, new c(n)); return s.KIND_OF_MQ = t, new e(s).__mathquillify(i || {}, n) } return i(t + " is defined", e), r.prototype = e.prototype, r } return h.L = t, h.R = 1, h.config = function (t) { return s(c.prototype, t), this }, h.registerEmbed = function (t, e) { if (!/^[a-z][a-z0-9]*$/i.test(t)) throw "Embed name must start with letter and be only letters and digits"; F[t] = e }, h.StaticMath = d("StaticMath", p.StaticMath), h.MathField = d("MathField", p.MathField), h.InnerMathField = d("InnerMathField", p.InnerMathField), p.TextField && (h.TextField = d("TextField", p.TextField)), h.prototype = l.prototype, (h.EditableField = function () { throw "wtf don't call me, I'm 'abstract'" }).prototype = u.prototype, n < 3 && (h.saneKeyboardEvents = nt), h } I.noConflict = function () { return window.MathQuill = P, I }; var P = window.MathQuill; function H(t) { t.moveOutOf = function (t) { i("controller is defined", this.controller), this.controller.handle("moveOutOf", t) }, t.deleteOutOf = function (t) { i("controller is defined", this.controller), this.controller.handle("deleteOutOf", t) }, t.selectOutOf = function (t) { i("controller is defined", this.controller), this.controller.handle("selectOutOf", t) }, t.upOutOf = function () { i("controller is defined", this.controller), this.controller.handle("upOutOf") }, t.downOutOf = function () { i("controller is defined", this.controller), this.controller.handle("downOutOf") }, t.reflow = function () { i("controller is defined", this.controller), this.controller.handle("reflow"), this.controller.handle("edited"), this.controller.handle("edit") } } function V(t, e) { throw "Parse Error: " + e + " at " + (t = t ? "'" + t + "'" : "EOF") } window.MathQuill = I; var j = function () { function t(t) { this._ = t } return t.prototype.parse = function (e) { return this.skip(t.eof)._("" + e, function (t, e) { return e }, V) }, t.prototype.or = function (e) { i("or is passed a parser", e instanceof t); var n = this; return new t(function (t, r, i) { return n._(t, r, function (n) { return e._(t, r, i) }) }) }, t.prototype.then = function (e) { var n = this; return new t(function (r, o, s) { return n._(r, function (n, r) { var a = e instanceof t ? e : e(r); return i("a parser is returned", a instanceof t), a._(n, o, s) }, s) }) }, t.prototype.many = function () { var e = this; return new t(function (t, n, r) { for (var i = []; e._(t, o, s);); return n(t, i); function o(e, n) { return t = e, i.push(n), !0 } function s() { return !1 } }) }, t.prototype.times = function (e, n) { arguments.length < 2 && (n = e); var r = this; return new t(function (t, i, o) { for (var s, a = [], c = !0, l = 0; l < e; l += 1)if (!(c = !!r._(t, u, p))) return o(t, s); for (; l < n && c; l += 1)r._(t, u, h); return i(t, a); function u(e, n) { return a.push(n), t = e, !0 } function p(e, n) { return s = n, t = e, !1 } function h(t, e) { return !1 } }) }, t.prototype.result = function (e) { return this.then(t.succeed(e)) }, t.prototype.atMost = function (t) { return this.times(0, t) }, t.prototype.atLeast = function (t) { var e = this; return e.times(t).then(function (t) { return e.many().map(function (e) { return t.concat(e) }) }) }, t.prototype.map = function (e) { return this.then(function (n) { return t.succeed(e(n)) }) }, t.prototype.skip = function (t) { return this.then(function (e) { return t.result(e) }) }, t.string = function (e) { var n = e.length, r = "expected '" + e + "'"; return new t(function (t, i, o) { var s = t.slice(0, n); return s === e ? i(t.slice(n), s) : o(t, r) }) }, t.regex = function (e) { i("regexp parser is anchored", "^" === e.toString().charAt(1)); var n = "expected " + e; return new t(function (t, r, i) { var o = e.exec(t); if (o) { var s = o[0]; return r(t.slice(s.length), s) } return i(t, n) }) }, t.succeed = function (e) { return new t(function (t, n) { return n(t, e) }) }, t.fail = function (e) { return new t(function (t, n, r) { return r(t, e) }) }, t.letter = t.regex(/^[a-z]/i), t.letters = t.regex(/^[a-z]*/i), t.digit = t.regex(/^[0-9]/), t.digits = t.regex(/^[0-9]*/), t.whitespace = t.regex(/^\s+/), t.optWhitespace = t.regex(/^\s*/), t.any = new t(function (t, e, n) { return t ? e(t.slice(1), t.charAt(0)) : n(t, "expected any character") }), t.all = new t(function (t, e, n) { return e("", t) }), t.eof = new t(function (t, e, n) { return t ? n(t, "expected EOF") : e(t, t) }), t }(), $ = function () { function t() { this.fn = r } return t.prototype.listen = function (t) { this.fn = t, clearTimeout(this.timeoutId), this.timeoutId = setTimeout(this.fn) }, t.prototype.listenOnce = function (t) { var e = this; this.listen(function () { for (var n = [], r = 0; r < arguments.length; r++)n[r] = arguments[r]; e.clearListener(), t.apply(void 0, n) }) }, t.prototype.clearListener = function () { this.fn = r, clearTimeout(this.timeoutId) }, t.prototype.trigger = function () { for (var t = [], e = 0; e < arguments.length; e++)t[e] = arguments[e]; this.fn.apply(this, t) }, t }(), Q = function () { var t = { 8: "Backspace", 9: "Tab", 10: "Enter", 13: "Enter", 16: "Shift", 17: "Control", 18: "Alt", 20: "CapsLock", 27: "Esc", 32: "Spacebar", 33: "PageUp", 34: "PageDown", 35: "End", 36: "Home", 37: "Left", 38: "Up", 39: "Right", 40: "Down", 45: "Insert", 46: "Del", 144: "NumLock" }, e = { ArrowRight: "Right", ArrowLeft: "Left", ArrowDown: "Down", ArrowUp: "Up", Delete: "Del", Escape: "Esc", " ": "Spacebar" }; function n(t) { switch (r(t)) { case "Right": case "Left": case "Down": case "Up": return !0 }return !1 } function r(n) { var r, i; if (void 0 === n.key) { var o = n.which || n.keyCode; return t[o] || String.fromCharCode(o) } return 1 === (i = n.key).length && i >= "a" && i <= "z" ? n.key.toUpperCase() : null !== (r = e[n.key]) && void 0 !== r ? r : n.key } function i(t) { var e = r(t), n = []; return t.ctrlKey && n.push("Ctrl"), t.metaKey && n.push("Meta"), t.altKey && n.push("Alt"), t.shiftKey && n.push("Shift"), n.length ? (n.push(e), n.join("-")) : e } return function (t, e) { var r = null, o = null, s = new $; function a() { try { t instanceof HTMLTextAreaElement && t.select() } catch (t) { } } var c = !1; function l() { e.options && e.options.overrideKeystroke ? e.options.overrideKeystroke(i(r), r) : e.keystroke(i(r), r) } function u(e) { s.trigger(e), e.target === t && (r = e, o = null, c && s.listenOnce(function (t) { t && "focusout" === t.type || a() }), l()) } function p(e) { s.trigger(e), e.target === t && (r && o && l(), o = e, n(e) ? s.listenOnce(f) : s.listen(d)) } function h(e) { s.trigger(e), e.target === t && r && !o && (n(e) ? s.listenOnce(f) : s.listen(d)) } function d() { if (!("selectionStart" in t && t instanceof HTMLTextAreaElement && t.selectionStart !== t.selectionEnd) && t instanceof HTMLTextAreaElement) { var n = t.value; 1 === n.length ? (t.value = "", e.options && e.options.overrideTypedText ? e.options.overrideTypedText(n) : e.typedText(n)) : f() } } function f() { t instanceof HTMLTextAreaElement && t.value.length > 1 && a() } function m() { r = null, o = null, s.clearListener(), t instanceof HTMLTextAreaElement && (t.value = "") } function g(t) { s.trigger(t) } return e.options && e.options.disableCopyPaste ? e.addTextareaEventListeners({ keydown: u, keypress: p, keyup: h, focusout: m, copy: function (t) { t.preventDefault() }, cut: function (t) { t.preventDefault() }, paste: function (t) { s.trigger(), t.preventDefault() }, input: g }) : e.addTextareaEventListeners({ keydown: u, keypress: p, keyup: h, focusout: m, cut: function () { s.listenOnce(function () { e.cut() }) }, copy: function () { s.listenOnce(function () { e.copy() }) }, paste: function (n) { s.trigger(), n.target === t && (document.activeElement !== t && t.focus(), s.listen(function () { if (t instanceof HTMLTextAreaElement) { var n = t.value; t.value = "", n && e.paste(n) } })) }, input: g }), { select: function (e) { s.trigger(), s.clearListener(), t instanceof HTMLTextAreaElement && (t.value = e), e && a(), c = !!e } } } }(), G = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.exportText = function () { return this.root.foldChildren("", function (t, e) { return t + e.text() }) }, e }(T); T.onNotify(function (t, e) { if ("edit" === e || "replace" === e || void 0 === e) { var n = t.controller; if (!n) return; if (!n.options.enableDigitGrouping) return; if (!1 !== n.blurred) return; n.disableGroupingForSeconds(1) } }); var W = function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.handleTextareaFocusEditable = function () { var t = e.cursor; e.updateMathspeak(), e.blurred = !1, clearTimeout(e.blurTimeout), m(e.container).addClass("dcg-mq-focused"), t.parent || t.insAtRightEnd(e.root), t.selection ? (t.selection.domFrag().removeClass("dcg-mq-blur"), e.selectionChanged()) : t.show(), e.setOverflowClasses() }, e.handleTextareaBlurEditable = function () { e.textareaSelectionTimeout && (clearTimeout(e.textareaSelectionTimeout), e.textareaSelectionTimeout = 0), e.disableGroupingForSeconds(0), e.blurred = !0, e.blurTimeout = setTimeout(function () { e.root.postOrder(function (t) { t.intentionalBlur() }), e.cursor.clearSelection().endSelection(), e.blur(), e.updateMathspeak(), e.scrollHoriz() }), window.addEventListener("blur", e.handleWindowBlur) }, e.handleTextareaFocusStatic = function () { e.blurred = !1 }, e.handleTextareaBlurStatic = function () { e.cursor.selection && e.cursor.selection.clear(), setTimeout(function () { m(e.getTextareaSpanOrThrow()).detach(), e.blurred = !0 }) }, e.handleWindowBlur = function () { clearTimeout(e.blurTimeout), e.cursor.selection && e.cursor.selection.domFrag().addClass("dcg-mq-blur"), e.blur(), e.updateMathspeak() }, e } return __extends(e, t), e.prototype.disableGroupingForSeconds = function (t) { var e = this; clearTimeout(this.__disableGroupingTimeout), 0 === t ? this.root.domFrag().removeClass("dcg-mq-suppress-grouping") : (this.root.domFrag().addClass("dcg-mq-suppress-grouping"), this.__disableGroupingTimeout = setTimeout(function () { e.root.domFrag().removeClass("dcg-mq-suppress-grouping") }, 1e3 * t)) }, e.prototype.blur = function () { this.cursor.hide().parent.blur(this.cursor), m(this.container).removeClass("dcg-mq-focused"), window.removeEventListener("blur", this.handleWindowBlur), this.options && this.options.resetCursorOnBlur && this.cursor.resetToEnd(this) }, e.prototype.addEditableFocusBlurListeners = function () { var t = this.cursor; this.addTextareaEventListeners({ focus: this.handleTextareaFocusEditable, blur: this.handleTextareaBlurEditable }), this.blurred = !0, t.hide().parent.blur(t) }, e.prototype.addStaticFocusBlurListeners = function () { this.addTextareaEventListeners({ focus: this.handleTextareaFocusStatic, blur: this.handleTextareaBlurStatic }) }, e }(G), U = !1, K = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.keystroke = function (e, r, i) { var o = i.cursor; switch (e) { case "Ctrl-Shift-Backspace": case "Ctrl-Backspace": i.ctrlDeleteDir(t); break; case "Shift-Backspace": case "Backspace": i.backspace(); break; case "Esc": case "Tab": return void i.escapeDir(1, e, r); case "Shift-Tab": case "Shift-Esc": return void i.escapeDir(t, e, r); case "End": i.notify("move").cursor.insAtRightEnd(o.parent), i.aria.queue("end of").queue(o.parent, !0); break; case "Ctrl-End": i.notify("move").cursor.insAtRightEnd(i.root), i.aria.queue("end of").queue(i.ariaLabel).queue(i.root).queue(i.ariaPostLabel); break; case "Shift-End": i.selectToBlockEndInDir(1); break; case "Ctrl-Shift-End": i.selectToRootEndInDir(1); break; case "Home": i.notify("move").cursor.insAtLeftEnd(o.parent), i.aria.queue("beginning of").queue(o.parent, !0); break; case "Ctrl-Home": i.notify("move").cursor.insAtLeftEnd(i.root), i.aria.queue("beginning of").queue(i.ariaLabel).queue(i.root).queue(i.ariaPostLabel); break; case "Shift-Home": i.selectToBlockEndInDir(t); break; case "Ctrl-Shift-Home": i.selectToRootEndInDir(t); break; case "Left": i.moveLeft(); break; case "Shift-Left": i.selectLeft(); break; case "Ctrl-Left": break; case "Right": i.moveRight(); break; case "Shift-Right": i.selectRight(); break; case "Ctrl-Right": break; case "Up": i.moveUp(); break; case "Down": i.moveDown(); break; case "Shift-Up": i.withIncrementalSelection(function (e) { if (o[t]) for (; o[t];)e(t); else e(t) }); break; case "Shift-Down": i.withIncrementalSelection(function (t) { if (o[1]) for (; o[1];)t(1); else t(1) }); break; case "Ctrl-Up": case "Ctrl-Down": break; case "Ctrl-Shift-Del": case "Ctrl-Del": i.ctrlDeleteDir(1); break; case "Shift-Del": case "Del": i.deleteForward(); break; case "Meta-A": case "Ctrl-A": i.selectAll(); break; case "Ctrl-Alt-Up": o.parent.parent && o.parent.parent instanceof n ? i.aria.queue(o.parent.parent) : i.aria.queue("nothing above"); break; case "Ctrl-Alt-Down": o.parent && o.parent instanceof n ? i.aria.queue(o.parent) : i.aria.queue("block is empty"); break; case "Ctrl-Alt-Left": o.parent.parent && o.parent.parent.getEnd(t) ? i.aria.queue(o.parent.parent.getEnd(t)) : i.aria.queue("nothing to the left"); break; case "Ctrl-Alt-Right": o.parent.parent && o.parent.parent.getEnd(1) ? i.aria.queue(o.parent.parent.getEnd(1)) : i.aria.queue("nothing to the right"); break; case "Ctrl-Alt-Shift-Down": o.selection ? i.aria.queue(o.selection.join("mathspeak", " ").trim() + " selected") : i.aria.queue("nothing selected"); break; case "Ctrl-Alt-=": case "Ctrl-Alt-Shift-Right": i.ariaPostLabel.length ? i.aria.queue(i.ariaPostLabel) : i.aria.queue("no answer"); break; default: return }i.aria.alert(), null == r || r.preventDefault(), i.scrollHoriz() }, n.prototype.moveOutOf = function (t, e, n) { i("overridden or never called on this node", !1) }, n.prototype.moveTowards = function (t, e, n) { i("overridden or never called on this node", !1) }, n.prototype.deleteOutOf = function (t, e) { i("overridden or never called on this node", !1) }, n.prototype.deleteTowards = function (t, e) { i("overridden or never called on this node", !1) }, n.prototype.unselectInto = function (t, e) { i("overridden or never called on this node", !1) }, n.prototype.selectOutOf = function (t, e) { i("overridden or never called on this node", !1) }, n.prototype.selectTowards = function (t, e) { i("overridden or never called on this node", !1) }, n }(w); T.onNotify(function (t, e) { "move" !== e && "upDown" !== e || t.show().clearSelection() }), D.leftRightIntoCmdGoes = function (t) { if (t && "up" !== t && "down" !== t) throw '"up" or "down" required for leftRightIntoCmdGoes option, got "' + t + '"'; return t }, T.onNotify(function (t, e) { "upDown" !== e && (t.upDownCache = {}) }), T.onNotify(function (t, e) { "edit" === e && t.show().deleteSelection() }), T.onNotify(function (t, e) { "select" !== e && t.endSelection() }); var Y = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.keystroke = function (t, e) { this.cursor.parent.keystroke(t, e, this.getControllerSelf()) }, n.prototype.escapeDir = function (t, e, n) { o(t); var r = this.cursor; if (r.parent !== this.root && (null == n || n.preventDefault()), r.parent !== this.root) return r.clearSelection(), r.parent.moveOutOf(t, r), r.controller.aria.alert(), this.notify("move") }, n.prototype.moveDir = function (t) { o(t); var e = this.cursor, n = e.options.leftRightIntoCmdGoes, r = e[t]; return e.selection ? e.insDirOf(t, e.selection.getEnd(t)) : r ? r.moveTowards(t, e, n) : e.parent.moveOutOf(t, e, n), this.notify("move") }, n.prototype.moveLeft = function () { return this.moveDir(t) }, n.prototype.moveRight = function () { return this.moveDir(1) }, n.prototype.moveUp = function () { return this.moveUpDown("up") }, n.prototype.moveDown = function () { return this.moveUpDown("down") }, n.prototype.moveUpDown = function (e) { var n, r, i = this.notify("upDown").cursor; "up" === e ? (n = "upInto", r = "upOutOf") : (n = "downInto", r = "downOutOf"); var o = i[t], s = i[1], a = s && s[n], c = o && o[n]; return a ? i.insAtLeftEnd(a) : c ? i.insAtRightEnd(c) : i.parent.bubble(function (t) { var e = t[r]; if (e && ("function" == typeof e && (e = e.call(t, i)), e instanceof K && i.jumpUpDown(t, e), !0 !== e)) return !1 }), this }, n.prototype.deleteDir = function (e) { o(e); var n = this.cursor, r = n[e], i = n.parent.parent, s = n.controller; if (r && r instanceof K) r.sides ? s.aria.queue(r.parent.chToCmd(r.sides[-e].ch).mathspeak({ createdLeftOf: n })) : r.blocks || "\\text" === r.parent.ctrlSeq || s.aria.queue(r); else if (i && i instanceof K) if (i.sides) s.aria.queue(i.parent.chToCmd(i.sides[e].ch).mathspeak({ createdLeftOf: n })); else if (i.blocks && i.mathspeakTemplate) if (i.upInto && i.downInto) s.aria.queue(i.mathspeakTemplate[1]); else { var a = i.mathspeakTemplate, c = e === t ? a[0] : a[a.length - 1]; s.aria.queue(c) } else s.aria.queue(i); var l = n.selection; if (this.notify("edit"), !l) { var u = n[e]; u ? u.deleteTowards(e, n) : n.parent.deleteOutOf(e, n) } var p = n[t], h = n[1]; return p.siblingDeleted && p.siblingDeleted(n.options, 1), h.siblingDeleted && h.siblingDeleted(n.options, t), n.parent.bubble(function (t) { t.reflow() }), this }, n.prototype.ctrlDeleteDir = function (e) { o(e); var n, r = this.cursor; if (!r[e] || r.selection) return this.deleteDir(e); this.notify("edit"), n = e === t ? new x(r.parent.getEnd(t), r[t]) : new x(r[1], r.parent.getEnd(1)), r.controller.aria.queue(n), n.remove(), r.insAtDirEnd(e, r.parent); var i = r[t], s = r[1]; return i && i.siblingDeleted(r.options, 1), s && s.siblingDeleted(r.options, t), r.parent.bubble(function (t) { t.reflow() }), this }, n.prototype.backspace = function () { return this.deleteDir(t) }, n.prototype.deleteForward = function () { return this.deleteDir(1) }, n.prototype.startIncrementalSelection = function () { i("Multiple selections can't be simultaneously open", !U), U = !0, this.notify("select"); var t = this.cursor; t.anticursor || t.startSelection() }, n.prototype.selectDirIncremental = function (t) { i("A selection is open", U), U = !0; var e = this.cursor, n = e.selection; o(t); var r = e[t]; r ? n && n.getEnd(t) === r && e.anticursor[-t] !== r ? r.unselectInto(t, e) : r.selectTowards(t, e) : e.parent.selectOutOf(t, e) }, n.prototype.finishIncrementalSelection = function () { i("A selection is open", U); var t = this.cursor; t.clearSelection(), t.select() || t.show(); var e = t.selection; e && t.controller.aria.clear().queue(e.join("mathspeak", " ").trim() + " selected"), U = !1 }, n.prototype.withIncrementalSelection = function (t) { var e = this; try { this.startIncrementalSelection(); try { t(function (t) { return e.selectDirIncremental(t) }) } finally { this.finishIncrementalSelection() } } finally { U = !1 } }, n.prototype.selectDir = function (t) { this.withIncrementalSelection(function (e) { return e(t) }) }, n.prototype.selectLeft = function () { return this.selectDir(t) }, n.prototype.selectRight = function () { return this.selectDir(1) }, n.prototype.selectAll = function () { this.notify("move"); var e = this.cursor; e.insAtRightEnd(this.root), this.withIncrementalSelection(function (n) { for (; e[t];)n(t) }) }, n.prototype.selectToBlockEndInDir = function (t) { var e = this.cursor; this.withIncrementalSelection(function (n) { for (; e[t];)n(t) }) }, n.prototype.selectToRootEndInDir = function (t) { var e = this, n = this.cursor; this.withIncrementalSelection(function (r) { for (; n[t] || n.parent !== e.root;)r(t) }) }, n }(W), X = (function (t) { function e(e) { return t.call(this) || this } __extends(e, t) }(K), function () { function t(t) { for (var e = t[0] || new ht, n = 1; n < t.length; n += 1)t[n].children().adopt(e, e.getEnd(1), 0); return e } var e = j.string, n = j.regex, r = j.letter, i = j.digit, o = j.any, s = j.optWhitespace, a = j.succeed, c = j.fail, l = r.map(function (t) { return new yt(t) }), u = i.map(function (t) { return new mt(t) }), p = n(/^[^${}\\_^]/).map(function (t) { return new ct(t) }), h = n(/^[^\\a-eg-zA-Z]/).or(e("\\").then(n(/^[a-z]+/i).or(n(/^\s+/).result(" ")).or(o))).then(function (t) { var e = E[t]; return e ? e.constructor ? new e(t).parser() : e(t).parser() : c("unknown command: \\" + t) }).or(l).or(u).or(p), d = e("{").then(function () { return m }).skip(e("}")), f = s.then(d.or(h.map(function (t) { var e = new ht; return t.adopt(e, 0, 0), e }))), m = f.many().map(t).skip(s), g = e("[").then(f.then(function (t) { return "]" !== t.join("latex") ? a(t) : c("") }).many().map(t).skip(s)).skip(e("]")), v = m; return v.block = f, v.optBlock = g, v }()); D.maxDepth = function (t) { return "number" == typeof t ? t : void 0 }; var Z, J = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.cleanLatex = function (t) { return t.replace(/(\\[a-z]+) (?![a-z])/gi, "$1") }, n.prototype.exportLatex = function () { return this.cleanLatex(this.root.latex()) }, n.prototype.writeLatex = function (t) { var e = this.notify("edit").cursor; return e.parent.writeLatex(e, t), this }, n.prototype.exportLatexSelection = function () { var e = { latex: "", startIndex: -1, endIndex: -1 }, n = this.cursor.selection; if (n) e.startSelectionBefore = n.getEnd(t), e.endSelectionAfter = n.getEnd(1); else { var r = this.cursor[t]; r ? e.startSelectionAfter = r : e.startSelectionBefore = this.cursor.parent; var i = this.cursor[1]; i ? e.endSelectionBefore = i : e.endSelectionAfter = this.cursor.parent } this.root.latexRecursive(e); for (var o = e.latex, s = this.cleanLatex(o), a = e.startIndex, c = e.endIndex, l = 0, u = 0; u < e.endIndex; u++)o[u] !== s[l] ? (u < e.startIndex && (a -= 1), c -= 1) : l += 1; return { latex: s, startIndex: a, endIndex: c } }, n.prototype.classifyLatexForEfficientUpdate = function (t) { if ("string" == typeof t) { var e = t.match(/-?[0-9.]+$/g); return e && 1 === e.length ? { latex: t, prefix: t.substr(0, t.length - e[0].length), digits: e[0] } : void 0 } }, n.prototype.updateLatexMathEfficiently = function (e, n) { var r, i, o, s, a, c = this.root, l = this.classifyLatexForEfficientUpdate(e); if (!l) return !1; if (!(a = this.classifyLatexForEfficientUpdate(n)) || a.prefix !== l.prefix) return !1; var u = a.digits, p = l.digits, h = !1, d = !1; "-" === u[0] && (h = !0, u = u.substr(1)), "-" === p[0] && (d = !0, p = p.substr(1)); for (var f = this.root.getEnd(1), m = [], g = u.length - 1; g >= 0; g--) { if (!f || f.ctrlSeq !== u[g]) return !1; if (f.parent !== c) return !1; m.unshift(f), f = f[t] } if (h && !d) { var v = f; if (!v) return !1; if ("-" !== v.ctrlSeq) return !1; if (v[1] !== m[0]) return !1; if (v.parent !== c) return !1; var y = v[t]; if (y && y.parent !== c) return !1; m[0][t] = v[t], c.getEnd(t) === v && c.setEnds(((r = {})[t] = m[0], r[1] = c.getEnd(1), r)), y && (y[1] = m[0]), v.domFrag().remove() } if (!h && d) { var w = new Lt("-"), b = document.createElement("span"); b.textContent = "-", w.setDOM(b); var x = m[0][t]; x && (x[1] = w), c.getEnd(t) === m[0] && c.setEnds(((i = {})[t] = w, i[1] = c.getEnd(1), i)), w.parent = c, w[t] = m[0][t], w[1] = m[0], m[0][t] = w, w.contactWeld(this.cursor), w.domFrag().insertBefore(m[0].domFrag()) } var E = Math.min(u.length, p.length); for (g = 0; g < E; g++) { var k = p[g]; (f = m[g]).ctrlSeq !== k && (f.ctrlSeq = k, f.domFrag().oneElement().textContent = k, f.mathspeakName = k) } if (u.length > p.length) for (f = m[p.length - 1], c.setEnds(((o = {})[t] = c.getEnd(t), o[1] = f, o)), f[1] = 0, g = u.length - 1; g >= E; g--)m[g].domFrag().remove(); if (p.length > u.length) { var q = document.createDocumentFragment(); for (g = E; g < p.length; g++) { var _ = document.createElement("span"); _.className = "dcg-mq-digit", _.textContent = p[g]; var L = new mt(p[g]); L.parent = c, L.setDOM(_), q.appendChild(_), L[t] = c.getEnd(1), L[1] = 0, L[t][1] = L, c.setEnds(((s = {})[t] = c.getEnd(t), s[1] = L, s)) } c.domFrag().oneElement().appendChild(q) } var S = this.exportLatex(); if (S !== e) return console.warn("tried updating latex efficiently but did not work. Attempted: " + e + " but wrote: " + S), !1; var O = c.getEnd(1); return O && O.fixDigitGrouping(this.cursor.options), !0 }, n.prototype.renderLatexMathFromScratch = function (e) { var n, r = this.root, i = this.cursor, o = j.all, s = j.eof, a = X.skip(s).or(o.result(!1)).parse(e); if (r.setEnds(((n = {})[t] = 0, n[1] = 0, n)), a && a.children().adopt(r, 0, 0), a) { var c = r.domFrag(); c.children().remove(), c.oneElement().appendChild(a.html()), r.finalizeInsert(i.options, i) } else r.domFrag().empty() }, n.prototype.renderLatexMath = function (e) { var n = this.cursor, r = this.root; this.notify("replace"), n.clearSelection(); var i = this.exportLatex(); r.getEnd(t) && r.getEnd(1) && i === e || (this.updateLatexMathEfficiently(e, i) || this.renderLatexMathFromScratch(e), this.updateMathspeak()), n.insAtRightEnd(r) }, n.prototype.renderLatexText = function (e) { var n, r = this.root, i = this.cursor; r.domFrag().children().slice(1).remove(), r.setEnds(((n = {})[t] = 0, n[1] = 0, n)), delete i.selection, i.show().insAtRightEnd(r); var o = j.regex, s = j.string, a = j.eof, c = j.all, l = s("$").then(X).skip(s("$").or(a)).map(function (e) { var n = new RootMathCommand(i); n.createBlocks(); var r = n.getEnd(t); return e.children().adopt(r, 0, 0), n }), u = s("\\$").result("$").or(o(/^[^$]/)).map(function (t) { return new ct(t) }), p = l.or(u).many().skip(a).or(c.result(!1)).parse(e); if (p) { for (var h = 0; h < p.length; h += 1)p[h].adopt(r, r.getEnd(1), 0); m(r.html()).appendTo(r.domFrag().oneElement()), r.finalizeInsert(i.options, i) } }, n }(Y), tt = function (t) { return !1 }; A.prototype.ignoreNextMousedown = tt, T.onNotify(function (t, e) { "edit" !== e && "replace" !== e || Z && Z.cursor === t && Z.cb() }); var et = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.setOverflowClasses = function () { var t = this.root.domFrag().oneElement(), e = !1, n = !1; if (!this.blurred) { var r = u(t).width, i = t.scrollWidth, o = t.scrollLeft; e = i > r + o, n = o > 0 } t.classList.contains("dcg-mq-editing-overflow-right") !== e && t.classList.toggle("dcg-mq-editing-overflow-right"), t.classList.contains("dcg-mq-editing-overflow-left") !== n && t.classList.toggle("dcg-mq-editing-overflow-left") }, n.prototype.scrollHoriz = function () { var e = this, n = this.cursor, r = n.selection, i = u(this.root.domFrag().oneElement()); if (!n.domFrag().isEmpty() || r) { if (r) { var o = u(r.domFrag().oneElement()), s = o.left - (i.left + 20), a = o.right - (i.right - 20); if (r.getEnd(t) === n[1]) if (s < 0) l = s; else { if (!(a > 0)) return; if (o.left - a < i.left + 20) l = s; else l = a } else if (a > 0) l = a; else { if (!(s < 0)) return; if (o.right - s > i.right - 20) l = a; else l = s } } else { var c = u(n.domFrag().oneElement()).left; if (c > i.right - 20) var l = c - (i.right - 20); else { if (!(c < i.left + 20)) return; var l = c - (i.left + 20) } } var p = this.root.domFrag().oneElement(); if (!(l < 0 && 0 === p.scrollLeft || l > 0 && p.scrollWidth <= p.scrollLeft + i.width)) { this.cancelScrollHoriz && (this.cancelScrollHoriz(), this.cancelScrollHoriz = void 0); var h = this.root.domFrag().oneElement(), f = h.scrollLeft; d(this.getScrollAnimationDuration(), function (t, n, r) { t >= 1 ? (e.cancelScrollHoriz = void 0, h.scrollLeft = Math.round(f + l), e.setOverflowClasses()) : (e.cancelScrollHoriz = r, n(), h.scrollLeft = Math.round(f + t * l)) }) } } else { this.cancelScrollHoriz && (this.cancelScrollHoriz(), this.cancelScrollHoriz = void 0); var m = this.root.domFrag().oneElement(), g = m.scrollLeft; d(this.getScrollAnimationDuration(), function (t, n, r) { t >= 1 ? (e.cancelScrollHoriz = void 0, m.scrollLeft = 0, e.setOverflowClasses()) : (e.cancelScrollHoriz = r, n(), m.scrollLeft = Math.round((1 - t) * g)) }) } }, n.prototype.getScrollAnimationDuration = function () { var t; return null !== (t = this.options.scrollAnimationDuration) && void 0 !== t ? t : 100 }, n }(function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.handleMouseDown = function (t) { var n = c(t.target, ".dcg-mq-root-block"), i = n && w.getNodeOfElement(n) || w.getNodeOfElement(e.root.domFrag().oneElement()), o = i.domFrag().firstNode().ownerDocument, s = i.controller, a = s.cursor, l = a.blink, u = s.getTextareaSpanOrThrow(), p = s.getTextareaOrThrow(); if (t.preventDefault(), t.target.unselectable = !0, !a.options.ignoreNextMousedown(t)) { a.options.ignoreNextMousedown = tt; var h, d = null; Z = { cursor: a, cb: function () { h = !0, a.blink = l, a.clearSelection(), y(), v() } }, s.blurred && (n && !s.editable && m(n).prepend(m(u)), p.focus(), h) || (a.blink = r, s.seek(t.target, t.clientX, t.clientY).cursor.startSelection(), null == n || n.addEventListener("mousemove", f), null == o || o.addEventListener("mousemove", g), null == o || o.addEventListener("mouseup", b)) } function f(t) { d = t.target } function g(t) { a.anticursor || a.startSelection(), s.seek(d, t.clientX, t.clientY).cursor.select(), a.selection && a.controller.aria.clear().queue(a.selection.join("mathspeak") + " selected").alert(), d = null } function v() { null == n || n.removeEventListener("mousemove", f), null == o || o.removeEventListener("mousemove", g), null == o || o.removeEventListener("mouseup", b), Z = void 0 } function y() { s.editable ? (a.show(), a.controller.aria.queue(a.parent).alert()) : m(u).detach() } function b() { a.blink = l, a.selection || y(), v() } }, e } return __extends(e, t), e.prototype.addMouseEventListener = function () { this.container.addEventListener("mousedown", this.handleMouseDown) }, e.prototype.removeMouseEventListener = function () { this.container.removeEventListener("mousedown", this.handleMouseDown) }, e.prototype.seek = function (t, e, n) { for (var r, i = this.notify("select").cursor; t && !(r = w.getNodeOfElement(t));)t = t.parentElement; return r || (r = this.root), i.clearSelection().show(), r.seek(e, i), this.scrollHoriz(), this }, e }(J)); function nt(t, e) { return Q(t[0], e) } A.prototype.substituteTextarea = function () { return a("textarea", { autocapitalize: "off", autocomplete: "off", autocorrect: "off", spellcheck: !1, "x-palm-disable-ste-all": !0 }) }, A.prototype.substituteKeyboardEvents = nt; var rt = function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.selectFn = r, e } return __extends(e, t), e.prototype.createTextarea = function () { this.textareaSpan = a("span", { class: "dcg-mq-textarea" }); var t = this.options.substituteTextarea(); if (!t.nodeType) throw "substituteTextarea() must return a DOM element, got " + t; this.textarea = m(t).appendTo(this.textareaSpan).oneElement(); var e = this; e.cursor.selectionChanged = function () { e.selectionChanged() } }, e.prototype.selectionChanged = function () { var t = this; t.textareaSelectionTimeout || (t.textareaSelectionTimeout = setTimeout(function () { t.setTextareaSelection() })) }, e.prototype.setTextareaSelection = function () { this.textareaSelectionTimeout = 0; var t = ""; this.cursor.selection && (t = this.cleanLatex(this.cursor.selection.join("latex")), this.options.statelessClipboard && (t = "$" + t + "$")), this.selectFn(t) }, e.prototype.staticMathTextareaEvents = function () { var t = this; this.removeTextareaEventListener("cut"), this.removeTextareaEventListener("paste"), t.options.disableCopyPaste ? this.removeTextareaEventListener("copy") : this.addTextareaEventListeners({ copy: function () { t.setTextareaSelection() } }), this.addStaticFocusBlurListeners(), t.selectFn = function (e) { var n = t.getTextareaOrThrow(); n instanceof HTMLTextAreaElement && (n.value = e, e && n.select()) } }, e.prototype.editablesTextareaEvents = function () { var t = this.getTextareaOrThrow(), e = this.getTextareaSpanOrThrow(); if (this.options.version < 3) { var n = this.options.assertJquery(), r = this.options.substituteKeyboardEvents(n(t), this); this.selectFn = function (t) { r.select(t) } } else { var i = Q(t, this).select; this.selectFn = i } m(this.container).prepend(m(e)), this.addEditableFocusBlurListeners(), this.updateMathspeak() }, e.prototype.unbindEditablesEvents = function () { var t = this, e = t.getTextareaOrThrow(), n = t.getTextareaSpanOrThrow(); this.selectFn = function (t) { e instanceof HTMLTextAreaElement && (e.value = t, t && e.select()) }, m(n).remove(), this.removeTextareaEventListener("focus"), this.removeTextareaEventListener("blur"), t.blurred = !0, this.removeTextareaEventListener("cut"), this.removeTextareaEventListener("paste") }, e.prototype.typedText = function (t) { if ("\n" === t) return this.handle("enter"); var e = this.notify(void 0).cursor; e.parent.write(e, t), this.scrollHoriz() }, e.prototype.cut = function () { var t = this, e = t.cursor; e.selection && setTimeout(function () { t.notify("edit"), e.parent.bubble(function (t) { t.reflow() }), t.options && t.options.onCut && t.options.onCut() }) }, e.prototype.copy = function () { this.setTextareaSelection() }, e.prototype.paste = function (t) { this.options.statelessClipboard && (t = "$" === t.slice(0, 1) && "$" === t.slice(-1) ? t.slice(1, -1) : "\\text{" + t + "}"), this.writeLatex(t).cursor.show(), this.scrollHoriz(), this.options && this.options.onPaste && this.options.onPaste() }, e.prototype.setupStaticField = function () { this.mathspeakSpan = a("span", { class: "dcg-mq-mathspeak" }), m(this.container).prepend(m(this.mathspeakSpan)), this.updateMathspeak(), this.blurred = !0, this.cursor.hide().parent.blur(this.cursor) }, e.prototype.updateMathspeak = function () { var t = this, e = t.getAriaLabel(), n = /[A-Za-z0-9]$/.test(e) ? e + ":" : e, r = t.root.mathspeak().trim(); this.aria.clear(); var i = t.getTextareaOrThrow(); t.mathspeakSpan ? (i.setAttribute("aria-label", ""), t.mathspeakSpan.textContent = (n + " " + r).trim()) : i.setAttribute("aria-label", (n + " " + r + " " + t.ariaPostLabel).trim()) }, e }(et), it = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.finalizeInsert = function (e, n) { var r = this; r.postOrder(function (t) { t.finalizeTree(e) }), r.postOrder(function (t) { t.contactWeld(n) }), r.postOrder(function (t) { t.blur(n) }), r.postOrder(function (t) { t.reflow() }); var i = r[1], o = r[t]; i && i.siblingCreated(e, t), o && o.siblingCreated(e, 1), r.bubble(function (t) { t.reflow() }) }, n.prototype.prepareInsertionAt = function (t) { var e = t.options.maxDepth; if (void 0 !== e) { var n = t.depth(); if (n > e) return !1; this.removeNodesDeeperThan(e - n) } return !0 }, n.prototype.removeNodesDeeperThan = function (t) { for (var e, n = 0, r = [[this, n]]; e = r.shift();) { var i = e; i[0].children().each(function (e) { var o = e instanceof ht ? 1 : 0; (n = i[1] + o) <= t ? r.push([e, n]) : (o ? e.children() : e).remove() }) } }, n }(K), ot = function (t, e) { this.childCount = t, this.render = e }, st = function (e) { function n(t, n, r) { var i = e.call(this) || this; return i.textTemplate = [""], i.mathspeakTemplate = [""], i.setCtrlSeqHtmlAndText(t, n, r), i } return __extends(n, e), n.prototype.setEnds = function (e) { i("MathCommand ends are never empty", e[t] && e[1]), this.ends = e }, n.prototype.getEnd = function (t) { return this.ends[t] }, n.prototype.setCtrlSeqHtmlAndText = function (t, e, n) { this.ctrlSeq || (this.ctrlSeq = t), e && (this.domView = e), n && (this.textTemplate = n) }, n.prototype.replaces = function (t) { t.disown(), this.replacedFragment = t }, n.prototype.isEmpty = function () { return this.foldChildren(!0, function (t, e) { return t && e.isEmpty() }) }, n.prototype.parser = function () { var t = this; return X.block.times(this.numBlocks()).map(function (e) { t.blocks = e; for (var n = 0; n < e.length; n += 1)e[n].adopt(t, t.getEnd(1), 0); return t }) }, n.prototype.createLeftOf = function (n) { var r = this, i = r.replacedFragment; if (r.createBlocks(), e.prototype.createLeftOf.call(this, n), i) { var o = r.getEnd(t); i.adopt(o, 0, 0), i.domFrag().appendTo(o.domFrag().oneElement()), r.placeCursor(n), r.prepareInsertionAt(n) } r.finalizeInsert(n.options, n), r.placeCursor(n) }, n.prototype.createBlocks = function () { for (var t = this, e = t.numBlocks(), n = t.blocks = Array(e), r = 0; r < e; r += 1) { (n[r] = new ht).adopt(t, t.getEnd(1), 0) } }, n.prototype.placeCursor = function (e) { e.insAtRightEnd(this.foldChildren(this.getEnd(t), function (t, e) { return t.isEmpty() ? t : e })) }, n.prototype.moveTowards = function (t, e, n) { var r; "up" === n ? r = this.upInto : "down" === n && (r = this.downInto); var i = r || this.getEnd(-t); e.insAtDirEnd(-t, i), e.controller.aria.queueDirEndOf(-t).queue(e.parent, !0) }, n.prototype.deleteTowards = function (t, e) { this.isEmpty() ? e[t] = this.remove()[t] : this.moveTowards(t, e) }, n.prototype.selectTowards = function (t, e) { e[-t] = this, e[t] = this[t] }, n.prototype.selectChildren = function () { return new O(this, this) }, n.prototype.unselectInto = function (t, e) { var n = e.anticursor.ancestors[this.id]; e.insAtDirEnd(-t, n) }, n.prototype.seek = function (e, n) { function r(e) { var n, r = e.domFrag().oneElement(), i = u(r).left, o = i + r.offsetWidth; return (n = {})[t] = i, n[1] = o, n } var i = this, o = r(i); if (e < o[t]) return n.insLeftOf(i); if (e > o[1]) return n.insRightOf(i); var s = o[t]; i.eachChild(function (a) { var c = r(a); return e < c[t] ? (e - s < c[t] - e ? a[t] ? n.insAtRightEnd(a[t]) : n.insLeftOf(i) : n.insAtLeftEnd(a), !1) : e > c[1] ? void (a[1] ? s = c[1] : o[1] - e < e - c[1] ? n.insRightOf(i) : n.insAtRightEnd(a)) : (a.seek(e, n), !1) }) }, n.prototype.numBlocks = function () { return this.domView.childCount }, n.prototype.html = function () { var t = this.blocks; i("domView is defined", this.domView); var e = this.domView.render(t || []); return this.setDOM(e), w.linkElementByCmdNode(e, this), e }, n.prototype.latexRecursive = function (t) { this.checkCursorContextOpen(t), t.latex += this.ctrlSeq || "", this.eachChild(function (e) { t.latex += "{"; var n = t.latex.length; e.latexRecursive(t), n === t.latex.length && (t.latex += " "), t.latex += "}" }), this.checkCursorContextClose(t) }, n.prototype.text = function () { var t = this, e = 0; return t.foldChildren(t.textTemplate[e], function (n, r) { e += 1; var i = r.text(); return n && "(" === t.textTemplate[e] && "(" === i[0] && ")" === i.slice(-1) ? n + i.slice(1, -1) + t.textTemplate[e] : n + i + (t.textTemplate[e] || "") }) }, n.prototype.mathspeak = function () { var t = this, e = 0; return t.foldChildren(t.mathspeakTemplate[e] || "Start" + t.ctrlSeq + " ", function (n, r) { return e += 1, n + " " + r.mathspeak() + " " + (t.mathspeakTemplate[e] + " " || "End" + t.ctrlSeq + " ") }) }, n }(it), at = function (t) { function e(e, n, r, i) { var o = t.call(this) || this; return o.setCtrlSeqHtmlTextAndMathspeak(e, n ? new ot(0, function () { return n.cloneNode(!0) }) : void 0, r, i), o } return __extends(e, t), e.prototype.setCtrlSeqHtmlTextAndMathspeak = function (e, n, r, i) { !r && e && (r = e.replace(/^\\/, "")), this.mathspeakName = i || r, t.prototype.setCtrlSeqHtmlAndText.call(this, e, n, [r || ""]) }, e.prototype.parser = function () { return j.succeed(this) }, e.prototype.numBlocks = function () { return 0 }, e.prototype.replaces = function (t) { t.remove() }, e.prototype.createBlocks = function () { }, e.prototype.moveTowards = function (t, e) { e.domFrag().insDirOf(t, this.domFrag()), e[-t] = this, e[t] = this[t], e.controller.aria.queue(this) }, e.prototype.deleteTowards = function (t, e) { e[t] = this.remove()[t] }, e.prototype.seek = function (t, e) { var n = this.domFrag().oneElement(); return t - u(n).left < n.offsetWidth / 2 ? e.insLeftOf(this) : e.insRightOf(this), e }, e.prototype.latexRecursive = function (t) { this.checkCursorContextOpen(t), t.latex += this.ctrlSeq || "", this.checkCursorContextClose(t) }, e.prototype.text = function () { return this.textTemplate.join("") }, e.prototype.mathspeak = function (t) { return this.mathspeakName || "" }, e.prototype.placeCursor = function () { }, e.prototype.isEmpty = function () { return !0 }, e }(st), ct = function (t) { function e(e, n, r) { return t.call(this, e, a("span", {}, [n || a.text(e)]), void 0, r) || this } return __extends(e, t), e }(at); function lt(t, e, n) { return function () { return new ct(t, e ? a.entityText(e) : void 0, n) } } var ut = function (t) { function e(e, n, r, i, o) { return o ? t.call(this, e, a("span", {}, [n || a.text(e || "")]), void 0, i) || this : t.call(this, e, a("span", { class: "dcg-mq-binary-operator" }, n ? [n] : []), r, i) || this } return __extends(e, t), e }(at); function pt(t, e, n, r) { return function () { return new ut(t, e ? a.entityText(e) : void 0, n, r) } } var ht = function (e) { function n() { var t = null !== e && e.apply(this, arguments) || this; return t.ariaLabel = "block", t } return __extends(n, e), n.prototype.join = function (t) { return this.foldChildren("", function (e, n) { return e + n[t]() }) }, n.prototype.html = function () { var t = document.createDocumentFragment(); return this.eachChild(function (e) { var n = e.html(); t.appendChild(n) }), t }, n.prototype.latexRecursive = function (t) { this.checkCursorContextOpen(t), this.eachChild(function (e) { return e.latexRecursive(t) }), this.checkCursorContextClose(t) }, n.prototype.text = function () { var e = this.getEnd(t); return e === this.getEnd(1) && 0 !== e ? e.text() : this.join("text") }, n.prototype.mathspeak = function () { var t = "", e = {}; return this.controller && (e = this.controller.options.autoOperatorNames), this.foldChildren([], function (n, r) { if (r.isPartOfOperator) t += r.mathspeak(); else { if ("" !== t) { if (e._maxLength > 0) { var i = e[t.toLowerCase()]; "string" == typeof i && (t = i) } n.push(t + " "), t = "" } var o = r.mathspeak(), s = r.ctrlSeq; !isNaN(s) || "." === s || r.parent && r.parent.parent && r.parent.parent.isTextBlock() || (o = " " + o + " "), n.push(o) } return n }).join("").replace(/ +(?= )/g, "").replace(/(\.)([0-9]+)/g, function (t, e, n) { return e + n.split("").join(" ").trim() }) }, n.prototype.keystroke = function (n, r, i) { return !i.options.spaceBehavesLikeTab || "Spacebar" !== n && "Shift-Spacebar" !== n ? e.prototype.keystroke.call(this, n, r, i) : (null == r || r.preventDefault(), void i.escapeDir("Shift-Spacebar" === n ? t : 1, n, r)) }, n.prototype.moveOutOf = function (t, e, n) { var r; if ("up" === n ? r = this.parent.upInto : "down" === n && (r = this.parent.downInto), !r && this[t]) { var i = -t; e.insAtDirEnd(i, this[t]), e.controller.aria.queueDirEndOf(i).queue(e.parent, !0) } else e.insDirOf(t, this.parent), e.controller.aria.queueDirOf(t).queue(this.parent) }, n.prototype.selectOutOf = function (t, e) { e.insDirOf(t, this.parent) }, n.prototype.deleteOutOf = function (t, e) { e.unwrapGramp() }, n.prototype.seek = function (e, n) { var r = this.getEnd(1); if (!r) return n.insAtRightEnd(this); var i = r.domFrag().oneElement(); if (u(i).left + i.offsetWidth < e) return n.insAtRightEnd(this); if (e < u(this.getEnd(t).domFrag().oneElement()).left) return n.insAtLeftEnd(this); for (; e < u(r.domFrag().oneElement()).left;)r = r[t]; return r.seek(e, n) }, n.prototype.chToCmd = function (t, e) { var n; return t.match(/^[a-eg-zA-Z]$/) ? new yt(t) : /^\d$/.test(t) ? new mt(t) : e && e.typingSlashWritesDivisionSymbol && "/" === t ? E["Ã·"](t) : e && e.typingAsteriskWritesTimesSymbol && "*" === t ? E["Ã"](t) : e && e.typingPercentWritesPercentOf && "%" === t ? E.percentof(t) : (n = k[t] || E[t]) ? n.constructor ? new n(t) : n(t) : new ct(t) }, n.prototype.write = function (t, e) { var n = this.chToCmd(e, t.options); t.selection && n.replaces(t.replaceSelection()), t.isTooDeep() || (n.createLeftOf(t.show()), "/" === e ? t.controller.aria.alert("over") : t.controller.aria.alert(n.mathspeak({ createdLeftOf: t }))) }, n.prototype.writeLatex = function (e, n) { var r = j.all, i = j.eof, o = X.skip(i).or(r.result(!1)).parse(n); if (o && !o.isEmpty() && o.prepareInsertionAt(e)) { o.children().adopt(e.parent, e[t], e[1]), m(o.html()).insertBefore(e.domFrag()), e[t] = o.getEnd(1), o.finalizeInsert(e.options, e); var s = o.getEnd(1), a = o.getEnd(t), c = s[1], l = a[t]; c && c.siblingCreated(e.options, t), l && l.siblingCreated(e.options, 1), e.parent.bubble(function (t) { t.reflow() }) } }, n.prototype.focus = function () { return this.domFrag().addClass("dcg-mq-hasCursor"), this.domFrag().removeClass("dcg-mq-empty"), this }, n.prototype.blur = function (t) { return this.domFrag().removeClass("dcg-mq-hasCursor"), this.isEmpty() && (this.domFrag().addClass("dcg-mq-empty"), t && this.isQuietEmptyDelimiter(t.options.quietEmptyDelimiters) && this.domFrag().addClass("dcg-mq-quiet-delimiter")), this }, n }(it); A.prototype.mouseEvents = !0, C.StaticMath = function (t) { var e; return (e = function (e) { function n(n) { var r = e.call(this, n) || this, i = r.innerFields = []; return r.__controller.root.postOrder(function (e) { e.registerInnerField(i, t.InnerMathField) }), r } return __extends(n, e), n.prototype.__mathquillify = function (t, n) { return this.config(t), e.prototype.mathquillify.call(this, "dcg-mq-math-mode"), this.__controller.setupStaticField(), this.__options.mouseEvents && (this.__controller.addMouseEventListener(), this.__controller.staticMathTextareaEvents()), this }, n.prototype.latex = function (n) { var r = e.prototype.latex.apply(this, arguments); if (arguments.length > 0) { var i = this.innerFields = []; this.__controller.root.postOrder(function (e) { e.registerInnerField(i, t.InnerMathField) }), this.__controller.updateMathspeak() } return r }, n.prototype.setAriaLabel = function (t) { return this.__controller.setAriaLabel(t), this }, n.prototype.getAriaLabel = function () { return this.__controller.getAriaLabel() }, n }(t.AbstractMathQuill)).RootBlock = ht, e }; var dt = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e }(ht); H(dt.prototype), C.MathField = function (t) { var e; return (e = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.__mathquillify = function (e, n) { return this.config(e), n > 1 && (this.__controller.root.reflow = r), t.prototype.mathquillify.call(this, "dcg-mq-editable-field dcg-mq-math-mode"), delete this.__controller.root.reflow, this }, e }(t.EditableField)).RootBlock = dt, e }, C.InnerMathField = function (t) { return i("MathField class is defined", t.MathField), function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.makeStatic = function () { this.__controller.editable = !1, this.__controller.root.blur(), this.__controller.unbindEditablesEvents(), m(this.__controller.container).removeClass("dcg-mq-editable-field") }, e.prototype.makeEditable = function () { this.__controller.editable = !0, this.__controller.editablesTextareaEvents(), this.__controller.cursor.insAtRightEnd(this.__controller.root), m(this.__controller.container).addClass("dcg-mq-editable-field") }, e }(t.MathField) }; var ft = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.finalizeTree = function (t, e) { this.sharedSiblingMethod(t, e) }, n.prototype.siblingDeleted = function (t, e) { this.sharedSiblingMethod(t, e) }, n.prototype.siblingCreated = function (t, e) { this.sharedSiblingMethod(t, e) }, n.prototype.sharedSiblingMethod = function (e, r) { r !== t && this[1] instanceof n || this.fixDigitGrouping(e) }, n.prototype.fixDigitGrouping = function (e) { if (e.enableDigitGrouping) { var n = this, r = this, i = 0, o = [], s = "\\ ", a = n; do { if (/^[0-9]$/.test(a.ctrlSeq)) n = a; else if (a.ctrlSeq === s) n = a, i += 1; else { if ("." !== a.ctrlSeq) break; n = a, o.push(a) } } while (a = n[t]); for (; a = r[1];)if (/^[0-9]$/.test(a.ctrlSeq)) r = a; else if (a.ctrlSeq === s) r = a, i += 1; else { if ("." !== a.ctrlSeq) break; r = a, o.push(a) } for (; r !== n && n && n.ctrlSeq === s;)n = n[1], i -= 1; for (; r !== n && r && r.ctrlSeq === s;)r = r[t], i -= 1; if (n !== r || !n || n.ctrlSeq !== s) i > 0 || o.length > 1 ? this.removeGroupingBetween(n, r) : o[0] ? (o[0] !== n && this.addGroupingBetween(o[0][t], n), o[0] !== r && this.removeGroupingBetween(o[0][1], r)) : this.addGroupingBetween(r, n) } }, n.prototype.removeGroupingBetween = function (t, e) { var r = t; do { if (r instanceof n && r.setGroupingClass(void 0), !r || r === e) break } while (r = r[1]) }, n.prototype.addGroupingBetween = function (e, r) { var i = e, o = 0, s = 0; for (i = e; i && (s += 1, i !== r);)i = i[t]; var a = s % 3; 0 === a && (a = 3); for (i = e; i;) { o += 1; var c = void 0; if (s >= 4 && (o === s ? c = "dcg-mq-group-leading-" + a : o % 3 == 0 && o !== s && (c = "dcg-mq-group-start"), c || (c = "dcg-mq-group-other")), i instanceof n && i.setGroupingClass(c), i === r) break; i = i[t] } }, n.prototype.setGroupingClass = function (t) { this._groupingClass !== t && (this._groupingClass && this.domFrag().removeClass(this._groupingClass), t && this.domFrag().addClass(t), this._groupingClass = t) }, n }(at), mt = function (e) { function n(t, n) { return e.call(this, t, a("span", { class: "dcg-mq-digit" }, [a.text(t)]), void 0, n) || this } return __extends(n, e), n.prototype.createLeftOf = function (n) { var r = n[t], i = r && r[t], o = n.parent.parent instanceof Pt ? n.parent.parent.sub : void 0; n.options.autoSubscriptNumerals && n.parent !== o && (r instanceof gt && !1 !== r.isItalic || r instanceof Pt && i instanceof gt && !1 !== i.isItalic) ? ((new Vt).createLeftOf(n), e.prototype.createLeftOf.call(this, n), n.insRightOf(n.parent.parent)) : e.prototype.createLeftOf.call(this, n) }, n.prototype.mathspeak = function (n) { if (n && n.createdLeftOf) { var r = n.createdLeftOf, i = r[t], o = i && i[t], s = r.parent.parent instanceof Pt ? r.parent.parent.sub : void 0; if (r.options.autoSubscriptNumerals && r.parent !== s && (i instanceof gt && !1 !== i.isItalic || r[t] instanceof Pt && o instanceof gt && !1 !== o.isItalic)) return "Subscript " + e.prototype.mathspeak.call(this) + " Baseline" } return e.prototype.mathspeak.call(this) }, n }(ft), gt = function (e) { function n(t, n) { return e.call(this, t, a("var", {}, [n || a.text(t)])) || this } return __extends(n, e), n.prototype.text = function () { var e = this.ctrlSeq || ""; return this.isPartOfOperator ? "\\" == e[0] ? e = e.slice(1, e.length) : " " == e[e.length - 1] && (e = e.slice(0, -1)) : (!this[t] || this[t] instanceof n || this[t] instanceof ut || "\\ " === this[t].ctrlSeq || (e = "*" + e), !this[1] || this[1] instanceof ut || this[1] instanceof Pt || (e += "*")), e }, n.prototype.mathspeak = function () { var t = this.ctrlSeq || ""; return this.isPartOfOperator || t.length > 1 || this.parent && this.parent.parent && this.parent.parent.isTextBlock() ? e.prototype.mathspeak.call(this) : '"' + t + '"' }, n }(at); function vt(t, e, n) { return function () { return new gt(t, a.entityText(e)) } } A.prototype.autoCommands = { _maxLength: 0 }, D.autoCommands = function (t) { if ("string" != typeof t || !/^[a-z]+(?: [a-z]+)*$/i.test(t)) throw '"' + t + '" not a space-delimited list of only letters'; for (var e = t.split(" "), r = {}, i = 0, o = 0; o < e.length; o += 1) { var s = e[o]; if (s.length < 2) throw 'autocommand "' + s + '" not minimum length of 2'; if (E[s] === xt) throw '"' + s + '" is a built-in operator name'; r[s] = 1, i = n(i, s.length) } return r._maxLength = i, r }, A.prototype.quietEmptyDelimiters = {}, D.quietEmptyDelimiters = function (t) { void 0 === t && (t = ""); for (var e = t.split(" "), n = {}, r = 0; r < e.length; r += 1) { n[e[r]] = 1 } return n }, A.prototype.autoParenthesizedFunctions = { _maxLength: 0 }, D.autoParenthesizedFunctions = function (t) { if ("string" != typeof t || !/^[a-z]+(?: [a-z]+)*$/i.test(t)) throw '"' + t + '" not a space-delimited list of only letters'; for (var e = t.split(" "), r = {}, i = 0, o = 0; o < e.length; o += 1) { var s = e[o]; if (s.length < 2) throw 'autocommand "' + s + '" not minimum length of 2'; r[s] = 1, i = n(i, s.length) } return r._maxLength = i, r }; var yt = function (n) { function r(t) { var e = n.call(this, t) || this; return e.letter = t, e } return __extends(r, n), r.prototype.checkAutoCmds = function (e) { if (!this.shouldIgnoreSubstitutionInSimpleSubscript(e.options)) { var n = e.options.autoCommands, i = n._maxLength || 0; if (i > 0) { for (var o = "", s = this, a = 0; s instanceof r && s.ctrlSeq === s.letter && a < i;)o = s.letter + o, s = s[t], a += 1; for (; o.length;) { if (n.hasOwnProperty(o)) { for (s = this, a = 1; s && a < o.length; a += 1, s = s[t]); new x(s, this).remove(), e[t] = s[t]; var c = E[o]; return (q(c) ? new c(o) : c(o)).createLeftOf(e) } o = o.slice(1) } } } }, r.prototype.autoParenthesize = function (e) { var n = e.parent.getEnd(1); if (!(n && n instanceof Zt && "\\left(" === n.ctrlSeq || this.shouldIgnoreSubstitutionInSimpleSubscript(e.options))) { for (var i = "", o = this, s = 0, a = e.options.autoParenthesizedFunctions, c = a._maxLength || 0, l = e.options.autoOperatorNames; o instanceof r && s < c;)i = o.letter + i, o = o[t], s += 1; for (; i.length;) { if (a.hasOwnProperty(i) && l.hasOwnProperty(i)) return e.parent.write(e, "("); i = i.slice(1) } } }, r.prototype.createLeftOf = function (t) { n.prototype.createLeftOf.call(this, t), this.checkAutoCmds(t), this.autoParenthesize(t) }, r.prototype.italicize = function (t) { return this.isItalic = t, this.isPartOfOperator = !t, this.domFrag().toggleClass("dcg-mq-operator-name", !t), this }, r.prototype.finalizeTree = function (t, e) { this.sharedSiblingMethod(t, e) }, r.prototype.siblingDeleted = function (t, e) { this.sharedSiblingMethod(t, e) }, r.prototype.siblingCreated = function (t, e) { this.sharedSiblingMethod(t, e) }, r.prototype.sharedSiblingMethod = function (e, n) { n !== t && this[1] instanceof r || this.autoUnItalicize(e) }, r.prototype.autoUnItalicize = function (n) { var i = n.autoOperatorNames; if (0 !== i._maxLength && !this.shouldIgnoreSubstitutionInSimpleSubscript(n)) { for (var o = this.letter, s = this[t]; s instanceof r; s = s[t])o = s.letter + o; for (var a = this[1]; a instanceof r; a = a[1])o += a.letter; var c = s && s[1], l = a && a[t]; new x(c || this.parent.getEnd(t), l || this.parent.getEnd(1)).each(function (t) { t instanceof r && (t.italicize(!0).domFrag().removeClass("dcg-mq-first dcg-mq-last dcg-mq-followed-by-supsub"), t.ctrlSeq = t.letter) }); var u = i._maxLength || 0; t: for (var p = 0, h = s[1] || this.parent.getEnd(t); h && p < o.length; p += 1, h = h[1])for (var d = e(u, o.length - p); d > 0; d -= 1) { var f = o.slice(p, p + d), m = void 0; if (i.hasOwnProperty(f)) { for (var g = 0, v = h; g < d; g += 1, v = v[1])v instanceof r && (v.italicize(!1), m = v); var y = wt.hasOwnProperty(f); if (h.ctrlSeq = (y ? "\\" : "\\operatorname{") + h.ctrlSeq, m.ctrlSeq += y ? " " : "}", bt.hasOwnProperty(f)) { var w = m[t], b = w && w[t]; (b && b[t]).domFrag().addClass("dcg-mq-last") } if (this.shouldOmitPadding(h[t]) || h.domFrag().addClass("dcg-mq-first"), !this.shouldOmitPadding(m[1])) if (m[1] instanceof Pt) { var E = m[1]; (E.siblingCreated = E.siblingDeleted = function () { E.domFrag().toggleClass("dcg-mq-after-operator-name", !(E[1] instanceof Zt)) })() } else m.domFrag().toggleClass("dcg-mq-last", !(m[1] instanceof Zt)); p += d - 1, h = m; continue t } } } }, r.prototype.shouldOmitPadding = function (t) { return !t || ("." === t.ctrlSeq || (t instanceof ut || t instanceof jt)) }, r }(gt), wt = {}; A.prototype.autoOperatorNames = function () { for (var t = { _maxLength: 9 }, e = "arg deg det dim exp gcd hom inf ker lg lim ln log max min sup limsup liminf injlim projlim Pr".split(" "), n = 0; n < e.length; n += 1)wt[e[n]] = t[e[n]] = 1; var r = "sin cos tan arcsin arccos arctan sinh cosh tanh sec csc cot coth".split(" "); for (n = 0; n < r.length; n += 1)wt[r[n]] = 1; var i = "sin cos tan sec cosec csc cotan cot ctg".split(" "); for (n = 0; n < i.length; n += 1)t[i[n]] = t["arc" + i[n]] = t[i[n] + "h"] = t["ar" + i[n] + "h"] = t["arc" + i[n] + "h"] = 1; var o = "gcf hcf lcm proj span".split(" "); for (n = 0; n < o.length; n += 1)t[o[n]] = 1; return t }(); var bt = { limsup: 1, liminf: 1, projlim: 1, injlim: 1 }; D.autoOperatorNames = function (t) { if ("string" != typeof t) throw '"' + t + '" not a space-delimited list'; if (!/^[a-z\|\-]+(?: [a-z\|\-]+)*$/i.test(t)) throw '"' + t + '" not a space-delimited list of letters or "|"'; for (var e = t.split(" "), r = {}, i = 0, o = 0; o < e.length; o += 1) { var s = e[o]; if (s.length < 2) throw '"' + s + '" not minimum length of 2'; if (s.indexOf("|") < 0) r[s] = s, i = n(i, s.length); else { var a = s.split("|"); if (a.length > 2) throw '"' + s + '" has more than 1 mathspeak delimiter'; if (a[0].length < 2) throw '"' + s[0] + '" not minimum length of 2'; r[a[0]] = a[1].replace(/-/g, " "), i = n(i, a[0].length) } } return r._maxLength = i, r }; var xt = function (t) { function e(e) { return t.call(this, e || "") || this } return __extends(e, t), e.prototype.createLeftOf = function (t) { for (var e = this.ctrlSeq, n = 0; n < e.length; n += 1)new yt(e.charAt(n)).createLeftOf(t) }, e.prototype.parser = function () { for (var t = this.ctrlSeq, e = new ht, n = 0; n < t.length; n += 1)new yt(t.charAt(n)).adopt(e, e.getEnd(1), 0); return j.succeed(e.children()) }, e }(at); for (var Et in A.prototype.autoOperatorNames) A.prototype.autoOperatorNames.hasOwnProperty(Et) && (E[Et] = xt); E.operatorname = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.createLeftOf = function () { }, e.prototype.numBlocks = function () { return 1 }, e.prototype.parser = function () { return X.block.map(function (t) { var e = !0, n = "", r = t.children(); return r.each(function (t) { t instanceof yt ? n += t.letter : e = !1 }), e && "ans" === n ? Gt() : r }) }, e }(st), E.f = function (t) { function e() { var e = this; return (e = t.call(this, "f") || this).letter = "f", e.domView = new ot(0, function () { return a("var", { class: "dcg-mq-f" }, [a.text("f")]) }), e } return __extends(e, t), e.prototype.italicize = function (e) { return this.domFrag().eachElement(function (t) { return t.textContent = "f" }), this.domFrag().toggleClass("dcg-mq-f", e), t.prototype.italicize.call(this, e) }, e }(yt), E[" "] = E.space = function () { return new ft("\\ ", a("span", {}, [a.text("Â ")]), " ") }, E["."] = function () { return new ft(".", a("span", { class: "dcg-mq-digit" }, [a.text(".")]), ".") }, E["'"] = E.prime = lt("'", "&prime;", "prime"), E["â³"] = E.dprime = lt("â³", "&Prime;", "double prime"), E.backslash = lt("\\backslash ", "\\", "backslash"), k["\\"] || (k["\\"] = E.backslash), E.$ = lt("\\$", "$", "dollar"), E.square = lt("\\square ", "â¡", "square"), E.mid = lt("\\mid ", "â£", "mid"); var kt = function (t) { function e(e, n, r) { return t.call(this, e, a("span", { class: "dcg-mq-nonSymbola" }, [n || a.text(e)])) || this } return __extends(e, t), e }(at); E["@"] = function () { return new kt("@") }, E["&"] = function () { return new kt("\\&", a.entityText("&amp;"), "and") }, E["%"] = function (t) { function e() { return t.call(this, "\\%", a.text("%"), "percent") || this } return __extends(e, t), e.prototype.parser = function () { var e = j.optWhitespace, n = j.string; return e.then(n("\\operatorname{of}").map(function () { return Wt() })).or(t.prototype.parser.call(this)) }, e }(kt), E["â¥"] = E.parallel = lt("\\parallel ", "&#x2225;", "parallel"), E["â¦"] = E.nparallel = lt("\\nparallel ", "&#x2226;", "not parallel"), E["â"] = E.perp = lt("\\perp ", "&#x27C2;", "perpendicular"), E.alpha = E.beta = E.gamma = E.delta = E.zeta = E.eta = E.theta = E.iota = E.kappa = E.mu = E.nu = E.xi = E.rho = E.sigma = E.tau = E.chi = E.psi = E.omega = function (t) { return new gt("\\" + t + " ", a.entityText("&" + t + ";")) }, E.phi = vt("\\phi ", "&#981;"), E.phiv = E.varphi = vt("\\varphi ", "&phi;"), E.epsilon = vt("\\epsilon ", "&#1013;"), E.epsiv = E.varepsilon = vt("\\varepsilon ", "&epsilon;"), E.piv = E.varpi = vt("\\varpi ", "&piv;"), E.sigmaf = E.sigmav = E.varsigma = vt("\\varsigma ", "&sigmaf;"), E.thetav = E.vartheta = E.thetasym = vt("\\vartheta ", "&thetasym;"), E.upsilon = E.upsi = vt("\\upsilon ", "&upsilon;"), E.gammad = E.Gammad = E.digamma = vt("\\digamma ", "&#989;"), E.kappav = E.varkappa = vt("\\varkappa ", "&#1008;"), E.rhov = E.varrho = vt("\\varrho ", "&#1009;"), E.pi = E["Ï"] = function () { return new kt("\\pi ", a.entityText("&pi;"), "pi") }, E.lambda = function () { return new kt("\\lambda ", a.entityText("&lambda;"), "lambda") }, E.Upsilon = E.Upsi = E.upsih = E.Upsih = function () { return new at("\\Upsilon ", a("var", { style: "font-family: serif" }, [a.entityText("&upsih;")]), "capital upsilon") }, E.Gamma = E.Delta = E.Theta = E.Lambda = E.Xi = E.Pi = E.Sigma = E.Phi = E.Psi = E.Omega = E.forall = function (t) { return new ct("\\" + t + " ", a.entityText("&" + t + ";")) }; var qt = function (e) { function n(t) { var n = e.call(this) || this; return n.latexStr = t, n } return __extends(n, e), n.prototype.createLeftOf = function (e) { var n = X.parse(this.latexStr); n.children().adopt(e.parent, e[t], e[1]), e[t] = n.getEnd(1), m(n.html()).insertBefore(e.domFrag()), n.finalizeInsert(e.options, e); var r = n.getEnd(1), i = r && r[1]; i && i.siblingCreated(e.options, t); var o = n.getEnd(t), s = o && o[t]; s && s.siblingCreated(e.options, 1), e.parent.bubble(function (t) { t.reflow() }) }, n.prototype.mathspeak = function () { return X.parse(this.latexStr).mathspeak() }, n.prototype.parser = function () { var t = X.parse(this.latexStr).children(); return j.succeed(t) }, n }(st); function _t(e) { if (!e) return !1; var n = e[t]; return n ? !(n instanceof ut || /^(\\ )|[,;:\(\[]$/.test(n.ctrlSeq)) : !!(e.parent && e.parent.parent && e.parent.parent.isStyleBlock()) && _t(e.parent.parent) } E["â°"] = function () { return new qt("^0") }, E["Â¹"] = function () { return new qt("^1") }, E["Â²"] = function () { return new qt("^2") }, E["Â³"] = function () { return new qt("^3") }, E["â´"] = function () { return new qt("^4") }, E["âµ"] = function () { return new qt("^5") }, E["â¶"] = function () { return new qt("^6") }, E["â·"] = function () { return new qt("^7") }, E["â¸"] = function () { return new qt("^8") }, E["â¹"] = function () { return new qt("^9") }, E["Â¼"] = function () { return new qt("\\frac14") }, E["Â½"] = function () { return new qt("\\frac12") }, E["Â¾"] = function () { return new qt("\\frac34") }, E["â"] = function () { return new qt("\\sqrt{}") }; var Lt = function (t) { function e(e, n, r) { return t.call(this, e, n, void 0, r, !0) || this } return __extends(e, t), e.prototype.contactWeld = function (t, e) { this.sharedSiblingMethod(t.options, e) }, e.prototype.siblingCreated = function (t, e) { this.sharedSiblingMethod(t, e) }, e.prototype.siblingDeleted = function (t, e) { this.sharedSiblingMethod(t, e) }, e.prototype.sharedSiblingMethod = function (t, e) { if (1 !== e) return this.domFrag().oneElement().className = _t(this) ? "dcg-mq-binary-operator" : "", this }, e }(ut); E["+"] = function (t) { function e() { return t.call(this, "+", a.text("+")) || this } return __extends(e, t), e.prototype.mathspeak = function () { return _t(this) ? "plus" : "positive" }, e }(Lt); var St = function (t) { function e() { return t.call(this, "-", a.entityText("&minus;")) || this } return __extends(e, t), e.prototype.mathspeak = function () { return _t(this) ? "minus" : "negative" }, e }(Lt); E["â"] = E["â"] = E["â"] = E["-"] = St, E["Â±"] = E.pm = E.plusmn = E.plusminus = function () { return new Lt("\\pm ", a.entityText("&plusmn;"), "plus-or-minus") }, E.mp = E.mnplus = E.minusplus = function () { return new Lt("\\mp ", a.entityText("&#8723;"), "minus-or-plus") }, k["*"] = E.sdot = E.cdot = pt("\\cdot ", "&middot;", "*", "times"); var Ot = function (e) { function n() { return e.call(this, "\\to ", a.entityText("&rarr;"), "to") || this } return __extends(n, e), n.prototype.deleteTowards = function (n, r) { if (n === t) { var i = r[t]; return new x(i, this).remove(), r[t] = i[t], (new St).createLeftOf(r), void r[t].bubble(function (t) { t.reflow() }) } e.prototype.deleteTowards.call(this, n, r) }, n }(ut); E["â"] = E.to = Ot; var Tt = function (e) { function n(t, n) { var r = this, i = n ? "Strict" : ""; return (r = e.call(this, t["ctrlSeq".concat(i)], a.entityText(t["htmlEntity".concat(i)]), t["text".concat(i)], t["mathspeak".concat(i)]) || this).data = t, r.strict = n, r } return __extends(n, e), n.prototype.swap = function (t) { this.strict = t; var e = t ? "Strict" : ""; this.ctrlSeq = this.data["ctrlSeq".concat(e)], this.domFrag().children().replaceWith(m(a.entityText(this.data["htmlEntity".concat(e)]))), this.textTemplate = [this.data["text".concat(e)]], this.mathspeakName = this.data["mathspeak".concat(e)] }, n.prototype.deleteTowards = function (n, r) { if (n === t && !this.strict) return this.swap(!0), void this.bubble(function (t) { t.reflow() }); e.prototype.deleteTowards.call(this, n, r) }, n }(ut), Ct = { ctrlSeq: "\\le ", htmlEntity: "&le;", text: "â¤", mathspeak: "less than or equal to", ctrlSeqStrict: "<", htmlEntityStrict: "&lt;", textStrict: "<", mathspeakStrict: "less than" }, Ft = { ctrlSeq: "\\ge ", htmlEntity: "&ge;", text: "â¥", mathspeak: "greater than or equal to", ctrlSeqStrict: ">", htmlEntityStrict: "&gt;", textStrict: ">", mathspeakStrict: "greater than" }, Dt = function (e) { function n() { return e.call(this, Ft, !0) || this } return __extends(n, e), n.prototype.createLeftOf = function (n) { var r = n[t]; if (r instanceof ut && "-" === r.ctrlSeq) { var i = r; return n[t] = i[t], i.remove(), (new Ot).createLeftOf(n), void n[t].bubble(function (t) { t.reflow() }) } e.prototype.createLeftOf.call(this, n) }, n }(Tt); E["<"] = E.lt = function () { return new Tt(Ct, !0) }, E[">"] = E.gt = Dt, E["â¤"] = E.le = E.leq = function () { return new Tt(Ct, !1) }, E["â¥"] = E.ge = E.geq = function () { return new Tt(Ft, !1) }, E.infty = E.infin = E.infinity = lt("\\infty ", "&infin;", "infinity"), E["â "] = E.ne = E.neq = pt("\\ne ", "&ne;", "not equal"); var At = function (e) { function n() { return e.call(this, "=", a.text("="), "=", "equals") || this } return __extends(n, e), n.prototype.createLeftOf = function (n) { var r = n[t]; if (r instanceof Tt && r.strict) return r.swap(!1), void r.bubble(function (t) { t.reflow() }); e.prototype.createLeftOf.call(this, n) }, n }(ut); E["="] = At, E["Ã"] = E.times = pt("\\times ", "&times;", "[x]", "times"), E["Ã·"] = E.div = E.divide = E.divides = pt("\\div ", "&divide;", "[/]", "over"); var Mt = function (e) { function n() { return e.call(this, "\\sim ", a.text("~"), "~", "tilde") || this } return __extends(n, e), n.prototype.createLeftOf = function (r) { if (r[t] instanceof n) { var i = r[t]; return r[t] = i[t], i.remove(), (new Nt).createLeftOf(r), void r[t].bubble(function (t) { t.reflow() }) } e.prototype.createLeftOf.call(this, r) }, n }(ut), Nt = function (e) { function n() { return e.call(this, "\\approx ", a.entityText("&approx;"), "â", "approximately equal") || this } return __extends(n, e), n.prototype.deleteTowards = function (n, r) { if (n === t) { var i = r[t]; return new x(i, this).remove(), r[t] = i[t], (new Mt).createLeftOf(r), void r[t].bubble(function (t) { t.reflow() }) } e.prototype.deleteTowards.call(this, n, r) }, n }(ut); E.tildeNbsp = lt("~", "Â ", " "), E.sim = Mt, E["â"] = E.approx = Nt, k["~"] = E.sim, E["~"] = E.tildeNbsp, D.interpretTildeAsSim = function (t) { var e = !!t; return E["~"] = e ? E.sim : E.tildeNbsp, e }; var It = { sqrt: { width: "", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 32 54" }, [a("path", { d: "M0 33 L7 27 L12.5 47 L13 47 L30 0 L32 0 L13 54 L11 54 L4.5 31 L0 33" })]) } }, "|": { width: ".4em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 10 54" }, [a("path", { d: "M4.4 0 L4.4 54 L5.6 54 L5.6 0" })]) } }, "[": { width: ".55em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 11 24" }, [a("path", { d: "M8 0 L3 0 L3 24 L8 24 L8 23 L4 23 L4 1 L8 1" })]) } }, "]": { width: ".55em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 11 24" }, [a("path", { d: "M3 0 L8 0 L8 24 L3 24 L3 23 L7 23 L7 1 L3 1" })]) } }, "(": { width: ".55em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "3 0 106 186" }, [a("path", { d: "M85 0 A61 101 0 0 0 85 186 L75 186 A75 101 0 0 1 75 0" })]) } }, ")": { width: ".55em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "3 0 106 186" }, [a("path", { d: "M24 0 A61 101 0 0 1 24 186 L34 186 A75 101 0 0 0 34 0" })]) } }, "{": { width: ".7em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "10 0 210 350" }, [a("path", { d: "M170 0 L170 6 A47 52 0 0 0 123 60 L123 127 A35 48 0 0 1 88 175 A35 48 0 0 1 123 223 L123 290 A47 52 0 0 0 170 344 L170 350 L160 350 A58 49 0 0 1 102 301 L103 220 A45 40 0 0 0 58 180 L58 170 A45 40 0 0 0 103 130 L103 49 A58 49 0 0 1 161 0" })]) } }, "}": { width: ".7em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "10 0 210 350" }, [a("path", { d: "M60 0 L60 6 A47 52 0 0 1 107 60 L107 127 A35 48 0 0 0 142 175 A35 48 0 0 0 107 223 L107 290 A47 52 0 0 1 60 344 L60 350 L70 350 A58 49 0 0 0 128 301 L127 220 A45 40 0 0 1 172 180 L172 170 A45 40 0 0 1 127 130 L127 49 A58 49 0 0 0 70 0" })]) } }, "&#8741;": { width: ".7em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 10 54" }, [a("path", { d: "M3.2 0 L3.2 54 L4 54 L4 0 M6.8 0 L6.8 54 L6 54 L6 0" })]) } }, "&lang;": { width: ".55em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 10 54" }, [a("path", { d: "M6.8 0 L3.2 27 L6.8 54 L7.8 54 L4.2 27 L7.8 0" })]) } }, "&rang;": { width: ".55em", html: function () { return a("svg", { preserveAspectRatio: "none", viewBox: "0 0 10 54" }, [a("path", { d: "M3.2 0 L6.8 27 L3.2 54 L2.2 54 L5.8 27 L2.2 0" })]) } } }, Bt = function (t) { function e(e, n, r, i, o) { var s = t.call(this, e, new ot(1, function (t) { return a.block(n, r, t[0]) })) || this; return s.ariaLabel = i || e.replace(/^\\/, ""), s.mathspeakTemplate = ["Start" + s.ariaLabel + ",", "End" + s.ariaLabel], s.shouldNotSpeakDelimiters = o && o.shouldNotSpeakDelimiters, s } return __extends(e, t), e.prototype.mathspeak = function (e) { return !this.shouldNotSpeakDelimiters || e && e.ignoreShorthand ? t.prototype.mathspeak.call(this) : this.foldChildren("", function (t, n) { return t + " " + n.mathspeak(e) }).trim() }, e }(st); E.mathrm = function (t) { function e() { return t.call(this, "\\mathrm", "span", { class: "dcg-mq-roman dcg-mq-font" }, "Roman Font", { shouldNotSpeakDelimiters: !0 }) || this } return __extends(e, t), e.prototype.isTextBlock = function () { return !0 }, e }(Bt), E.mathit = function () { return new Bt("\\mathit", "i", { class: "dcg-mq-font" }, "Italic Font") }, E.mathbf = function () { return new Bt("\\mathbf", "b", { class: "dcg-mq-font" }, "Bold Font") }, E.mathsf = function () { return new Bt("\\mathsf", "span", { class: "dcg-mq-sans-serif dcg-mq-font" }, "Serif Font") }, E.mathtt = function () { return new Bt("\\mathtt", "span", { class: "dcg-mq-monospace dcg-mq-font" }, "Math Text") }, E.underline = function () { return new Bt("\\underline", "span", { class: "dcg-mq-non-leaf dcg-mq-underline" }, "Underline") }, E.overline = E.bar = function () { return new Bt("\\overline", "span", { class: "dcg-mq-non-leaf dcg-mq-overline" }, "Overline") }, E.overrightarrow = function () { return new Bt("\\overrightarrow", "span", { class: "dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-right" }, "Over Right Arrow") }, E.overleftarrow = function () { return new Bt("\\overleftarrow", "span", { class: "dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-left" }, "Over Left Arrow") }, E.overleftrightarrow = function () { return new Bt("\\overleftrightarrow ", "span", { class: "dcg-mq-non-leaf dcg-mq-overarrow dcg-mq-arrow-leftright" }, "Over Left and Right Arrow") }, E.overarc = function () { return new Bt("\\overarc", "span", { class: "dcg-mq-non-leaf dcg-mq-overarc" }, "Over Arc") }, E.dot = function () { return new st("\\dot", new ot(1, function (t) { return a("span", { class: "dcg-mq-non-leaf" }, [a("span", { class: "dcg-mq-dot-recurring-inner" }, [a("span", { class: "dcg-mq-dot-recurring" }, [a.text("Ë")]), a.block("span", { class: "dcg-mq-empty-box" }, t[0])])]) })) }, E.textcolor = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.setColor = function (t) { this.color = t, this.domView = new ot(1, function (e) { return a.block("span", { class: "dcg-mq-textcolor", style: "color:" + t }, e[0]) }), this.ariaLabel = t.replace(/^\\/, ""), this.mathspeakTemplate = ["Start " + this.ariaLabel + ",", "End " + this.ariaLabel] }, e.prototype.latexRecursive = function (t) { this.checkCursorContextOpen(t); var e = this.blocks[0]; t.latex += "\\textcolor{" + this.color + "}{", e.latexRecursive(t), t.latex += "}", this.checkCursorContextClose(t) }, e.prototype.parser = function () { var e = this, n = j.optWhitespace, r = j.string, i = j.regex; return n.then(r("{")).then(i(/^[#\w\s.,()%-]*/)).skip(r("}")).then(function (n) { return e.setColor(n), t.prototype.parser.call(e) }) }, e.prototype.isStyleBlock = function () { return !0 }, e }(st); E.class = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.parser = function () { var e = this, n = j.string, r = j.regex; return j.optWhitespace.then(n("{")).then(r(/^[-\w\s\\\xA0-\xFF]*/)).skip(n("}")).then(function (n) { return e.cls = n || "", e.domView = new ot(1, function (t) { return a.block("span", { class: "dcg-mq-class ".concat(n) }, t[0]) }), e.ariaLabel = n + " class", e.mathspeakTemplate = ["Start " + e.ariaLabel + ",", "End " + e.ariaLabel], t.prototype.parser.call(e) }) }, e.prototype.latexRecursive = function (t) { this.checkCursorContextOpen(t); var e = this.blocks[0]; t.latex += "\\class{" + this.cls + "}{", e.latexRecursive(t), t.latex += "}", this.checkCursorContextClose(t) }, e.prototype.isStyleBlock = function () { return !0 }, e }(st); var Rt = /^[\+\-]?[\d]+$/; function zt(t) { if (!t) return ""; var e = ""; return t.eachChild(function (t) { void 0 !== t.ctrlSeq && (e += t.ctrlSeq) }), e } A.prototype.charsThatBreakOutOfSupSub = ""; var Pt = function (e) { function n() { var t = null !== e && e.apply(this, arguments) || this; return t.ctrlSeq = "_{...}^{...}", t } return __extends(n, e), n.prototype.setEnds = function (e) { i("SupSub ends must be MathBlocks", e[t] instanceof ht && e[1] instanceof ht), this.ends = e }, n.prototype.getEnd = function (t) { return this.ends[t] }, n.prototype.createLeftOf = function (n) { if (this.replacedFragment || n[t] || !n.options.supSubsRequireOperand) return e.prototype.createLeftOf.call(this, n) }, n.prototype.contactWeld = function (e) { for (var r = t; r; r = r === t && 1) { var i = this[r], o = void 0; if (i instanceof n) { for (var s = "sub"; s; s = "sub" === s && "sup") { var a = this[s], c = i[s]; if (a) { if (c) if (a.isEmpty()) o = new g(c, 0, c.getEnd(t)); else { a.domFrag().children().insAtDirEnd(-r, c.domFrag().oneElement()); var l = a.children().disown(); o = new g(c, l.getEnd(1), c.getEnd(t)), r === t ? l.adopt(c, c.getEnd(1), 0) : l.adopt(c, 0, c.getEnd(t)) } else i.addBlock(a.disown()); this.placeCursor = function (t, e) { return function (n) { n.insAtDirEnd(-r, t || e) } }(c, a) } } this.remove(), e && e[t] === this && (1 === r && o ? o[t] ? e.insRightOf(o[t]) : e.insAtLeftEnd(o.parent) : e.insRightOf(i)); break } } }, n.prototype.finalizeTree = function () { this.getEnd(t).write = function (e, n) { if (e.options.autoSubscriptNumerals && this === this.parent.sub) { if ("_" === n) return; var r = this.chToCmd(n, e.options); return r instanceof at ? e.deleteSelection() : e.clearSelection().insRightOf(this.parent), r.createLeftOf(e.show()), void e.controller.aria.queue("Baseline").alert(r.mathspeak({ createdLeftOf: e })) } e[t] && !e[1] && !e.selection && e.options.charsThatBreakOutOfSupSub.indexOf(n) > -1 && (e.insRightOf(this.parent), e.controller.aria.queue("Baseline")), ht.prototype.write.call(this, e, n) } }, n.prototype.moveTowards = function (t, n, r) { n.options.autoSubscriptNumerals && !this.sup ? n.insDirOf(t, this) : e.prototype.moveTowards.call(this, t, n, r) }, n.prototype.deleteTowards = function (n, r) { if (r.options.autoSubscriptNumerals && this.sub) { var i = this.sub.getEnd(-n); i instanceof at ? i.remove() : i && i.deleteTowards(n, r.insAtDirEnd(-n, this.sub)), this.sub.isEmpty() && (this.sub.deleteOutOf(t, r.insAtLeftEnd(this.sub)), this.sup && r.insDirOf(-n, this)) } else e.prototype.deleteTowards.call(this, n, r) }, n.prototype.latexRecursive = function (t) { if (this.checkCursorContextOpen(t), this.sub) { t.latex += "_{"; var e = t.latex.length; this.sub.latexRecursive(t), e === t.latex.length && (t.latex += " "), t.latex += "}" } if (this.sup) { t.latex += "^{"; e = t.latex.length; this.sup.latexRecursive(t), e === t.latex.length && (t.latex += " "), t.latex += "}" } this.checkCursorContextClose(t) }, n.prototype.text = function () { function t(t, e) { var n = e && e.text() || ""; return e ? t + (1 === n.length ? n : "(" + (n || " ") + ")") : "" } return t("_", this.sub) + t("^", this.sup) }, n.prototype.addBlock = function (t) { "sub" === this.supsub ? (this.sup = this.upInto = this.sub.upOutOf = t, t.adopt(this, this.sub, 0).downOutOf = this.sub, t.setDOM(m(a("span", { class: "dcg-mq-sup" })).append(t.domFrag().children()).prependTo(this.domFrag().oneElement()).oneElement()), w.linkElementByBlockNode(t.domFrag().oneElement(), t)) : (this.sub = this.downInto = this.sup.downOutOf = t, t.adopt(this, 0, this.sup).upOutOf = this.sup, this.domFrag().removeClass("dcg-mq-sup-only"), t.setDOM(m(a("span", { class: "dcg-mq-sub" })).append(t.domFrag().children()).appendTo(this.domFrag().oneElement()).oneElement()), w.linkElementByBlockNode(t.domFrag().oneElement(), t), this.domFrag().append(m(a("span", { style: "display:inline-block;width:0" }, [a.text(l)])))); for (var e = 0; e < 2; e += 1)!function (t, e, n, r) { t[e].deleteOutOf = function (i, o) { if (o.insDirOf(this[i] ? -i : i, this.parent), !this.isEmpty()) { var s = this.getEnd(i); this.children().disown().withDirAdopt(i, o.parent, o[i], o[-i]).domFrag().insDirOf(-i, o.domFrag()), o[-i] = s } t.supsub = n, delete t[e], delete t["".concat(r, "Into")]; var a = t[n]; a["".concat(r, "OutOf")] = Ht, delete a.deleteOutOf, "sub" === e && t.domFrag().addClass("dcg-mq-sup-only").children().last().remove(), this.remove() } }(this, "sub sup".split(" ")[e], "sup sub".split(" ")[e], "down up".split(" ")[e]) }, n }(st); function Ht(t) { var e = this.parent, n = t; do { if (n[1]) return t.insLeftOf(e); n = n.parent.parent } while (n !== e); t.insRightOf(e) } var Vt = function (e) { function n() { var t = null !== e && e.apply(this, arguments) || this; return t.supsub = "sub", t.domView = new ot(1, function (t) { return a("span", { class: "dcg-mq-supsub dcg-mq-non-leaf" }, [a.block("span", { class: "dcg-mq-sub" }, t[0]), a("span", { style: "display:inline-block;width:0" }, [a.text(l)])]) }), t.textTemplate = ["_"], t.mathspeakTemplate = ["Subscript,", ", Baseline"], t.ariaLabel = "subscript", t } return __extends(n, e), n.prototype.finalizeTree = function () { this.downInto = this.sub = this.getEnd(t), this.sub.upOutOf = Ht, e.prototype.finalizeTree.call(this) }, n }(Pt); E.subscript = E._ = Vt, E.superscript = E.supscript = E["^"] = function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.supsub = "sup", e.domView = new ot(1, function (t) { return a("span", { class: "dcg-mq-supsub dcg-mq-non-leaf dcg-mq-sup-only" }, [a.block("span", { class: "dcg-mq-sup" }, t[0])]) }), e.textTemplate = ["^(", ")"], e.ariaLabel = "superscript", e.mathspeakTemplate = ["Superscript,", ", Baseline"], e } return __extends(e, t), e.prototype.mathspeak = function (e) { var n = this.upInto; if (void 0 !== n) { var r = zt(n); if ((!e || !e.ignoreShorthand) && Rt.test(r)) { if ("0" === r) return "to the 0 power"; if ("2" === r) return "squared"; if ("3" === r) return "cubed"; var i = ""; return /^[+-]?\d{1,3}$/.test(r) && (/(11|12|13|4|5|6|7|8|9|0)$/.test(r) ? i = "th" : /1$/.test(r) ? i = "st" : /2$/.test(r) ? i = "nd" : /3$/.test(r) && (i = "rd")), "to the " + ("object" == typeof n ? n.mathspeak() : r) + i + " power" } } return t.prototype.mathspeak.call(this) }, e.prototype.finalizeTree = function () { this.upInto = this.sup = this.getEnd(1), this.sup.downOutOf = Ht, t.prototype.finalizeTree.call(this) }, e }(Pt); var jt = function (e) { function n(t, n, r) { var i = e.call(this) || this; i.ariaLabel = r || t.replace(/^\\/, ""); var o = new ot(2, function (t) { return a("span", { class: "dcg-mq-large-operator dcg-mq-non-leaf" }, [a("span", { class: "dcg-mq-to" }, [a.block("span", {}, t[1])]), a("big", {}, [a.text(n)]), a("span", { class: "dcg-mq-from" }, [a.block("span", {}, t[0])])]) }); return at.prototype.setCtrlSeqHtmlTextAndMathspeak.call(i, t, o), i } return __extends(n, e), n.prototype.createLeftOf = function (t) { e.prototype.createLeftOf.call(this, t), t.options.sumStartsWithNEquals && (new yt("n").createLeftOf(t), (new At).createLeftOf(t)) }, n.prototype.latexRecursive = function (e) { this.checkCursorContextOpen(e), e.latex += this.ctrlSeq + "_{"; var n = e.latex.length; this.getEnd(t).latexRecursive(e); var r = e.latex.length; r === n && (e.latex += " "), e.latex += "}^{", n = e.latex.length, this.getEnd(1).latexRecursive(e), n === (r = e.latex.length) && (e.latex += " "), e.latex += "}", this.checkCursorContextClose(e) }, n.prototype.mathspeak = function () { return "Start " + this.ariaLabel + " from " + this.getEnd(t).mathspeak() + " to " + this.getEnd(1).mathspeak() + ", end " + this.ariaLabel + ", " }, n.prototype.parser = function () { for (var t = j.string, e = j.optWhitespace, n = j.succeed, r = X.block, i = this, o = i.blocks = [new ht, new ht], s = 0; s < o.length; s += 1)o[s].adopt(i, i.getEnd(1), 0); return e.then(t("_").or(t("^"))).then(function (t) { var e = o["_" === t ? 0 : 1]; return r.then(function (t) { return t.children().adopt(e, e.getEnd(1), 0), n(i) }) }).many().result(i) }, n.prototype.finalizeTree = function () { var e = this.getEnd(t), n = this.getEnd(1); e.ariaLabel = "lower bound", n.ariaLabel = "upper bound", this.downInto = e, this.upInto = n, e.upOutOf = n, n.downOutOf = e }, n }(st); E["â"] = E.sum = E.summation = function () { return new jt("\\sum ", "â", "sum") }, E["â"] = E.prod = E.product = function () { return new jt("\\prod ", "â", "product") }, E.coprod = E.coproduct = function () { return new jt("\\coprod ", "â", "co product") }, E["â«"] = E.int = E.integral = function (t) { function e() { var e = t.call(this, "\\int ", "", "integral") || this; return e.ariaLabel = "integral", e.domView = new ot(2, function (t) { return a("span", { class: "dcg-mq-int dcg-mq-non-leaf" }, [a("big", {}, [a.text("â«")]), a("span", { class: "dcg-mq-supsub dcg-mq-non-leaf" }, [a("span", { class: "dcg-mq-sup" }, [a.block("span", { class: "dcg-mq-sup-inner" }, t[1])]), a.block("span", { class: "dcg-mq-sub" }, t[0]), a("span", { style: "display:inline-block;width:0" }, [a.text(l)])])]) }), e } return __extends(e, t), e.prototype.createLeftOf = function (t) { st.prototype.createLeftOf.call(this, t) }, e }(jt); var $t = E.frac = E.dfrac = E.cfrac = E.fraction = function (e) { function n() { var t = null !== e && e.apply(this, arguments) || this; return t.ctrlSeq = "\\frac", t.domView = new ot(2, function (t) { return a("span", { class: "dcg-mq-fraction dcg-mq-non-leaf" }, [a.block("span", { class: "dcg-mq-numerator" }, t[0]), a.block("span", { class: "dcg-mq-denominator" }, t[1]), a("span", { style: "display:inline-block;width:0" }, [a.text(l)])]) }), t.textTemplate = ["(", ")/(", ")"], t } return __extends(n, e), n.prototype.finalizeTree = function () { var e = this.getEnd(t), n = this.getEnd(1); this.upInto = n.upOutOf = e, this.downInto = e.downOutOf = n, e.ariaLabel = "numerator", n.ariaLabel = "denominator", this.getFracDepth() > 1 ? this.mathspeakTemplate = ["StartNestedFraction,", "NestedOver", ", EndNestedFraction"] : this.mathspeakTemplate = ["StartFraction,", "Over", ", EndFraction"] }, n.prototype.mathspeak = function (n) { if (n && n.createdLeftOf) return n.createdLeftOf.parent.mathspeak(); var r = zt(this.getEnd(t)), i = zt(this.getEnd(1)); if ((!n || !n.ignoreShorthand) && Rt.test(r) && Rt.test(i)) { var o = "1" === r || "-1" === r, s = ""; if ("2" === i ? s = o ? "half" : "halves" : "3" === i ? s = o ? "third" : "thirds" : "4" === i ? s = o ? "quarter" : "quarters" : "5" === i ? s = o ? "fifth" : "fifths" : "6" === i ? s = o ? "sixth" : "sixths" : "7" === i ? s = o ? "seventh" : "sevenths" : "8" === i ? s = o ? "eighth" : "eighths" : "9" === i && (s = o ? "ninth" : "ninths"), "" !== s) { for (var a = "", c = !1, l = this[t]; l && void 0 !== l[t]; l = l[t])if ("\\ " !== l.ctrlSeq) { if (!Rt.test(l.ctrlSeq || "")) { c = !1; break } c = !0 } return c && (a += "and "), a += this.getEnd(t).mathspeak() + " " + s } } return e.prototype.mathspeak.call(this) }, n.prototype.getFracDepth = function () { var t = function (e, n) { return e instanceof K && e.ctrlSeq && e.ctrlSeq.toLowerCase().search("frac") >= 0 && (n += 1), e && e.parent ? t(e.parent, n) : n }; return t(this, 0) }, n }(st), Qt = E.over = k["/"] = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.createLeftOf = function (n) { if (!this.replacedFragment) { var i = n[t]; if (!n.options.typingSlashCreatesNewFraction) for (; i && !(i instanceof ut || i instanceof (E.text || r) || i instanceof jt || "\\ " === i.ctrlSeq || /^[,;:]$/.test(i.ctrlSeq));)i = i[t]; if (i instanceof jt && i[1] instanceof Pt) (o = (i = i[1])[1]) instanceof Pt && o.ctrlSeq != i.ctrlSeq && (i = i[1]); if (i !== n[t] && !n.isTooDeep(1)) { var o = i[1], s = n[t]; this.replaces(new x(o || n.parent.getEnd(t), s)), n[t] = i } } e.prototype.createLeftOf.call(this, n) }, n }($t), Gt = function () { return new at("\\operatorname{ans}", a("span", { class: "dcg-mq-ans" }, [a.text("ans")]), "ans") }; E.ans = Gt; var Wt = function () { return new at("\\%\\operatorname{of}", a("span", { class: "dcg-mq-nonSymbola dcg-mq-operator-name" }, [a.text("% of ")]), "percent of") }; E.percent = E.percentof = Wt; var Ut = function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.ctrlSeq = "\\sqrt", e.domView = new ot(1, function (t) { return a("span", { class: "dcg-mq-non-leaf dcg-mq-sqrt-container" }, [a("span", { class: "dcg-mq-scaled dcg-mq-sqrt-prefix" }, [It.sqrt.html()]), a.block("span", { class: "dcg-mq-non-leaf dcg-mq-sqrt-stem" }, t[0])]) }), e.textTemplate = ["sqrt(", ")"], e.mathspeakTemplate = ["StartRoot,", ", EndRoot"], e.ariaLabel = "root", e } return __extends(e, t), e.prototype.parser = function () { return X.optBlock.then(function (t) { return X.block.map(function (e) { var n = new Kt; return n.blocks = [t, e], t.adopt(n, 0, 0), e.adopt(n, t, 0), n }) }).or(t.prototype.parser.call(this)) }, e }(st); E.sqrt = Ut, E.hat = function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.ctrlSeq = "\\hat", e.domView = new ot(1, function (t) { return a("span", { class: "dcg-mq-non-leaf" }, [a("span", { class: "dcg-mq-hat-prefix" }, [a.text("^")]), a.block("span", { class: "dcg-mq-hat-stem" }, t[0])]) }), e.textTemplate = ["hat(", ")"], e } return __extends(e, t), e }(st); var Kt = function (e) { function n() { var t = null !== e && e.apply(this, arguments) || this; return t.domView = new ot(2, function (t) { return a("span", { class: "dcg-mq-nthroot-container dcg-mq-non-leaf" }, [a.block("sup", { class: "dcg-mq-nthroot dcg-mq-non-leaf" }, t[0]), a("span", { class: "dcg-mq-scaled dcg-mq-sqrt-container" }, [a("span", { class: "dcg-mq-sqrt-prefix dcg-mq-scaled" }, [It.sqrt.html()]), a.block("span", { class: "dcg-mq-sqrt-stem dcg-mq-non-leaf" }, t[1])])]) }), t.textTemplate = ["sqrt[", "](", ")"], t } return __extends(n, e), n.prototype.latexRecursive = function (e) { this.checkCursorContextOpen(e), e.latex += "\\sqrt[", this.getEnd(t).latexRecursive(e), e.latex += "]{", this.getEnd(1).latexRecursive(e), e.latex += "}", this.checkCursorContextClose(e) }, n.prototype.mathspeak = function () { var e = this.getEnd(t).mathspeak(), n = this.getEnd(1).mathspeak(); return this.getEnd(t).ariaLabel = "Index", this.getEnd(1).ariaLabel = "Radicand", "3" === e ? "Start Cube Root, " + n + ", End Cube Root" : "Root Index " + e + ", Start Root, " + n + ", End Root" }, n }(Ut); E.nthroot = Kt, E.cbrt = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.createLeftOf = function (e) { t.prototype.createLeftOf.call(this, e), new mt("3").createLeftOf(e), e.controller.moveRight() }, e }(Kt); var Yt = function (t) { function e(e, n, r) { var i = new ot(1, function (t) { return a("span", { class: "dcg-mq-non-leaf" }, [a("span", { class: "dcg-mq-diacritic-above" }, [n]), a.block("span", { class: "dcg-mq-diacritic-stem" }, t[0])]) }); return t.call(this, e, i, r) || this } return __extends(e, t), e }(st); E.vec = function () { return new Yt("\\vec", a.entityText("&rarr;"), ["vec(", ")"]) }, E.tilde = function () { return new Yt("\\tilde", a.text("~"), ["tilde(", ")"]) }; var Xt = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return __extends(n, e), n.prototype.setDOM = function (n) { var r; e.prototype.setDOM.call(this, n); var i = this.domFrag().children(); return i.isEmpty() || (this.delimFrags = ((r = {})[t] = i.first(), r[1] = i.last(), r)), this }, n }(st), Zt = function (e) { function n(n, r, i, o, s) { var a, c = e.call(this, "\\left" + o, void 0, [r, i]) || this; return c.side = n, c.sides = ((a = {})[t] = { ch: r, ctrlSeq: o }, a[1] = { ch: i, ctrlSeq: s }, a), c } return __extends(n, e), n.prototype.numBlocks = function () { return 1 }, n.prototype.html = function () { var n = this, r = this.getSymbol(t), i = this.getSymbol(1); return this.domView = new ot(1, function (e) { return a("span", { class: "dcg-mq-non-leaf dcg-mq-bracket-container" }, [a("span", { style: "width:" + r.width, class: "dcg-mq-scaled dcg-mq-bracket-l dcg-mq-paren" + (1 === n.side ? " dcg-mq-ghost" : "") }, [r.html()]), a.block("span", { style: "margin-left:" + r.width + ";margin-right:" + i.width, class: "dcg-mq-bracket-middle dcg-mq-non-leaf" }, e[0]), a("span", { style: "width:" + i.width, class: "dcg-mq-scaled dcg-mq-bracket-r dcg-mq-paren" + (n.side === t ? " dcg-mq-ghost" : "") }, [i.html()])]) }), e.prototype.html.call(this) }, n.prototype.getSymbol = function (t) { var e = this.sides[t || 1].ch; return It[e] || { width: "0", html: "" } }, n.prototype.latexRecursive = function (e) { this.checkCursorContextOpen(e), e.latex += "\\left" + this.sides[t].ctrlSeq, this.getEnd(t).latexRecursive(e), e.latex += "\\right" + this.sides[1].ctrlSeq, this.checkCursorContextClose(e) }, n.prototype.mathspeak = function (n) { var r = this.sides[t].ch, i = this.sides[1].ch; if ("|" === r && "|" === i) this.mathspeakTemplate = ["StartAbsoluteValue,", ", EndAbsoluteValue"], this.ariaLabel = "absolute value"; else { if (n && n.createdLeftOf && this.side) { var o = ""; return this.side === t ? o = this.textTemplate[0] : 1 === this.side && (o = this.textTemplate[1]), (this.side === t ? "left " : "right ") + te[o] } this.mathspeakTemplate = ["left " + te[r] + ",", ", right " + te[i]], this.ariaLabel = te[r] + " block" } return e.prototype.mathspeak.call(this) }, n.prototype.matchBrack = function (e, r, i) { return i instanceof n && i.side && i.side !== -r && (!e.restrictMismatchedBrackets || Jt[this.sides[this.side].ch] === i.sides[i.side].ch || { "(": "]", "[": ")" }[this.sides[t].ch] === i.sides[1].ch) && i }, n.prototype.closeOpposing = function (e) { e.side = 0, e.sides[this.side] = this.sides[this.side]; var n = e.delimFrags[this.side === t ? t : 1].removeClass("dcg-mq-ghost"); this.replaceBracket(n, this.side) }, n.prototype.createLeftOf = function (n) { var r; if (!this.replacedFragment) { var i = n.options; r = "|" === this.sides[t].ch ? this.matchBrack(i, 1, n[1]) || this.matchBrack(i, t, n[t]) || this.matchBrack(i, 0, n.parent.parent) : this.matchBrack(i, -this.side, n[-this.side]) || this.matchBrack(i, -this.side, n.parent.parent) } if (r) { var o = this.side = -r.side; this.closeOpposing(r), r === n.parent.parent && n[o] && new x(n[o], n.parent.getEnd(o), -o).disown().withDirAdopt(-o, r.parent, r, r[o]).domFrag().insDirOf(o, r.domFrag()), r.bubble(function (t) { t.reflow() }) } else o = (r = this).side, r.replacedFragment ? r.side = 0 : n[-o] && (r.replaces(new x(n[-o], n.parent.getEnd(-o), o)), n[-o] = 0), e.prototype.createLeftOf.call(this, n); o === t ? n.insAtLeftEnd(r.getEnd(t)) : n.insRightOf(r) }, n.prototype.placeCursor = function () { }, n.prototype.unwrap = function () { this.getEnd(t).children().disown().adopt(this.parent, this, this[1]).domFrag().insertAfter(this.domFrag()), this.remove() }, n.prototype.deleteSide = function (e, n, r) { var i = this.parent, o = this[e], s = i.getEnd(e); if (e === this.side) return this.unwrap(), void (o ? r.insDirOf(-e, o) : r.insAtDirEnd(e, i)); var a = r.options, c = !this.side; if (this.side = -e, this.matchBrack(a, e, this.getEnd(t).getEnd(this.side))) { this.closeOpposing(this.getEnd(t).getEnd(this.side)); var l = this.getEnd(t).getEnd(e); this.unwrap(), l && l.siblingCreated(r.options, e), o ? r.insDirOf(-e, o) : r.insAtDirEnd(e, i) } else { if (this.matchBrack(a, e, this.parent.parent)) this.parent.parent.closeOpposing(this), this.parent.parent.unwrap(); else { if (n && c) return this.unwrap(), void (o ? r.insDirOf(-e, o) : r.insAtDirEnd(e, i)); this.sides[e] = function (t) { var e = t.side, n = t.sides[e]; return { ch: Jt[n.ch], ctrlSeq: Jt[n.ctrlSeq] } }(this), this.delimFrags[t].removeClass("dcg-mq-ghost"), this.delimFrags[1].removeClass("dcg-mq-ghost"); var u = this.delimFrags[e].addClass("dcg-mq-ghost"); this.replaceBracket(u, e) } if (o) { var p = this.getEnd(t); l = p.getEnd(e); p.domFrag().removeClass("dcg-mq-empty"), new x(o, s, -e).disown().withDirAdopt(-e, p, l, 0).domFrag().insAtDirEnd(e, p.domFrag().oneElement()), l && l.siblingCreated(r.options, e), r.insDirOf(-e, o) } else n ? r.insDirOf(e, this) : r.insAtDirEnd(e, this.getEnd(t)) } }, n.prototype.replaceBracket = function (e, n) { var r = this.getSymbol(n); if (e.children().replaceWith(m(r.html())), e.oneElement().style.width = r.width, n === t) { var i = e.next(); i.isEmpty() || (i.oneElement().style.marginLeft = r.width) } else { var o = e.prev(); o.isEmpty() || (o.oneElement().style.marginRight = r.width) } }, n.prototype.deleteTowards = function (t, e) { this.deleteSide(-t, !1, e) }, n.prototype.finalizeTree = function () { this.getEnd(t).deleteOutOf = function (t, e) { this.parent.deleteSide(t, !0, e) }, this.finalizeTree = this.intentionalBlur = function () { this.delimFrags[this.side === t ? 1 : t].removeClass("dcg-mq-ghost"), this.side = 0 } }, n.prototype.siblingCreated = function (t, e) { e === -this.side && this.finalizeTree() }, n }(Xt); var Jt = { "(": ")", ")": "(", "[": "]", "]": "[", "{": "}", "}": "{", "\\{": "\\}", "\\}": "\\{", "&lang;": "&rang;", "&rang;": "&lang;", "\\langle ": "\\rangle ", "\\rangle ": "\\langle ", "|": "|", "\\lVert ": "\\rVert ", "\\rVert ": "\\lVert " }, te = { "&lang;": "angle-bracket", "&rang;": "angle-bracket", "|": "pipe" }; function ee(e, n, r) { n = n || e; var i = Jt[e], o = Jt[n]; k[e] = function () { return new Zt(t, e, i, n, o) }, k[i] = function () { return new Zt(1, e, i, n, o) }, te[e] = te[i] = r } ee("(", "", "parenthesis"), ee("[", "", "bracket"), ee("{", "\\{", "brace"), E.langle = function () { return new Zt(t, "&lang;", "&rang;", "\\langle ", "\\rangle ") }, E.rangle = function () { return new Zt(1, "&lang;", "&rang;", "\\langle ", "\\rangle ") }, k["|"] = function () { return new Zt(t, "|", "|", "|", "|") }, E.lVert = function () { return new Zt(t, "&#8741;", "&#8741;", "\\lVert ", "\\rVert ") }, E.rVert = function () { return new Zt(1, "&#8741;", "&#8741;", "\\lVert ", "\\rVert ") }, E.left = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.parser = function () { var t = j.regex, e = j.string, n = j.optWhitespace; return n.then(t(/^(?:[([|]|\\\{|\\langle(?![a-zA-Z])|\\lVert(?![a-zA-Z]))/)).then(function (r) { var i = r.replace(/^\\/, ""); return "\\langle" == r && (i = "&lang;", r += " "), "\\lVert" == r && (i = "&#8741;", r += " "), X.then(function (o) { return e("\\right").skip(n).then(t(/^(?:[\])|]|\\\}|\\rangle(?![a-zA-Z])|\\rVert(?![a-zA-Z]))/)).map(function (t) { var e = t.replace(/^\\/, ""); "\\rangle" == t && (e = "&rang;", t += " "), "\\rVert" == t && (e = "&#8741;", t += " "); var n = new Zt(0, i, e, r, t); return n.blocks = [o], o.adopt(n, 0, 0), n }) }) }) }, e }(st), E.right = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.parser = function () { return j.fail("unmatched \\right") }, e }(st); var ne = It["("], re = It[")"], ie = function (t) { function e() { var e = null !== t && t.apply(this, arguments) || this; return e.ctrlSeq = "\\binom", e.domView = new ot(2, function (t) { return a("span", { class: "dcg-mq-non-leaf dcg-mq-bracket-container" }, [a("span", { style: "width:" + ne.width, class: "dcg-mq-paren dcg-mq-bracket-l dcg-mq-scaled" }, [ne.html()]), a("span", { style: "margin-left:" + ne.width + "; margin-right:" + re.width, class: "dcg-mq-non-leaf dcg-mq-bracket-middle" }, [a("span", { class: "dcg-mq-array dcg-mq-non-leaf" }, [a.block("span", {}, t[0]), a.block("span", {}, t[1])])]), a("span", { style: "width:" + re.width, class: "dcg-mq-paren dcg-mq-bracket-r dcg-mq-scaled" }, [re.html()])]) }), e.textTemplate = ["choose(", ",", ")"], e.mathspeakTemplate = ["StartBinomial,", "Choose", ", EndBinomial"], e.ariaLabel = "binomial", e } return __extends(e, t), e }(Xt); E.binom = E.binomial = ie, E.choose = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.createLeftOf = function (t) { Qt.prototype.createLeftOf(t) }, e }(ie); var oe = function (e) { function n() { var t = null !== e && e.apply(this, arguments) || this; return t.ctrlSeq = "\\MathQuillMathField", t.domView = new ot(1, function (t) { return a("span", { class: "dcg-mq-editable-field" }, [a.block("span", { class: "dcg-mq-root-block", "aria-hidden": "true" }, t[0])]) }), t } return __extends(n, e), n.prototype.parser = function () { var t = this, n = j.string, r = j.regex, i = j.succeed; return n("[").then(r(/^[a-z][a-z0-9]*/i)).skip(n("]")).map(function (e) { t.name = e }).or(i(void 0)).then(e.prototype.parser.call(this)) }, n.prototype.finalizeTree = function (e) { var n = new rt(this.getEnd(t), this.domFrag().oneElement(), e); n.KIND_OF_MQ = "MathField", n.editable = !0, n.createTextarea(), n.editablesTextareaEvents(), n.cursor.insAtRightEnd(n.root), H(n.root), function t(e) { if (e.parentNode && !m(e).hasClass("dcg-mq-root-block") && t(e.parentNode), e.nodeType === Node.ELEMENT_NODE) { var n = e; "true" === n.getAttribute("aria-hidden") && (n.removeAttribute("aria-hidden"), m(e).children().eachElement(function (t) { t.setAttribute("aria-hidden", "true") })) } }(this.domFrag().parent().oneElement()), this.domFrag().oneElement().removeAttribute("aria-hidden") }, n.prototype.registerInnerField = function (e, n) { var r = new n(this.getEnd(t).controller); e[this.name] = r, e.push(r) }, n.prototype.latexRecursive = function (e) { this.checkCursorContextOpen(e), this.getEnd(t).latexRecursive(e), this.checkCursorContextClose(e) }, n.prototype.text = function () { return this.getEnd(t).text() }, n }(st); E.editable = E.MathQuillMathField = oe; var se = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.setOptions = function (t) { function e() { return "" } return this.text = t.text || e, this.domView = new ot(0, function () { return a("span", {}, [s(t.htmlString || "")]) }), this.latex = t.latex || e, this }, e.prototype.latexRecursive = function (t) { this.checkCursorContextOpen(t), t.latex += this.latex(), this.checkCursorContextClose(t) }, e.prototype.parser = function () { var t = this, e = j.string, n = j.regex, r = j.succeed; return e("{").then(n(/^[a-z][a-z0-9]*/i)).skip(e("}")).then(function (i) { return e("[").then(n(/^[-\w\s]*/)).skip(e("]")).or(r(void 0)).map(function (e) { return t.setOptions(F[i](e)) }) }) }, e }(at); if (E.embed = se, window.jQuery) for (var ae in _ = z(1)) !function (t, e) { "function" == typeof e ? (I[t] = function () { return N(), e.apply(this, arguments) }, I[t].prototype = e.prototype) : I[t] = e }(ae, _[ae]) }();
define("mathquill_src", function () { });


define('loadcss!Symbola-basic', function () { });

define('loadcss!vendor/mathquill/mathquill-basic', function () { });
define('toplevel/mathquill', ['require', 'testbridge', 'mathquill_src', 'loadcss!Symbola-basic', 'loadcss!vendor/mathquill/mathquill-basic'], function (require) { "use strict"; return require("testbridge"), require("mathquill_src"), require("loadcss!Symbola-basic"), require("loadcss!vendor/mathquill/mathquill-basic"), window.MathQuill.noConflict() });
define('main/mathquill-operators', ["require", "exports", "config"], function (require, t, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.getAutoOperators = t.getAutoCommands = void 0; var n = ["exp|exponent ln|natural-log log", "total length mean median quantile quartile nCr nPr stats", "stdev|standard-deviation stddev|standard-deviation", "stdDev|standard-deviation stdevp|standard-deviation-population", "stddevp|standard-deviation-population stdDevP|standard-deviation-population mad var|variance", "varp|variance-population variance cov|co-variance covp|co-variance-population corr|correlation spearman", "lcm mcm gcd mcd gcf mod ceil|ceiling floor round abs|absolute-value min max sign|signum signum sgn", "sin|sine cos|cosine tan|tangent csc|co-secant sec|secant cot|co-tangent", "sinh|hyperbolic-sine cosh|hyperbolic-cosine tanh|hyperbolic-tangent csch|hyperbolic-co-secant", "sech|hyperbolic-secant coth|hyperbolic-co-tangent", "arcsin|arc-sine arccos|arc-cosine arctan|arc-tangent arccsc|arc-co-secant arcsec|arc-secant", "arccot|arc-co-tangent", "arcsinh|hyperbolic-arc-sine arccosh|hyperbolic-arc-cosine arctanh|hyperbolic-arc-co-tangent", "arccsch|hyperbolic-arc-co-secant arcsech|hyperbolic-arc-secant", "arccoth|hyperbolic-arc-co-tangent", "arsinh|hyperbolic-ar-sine arcosh|hyperbolic-ar-cosine artanh|hyperbolic-ar-co-tangent", "arcsch|hyperbolic-ar-co-secant arsech|hyperbolic-ar-secant", "arcoth|hyperbolic-ar-co-tangent", "polygon", "distance midpoint", "sort shuffle join unique", "erf|error-function", "TTest|t-test ttest|t-test TScore|t-score tscore|t-score", "iTTest|independent-t-test ittest|independent-t-test IndependentTTest", "TScore|t-score Tscore|t-score tscore|t-score", "normaldist|normal-distribution tdist|t-distribution poissondist|poisson-distribution", "binomialdist|binomial-distribution", "uniformdist|uniform-distribution", "pdf cdf random inverseCdf inversecdf", "histogram dotplot boxplot", "pdf cdf", "rgb hsv", "for", "width height"].join(" "), o = ["det|determinant", "inv|inverse", "transpose", "rref|reduced-row-echelon-form", "trace"].join(" "); n += " " + o, e.get("3d") && (n += " cube sphere cone dodecahedron octahedron tetrahedron"); t.getAutoCommands = function (t) { t || (t = {}); var e = "alpha beta sqrt theta phi pi tau nthroot cbrt sum prod int ans percent infinity infty"; return t.additionalCommands && t.additionalCommands.length && (e = e + " " + t.additionalCommands.join(" ")), t.disallowFrac ? e : e + " frac" }, t.getAutoOperators = function (t) { t || (t = {}); var e = n; return t.additionalOperators && t.additionalOperators.length && (e = e + " " + t.additionalOperators.join(" ")), e } });
define('mathquill', ['require', 'browser', 'jquery', 'toplevel/mathquill', 'main/mathquill-operators'], function (require) { "use strict"; var t = require("browser"), e = require("jquery"), r = require("toplevel/mathquill").getInterface(3), i = require("main/mathquill-operators"); return r.config({ leftRightIntoCmdGoes: "up", sumStartsWithNEquals: !0, supSubsRequireOperand: !0, charsThatBreakOutOfSupSub: "+-=<>*", autoCommands: i.getAutoCommands(), autoSubscriptNumerals: !0, restrictMismatchedBrackets: !0, typingPercentWritesPercentOf: !0, substituteTextarea: function () { return t.IS_IOS || t.IS_ANDROID ? e('<span class="dcg-mathquill-input-span" tabindex=0 role="textbox" style="display:inline-block;height:1px;width:1px">')[0] : t.IS_WINDOWS && t.IS_TOUCH ? e("<textarea readonly>").on("keydown", function () { this.readOnly = !1, this.select() }).on("blur", function () { this.readOnly = !0 })[0] : e("<textarea>")[0] }, autoOperatorNames: i.getAutoOperators(), quietEmptyDelimiters: "( [", resetCursorOnBlur: !0, enableDigitGrouping: !0, disableAutoSubstitutionInSubscripts: !0, interpretTildeAsSim: !0 }) });
define('core/types/graphmode', ["require", "exports"], function (require, O) { "use strict"; Object.defineProperty(O, "__esModule", { value: !0 }), O.POLYGON = O.ERROR = O.PARAMETRIC_CURVE_3D = O.Z_3D = O.OBJECT3D = O.VISUALIZATION = O.NONE = O.IMPLICIT = O.POLYGONFILL = O.POLAR = O.PARAMETRIC = O.XYPOINT_MOVABLE = O.XYPOINT = O.Y = O.X = void 0, O.X = 1, O.Y = 2, O.XYPOINT = 3, O.XYPOINT_MOVABLE = 4, O.PARAMETRIC = 5, O.POLAR = 6, O.POLYGONFILL = 7, O.IMPLICIT = 8, O.NONE = 10, O.VISUALIZATION = 11, O.OBJECT3D = 12, O.Z_3D = 13, O.PARAMETRIC_CURVE_3D = 14, O.ERROR = 15, O.POLYGON = 16 });
define('graphing/clipping', ["require", "exports", "core/types/graphmode"], function (require, e, n) { "use strict"; function r(e, n, r, t) { var i, A, u, l, E = []; t ? (i = 2, (l = n(A = e[0], u = e[1])) && E.push(A, u)) : (i = 0, l = n(A = e[e.length - 2], u = e[e.length - 1])); for (var s = i; s < e.length; s += 2) { var o = A, a = u, p = l; ((l = n(A = e[s], u = e[s + 1])) || p) && (l && p && E.push(A, u), l && !p && (Array.prototype.push.apply(E, r(A, u, o, a)), E.push(A, u)), !l && p && Array.prototype.push.apply(E, r(o, a, A, u))) } return E } function t(n, t, i, A) { var u = t.xmin, l = t.xmax, E = t.ymin, s = t.ymax, o = n; return i & e.LEFT && (o = r(n, function (e, n) { return e >= u }, function (e, n, r, t) { return [u, (n = n) + ((t = t) - n) * (u - (e = e)) / ((r = r) - e)] }, A)), i & e.BOTTOM && (o = r(o, function (e, n) { return n >= E }, function (e, n, r, t) { return [(e = e) + ((r = r) - e) * (E - (n = n)) / ((t = t) - n), E] }, A)), i & e.RIGHT && (o = r(o, function (e, n) { return e <= l }, function (e, n, r, t) { return [l, (n = n) + ((t = t) - n) * (l - (e = e)) / ((r = r) - e)] }, A)), i & e.TOP && (o = r(o, function (e, n) { return n <= s }, function (e, n, r, t) { return [(e = e) + ((r = r) - e) * (s - (n = n)) / ((t = t) - n), s] }, A)), o } Object.defineProperty(e, "__esModule", { value: !0 }), e.getClippingGraphType = e.computeCartesianFill = e.computePolarFill = e.clipAllFillEdges = e.clipFillEdges = e.clipFillEdge = e.clipStrokeEdges = e.mapSegmentToCanvas = e.X_EQUALS = e.Y_EQUALS = e.POLAR_DEGREE_INEQUALITY = e.POLAR_DEGREE_EQUALITY = e.POLAR_RADIAN_INEQUALITY = e.POLAR_RADIAN_EQUALITY = e.Y = e.X = e.ALL = e.RIGHT = e.LEFT = e.BOTTOM = e.TOP = void 0, e.TOP = 1, e.BOTTOM = 2, e.LEFT = 4, e.RIGHT = 8, e.ALL = 15, e.X = 12, e.Y = 3, e.POLAR_RADIAN_EQUALITY = 1, e.POLAR_RADIAN_INEQUALITY = 2, e.POLAR_DEGREE_EQUALITY = 3, e.POLAR_DEGREE_INEQUALITY = 4, e.Y_EQUALS = 5, e.X_EQUALS = 6, e.mapSegmentToCanvas = function (n, r, t, i) { var A = [], u = r.xmin, l = r.ymin, E = r.xmax - r.xmin, s = r.ymax - r.ymin, o = t.width, a = t.height, p = o / E, L = -a / s, h = n.length; if (i === e.Y_EQUALS) for (var c = 0; c < h; c += 2) { var _ = (n[c] - u) * p, I = (n[c + 1] - l) * L + a; A.push(_, I) } else if (i === e.X_EQUALS) for (c = 0; c < h; c += 2) { _ = (n[c + 1] - u) * p, I = (n[c] - l) * L + a; A.push(_, I) } else if (i === e.POLAR_RADIAN_EQUALITY) for (c = 0; c < n.length; c += 2) { var f = n[c]; _ = ((R = n[c + 1]) * Math.cos(f) - u) * p, I = (R * Math.sin(f) - l) * L + a; A.push(_, I) } else if (i === e.POLAR_RADIAN_INEQUALITY) for (c = 0; c < n.length; c += 2) { f = n[c]; (R = n[c + 1]) < 0 && (R = 0); _ = (R * Math.cos(f) - u) * p, I = (R * Math.sin(f) - l) * L + a; A.push(_, I) } else if (i === e.POLAR_DEGREE_EQUALITY) for (c = 0; c < n.length; c += 2) { f = n[c] * Math.PI / 180, _ = ((R = n[c + 1]) * Math.cos(f) - u) * p, I = (R * Math.sin(f) - l) * L + a; A.push(_, I) } else if (i === e.POLAR_DEGREE_INEQUALITY) for (c = 0; c < n.length; c += 2) { var R; f = n[c] * Math.PI / 180; (R = n[c + 1]) < 0 && (R = 0); _ = (R * Math.cos(f) - u) * p, I = (R * Math.sin(f) - l) * L + a; A.push(_, I) } return A }, e.clipStrokeEdges = function (n, r) { return t(n, r, e.ALL, !0) }, e.clipFillEdge = r, e.clipFillEdges = t, e.clipAllFillEdges = function (n, r) { return t(n, r, e.ALL, !1) }, e.computePolarFill = function (e, n, r) { var t = [], i = e[0], A = i + r, u = []; t.push(u); for (var l = 0; l < e.length; l += 2) { var E = e[l], s = e[l + 1]; if (s < 0 && (s = 0), E >= A) { for (u = [], t.push(u), A = i = e[l - 2]; E >= A;)A += r; l -= 4 } else u.push(E, s) } if (0 === n) for (l = 0; l < t.length; l++)t[l].push(0, 0); else { var o = r / 16, a = n; for (l = 0; l < t.length; l++) { var p = t[l]; i = p[0]; for (E = A = p[p.length - 2]; E > i; E -= o)p.push(E, a); p.push(i, a) } } return t }, e.computeCartesianFill = function (e, n) { return (e = e.slice()).push(e[e.length - 2], n), e.push(e[0], n), [e] }, e.getClippingGraphType = function (r, t, i) { switch (r) { case n.X: return e.X_EQUALS; case n.IMPLICIT: case n.PARAMETRIC: case n.Y: return e.Y_EQUALS; case n.POLAR: return i.degreeMode ? t ? e.POLAR_DEGREE_INEQUALITY : e.POLAR_DEGREE_EQUALITY : t ? e.POLAR_RADIAN_INEQUALITY : e.POLAR_RADIAN_EQUALITY } } });
define('graphing/svg-classes', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.restore = e.save = void 0, e.save = function (e, s) { var a = e; a._dcgSaveClassName && a._dcgSaveClassName(s) }, e.restore = function (e) { var s = e; s._dcgRestoreClassName && s._dcgRestoreClassName() } });
define('graphing/canvas-labels', ["require", "exports", "tslib", "core/lib/deepCopy", "graphing/svg-classes"], function (require, e, t, r, o) { "use strict"; function n(e, t) { e.translate(t.left, t.top) } function i(e, t) { var r = document.createRange(); r.selectNode(e); var o = r.getBoundingClientRect(); if (o.width > 0 && o.height > 0) { var n = window.getComputedStyle(e.parentElement), i = e.nodeValue || ""; if (i) { var a = -.228 * parseFloat(n.fontSize), l = n.fontStyle + " " + n.fontWeight + " " + n.fontSize + " " + n.fontFamily; return { type: "text", rect: { left: o.left - t.pointCenterX, right: o.right - t.pointCenterY, top: o.top - t.pointCenterY, bottom: o.bottom - t.pointCenterY }, text: i, color: n.color || "#000", font: l, y: o.height + a, hasOutline: t.hasOutline } } } } function a(e, t, r) { e.save(), e.font = t.font, r ? (e.strokeStyle = "#FFF", e.lineWidth = 3, e.miterLimit = 2, e.strokeText(t.text, 0, t.y)) : (e.fillStyle = t.color, e.fillText(t.text, 0, t.y)), e.restore() } function l(e, t, r) { e.save(), r ? (e.strokeStyle = "#FFF", e.lineWidth = 3) : (t.fillColor && (e.fillStyle = t.fillColor), t.strokeColor && (e.strokeStyle = t.strokeColor)), e.beginPath(); for (var o = 0, n = t.instructions; o < n.length; o++) { var i = n[o]; switch (i.type) { case "moveTo": e.moveTo(i.x, i.y); break; case "lineTo": e.lineTo(i.x, i.y); break; case "arcTo": e.arcTo(i.cx, i.cy, i.x, i.y, i.radius); break; case "ellipse": e.ellipse(i.centerX, i.centerY, i.radiusX, i.radiusY, i.rotation, i.startAngle, i.endAngle, i.anticlockwise) } } e.closePath(), r ? e.stroke() : (t.strokeColor && e.stroke(), t.fillColor && e.fill()), e.restore() } function s(e, t) { var r = Math.sqrt(e[0] * e[0] + e[1] * e[1]), o = Math.sqrt(t[0] * t[0] + t[1] * t[1]), n = e[0] * t[0] + e[1] * t[1], i = Math.acos(n / (r * o)); return e[0] * t[1] - e[1] * t[0] < 0 && (i *= -1), i } function c(e, t, r, o, n, i, a, l, c) { var p = Math.cos(n), u = Math.sin(n), h = (e - l) / 2, d = (t - c) / 2, f = p * h + u * d, y = -u * h + p * d, g = r * r, v = o * o, C = f * f, x = y * y, b = Math.sqrt((g * v - g * x - v * C) / (g * x + v * C)); i === a && (b *= -1); var m = b * r * y / o, T = -b * o * f / r, w = [1, 0], k = [(-f - m) / r, (-y - T) / o]; return { centerX: p * m - u * T + (e + l) / 2, centerY: u * m + p * T + (t + c) / 2, radiusX: r, radiusY: o, startAngle: s(w, [(f - m) / r, (y - T) / o]), endAngle: s(w, k), rotation: n, anticlockwise: 0 === a } } Object.defineProperty(e, "__esModule", { value: !0 }), e.drawCommandsToCtx = e.computeDrawingCommandsForDOMLabel = void 0; var p = {}; function u(e, o) { var n = e.childNodes[0]; if (n && "path" === n.nodeName) { var i = e.getBoundingClientRect(); if (i.width > 0 && i.height > 0) { for (var a = function (e, r) { var o = e + "-" + r, n = p[o]; if (n) return n; n = [], p[o] = n; var i = r.split(" "); if (4 !== i.length) return n; var a = parseFloat(i[0]), l = parseFloat(i[2]), s = parseFloat(i[1]), u = parseFloat(i[3]), h = l - a, d = u - s; function f(e) { return (e - a) / h } function y(e) { return (e - s) / d } var g = new RegExp("(M[0-9-.]+ [0-9-.]+)|(L[0-9-.]+ [0-9-.]+)|(A[0-9-.]+ [0-9-.]+ [0-9-.]+ [0-9-.]+ [0-9-.]+ [0-9-.]+ [0-9-.]+)", "g"), v = e.match(g); if (!v || !v.length) return n; for (var C = NaN, x = NaN, b = 0, m = v; b < m.length; b++) { var T = m[b], w = T.substr(1).split(" ").map(parseFloat); switch (T[0]) { case "M": C = f(w[0]), x = y(w[1]), n.push({ type: "moveTo", x: C, y: x }); break; case "L": C = f(w[0]), x = y(w[1]), n.push({ type: "lineTo", x: C, y: x }); break; case "A": var k = w[0] / h, F = w[1] / d, Y = w[2], X = w[3], M = w[4], S = f(w[5]), N = y(w[6]), A = c(C, x, k, F, Y, X, M, S, N); C = S, x = N, n.push(t.__assign({ type: "ellipse" }, A)) } } return n }(n.getAttribute("d") || "", e.getAttribute("viewBox") || ""), l = window.getComputedStyle(e), s = i.width, u = i.height, h = 0, d = a = r.default(a); h < d.length; h++) { var f = d[h]; switch (f.type) { case "moveTo": case "lineTo": f.x *= s, f.y *= u; break; case "arcTo": f.x *= s, f.y *= u, f.cx *= s, f.cy *= u, f.radius *= s; break; case "ellipse": f.centerX *= s, f.centerY *= u, f.radiusX *= s, f.radiusY *= u; break; default: return f } } return { type: "path", rect: { left: i.left - o.pointCenterX, right: i.right - o.pointCenterX, top: i.top - o.pointCenterY, bottom: i.bottom - o.pointCenterY }, fillColor: l.color || "#000", instructions: a } } } } function h(e, t, r) { var o = window.getComputedStyle(e); "0px" !== o.borderTopWidth && ((s = function (e, t, r) { var o = e.getBoundingClientRect(); if (o.width > 0 && o.height > 0) { var n = o.width, i = parseFloat(t.borderTopWidth || "1px"), a = t.borderTopColor || "#000", l = [{ type: "moveTo", x: 0, y: 0 }, { type: "lineTo", x: n, y: 0 }, { type: "lineTo", x: n, y: i }, { type: "lineTo", x: 0, y: i }]; return { type: "path", rect: { left: o.left - r.pointCenterX, right: o.right - r.pointCenterX, top: o.top - r.pointCenterY, bottom: o.bottom - r.pointCenterY }, instructions: l, fillColor: a } } }(e, o, t)) && r.push(s)); for (var n = e.childNodes, a = 0; a < n.length; a++) { var l = n[a]; if (3 === l.nodeType) (s = i(l, t)) && r.push(s); else if ("svg" === l.nodeName) { var s; (s = u(l, t)) && r.push(s) } else 1 === l.nodeType && h(l, t, r) } } e.computeDrawingCommandsForDOMLabel = function (e, t) { var r = []; if (t.hasBorder) { var o = function (e, t) { var r = e.getBoundingClientRect(); if (r.width > 0 && r.height > 0) { var o = -5, n = r.width + 5, i = -5, a = r.height + 5, l = [{ type: "moveTo", x: -2, y: i }, { type: "lineTo", x: n - 3, y: i }, { type: "arcTo", cx: n, cy: i, x: n, y: -2, radius: 3 }, { type: "lineTo", x: n, y: a - 3 }, { type: "arcTo", cx: n, cy: a, x: n - 3, y: a, radius: 3 }, { type: "lineTo", x: -2, y: a }, { type: "arcTo", cx: o, cy: a, x: o, y: a - 3, radius: 3 }, { type: "lineTo", x: o, y: -2 }, { type: "arcTo", cx: o, cy: i, x: -2, y: i, radius: 3 }]; return { type: "path", disableGlow: !0, rect: { left: r.left - t.pointCenterX, right: r.right - t.pointCenterX, top: r.top - t.pointCenterY, bottom: r.bottom - t.pointCenterY }, instructions: l, strokeColor: "#C2C2C2", fillColor: "rgba(255,255,255,.75)" } } }(e, t); o && r.push(o) } return h(e, t, r), r }, e.drawCommandsToCtx = function (e, t) { o.save(t, "dcg-svg-label"), t.save(), o.restore(t); for (var r = 0, i = e; r < i.length; r++) { var s = i[r]; switch (t.save(), n(t, s.rect), s.type) { case "path": s.disableGlow || l(t, s, !0); break; case "text": s.hasOutline && a(t, s, !0); break; default: return s }t.restore() } for (var c = 0, p = e; c < p.length; c++) { s = p[c]; switch (t.save(), n(t, s.rect), s.type) { case "path": l(t, s, !1); break; case "text": a(t, s, !1); break; default: return s }t.restore() } t.restore() } });
define('core/constants', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.CURRENT_API_VERSION = void 0, e.CURRENT_API_VERSION = "v1.8" });
define('main/raf-loop', ['require', 'lib/parse-query-params'], function (require) { "use strict"; var e = (0, require("lib/parse-query-params").getQueryParams)().timeoutLoop; return void 0 !== e ? (e = parseFloat(e), isNaN(e) && (e = 1e3 / 60), function (t) { setTimeout(function i() { setTimeout(i, e), t(Date.now()) }, e) }) : function (e) { requestAnimationFrame(function t(i) { requestAnimationFrame(t), e(i) }) } });
define('main/shared-clock-bus', ["require", "exports", "main/raf-loop", "underscore_model"], function (require, e, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.unsubscribe = e.subscribe = void 0; var i = new r.UnderscoreModel; n(function (e) { i.triggerEvent("tick", e) }); var t = 0; e.subscribe = function (e) { return t += 1, i.observeEvent("tick." + t, function (n, r) { e(r) }), t }, e.unsubscribe = function (e) { i.unobserveEvent("tick." + e) } });
define('core/math/parser/input-span', ["require", "exports"], function (require, n) { "use strict"; function t(n, t, e) { return { input: n, start: t, end: e } } Object.defineProperty(n, "__esModule", { value: !0 }), n.slice = n.joinSpans = n.emptySpanAt = n.Span = void 0, n.Span = t, n.emptySpanAt = function (n, e) { return t(n, e, e) }, n.joinSpans = function (n, e) { if (n.input !== e.input) throw new Error("Programming Error: cannot form a span on different inputs"); return t(n.input, n.start, e.end) }, n.slice = function (n) { return n.input.slice(n.start, n.end) } });
define('core/math/domaintypes', ["require", "exports"], function (require, n) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.intersectDomains = n.allReals = n.linearPositiveDomain = n.knownDomain = n.unknownDomain = n.emptyDomain = void 0; n.emptyDomain = function () { return { type: "empty" } }; n.unknownDomain = function () { return { type: "unknown" } }; n.knownDomain = function (e) { return isNaN(e[0]) || isNaN(e[1]) || e[1] < e[0] ? n.emptyDomain() : { type: "known", bounds: e } }; n.linearPositiveDomain = function (e, o) { if (0 === o) return e > 0 ? n.allReals() : n.emptyDomain(); var t = -e / o, i = o < 0 ? [-1 / 0, t] : [t, 1 / 0]; return n.knownDomain(i) }; n.allReals = function () { return n.knownDomain([-1 / 0, 1 / 0]) }; n.intersectDomains = function (e, o) { if ("empty" === e.type || "empty" === o.type) return n.emptyDomain(); if ("unknown" === e.type || "unknown" === o.type) return n.unknownDomain(); if (e.bounds && o.bounds) { var t = [Math.max(e.bounds[0], o.bounds[0]), Math.min(e.bounds[1], o.bounds[1])]; return n.knownDomain(t) } return n.emptyDomain() } });
define('core/math/types', ["require", "exports", "core/lib/worker-i18n"], function (require, e, t) { "use strict"; var r; function s(t) { switch (t) { case e.Any: return "Any"; case e.Number: return "Number"; case e.Bool: return "Bool"; case e.Point: return "Point"; case e.Distribution: return "Distribution"; case e.Action: return "Action"; case e.ListOfAny: return "ListOfAny"; case e.ListOfNumber: return "ListOfNumber"; case e.ListOfBool: return "ListOfBool"; case e.ListOfPoint: return "ListOfPoint"; case e.ListOfDistribution: return "ListOfDistribution"; case e.EmptyList: return "EmptyList"; case e.ErrorType: return "ErrorType"; case e.SeedType: return "SeedType"; case e.RGBColor: return "RGBColor"; case e.ListOfColor: return "ListOfColor"; case e.Polygon: return "Polygon"; case e.ListOfPolygon: return "ListOfPolygon"; default: throw new Error("Invalid type: " + t) } } Object.defineProperty(e, "__esModule", { value: !0 }), e.isTypeOrListOfType = e.typesMatch = e.isSubType = e.isOneOf = e.hasListType = e.listType = e.elementType = e.isList = e.prettyPrint = e.repr = e.ListOfPolygon = e.Polygon = e.ListOfColor = e.RGBColor = e.SeedType = e.ErrorType = e.EmptyList = e.ListOfDistribution = e.ListOfPoint = e.ListOfBool = e.ListOfNumber = e.ListOfAny = e.Action = e.Distribution = e.Point = e.Bool = e.Number = e.Any = void 0, e.Any = 0, e.Number = 1, e.Bool = 2, e.Point = 3, e.Distribution = 4, e.Action = 5, e.ListOfAny = 6, e.ListOfNumber = 7, e.ListOfBool = 8, e.ListOfPoint = 9, e.ListOfDistribution = 10, e.EmptyList = 11, e.ErrorType = 12, e.SeedType = 13, e.RGBColor = 14, e.ListOfColor = 15, e.Polygon = 16, e.ListOfPolygon = 17, e.repr = s, e.prettyPrint = function (r) { switch (r) { case e.Any: return t.s("shared-calculator-label-value-type-any"); case e.Number: return t.s("shared-calculator-label-value-type-number"); case e.Bool: return t.s("shared-calculator-label-value-type-bool"); case e.Point: return t.s("shared-calculator-label-value-type-point"); case e.Distribution: return t.s("shared-calculator-label-value-type-distribution"); case e.Action: return t.s("shared-calculator-label-value-type-action"); case e.ListOfAny: return t.s("shared-calculator-label-value-type-list-of-any"); case e.ListOfNumber: return t.s("shared-calculator-label-value-type-list-of-numbers"); case e.ListOfBool: return t.s("shared-calculator-label-value-type-list-of-bool"); case e.ListOfPoint: return t.s("shared-calculator-label-value-type-list-of-points"); case e.ListOfDistribution: return t.s("shared-calculator-label-value-type-list-of-distributions"); case e.EmptyList: return t.s("shared-calculator-label-value-type-empty-list"); case e.ErrorType: return t.s("shared-calculator-label-value-type-error"); case e.SeedType: return t.s("shared-calculator-label-value-type-seed"); case e.RGBColor: return t.s("shared-calculator-label-value-type-color"); case e.ListOfColor: return t.s("shared-calculator-label-value-type-list-of-colors"); case e.Polygon: return t.s("shared-calculator-label-value-type-polygon"); case e.ListOfPolygon: return t.s("shared-calculator-label-value-type-list-of-polygons"); default: throw new Error("Invalid type: " + r) } }; (r = {})[e.ListOfAny] = e.Any, r[e.EmptyList] = e.Number, r[e.ListOfNumber] = e.Number, r[e.ListOfBool] = e.Bool, r[e.ListOfPoint] = e.Point, r[e.ListOfDistribution] = e.Distribution, r[e.ListOfColor] = e.RGBColor, r[e.ListOfPolygon] = e.Polygon; function o(t) { switch (t) { case e.ListOfAny: case e.ListOfNumber: case e.ListOfBool: case e.ListOfPoint: case e.ListOfDistribution: case e.ListOfColor: case e.ListOfPolygon: case e.EmptyList: return !0; case e.Any: case e.Number: case e.Bool: case e.Point: case e.Distribution: case e.ErrorType: case e.SeedType: case e.RGBColor: case e.Action: case e.Polygon: return !1; default: throw new Error("Invalid type: " + t) } } function i(t) { switch (t) { case e.EmptyList: case e.ListOfNumber: return e.Number; case e.ListOfBool: return e.Bool; case e.ListOfPoint: return e.Point; case e.ListOfDistribution: return e.Distribution; case e.ListOfColor: return e.RGBColor; case e.ListOfPolygon: return e.Polygon; case e.ListOfAny: return e.Any; case e.Any: case e.Number: case e.Bool: case e.Point: case e.Distribution: case e.ErrorType: case e.SeedType: case e.RGBColor: case e.Action: case e.Polygon: return e.Any; default: throw new Error("Invalid type: " + t) } } function a(t, r) { return !(t !== e.EmptyList || !o(r)) || (!(r !== e.ListOfAny || !o(t)) || t === r) } e.isList = o, e.elementType = i, e.listType = function (t) { switch (t) { case e.Any: return e.ListOfAny; case e.Number: return e.ListOfNumber; case e.Bool: return e.ListOfBool; case e.Point: return e.ListOfPoint; case e.Distribution: return e.ListOfDistribution; case e.RGBColor: return e.ListOfColor; case e.Polygon: return e.ListOfPolygon; case e.EmptyList: case e.ListOfNumber: case e.ListOfBool: case e.ListOfPoint: case e.ListOfDistribution: case e.ListOfColor: case e.ListOfPolygon: case e.ListOfAny: case e.ErrorType: case e.SeedType: case e.Action: throw new Error("Type " + s(t) + " does not implement listType."); default: throw new Error("Invalid type: " + t) } }, e.hasListType = function (t) { switch (t) { case e.Any: case e.Number: case e.Bool: case e.Point: case e.Distribution: case e.RGBColor: case e.Polygon: return !0; case e.EmptyList: case e.ListOfNumber: case e.ListOfBool: case e.ListOfPoint: case e.ListOfDistribution: case e.ListOfColor: case e.ListOfPolygon: case e.ListOfAny: case e.ErrorType: case e.SeedType: case e.Action: return !1; default: throw new Error("Invalid type: " + t) } }, e.isOneOf = function (e, t) { for (var r = 0, s = t; r < s.length; r++) { if (e === s[r]) return !0 } return !1 }, e.isSubType = a, e.typesMatch = function (e, t) { return a(e, t) || a(t, e) }, e.isTypeOrListOfType = function (t, r) { return t === r || !!o(t) && (t === e.EmptyList || i(t) === r) } });
define('core/math/parsenode/base', ['require', 'pjs', 'core/math/parser/input-span', 'core/math/domaintypes', 'core/math/types'], function (require) { "use strict"; var e = require("pjs"), n = require("core/math/parser/input-span"), t = require("core/math/domaintypes"), i = require("core/math/types"); return e(function (e, s, d) { e.init = function () { this._dependencies = [], this._dummyDependencies = [], this._updateSymbols = [], this._scope = { definitions: [], dependencies: [], scopes: [] }, this._exports = [] }, e.exportPenalty = 0, e.setInputSpan = function (e) { this._inputSpan = e }, e.getInputString = function () { return void 0 === this.getInputSpan() ? "" : n.slice(this._inputSpan) }, e.getInputSpan = function () { return this._inputSpan }, e.shouldExportAns = function () { return !1 }, e.getAnsVariable = function () { return this.shouldExportAns() && this.userData && this.userData.hasOwnProperty("index") ? ["ans_" + this.userData.index] : [] }, e.addDependency = function (e) { -1 === this._dependencies.indexOf(e) && this._dependencies.push(e), -1 === this._scope.dependencies.indexOf(e) && this._scope.dependencies.push(e) }, e.addDependencies = function (e) { for (var n = 0; n < e.length; n++)this.addDependency(e[n]) }, e.addDummyDependency = function (e) { -1 === this._dependencies.indexOf(e) && this._dependencies.push(e), -1 === this._dummyDependencies.indexOf(e) && this._dummyDependencies.push(e) }, e.addDummyDependencies = function (e) { for (var n = 0; n < e.length; n++)this.addDummyDependency(e[n]) }, e.addUpdateSymbol = function (e) { -1 === this._dependencies.indexOf(e) && this._dependencies.push(e), -1 === this._updateSymbols.indexOf(e) && this._updateSymbols.push(e) }, e.mergeDependencies = function () { for (var e = 0; e < arguments.length; e++) { var n, t = arguments[e]; for (n = 0; n < t._dependencies.length; n++)-1 === this._dependencies.indexOf(t._dependencies[n]) && this._dependencies.push(t._dependencies[n]); for (n = 0; n < t._updateSymbols.length; n++)-1 === this._updateSymbols.indexOf(t._updateSymbols[n]) && this._updateSymbols.push(t._updateSymbols[n]); for (n = 0; n < t._scope.dependencies.length; n++)-1 === this._scope.dependencies.indexOf(t._scope.dependencies[n]) && this._scope.dependencies.push(t._scope.dependencies[n]); this.addDummyDependencies(t.getDummyDependencies()), Array.prototype.push.apply(this._scope.scopes, t._scope.scopes) } }, e.mergeDependenciesInScope = function (e, n) { this.addDummyDependencies(e); var t = n.getScope(), i = { definitions: e, dependencies: t.dependencies, scopes: t.scopes }; this._scope.scopes.push(i); for (var s = 0; s < n._dependencies.length; s++)-1 === this._dependencies.indexOf(n._dependencies[s]) && this._dependencies.push(n._dependencies[s]); for (s = 0; s < n._updateSymbols.length; s++)-1 === this._updateSymbols.indexOf(n._updateSymbols[s]) && this._updateSymbols.push(n._updateSymbols[s]); this.addDummyDependencies(n.getDummyDependencies()) }, e.getDependencies = function () { return this._dependencies }, e.getDummyDependencies = function () { return this._dummyDependencies }, e.getUpdateSymbols = function () { return this._updateSymbols }, e.getScope = function () { return this._scope }, e.dependsOn = function (e) { return this._dependencies.indexOf(e) > -1 }, e.getExports = function () { return (this._exports || []).concat(this.getAnsVariable()) }, e.getLegalExports = function (e) { return this.getExports().filter(function (n) { return !e.assignmentForbidden(n) }) }, e.exportsSymbol = function (e) { return this._exports.indexOf(e) > -1 }, e.exportTo = function (e, n, t) { for (var i = this.getLegalExports(e), s = 0; s < i.length; s++) { var d = i[s]; if (t[d]) return; t[d] = n.blocksExport ? n : this } }, e.getOperator = function () { return this.operator || "=" }, e.isInequality = function () { return !1 }, e.isShadeBetween = function () { return !1 }, e.getAllIds = function () { return this.userData ? [this.userData.id] : [] }, e.getEvaluationInfo = function () { return !1 }, e.shouldPromoteToSlider = function (e) { return !1 }, e.getSliderVariables = function (e, n) { var t = e.sliderVariables(n.getDependencies()); return n.valueType === i.Point || n.valueType === i.ListOfPoint ? t.filter(function (n) { return !e.validParametricVariable(n) }) : t }, e.getCompiledDerivative = function () { var e = this.getDependencies(); return this.takeDerivative(e[0] || "x").getCompiledFunction() }, e.asValue = function () { }, e.boundDomain = function (e) { return t.unknownDomain() } }) });
define('core/math/parsenode/error', ['require', 'pjs', './base'], function (require) { "use strict"; return require("pjs")(require("./base"), function (t, n) { t.init = function (t) { n.init.call(this), this._msg = t, this.blocksExport = !0 }, t.evaluateOnce = function (t) { return this._msg }, t.isError = !0, t.getError = function () { return this._msg }, t.setDependencies = function (t) { return this.addDependencies(t), this }, t.setActionValue = function (t) { this.actionValue = t }, t.allowExport = function () { return this.blocksExport = !1, this } }) });
define('core/math/distance', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.halfRound = t.approx = t.pointToSegment = t.closestPointOnSegment = t.pointToSegmentParameter = t.mean = t.hypot = void 0; var n = Math.hypot && Math.hypot(1 / 0, NaN) === 1 / 0; function r(t) { return t === 1 / 0 || t === -1 / 0 } function e(n, r, e, o, a, i, u, h, f) { var p = t.hypot(u - o, h - a, f - i); return 0 === p ? 0 : function (t, n, r, e, o, a) { return t * e + n * o + r * a }((n - o) / p, (r - a) / p, (e - i) / p, (u - o) / p, (h - a) / p, (f - i) / p) } function o(t, n, r, o, a, i) { var u = e(t, n, 0, r, o, 0, a, i, 0); return u <= 0 ? [r, o] : u >= 1 ? [a, i] : [r + u * (a - r), o + u * (i - o)] } t.hypot = n ? Math.hypot : function (t, n, e) { if (r(t) || r(n) || void 0 !== e && r(e)) return 1 / 0; if (isNaN(t) || isNaN(n) || void 0 !== e && isNaN(e)) return NaN; if (0 === t && 0 === n && (void 0 === e || 0 === e)) return 0; for (var o = 0, a = 0, i = 0; i < arguments.length; i += 1) { var u = Math.abs(Number(arguments[i])); u > o && (a *= o / u * (o / u), o = u), a += 0 === u && 0 === o ? 0 : u / o * (u / o) } return o === 1 / 0 ? 1 / 0 : o * Math.sqrt(a) }, t.mean = function (t, n) { return t > 0 == n > 0 ? t + .5 * (n - t) : .5 * (t + n) }, t.pointToSegmentParameter = e, t.closestPointOnSegment = o, t.pointToSegment = function (n, r, e, a, i, u) { var h = o(n, r, e, a, i, u); return t.hypot(n - h[0], r - h[1]) }, t.approx = function (t, n, r) { if (void 0 === r && (r = 1), t === n) return !0; if (!isFinite(t) || !isFinite(n)) return !1; if (r > 50) throw new Error("Within " + (52 - r) + " bits isn't really approximate any more"); var e = Math.max(Math.max(Math.abs(t), Math.abs(n)), 1); return e === e + (1 === r ? .5 : Math.pow(.5, r)) * Math.abs(n - t) }, t.halfRound = function (t) { return Math.round(t - .5) + .5 } });
define('core/math/tofraction', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e, r) { if (void 0 === r && (r = 1e6), e === 1 / 0) return { n: 1 / 0, d: 1 }; if (e === -1 / 0) return { n: -1 / 0, d: 1 }; if (!isFinite(e)) return { n: NaN, d: 1 }; for (var n, t, i, u = 0, f = 1, d = 1, o = 0; !(t = (n = Math.floor(e)) * f + u, (i = n * o + d) > r || (u = f, d = o, f = t, o = i, e === n));)e = 1 / (e - n); return { n: f, d: o } } });
define('core/lib/label', ["require", "exports", "underscore", "core/math/distance", "core/math/tofraction"], function (require, e, t, n, r) { "use strict"; function a(e, t) { if (void 0 === t && (t = e), isNaN(e) || !isFinite(e)) return { ariaString: "undefined", string: "undefined", value: e }; if (0 === e) return { ariaString: "0", string: "0", value: e }; Math.abs(e) > Math.abs(t) && (t = e); var a, i = r.default(e / Math.PI, 24); if (m(t) && n.approx(i.n / i.d * Math.PI, e, 3)) return { ariaString: f(a = (0 === i.n ? "0" : 1 === i.n ? "Ï" : -1 === i.n ? "-Ï" : i.n.toString() + "Ï") + (1 === i.d ? "" : "/" + i.d.toString())), string: a, value: i.n / i.d * Math.PI }; if (m(t)) return { ariaString: f(a = function (e) { return "-0" === e ? "0" : e }(l(e.toFixed(v(t))))), string: a, value: parseFloat(a) }; var u = p(e.toExponential(v(t / e))).split("e"), o = u[0] + "Ã10", c = u[1].replace("+", ""); return { ariaString: f(a = p(e.toExponential(v(t / e))).replace("+", "")), string: a, mantissa: o, superscript: c, value: parseFloat(a) } } Object.defineProperty(e, "__esModule", { value: !0 }), e.trimLatex = e.latexToIdentifier = e.identifierToHTML = e.identifierToLatex = e.formatSymbol = e.truncatedAriaLabel = e.truncatedLatexLabel = e.truncatedPlainmathLabel = e.truncatedHTMLLabel = e.numericLabel = e.canDisplayAsFraction = e.point = e.value = void 0, e.value = a; var i = { "[e]": " times 10 to the ", "[+]": " plus ", "[-]": " minus ", "[*]": " times ", "[/]": " over ", "[Ï]": " pi ", "[Ï]": " tau ", "[Î¸]": " theta ", "[Ï]": " phi " }, u = new RegExp(Object.keys(i).join("|"), "gi"); function o(e) { return i["[" + e + "]"] } var c = /(\.)([0-9]+)/g; function s(e, t, n) { return t + n.split("").join(" ").trim() } function f(e) { return e.replace(c, s).replace(u, o).replace(/ +/gi, " ").trim() } e.point = function (e, t, n, r) { var i = a(e, t); return [i, a(r(i.value), n)] }; var d = /\.?0+$/; function l(e) { return -1 === e.indexOf(".") ? e : e.replace(d, "") } function p(e) { return e.replace(/\.?0+e/, "e") } function m(e) { return 1e-4 < (e = Math.abs(e)) && e < 1e7 } function v(e) { return e = Math.abs(e), e = Math.max(e, 1e-16), Math.max(3, Math.floor(4.5 - Math.log(e) / Math.LN10)) } function h(e) { return 1e6 / Math.sqrt(Math.abs(e)) } function b(e) { var t = h(e); if (t < 1) return !1; if (t > 1e12) return !1; var n = r.default(e, t), a = n.n, i = n.d; return 1 !== i && e === e + Math.pow(2, -3) * Math.abs(a / i - e) } function g(e, t) { if (t = t || {}, isNaN(e) || !isFinite(e)) return { type: "undefined" }; if (0 === e || t.zeroCutoff && Math.abs(e) < t.zeroCutoff) return { type: "decimal", value: "0" }; var n = t.smallCutoff || .001, a = t.bigCutoff || 1e6, i = t.digits || 10, u = p(e.toExponential(i - 2)).match(/([\d\.\-]+)e\+?([\d\-]+)/); if (!u) return { type: "undefined" }; var o = parseInt(u[2], 10) >= i; if (b(e) && t.displayAsFraction) { var c = r.default(e, h(e)); return { type: "fraction", numerator: c.n.toString(), denominator: c.d.toString() } } if (Math.abs(e) > a || Math.abs(e) < n || o) return { type: "scientific", mantissa: u[1], exponent: u[2] }; var s = l(e.toPrecision(i)); return e !== Number(s) && t.addEllipses && (s += "..."), { type: "decimal", value: s } } function x(e) { e = e.replace("\\", ""); var t = { pi: "Ï", tau: "Ï", theta: "Î¸", phi: "Ï", div: "Ã·", cdot: "â", times: "Ã", lt: "<", gt: ">", le: "â¤", ge: "â¥", sim: "â¼", ldots: "â¦", prime: "â²", approx: "â", to: "â", "->": "â" }; return t.hasOwnProperty(e) ? t[e] : e } e.canDisplayAsFraction = b, e.numericLabel = g, e.truncatedHTMLLabel = function (e, t) { var n = g(e, t); switch (n.type) { case "undefined": return "undefined"; case "decimal": return n.value; case "scientific": return n.mantissa + "<span class='dcg-cross'>Ã</span>10<sup>" + n.exponent + "</sup>"; case "fraction": return "1" === n.denominator ? n.numerator : n.numerator + "/" + n.denominator; default: return n } }, e.truncatedPlainmathLabel = function (e, t) { var n = g(e, t); switch (n.type) { case "undefined": return "undefined"; case "decimal": return n.value; case "scientific": return n.mantissa + " * 10^" + n.exponent; case "fraction": return "1" === n.denominator ? n.numerator : n.numerator + "/" + n.denominator; default: return n } }, e.truncatedLatexLabel = function (e, t) { var n = g(e, t); switch (n.type) { case "undefined": return "undefined"; case "decimal": return n.value; case "scientific": return n.mantissa + "\\times10^{" + n.exponent + "}"; case "fraction": return "1" === n.denominator ? n.numerator : "-" === n.numerator[0] ? "-\\frac{" + n.numerator.slice(1) + "}{" + n.denominator + "}" : "\\frac{" + n.numerator + "}{" + n.denominator + "}"; default: return n } }, e.truncatedAriaLabel = function (e, t) { var n = g(e, t); switch (n.type) { case "undefined": return "undefined"; case "decimal": return f(n.value); case "scientific": return f(n.mantissa + "e" + n.exponent); case "fraction": return f(n.numerator + "/" + n.denominator); default: return n } }, e.formatSymbol = x, e.identifierToLatex = function (e) { var t = e.match(/^\$(\d+)$/); if (t) return "\\token{" + t[1] + "}"; var n = e.split("_"), r = ""; return n[0].length > 1 && (r += "\\"), r += n[0], n[1] && (r += "_{" + n[1] + "}"), r }, e.identifierToHTML = function (e) { if (!e) return ""; var n = e.split("_").map(x).map(t.escape), r = n[0]; return n[1] && (r += "<sub>" + n[1] + "</sub>"), r }, e.latexToIdentifier = function (e) { var t = e.match(/\\token\{(\d+)\}/); return t ? "$" + t[1] : (e = e.replace(/\\operatorname\{(.*)\}/, "$1")).replace(/[{}\\]/g, "") }, e.trimLatex = function (e) { return e.replace(/^(\\ | |\\space)+/, "").replace(/(\\ | |\\space)+$/, "") } });
define('core/math/errormsg', ["require", "exports", "core/math/parsenode/error", "core/lib/worker-i18n", "core/lib/label", "core/math/types"], function (require, r, e, o, n, t) { "use strict"; function a(r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-multiply-defined", { dependency: r })) } function i(r) { var t = (r = r.map(n.formatSymbol)).pop() || ""; return e(o.s("shared-calculator-error-dependency-cycle", { symbols: r.join("', '"), lastSymbol: t })) } Object.defineProperty(r, "__esModule", { value: !0 }), r.variableLengthProductBodyDependsOnIndex = r.variableLengthSumBodyDependsOnIndex = r.variableLengthDistributionList = r.variableLengthTopLevelList = r.badListComprehensionInputDependency = r.shadowedListComprehensionInput = r.unexpectedForKeyword = r.listComprehensionIncorrectInput = r.listComprehensionInputListTypeError = r.matrixInvalidVariable = r.matrixElementTypeError = r.matrixPowerDimensions = r.matrixFractionalPower = r.matrixMultiplyDimensions = r.matrixSubtractDimensions = r.matrixAddDimensions = r.matrixAssignment = r.clickableObjectInvalidExpression = r.clickableObjectAssignmentNotIdentifier = r.clickableObjectAlreadyAssigned = r.clickableObjectAssignmentNotDefined = r.singularInverse = r.nonSquareInverse = r.nonSquareTrace = r.nonSquareDeterminant = r.fractionsUnavailable = r.featureUnavailable = r.pointsUnsupported = r.regressionsUnsupported = r.inequalitiesUnsupported = r.equationsUnsupported = r.functionDefinitionsUnsupported = r.assignmentsUnsupported = r.variableUnsupported = r.constantUnsupported = r.logbaseUnsupported = r.functionUnsupported = r.variablesUnsupported = r.ansUndefined = r.badSymbolContext = r.variableSeed = r.badSampleSize = r.ttestListTooShort = r.illegalBinWidth = r.percentMissingOf = r.badIntegralBoundDependency = r.shadowedIntegrationVariable = r.mismatchedBraces = r.derivativeMissingBody = r.integralMissingBody = r.productMissingBody = r.sumMissingBody = r.differentialWithSuperscript = r.integralMissingDifferential = r.integralMissingBound = r.badProductBoundDependency = r.badSumBoundDependency = r.incorrectProductLowerBound = r.incorrectSumLowerBound = r.productMissingBound = r.sumMissingBound = r.invalidHalfEmptyRange = r.nonArithmeticRange = r.functionFreeVariable = r.methodRequiresList = r.nonListParameterizedReducer = r.nonListDoubleReducer = r.optimizationError = r.invalidRegressionParameter = r.invalidDependentFirstTableColumn = r.invalidFirstTableColumn = r.invalidTableEntry = r.invalidTableHeader = r.distributionAsFunction = r.variableAsFunction = r.equationRequired = r.complicatedDoubleInequality = r.mismatchedDoubleInequality = r.invalidDoubleInequalityVariables = r.complicatedPolarImplicit = r.inequalitiesDisabled = r.implicitsDisabled = r.singleVariableImplicitEquationsDisabled = r.invalidImplicitVariables = r.invalidInequalityVariables = r.unplottablePolarFunction = r.invalidLHS = r.addArgumentsToDefinition = r.tooManyVariables = r.cdfMaxLessThanMin = r.cdfMaxInvalid = r.cdfMinInvalid = r.domainMaxLessThanMin = r.domainMaxInvalid = r.domainMinInvalid = r.sliderStepInvalid = r.sliderMaxLessThanMin = r.sliderMaxInvalid = r.sliderMinInvalid = r.sliderLimitReferencesExport = r.tickerMinStepNonNegativeNumber = r.selfReferentialFunction = r.tableCycleWithoutGlobalDefinition = r.cycle = r.shadowedIndex = r.multiplyDefinedByTables = r.multiplyDefined = r.cannotSubscript = r.cannotRedefine = r.parameterAlreadyDefined = r.functionNotDefined = r.blankExpression = r.colonMissingCondition = r.piecewisePartMissingCondition = r.piecewiseMissingCondition = r.inequalityChainTooLong = r.badLogExponent = r.badTrigExponent = r.emptyPipe = r.emptySquareBracket = r.emptyParen = r.emptyRadicalIndex = r.emptyRadical = r.primeWithoutParen = r.unexpectedPrime = r.superscriptWithPrime = r.unexpectedSubscript = r.invalidOperatorName = r.invalidSubscript = r.emptySuperscript = r.emptySubscript = r.fractionEmpty = r.fractionMissingDenominator = r.fractionMissingNumerator = r.unaryOperatorMissingRight = r.unaryOperatorMissingLeft = r.binaryOperatorMissingOperand = r.identifierAsFunction = r.tokenWithSubscript = r.adjacentNumbers = r.badImplicitCall = r.badTupleDimensions = r.malformedList = r.malformedPoint = r.zeroArgReducer = r.primedFunctionArity = r.wrongDoubleReducerArity = r.wrongParameterizedReducerArity = r.wrongArity = r.colorArity = r.randomFromBroadcastDistribution = r.randomArity = r.tdistWrongArity = r.cdfTooManyArguments = r.cdfRequiresArguments = r.pdfWrongArity = r.tooManyArguments = r.boxplotBreadthInvalid = r.boxplotOffsetInvalid = r.polygonTwoNumbersError = r.polygonPointArgsError = r.polygonListTypeError = r.maxListSize = r.deeplyNested = r.combineTypeError = r.heterogeneousList = r.eventHandlerTypeError = r.actionMergeFreeVariable = r.updateRuleLocalLHS = r.updateRuleFunctionLHS = r.updateRuleIllegalLHS = r.updateRuleUndefinedLHS = r.duplicateUpdateRules = r.updateRuleNonIdentifierLHS = r.updateRuleTypeError = r.regressionTypeError = r.tableEntryTypeError = r.tableHeaderTypeError = r.piecewiseBranchTypeError = r.piecewiseConditionTypeError = r.derivativeVariableTypeError = r.derivativeTypeError = r.integralArgumentTypeError = r.integralUpperBoundTypeError = r.integralLowerBoundTypeError = r.productArgumentTypeError = r.productInfiniteBoundError = r.productUpperBoundTypeError = r.productLowerBoundTypeError = r.sumArgumentTypeError = r.sumInfiniteBoundError = r.sumUpperBoundTypeError = r.sumLowerBoundTypeError = r.dotLHSTypeError = r.illegalDotCall = r.functionTypeError = r.orderedPairAccessTypeError = r.indexTypeError = r.pointTypeError = r.listTypeError = r.andTypeError = r.comparatorTypeError = r.negativeTypeError = r.exponentTypeError = r.divideTypeError = r.multiplyTypeError = r.subtractTypeError = r.addTypeError = r.unexpectedSymbol = r.unexpectedInequality = r.unrecognizedSymbol = r.parseError = void 0, r.parseError = function () { return e(o.s("shared-calculator-error-parse-error")) }, r.unrecognizedSymbol = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-unrecognized-symbol", { symbol: r })) }, r.unexpectedInequality = function () { return e(o.s("shared-calculator-error-unexpected-inequality")) }, r.unexpectedSymbol = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-unexpected-symbol", { symbol: r })) }, r.addTypeError = function (r) { return e(o.s("shared-calculator-error-add-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.subtractTypeError = function (r) { return e(o.s("shared-calculator-error-subtract-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.multiplyTypeError = function (r) { return e(o.s("shared-calculator-error-multiply-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.divideTypeError = function (r) { return e(o.s("shared-calculator-error-divide-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.exponentTypeError = function (r) { return e(o.s("shared-calculator-error-exponent-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.negativeTypeError = function (r) { return e(o.s("shared-calculator-error-negative-type-error", { symbol: r[0] })).allowExport() }, r.comparatorTypeError = function (r) { return e(o.s("shared-calculator-error-comparator-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.andTypeError = function (r) { return e(o.s("shared-calculator-error-and-type-error", { symbol: "and", symbol1: r[0], symbol2: r[1] })).allowExport() }, r.listTypeError = function (r) { return e(o.s("shared-calculator-error-list-type-error", { symbol1: r[0] })).allowExport() }, r.pointTypeError = function (r) { return e(o.s("shared-calculator-error-point-type-error", { symbol1: r, symbol2: t.prettyPrint(t.Point) })).allowExport() }, r.indexTypeError = function (r) { return e(o.s("shared-calculator-error-index-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.orderedPairAccessTypeError = function (r) { return e(o.s("shared-calculator-error-ordered-pair-access-type-error", { symbol: r[0] })).allowExport() }, r.functionTypeError = function (r, t) { switch (t.length) { case 1: return e(o.s("shared-calculator-error-function-type-error-1", { fn: n.formatSymbol(r), arg: t[0] })).allowExport(); case 2: return e(o.s("shared-calculator-error-function-type-error-2", { fn: n.formatSymbol(r), arg1: t[0], arg2: t[1] })).allowExport(); default: return e(o.s("shared-calculator-error-function-type-error-many", { fn: n.formatSymbol(r) })).allowExport() } }, r.illegalDotCall = function (r) { return e(o.s("shared-calculator-error-illegal-dot-call", { symbol: n.formatSymbol(r) })) }, r.dotLHSTypeError = function (r, t) { return e(o.s("shared-calculator-error-dot-lhs-type-error", { symbol: n.formatSymbol(r), type: t })).allowExport() }, r.sumLowerBoundTypeError = function (r) { return e(o.s("shared-calculator-error-sum-lower-bound-type-error", { symbol: r[0] })).allowExport() }, r.sumUpperBoundTypeError = function (r) { return e(o.s("shared-calculator-error-sum-upper-bound-type-error", { symbol: r[0] })).allowExport() }, r.sumInfiniteBoundError = function () { return e(o.s("shared-calculator-error-sum-infinite-bound-type-error")) }, r.sumArgumentTypeError = function (r) { return e(o.s("shared-calculator-error-sum-argument-type-error", { symbol: r[0] })).allowExport() }, r.productLowerBoundTypeError = function (r) { return e(o.s("shared-calculator-error-product-lower-bound-type-error", { symbol: r[0] })).allowExport() }, r.productUpperBoundTypeError = function (r) { return e(o.s("shared-calculator-error-product-upper-bound-type-error", { symbol: r[0] })).allowExport() }, r.productInfiniteBoundError = function () { return e(o.s("shared-calculator-error-product-infinite-bound-type-error")) }, r.productArgumentTypeError = function (r) { return e(o.s("shared-calculator-error-product-argument-type-error", { symbol: r[0] })).allowExport() }, r.integralLowerBoundTypeError = function (r) { return e(o.s("shared-calculator-error-integral-lower-bound-type-error", { symbol: r[0] })).allowExport() }, r.integralUpperBoundTypeError = function (r) { return e(o.s("shared-calculator-error-integral-upper-bound-type-error", { symbol: r[0] })).allowExport() }, r.integralArgumentTypeError = function (r) { return e(o.s("shared-calculator-error-integral-argument-type-error", { symbol: r[0] })).allowExport() }, r.derivativeTypeError = function (r) { return e(o.s("shared-calculator-error-derivative-type-error", { symbol: r[0] })).allowExport() }, r.derivativeVariableTypeError = function (r, t) { return e(o.s("shared-calculator-error-derivative-variable-type-error", { symbol1: n.formatSymbol(r), symbol2: t[0] })) }, r.piecewiseConditionTypeError = function (r) { return e(o.s("shared-calculator-error-piecewise-condition-type-error", { symbol1: t.prettyPrint(t.Bool), symbol2: r[0] })).allowExport() }, r.piecewiseBranchTypeError = function (r) { return e(o.s("shared-calculator-error-piecewise-branch-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.tableHeaderTypeError = function (r) { return e(o.s("shared-calculator-error-table-header-type-error", { symbol: r[0] })) }, r.tableEntryTypeError = function (r) { return e(o.s("shared-calculator-error-table-entry-type-error", { symbol: r[0] })) }, r.regressionTypeError = function (r) { return e(o.s("shared-calculator-error-regression-type-error", { symbol1: r[0], symbol2: r[1] })) }, r.updateRuleTypeError = function (r) { return e(o.s("shared-calculator-error-update-rule-type-error", { symbol: r })) }, r.updateRuleNonIdentifierLHS = function () { return e(o.s("shared-calculator-error-update-rule-non-identifier-lhs", { arrow: "â", example: "a" })) }, r.duplicateUpdateRules = function (r) { return e(o.s("shared-calculator-error-duplicate-update-rules", { symbol: n.formatSymbol(r) })) }, r.updateRuleUndefinedLHS = function (r) { return e(o.s("shared-calculator-error-update-rule-undefined-lhs", { symbol: n.formatSymbol(r) })) }, r.updateRuleIllegalLHS = function (r) { return e(o.s("shared-calculator-error-update-rule-illegal-lhs", { symbol: n.formatSymbol(r) })) }, r.updateRuleFunctionLHS = function (r) { return e(o.s("shared-calculator-error-update-rule-function-lhs", { symbol: n.formatSymbol(r) })) }, r.updateRuleLocalLHS = function (r) { return e(o.s("shared-calculator-error-update-rule-local-lhs", { symbol: n.formatSymbol(r) })) }, r.actionMergeFreeVariable = function (r) { var t = r.filter(function (r) { return "free" === r.scope }).map(function (r) { return r.symbol }); return e(o.s("shared-calculator-error-action-merge-free-variable", { symbol: n.formatSymbol(t[0] || "") })).setDependencies(t).allowExport() }, r.eventHandlerTypeError = function (r) { return e(o.s("shared-calculator-error-event-handler-type-error", { example: "aâa+1" })) }, r.heterogeneousList = function () { return e(o.s("shared-calculator-error-heterogeneous-list")).allowExport() }, r.combineTypeError = function (r) { return e(o.s("shared-calculator-error-combine-type-error", { symbol1: r[0], symbol2: r[1] })).allowExport() }, r.deeplyNested = function () { return e(o.s("shared-calculator-error-deeply-nested")).allowExport() }, r.maxListSize = function (r) { return e(o.s("shared-calculator-error-max-list-size", { maxListSize: r })).allowExport() }, r.polygonListTypeError = function (r) { return e(o.s("shared-calculator-error-polygon-list-type-error", { type: r[0] })) }, r.polygonPointArgsError = function () { return e(o.s("shared-calculator-error-polygon-point-args-error")) }, r.polygonTwoNumbersError = function () { return e(o.s("shared-calculator-error-two-numbers-error")) }, r.boxplotOffsetInvalid = function () { return e(o.s("shared-calculator-error-boxplot-offset-invalid")) }, r.boxplotBreadthInvalid = function () { return e(o.s("shared-calculator-error-boxplot-breadth-invalid")) }, r.tooManyArguments = function (r, n) { return e(o.s("shared-calculator-error-too-many-arguments", { symbol: r, max: n })) }, r.pdfWrongArity = function () { var r = o.s("shared-calculator-error-pdf-wrong-arity-recommendation"), n = o.s("shared-calculator-error-pdf-wrong-arity", { recommendation: r }); return e(n) }, r.cdfRequiresArguments = function () { var r = o.s("shared-calculator-error-cdf-wrong-arity-recommendation"), n = o.s("shared-calculator-error-cdf-wrong-arity", { recommendation: r }); return e(n) }, r.cdfTooManyArguments = function () { var r = o.s("shared-calculator-error-cdf-too-many-arguments-recommendation"), n = o.s("shared-calculator-error-cdf-too-many-arguments", { recommendation: r }); return e(n) }, r.tdistWrongArity = function () { return e(o.s("shared-calculator-error-tdist-wrong-arity")) }, r.randomArity = function () { return e(o.s("shared-calculator-error-random-arity")) }, r.randomFromBroadcastDistribution = function () { return e(o.s("shared-calculator-error-random-from-broadcast-distribution")) }, r.colorArity = function (r) { var t = "rgb" === r ? [150, 30, 100] : [180, .5, .5], a = o.s("shared-calculator-error-color-arity-recommendation", { recommendation: n.formatSymbol(r) + "(" + t.join(", ") + ")" }), i = o.s("shared-calculator-error-color-arity", { symbol: r, recommendation: a }); return e(i) }, r.wrongArity = function (r, t, a, i) { var l, s; if (r = n.formatSymbol(r), 1 === t) i || (i = r + "(x)"), s = o.s("shared-calculator-error-wrong-arity-supplement", { recommendation: i }), l = a > 1 ? o.s("shared-calculator-error-wrong-arity-single-arg-too-many", { dependency: r, supplement: s }) : o.s("shared-calculator-error-wrong-arity-single-arg-too-few", { dependency: r, supplement: s }); else { var u = []; if (!i) { for (var c = 0; c < t; c++)u[c] = c + 1; i = n.formatSymbol(r) + "(" + u.join(", ") + ")" } s = o.s("shared-calculator-error-wrong-arity-supplement", { recommendation: i }), l = o.s("shared-calculator-error-wrong-arity-many-arg", { dependency: r, assignment_arity: t, supplement: s }) } return e(l) }, r.wrongParameterizedReducerArity = function (r) { return e(o.s("shared-calculator-error-wrong-two-arg-arity", { symbol: n.formatSymbol(r), recommendation: n.formatSymbol(r) + "([1,2,3], 1)" })) }, r.wrongDoubleReducerArity = function (r) { return e(o.s("shared-calculator-error-wrong-two-arg-arity", { symbol: n.formatSymbol(r), recommendation: n.formatSymbol(r) + "([1,2,3], [3,2,1])" })) }, r.primedFunctionArity = function () { return e(o.s("shared-calculator-error-primed-function-arity")) }, r.zeroArgReducer = function (r) { return e(o.s("shared-calculator-error-zero-arg-reducer", { symbol: n.formatSymbol(r) })) }, r.malformedPoint = function () { return e(o.s("shared-calculator-error-malformed-point")) }, r.malformedList = function () { return e(o.s("shared-calculator-error-malformed-list")) }, r.badTupleDimensions = function (r) { return e(o.s("shared-calculator-error-bad-tuple-dimensions", { symbol: r })) }, r.badImplicitCall = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-bad-implicit-call", { symbol: r })) }, r.adjacentNumbers = function (r, n) { return e(o.s("shared-calculator-error-adjacent-numbers", { left: r, right: n })) }, r.tokenWithSubscript = function () { return e(o.s("shared-calculator-error-token-with-subscript")) }, r.identifierAsFunction = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-identifier-as-function", { symbol: r })) }, r.binaryOperatorMissingOperand = function (r) { return "%" === (r = n.formatSymbol(r)) && (r = "% of"), e(o.s("shared-calculator-error-binary-operator-missing-operand", { symbol: r })) }, r.unaryOperatorMissingLeft = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-unary-operator-missing-left", { symbol: r })) }, r.unaryOperatorMissingRight = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-unary-operator-missing-right", { symbol: r })) }, r.fractionMissingNumerator = function () { return e(o.s("shared-calculator-error-fraction-missing-numerator")) }, r.fractionMissingDenominator = function () { return e(o.s("shared-calculator-error-fraction-missing-denominator")) }, r.fractionEmpty = function () { return e(o.s("shared-calculator-error-fraction-empty")) }, r.emptySubscript = function () { return e(o.s("shared-calculator-error-empty-subscript")) }, r.emptySuperscript = function () { return e(o.s("shared-calculator-error-empty-superscript")) }, r.invalidSubscript = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-invalid-subscript", { symbol: r })) }, r.invalidOperatorName = function () { return e(o.s("shared-calculator-error-invalid-operator-name")) }, r.unexpectedSubscript = function () { return e(o.s("shared-calculator-error-unexpected-subscript")) }, r.superscriptWithPrime = function () { return e(o.s("shared-calculator-error-superscript-with-prime")) }, r.unexpectedPrime = function () { return e(o.s("shared-calculator-error-unexpected-prime")) }, r.primeWithoutParen = function () { return e(o.s("shared-calculator-error-prime-without-paren")) }, r.emptyRadical = function () { return e(o.s("shared-calculator-error-empty-radical")) }, r.emptyRadicalIndex = function () { return e(o.s("shared-calculator-error-empty-radical-index")) }, r.emptyParen = function () { return e(o.s("shared-calculator-error-empty-paren")) }, r.emptySquareBracket = function () { return e(o.s("shared-calculator-error-empty-square-bracket")) }, r.emptyPipe = function () { return e(o.s("shared-calculator-error-empty-pipe")) }, r.badTrigExponent = function (r) { var n = r + "^2", t = r + "^-1"; return e(o.s("shared-calculator-error-bad-trig-exponent", { form1: n, form2: t })) }, r.badLogExponent = function (r) { var n = r + "^2"; return e(o.s("shared-calculator-error-bad-log-exponent", { form: n })) }, r.inequalityChainTooLong = function () { return e(o.s("shared-calculator-error-inequality-chain-too-long")) }, r.piecewiseMissingCondition = function () { return e(o.s("shared-calculator-error-piecewise-missing-condition")) }, r.piecewisePartMissingCondition = function () { return e(o.s("shared-calculator-error-piecewise-part-missing-condition")) }, r.colonMissingCondition = function () { return e(o.s("shared-calculator-error-colon-missing-condition")) }, r.blankExpression = function () { return e(o.s("shared-calculator-error-blank-expression")) }, r.functionNotDefined = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-function-not-defined", { dependency: r })) }, r.parameterAlreadyDefined = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-parameter-already-defined", { dependency: r })) }, r.cannotRedefine = function (r, t) { return r = n.formatSymbol(r), e(void 0 === t ? o.s("shared-calculator-error-cannot-redefine", { symbol: r }) : o.s("shared-calculator-error-cannot-redefine-root", { symbol: r, symbolRoot: t })) }, r.cannotSubscript = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-cannot-subscript", { symbol: r })) }, r.multiplyDefined = a, r.multiplyDefinedByTables = function (r) { var e = a(r); return e.isMultiplyDefinedByTables = !0, e }, r.shadowedIndex = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-shadowed-index", { symbol: r })) }, r.cycle = i, r.tableCycleWithoutGlobalDefinition = function (r) { var e = i(r); return e.isTableCycleWithoutGlobalDefinition = !0, e }, r.selfReferentialFunction = function (r) { return e(o.s("shared-calculator-error-self-referential-function", { symbol: n.formatSymbol(r) })) }, r.tickerMinStepNonNegativeNumber = function () { return e(o.s("shared-calculator-error-ticker-min-step-nonnegative")) }, r.sliderLimitReferencesExport = function (r) { return e(o.s("shared-calculator-error-slider-limit-references-export", { symbol: n.formatSymbol(r) })) }, r.sliderMinInvalid = function () { return e(o.s("shared-calculator-error-slider-min-invalid")) }, r.sliderMaxInvalid = function () { return e(o.s("shared-calculator-error-slider-max-invalid")) }, r.sliderMaxLessThanMin = function () { return e(o.s("shared-calculator-error-slider-max-less-than-min")) }, r.sliderStepInvalid = function () { return e(o.s("shared-calculator-error-slider-step-invalid")) }, r.domainMinInvalid = function () { return e(o.s("shared-calculator-error-domain-min-invalid")) }, r.domainMaxInvalid = function () { return e(o.s("shared-calculator-error-domain-max-invalid")) }, r.domainMaxLessThanMin = function () { return e(o.s("shared-calculator-error-domain-max-less-than-min")) }, r.cdfMinInvalid = function () { return e(o.s("shared-calculator-error-cdf-min-invalid")) }, r.cdfMaxInvalid = function () { return e(o.s("shared-calculator-error-cdf-max-invalid")) }, r.cdfMaxLessThanMin = function () { return e(o.s("shared-calculator-error-cdf-max-less-than-min")) }, r.tooManyVariables = function (r) { if (0 === (r = r.map(n.formatSymbol)).length) return e(o.s("shared-calculator-error-too-many-variables-no-symbols")); var t = r.pop() || ""; return r.length > 0 ? e(o.s("shared-calculator-error-too-many-variables-many-symbols", { variables: r.join("', '"), lastVariable: t })) : e(o.s("shared-calculator-error-too-many-variables-one-symbol", { variable: t })) }, r.addArgumentsToDefinition = function (r, t, a) { r = r.map(n.formatSymbol); var i = (t = n.formatSymbol(t)) + "(" + (a = a.map(n.formatSymbol)).join(",") + "," + r.join(",") + ")", l = r.pop() || "", s = { symbols: r.join("', '"), lastSymbol: l, newSignature: i }; return r.length ? e(o.s("shared-calculator-error-add-arguments-to-definition-many", s)) : e(o.s("shared-calculator-error-add-arguments-to-definition-one", s)) }, r.invalidLHS = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-invalid-lhs", { symbol: r })) }, r.unplottablePolarFunction = function () { return e(o.s("shared-calculator-error-unplottable-polar-function")) }, r.invalidInequalityVariables = function () { return e(o.s("shared-calculator-error-invalid-inequality-variables")) }, r.invalidImplicitVariables = function () { return e(o.s("shared-calculator-error-invalid-implicit-variables")) }, r.singleVariableImplicitEquationsDisabled = function () { return e(o.s("shared-calculator-error-single-variable-implicit-equations-disabled")) }, r.implicitsDisabled = function () { return e(o.s("shared-calculator-error-implicits-disabled")) }, r.inequalitiesDisabled = function () { return e(o.s("shared-calculator-error-inequalities-disabled")) }, r.complicatedPolarImplicit = function () { return e(o.s("shared-calculator-error-complicated-polar-implicit")) }, r.invalidDoubleInequalityVariables = function () { return e(o.s("shared-calculator-error-invalid-double-inequality-variables")) }, r.mismatchedDoubleInequality = function () { return e(o.s("shared-calculator-error-mismatched-double-inequality", { example: "1 < y < 2" })) }, r.complicatedDoubleInequality = function () { return e(o.s("shared-calculator-error-complicated-double-inequality")) }, r.equationRequired = function (r) { return r ? (r = n.formatSymbol(r), e(o.s("shared-calculator-error-equation-required-symbol", { lhs: r + "=" }))) : e(o.s("shared-calculator-error-equation-required")) }, r.variableAsFunction = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-variable-as-function", { dependency: r })) }, r.distributionAsFunction = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-distribution-as-function", { symbol: r })) }, r.invalidTableHeader = function (r) { return e(o.s("shared-calculator-error-invalid-table-header", { supplement: r })) }, r.invalidTableEntry = function (r) { return e(o.s("shared-calculator-error-invalid-table-entry", { supplement: r })) }, r.invalidFirstTableColumn = function () { return e(o.s("shared-calculator-error-invalid-first-table-column", { most: "'y', 'r',", last: "'Î¸'" })) }, r.invalidDependentFirstTableColumn = function () { return e(o.s("shared-calculator-error-invalid-dependent-first-table-column")) }, r.invalidRegressionParameter = function (r) { return e(o.s("shared-calculator-error-invalid-regression-parameter", { symbol: n.formatSymbol(r) })) }, r.optimizationError = function () { return e(o.s("shared-calculator-error-optimization-error")) }, r.nonListDoubleReducer = function (r) { return e(o.s("shared-calculator-error-non-list-double-reducer", { symbol: n.formatSymbol(r), recommendation: n.formatSymbol(r) + "([1,2,3], [3,2,1])" })).allowExport() }, r.nonListParameterizedReducer = function (r) { return e(o.s("shared-calculator-error-non-list-parameterized-reducer", { symbol: n.formatSymbol(r), recommendation: n.formatSymbol(r) + "([1,2,3], 1)" })).allowExport() }, r.methodRequiresList = function (r) { return e(o.s("shared-calculator-error-method-requires-list", { symbol: n.formatSymbol(r), recommendation: n.formatSymbol(r) + "([1,2,3])" })).allowExport() }, r.functionFreeVariable = function (r, n) { return e(o.s("shared-calculator-error-variable-function-free-variable", { functionSymbol: r, variableSymbol: n })).allowExport() }, r.nonArithmeticRange = function () { return e(o.s("shared-calculator-error-non-arithmetic-range")).allowExport() }, r.invalidHalfEmptyRange = function () { return e(o.s("shared-calculator-error-invalid-half-empty-range")) }, r.sumMissingBound = function () { return e(o.s("shared-calculator-error-sum-missing-bound")) }, r.productMissingBound = function () { return e(o.s("shared-calculator-error-product-missing-bound")) }, r.incorrectSumLowerBound = function () { return e(o.s("shared-calculator-error-incorrect-sum-lower-bound")) }, r.incorrectProductLowerBound = function () { return e(o.s("shared-calculator-error-incorrect-product-lower-bound")) }, r.badSumBoundDependency = function (r) { return e(o.s("shared-calculator-error-bad-sum-bound-dependency", { symbol: n.formatSymbol(r) })) }, r.badProductBoundDependency = function (r) { return e(o.s("shared-calculator-error-bad-product-bound-dependency", { symbol: n.formatSymbol(r) })) }, r.integralMissingBound = function () { return e(o.s("shared-calculator-error-integral-missing-bound")) }, r.integralMissingDifferential = function () { return e(o.s("shared-calculator-error-integral-missing-differential")) }, r.differentialWithSuperscript = function () { return e(o.s("shared-calculator-error-differential-with-superscript")) }, r.sumMissingBody = function () { return e(o.s("shared-calculator-error-sum-missing-body")) }, r.productMissingBody = function () { return e(o.s("shared-calculator-error-product-missing-body")) }, r.integralMissingBody = function () { return e(o.s("shared-calculator-error-integral-missing-body")) }, r.derivativeMissingBody = function () { return e(o.s("shared-calculator-error-derivative-missing-body")) }, r.mismatchedBraces = function (r, t) { return r = n.formatSymbol(r), t = n.formatSymbol(t), e(o.s("shared-calculator-error-mismatched-braces", { symbol1: r, symbol2: t })) }, r.shadowedIntegrationVariable = function (r) { return e(o.s("shared-calculator-error-shadowed-integration-variable", { symbol: n.formatSymbol(r) })) }, r.badIntegralBoundDependency = function (r) { return e(o.s("shared-calculator-error-bad-integral-bound-dependency", { symbol: n.formatSymbol(r) })) }, r.percentMissingOf = function () { return e(o.s("shared-calculator-error-percent-missing-of")) }, r.illegalBinWidth = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-illegal-bin-width", { symbol: r })) }, r.ttestListTooShort = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-ttest-list-too-short", { symbol: r })) }, r.badSampleSize = function () { return e(o.s("shared-calculator-error-bad-sample-size")) }, r.variableSeed = function (r) { return e(o.s("shared-calculator-error-variable-seed", { symbol: n.formatSymbol(r[0].symbol) })).setDependencies(r.filter(function (r) { return "free" === r.scope }).map(function (r) { return r.symbol })).allowExport() }, r.badSymbolContext = function (r) { return e(o.s("shared-calculator-error-bad-symbol-context", { symbol: n.formatSymbol(r) })) }, r.ansUndefined = function () { return e(o.s("shared-calculator-error-ans-undefined")) }, r.variablesUnsupported = function (r) { return e(o.s("shared-calculator-error-variables-unsupported", { variable: n.formatSymbol(r) })) }, r.functionUnsupported = function (r) { return e(o.s("shared-calculator-error-function-unsupported", { symbol: n.formatSymbol(r) })) }, r.logbaseUnsupported = function () { return e(o.s("shared-calculator-error-logbase-unsupported")) }, r.constantUnsupported = function (r) { return e(o.s("shared-calculator-error-constant-unsupported", { symbol: n.formatSymbol(r) })) }, r.variableUnsupported = function (r) { return e(o.s("shared-calculator-error-variable-unsupported", { symbol: n.formatSymbol(r) })) }, r.assignmentsUnsupported = function () { return e(o.s("shared-calculator-error-assignments-unsupported")) }, r.functionDefinitionsUnsupported = function () { return e(o.s("shared-calculator-error-function-definition-unsupported")) }, r.equationsUnsupported = function () { return e(o.s("shared-calculator-error-equations-unsupported")) }, r.inequalitiesUnsupported = function () { return e(o.s("shared-calculator-error-inequalities-unsupported")) }, r.regressionsUnsupported = function () { return e(o.s("shared-calculator-error-regressions-unsupported")) }, r.pointsUnsupported = function () { return e(o.s("shared-calculator-error-points-unsupported")) }, r.featureUnavailable = function () { return e(o.s("shared-calculator-error-feature-unavailable")) }, r.fractionsUnavailable = function () { return e(o.s("basic-calculator-error-fractions-unavailable")) }, r.nonSquareDeterminant = function () { return e(o.s("shared-calculator-error-non-square-determinant")) }, r.nonSquareTrace = function () { return e(o.s("shared-calculator-error-non-square-trace")) }, r.nonSquareInverse = function () { return e(o.s("shared-calculator-error-non-square-inverse")) }, r.singularInverse = function () { return e(o.s("shared-calculator-error-non-singular-inverse")) }, r.clickableObjectAssignmentNotDefined = function (r) { return e(o.s("shared-calculator-error-clickable-object-assignment-not-defined", { symbol: r })) }, r.clickableObjectAlreadyAssigned = function (r) { return e(o.s("shared-calculator-error-multiply-defined", { dependency: r })) }, r.clickableObjectAssignmentNotIdentifier = function () { return e(o.s("shared-calculator-error-clickable-object-assignment-not-identifier")) }, r.clickableObjectInvalidExpression = function () { return e(o.s("shared-calculator-error-clickable-object-invalid-expression")) }, r.matrixAssignment = function () { return e(o.s("shared-calculator-error-matrix-assignment")) }, r.matrixAddDimensions = function () { return e(o.s("shared-calculator-error-matrix-add-dimensions")) }, r.matrixSubtractDimensions = function () { return e(o.s("shared-calculator-error-matrix-subtract-dimensions")) }, r.matrixMultiplyDimensions = function () { return e(o.s("shared-calculator-error-matrix-multiply-dimensions")) }, r.matrixFractionalPower = function () { return e(o.s("shared-calculator-error-matrix-fractional-power")) }, r.matrixPowerDimensions = function () { return e(o.s("shared-calculator-error-matrix-power-dimensions")) }, r.matrixElementTypeError = function (r) { return e(o.s("shared-calculator-error-matrix-element-type-error", { arg: r[0] })) }, r.matrixInvalidVariable = function (r) { return e(o.s("shared-calculator-error-matrix-invalid-variable", { symbol: n.formatSymbol(r) })) }, r.listComprehensionInputListTypeError = function (r, n) { return e(o.s("shared-calculator-error-list-comprehension-input-type-error", { identifier: r, actual: n })) }, r.listComprehensionIncorrectInput = function () { return e(o.s("shared-calculator-error-incorrect-list-comprehension-input")) }, r.unexpectedForKeyword = function () { return e(o.s("shared-calculator-error-unexpected-for-keyword")) }, r.shadowedListComprehensionInput = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-shadowed-list-comprehension-input", { symbol: r })) }, r.badListComprehensionInputDependency = function (r) { return r = n.formatSymbol(r), e(o.s("shared-calculator-error-bad-list-comprehension-input-dependency", { symbol: r })) }, r.variableLengthTopLevelList = function (r) { var t = r.filter(function (r) { return "free" === r.scope }).map(function (r) { return r.symbol }); return e(o.s("shared-calculator-error-variable-length-top-level-list", { symbol: n.formatSymbol(t[0] || "") })).setDependencies(t).allowExport() }, r.variableLengthDistributionList = function (r) { return e(o.s("shared-calculator-error-variable-length-distribution-list", { symbol: r[0].symbol })).setDependencies(r.filter(function (r) { return "free" === r.scope }).map(function (r) { return r.symbol })) }, r.variableLengthSumBodyDependsOnIndex = function (r) { return e(o.s("shared-calculator-error-variable-length-sum-body-depends-on-index", { symbol: r })) }, r.variableLengthProductBodyDependsOnIndex = function (r) { return e(o.s("shared-calculator-error-variable-length-product-body-depends-on-index", { symbol: r })) } });
define('core/math/parsenode/expression', ['require', 'pjs', './base', 'core/math/errormsg'], function (require) { "use strict"; var r = require("pjs"), e = require("./base"); require("core/math/errormsg"); return r(e, function (r, e) { r.init = function (r) { if (!Array.isArray(r)) throw new TypeError("Argument to expression constructor must be an Array."); e.init.call(this), this.args = r, this.registerDependencies() }, r.shouldExportAns = function () { return !0 }, r.registerDependencies = function () { for (var r = 0; r < this.args.length; r++)this.mergeDependencies(this.args[r]) }, r.copyWithArgs = function (r) { return new this.constructor(r) } }) });
define('core/math/parsenode/expressionTypes', ['require', 'pjs', './expression'], function (require) { "use strict"; var n = require("pjs"), t = require("./expression"), e = { Add: n(t, {}), Subtract: n(t, {}), Multiply: n(t, {}), Divide: n(t, {}), Exponent: n(t, {}), Negative: n(t, {}), And: n(t, { isInequality: function () { return this.args[0].isInequality() && this.args[1].isInequality() } }), PercentOf: n(t, {}) }; return e.RawExponent = n(e.Exponent, {}), e });
define('core/math/builtin-common', ["require", "exports", "./tofraction", "core/math/distance"], function (require, r, t, e) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.pow = r.gcd = void 0, r.gcd = function (r, t) { if ((r = Math.round(r)) < 0 && (r = -r), (t = Math.round(t)) < 0 && (t = -t), t > r) { var e = t; t = r, r = e } if (0 === t) return r; for (var n = r % t; n > 0;)n = (r = t) % (t = n); return t }, r.pow = function (r, n) { if (!isFinite(r) && 0 === n) return NaN; if (r >= 0 || n === Math.floor(n)) return Math.pow(r, n); var o = t.default(n, 100); return e.approx(o.n / o.d, n, 2) && o.d % 2 == 1 ? (o.n % 2 == 0 ? 1 : -1) * Math.pow(-r, n) : NaN } });
define('core/math/maybe-rational', ["require", "exports", "./builtin-common"], function (require, n, t) { "use strict"; function r(n, t) { return { n: n, d: t } } function a(n) { return "object" == typeof n && "number" == typeof n.n && "number" == typeof n.d } Object.defineProperty(n, "__esModule", { value: !0 }), n.total = n.mod = n.nthroot = n.sqrt = n.pow = n.div = n.sub = n.mul = n.add = n.reciprocal = n.abs = n.neg = n.maybeRational = n.isNanFloat = n.asFloat = n.fromDecimalString = n.isRational = void 0, n.isRational = a; var o = Math.pow(2, 53) - 1; function e(n) { return a(n) ? n.n / n.d : +n } function u(n, a) { if (!isFinite(n) || !isFinite(a) || 0 === a || Math.floor(n) !== n || Math.floor(a) !== a || Math.abs(n) > o || Math.abs(a) > o) return n / a; a < 0 && (n = -n, a = -a); var e = t.gcd(n, a); return r(n / e, a / e) } function i(n) { return a(n) ? r(-n.n, n.d) : -n } function d(n) { return a(n) ? 0 === n.n ? n.d / n.n : r(n.n < 0 ? -n.d : n.d, Math.abs(n.n)) : 1 / n } function f(n, r) { if (!a(n) || !a(r)) return e(n) + e(r); var o = t.gcd(n.d, r.d); return u(n.n * (r.d / o) + r.n * (n.d / o), n.d / o * r.d) } function c(n, r) { if (!a(n) || !a(r)) return e(n) * e(r); var o = t.gcd(n.n, r.d), i = t.gcd(r.n, n.d); return u(n.n / o * (r.n / i), n.d / i * (r.d / o)) } function s(n, t) { return f(n, i(t)) } function h(n, t) { return a(n) && a(t) ? c(n, d(t)) : e(n) / e(t) } function M(n, r) { if (!a(n) || !a(r)) return t.pow(e(n), e(r)); var o = function (n, r) { var o = n, f = r; if (r.n < 0 && (f = i(r), o = d(n)), !a(o) || !a(f)) return t.pow(e(n), e(r)); if (n = o, 1 === (r = f).d) return u(Math.pow(n.n, r.n), Math.pow(n.d, r.n)); var c = n.n < 0; if (c && r.d % 2 != 1) return NaN; var s = (c ? -1 : 1) * Math.round(Math.pow(Math.abs(n.n), 1 / r.d)), h = Math.round(Math.pow(Math.abs(n.d), 1 / r.d)); return Math.pow(s, r.d) !== n.n || Math.pow(h, r.d) !== n.d ? t.pow(e(n), e(r)) : u(Math.pow(s, r.n), Math.pow(h, r.n)) }(n, r); return a(o) ? o : t.pow(e(n), e(r)) } n.fromDecimalString = function (n) { var t = n.match(/^(-)?(\d*)?(?:\.(\d*))?$/); if (!t) return NaN; var r = t[1], a = t[2], e = t[3]; if (!a && !e) return NaN; var i = !!r; if (e) { var d, f = e.replace(/0+$/, ""), c = f.length, s = Math.pow(10, c); return (d = parseInt(a || "0", 10) * s + parseInt(f || "0", 10)) > o || s > o ? parseFloat(n) : u(i ? -d : d, s) } return (d = parseInt(a, 10)) > o ? parseFloat(n) : u(i ? -d : d, 1) }, n.asFloat = e, n.isNanFloat = function (n) { return !a(n) && isNaN(n) }, n.maybeRational = u, n.neg = i, n.abs = function (n) { return a(n) ? r(Math.abs(n.n), Math.abs(n.d)) : Math.abs(n) }, n.reciprocal = d, n.add = f, n.mul = c, n.sub = s, n.div = h, n.pow = M, n.sqrt = function (n) { if (!a(n)) return Math.sqrt(n); var t = Math.round(Math.sqrt(n.n)), r = Math.round(Math.sqrt(n.d)); return t * t !== n.n || r * r !== n.d ? Math.sqrt(e(n)) : u(t, r) }, n.nthroot = function (n, t) { return M(n, d(t)) }, n.mod = function (n, t) { if (!a(n) || !a(t)) { var o = e(n), u = e(t); return o - u * Math.floor(o / u) } return s(n, c(t, r(Math.floor(e(h(n, t))), 1))) }, n.total = function (n) { for (var t = r(0, 1), a = 0, o = n; a < o.length; a++) { t = f(t, o[a]) } return t } });
define('core/math/parsenode/constant', ['require', 'pjs', './expression', 'core/math/maybe-rational'], function (require) { "use strict"; var t = require("pjs"), n = require("./expression"), a = require("core/math/maybe-rational"); return t(n, function (t, n) { t.init = function (t) { "number" == typeof t && (t = a.maybeRational(t, 1)), this._constantValue = t, n.init.call(this, []) }, t.isConstant = !0, t.asValue = function () { return "boolean" == typeof this._constantValue ? this._constantValue : a.asFloat(this._constantValue) }, t.asCompilerValue = function () { return this._constantValue }, t.scalarExprString = function () { return this.asValue() > 0 ? String(this.asValue()) : "(" + String(this.asValue()) + ")" }, t.getEvaluationInfo = function () { return [{ val: this.asValue() }] }, t.isNaN = function () { return "number" == typeof this.asValue() && isNaN(this.asValue()) } }) });
define('core/math/parsenode/mixednumber', ['require', 'pjs', './constant'], function (require) { "use strict"; return require("pjs")(require("./constant"), function (n, i) { n.init = function (n) { i.init.call(this, n) }, n.is_mixed_number = !0 }) });
define('core/math/parsenode/identifier', ['require', 'pjs', './expression', 'core/lib/label', 'core/math/parser/input-span'], function (require) { "use strict"; var t = require("pjs"), n = require("./expression"), i = require("core/lib/label"), e = require("core/math/parser/input-span"); return t(n, function (t, n, s) { t.init = function (t) { n.init.call(this, []), this._symbol = i.latexToIdentifier(t), this._errorSymbol = this._symbol, this.addDependency(this._symbol) }, t.setInputSpan = function (t) { n.setInputSpan.call(this, t), this._errorSymbol = i.latexToIdentifier(this.getInputString()) }, t.getInputSpan = function () { return void 0 === this._inputSpan ? new e.Span(this._symbol, 0, this._symbol.length) : this._inputSpan } }) });
define('core/math/parsenode/ans', ['require', 'pjs', './identifier'], function (require) { "use strict"; return require("pjs")(require("./identifier"), function (i, n, e) { }) });
define('core/math/parsenode/list', ['require', 'pjs', './expression', 'core/math/types'], function (require) { "use strict"; var t = require("pjs"), i = require("./expression"), n = require("core/math/types"); return t(i, function (t, i, s) { t.init = function (t) { i.init.call(this, t), this.length = t.length }, t.isList = !0, t.asValue = function () { for (var t = [], i = 0; i < this.args.length; i++)t.push(this.args[i].asValue()); return t }, t.asCompilerValue = function () { for (var t = [], i = 0; i < this.args.length; i++)t.push(this.args[i].asCompilerValue()); return t }, t.getEvaluationInfo = function () { if (this.args.every(function (t) { return t.isConstant })) return [{ val: this.args.map(function (t) { return t.asValue() }) }] }, s.eachArgs = function (t, i) { var s = function (t) { for (var i = 1 / 0, n = 0; n < t.length; n++)(t[n].isList || t[n].isBroadcast) && (i = Math.min(i, t[n].length)); return i }(t); if (isFinite(s)) for (var e = 0; e < s; e++) { for (var r = [], a = 0; a < t.length; a++)r.push(t[a].isList || n.isList(t[a].valueType) ? t[a].elementAt(e) : t[a]); i(r, e) } else i(t) }, s.wrap = function (t) { return t.isList || n.isList(t.valueType) ? t : s([t]) } }) });
define('core/math/parsenode/range', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (n, i, t) { n.init = function (n) { i.init.call(this, n), this.beginning = n[0], this.end = n[1] }, n.isHalfEmpty = function () { return this.end && this.end.args && 0 === this.end.args.length } }) });
define('core/math/parsenode/listaccess', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, n) { i.init = function (i) { n.init.call(this, i), this.list = i[0], this.index = i[1] } }) });
define('core/math/parsenode/dotaccess', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), {}) });
define('core/math/parsenode/parenseq', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), {}) });
define('core/math/parsenode/movablepoint', ['require', 'pjs', './parenseq', 'core/math/types'], function (require) { "use strict"; var t = require("pjs"), e = require("./parenseq"), a = require("core/math/types"); return t(e, function (t, e) { t.asValue = function () { return [+this.args[0].asValue(), +this.args[1].asValue()] }, t.asCompilerValue = function () { return [this.args[0].asCompilerValue(), this.args[1].asCompilerValue()] }, t.init = function (t, i, s) { e.init.call(this, t), this.moveStrategy = i, this.defaultDragMode = s, this.valueType = a.Point }, t.isMovablePoint = !0 }) });
define('core/math/parsenode/orderedpairaccess', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, n) { i.init = function (i) { n.init.call(this, i), this.point = i[0], this.index = i[1] } }) });
define('core/math/parsenode/bareseq', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), {}) });
define('core/math/comparators', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.get = e.table = void 0, e.table = { "<": { inclusive: !1, direction: -1 }, "!=": { inclusive: !1, direction: 0 }, ">": { inclusive: !1, direction: 1 }, "<=": { inclusive: !0, direction: -1 }, "=": { inclusive: !0, direction: 0 }, ">=": { inclusive: !0, direction: 1 } }, e.get = function (e, i) { switch (i) { case -1: return e ? "<=" : "<"; case 0: return e ? "=" : "!="; case 1: return e ? ">=" : ">"; default: throw "Programming error.  Comparators must have a direction of -1, 0, or 1" } } });
define('core/math/parsenode/basecomparator', ['require', 'pjs', './expression', './expressionTypes', 'core/math/comparators'], function (require) { "use strict"; var t = require("pjs"), n = require("./expression"), i = require("./expressionTypes").Subtract, r = require("core/math/comparators").table; return t(n, function (n, e, o) { o.create = function (n) { return t(o, function (t, i) { t.operator = n, t.isInequality = function () { return 0 !== r[n].direction } }) }, n.init = function (t) { e.init.call(this, t), this._difference = -1 === r[this.operator].direction ? i([t[1], t[0]]) : i([t[0], t[1]]) }, n.asComparator = function () { return this } }) });
define('core/math/parsenode/comparator', ['require', 'core/math/parsenode/basecomparator'], function (require) { "use strict"; var e = require("core/math/parsenode/basecomparator"); return { "<": e.create("<"), ">": e.create(">"), "<=": e.create("<="), ">=": e.create(">="), "=": e.create("=") } });
define('core/math/parsenode/doubleinequality', ['require', 'pjs', './base', 'core/math/comparators', './comparator'], function (require) { "use strict"; var i = require("pjs"), e = require("./base"), s = require("core/math/comparators"), t = require("./comparator"); return i(e, function (i, e) { i.init = function (i) { e.init.call(this), this.args = i, this._symbol = i[2]._symbol, this._operators = [i[1], i[3]], this._expressions = [i[0], i[4]]; var n = s.get(s.table[i[1]].inclusive && s.table[i[3]].inclusive, s.table[i[1]].direction); this._indicator = t[n]([i[0], i[4]]), this.addDependency(this._symbol), this.mergeDependencies(this._expressions[0], this._expressions[1]) }, i.isInequality = function () { return !0 }, i.isShadeBetween = function () { return !0 } }) });
define('core/math/parsenode/repeatedoperator', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (e, i) { e.init = function (e) { this._index = e[0], i.init.call(this, e) }, e.registerDependencies = function () { this.addDummyDependency(this._index._symbol), this.mergeDependencies(this.args[1]), this.mergeDependencies(this.args[2]), this.mergeDependenciesInScope([this._index._symbol], this.args[3]) } }) });
define('core/math/parsenode/sum', ['require', 'pjs', './repeatedoperator'], function (require) { "use strict"; return require("pjs")(require("./repeatedoperator"), function (t, n) { t.in_place_operator = "+=", t.starting_value = 0, t.evaluateConstant = function (t) { var n = 1 + Math.round(t[1]) - Math.round(t[0]); return n <= 0 ? this.starting_value : n * t[2] }, t.update = function (t, n) { return t + n } }) });
define('core/math/parsenode/product', ['require', 'pjs', './repeatedoperator'], function (require) { "use strict"; return require("pjs")(require("./repeatedoperator"), function (t, n) { t.in_place_operator = "*=", t.starting_value = 1, t.evaluateConstant = function (t) { var n = 1 + Math.round(t[1]) - Math.round(t[0]); return n <= 0 ? this.starting_value : Math.pow(t[2], n) }, t.update = function (t, n) { return t * n } }) });
define('core/math/parsenode/integral', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (e, i) { e.init = function (e) { this._differential = e[0], i.init.call(this, e) }, e.registerDependencies = function () { this.mergeDependencies(this.args[1]), this.mergeDependencies(this.args[2]), this.mergeDependenciesInScope([this._differential._symbol], this.args[3]) } }) });
define('core/math/parsenode/assignmentexpression', ['require', './expression', 'pjs'], function (require) { "use strict"; var i = require("./expression"); return require("pjs")(i, function (i, n) { i.init = function (i) { n.init.call(this, i), this._symbol = i[0]._symbol } }) });
define('core/math/parsenode/listcomprehension', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, e) { i.init = function (i, s, n) { this._index = i, this._body = s, this._inputLists = n, e.init.call(this, [i, s].concat(n)) }, i.registerDependencies = function () { for (var i = [], e = 0; e < this._inputLists.length; e++) { var s = this._inputLists[e], n = s._symbol; this.addDummyDependency(n), i.push(n), this.mergeDependencies(s.args[1]) } this.addDummyDependency(this._index._symbol), i.push(this._index._symbol), this.mergeDependenciesInScope(i, this._body) } }) });
define('core/math/ir/opcodes', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Action = e.BroadcastResult = e.BlockVar = e.ExtendSeed = e.Distribution = e.InboundsListAccess = e.DeferredListAccess = e.ListAccess = e.List = e.NativeFunction = e.Piecewise = e.And = e.GreaterEqual = e.LessEqual = e.Greater = e.Less = e.Equal = e.EndBroadcast = e.BeginBroadcast = e.EndIntegral = e.BeginIntegral = e.EndLoop = e.BeginLoop = e.OrderedPairAccess = e.OrderedPair = e.Negative = e.RawExponent = e.Exponent = e.Divide = e.Multiply = e.Subtract = e.Add = e.MAX_LEAF_OPCODE = e.SymbolicVar = e.LoadArg = e.Constant = e.Noop = void 0, e.Noop = 0, e.Constant = 1, e.LoadArg = 2, e.SymbolicVar = 3, e.MAX_LEAF_OPCODE = 3, e.Add = 8, e.Subtract = 9, e.Multiply = 10, e.Divide = 11, e.Exponent = 12, e.RawExponent = 13, e.Negative = 14, e.OrderedPair = 15, e.OrderedPairAccess = 16, e.BeginLoop = 17, e.EndLoop = 18, e.BeginIntegral = 19, e.EndIntegral = 20, e.BeginBroadcast = 21, e.EndBroadcast = 22, e.Equal = 23, e.Less = 24, e.Greater = 25, e.LessEqual = 26, e.GreaterEqual = 27, e.And = 30, e.Piecewise = 31, e.NativeFunction = 37, e.List = 38, e.ListAccess = 39, e.DeferredListAccess = 40, e.InboundsListAccess = 41, e.Distribution = 42, e.ExtendSeed = 44, e.BlockVar = 47, e.BroadcastResult = 48, e.Action = 49 });
define('core/math/ir/builtin-table', ["require", "exports", "core/math/types", "./opcodes", "core/math/maybe-rational"], function (require, e, t, r, n) { "use strict"; function u(e, r, n) { var u, a, l, i, m, o, s = null !== (u = null == n ? void 0 : n.tag) && void 0 !== u ? u : "default", d = null !== (a = null == n ? void 0 : n.argumentTypes) && void 0 !== a ? a : function (e) { switch (e) { case "default": case "trig": case "inverseTrig": case "never-broadcast": return [t.Number]; case "reducer": return [t.ListOfNumber]; case "doubleReducer": return [t.ListOfNumber, t.ListOfNumber]; case "parameterizedReducer": return [t.ListOfNumber, t.Number]; case "color": return [t.Number, t.Number, t.Number] } }(s), g = (null == n ? void 0 : n.defaultArguments) ? n.defaultArguments.length : 0, c = null !== (l = null == n ? void 0 : n.minArity) && void 0 !== l ? l : d.length - g, p = null !== (i = null == n ? void 0 : n.maxArity) && void 0 !== i ? i : function (e, t, r) { return "reducer" === e ? 1 / 0 : t + r }(s, c, g), b = null !== (m = null == n ? void 0 : n.allowDotCall) && void 0 !== m ? m : function (e) { switch (e) { case "default": case "trig": case "inverseTrig": case "doubleReducer": case "color": case "never-broadcast": return !1; case "reducer": case "parameterizedReducer": return !0 } }(s); return { module: e, symbol: r, argumentTypes: d, defaultArguments: null == n ? void 0 : n.defaultArguments, returnType: null !== (o = null == n ? void 0 : n.returnType) && void 0 !== o ? o : t.Number, tag: s, minArity: c, maxArity: p, allowDotCall: b } } function a(e) { if (!n.isRational(e)) throw new Error("Programming Error: numeric constants should be rational"); return { type: r.Constant, valueType: t.Number, value: e } } Object.defineProperty(e, "__esModule", { value: !0 }), e.CompilerFunctionTable = e.BuiltInTable = void 0; var l = a(n.maybeRational(0, 1)), i = a(n.maybeRational(1, 1)), m = a(n.maybeRational(1, 2)); function o(e, t) { var r, n, u, a, l = null == t ? void 0 : t.defaultArguments, i = null !== (r = null == t ? void 0 : t.maxArity) && void 0 !== r ? r : function (e, t) { return t ? t.length + e : e }(e, l), m = null !== (n = null == t ? void 0 : t.fallthroughUnlessDistribution) && void 0 !== n && n, o = null !== (u = null == t ? void 0 : t.allowDotCall) && void 0 !== u && u, s = null !== (a = null == t ? void 0 : t.isSeeded) && void 0 !== a && a; return { minArity: e, maxArity: i, defaultArguments: l, fallthroughUnlessDistribution: m, minArityExampleArgs: null == t ? void 0 : t.minArityExampleArgs, maxArityExampleArgs: null == t ? void 0 : t.maxArityExampleArgs, dotMinArityExampleArgs: null == t ? void 0 : t.dotMinArityExampleArgs, dotMaxArityExampleArgs: null == t ? void 0 : t.dotMaxArityExampleArgs, allowDotCall: o, isSeeded: s } } function s() { return o(0, { maxArity: 1 / 0 }) } e.BuiltInTable = { sin: u("BuiltIn", "sin", { tag: "trig" }), cos: u("BuiltIn", "cos", { tag: "trig" }), tan: u("BuiltIn", "tan", { tag: "trig" }), cot: u("BuiltIn", "cot", { tag: "trig" }), sec: u("BuiltIn", "sec", { tag: "trig" }), csc: u("BuiltIn", "csc", { tag: "trig" }), arcsin: u("Math", "asin", { tag: "inverseTrig" }), arccos: u("Math", "acos", { tag: "inverseTrig" }), arctan: u("Math", "atan2", { argumentTypes: [t.Number, t.Number], defaultArguments: [i], tag: "inverseTrig" }), arccot: u("BuiltIn", "acot", { tag: "inverseTrig" }), arcsec: u("BuiltIn", "asec", { tag: "inverseTrig" }), arccsc: u("BuiltIn", "acsc", { tag: "inverseTrig" }), sinh: u("BuiltIn", "sinh"), cosh: u("BuiltIn", "cosh"), tanh: u("BuiltIn", "tanh"), coth: u("BuiltIn", "coth"), sech: u("BuiltIn", "sech"), csch: u("BuiltIn", "csch"), arcsinh: u("BuiltIn", "asinh"), arccosh: u("BuiltIn", "acosh"), arctanh: u("BuiltIn", "atanh"), arccoth: u("BuiltIn", "acoth"), arcsech: u("BuiltIn", "asech"), arccsch: u("BuiltIn", "acsch"), sqrt: u("Math", "sqrt"), rtxsqpone: u("BuiltIn", "sqrtxsqp1"), rtxsqmone: u("BuiltIn", "sqrtxsqm1"), nthroot: u("BuiltIn", "nthroot", { argumentTypes: [t.Number, t.Number] }), hypot: u("BuiltIn", "hypot", { argumentTypes: [t.Number, t.Number] }), log: u("BuiltIn", "common_log"), logbase: u("BuiltIn", "log_base", { argumentTypes: [t.Number, t.Number] }), ln: u("BuiltIn", "log"), exp: u("Math", "exp"), floor: u("Math", "floor"), ceil: u("Math", "ceil"), round: u("Math", "round"), abs: u("Math", "abs"), sign: u("BuiltIn", "sign"), mod: u("BuiltIn", "mod", { argumentTypes: [t.Number, t.Number] }), nCr: u("BuiltIn", "nCr", { argumentTypes: [t.Number, t.Number] }), nPr: u("BuiltIn", "nPr", { argumentTypes: [t.Number, t.Number] }), factorial: u("BuiltIn", "factorial"), polyGamma: u("BuiltIn", "polyGamma", { argumentTypes: [t.Number, t.Number] }), lcm: u("BuiltIn", "listLCM", { tag: "reducer" }), gcd: u("BuiltIn", "listGCD", { tag: "reducer" }), distance: u("BuiltIn", "distance", { argumentTypes: [t.Point, t.Point] }), polygon: u("BuiltIn", "polygon", { tag: "never-broadcast", argumentTypes: [t.ListOfPoint], returnType: t.Polygon }), mean: u("BuiltIn", "mean", { tag: "reducer" }), total: u("BuiltIn", "total", { tag: "reducer" }), stdev: u("BuiltIn", "stdev", { tag: "reducer" }), stdevp: u("BuiltIn", "stdevp", { tag: "reducer" }), mad: u("BuiltIn", "mad", { tag: "reducer" }), length: u("BuiltIn", "length", { tag: "reducer", argumentTypes: [t.ListOfAny] }), min: u("BuiltIn", "listMin", { tag: "reducer" }), max: u("BuiltIn", "listMax", { tag: "reducer" }), argmin: u("BuiltIn", "argMin", { tag: "reducer" }), argmax: u("BuiltIn", "argMax", { tag: "reducer" }), median: u("BuiltIn", "median", { tag: "reducer" }), var: u("BuiltIn", "variance", { tag: "reducer" }), varp: u("BuiltIn", "varp", { tag: "reducer" }), cov: u("BuiltIn", "cov", { tag: "doubleReducer" }), covp: u("BuiltIn", "covp", { tag: "doubleReducer" }), corr: u("BuiltIn", "corr", { tag: "doubleReducer" }), spearman: u("BuiltIn", "spearman", { tag: "doubleReducer" }), quantile: u("BuiltIn", "quantile", { tag: "parameterizedReducer" }), quartile: u("BuiltIn", "quartile", { tag: "parameterizedReducer" }), upperQuantileIndex: u("BuiltIn", "upperQuantileIndex", { tag: "parameterizedReducer" }), lowerQuantileIndex: u("BuiltIn", "lowerQuantileIndex", { tag: "parameterizedReducer" }), quartileIndex: u("BuiltIn", "quartileIndex", { tag: "parameterizedReducer" }), upperQuartileIndex: u("BuiltIn", "upperQuartileIndex", { tag: "parameterizedReducer" }), lowerQuartileIndex: u("BuiltIn", "lowerQuartileIndex", { tag: "parameterizedReducer" }), normalcdf: u("BuiltIn", "normalcdf", { argumentTypes: [t.Number, t.Number, t.Number, t.Number], defaultArguments: [l, i] }), normalpdf: u("BuiltIn", "normalpdf", { argumentTypes: [t.Number, t.Number, t.Number], defaultArguments: [l, i] }), binomcdf: u("BuiltIn", "binomcdf", { argumentTypes: [t.Number, t.Number, t.Number, t.Number], defaultArguments: [m] }), binompdf: u("BuiltIn", "binompdf", { argumentTypes: [t.Number, t.Number, t.Number], defaultArguments: [m] }), poissoncdf: u("BuiltIn", "poissoncdf", { argumentTypes: [t.Number, t.Number, t.Number] }), poissonpdf: u("BuiltIn", "poissonpdf", { argumentTypes: [t.Number, t.Number, t.Number] }), uniformcdf: u("BuiltIn", "uniformcdf", { argumentTypes: [t.Number, t.Number, t.Number, t.Number], defaultArguments: [l, i] }), uniformpdf: u("BuiltIn", "uniformpdf", { argumentTypes: [t.Number, t.Number, t.Number], defaultArguments: [l, i] }), invT: u("BuiltIn", "invT", { argumentTypes: [t.Number, t.Number] }), invPoisson: u("BuiltIn", "invPoisson", { argumentTypes: [t.Number, t.Number] }), invBinom: u("BuiltIn", "invBinom", { argumentTypes: [t.Number, t.Number, t.Number] }), invUniform: u("BuiltIn", "invUniform", { argumentTypes: [t.Number, t.Number, t.Number] }), tpdf: u("BuiltIn", "tpdf", { argumentTypes: [t.Number, t.Number] }), tcdf: u("BuiltIn", "tcdf", { argumentTypes: [t.Number, t.Number, t.Number] }), erf: u("BuiltIn", "erf"), invNorm: u("BuiltIn", "invNorm"), tscore: u("BuiltIn", "tscore", { tag: "parameterizedReducer", defaultArguments: [l] }), normalSample: u("BuiltIn", "normalSample", { argumentTypes: [t.SeedType, t.Number, t.Number] }), uniformSample: u("BuiltIn", "uniformSample", { argumentTypes: [t.SeedType, t.Number, t.Number] }), tSample: u("BuiltIn", "tSample", { argumentTypes: [t.SeedType, t.Number] }), poissonSample: u("BuiltIn", "poissonSample", { argumentTypes: [t.SeedType, t.Number] }), binomSample: u("BuiltIn", "binomSample", { argumentTypes: [t.SeedType, t.Number, t.Number] }), rgb: u("BuiltIn", "rgb", { returnType: t.RGBColor, tag: "color" }), hsv: u("BuiltIn", "hsv", { returnType: t.RGBColor, tag: "color" }), validateRangeLength: u("BuiltIn", "validateRangeLength", { returnType: t.Number, argumentTypes: [t.ListOfNumber, t.ListOfNumber, t.Number, t.Number], tag: "never-broadcast" }), validateSampleCount: u("BuiltIn", "validateSampleCount", { returnType: t.Number, argumentTypes: [t.Number] }), select: u("BuiltIn", "select", { argumentTypes: [t.ListOfAny, t.ListOfBool], returnType: function (e) { return e[0] }, tag: "never-broadcast" }), shuffle: u("BuiltIn", "shuffle", { argumentTypes: [t.SeedType, t.ListOfAny], returnType: function (e) { return e[1] }, tag: "never-broadcast" }), sortPerm: u("BuiltIn", "sortPerm", { argumentTypes: [t.ListOfNumber], returnType: t.ListOfNumber, tag: "never-broadcast" }), elementsAt: u("BuiltIn", "elementsAt", { argumentTypes: [t.ListOfAny, t.ListOfNumber], returnType: function (e) { return e[0] }, tag: "never-broadcast" }), uniquePerm: u("BuiltIn", "uniquePerm", { argumentTypes: [t.ListOfAny], returnType: t.ListOfNumber, tag: "never-broadcast" }) }, e.CompilerFunctionTable = { round: o(1, { maxArity: 2 }), midpoint: o(2), sort: o(1, { maxArity: 2, minArityExampleArgs: "([3,2,1])", maxArityExampleArgs: "([1,2,3],[3,2,1])", dotMaxArityExampleArgs: "([3,4])", allowDotCall: !0 }), shuffle: o(2, { maxArity: 3, minArityExampleArgs: "([1,2,3])", maxArityExampleArgs: "([1,2,3],2)", dotMaxArityExampleArgs: "(2)", allowDotCall: !0, isSeeded: !0 }), join: o(2, { maxArity: 1 / 0, minArityExampleArgs: "([1,2],[3,4])", dotMinArityExampleArgs: "([3,4])", allowDotCall: !0 }), unique: o(1, { minArityExampleArgs: "([1,2,3])", maxArityExampleArgs: "([1,2,3])", allowDotCall: !0 }), normaldist: o(0, { defaultArguments: [l, i] }), tdist: o(1), binomialdist: o(1, { defaultArguments: [m] }), poissondist: o(1), uniformdist: o(0, { defaultArguments: [l, i] }), pdf: o(2, { allowDotCall: !0 }), cdf: o(2, { maxArity: 3, allowDotCall: !0 }), mean: o(1, { fallthroughUnlessDistribution: !0, allowDotCall: !0 }), median: o(1, { fallthroughUnlessDistribution: !0, allowDotCall: !0 }), stdev: o(1, { fallthroughUnlessDistribution: !0, allowDotCall: !0 }), var: o(1, { fallthroughUnlessDistribution: !0, allowDotCall: !0 }), quantile: o(2, { fallthroughUnlessDistribution: !0, allowDotCall: !0, minArityExampleArgs: "([1,2,3], 1)", maxArityExampleArgs: "([1,2,3], 1)", dotMinArityExampleArgs: "(x)", dotMaxArityExampleArgs: "(x)" }), random: o(1, { maxArity: 4, allowDotCall: !0, isSeeded: !0 }), polygon: o(0, { maxArity: 1 / 0 }), histogram: s(), dotplot: s(), boxplot: s(), ttest: s(), ittest: s(), stats: s(), det: s(), inv: s(), transpose: s(), rref: s(), trace: s() } });
define('core/math/parsenode/functioncall', ['require', 'pjs', './expression', './identifier', 'core/math/ir/builtin-table'], function (require) { "use strict"; var i = require("pjs"), e = require("./expression"), t = require("./identifier"), r = require("core/math/ir/builtin-table").BuiltInTable; return i(e, function (i, e) { i.init = function (i, r) { "string" == typeof i && (i = t(i)), this._identifier = i, this._symbol = i._symbol, this._errorSymbol = "logbase" === i._errorSymbol ? "log" : i._errorSymbol, e.init.call(this, r) }, i.registerDependencies = function () { this.addDependency(this._symbol), e.registerDependencies.call(this); var i = r[this._symbol]; !i || "trig" !== i.tag && "inverseTrig" !== i.tag || this.addDependency("trigAngleMultiplier") }, i.copyWithArgs = function (i) { return new this.constructor(t(this._symbol), i) } }) });
define('core/math/parsenode/seededfunctioncall', ['require', 'pjs', './functioncall'], function (require) { "use strict"; return require("pjs")(require("./functioncall"), function (i, n) { i.init = function (i, t) { n.init.call(this, i, t), this.seed = t[0] } }) });
define('core/math/parsenode/functionexponent', ['require', 'pjs', './expression', 'core/math/ir/builtin-table'], function (require) { "use strict"; var e = require("pjs"), i = require("./expression"), t = require("core/math/ir/builtin-table").BuiltInTable; return e(i, function (e, i) { e.registerDependencies = function () { if (i.registerDependencies.call(this), "Identifier" === this.args[0].type) { var e = this.args[0]._symbol, n = t[e]; !n || "trig" !== n.tag && "inverseTrig" !== n.tag || this.addDependency("trigAngleMultiplier") } } }) });
define('core/math/parsenode/functionfactorial', ['require', 'pjs', './expression', 'core/math/ir/builtin-table'], function (require) { "use strict"; var e = require("pjs"), i = require("./expression"), t = require("core/math/ir/builtin-table").BuiltInTable; return e(i, function (e, i) { e.registerDependencies = function () { if (this.addDependency("factorial"), i.registerDependencies.call(this), "Identifier" === this.args[0].type) { var e = this.args[0]._symbol, n = t[e]; !n || "trig" !== n.tag && "inverseTrig" !== n.tag || this.addDependency("trigAngleMultiplier") } } }) });
define('core/math/parsenode/prime', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (t, i) { t.init = function (t, n) { i.init.call(this, n), this.order = t }, t.copyWithArgs = function (t) { return new this.constructor(this.order, t) } }) });
define('core/math/parsenode/piecewise', ['require', 'pjs', './expression', './constant', 'core/math/maybe-rational'], function (require) { "use strict"; var n = require("pjs"), t = require("./expression"), e = require("./constant"), r = require("core/math/maybe-rational").maybeRational, a = n(t, {}); return a.chain = function (n, t) { for (var e, r = t; n.length;)e = n.pop(), r = a([e.condition, e.if_expr, r]); return r }, a.empty = function () { return a([e(!0), e(r(1, 1)), e(NaN)]) }, a });
define('core/math/parsenode/derivative', ['require', 'pjs', './expression', './identifier'], function (require) { "use strict"; var i = require("pjs"), n = require("./expression"), s = require("./identifier"); return i(n, function (i, n) { i.init = function (i, t) { this._symbol = i instanceof s ? i._symbol : s(i)._symbol, n.init.call(this, t), this.addDependency(this._symbol) } }) });
define('core/math/parsenode/updaterule', ['require', './expression', 'pjs'], function (require) { "use strict"; var e = require("./expression"); return require("pjs")(e, function (e, i) { e.init = function (e) { this._symbol = e[0]._symbol, this._expression = e[1], i.init.call(this, e) }, e.registerDependencies = function () { this.addUpdateSymbol(this._symbol), this.mergeDependencies(this._expression) } }) });
define('core/math/parsenode/histogram', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, n) { i.init = function (i) { n.init.call(this, i), this._symbol = "histogram" } }) });
define('core/math/parsenode/object3d', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, n) { i.init = function (i, t) { n.init.call(this, i), this._symbol = t } }) });
define('core/math/parsenode/dotplot', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, t) { i.init = function (i) { t.init.call(this, i), this._symbol = "dotplot" } }) });
define('core/math/parsenode/boxplot', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, n) { i.init = function (i) { n.init.call(this, i), this._symbol = "boxplot" } }) });
define('core/math/parsenode/ttest', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (t, i) { t.init = function () { i.init.apply(this, arguments), this._symbol = "ttest" } }) });
define('core/math/parsenode/independent-ttest', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, t) { i.init = function () { t.init.apply(this, arguments), this._symbol = "ittest" } }) });
define('core/math/parsenode/stats', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, t) { i.init = function () { t.init.apply(this, arguments), this._symbol = "stats" } }) });
define('core/math/parsenode/equation', ['require', './base', 'pjs', './expressionTypes', 'core/math/parsenode/comparator'], function (require) { "use strict"; var s = require("./base"), t = require("pjs"), i = require("./expressionTypes").Subtract, e = require("core/math/parsenode/comparator"); return t(s, function (s, t) { s.init = function (s, e) { t.init.call(this), this.mergeDependencies(s, e), this._lhs = s, this._rhs = e, this._difference = i([this._lhs, this._rhs]) }, s.asComparator = function () { return e["="]([this._lhs, this._rhs]) } }) });
define('core/math/parsenode/assignment', ['require', './base', './equation', './identifier', 'pjs'], function (require) { "use strict"; var e = require("./base"), t = require("./equation"), i = require("./identifier"); return require("pjs")(e, function (e, s) { e.init = function (e, t) { s.init.call(this), e = e._symbol, this.mergeDependencies(t), this._expression = t, this._symbol = e, this._exports = this.computeExports() }, e.shouldExportAns = function () { return !0 }, e.computeExports = function () { for (var e = this._symbol, t = this.getDependencies(), i = 0; i < t.length; i++)if (t[i] === e) return []; return [e] }, e.isEquation = function (e) { return -1 !== e.getDependencies().indexOf(this._symbol) }, e.asEquation = function () { var e = t(i(this._symbol), this._expression); return e.userData = this.userData, e.metaData = this.metaData, e }, e.shouldPromoteToSlider = function (e) { return !!this._expression.isConstant && (!this._expression.is_mixed_number && ("number" == typeof this._expression.asValue() && (!!isFinite(this._expression.asValue()) && e.isValidSlider(this._symbol)))) } }) });
define('core/math/parsenode/functiondefinition', ['require', 'pjs', './base', 'core/math/errormsg', './equation', './identifier', './functioncall'], function (require) { "use strict"; var t = require("pjs"), e = require("./base"), i = require("core/math/errormsg"), r = require("./equation"), n = require("./identifier"), s = require("./functioncall"); return t(e, function (t, e) { t.init = function (t, i, r) { e.init.call(this), t = t._symbol, this._argSymbols = i.map(function (t) { return t._symbol }), this._symbol = t, this._exports = [t], this._expression = r, this.mergeDependenciesInScope(this._argSymbols, this._expression) }, t.isFunction = !0, t.getConcreteInvocationTree = function (t, e, r, n) { if (r.length !== this._argSymbols.length) throw i.wrongArity(n, this._argSymbols.length, r.length); for (var s = Object.create(e), o = 0; o < this._argSymbols.length; o++)s[this._argSymbols[o]] = r[o]; return this._expression.getConcreteTree(t, s) }, t.getSliderVariables = function (t, i) { var r = this._argSymbols; return e.getSliderVariables.call(this, t, i).filter(function (t) { return -1 === r.indexOf(t) }) }, t.asEquation = function () { var t = this._argSymbols.map(function (t) { return n(t) }), e = r(s(n(this._symbol), t), this._expression); return e.userData = this.userData, e.metaData = this.metaData, e } }) });
define('core/math/parsenode/regression', ['require', 'pjs', './base', 'core/math/errormsg', './functioncall', './identifier', './expressionTypes'], function (require) { "use strict"; var e = require("pjs"), i = require("./base"), r = require("core/math/errormsg"), s = require("./functioncall"), n = require("./identifier"), t = require("./expressionTypes").Subtract; return e(i, function (e, i, a) { e.init = function (e, r) { i.init.call(this), this._lhs = e, this.isLhsSimple = e instanceof n, this._logLhs = s("ln", [e]), this._rhs = r, this._difference = t([e, r]), this._logDifference = t([s("ln", [e]), s("ln", [r])]), this.mergeDependencies(e, r) }, e.isRegression = !0, e.exportTo = function (e, i, s) { if (!i.isError) { for (var n in i.parameters) i.parameters.hasOwnProperty(n) && (e.assignmentForbidden(n) || (s[n] = s[n] ? r.multiplyDefined(n) : i.parameters[n])); e.assignmentForbidden(i.residualVariable) || (s[i.residualVariable] = i.residuals) } }, e.getSliderVariables = function () { return [] } }) });
define('core/math/parsenode/image', ['require', 'pjs', './base'], function (require) { "use strict"; return require("pjs")(require("./base"), function (i, t, e, h) { i.isImage = !0, i.init = function (i, e) { t.init.call(this), this.center = i.center, this.radianAngle = i.radianAngle, this.width = i.width, this.height = i.height, this.opacity = i.opacity, this.moveStrategy = e, this.mergeDependencies(this.center, this.radianAngle, this.width, this.height, this.opacity) } }) });
define('core/math/parsenode/ticker', ['require', 'pjs', './base'], function (require) { "use strict"; return require("pjs")(require("./base"), function (e, i) { e.init = function (e) { i.init.call(this), this.handler = e.handler, this.minStep = e.minStep, this.mergeDependencies(this.handler), this.mergeDependencies(this.minStep) } }) });
define('core/math/parsenode/slider', ['require', 'pjs', './assignment', './identifier'], function (require) { "use strict"; var i = require("pjs"), s = require("./assignment"), e = require("./identifier"); return i(s, function (i, t, n, r) { i.isSlider = !0, i.init = function (i, s) { t.init.call(this, e(i._symbol), i._expression), this.setInputSpan(i._inputSpan), this.sliderAssignment = i, this.sliderMin = s.sliderMin, this.sliderMax = s.sliderMax, this.sliderSoftMin = s.sliderSoftMin, this.sliderSoftMax = s.sliderSoftMax, this.sliderStep = s.sliderStep, this.sliderIsPlayingOnce = s.sliderIsPlayingOnce, this.sliderMin && this.mergeDependencies(this.sliderMin), this.sliderMax && this.mergeDependencies(this.sliderMax), this.sliderStep && this.mergeDependencies(this.sliderStep) }, i.shouldPromoteToSlider = function (i) { return !1 }, i.asAssignment = function () { return s(this._symbol, this._expression) } }) });
define('core/math/parsenode/table', ['require', 'pjs', './base'], function (require) { "use strict"; return require("pjs")(require("./base"), function (t, n) { t.init = function (t) { n.init.call(this), this.columns = t, this._exports = [], this.mergeDependencies.apply(this, t); for (var e = 0; e < t.length; e++)Array.prototype.push.apply(this._exports, t[e].getExports()) }, t.exportPenalty = 1, t.isTable = !0, t.exportTo = function (t, n, e) { for (var s = 0; s < this.columns.length; s++) { var r = this.columns[s].getExports(); if (r.length) { var i = r[0]; t.assignmentForbidden(i) || e[i] || (n.isError ? e[i] = n : this.columns[s].exportTo(t, n.columns[s], e)) } } }, t.getAllIds = function () { return this.columns.map(function (t) { return t.header.userData.id }) } }) });
define('core/math/parsenode/tablecolumn', ['require', 'pjs', './base', './list', './constant', './identifier'], function (require) { "use strict"; var e = require("pjs"), t = require("./base"), n = require("./list"), i = require("./constant"), s = require("./identifier"); return e(t, function (e, o) { function r(e) { return e.isConstant ? i(e.asCompilerValue()) : i(NaN) } e.init = function (e, t, n) { o.init.call(this), this.header = e, this.length = t, this.values = n, this.isIndependent = !1, this.registerDependencies(), this._exports = this.computeExports() }, e.registerDependencies = function () { this.mergeDependencies(this.header), this.mergeDependencies.apply(this, this.values) }, e.computeExports = function () { return this.header instanceof s ? [this.header._symbol] : [] }, e.isDiscrete = function (e) { return !this.continuousConcreteTree || 1 !== this.continuousConcreteTree.getDependencies().length || 1 !== e.header.getDependencies().length || this.continuousConcreteTree.getDependencies()[0] !== e.header.getDependencies()[0] }, e._exportSymbolsTo = function (e, i, s) { if (e.length) { var o = e[0]; if (i.isError) s[o] = i; else try { s[o] = n(i.values.map(r)) } catch (e) { if (!(e instanceof t)) throw e; s[o] = e } } }, e.exportTo = function (e, t, n) { var i = this.getLegalExports(e); this._exportSymbolsTo(i, t, n) }, e.exportToLocal = function (e, t) { this._exportSymbolsTo(this.getExports(), e, t) } }) });
define('core/math/parsenode/solvedequation', ['require', 'pjs', './base'], function (require) { "use strict"; return require("pjs")(require("./base"), function (i, e) { i.init = function (i, n, t) { e.init.call(this), this._symbol = i, this._expression = n, this.mergeDependencies(n), this.branchMultiplier = t } }) });
define('core/math/parsenode/optimizedregression', ['require', 'pjs', './base'], function (require) { "use strict"; return require("pjs")(require("./base"), function (i, e) { i.init = function (i, t, s, r, a) { for (var n in e.init.call(this), this.parameters = i, this.residuals = t, this.statistics = s, this.model = r, this.isModelValid = a.isModelValid, this.residualVariable = a.residualVariable, this.residualSuggestionId = a.residualSuggestionId, this.shouldSuggestLogMode = a.shouldSuggestLogMode, this.isLinear = a.isLinear, this.parameterWarning = a.parameterWarning, this._exports = [this.residualVariable], i) i.hasOwnProperty(n) && this._exports.push(n); this.mergeDependencies(r) }, i.getCompiledFunction = function () { return this.model.getCompiledFunction.apply(this.model, arguments) }, i.getCompiledDerivative = function () { return this.model.getCompiledDerivative.apply(this.model, arguments) } }) });
define('core/math/parsenode/seed', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (i, n) { i.init = function (i) { "string" != typeof i && (i = "" + i), this._stringValue = i, n.init.call(this, []) }, i.isString = !0, i.asValue = function () { return this._stringValue } }) });
define('core/math/parsenode/extendseed', ['require', 'pjs', './expression'], function (require) { "use strict"; return require("pjs")(require("./expression"), function (t, s) { t.init = function (t, e) { s.init.call(this, e), this.seed = e[0], this.userSeed = e[1], this.tag = t }, t.asValue = function () { return this.seed.asValue() + "::" + this.tag + this.userSeed.asValue() }, t.copyWithArgs = function (t) { return new this.constructor(this.tag, t) } }) });
define('core/math/context-types', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.isActionCompilerValue = void 0, e.isActionCompilerValue = function (e) { return !("object" != typeof e || !e) && "Action" === e.type } });
define('core/math/ir/features/as-value', ["require", "exports", "../opcodes", "core/math/context-types", "core/math/maybe-rational"], function (require, e, t, a, r) { "use strict"; function u(e) { if (Array.isArray(e)) return e.map(u); switch (typeof e) { case "boolean": case "number": case "string": return e; case "object": if (a.isActionCompilerValue(e)) { var t = {}; for (var o in e.updateRules) { var n = e.updateRules[o]; t[o] = { value: u(n.value), valueType: n.valueType } } return { type: "Action", updateRules: t } } return r.asFloat(e); default: throw new Error("Unexpected value: " + e) } } Object.defineProperty(e, "__esModule", { value: !0 }), e.compilerValueToRuntimeValue = e.asValue = void 0, e.asValue = function (e, a) { var r = e.getInstruction(a); switch (r.type) { case t.Constant: return u(r.value); default: throw new Error("Unexpected opcode " + r.type + ".") } }, e.compilerValueToRuntimeValue = u });
define('core/math/ir/features/nan-of-type', ["require", "exports", "core/math/types"], function (require, e, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.nanOfType = e.isNanableValueType = void 0, e.isNanableValueType = function (e) { switch (e) { case a.Bool: case a.Number: case a.Point: case a.Action: case a.RGBColor: case a.Polygon: return !0; default: return !1 } }, e.nanOfType = function (e) { switch (e) { case a.Number: return NaN; case a.Point: return [NaN, NaN]; case a.RGBColor: return [NaN, NaN, NaN]; case a.Action: return { type: "Action", updateRules: {} }; case a.Bool: return !1; case a.Polygon: return []; default: throw new Error(e + " does not have a NaN type.") } } });
define('core/math/parsenode/irexpression', ['require', 'pjs', './base', 'core/math/types', 'core/math/ir/features/as-value', 'core/math/ir/features/nan-of-type', 'core/math/errormsg'], function (require) { "use strict"; var e = require("pjs"), t = require("./base"), n = require("core/math/types"), i = require("core/math/ir/features/as-value").compilerValueToRuntimeValue, s = require("core/math/ir/features/nan-of-type").nanOfType, u = require("core/math/errormsg"); return e(t, function (e, t, r) { e.init = function (e) { if (t.init.call(this), this._chunk = e, this.valueType = e.getReturnType(), this.addDependencies(e.getLiveArgNames()), this.isList = n.isList(this.valueType), this.isList && (this.length = this._chunk.getConstantListLength(), void 0 === this.length)) throw u.variableLengthTopLevelList(e.getListLengthDependencies()); var i = e.isConstant(); this.isConstant = i && (this.valueType === n.Number || this.valueType === n.Bool), this.isEmptyAction = i && this.valueType === n.Action && 0 === Object.keys(e.asValue().updateRules).length }, e.shouldExportAns = function () { return !0 }, e.getCompiledFunction = function (e) { return this._chunk.getCompiledFunction(e) }, e.polynomialOrder = function (e) { return this._chunk.polynomialOrder(e, { allowRestriction: !0, allowClosedBlockReferences: !1 }) }, e.getPolynomialCoefficients = function (e) { for (var t = this._chunk.getPolynomialCoefficients(e), n = t.chunk, i = t.coefficients, s = [], u = 0; u < i.length; u++) { var o = n.copy(); o.returnIndex = i[u], o.close(), s.push(new r(o)) } return s }, e.takeDerivative = function (e) { var t = this._chunk.copy().takeDerivative(e).close(); return new r(t) }, e.boundDomain = function (e) { return this._chunk.boundDomain(e) }, e.asValue = function () { if (this._chunk.isConstant()) return this._chunk.asValue(); if (this.isList) { for (var e = [], t = i(s(n.elementType(this.valueType))), u = 0; u < this.length; u++)e.push(t); return e } return i(s(this.valueType)) }, e.asCompilerValue = function () { return this._chunk.asCompilerValue() }, e.isNaN = function () { return "number" == typeof this.asValue() && isNaN(this.asValue()) }, e.getEvaluationInfo = function () { return !(!this._chunk.isConstant() || 0 !== this.getDependencies().length || !n.isTypeOrListOfType(this.valueType, n.Number) && !n.isTypeOrListOfType(this.valueType, n.Bool)) && [{ val: this.asValue() }] }, e.elementAt = function (e) { var t = this._chunk.elementAt(e); return new r(t) }, e.findLinearSubset = function (e) { return this._chunk.findLinearSubset(e) }, e.deriveRegressionRestrictions = function () { var e = this._chunk.deriveRegressionRestrictions(); return e === this._chunk ? this : new r(e) }, e.eachElement = function (e) { for (var t = 0; t < this.length; t++)e(this.elementAt(t), t) }, e.mapElements = function (e) { for (var t = [], n = 0; n < this.length; n++)t.push(e(this.elementAt(n), n)); return t } }) });
define('parsenodes', ['require', 'core/math/parsenode/expressionTypes', 'core/math/parsenode/base', 'core/math/parsenode/expression', 'core/math/parsenode/error', 'core/math/parsenode/constant', 'core/math/parsenode/mixednumber', 'core/math/parsenode/identifier', 'core/math/parsenode/ans', 'core/math/parsenode/list', 'core/math/parsenode/range', 'core/math/parsenode/listaccess', 'core/math/parsenode/dotaccess', 'core/math/parsenode/parenseq', 'core/math/parsenode/movablepoint', 'core/math/parsenode/orderedpairaccess', 'core/math/parsenode/bareseq', 'core/math/parsenode/basecomparator', 'core/math/parsenode/comparator', 'core/math/parsenode/doubleinequality', 'core/math/parsenode/repeatedoperator', 'core/math/parsenode/sum', 'core/math/parsenode/product', 'core/math/parsenode/integral', 'core/math/parsenode/assignmentexpression', 'core/math/parsenode/listcomprehension', 'core/math/parsenode/functioncall', 'core/math/parsenode/seededfunctioncall', 'core/math/parsenode/functionexponent', 'core/math/parsenode/functionfactorial', 'core/math/parsenode/prime', 'core/math/parsenode/piecewise', 'core/math/parsenode/derivative', 'core/math/parsenode/updaterule', 'core/math/parsenode/histogram', 'core/math/parsenode/object3d', 'core/math/parsenode/dotplot', 'core/math/parsenode/boxplot', 'core/math/parsenode/ttest', 'core/math/parsenode/independent-ttest', 'core/math/parsenode/stats', 'core/math/parsenode/assignment', 'core/math/parsenode/functiondefinition', 'core/math/parsenode/equation', 'core/math/parsenode/regression', 'core/math/parsenode/image', 'core/math/parsenode/ticker', 'core/math/parsenode/slider', 'core/math/parsenode/table', 'core/math/parsenode/tablecolumn', 'core/math/parsenode/solvedequation', 'core/math/parsenode/optimizedregression', 'core/math/parsenode/seed', 'core/math/parsenode/extendseed', 'core/math/parsenode/irexpression'], function (require) { "use strict"; var e = require("core/math/parsenode/expressionTypes"), o = { Base: require("core/math/parsenode/base"), Expression: require("core/math/parsenode/expression"), Error: require("core/math/parsenode/error"), Constant: require("core/math/parsenode/constant"), MixedNumber: require("core/math/parsenode/mixednumber"), Identifier: require("core/math/parsenode/identifier"), Ans: require("core/math/parsenode/ans"), List: require("core/math/parsenode/list"), Range: require("core/math/parsenode/range"), ListAccess: require("core/math/parsenode/listaccess"), DotAccess: require("core/math/parsenode/dotaccess"), ParenSeq: require("core/math/parsenode/parenseq"), MovablePoint: require("core/math/parsenode/movablepoint"), OrderedPairAccess: require("core/math/parsenode/orderedpairaccess"), BareSeq: require("core/math/parsenode/bareseq"), BaseComparator: require("core/math/parsenode/basecomparator"), Comparator: require("core/math/parsenode/comparator"), DoubleInequality: require("core/math/parsenode/doubleinequality"), RepeatedOperator: require("core/math/parsenode/repeatedoperator"), Sum: require("core/math/parsenode/sum"), Product: require("core/math/parsenode/product"), Integral: require("core/math/parsenode/integral"), AssignmentExpression: require("core/math/parsenode/assignmentexpression"), ListComprehension: require("core/math/parsenode/listcomprehension"), FunctionCall: require("core/math/parsenode/functioncall"), SeededFunctionCall: require("core/math/parsenode/seededfunctioncall"), FunctionExponent: require("core/math/parsenode/functionexponent"), FunctionFactorial: require("core/math/parsenode/functionfactorial"), Prime: require("core/math/parsenode/prime"), Piecewise: require("core/math/parsenode/piecewise"), Derivative: require("core/math/parsenode/derivative"), UpdateRule: require("core/math/parsenode/updaterule"), Histogram: require("core/math/parsenode/histogram"), Object3D: require("core/math/parsenode/object3d"), DotPlot: require("core/math/parsenode/dotplot"), BoxPlot: require("core/math/parsenode/boxplot"), TTest: require("core/math/parsenode/ttest"), IndependentTTest: require("core/math/parsenode/independent-ttest"), Stats: require("core/math/parsenode/stats"), Assignment: require("core/math/parsenode/assignment"), FunctionDefinition: require("core/math/parsenode/functiondefinition"), Equation: require("core/math/parsenode/equation"), Regression: require("core/math/parsenode/regression"), Image: require("core/math/parsenode/image"), Ticker: require("core/math/parsenode/ticker"), Slider: require("core/math/parsenode/slider"), Table: require("core/math/parsenode/table"), TableColumn: require("core/math/parsenode/tablecolumn"), SolvedEquation: require("core/math/parsenode/solvedequation"), OptimizedRegression: require("core/math/parsenode/optimizedregression"), Seed: require("core/math/parsenode/seed"), ExtendSeed: require("core/math/parsenode/extendseed"), IRExpression: require("core/math/parsenode/irexpression") }; for (var r in e) o[r] = e[r]; for (var a in o) o.hasOwnProperty(a) && "Comparator" !== a && (o[a].prototype.type = a); for (var t in o.Comparator) o.Comparator.hasOwnProperty(t) && (o.Comparator[t].prototype.type = "Comparator['" + t + "']"); return o });
define('core/math/parser/char-codes', ["require", "exports"], function (require, e) { "use strict"; function t(e) { return 97 <= e && e <= 122 } function i(e) { return 65 <= e && e <= 90 } Object.defineProperty(e, "__esModule", { value: !0 }), e.isWhitespace = e.isSingleQuote = e.isDot = e.isBackslash = e.isLetter = e.isUpperCaseLetter = e.isLowerCaseLetter = e.isDigit = void 0, e.isDigit = function (e) { return 48 <= e && e <= 57 }, e.isLowerCaseLetter = t, e.isUpperCaseLetter = i, e.isLetter = function (e) { return t(e) || i(e) }, e.isBackslash = function (e) { return 92 === e }, e.isDot = function (e) { return 46 === e }, e.isSingleQuote = function (e) { return 39 === e }, e.isWhitespace = function (e) { if (9 <= e && e <= 13) return !0; if (8192 <= e && e <= 8202) return !0; switch (e) { case 32: case 160: case 5760: case 8232: case 8233: case 8239: case 8287: case 12288: case 65279: return !0; default: return !1 } } });
define('core/math/parser/latex-lexer', ["require", "exports", "./char-codes", "./input-span"], function (require, e, t, n) { "use strict"; function r(e, t, n) { return { type: e, span: t, val: n } } function a(e, a, i) { for (; t.isWhitespace(e.charCodeAt(a));)a += 1; var o = function (e, a) { var i = a; if (a >= e.length) return r("End", n.emptySpanAt(e, a), ""); var o = e.charCodeAt(a); if (t.isDigit(o)) return r("Digit", u = n.Span(e, i, a + 1), e.charAt(i)); if (t.isLetter(o)) return r("Letter", u = n.Span(e, i, a + 1), e.charAt(i)); if (t.isBackslash(o)) { if (a += 1, t.isLetter(e.charCodeAt(a))) { for (; t.isLetter(e.charCodeAt(a));)a += 1; var u = n.Span(e, i, a), c = n.slice(u); return r(p[c] || "Cmd", u, c) } return a += 1, r("EscapedSymbol", u = n.Span(e, i, a), c = n.slice(u)) } if (t.isSingleQuote(o)) { for (a += 1; t.isSingleQuote(e.charCodeAt(a));)a += 1; return "^" === e.charAt(a) ? (a += 1, r("Primes^", u = n.Span(e, i, a), c = n.slice(u))) : r("Primes", u = n.Span(e, i, a), c = n.slice(u)) } u = n.Span(e, i, a + 1), c = e.charAt(i); return r(s[c] || "Symbol", u, c) }(e, a); return function (e, t, n, r) { return { input: e, prevSpan: t, pos: n, token: r } }(e, i, a, o) } function i(e) { return a(e.input, e.token.span.end, e.token.span) } function o(e) { return e.token } Object.defineProperty(e, "__esModule", { value: !0 }), e.isDone = e.isAt = e.eat = e.peek = e.advance = e.lex = e.LatexToken = e.spanStates = void 0, e.spanStates = function (e, t) { return n.joinSpans(e.token.span, t.prevSpan) }, e.LatexToken = r, e.lex = function (e) { return a(e, 0, n.emptySpanAt(e, 0)) }, e.advance = i, e.peek = o, e.eat = function (e, t) { if (o(e).type !== t) throw "Parse Error: expected " + t + "."; return i(e) }, e.isAt = function (e, t) { return o(e).type === t }, e.isDone = function (e) { return e.pos >= e.input.length }; var p = { "\\left": "Left", "\\right": "Right", "\\sqrt": "Sqrt", "\\frac": "Frac", "\\operatorname": "OperatorName", "\\token": "Token" }, s = { "[": "[", "]": "]", "{": "{", "}": "}", "^": "^", _: "_" } });
define('core/math/parser/latex-node', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Symbol = e.TokenNode = e.OperatorName = e.LeftRight = e.SupSub = e.Frac = e.Sqrt = e.Group = void 0, e.Group = function (e, r) { return { type: "Group", span: e, args: r } }, e.Sqrt = function (e, r, t) { return { type: "Sqrt", span: e, optArg: r, arg: t } }, e.Frac = function (e, r, t) { return { type: "Frac", span: e, num: r, den: t } }, e.SupSub = function (e, r, t, n) { return { type: "SupSub", span: e, sup: r, sub: t, nprimes: n } }, e.LeftRight = function (e, r, t, n) { return { type: "LeftRight", span: e, left: r, right: t, arg: n } }, e.OperatorName = function (e, r) { return { type: "OperatorName", span: e, arg: r } }, e.TokenNode = function (e, r) { return { type: "TokenNode", span: e, arg: r } }, e.Symbol = function (e, r) { return { type: "Symbol", span: e, val: r } } });
define('core/math/parser/latex-parser', ["require", "exports", "./latex-lexer", "./input-span", "./latex-node"], function (require, e, r, a, t) { "use strict"; function s(e) { switch (e) { case "Frac": return 2; case "^": case "_": case "Primes^": case "Left": case "Sqrt": case "OperatorName": case "Token": return 1; default: return 0 } } function n(e, r) { return { state: e, tree: r } } function c(e, a) { var s, c = e, p = []; e: for (; !r.isDone(e);) { var u = r.peek(e); switch (u.type) { case "Cmd": case "EscapedSymbol": case "Letter": case "Digit": case "Symbol": case "[": case "{": case "^": case "_": case "Primes": case "Primes^": case "Left": case "Frac": case "Sqrt": case "OperatorName": case "Token": case "]": if ("]" === u.type && a) break e; var i; if (e = (s = o(e)).state, "Group" === (i = s.tree).type) for (var v = 0, f = i.args; v < f.length; v++) { var d = f[v]; p.push(d) } else p.push(i); break; case "}": case "Right": case "End": break e; default: throw "Unexpected token type " + u.type + "." } } var l = r.spanStates(c, e); return n(e, t.Group(l, p)) } function o(e) { var a, s = r.peek(e); switch (s.type) { case "Cmd": case "EscapedSymbol": case "Letter": case "Digit": case "Symbol": return n(e = r.advance(e), s); case "[": case "]": return n(e = r.advance(e), t.Symbol(s.span, s.val)); case "{": var o; return e = (a = c(e = r.advance(e), !1)).state, o = a.tree, n(e = r.eat(e, "}"), o); case "^": case "_": case "Primes": case "Primes^": return function (e) { var a, s, c, o, u, i = e, v = 0; e: for (; !r.isDone(e);) { var f = r.peek(e); switch (f.type) { case "^": if (e = r.advance(e), o) throw "Parse Error: double superscript."; e = (a = p(e, f)).state, o = a.tree; break; case "_": if (e = r.advance(e), u) throw "Parse Error: double subscript."; e = (s = p(e, f)).state, u = s.tree; break; case "Primes": if (e = r.advance(e), v > 0) throw "Parse Error: double primes."; v = f.val.length; break; case "Primes^": if (e = r.advance(e), v > 0) throw "Parse Error: double primes."; if (o) throw "Parse Error: double superscript"; v = f.val.length - 1, e = (c = p(e, f)).state, o = c.tree; break; default: break e } } var d = r.spanStates(i, e); return n(e, t.SupSub(d, o, u, v)) }(e); case "Left": return function (e) { var a, s = e; e = r.eat(e, "Left"); var o, p = r.peek(e); e = r.advance(e), a = c(e, !1), e = a.state, o = a.tree, e = r.eat(e, "Right"); var u = r.peek(e); e = r.advance(e); var i = r.spanStates(s, e); return n(e, t.LeftRight(i, p, u, o)) }(e); case "Frac": return function (e) { var a, s, c, o, u = e, i = r.peek(e); e = r.eat(e, "Frac"), a = p(e, i), e = a.state, c = a.tree, s = p(e, i), e = s.state, o = s.tree; var v = r.spanStates(u, e); return n(e, t.Frac(v, c, o)) }(e); case "Sqrt": return function (e) { var a, s, o, u, i = e, v = r.peek(e); e = r.eat(e, "Sqrt"), r.isAt(e, "[") && (a = function (e) { var a, t; return e = r.eat(e, "["), a = c(e, !0), e = a.state, t = a.tree, n(e = r.eat(e, "]"), t) }(e), e = a.state, o = a.tree); s = p(e, v), e = s.state, u = s.tree; var f = r.spanStates(i, e); return n(e, t.Sqrt(f, o, u)) }(e); case "OperatorName": return function (e) { var a, s, c = e, o = r.peek(e); e = r.eat(e, "OperatorName"), a = p(e, o), e = a.state, s = a.tree; var u = r.spanStates(c, e); return n(e, t.OperatorName(u, s)) }(e); case "Token": return function (e) { var a, s, c = e, o = r.peek(e); e = r.eat(e, "Token"), a = p(e, o), e = a.state, s = a.tree; var u = r.spanStates(c, e); return n(e, t.TokenNode(u, s)) }(e); case "}": case "Right": throw "Parse Error: unexpected " + s.val + "."; case "End": throw "Parse Error: unexpected end."; default: throw "Unexpected token type " + s.type + "." } } function p(e, c) { var p, u, i = s(c.type); if (i <= 0) throw new Error("Programming Error: greediness must be greater than 0."); var v = s(r.peek(e).type); if (v > 0 && v <= i) { var f = a.slice(c.span); throw "Parse Error: can't use " + a.slice(r.peek(e).span) + " as argument of " + f + ". Use {}." } return e = (p = o(e)).state, "Group" !== (u = p.tree).type && (u = t.Group(u.span, [u])), n(e, u) } Object.defineProperty(e, "__esModule", { value: !0 }), e.parse = void 0, e.parse = function (e) { var t = c(r.lex(e), !1), s = t.state, n = t.tree; if (!r.isDone(s)) throw "Parse error: unexpected " + a.slice(r.peek(s).span) + "."; return n } });
define('core/math/parser/command-aliases', ["require", "exports", "./char-codes"], function (require, e, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.translateCmd = void 0; var s = { mcd: "gcd", gcf: "gcd", mcm: "lcm", signum: "sign", sgn: "sign", stdDevP: "stdevp", stddevp: "stdevp", stdDev: "stdev", stddev: "stdev", variance: "var", TTest: "ttest", TScore: "tscore", IndependentTTest: "ittest", iTTest: "ittest", inverseCdf: "quantile", inversecdf: "quantile", arsinh: "arcsinh", arcosh: "arccosh", artanh: "arctanh", arcsch: "arccsch", arsech: "arcsech", arcoth: "arccoth" }; e.translateCmd = function (e) { for (var c = 0; t.isBackslash(e.charCodeAt(c));)c += 1; return c > 0 && (e = e.slice(c)), s[e] || e } });
define('core/math/parser/surface-node', ["require", "exports", "./command-aliases"], function (require, n, t) { "use strict"; function e(n) { if ("Subscript" === n.type) { if ("Alphanumeric" !== n.args[1].type) return !1; n = n.args[0] } switch (n.type) { case "Cmd": case "Letter": return !0; default: return !1 } } Object.defineProperty(n, "__esModule", { value: !0 }), n.unwrapSeq = n.isDerivative = n.isSuperscriptedIdentifier = n.isIdentifier = n.MixedNumber = n.Alphanumeric = n.Cmd = n.Decimal = n.Letter = n.Juxt = n.RightArrow = n.PercentOf = n.Dot = n.For = n.Ellipsis = n.Colon = n.EmptyRangeEnd = n.EmptyPiecewise = n.Piecewise = n.Product = n.Sum = n.EmptyIntegral = n.Integral = n.Derivative = n.Frac = n.Nthroot = n.Sqrt = n.Seq = n.Prime = n.Superscript = n.Subscript = n.Pipes = n.List = n.Paren = n.Index = n.ImplicitCall = n.Call = n.Bang = n.Div = n.Mul = n.Sub = n.Add = n.Neg = n.Pos = n.Tilde = n.InequalityChain = n.TrailingInequalityPiece = n.Inequality = n.Equals = void 0, n.Equals = function (n, t) { return { type: "Equals", span: n, args: t } }, n.Inequality = function (n, t, e) { return { type: "Inequality", span: n, symbol: t, args: e } }, n.TrailingInequalityPiece = function (n, t, e) { return { type: "TrailingInequalityPiece", span: n, symbol: t, args: e } }, n.InequalityChain = function (n, t, e) { return { type: "InequalityChain", span: n, first: t, chain: e } }, n.Tilde = function (n, t) { return { type: "Tilde", span: n, args: t } }, n.Pos = function (n, t) { return { type: "Pos", span: n, args: t } }, n.Neg = function (n, t) { return { type: "Neg", span: n, args: t } }, n.Add = function (n, t) { return { type: "Add", span: n, args: t } }, n.Sub = function (n, t) { return { type: "Sub", span: n, args: t } }, n.Mul = function (n, t) { return { type: "Mul", span: n, args: t } }, n.Div = function (n, t) { return { type: "Div", span: n, args: t } }, n.Bang = function (n, t) { return { type: "Bang", span: n, args: t } }, n.Call = function (n, t) { return { type: "Call", span: n, args: t } }, n.ImplicitCall = function (n, t) { return { type: "ImplicitCall", span: n, args: t } }, n.Index = function (n, t) { return { type: "Index", span: n, args: t } }, n.Paren = function (n, t) { return { type: "Paren", span: n, args: t } }, n.List = function (n, t) { return { type: "List", span: n, args: t } }, n.Pipes = function (n, t) { return { type: "Pipes", span: n, args: t } }, n.Subscript = function (n, t) { return { type: "Subscript", span: n, args: t } }, n.Superscript = function (n, t) { return { type: "Superscript", span: n, args: t } }, n.Prime = function (n, t, e) { return { type: "Prime", span: n, nprimes: t, args: e } }, n.Seq = function (n, t) { return { type: "Seq", span: n, args: t } }, n.Sqrt = function (n, t) { return { type: "Sqrt", span: n, args: t } }, n.Nthroot = function (n, t) { return { type: "Nthroot", span: n, args: t } }, n.Frac = function (n, t) { return { type: "Frac", span: n, args: t } }, n.Derivative = function (n, t) { return { type: "Derivative", span: n, args: t } }, n.Integral = function (n, t) { return { type: "Integral", span: n, args: t } }, n.EmptyIntegral = function (n, t) { return { type: "EmptyIntegral", span: n, args: t } }, n.Sum = function (n, t) { return { type: "Sum", span: n, args: t } }, n.Product = function (n, t) { return { type: "Product", span: n, args: t } }, n.Piecewise = function (n, t) { return { type: "Piecewise", span: n, args: t } }, n.EmptyPiecewise = function (n) { return { type: "EmptyPiecewise", span: n } }, n.EmptyRangeEnd = function (n) { return { type: "EmptyRangeEnd", span: n } }, n.Colon = function (n, t) { return { type: "Colon", span: n, args: t } }, n.Ellipsis = function (n, t) { return { type: "Ellipsis", span: n, args: t } }, n.For = function (n, t) { return { type: "For", span: n, args: t } }, n.Dot = function (n, t) { return { type: "Dot", span: n, args: t } }, n.PercentOf = function (n, t) { return { type: "PercentOf", span: n, args: t } }, n.RightArrow = function (n, t) { return { type: "RightArrow", span: n, args: t } }, n.Juxt = function (n, t) { return { type: "Juxt", span: n, args: t } }, n.Letter = function (n, t) { return { type: "Letter", span: n, val: t } }, n.Decimal = function (n, t) { return { type: "Decimal", span: n, val: t } }, n.Cmd = function (n, e) { return { type: "Cmd", span: n, val: t.translateCmd(e) } }, n.Alphanumeric = function (n, t) { return { type: "Alphanumeric", span: n, val: t } }, n.MixedNumber = function (n, t, e, r) { return { type: "MixedNumber", span: n, whole: t, num: e, den: r } }, n.isIdentifier = e, n.isSuperscriptedIdentifier = function (n) { return "Superscript" === n.type && e(n.args[0]) }, n.isDerivative = function (n, t) { if ("Letter" !== n.type || "d" !== n.val) return !1; if ("Juxt" !== t.type) return !1; var r = t.args, i = r[0], a = r[1]; return "Letter" === i.type && "d" === i.val && e(a) }, n.unwrapSeq = function (n) { return "Seq" === n.type ? n.args : [n] } });
define('core/math/parser/surface-node-error', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.TokenWithSubscript = t.UnexpectedFor = t.AdjacentNumbers = t.FractionEmpty = t.FractionMissingDenominator = t.FractionMissingNumerator = t.DifferentialWithSuperscript = t.IntegralMissingDifferential = t.DerivativeMissingBody = t.IntegralMissingBody = t.ProductMissingBody = t.SumMissingBody = t.IntegralMissingBound = t.MissingBound = t.ProductMissingBound = t.SumMissingBound = t.UnexpectedPrime = t.SuperscriptWithPrime = t.PrimeWithoutParen = t.PercentMissingOf = t.FunctionMissingArgument = t.UnexpectedSubscript = t.InvalidSubscript = t.InvalidOperatorName = t.UnrecognizedSymbol = t.UnexpectedDifferential = t.UnexpectedCloseDelimiter = t.MissingCloseDelimiter = t.UnaryOperatorMissingLeft = t.UnaryOperatorMissingRight = t.BinaryOperatorMissingLeft = t.BinaryOperatorMissingRight = t.UnexpectedEnd = t.EmptyRadicalIndex = t.EmptyPipe = t.EmptySquareBracket = t.EmptyRadical = t.EmptySuperscript = t.EmptySubscript = t.EmptyGroup = t.EmptyInput = t.UnexpectedParseError = t.Err = void 0, t.Err = function (t, n) { return { type: "Err", span: t, error: n } }, t.UnexpectedParseError = function () { return { type: "UnexpectedParseError" } }, t.EmptyInput = function () { return { type: "EmptyInput" } }, t.EmptyGroup = function () { return { type: "EmptyGroup" } }, t.EmptySubscript = function () { return { type: "EmptySubscript" } }, t.EmptySuperscript = function () { return { type: "EmptySuperscript" } }, t.EmptyRadical = function () { return { type: "EmptyRadical" } }, t.EmptySquareBracket = function () { return { type: "EmptySquareBracket" } }, t.EmptyPipe = function () { return { type: "EmptyPipe" } }, t.EmptyRadicalIndex = function () { return { type: "EmptyRadicalIndex" } }, t.UnexpectedEnd = function () { return { type: "UnexpectedEnd" } }, t.BinaryOperatorMissingRight = function (t) { return { type: "BinaryOperatorMissingRight", val: t } }, t.BinaryOperatorMissingLeft = function (t) { return { type: "BinaryOperatorMissingLeft", val: t } }, t.UnaryOperatorMissingRight = function (t) { return { type: "UnaryOperatorMissingRight", val: t } }, t.UnaryOperatorMissingLeft = function (t) { return { type: "UnaryOperatorMissingLeft", val: t } }, t.MissingCloseDelimiter = function (t, n) { return { type: "MissingCloseDelimiter", open: t, close: n } }, t.UnexpectedCloseDelimiter = function (t, n) { return { type: "UnexpectedCloseDelimiter", open: t, close: n } }, t.UnexpectedDifferential = function () { return { type: "UnexpectedDifferential" } }, t.UnrecognizedSymbol = function (t) { return { type: "UnrecognizedSymbol", val: t } }, t.InvalidOperatorName = function (t) { return { type: "InvalidOperatorName", val: t } }, t.InvalidSubscript = function (t) { return { type: "InvalidSubscript", val: t } }, t.UnexpectedSubscript = function (t) { return { type: "UnexpectedSubscript", base: t } }, t.FunctionMissingArgument = function (t) { return { type: "FunctionMissingArgument", val: t } }, t.PercentMissingOf = function () { return { type: "PercentMissingOf" } }, t.PrimeWithoutParen = function () { return { type: "PrimeWithoutParen" } }, t.SuperscriptWithPrime = function () { return { type: "SuperscriptWithPrime" } }, t.UnexpectedPrime = function () { return { type: "UnexpectedPrime" } }, t.SumMissingBound = function () { return { type: "SumMissingBound" } }, t.ProductMissingBound = function () { return { type: "ProductMissingBound" } }, t.MissingBound = function () { return { type: "MissingBound" } }, t.IntegralMissingBound = function () { return { type: "IntegralMissingBound" } }, t.SumMissingBody = function () { return { type: "SumMissingBody" } }, t.ProductMissingBody = function () { return { type: "ProductMissingBody" } }, t.IntegralMissingBody = function () { return { type: "IntegralMissingBody" } }, t.DerivativeMissingBody = function () { return { type: "DerivativeMissingBody" } }, t.IntegralMissingDifferential = function () { return { type: "IntegralMissingDifferential" } }, t.DifferentialWithSuperscript = function () { return { type: "DifferentialWithSuperscript" } }, t.FractionMissingNumerator = function () { return { type: "FractionMissingNumerator" } }, t.FractionMissingDenominator = function () { return { type: "FractionMissingDenominator" } }, t.FractionEmpty = function () { return { type: "FractionEmpty" } }, t.AdjacentNumbers = function (t) { return { type: "AdjacentNumbers", args: t } }, t.UnexpectedFor = function () { return { type: "UnexpectedFor" } }, t.TokenWithSubscript = function () { return { type: "TokenWithSubscript" } } });
define('core/math/parser/expression-token-tables', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.allTokenTypes = e.rightTable = e.leftTable = e.escapedSymbolTable = e.symbolTable = e.commandTable = void 0; e.commandTable = { "\\lt": "<", "\\gt": ">", "\\le": "<=", "\\ge": ">=", "\\leq": "<=", "\\geq": ">=", "\\ldots": "...", "\\sim": "~", "\\to": "->", "\\cdot": "*", "\\times": "*", "\\div": "/", "\\ln": "Ln", "\\log": "Log", "\\int": "Int", "\\sum": "Sum", "\\prod": "Prod", "\\backslash": "Err", "\\for": "for" }; for (var a = 0, l = ["sin", "cos", "tan", "cot", "sec", "csc"]; a < l.length; a++) { var o = l[a]; e.commandTable["\\" + o] = "Trig", e.commandTable["\\" + o + "h"] = "Trig", e.commandTable["\\arc" + o] = "Trig", e.commandTable["\\arc" + o + "h"] = "Trig", e.commandTable["\\ar" + o + "h"] = "Trig" } e.symbolTable = { "+": "+", "-": "-", "*": "*", "/": "/", "!": "!", "(": "(", ")": ")", "[": "[", "]": "]", ",": ",", "...": "...", ":": ":", "=": "=", ">=": ">=", "<=": "<=", ">": ">", "<": "<", "~": "~", ".": "." }, e.escapedSymbolTable = { "\\{": "\\{", "\\}": "\\}", "\\%": "%" }, e.leftTable = { "|": "(|", "\\{": "\\{", "[": "[", "(": "(" }, e.rightTable = { "|": "|)", "\\}": "\\}", "]": "]", ")": ")" }, e.allTokenTypes = Object.keys({ "+": !0, "-": !0, "*": !0, "/": !0, "!": !0, "(": !0, ")": !0, "\\{": !0, "\\}": !0, "(|": !0, "|)": !0, "[": !0, "]": !0, ",": !0, "...": !0, ":": !0, "=": !0, ">": !0, "<": !0, ">=": !0, "<=": !0, "->": !0, "~": !0, "%": !0, ".": !0, for: !0, Letter: !0, Decimal: !0, Cmd: !0, TokenNode: !0, Differential: !0, End: !0, Trig: !0, Ln: !0, Log: !0, Int: !0, Sum: !0, Prod: !0, Err: !0 }) });
define('core/math/parser/expression-lexer', ["require", "exports", "./expression-token-tables", "./input-span", "./input-span", "./surface-node"], function (require, e, n, r, t, a) { "use strict"; function s(e, n, r, t, a, s, i, p) { return { opts: e, input: n, prevSpan: r, startIndex: t, endIndex: a, token: s, mode: i, parent: p } } function i(e, n, r) { return { type: e, span: n, val: r } } function p(e, r, t, a, p, u) { var f = r.args; if (t > f.length && u) return o(u, a); var v = g(r, t = m(f, t), p), d = v.token, y = v.endIndex; if ("End" === d.type && u) { var S = u.input.args[u.startIndex]; if ("LeftRight" === S.type) { var h = S.right; return s(e, r, a, t, y, i(n.rightTable[h.val] || "Err", h.span, h.val), p, u) } } else "Int" === d.type ? p = l(p) : "Differential" === d.type && (p = c(p)); return s(e, r, a, t, y, d, p, u) } function o(e, n) { var r = e.input, t = e.endIndex, a = e.mode, s = e.parent; return p(e.opts, r, t + 1, n, a, s) } function u(e) { return e.token } function l(e) { return { type: "integral", parent: e } } function c(e) { if (!e || "integral" !== e.type) throw new Error("Programming Error: expected lexer to be in integral mode."); return e.parent } function f(e, n) { return { token: n, endIndex: e } } function g(e, t, a) { if (t >= e.args.length) return f(t, i("End", r.emptySpanAt(e.span.input, e.span.end), "")); var s = e.args[t]; switch (s.type) { case "Sqrt": case "Frac": case "SupSub": return f(t, s); case "Letter": if (!a || "integral" !== a.type) return f(t, s); if ("d" != s.val) return f(t, s); var p = g(e, t + 1, a), o = p.endIndex, u = p.token; return "Letter" === u.type || "Cmd" === u.type ? f(o, function (e, n) { return { type: "Differential", span: e, val: n } }(r.joinSpans(s.span, u.span), u.val)) : f(t, s); case "LeftRight": var l = s.left; return f(t, i(n.leftTable[l.val] || "Err", r.joinSpans(s.span, l.span), l.val)); case "OperatorName": for (var c = [], d = 0, h = s.arg.args; d < h.length; d++) { var b = h[d]; if ("Letter" !== b.type) return f(t, i("Err", s.span, r.slice(s.arg.span))); c.push(b.val) } var k = "\\" + c.join(""); return f(t, i(n.commandTable[k] || "Cmd", s.span, k)); case "TokenNode": var x = "$"; if (0 === s.arg.args.length) return f(t, i("Err", s.span, r.slice(s.arg.span))); for (var j = 0, E = s.arg.args; j < E.length; j++) { var I = E[j]; if ("Digit" !== I.type) return f(t, i("Err", s.span, r.slice(s.arg.span))); x += I.val } return f(t, i("TokenNode", s.span, x)); case "Cmd": return f(t, i(n.commandTable[s.val] || "Cmd", s.span, s.val)); case "EscapedSymbol": return f(t, i(n.escapedSymbolTable[s.val] || "Err", s.span, s.val)); case "Symbol": return function (e, t, a) { switch (a.val) { case ".": return function (e, t) { var a = e.args[t]; if ("Symbol" !== a.type || "." !== a.val) throw new Error("Programming Error: expected '.'"); if (t + 2 < e.args.length && y(e.args[t + 1]) && y(e.args[t + 2])) { var s = r.joinSpans(a.span, e.args[t + 2].span); return f(t + 2, i("...", s, r.slice(s))) } var p = m(e.args, t + 1); if (p < e.args.length && "Digit" === e.args[p].type) return v(e, t); var o = n.symbolTable[a.val] || "Err"; return f(t, i(o, a.span, a.val)) }(e, t); case "-": if ((s = e.args[t + 1]) && S(s, ">")) return f(t + 1, i("->", r.joinSpans(a.span, s.span), "->")); break; case "<": if ((s = e.args[t + 1]) && S(s, "=")) return f(t + 1, i("<=", r.joinSpans(a.span, s.span), "<=")); break; case ">": var s; if ((s = e.args[t + 1]) && S(s, "=")) return f(t + 1, i(">=", r.joinSpans(a.span, s.span), ">=")) }var p = n.symbolTable[a.val] || "Err"; return f(t, i(p, a.span, a.val)) }(e, t, s); case "Digit": return v(e, t); default: throw "Unexpected atom " + s.type + "." } } function v(e, n) { var t = function (e, n) { for (var t = e.args, s = t[n].span, i = []; n < t.length; n++) { var p = m(t, n); if (p >= t.length) break; if ("Digit" !== (S = t[p]).type) break; n = p, i.push(S.val) } if ((n = m(t, n)) >= t.length) return; var o = t[n]; if ("Frac" !== o.type) return; for (var u = [], l = [], c = 0, g = o.num.args; c < g.length; c++) { if (!d(S = g[c])) { if ("Digit" !== S.type) return; u.push(S.val) } } for (var v = 0, y = o.den.args; v < y.length; v++) { var S; if (!d(S = y[v])) { if ("Digit" !== S.type) return; l.push(S.val) } } var h = r.joinSpans(s, o.span); return f(n, a.MixedNumber(h, i.join(""), u.join(""), l.join(""))) }(e, n); if (t) return t; for (var s = e.args, p = e.args[n].span, o = [], u = !1, l = !1; n < s.length; n++) { var c = m(s, n); if (c >= s.length) break; var g = s[c]; if ("Digit" === g.type) n = c, u = !0, o.push(g.val); else { if (l || !y(g)) break; if (c + 1 < s.length && y(e.args[c + 1])) break; n = c, l = !0, o.push(".") } } if (!u) throw new Error("Programming Error: decimals must have at least one digit."); return f(n - 1, i("Decimal", r.joinSpans(p, e.args[n - 1].span), o.join(""))) } function d(e) { switch (e.type) { case "Sqrt": case "Frac": case "SupSub": case "LeftRight": case "OperatorName": case "TokenNode": case "Symbol": case "Letter": case "Digit": return !1; case "Cmd": return "\\space" === e.val; case "EscapedSymbol": return "\\ " === e.val || "\\:" === e.val || "\\," === e.val || "\\;" === e.val; default: throw "Unexpected atom " + e.type + "." } } function m(e, n) { for (; n < e.length && d(e[n]);)n += 1; return n } function y(e) { return S(e, ".") } function S(e, n) { return "Symbol" === e.type && e.val === n } Object.defineProperty(e, "__esModule", { value: !0 }), e.didAdvance = e.isDone = e.isAt = e.endIntegral = e.beginIntegral = e.peek = e.advance = e.lexAt = e.lex = e.emptySpanAtState = e.joinState = e.spanStates = e.Span = void 0, Object.defineProperty(e, "Span", { enumerable: !0, get: function () { return t.Span } }), e.spanStates = function (e, n) { return r.joinSpans(e.token.span, n.prevSpan) }, e.joinState = function (e, n) { return r.joinSpans(e, n.prevSpan) }, e.emptySpanAtState = function (e) { return r.emptySpanAt(e.token.span.input, e.token.span.start) }, e.lex = function (e, n) { return p(n, e, 0, r.emptySpanAt(e.span.input, e.span.start), undefined, undefined) }, e.lexAt = p, e.advance = function (e) { var n = e.input.args[e.startIndex], r = e.token.span; return n && "LeftRight" === n.type ? p(e.opts, n.arg, 0, r, e.mode, e) : o(e, r) }, e.peek = u, e.beginIntegral = l, e.endIntegral = c, e.isAt = function (e, n) { return u(e).type === n }, e.isDone = function (e) { return e.startIndex >= e.input.args.length }, e.didAdvance = function (e, n) { return n.token.span.start > e.token.span.start } });
define('core/math/parser/precspec', ["require", "exports", "./expression-token-tables"], function (require, e, r) { "use strict"; function t(e, t) { for (var n = 0, i = r.allTokenTypes; n < i.length; n++) { var o = i[n]; if (void 0 === t[o]) throw new Error("Programming Error: token " + o + " must be a assigned a " + e + " precedence") } } function n(e, r, t, n) { if (void 0 !== r[t]) throw new Error("Programming Error: duplicate " + e + " entry for token " + t + "."); r[t] = n } Object.defineProperty(e, "__esModule", { value: !0 }), e.precSpec = e.ra = e.la = e.r = e.l = e.initial = void 0, e.initial = function (e) { return { type: "initial", tokenType: e } }, e.l = function (e) { return { type: "l", tokenType: e } }, e.r = function (e) { return { type: "r", tokenType: e } }, e.la = function (e) { return { type: "la", tokenType: e } }, e.ra = function (e) { return { type: "ra", tokenType: e } }, e.precSpec = function (e) { for (var r = {}, i = {}, o = {}, a = 0; a < e.length; a++)for (var c = 0, l = e[a]; c < l.length; c++) { var u = l[c], f = u.type, p = u.tokenType; switch (f) { case "initial": n("initial", r, p, a); break; case "l": n("left", i, p, a); break; case "r": n("right", o, p, a); break; case "la": n("left", i, p, a), n("right", o, p, a); break; case "ra": n("left", i, p, a), n("right", o, p, a - 1) } } function s(e) { return o[e] } return t("left", i), t("right", o), { rightPrec: s, leftPrec: function (e) { return i[e] }, initialPrec: function (e) { var t = r[e]; return void 0 === t ? s(e) : t } } } });
define('core/math/inverses', [], function () { "use strict"; var c = {}; return ["sin", "cos", "tan", "cot", "sec", "csc", "sinh", "cosh", "tanh", "coth", "sech", "csch"].forEach(function (n) { c[n] = "arc" + n, c["arc" + n] = n }), c });
define('core/math/parser/lower', ["require", "exports", "core/math/inverses", "tslib", "core/math/errormsg", "./input-span", "./surface-node", "../maybe-rational"], function (require, e, r, t, a, n, s, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.isLegalAssignmentLhs = e.isFunctionSignature = e.lower = void 0; var c = 0; function u(e, r) { for (var t = [], a = 0; a < r.length; a++)t.push(d(e, r[a])); return t } function o(e) { if ("Call" === e.type) { var r = e.args, t = r[0], a = r[1], n = s.unwrapSeq(a); return s.isIdentifier(t) && n.every(s.isIdentifier) ? { base: t, args: n } : void 0 } } function p(e) { return s.isIdentifier(e) } function l(e) { if ("Paren" !== e.type) return !1; var r = e.args[0]; return "Seq" === r.type && 2 === r.args.length } function d(e, r) { return e.setInput(g(e, r), r.span) } function g(e, r) { var t = e.nodes; switch (r.type) { case "Pos": return g(e, r.args[0]); case "Neg": for (var o = -1, p = r.args[0]; ;)if ("Pos" === p.type || "Paren" === p.type && !l(p)) p = p.args[0]; else { if ("Neg" !== p.type) break; p = p.args[0], o *= -1 } switch (p.type) { case "Decimal": var P = w(p); return t.Constant(-1 === o ? i.neg(P) : P); case "MixedNumber": P = S(p); return t.MixedNumber(-1 === o ? i.neg(P) : P); default: return -1 === o ? t.Negative([d(e, p)]) : g(e, p) }case "Add": return t.Add(u(e, r.args)); case "Sub": return t.Subtract(u(e, r.args)); case "Mul": return t.Multiply(u(e, r.args)); case "Div": return t.Divide(u(e, r.args)); case "Bang": var M = r.args[0]; return "Call" === M.type ? t.FunctionFactorial(u(e, M.args)) : t.FunctionCall("\\factorial", u(e, r.args)); case "PercentOf": return t.PercentOf(u(e, r.args)); case "Call": return m(e, r); case "ImplicitCall": return function (e) { var r = e.args, t = r[0], n = r[1]; "Superscript" === t.type && (t = t.args[0]); if ("Cmd" === t.type && "logbase" === t.val && "Seq" === n.type && 2 === n.args.length) { if (!I(n.args[0])) throw a.badImplicitCall("log") } else if (!I(n)) { if ("Cmd" === t.type) throw a.badImplicitCall(t.val); throw a.parseError() } }(r), m(e, r); case "Dot": var D = r.args[1], A = u(e, r.args), L = A[0], F = A[1]; if (C(D)) { var B = n.emptySpanAt(D.span.input, D.span.end), O = e.setInput(q(e), B); F = e.setInput(t.SeededFunctionCall(F, [O]), D.span) } else if ("Letter" === D.type) switch (D.val) { case "x": return t.OrderedPairAccess([L, t.Constant(1)]); case "y": return t.OrderedPairAccess([L, t.Constant(2)]) } else if ("Call" === D.type) { if ("Letter" === (U = D.args[0]).type) switch (U.val) { case "x": return t.Multiply([t.OrderedPairAccess([L, t.Constant(1)]), d(e, D.args[1])]); case "y": return t.Multiply([t.OrderedPairAccess([L, t.Constant(2)]), d(e, D.args[1])]) } } return t.DotAccess([L, F]); case "Prime": var N = r.args[0]; if ("Call" === N.type) { var R = N.args, U = R[0], _ = R[1], k = s.unwrapSeq(_).length; if ("Cmd" === U.type && "logbase" === U.val) { if (2 !== k) throw a.primedFunctionArity() } else if (1 !== k) throw a.primedFunctionArity(); return t.Prime(r.nprimes, u(e, r.args)) } throw "ImplicitCall" === N.type ? a.primeWithoutParen() : a.unexpectedPrime(); case "Index": var T = r.args, W = T[0], j = T[1]; if ("Seq" === j.type) return t.ListAccess([g(e, W), t.List(u(e, j.args))]); if ("Ellipsis" === j.type) { var z = j.args, H = z[0], J = z[1]; return t.ListAccess([g(e, W), t.Range([t.List(u(e, s.unwrapSeq(H))), t.List("EmptyRangeEnd" === J.type ? [] : u(e, s.unwrapSeq(J)))])]) } return h(j) ? t.ListAccess([g(e, W), v(e, j)]) : t.ListAccess(u(e, r.args)); case "Paren": var K = r.args[0]; if ("Seq" === K.type) { if (0 === K.args.length) throw a.emptyParen(); return t.ParenSeq(u(e, K.args)) } return g(e, K); case "List": if (0 === r.args.length) return t.List([]); var G = r.args[0]; if ("Ellipsis" === G.type) { var Q = G.args; H = Q[0], J = Q[1]; return t.Range([t.List(u(e, s.unwrapSeq(H))), t.List(u(e, s.unwrapSeq(J)))]) } if ("For" === G.type) { for (var V = G.args, X = V[0], Y = V[1], Z = e.setInput(t.Identifier("_comprehensionIndex_" + c++), X.span), $ = d(E(e, { prefix: "li", expr: Z }), X), ee = [], re = 0, te = s.unwrapSeq(Y); re < te.length; re++) { var ae = te[re]; if (!x(ae)) throw a.listComprehensionIncorrectInput(); ee.push(e.setInput(t.AssignmentExpression(u(e, ae.args)), ae.span)) } return t.ListComprehension(Z, $, ee) } return t.List(u(e, s.unwrapSeq(G))); case "Pipes": return t.FunctionCall("\\abs", u(e, r.args)); case "Subscript": var ne = r.args, se = ne[0], ie = ne[1]; if (0 === ie.val.length) throw a.emptySubscript(); var ce = void 0; switch (se.type) { case "Letter": case "Cmd": ce = se.val; break; default: throw a.unexpectedSubscript() }return t.Identifier(ce + "_" + ie.val); case "Superscript": var ue = r.args, oe = (se = ue[0], ue[1]); if ("Call" !== se.type || "Seq" === se.args[1].type || function (e) { if ("Call" !== e.type) return !1; var r = e.args[0]; for (; "Superscript" === r.type || "Subscript" === r.type || "Prime" === r.type;)r = r.args[0]; return "Cmd" === r.type && (f(r.val) || y(r.val)) }(se)) { if ("Dot" === se.type) { D = se.args[1]; var pe = u(e, se.args), le = (L = pe[0], F = pe[1], d(e, oe)); if ("Letter" === D.type) switch (D.val) { case "x": return t.Exponent([t.OrderedPairAccess([L, t.Constant(1)]), le]); case "y": return t.Exponent([t.OrderedPairAccess([L, t.Constant(2)]), le]) } else if ("Call" === D.type) { if ("Letter" === (U = D.args[0]).type) switch (U.val) { case "x": return t.Multiply([t.OrderedPairAccess([L, t.Constant(1)]), t.Exponent([d(e, D.args[1]), le])]); case "y": return t.Multiply([t.OrderedPairAccess([L, t.Constant(2)]), t.Exponent([d(e, D.args[1]), le])]) } } return t.Exponent([t.DotAccess([L, F]), le]) } return t.Exponent(u(e, r.args)) } return t.FunctionExponent(u(e, [se.args[0], se.args[1], oe])); case "Sqrt": return t.FunctionCall("sqrt", u(e, r.args)); case "Nthroot": return t.FunctionCall("nthroot", u(e, [r.args[1], r.args[0]])); case "Frac": return t.Divide(u(e, r.args)); case "Derivative": var de = u(e, r.args); if (!s.isIdentifier(r.args[0])) throw a.parseError(); return t.Derivative(de[0], [de[1]]); case "Integral": var ge = r.args; de = u(e, [ye = ge[0], ge[1], he = ge[2], ve = ge[3]]); return t.Integral(de); case "EmptyIntegral": var fe = u(e, r.args), ye = fe[0], me = fe[1], he = fe[2], ve = t.Constant(i.maybeRational(1, 1)); return t.Integral([ye, me, he, ve]); case "Sum": var we = r.args, Se = (X = we[0], we[1]); he = we[2]; if (!x(Se)) throw a.incorrectSumLowerBound(); var xe = d(E(e, { prefix: "ro", expr: (de = u(e, [Se.args[0], Se.args[1], he]))[0] }), X); return t.Sum(de.concat(xe)); case "Product": var be = r.args, Ie = (X = be[0], be[1]); he = be[2]; if (!x(Ie)) throw a.incorrectProductLowerBound(); xe = d(E(e, { prefix: "ro", expr: (de = u(e, [Ie.args[0], Ie.args[1], he]))[0] }), X); return t.Product(de.concat(xe)); case "Juxt": return t.Multiply(u(e, r.args)); case "Letter": return t.Identifier(r.val); case "Cmd": var Ce = r.val; switch (Ce) { case "ans": if (void 0 === e.currentIndex) throw a.badSymbolContext("ans"); return t.Ans("ans_{" + (e.currentIndex - 1) + "}"); case "approx": throw a.unrecognizedSymbol(Ce); case "dt": if (!e.allowDt) throw a.badSymbolContext(Ce); return t.Identifier(Ce); case "index": if (!e.allowIndex) throw a.badSymbolContext(Ce); return t.Identifier(Ce); default: return t.Identifier(Ce) }case "Decimal": return t.Constant(w(r)); case "MixedNumber": return t.MixedNumber(S(r)); case "Piecewise": return function (e, r) { var t, n = e.nodes, c = r.args[0], u = s.unwrapSeq(c), o = []; e: for (t = 0; t < u.length; t++) { var p = u[t]; switch (p.type) { case "Colon": var l = p.args, g = l[0], f = l[1]; if (!h(g)) throw a.colonMissingCondition(); o.push({ condition: v(e, g), if_expr: d(e, f) }); break; case "Equals": case "Inequality": case "InequalityChain": o.push({ condition: v(e, p), if_expr: n.Constant(i.maybeRational(1, 1)) }); break; default: break e } } if (0 === t) throw a.piecewiseMissingCondition(); if (t < u.length - 1) throw a.piecewisePartMissingCondition(); var y = t === u.length - 1 ? d(e, u[t]) : n.Constant(NaN); if (!n.Piecewise.chain) throw a.featureUnavailable(); return n.Piecewise.chain(o, y) }(e, r); case "RightArrow": return function (e, r) { var t = e.nodes; if (!s.isIdentifier(r.args[0])) throw a.updateRuleNonIdentifierLHS(); return e = E(e, { prefix: "ec", expr: e.setInput(t.Identifier("globalEventCount"), n.emptySpanAt(r.span.input, r.span.start)) }), t.UpdateRule(u(e, r.args)) }(e, r); case "Seq": return t.BareSeq(u(e, r.args)); case "EmptyPiecewise": if (!t.Piecewise.empty) throw a.featureUnavailable(); return t.Piecewise.empty(); case "Equals": throw a.unexpectedSymbol("="); case "Inequality": case "InequalityChain": throw a.unexpectedInequality(); case "Tilde": throw a.unexpectedSymbol("~"); case "Colon": throw a.unexpectedSymbol(":"); case "Ellipsis": throw a.unexpectedSymbol("..."); case "For": throw a.unexpectedForKeyword(); case "EmptyRangeEnd": throw a.invalidHalfEmptyRange(); case "Err": throw function (e) { switch (e.type) { case "UnexpectedParseError": case "MissingBound": case "EmptyGroup": case "UnexpectedDifferential": case "UnexpectedEnd": return a.parseError(); case "InvalidOperatorName": return a.invalidOperatorName(); case "UnexpectedCloseDelimiter": case "MissingCloseDelimiter": return a.mismatchedBraces(e.open, e.close); case "UnrecognizedSymbol": return "." === e.val ? a.unexpectedSymbol(e.val) : a.unrecognizedSymbol(e.val); case "EmptyInput": return a.blankExpression(); case "BinaryOperatorMissingRight": case "BinaryOperatorMissingLeft": return a.binaryOperatorMissingOperand("%" === e.val ? "% of" : e.val); case "UnaryOperatorMissingLeft": return a.unaryOperatorMissingLeft(e.val); case "UnaryOperatorMissingRight": return a.unaryOperatorMissingRight(e.val); case "UnexpectedSubscript": return a.cannotSubscript(e.base); case "PercentMissingOf": return a.percentMissingOf(); case "SumMissingBound": return a.sumMissingBound(); case "ProductMissingBound": return a.productMissingBound(); case "IntegralMissingBound": return a.integralMissingBound(); case "SumMissingBody": return a.sumMissingBody(); case "ProductMissingBody": return a.productMissingBody(); case "IntegralMissingBody": return a.integralMissingBody(); case "DerivativeMissingBody": return a.derivativeMissingBody(); case "IntegralMissingDifferential": return a.integralMissingDifferential(); case "DifferentialWithSuperscript": return a.differentialWithSuperscript(); case "FractionMissingNumerator": return a.fractionMissingNumerator(); case "FractionMissingDenominator": return a.fractionMissingDenominator(); case "FractionEmpty": return a.fractionEmpty(); case "EmptySuperscript": return a.emptySuperscript(); case "EmptySubscript": return a.emptySubscript(); case "InvalidSubscript": return a.invalidSubscript(e.val); case "SuperscriptWithPrime": return a.superscriptWithPrime(); case "PrimeWithoutParen": return a.primeWithoutParen(); case "UnexpectedPrime": return a.unexpectedPrime(); case "EmptyRadical": return a.emptyRadical(); case "EmptyRadicalIndex": return a.emptyRadicalIndex(); case "EmptySquareBracket": return a.emptySquareBracket(); case "EmptyPipe": return a.emptyPipe(); case "FunctionMissingArgument": return a.wrongArity(e.val, 1, 0); case "AdjacentNumbers": return a.adjacentNumbers(b(e.args[0]), b(e.args[1])); case "TokenWithSubscript": return a.tokenWithSubscript(); case "UnexpectedFor": return a.unexpectedForKeyword(); default: throw "Unexpected surface node " + e.type + "." } }(r.error); default: throw "Unexpected surface node " + r.type + "." } } function f(e) { return r.hasOwnProperty(e) } function y(e) { return "ln" === e || "log" === e || "logbase" === e } function m(e, t) { var i = e.nodes, c = t.args, o = c[0], p = c[1], l = d(e, o), g = u(e, s.unwrapSeq(p)); if (C(o)) { var m = n.emptySpanAt(p.span.input, p.span.start), h = e.setInput(q(e), m); return i.SeededFunctionCall(l, [h].concat(g)) } if (s.isIdentifier(o)) return i.FunctionCall(l, g); if ("Superscript" === o.type) { var v = o.args, w = v[0], S = v[1]; if ("Cmd" === w.type) { var x = w.val; if (f(x) || y(x)) { if (function (e) { return "Decimal" === e.type && "2" === e.val }(S)) return i.Exponent([i.FunctionCall(x, g), d(e, S)]); if (function (e) { return "Neg" === e.type && "Decimal" === (e = e.args[0]).type && "1" === e.val }(S) && void 0 !== r[x]) return i.FunctionCall(r[x], g); throw f(x) ? a.badTrigExponent(x) : a.badLogExponent("logbase" === x ? "log" : x) } } } return i.Multiply([l, d(e, p)]) } function h(e) { return "Equals" === e.type || "Inequality" === e.type || "InequalityChain" === e.type } function v(e, r) { var t = e.nodes; switch (r.type) { case "Equals": return t.Comparator["="](u(e, r.args)); case "Inequality": return t.Comparator[r.symbol](u(e, r.args)); case "InequalityChain": if (r.chain.length > 1) throw a.inequalityChainTooLong(); var i = r.first, c = i.symbol, o = i.args, p = o[0], l = o[1], d = r.chain[0], g = d.symbol, f = d.args[0], y = n.emptySpanAt(r.span.input, r.span.start); return t.And([v(e, s.Inequality(y, c, [p, l])), v(e, s.Inequality(y, g, [l, f]))]); default: throw a.parseError() } } function w(e) { return i.fromDecimalString(e.val) } function S(e) { var r = i.fromDecimalString(e.whole), t = i.fromDecimalString(e.num), a = i.fromDecimalString(e.den); return i.add(r, i.div(t, a)) } function x(e) { return "Equals" === e.type && s.isIdentifier(e.args[0]) } function b(e) { switch (e.type) { case "Decimal": return e.val; case "MixedNumber": return e.whole + " " + e.num + "/" + e.den; default: throw new Error("Unexpected node type " + e.type) } } function I(e) { switch (e.type) { case "Letter": case "Decimal": case "MixedNumber": case "Cmd": case "EmptyPiecewise": return !0; case "Neg": for (var r = e.args[0]; ;)if ("Pos" === r.type || "Paren" === r.type && !l(r)) r = r.args[0]; else { if ("Neg" !== r.type) break; r = r.args[0] } return "Decimal" === r.type || "MixedNumber" === r.type; case "Pos": case "Paren": return I(e.args[0]); case "Juxt": case "Mul": case "Div": return I(e.args[0]) && I(e.args[1]); case "Subscript": return I(e.args[0]); case "Superscript": case "Frac": case "Add": case "Sub": return I(e.args[0]) && I(e.args[1]); case "Piecewise": return "Equals" === (r = e.args[0]).type || "Inequality" === r.type || "InequalityChain" === r.type; case "Call": var t = e.args, a = t[0], n = t[1]; return !s.isIdentifier(a) && !s.isSuperscriptedIdentifier(a) && (I(a) && I(n)); case "Derivative": case "Sqrt": case "Nthroot": case "Pipes": case "Bang": return !1; case "Equals": case "Inequality": case "InequalityChain": case "Tilde": case "ImplicitCall": case "Index": case "List": case "Seq": case "Integral": case "EmptyIntegral": case "Sum": case "Product": case "Colon": case "Ellipsis": case "For": case "Dot": case "PercentOf": case "Prime": case "EmptyRangeEnd": case "RightArrow": return !1; default: throw "Unexpected surface node " + e.type + "." } } function C(e) { return "Cmd" === e.type && ("random" === e.val || "shuffle" === e.val) } function q(e) { var r = e.nodes.ExtendSeed("", [e.nodes.Identifier("globalRandomSeed"), e.nodes.Seed(e.nextSeed())]); if (!e.seedExtensions) return r; for (var t = 0, a = e.seedExtensions; t < a.length; t++) { var n = a[t], s = n.prefix, i = n.expr; r = e.nodes.ExtendSeed(s, [r, i]) } return r } function E(e, r) { var a = e.seedExtensions || []; return t.__assign(t.__assign({}, e), { seedExtensions: a.concat(r) }) } e.lower = function (e, r) { return function (e, r) { return e.setInput(function (e, r) { var t = e.nodes; switch (r.type) { case "Equals": var n = r.args, i = n[0], c = n[1], l = o(i); if (l) { var f = l.base, y = l.args; return t.FunctionDefinition(d(e, f), u(e, y), d(e, c)) } return p(i) ? t.Assignment(d(e, i), d(e, c)) : t.Equation(d(e, i), d(e, c)); case "Tilde": var m = u(e, r.args); i = m[0], c = m[1]; return t.Regression(i, c); case "Inequality": return v(e, r); case "InequalityChain": if (r.chain.length > 1) throw a.inequalityChainTooLong(); var h = r.first, w = h.symbol, S = h.args, x = S[0], b = S[1], I = r.chain[0], C = I.symbol, q = I.args[0]; return s.isIdentifier(b) ? t.DoubleInequality([d(e, x), w, d(e, b), C, d(e, q)]) : v(e, r); case "Call": var E = r.args, P = E[0], M = E[1]; if ("Cmd" === P.type) switch (P.val) { case "histogram": return t.Histogram(u(e, s.unwrapSeq(M))); case "cube": case "sphere": case "cone": case "dodecahedron": case "octahedron": case "tetrahedron": return t.Object3D(u(e, s.unwrapSeq(M)), P.val); case "dotplot": return t.DotPlot(u(e, s.unwrapSeq(M))); case "boxplot": return t.BoxPlot(u(e, s.unwrapSeq(M))); case "ttest": return t.TTest(u(e, s.unwrapSeq(M))); case "ittest": return t.IndependentTTest(u(e, s.unwrapSeq(M))); case "stats": return t.Stats(u(e, s.unwrapSeq(M))); default: return g(e, r) }return g(e, r); default: return g(e, r) } }(e, r), r.span) }(e, r) }, e.isFunctionSignature = function (e) { return void 0 !== o(e) }, e.isLegalAssignmentLhs = p });
define('core/math/parser/expression-parser', ["require", "exports", "tslib", "core/math/errormsg", "./surface-node", "./surface-node-error", "./input-span", "./expression-lexer", "./precspec", "./lower"], function (require, e, r, t, a, n, s, i, p, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.parse = void 0; var c = [[p.initial("("), p.la(")"), p.initial("\\{"), p.la("\\}"), p.r("["), p.la("]"), p.initial("(|"), p.la("|)"), p.la("Differential"), p.la("End")], [p.r("for")], [p.ra("...")], [p.la(",")], [p.ra(":")], [p.r("->")], [p.la("="), p.la(">"), p.la("<"), p.la(">="), p.la("<="), p.la("~")], [p.l("->")], [p.l("for")], [p.la("+"), p.la("-")], [p.la("*"), p.la("/"), p.la("Decimal"), p.la("MixedNumber"), p.la("Letter"), p.la("Cmd"), p.la("TokenNode"), p.la("%"), p.r("("), p.la("\\{"), p.la("(|"), p.la("Frac"), p.la("Sqrt"), p.la("Trig"), p.la("Ln"), p.la("Log"), p.ra("Int"), p.ra("Sum"), p.ra("Prod")], [p.initial("+"), p.initial("-")], [p.la("!")], [p.la("SupSub")], [p.l("["), p.la(".")], [p.l("(")], [p.la("Err")]], o = p.precSpec(c), l = o.leftPrec, d = o.rightPrec, E = o.initialPrec, f = { trailingComma: !1 }; function y(e, r) { var t = (void 0 === r ? { isToplevel: !1 } : r).isToplevel; if (i.isDone(e)) return n.Err(i.spanStates(e, e), n.EmptyGroup()); var a = S(e, 0, { isToplevel: t }), s = a.state, p = a.tree; return "Err" === p.type || i.isDone(s) ? p : j(s).tree } function v(e, r) { return { state: e, tree: r } } function S(e, r, s) { var p, u, c, o = (void 0 === s ? { isToplevel: !1 } : s).isToplevel, f = e; if (p = function (e) { var r, s, p, u, c, o, d, f, g, b, x, P, C, w, B, I, L, N, O, T = e, q = i.peek(e), F = E(q.type); switch (q.type) { case "+": if (e = (r = S(e = i.advance(e), F)).state, "Err" === (O = r.tree).type) { if (!m(O.error)) return v(e, O); var R = i.spanStates(T, e); return v(e, n.Err(R, n.UnaryOperatorMissingRight(q.val))) } return v(e, a.Pos(i.spanStates(T, e), [O])); case "-": if (e = (s = S(e = i.advance(e), F)).state, "Err" === (O = s.tree).type) { if (!m(O.error)) return v(e, O); R = i.spanStates(T, e); return v(e, n.Err(R, n.UnaryOperatorMissingRight(q.val))) } return v(e, a.Neg(i.spanStates(T, e), [O])); case "(": return A(e); case "\\{": return e = i.advance(e), i.isAt(e, "\\}") ? v(e = i.advance(e), a.EmptyPiecewise(i.spanStates(T, e))) : (e = (u = U(T, e = (p = S(e, F)).state, O = p.tree, "\\{", "\\}")).state, "Err" === (O = u.tree).type ? v(e, O) : v(e, a.Piecewise(i.spanStates(T, e), [O]))); case "[": return e = i.advance(e), i.isAt(e, "]") ? v(e = i.advance(e), a.List(i.spanStates(T, e), [])) : (e = (o = U(T, e = (c = S(e, F)).state, O = c.tree, "[", "]")).state, "Err" === (O = o.tree).type ? v(e, O) : v(e, a.List(i.spanStates(T, e), [O]))); case "(|": if (e = i.advance(e), i.isAt(e, "|)")) { e = i.advance(e); R = i.spanStates(T, e); return v(e, n.Err(R, n.EmptyPipe())) } return e = (f = U(T, e = (d = S(e, F)).state, O = d.tree, "(|", "|)")).state, "Err" === (O = f.tree).type ? v(e, O) : v(e, a.Pipes(i.spanStates(T, e), [O])); case "Frac": if (e.opts.disallowFrac) throw t.fractionsUnavailable(); e = i.advance(e); var G = y(i.lex(q.num, e.opts)), _ = y(i.lex(q.den, e.opts)); if ("Err" === G.type && "EmptyGroup" === G.error.type && "Err" === _.type && "EmptyGroup" === _.error.type) { R = i.spanStates(T, e); return v(e, n.Err(R, n.FractionEmpty())) } if ("Err" === G.type && "EmptyGroup" === G.error.type) { R = i.spanStates(T, e); return v(e, n.Err(R, n.FractionMissingNumerator())) } if ("Err" === _.type && "EmptyGroup" === _.error.type) { R = i.spanStates(T, e); return v(e, n.Err(R, n.FractionMissingDenominator())) } if ("Err" === G.type) return v(e, G); if ("Err" === _.type) return v(e, _); if (a.isDerivative(G, _) && "Juxt" === _.type) { var W = _.args[1], J = void 0; if (e = (g = S(e, l("*") - 1)).state, "Err" === (J = g.tree).type) { if (m(J.error)) { R = i.spanStates(T, e); return v(e, n.Err(R, n.DerivativeMissingBody())) } return v(e, J) } return v(e, a.Derivative(i.spanStates(T, e), [W, J])) } return v(e, a.Frac(i.spanStates(T, e), [G, _])); case "Sqrt": if (e = i.advance(e), q.optArg) { var z = y(i.lex(q.optArg, e.opts)); return "Err" === z.type ? "EmptyGroup" === z.error.type ? v(e, n.Err(z.span, n.EmptyRadicalIndex())) : v(e, z) : "Err" === (H = y(i.lex(q.arg, e.opts))).type ? "EmptyGroup" === H.error.type ? v(e, n.Err(H.span, n.EmptyRadical())) : v(e, H) : v(e, a.Nthroot(i.spanStates(T, e), [z, H])) } var H; return "Err" === (H = y(i.lex(q.arg, e.opts))).type ? "EmptyGroup" === H.error.type ? v(e, n.Err(H.span, n.EmptyRadical())) : v(e, H) : v(e, a.Sqrt(i.spanStates(T, e), [H])); case "Trig": case "Ln": e = i.advance(e); var K = a.Cmd(i.spanStates(T, e), q.val), Q = 0; if ("SupSub" === (ie = i.peek(e)).type) { if (e = i.advance(e), ie.sub) { R = i.spanStates(T, e); return v(e, n.Err(R, n.UnexpectedSubscript(K.val))) } if (Z = h(ie, e.opts)) { if ("Err" === Z.type) return v(e, Z); K = a.Superscript(i.spanStates(T, e), [K, Z]) } Q = ie.nprimes } if (V = i.isAt(e, "(")) { if (e = (b = A(e)).state, "Err" === (O = b.tree).type) return v(e, O); O = a.Call(i.spanStates(T, e), [K, O.args[0]]) } else { if (e = (x = S(e, F - 1)).state, "Err" === (O = x.tree).type) return m(O.error) ? v(e, n.Err(i.spanStates(T, e), n.FunctionMissingArgument(q.val))) : v(e, O); O = a.ImplicitCall(i.spanStates(T, e), [K, O]) } if (Q > 0) { R = i.spanStates(T, e); if (!V) return v(e, n.Err(R, n.PrimeWithoutParen())); O = a.Prime(R, Q, [O]) } return v(e, O); case "Log": e = i.advance(e); var V, X = i.spanStates(T, e), Y = (K = a.Cmd(X, q.val), Q = 0, void 0), Z = void 0; if ("SupSub" === (ie = i.peek(e)).type && (Y = M(ie, (e = i.advance(e)).opts), Z = h(ie, e.opts), Q = ie.nprimes), Y && "Err" === Y.type) return v(e, Y); if (Z && "Err" === Z.type) return v(e, Z); if (V = i.isAt(e, "(")) { if (e = (P = A(e)).state, "Err" === (O = P.tree).type) return v(e, O); O = O.args[0] } else if (e = (C = S(e, F - 1)).state, "Err" === (O = C.tree).type) return m(O.error) ? v(e, n.Err(i.spanStates(T, e), n.FunctionMissingArgument(q.val))) : v(e, O); var $ = Y ? a.Cmd(X, "\\logbase") : K, ee = Y ? a.Seq(i.spanStates(T, e), a.unwrapSeq(O).concat(Y)) : O; if (Z && ($ = a.Superscript(i.spanStates(T, e), [$, Z])), O = V ? a.Call(i.spanStates(T, e), [$, ee]) : a.ImplicitCall(i.spanStates(T, e), [$, ee]), Q > 0) { R = i.spanStates(T, e); if (!V) return v(e, n.Err(R, n.PrimeWithoutParen())); O = a.Prime(R, Q, [O]) } return v(e, O); case "Int": if (e = i.advance(e), "Err" === (te = D(ie = i.peek(e), T, e = i.advance(e))).type) return "MissingBound" === te.error.type ? v(e, n.Err(te.span, n.IntegralMissingBound())) : v(e, te); Z = te.sup, Y = te.sub, W = void 0; if (i.isAt(e, "Differential")) return e = (w = k(e)).state, "Err" === (W = w.tree).type ? v(e, W) : v(e, a.EmptyIntegral(i.spanStates(T, e), [W, Y, Z])); if (e = (B = S(e, F)).state, "Err" === (O = B.tree).type) return m(O.error) ? v(e, n.Err(O.span, n.IntegralMissingBody())) : v(e, O); var re = O; return i.isAt(e, "Differential") ? (e = (I = k(e)).state, "Err" === (W = I.tree).type ? v(e, W) : v(e, a.Integral(i.spanStates(T, e), [W, Y, Z, re]))) : v(e, n.Err(i.spanStates(T, e), n.IntegralMissingDifferential())); case "Sum": if (e = i.advance(e), "Err" === (te = D(ie = i.peek(e), T, e = i.advance(e))).type) return "MissingBound" === te.error.type ? v(e, n.Err(te.span, n.SumMissingBound())) : v(e, te); Z = te.sup, Y = te.sub; return e = (L = S(e, F)).state, "Err" === (O = L.tree).type ? m(O.error) ? v(e, n.Err(O.span, n.SumMissingBody())) : v(e, O) : v(e, a.Sum(i.spanStates(T, e), [O, Y, Z])); case "Prod": var te; if (e = i.advance(e), "Err" === (te = D(ie = i.peek(e), T, e = i.advance(e))).type) return "MissingBound" === te.error.type ? v(e, n.Err(te.span, n.ProductMissingBound())) : v(e, te); Z = te.sup, Y = te.sub; return e = (N = S(e, F)).state, "Err" === (O = N.tree).type ? m(O.error) ? v(e, n.Err(O.span, n.ProductMissingBody())) : v(e, O) : v(e, a.Product(i.spanStates(T, e), [O, Y, Z])); case "Cmd": return v(e = i.advance(e), O = a.Cmd(i.spanStates(T, e), q.val)); case "TokenNode": return e = i.advance(e), "SupSub" === (ie = i.peek(e)).type && ie.sub ? v(e = i.advance(e), n.Err(i.spanStates(T, e), n.TokenWithSubscript())) : v(e, O = a.Cmd(i.spanStates(T, e), q.val)); case "Letter": return v(e = i.advance(e), O = a.Letter(i.spanStates(T, e), q.val)); case "Decimal": e = i.advance(e); var ae = a.Decimal(i.spanStates(T, e), q.val); if ("Decimal" === (ie = e.token).type || "MixedNumber" === ie.type) { var ne = e; e = i.advance(e); R = i.spanStates(T, e); var se = "MixedNumber" === ie.type ? ie : a.Decimal(i.spanStates(ne, e), ie.val); return v(e, n.Err(R, n.AdjacentNumbers([ae, se]))) } return v(e, ae); case "MixedNumber": if (e.opts.disallowFrac) throw t.fractionsUnavailable(); var ie; if ("Decimal" === (ie = (e = i.advance(e)).token).type || "MixedNumber" === ie.type) { ne = e; e = i.advance(e); R = i.spanStates(T, e), se = "MixedNumber" === ie.type ? ie : a.Decimal(i.spanStates(ne, e), ie.val); return v(e, n.Err(R, n.AdjacentNumbers([q, se]))) } return v(e, q); case "*": case "/": case ",": case "=": case ">": case "<": case ">=": case "<=": case "->": case "~": case ":": case "...": case "%": case ".": e = i.advance(e); R = i.spanStates(T, e); return v(e, n.Err(R, n.BinaryOperatorMissingLeft(q.val))); case "for": e = i.advance(e); R = i.spanStates(T, e); return v(e, n.Err(R, n.UnexpectedFor())); case "!": e = i.advance(e); R = i.spanStates(T, e); return v(e, n.Err(R, n.UnaryOperatorMissingLeft(q.val))); case "SupSub": e = i.advance(e); var pe = "supsub"; q.sub ? pe = "subscript" : q.sup ? pe = "superscript" : q.nprimes > 0 && (pe = "prime"); R = i.spanStates(T, e); return v(e, n.Err(R, n.UnaryOperatorMissingLeft(pe))); case ")": case "\\}": case "]": case "|)": case "Differential": return j(e); case "Err": e = i.advance(e); R = i.spanStates(T, e); return v(e, n.Err(R, n.UnrecognizedSymbol(q.val))); case "End": R = i.spanStates(T, e); return v(e, n.Err(R, n.UnexpectedEnd())); default: throw "Unexpected token type " + q.type + "." } }(f), f = p.state, "Err" === (c = p.tree).type) return v(f, c); if (!i.didAdvance(e, f)) throw new Error("Programming Error: parseInitial did not advance state."); for (; !i.isDone(f);) { if (r >= (i.isAt(f, "(") && !x(c) ? d("(") : l(i.peek(f).type))) break; var P = f; if (f = (u = b(f, c, g(f, c, o) ? l(",") - 1 : d(i.peek(f).type))).state, "Err" === (c = u.tree).type) return v(f, c); if (!i.didAdvance(P, f)) throw new Error("Programming Error: parseSuccessor did not advance state.") } return v(f, c) } function m(e) { return "UnexpectedDifferential" === e.type || "UnexpectedCloseDelimiter" === e.type || "UnexpectedEnd" === e.type || "BinaryOperatorMissingLeft" === e.type } function g(e, r, t) { return i.isAt(e, "=") && t && (u.isFunctionSignature(r) || u.isLegalAssignmentLhs(r)) } function b(e, r, t) { var s, p, u, c, o, d, E, f, y, g, b, x, M, D = i.peek(e); switch (D.type) { case "+": case "-": case "*": case "/": case "=": case "~": case ":": case ".": case "->": case "for": if (e = (s = S(e = i.advance(e), t)).state, "Err" === (M = s.tree).type) { if (m(M.error)) { var k = i.joinState(r.span, e); return v(e, n.Err(k, n.BinaryOperatorMissingRight(D.val))) } return v(e, M) } return v(e, function (e, r, t) { switch (e) { case "+": return a.Add(r, t); case "-": return a.Sub(r, t); case "*": return a.Mul(r, t); case "/": return a.Div(r, t); case "=": return a.Equals(r, t); case "~": return a.Tilde(r, t); case ":": return a.Colon(r, t); case ".": return a.Dot(r, t); case "->": return a.RightArrow(r, t); case "for": return a.For(r, t); default: throw "Unexpected token type " + e + "." } }(D.type, i.joinState(r.span, e), [r, M])); case "%": e = i.advance(e); var w = i.peek(e); if ("Cmd" !== w.type || "of" !== w.val && "\\of" !== w.val) return v(e, n.Err(D.span, n.PercentMissingOf())); if (e = (p = S(e = i.advance(e), t)).state, "Err" === (M = p.tree).type) { if (m(M.error)) { k = i.joinState(r.span, e); return v(e, n.Err(k, n.BinaryOperatorMissingRight(D.val))) } return v(e, M) } return v(e, a.PercentOf(i.joinState(r.span, e), [r, M])); case ">=": case "<=": case ">": case "<": var B = D.type; if (e = (u = S(e = i.advance(e), t)).state, "Err" === (M = u.tree).type) { if (m(M.error)) { k = i.joinState(r.span, e); return v(e, n.Err(k, n.BinaryOperatorMissingRight(D.val))) } return v(e, M) } for (var I = a.Inequality(i.joinState(r.span, e), B, [r, M]), L = [], N = i.peek(e).type; ">=" === N || "<=" === N || ">" === N || "<" === N;) { var O = e; if (B = N, e = (c = S(e = i.advance(e), t)).state, "Err" === (M = c.tree).type) { if (m(M.error)) { k = i.joinState(r.span, e); return v(e, n.Err(k, n.BinaryOperatorMissingRight(D.val))) } return v(e, M) } L.push(a.TrailingInequalityPiece(i.spanStates(O, e), B, [M])), N = i.peek(e).type } return L.length ? v(e, a.InequalityChain(i.joinState(r.span, e), I, L)) : v(e, I); case "!": return v(e = i.advance(e), a.Bang(i.joinState(r.span, e), [r])); case "[": O = e; if (e = i.advance(e), i.isAt(e, "]")) { e = i.advance(e); k = i.spanStates(O, e); return v(e, n.Err(k, n.EmptySquareBracket())) } return e = (d = U(O, e = (o = S(e, t)).state, M = o.tree, "[", "]")).state, "Err" === (M = d.tree).type ? v(e, M) : v(e, a.Index(i.joinState(r.span, e), [r, M])); case "Sqrt": case "Frac": case "Letter": case "Cmd": case "TokenNode": case "Trig": case "Ln": case "Log": case "Sum": case "Int": case "Prod": case "Decimal": case "MixedNumber": case "\\{": case "(|": return e = (E = S(e, t)).state, "Err" === (M = E.tree).type ? v(e, M) : v(e, a.Juxt(i.joinState(r.span, e), [r, M])); case "(": if (a.isIdentifier(r)) { if (e = (f = A(e)).state, "Err" === (M = f.tree).type) return v(e, M); k = i.joinState(r.span, e); return v(e, a.Call(k, [r, M.args[0]])) } if ("Prime" === r.type && a.isIdentifier(r.args[0])) { if (e = (y = A(e)).state, "Err" === (M = y.tree).type) return v(e, M); k = i.joinState(r.span, e); return v(e, a.Prime(k, r.nprimes, [a.Call(k, [r.args[0], M.args[0]])])) } return e = (g = S(e, t)).state, "Err" === (M = g.tree).type ? v(e, M) : v(e, a.Juxt(i.joinState(r.span, e), [r, M])); case "SupSub": e = i.advance(e); var T = P(D), q = h(D, e.opts); if (T && "Err" === T.type) return v(e, T); if (q && "Err" === q.type) return v(e, q); if (T && (r = a.Subscript(i.joinState(r.span, e), [r, T])), q && (r = a.Superscript(i.joinState(r.span, e), [r, q])), D.nprimes > 0) { k = i.joinState(r.span, e); if (!a.isIdentifier(r)) return v(e, n.Err(k, n.UnexpectedPrime())); r = a.Prime(k, D.nprimes, [r]) } return v(e, r); case ",": for (var F = [r]; i.isAt(e, ",") && (e = i.advance(e), !i.isAt(e, "...")) && (!e.opts.trailingComma || !C(e));) { if (e = (b = S(e, t)).state, "Err" === (M = b.tree).type) { if (m(M.error)) { k = i.joinState(r.span, e); return v(e, n.Err(k, n.BinaryOperatorMissingRight(D.val))) } return v(e, M) } F.push(M) } return v(e, a.Seq(i.joinState(r.span, e), F)); case "...": if (e = i.advance(e), i.isAt(e, ",") && (e = i.advance(e)), t >= l(i.peek(e).type)) return v(e, a.Ellipsis(i.joinState(r.span, e), [r, a.EmptyRangeEnd(i.emptySpanAtState(e))])); if (e = (x = S(e, t)).state, "Err" === (M = x.tree).type) { if (m(M.error)) { k = i.joinState(r.span, e); return v(e, n.Err(k, n.BinaryOperatorMissingRight(D.val))) } return v(e, M) } return v(e, a.Ellipsis(i.joinState(r.span, e), [r, M])); case "]": case ")": case "\\}": case "|)": case "Differential": return j(e); case "Err": return S(e, t); case "End": k = i.spanStates(e, e); return v(e, n.Err(k, n.UnexpectedEnd())); default: throw "Unexpected token type " + D.type + "." } } function x(e) { return !!a.isIdentifier(e) || !("Prime" !== e.type || !a.isIdentifier(e.args[0])) } function M(e, r) { if (e.sub) { var t = e.sub, a = y(i.lex(t, r)); return "Err" === a.type && "EmptyGroup" === a.error.type ? n.Err(a.span, n.EmptySubscript()) : a } } function P(e) { if (e.sub) { var r = e.sub; if (0 === r.args.length) return n.Err(r.span, n.EmptySubscript()); for (var t = [], i = 0, p = r.args; i < p.length; i++) { var u = p[i]; if ("Digit" !== u.type && "Letter" !== u.type) { var c = u.span; return n.Err(c, n.InvalidSubscript(s.slice(c))) } t.push(u.val) } return a.Alphanumeric(r.span, t.join("")) } } function h(e, r) { if (e.sup) { var t = y(i.lex(e.sup, r)); return "Err" === t.type ? "EmptyGroup" === t.error.type ? n.Err(t.span, n.EmptySuperscript()) : t : e.nprimes > 0 ? n.Err(e.span, n.SuperscriptWithPrime()) : t } } function D(e, r, t) { if ("SupSub" !== e.type) { var a = i.spanStates(r, t); return n.Err(a, n.MissingBound()) } if (e.nprimes > 0) { a = i.spanStates(r, t); return n.Err(a, n.UnexpectedPrime()) } var s = M(e, t.opts), p = h(e, t.opts); if (!s || "Err" === s.type && "EmptySubscript" === s.error.type || !p || "Err" === p.type && "EmptySuperscript" === p.error.type) { a = i.spanStates(r, t); return n.Err(a, n.MissingBound()) } return "Err" === s.type ? s : "Err" === p.type ? p : { type: "Bounds", sup: p, sub: s } } function A(e) { var r, t, n, s = e, p = i.peek(e), u = E(p.type); if (!i.isAt(e, "(")) throw new Error("Programming Error: expected '(' at start of parseParen."); if (e = i.advance(e), i.isAt(e, ")")) { var c = a.Seq(i.emptySpanAtState(e), []); e = i.advance(e); var o = i.spanStates(s, e); return v(e, a.Paren(o, [c])) } return e = (t = U(s, e = (r = S(e, u)).state, n = r.tree, "(", ")")).state, "Err" === (n = t.tree).type ? v(e, n) : v(e, a.Paren(i.spanStates(s, e), [n])) } function k(e) { var r = e, t = i.peek(e); if ("Differential" !== t.type) throw new Error("Programming Error: expected differential"); e = i.advance(e); var s = a.Cmd(t.span, t.val), p = i.peek(e); if ("SupSub" === p.type) { e = i.advance(e); var u = i.spanStates(r, e), c = P(p); if (c) { if ("Err" === c.type) return v(e, c); s = a.Subscript(u, [s, c]) } if (p.sup) return v(e, n.Err(u, n.DifferentialWithSuperscript())); if (p.nprimes > 0) return v(e, n.Err(u, n.UnexpectedPrime())) } return v(e, s) } function U(e, r, t, a, s) { if ("Err" === t.type && "UnexpectedEnd" !== t.error.type) return v(r, t); if ("Err" === t.type || !i.isAt(r, s)) { var p = i.spanStates(e, r); return v(r, n.Err(p, n.MissingCloseDelimiter(a, s))) } return v(r = i.advance(r), t) } function j(e) { var r = e; switch (i.peek(e).type) { case ")": e = i.advance(e); var t = i.spanStates(r, e); return v(e, n.Err(t, n.UnexpectedCloseDelimiter("(", ")"))); case "]": e = i.advance(e); t = i.spanStates(r, e); return v(e, n.Err(t, n.UnexpectedCloseDelimiter("[", "]"))); case "\\}": e = i.advance(e); t = i.spanStates(r, e); return v(e, n.Err(t, n.UnexpectedCloseDelimiter("\\{", "\\}"))); case "|)": e = i.advance(e); t = i.spanStates(r, e); return v(e, n.Err(t, n.UnexpectedCloseDelimiter("|", "|"))); case "Differential": e = i.advance(e); t = i.spanStates(r, e); return v(e, n.Err(t, n.UnexpectedDifferential())); default: e = i.advance(e); t = i.spanStates(r, e); return v(e, n.Err(t, n.UnexpectedParseError())) } } function C(e) { return i.isAt(e, ")") || i.isAt(e, "]") || i.isAt(e, "\\}") } e.parse = function (e, t) { var a = t ? r.__assign(r.__assign({}, f), t) : f, s = y(i.lex(e, a), { isToplevel: !0 }); return "Err" === s.type && "EmptyGroup" === s.error.type ? n.Err(s.span, n.EmptyInput()) : s } });
define('core/math/baseparser', ["require", "exports", "parsenodes", "core/math/errormsg", "core/math/parser/latex-parser", "core/math/parser/expression-parser", "core/math/parser/lower"], function (require, r, e, a, t, o, n) { "use strict"; function i() { throw a.featureUnavailable() } function s(r, e) { return r.setInputSpan(e), r } Object.defineProperty(r, "__esModule", { value: !0 }), r.parse = void 0, r.parse = function (r, l) { void 0 === l && (l = {}); var d = typeof r; if ("string" !== d) throw new Error("Type Error: parse can only be called with strings, got " + JSON.stringify(r) + " of type " + d); var c = e; if (l.disabledFeatures) { c = Object.create(c); for (var p = 0, u = l.disabledFeatures; p < u.length; p++) { var f = u[p]; if (!c[f]) throw new Error("Programming Error: " + f + " cannot be disabled because it is not a parsenode."); c[f] = i } } var v = void 0 === l.seedPrefix ? "" : l.seedPrefix, w = 0, m = { nodes: c, currentIndex: l.index, setInput: s, nextSeed: function () { var r = v + "::vc" + w; return w += 1, r }, allowDt: !!l.allowDt, allowIndex: !!l.allowIndex }, g = {}; void 0 !== l.trailingComma && (g.trailingComma = l.trailingComma), l.disallowFrac && (g.disallowFrac = !0); try { var h = t.parse(r), x = o.parse(h, g); return n.lower(m, x) } catch (r) { return r instanceof e.Error ? r : "string" == typeof r ? e.Error(r) : a.parseError() } } });
define('core/math/sliders', ["require", "exports"], function (require, e) { "use strict"; function a(e, a) { var r = Math.round(1e6 * e) / 1e6; return Math.abs(r - e) < a ? r : e } function r(e) { var r = e.target, t = e.hardMin, i = e.hardMax, n = e.step, o = 1e-10; if (void 0 !== t && void 0 !== i && (o = Math.min(o, Math.abs(i - t) / 1e3)), n && (o = Math.min(o, n / 10)), void 0 !== t && (t = a(t, o)), void 0 !== i && (i = a(i, o)), e.forceSliderToMax && void 0 !== i && (r = i), t > i) return t; if (r <= t) return t; if (r >= i) return i; if (n) { var d = void 0 !== t ? t : 0; r = n * Math.round((r - d) / n) + d } var u = a(r, o); return (n || t === u || i === u) && (r = u), r <= t ? t : r >= i ? i : r } Object.defineProperty(e, "__esModule", { value: !0 }), e.computeSoftMax = e.constrainSliderValueLikeEvaluator = e.determineWhichLimitsAreCompatibleWithValue = e.roundToReasonableDecimal = void 0, e.roundToReasonableDecimal = a, e.determineWhichLimitsAreCompatibleWithValue = function (e) { var a = !0, t = !0, i = !0; return void 0 !== e.hardMin && e.target < e.hardMin && (a = !1), void 0 !== e.hardMax && e.target > e.hardMax && (t = !1), e.step && r({ target: e.target, step: e.step, hardMin: a ? e.hardMin : void 0, hardMax: t ? e.hardMax : void 0 }) !== e.target && (i = !1), { min: a, max: t, step: i } }, e.constrainSliderValueLikeEvaluator = r, e.computeSoftMax = function (e) { var a = e.storedMax, t = e.sliderValue, i = e.hardMin, n = e.step, o = 10; if (a > o && (o = a), t > o && (o = t), i > o && (o = i), n) { var d = r({ target: o, hardMin: i, hardMax: void 0, step: n }); o = d >= o ? d : d + n } return o } });
define('core/math/features/getConcreteTree', ['require', 'parsenodes', 'core/math/errormsg', 'core/math/types', 'core/math/maybe-rational', 'core/math/sliders'], function (require) { "use strict"; var e = require("parsenodes"), t = require("core/math/errormsg"), r = require("core/math/types"), i = require("core/math/maybe-rational"), s = (e.List, e.ParenSeq, e.Constant), n = e.Identifier, o = require("core/math/sliders"); function a(e, r) { return e.isError ? e : -1 === r.indexOf(e.valueType) ? t.parseError() : e } function l(e, t, r) { if (t) { var i = t.getDependencies(); if (t.isError) r.errors[e] = !0; else if (i.length > 0) { r.errors[e] = !0; for (var s = 0; s < i.length; s++)i[s] === r.exportedSymbol ? r.errors.cycle = !0 : r.missingVars.push(i[s]) } else r.values[e] = +t.asValue(); r.valids[e] = isFinite(r.values[e]), r.valids[e] || (r.values[e] = void 0) } else r.valids[e] = !0 } function c(e) { return e && e.valueType === r.ListOfNumber && 1 === e.length && e.args ? e.args[0] : e } function u(i, s) { if (!s[this._symbol]) throw t.functionUnsupported(this._symbol); var n = this.args.map(function (e) { return e.getConcreteTree(i, s) }); if (n.length > 0) { if (1 === n.length && n.push(e.Constant(1).getConcreteTree(i, s)), n[1].getDependencies().length) throw t.illegalBinWidth(this._symbol).setDependencies(n[1].getDependencies()); if (n[1].valueType !== r.Number) throw t.illegalBinWidth(this._symbol); var o = n[1].asValue(); if (!isFinite(o) || o <= 0) throw t.illegalBinWidth(this._symbol) } return this.typeCheck(i, n), new this.constructor(n) } function h(e, r) { if (!r[this._symbol]) throw t.functionUnsupported(this._symbol); var i = this.args.map(function (t) { return t.getConcreteTree(e, r) }); return this.typeCheck(e, i), new this.constructor(i) } e.Base.prototype.tryGetConcreteTree = function () { var r; try { r = this.getConcreteTree.apply(this, arguments) } catch (i) { r = i instanceof e.Base ? i : t.parseError() } return r }, e.Base.prototype.getConcreteTree = function (e, t) { var r = this.buildIRExpression(e, t); if (r.isError) throw r; return r }, e.DoubleInequality.prototype.getConcreteTree = function (t, r) { return new this.constructor([e.Piecewise([this._indicator, this._expressions[0], s(NaN)]).getConcreteTree(t, r), this._operators[0], n(this._symbol), this._operators[1], e.Piecewise([this._indicator, this._expressions[1], s(NaN)]).getConcreteTree(t, r)]) }, e.Error.prototype.getConcreteTree = function (e, t) { return this }, e.Image.prototype.getConcreteTree = function (t, i) { var s = this.center.tryGetConcreteTree(t, i), n = this.radianAngle.tryGetConcreteTree(t, i), o = this.width.tryGetConcreteTree(t, i), l = this.height.tryGetConcreteTree(t, i), c = this.opacity.tryGetConcreteTree(t, i), u = [r.Point, r.ListOfPoint, r.EmptyList], h = [r.Number, r.ListOfNumber, r.EmptyList]; return s = a(s, u), n = a(n, h), o = a(o, h), l = a(l, h), c = a(c, h), e.Image({ center: s, radianAngle: n, width: o, height: l, opacity: c }, this.moveStrategy) }, e.Ticker.prototype.getConcreteTree = function (i, s) { var n = this.handler.tryGetConcreteTree(i, s); n.isError || n.valueType === r.Action || (n = t.eventHandlerTypeError(r.prettyPrint(n.valueType))); var o = n.getDependencies().filter(function (e) { return !i.validActionVariable(e) }); return o.length && (n = t.tooManyVariables(i.sliderVariables(o)).setDependencies(o)), e.Ticker({ handler: n, minStep: this.minStep.tryGetConcreteTree(i, s) }) }, e.Slider.prototype.getConcreteTree = function (e, r) { var n = this._expression.getConcreteTree(e, r), a = c(this.sliderMin && this.sliderMin.tryGetConcreteTree(e, r)), u = c(this.sliderMax && this.sliderMax.tryGetConcreteTree(e, r)), h = c(this.sliderStep && this.sliderStep.tryGetConcreteTree(e, r)), p = { exportedSymbol: this._symbol, errors: {}, values: {}, valids: {}, missingVars: [], errMsg: void 0 }; if (l("min", a, p), l("max", u, p), l("step", h, p), h && p.valids.step && (0 === p.values.step ? delete p.values.step : p.values.step = Math.abs(p.values.step)), p.errors.cycle ? n = t.sliderLimitReferencesExport(p.exportedSymbol) : (p.errors.min || !p.valids.min ? p.errMsg = t.sliderMinInvalid() : p.errors.max || !p.valids.max ? p.errMsg = t.sliderMaxInvalid() : !p.errors.step && p.valids.step || (p.errMsg = t.sliderStepInvalid()), p.values.min > p.values.max && (p.valids.min = !1, p.valids.max = !1, p.errMsg || (p.errMsg = t.sliderMaxLessThanMin()))), n.isConstant) { var d = r.initialEvaluation && r.initialEvaluation.asValue() && this.sliderIsPlayingOnce, y = p.values.max, v = +n.asValue(), g = p.values.min, T = p.values.step; if (d && !isFinite(y)) { var m = c(this.sliderSoftMax && this.sliderSoftMax.tryGetConcreteTree(e, r)); m && (y = o.computeSoftMax({ storedMax: +m.asValue(), sliderValue: v, step: T, hardMin: g })) } var f = o.constrainSliderValueLikeEvaluator({ target: v, hardMin: g, hardMax: y, step: T, forceSliderToMax: d }), C = i.fromDecimalString(f.toString()), b = isFinite(i.asFloat(C)) ? C : f; n = s(b).getConcreteTree(e, r) } return n.sliderInfo = p, n }, e.Histogram.prototype.getConcreteTree = u, e.DotPlot.prototype.getConcreteTree = u, e.BoxPlot.prototype.getConcreteTree = function (e, i) { if (!i[this._symbol]) throw t.functionUnsupported(this._symbol); var s = this.args.map(function (t) { return t.getConcreteTree(e, i) }); return this.typeCheck(e, s), 1 !== s.length || s[0].valueType !== r.ListOfNumber && s[0].valueType !== r.EmptyList ? t.parseError() : new this.constructor(s) }, e.TTest.prototype.getConcreteTree = h, e.IndependentTTest.prototype.getConcreteTree = h, e.Stats.prototype.getConcreteTree = h, e.Table.prototype.getConcreteTree = function (e, t) { for (var r = [], i = Object.create(t), s = 0; s < this.columns.length; s++) { var n = this.columns[s].getConcreteTree(e, i); n.isIndependent && this.columns[s].exportToLocal(n, i), r.push(n) } return new this.constructor(r) }, e.TableColumn.prototype.getConcreteTree = function (i, s, n) { var o, a, l = this.header.getConcreteTree(i, s); if (this.header instanceof e.Identifier && !s[this.header._symbol]) { o = []; for (var c = 0; c < this.values.length; c++)if (this.values[c].tableError()) o.push(t.invalidTableEntry(this.values[c].tableError())); else { var u = this.values[c].tryGetConcreteTree(i, s); u.isError ? o.push(u) : u.tableError() ? o.push(t.invalidTableEntry(u.tableError())) : u.valueType === r.Number ? o.push(u) : o.push(t.tableEntryTypeError([r.prettyPrint(u.valueType)])) } return (a = new this.constructor(l, this.length, o)).isIndependent = !0, a } if (l.isConstant) { for (var h = [], p = 0; p < this.length; p++)h.push(l); o = h } else o = l.isList ? l.mapElements(function (e) { return e }) : []; if (l.isError || l.valueType === r.Number || l.valueType === r.ListOfNumber || l.valueType === r.EmptyList || (l = t.tableHeaderTypeError([r.prettyPrint(l.valueType)])), a = new this.constructor(l, this.length, o), void 0 !== n) { var d = this.header.tryGetConcreteTree(i, n); d.isError || d.valueType !== r.Number || (a.continuousConcreteTree = d) } return a } });
define('core/math/builtinconstants', ['require', 'core/math/parsenode/constant', 'core/math/maybe-rational'], function (require) { "use strict"; var t = require("core/math/parsenode/constant"), a = require("core/math/maybe-rational").maybeRational; return { pi: t(Math.PI), tau: t(2 * Math.PI), e: t(Math.E), trigAngleMultiplier: t(a(1, 1)), infty: t(1 / 0) } });
define('core/math/builtinframe', ['require', 'core/math/builtinconstants', 'core/math/ir/builtin-table'], function (require) { "use strict"; var n, i = require("core/math/builtinconstants"), t = require("core/math/ir/builtin-table"), r = {}; for (n in i) i.hasOwnProperty(n) && (r[n] = i[n]); for (n in t.BuiltInTable) t.BuiltInTable.hasOwnProperty(n) && (r[n] = { isFunction: !0 }); for (n in t.CompilerFunctionTable) t.CompilerFunctionTable.hasOwnProperty(n) && (r[n] = { isFunction: !0 }); return r });
define('core/math/ir/scope', ["require", "exports"], function (require, e) { "use strict"; function o(e, o) { return { symbolMap: e, maxIndex: o } } Object.defineProperty(e, "__esModule", { value: !0 }), e.childScope = e.setSymbol = e.getSymbol = e.Scope = void 0, e.Scope = o, e.getSymbol = function (e, o) { return e.symbolMap[o] }, e.setSymbol = function (e, o, t) { e.symbolMap[o] = t, e.maxIndex = Math.max(e.maxIndex, t) }, e.childScope = function (e) { return o(Object.create(e.symbolMap), e.maxIndex) } });
define('core/vendor/d3-color', ['require'], function (require) { function e(e, t, r) { e.prototype = t.prototype = r, r.constructor = e } function t(e, t) { var r = Object.create(e.prototype); for (var n in t) r[n] = t[n]; return r } function r() { } var n = .7, i = 1 / n, a = "\\s*([+-]?\\d+)\\s*", o = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*", s = "\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*", l = /^#([0-9a-f]{3,8})$/, h = new RegExp("^rgb\\(" + [a, a, a] + "\\)$"), u = new RegExp("^rgb\\(" + [s, s, s] + "\\)$"), g = new RegExp("^rgba\\(" + [a, a, a, o] + "\\)$"), c = new RegExp("^rgba\\(" + [s, s, s, o] + "\\)$"), d = new RegExp("^hsl\\(" + [o, s, s] + "\\)$"), b = new RegExp("^hsla\\(" + [o, s, s, o] + "\\)$"), p = { aliceblue: 15792383, antiquewhite: 16444375, aqua: 65535, aquamarine: 8388564, azure: 15794175, beige: 16119260, bisque: 16770244, black: 0, blanchedalmond: 16772045, blue: 255, blueviolet: 9055202, brown: 10824234, burlywood: 14596231, cadetblue: 6266528, chartreuse: 8388352, chocolate: 13789470, coral: 16744272, cornflowerblue: 6591981, cornsilk: 16775388, crimson: 14423100, cyan: 65535, darkblue: 139, darkcyan: 35723, darkgoldenrod: 12092939, darkgray: 11119017, darkgreen: 25600, darkgrey: 11119017, darkkhaki: 12433259, darkmagenta: 9109643, darkolivegreen: 5597999, darkorange: 16747520, darkorchid: 10040012, darkred: 9109504, darksalmon: 15308410, darkseagreen: 9419919, darkslateblue: 4734347, darkslategray: 3100495, darkslategrey: 3100495, darkturquoise: 52945, darkviolet: 9699539, deeppink: 16716947, deepskyblue: 49151, dimgray: 6908265, dimgrey: 6908265, dodgerblue: 2003199, firebrick: 11674146, floralwhite: 16775920, forestgreen: 2263842, fuchsia: 16711935, gainsboro: 14474460, ghostwhite: 16316671, gold: 16766720, goldenrod: 14329120, gray: 8421504, green: 32768, greenyellow: 11403055, grey: 8421504, honeydew: 15794160, hotpink: 16738740, indianred: 13458524, indigo: 4915330, ivory: 16777200, khaki: 15787660, lavender: 15132410, lavenderblush: 16773365, lawngreen: 8190976, lemonchiffon: 16775885, lightblue: 11393254, lightcoral: 15761536, lightcyan: 14745599, lightgoldenrodyellow: 16448210, lightgray: 13882323, lightgreen: 9498256, lightgrey: 13882323, lightpink: 16758465, lightsalmon: 16752762, lightseagreen: 2142890, lightskyblue: 8900346, lightslategray: 7833753, lightslategrey: 7833753, lightsteelblue: 11584734, lightyellow: 16777184, lime: 65280, limegreen: 3329330, linen: 16445670, magenta: 16711935, maroon: 8388608, mediumaquamarine: 6737322, mediumblue: 205, mediumorchid: 12211667, mediumpurple: 9662683, mediumseagreen: 3978097, mediumslateblue: 8087790, mediumspringgreen: 64154, mediumturquoise: 4772300, mediumvioletred: 13047173, midnightblue: 1644912, mintcream: 16121850, mistyrose: 16770273, moccasin: 16770229, navajowhite: 16768685, navy: 128, oldlace: 16643558, olive: 8421376, olivedrab: 7048739, orange: 16753920, orangered: 16729344, orchid: 14315734, palegoldenrod: 15657130, palegreen: 10025880, paleturquoise: 11529966, palevioletred: 14381203, papayawhip: 16773077, peachpuff: 16767673, peru: 13468991, pink: 16761035, plum: 14524637, powderblue: 11591910, purple: 8388736, rebeccapurple: 6697881, red: 16711680, rosybrown: 12357519, royalblue: 4286945, saddlebrown: 9127187, salmon: 16416882, sandybrown: 16032864, seagreen: 3050327, seashell: 16774638, sienna: 10506797, silver: 12632256, skyblue: 8900331, slateblue: 6970061, slategray: 7372944, slategrey: 7372944, snow: 16775930, springgreen: 65407, steelblue: 4620980, tan: 13808780, teal: 32896, thistle: 14204888, tomato: 16737095, turquoise: 4251856, violet: 15631086, wheat: 16113331, white: 16777215, whitesmoke: 16119285, yellow: 16776960, yellowgreen: 10145074 }; function m() { return this.rgb().formatHex() } function f() { return this.rgb().formatRgb() } function y(e) { var t, r; return e = (e + "").trim().toLowerCase(), (t = l.exec(e)) ? (r = t[1].length, t = parseInt(t[1], 16), 6 === r ? w(t) : 3 === r ? new v(t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | 240 & t, (15 & t) << 4 | 15 & t, 1) : 8 === r ? k(t >> 24 & 255, t >> 16 & 255, t >> 8 & 255, (255 & t) / 255) : 4 === r ? k(t >> 12 & 15 | t >> 8 & 240, t >> 8 & 15 | t >> 4 & 240, t >> 4 & 15 | 240 & t, ((15 & t) << 4 | 15 & t) / 255) : null) : (t = h.exec(e)) ? new v(t[1], t[2], t[3], 1) : (t = u.exec(e)) ? new v(255 * t[1] / 100, 255 * t[2] / 100, 255 * t[3] / 100, 1) : (t = g.exec(e)) ? k(t[1], t[2], t[3], t[4]) : (t = c.exec(e)) ? k(255 * t[1] / 100, 255 * t[2] / 100, 255 * t[3] / 100, t[4]) : (t = d.exec(e)) ? E(t[1], t[2] / 100, t[3] / 100, 1) : (t = b.exec(e)) ? E(t[1], t[2] / 100, t[3] / 100, t[4]) : p.hasOwnProperty(e) ? w(p[e]) : "transparent" === e ? new v(NaN, NaN, NaN, 0) : null } function w(e) { return new v(e >> 16 & 255, e >> 8 & 255, 255 & e, 1) } function k(e, t, r, n) { return n <= 0 && (e = t = r = NaN), new v(e, t, r, n) } function N(e) { return e instanceof r || (e = y(e)), e ? new v((e = e.rgb()).r, e.g, e.b, e.opacity) : new v } function x(e, t, r, n) { return 1 === arguments.length ? N(e) : new v(e, t, r, null == n ? 1 : n) } function v(e, t, r, n) { this.r = +e, this.g = +t, this.b = +r, this.opacity = +n } function M() { return "#" + q(this.r) + q(this.g) + q(this.b) } function R() { var e = this.opacity; return (1 === (e = isNaN(e) ? 1 : Math.max(0, Math.min(1, e))) ? "rgb(" : "rgba(") + Math.max(0, Math.min(255, Math.round(this.r) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.g) || 0)) + ", " + Math.max(0, Math.min(255, Math.round(this.b) || 0)) + (1 === e ? ")" : ", " + e + ")") } function q(e) { return ((e = Math.max(0, Math.min(255, Math.round(e) || 0))) < 16 ? "0" : "") + e.toString(16) } function E(e, t, r, n) { return n <= 0 ? e = t = r = NaN : r <= 0 || r >= 1 ? e = t = NaN : t <= 0 && (e = NaN), new C(e, t, r, n) } function $(e) { if (e instanceof C) return new C(e.h, e.s, e.l, e.opacity); if (e instanceof r || (e = y(e)), !e) return new C; if (e instanceof C) return e; var t = (e = e.rgb()).r / 255, n = e.g / 255, i = e.b / 255, a = Math.min(t, n, i), o = Math.max(t, n, i), s = NaN, l = o - a, h = (o + a) / 2; return l ? (s = t === o ? (n - i) / l + 6 * (n < i) : n === o ? (i - t) / l + 2 : (t - n) / l + 4, l /= h < .5 ? o + a : 2 - o - a, s *= 60) : l = h > 0 && h < 1 ? 0 : s, new C(s, l, h, e.opacity) } function H(e, t, r, n) { return 1 === arguments.length ? $(e) : new C(e, t, r, null == n ? 1 : n) } function C(e, t, r, n) { this.h = +e, this.s = +t, this.l = +r, this.opacity = +n } function j(e, t, r) { return 255 * (e < 60 ? t + (r - t) * e / 60 : e < 180 ? r : e < 240 ? t + (r - t) * (240 - e) / 60 : t) } return e(r, y, { copy: function (e) { return Object.assign(new this.constructor, this, e) }, displayable: function () { return this.rgb().displayable() }, hex: m, formatHex: m, formatHsl: function () { return $(this).formatHsl() }, formatRgb: f, toString: f }), e(v, x, t(r, { brighter: function (e) { return e = null == e ? i : Math.pow(i, e), new v(this.r * e, this.g * e, this.b * e, this.opacity) }, darker: function (e) { return e = null == e ? n : Math.pow(n, e), new v(this.r * e, this.g * e, this.b * e, this.opacity) }, rgb: function () { return this }, displayable: function () { return -.5 <= this.r && this.r < 255.5 && -.5 <= this.g && this.g < 255.5 && -.5 <= this.b && this.b < 255.5 && 0 <= this.opacity && this.opacity <= 1 }, hex: M, formatHex: M, formatRgb: R, toString: R })), e(C, H, t(r, { brighter: function (e) { return e = null == e ? i : Math.pow(i, e), new C(this.h, this.s, this.l * e, this.opacity) }, darker: function (e) { return e = null == e ? n : Math.pow(n, e), new C(this.h, this.s, this.l * e, this.opacity) }, rgb: function () { var e = this.h % 360 + 360 * (this.h < 0), t = isNaN(e) || isNaN(this.s) ? 0 : this.s, r = this.l, n = r + (r < .5 ? r : 1 - r) * t, i = 2 * r - n; return new v(j(e >= 240 ? e - 240 : e + 120, i, n), j(e, i, n), j(e < 120 ? e + 240 : e - 120, i, n), this.opacity) }, displayable: function () { return (0 <= this.s && this.s <= 1 || isNaN(this.s)) && 0 <= this.l && this.l <= 1 && 0 <= this.opacity && this.opacity <= 1 }, formatHsl: function () { var e = this.opacity; return (1 === (e = isNaN(e) ? 1 : Math.max(0, Math.min(1, e))) ? "hsl(" : "hsla(") + (this.h || 0) + ", " + 100 * (this.s || 0) + "%, " + 100 * (this.l || 0) + "%" + (1 === e ? ")" : ", " + e + ")") } })), { Color: r, darker: n, brighter: i, color: y, rgbConvert: N, rgb: x, Rgb: v, hslConvert: $, hsl: H } });
define('core/math/mathshim', ["require", "exports"], function (require, n) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.sign = n.sqrtxsqm1 = n.sqrtxsqp1 = n.log1p = n.expm1 = n.atanh = n.asinh = n.acosh = n.tanh = n.sinh = n.cosh = void 0; var t = Math; n.cosh = t.cosh || function (n) { return .5 * (Math.exp(n) + Math.exp(-n)) }, n.sinh = t.sinh && 0 !== t.sinh(1e-20) ? t.sinh : function (t) { var a = t > 0 ? 1 : -1; return t = t > 0 ? t : -t, .5 * -a * Math.exp(t) * n.expm1(-2 * t) }, n.tanh = t.tanh && 0 !== t.tanh(1e-20) ? t.tanh : function (t) { var a = t > 0 ? 1 : -1; t = t > 0 ? t : -t; var r = n.expm1(-2 * t); return -a * r / (2 + r) }, n.acosh = t.acosh || function (t) { return t < 1 ? NaN : Math.log(t + n.sqrtxsqm1(t)) }, n.asinh = t.asinh && 0 !== t.asinh(1e-20) ? t.asinh : function (t) { var a = t > 0 ? 1 : -1; return 1 + (t = t > 0 ? t : -t) * t == 1 ? a * n.log1p(t) : a * Math.log(t + n.sqrtxsqp1(t)) }, n.atanh = t.atanh && 0 !== t.atanh(1e-20) ? t.atanh : function (t) { return .5 * (n.log1p(t) - n.log1p(-t)) }, n.expm1 = t.expm1 || function (n) { return n + .5 * n * n === n ? n : Math.exp(n) - 1 }, n.log1p = t.log1p || function (n) { return n - .5 * n * n === n ? n : Math.log(1 + n) }; n.sqrtxsqp1 = function (n) { var t = n * n; return 1 + t === 1 ? 1 : 1 + t === t ? Math.abs(n) : Math.sqrt(t + 1) }; n.sqrtxsqm1 = function (n) { var t = n * n; return t < 1 ? NaN : t - 1 === t ? Math.abs(n) : Math.sqrt(t - 1) }, n.sign = t.sign || function (n) { return 0 === n ? 0 : n > 0 ? 1 : n < 0 ? -1 : NaN } });
define('core/math/poi', ["require", "exports", "core/math/distance"], function (require, i, t) { "use strict"; function r(i, r) { var n; i > r && (n = i, i = r, r = n); var e = i > 0, a = r > 0, s = Math.abs(i) > .01, f = Math.abs(r) > .01; if (s || f) return t.mean(i, r); if (0 === i) return r * Math.abs(r); if (0 === r) return i * Math.abs(i); if (e !== a) return 0; var u = e ? Math.sqrt(i * r) : -Math.sqrt(i * r); return u >= i && r >= u ? u : t.mean(i, r) } function n(i, t, n, s, f, u, o) { var c, F, v, b; if (isFinite(s)) return isFinite(t) || (c = e(i, t, n, s, o)) && (i = c[0], t = c[1]), isFinite(u) || (c = e(n, s, f, u, o)) && (f = c[0], u = c[1]), F = t === s ? [i, t] : a(i, t, n, s, o, s), v = u === s ? [f, u] : a(n, s, f, u, o, s), F && v && (b = r(F[0], v[0])), void 0 !== b ? [b, o(b)] : void 0 } function e(i, t, n, e, a) { if (isFinite(t) !== isFinite(e)) for (; ;) { var s = r(i, n), f = a(s); if (s === i || s === n) return isFinite(t) ? [i, t] : [n, e]; isFinite(f) !== isFinite(t) ? (n = s, e = f) : (i = s, t = f) } } function a(i, t, n, e, a, s) { if (t === s != (e === s)) for (; ;) { var f = r(i, n), u = a(f); if (f === i || f === n) return t === s ? [i, t] : [n, e]; u === s != (t === s) ? (n = f, e = u) : (i = f, t = u) } } function s(i, t) { var r = i[0], n = i[1], e = t[0], a = t[1]; return (e - r) * (e - r) + (a - n) * (a - n) } function f(i, t, n, e, a, f) { var u, o, c, F, v, b, M, h, m, d = f(i), l = f(t), P = f(n), p = s(d, e), C = s(l, e), O = s(P, e); if (!(t <= i || n <= t) && isFinite(p) && isFinite(C) && isFinite(O) && !(C >= p || C >= O)) for (; ;) { if (Math.abs(P[0] - d[0]) < a && Math.abs(P[1] - d[1]) < a) return [i, n]; var x = r(i, t), N = f(x), q = s(N, e), E = r(t, n), J = f(E), L = s(J, e); if (!isFinite(q) || !isFinite(L)) return; if (x === i || x === t || E === t || E === n) return q < C && q < L ? [x, x] : L < q && L < C ? [E, E] : [t, t]; if (!(q !== C && L !== C || q !== (C = s(l = f(t = .5 * (x + t)), e)) && L !== C)) return [i, n]; q < C && q < L ? (n = (u = [t, x])[0], t = u[1], P = (o = [l, N])[0], l = o[1], O = (c = [C, q])[0], C = c[1]) : L < q && L < C ? (i = (F = [t, E])[0], t = F[1], d = (v = [l, J])[0], l = v[1], p = (b = [C, L])[0], C = b[1]) : (i = (M = [x, E])[0], n = M[1], d = (h = [N, J])[0], P = h[1], p = (m = [q, L])[0], O = m[1]) } } function u(i, t, r) { return void 0 === t && (t = -1 / 0), void 0 === r && (r = 1 / 0), Math.min(r, Math.max(t, i)) } function o(i, t, r, n, e, a) { var o, c, F, v, b; void 0 !== n && void 0 !== e ? b = r + .01 * (r < .5 * (n + e) ? e - n : n - e) : b = Math.abs(r) > 1 ? 1.00001 * r : r + 1e-5; var M = i(r), h = i(b), m = s(M, t), d = s(h, t); if (isFinite(m) && isFinite(d)) { if (m === d) return [r, b]; for (d > m && (r = (o = [b, r])[0], b = o[1], M = (c = [h, M])[0], h = c[1], m = (F = [d, m])[0], d = F[1]); isFinite(r) && isFinite(b) && r !== b;) { if (void 0 !== e && b > e) return [e, e]; if (void 0 !== n && b < n) return [n, n]; var l = r + 3 * (b - r), P = s(i(l), t); if (!isFinite(P)) return [r, b]; if (P === d) return [r, b]; if (P > d) { var p = b > r ? f(r, b, l, t, a, i) : f(l, b, r, t, a, i); return p ? [u(p[0], n, e), u(p[1], n, e)] : p } r = (v = [b, d, l, P])[0], m = v[1], b = v[2], d = v[3] } return [r, b] } } function c(i, t, r, n) { return !r || !!n && Math.min(s(i(n[0]), t), s(i(n[1]), t)) < Math.min(s(i(r[0]), t), s(i(r[1]), t)) } function F(i, t, r, n, e, a, s, f) { var u = Math.abs(n - t), o = Math.abs(a - n), c = Math.abs(f - a); return u > o && u > c ? [[i, t], [r, n]] : c > o && c > u ? [[e, a], [s, f]] : [[r, n], [e, a]] } Object.defineProperty(i, "__esModule", { value: !0 }), i.bisectJump = i.findLocalClosestPointOnParametric = i.clamp = i.bisectClosestPointOnParametric = i.bisectExtremum = i.bisectFinite = i.flatCenter = i.bisectZero = i.floatMiddle = void 0, i.floatMiddle = r, i.bisectZero = function (i, t, e, a, s) { if (!isNaN(t) && !isNaN(a) && t < 0 != a < 0) for (; ;) { var f = r(i, e), u = s(f); if (!isFinite(u)) return; if (f === i || f === e) return Math.abs(t) <= Math.abs(a) ? [i, t] : [e, a]; if (0 === u) return n(i, t, f, u, e, a, s); t < 0 != u < 0 ? (e = f, a = u) : (i = f, t = u) } }, i.flatCenter = n, i.bisectFinite = e, i.bisectExtremum = function (i, t, e, a, s, f, u) { if (i < e && e < s && isFinite(t) && isFinite(a) && isFinite(f) && t !== a && a !== f && a > t == a > f) for (; ;) { var o = r(i, e), c = u(o), F = r(e, s), v = u(F); if (!isFinite(c) || !isFinite(v)) return; if (o === i || o === e || F === e || F === s) return c > a == a > t ? [o, c] : v > a == a > t ? [F, v] : [e, a]; if (c === a || v === a) return n(i, t, e, a, s, f, u); c > t == a > t && c > t == c > a ? (s = e, f = a, e = o, a = c) : v > f == a > f && v > a == v > f ? (i = e, t = a, e = F, a = v) : (i = o, t = c, s = F, f = v) } }, i.bisectClosestPointOnParametric = f, i.clamp = u, i.findLocalClosestPointOnParametric = function (i, t, r, n, e, a) { var s = o(i, t, r, n, e, a); if (void 0 !== n) { var f = o(i, t, n, n, e, a); c(i, t, s, f) && (s = f) } if (void 0 !== e) { var u = o(i, t, e, n, e, a); c(i, t, s, u) && (s = u) } return s }, i.bisectJump = function (i, n, a, s, f, u, o, c) { if (c || (c = 0), !((a - i) * (f - a) <= 0) && isFinite(i) && isFinite(a) && isFinite(f) && isFinite(n) && isFinite(u)) { if (!isFinite(s)) { var v = e(i, n, a, s, o), b = e(a, s, f, u, o); if (!v || !b) return; return [v, b] } if (!(Math.abs(s - ((f - a) * n + (a - i) * u) / (f - i)) < c)) for (; ;) { var M = r(i, a), h = o(M), m = r(a, f), d = o(m), l = Math.abs(h - t.mean(n, s)), P = Math.abs(s - t.mean(h, d)), p = Math.abs(d - t.mean(s, u)); if (l <= c && P <= c && p <= c) return; if (!isFinite(h)) { v = e(i, n, M, h, o), b = e(M, h, f, u, o); if (!v || !b) return; return [v, b] } if (!isFinite(d)) { v = e(i, n, m, d, o), b = e(m, d, f, u, o); if (!v || !b) return; return [v, b] } if (!(M !== i && M !== a || m !== a && m !== f)) return Math.abs(s - n) > Math.abs(u - s) ? [[i, n], [a, s]] : [[a, s], [f, u]]; if (M === i || M === a) return F(i, n, a, s, m, d, f, u); if (m === a || m === f) return F(i, n, M, h, a, s, f, u); l > p && l >= P ? (f = a, u = s, a = M, s = h) : p > l && p >= P ? (i = a, n = s, a = m, s = d) : (i = M, n = h, f = m, u = d) } } } });
define('core/math/quadrature', ['require', 'core/math/mathshim', 'core/math/poi'], function (require) { "use strict"; var a = require("core/math/mathshim"), r = require("core/math/poi"), t = r.bisectJump, i = r.bisectFinite, n = Math.pow(2, -13), e = n * n, o = e * e, s = e, u = [], h = []; !function (r, t) { for (var i = 32; i > 0; i--) { var n = .09856311095410075 * i, e = a.sinh(n), o = a.cosh(Math.PI / 2 * e), s = 1 / (Math.exp(Math.PI / 2 * e) * o), u = a.cosh(n) / (o * o); r.push(s), t.push(u) } }(u, h); for (var N = 0, f = 0; f < h.length; f++)N += h[f]; var m = 1 / (1 + 2 * N); function x(a, r, t) { return .5 * (r * (2 - t) + a * t) } function M(a, r, i) { var n = .5 * (r + i), e = t(r, a(r), n, a(n), i, a(i), a, 0); return e ? .5 * (e[0][0] + e[1][0]) : n } function v(a, r, t, i, n) { return { x1: a, x2: r, value: t, error: i, minerror: n } } function b(a, r, t) { var i = Math.abs(a(x(r, t, e))), n = Math.abs(a(x(r, t, 2 * e))), o = Math.abs(a(x(r, t, 4 * e))); return !(i < e || n < e) && (i > 1.95 * n && n > 1.95 * o) } function c(a, r, t) { var n, e, o = x(t, r, u[0]), N = x(r, t, u[0]), f = a(o), M = a(N), c = x(r, t, 1), l = a(c); if (isFinite(l) && !isFinite(f)) { if (n = i(o, f, c, l, a), Math.abs((n[0] - r) / (t - r)) > s) return v(r, t, NaN, NaN, NaN); r = n[0], f = n[1] } if (isFinite(l) && !isFinite(M)) { if (e = i(c, l, N, M, a), Math.abs((e[0] - t) / (t - r)) > s) return v(r, t, NaN, NaN, NaN); t = e[0], M = e[1] } if (isFinite(f) && isFinite(M) && !isFinite(l)) { if (n = i(o, f, c, l, a), e = i(c, l, N, M, a), Math.abs((e[0] - n[0]) / (t - r)) > s) return v(r, t, NaN, NaN, NaN); l = .5 * (n[1] + e[1]) } if (b(a, r, t) || b(a, t, r)) return v(r, t, NaN, NaN, NaN); for (var F = l, p = 0, d = 0, g = 0, I = 0, P = 0, q = 0, w = 0; w < 32; w += 4)P = a(x(r, t, u[w])), q = a(x(t, r, u[w])), I = Math.max(I, Math.abs(P), Math.abs(q)), p += h[w] * (P + q), P = a(x(r, t, u[w + 1])), q = a(x(t, r, u[w + 1])), I = Math.max(I, Math.abs(P), Math.abs(q)), g += h[w + 1] * (P + q), P = a(x(r, t, u[w + 2])), q = a(x(t, r, u[w + 2])), I = Math.max(I, Math.abs(P), Math.abs(q)), d += h[w + 2] * (P + q), P = a(x(r, t, u[w + 3])), q = a(x(t, r, u[w + 3])), I = Math.max(I, Math.abs(P), Math.abs(q)), g += h[w + 3] * (P + q); var J, j = F + p, k = j + d, y = k + g, z = Math.abs(d - j), A = Math.abs(g - k), B = m * (t - r) * y, C = m * Math.abs(t - r) * I * h[0]; return J = 0 === z ? m * Math.abs(t - r) * A : m * Math.abs(t - r) * A * (A / z) * (A / z), v(r, t, B, J = Math.max(J, C), C) } function l(a) { for (var r = -1 / 0, t = -1 / 0, i = -1, n = 0, e = 0; e < a.length; e++) { var o = a[e]; n += o.value, o.error > r && (r = o.error, i = e), o.minerror > t && (t = o.minerror) } return { maxerror: r, maxminerror: t, maxindex: i, totalvalue: n } } return { quad: function a(r, t, i, n) { if (void 0 === n && (n = 32), isNaN(t) || isNaN(i)) return NaN; var e = 1; if (t > i) { var s = t; t = i, i = s, e = -1 } if (t === 1 / 0 && i === 1 / 0) return NaN; if (t === -1 / 0 && i === -1 / 0) return NaN; if (t === -1 / 0 && i === 1 / 0) return e * a(function (a) { return r(a / ((1 + a) * (1 - a))) * (1 + a * a) / ((1 + a) * (1 + a) * (1 - a) * (1 - a)) }, -1, 1, n); if (t === -1 / 0) return e * a(function (a) { return -r(i - a / (1 - a)) / ((1 - a) * (1 - a)) }, 1, 0, n); if (i === 1 / 0) return e * a(function (a) { return r(t + a / (1 - a)) / ((1 - a) * (1 - a)) }, 0, 1, n); for (var u = [c(r, t, i)], h = l(u), N = 1; N < n && (!(Math.abs(h.maxerror / h.totalvalue) <= 32 * o || h.maxerror <= 32 * o || h.maxerror <= 32 * h.maxminerror) && isFinite(h.maxerror) && isFinite(h.maxminerror)); N++) { var f = u[u.length - 1]; u[u.length - 1] = u[h.maxindex], u[h.maxindex] = f; var m = u.pop(), v = M(r, x(m.x2, m.x1, .125), x(m.x1, m.x2, .125)); u.push(c(r, m.x1, v)), u.push(c(r, v, m.x2)), h = l(u) } return isFinite(h.maxerror) && isFinite(h.maxminerror) ? Math.abs(h.totalvalue) <= 10 * h.maxminerror ? 0 : e * h.totalvalue : NaN } } });
define('core/lib/md5', ["require", "exports"], function (require, n) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.default = function (n) { function r(n, r) { var t = (65535 & n) + (65535 & r); return (n >> 16) + (r >> 16) + (t >> 16) << 16 | 65535 & t } function t(n, t, e, u, o, c) { return r((f = r(r(t, n), r(u, c))) << (i = o) | f >>> 32 - i, e); var f, i } function e(n, r, e, u, o, c, f) { return t(r & e | ~r & u, n, r, o, c, f) } function u(n, r, e, u, o, c, f) { return t(r & u | e & ~u, n, r, o, c, f) } function o(n, r, e, u, o, c, f) { return t(r ^ e ^ u, n, r, o, c, f) } function c(n, r, e, u, o, c, f) { return t(e ^ (r | ~u), n, r, o, c, f) } function f(n, t) { var f, i, a, h, l; n[t >> 5] |= 128 << t % 32, n[14 + (t + 64 >>> 9 << 4)] = t; var v = 1732584193, d = -271733879, g = -1732584194, s = 271733878; for (f = 0; f < n.length; f += 16)i = v, a = d, h = g, l = s, v = e(v, d, g, s, n[f], 7, -680876936), s = e(s, v, d, g, n[f + 1], 12, -389564586), g = e(g, s, v, d, n[f + 2], 17, 606105819), d = e(d, g, s, v, n[f + 3], 22, -1044525330), v = e(v, d, g, s, n[f + 4], 7, -176418897), s = e(s, v, d, g, n[f + 5], 12, 1200080426), g = e(g, s, v, d, n[f + 6], 17, -1473231341), d = e(d, g, s, v, n[f + 7], 22, -45705983), v = e(v, d, g, s, n[f + 8], 7, 1770035416), s = e(s, v, d, g, n[f + 9], 12, -1958414417), g = e(g, s, v, d, n[f + 10], 17, -42063), d = e(d, g, s, v, n[f + 11], 22, -1990404162), v = e(v, d, g, s, n[f + 12], 7, 1804603682), s = e(s, v, d, g, n[f + 13], 12, -40341101), g = e(g, s, v, d, n[f + 14], 17, -1502002290), v = u(v, d = e(d, g, s, v, n[f + 15], 22, 1236535329), g, s, n[f + 1], 5, -165796510), s = u(s, v, d, g, n[f + 6], 9, -1069501632), g = u(g, s, v, d, n[f + 11], 14, 643717713), d = u(d, g, s, v, n[f], 20, -373897302), v = u(v, d, g, s, n[f + 5], 5, -701558691), s = u(s, v, d, g, n[f + 10], 9, 38016083), g = u(g, s, v, d, n[f + 15], 14, -660478335), d = u(d, g, s, v, n[f + 4], 20, -405537848), v = u(v, d, g, s, n[f + 9], 5, 568446438), s = u(s, v, d, g, n[f + 14], 9, -1019803690), g = u(g, s, v, d, n[f + 3], 14, -187363961), d = u(d, g, s, v, n[f + 8], 20, 1163531501), v = u(v, d, g, s, n[f + 13], 5, -1444681467), s = u(s, v, d, g, n[f + 2], 9, -51403784), g = u(g, s, v, d, n[f + 7], 14, 1735328473), v = o(v, d = u(d, g, s, v, n[f + 12], 20, -1926607734), g, s, n[f + 5], 4, -378558), s = o(s, v, d, g, n[f + 8], 11, -2022574463), g = o(g, s, v, d, n[f + 11], 16, 1839030562), d = o(d, g, s, v, n[f + 14], 23, -35309556), v = o(v, d, g, s, n[f + 1], 4, -1530992060), s = o(s, v, d, g, n[f + 4], 11, 1272893353), g = o(g, s, v, d, n[f + 7], 16, -155497632), d = o(d, g, s, v, n[f + 10], 23, -1094730640), v = o(v, d, g, s, n[f + 13], 4, 681279174), s = o(s, v, d, g, n[f], 11, -358537222), g = o(g, s, v, d, n[f + 3], 16, -722521979), d = o(d, g, s, v, n[f + 6], 23, 76029189), v = o(v, d, g, s, n[f + 9], 4, -640364487), s = o(s, v, d, g, n[f + 12], 11, -421815835), g = o(g, s, v, d, n[f + 15], 16, 530742520), v = c(v, d = o(d, g, s, v, n[f + 2], 23, -995338651), g, s, n[f], 6, -198630844), s = c(s, v, d, g, n[f + 7], 10, 1126891415), g = c(g, s, v, d, n[f + 14], 15, -1416354905), d = c(d, g, s, v, n[f + 5], 21, -57434055), v = c(v, d, g, s, n[f + 12], 6, 1700485571), s = c(s, v, d, g, n[f + 3], 10, -1894986606), g = c(g, s, v, d, n[f + 10], 15, -1051523), d = c(d, g, s, v, n[f + 1], 21, -2054922799), v = c(v, d, g, s, n[f + 8], 6, 1873313359), s = c(s, v, d, g, n[f + 15], 10, -30611744), g = c(g, s, v, d, n[f + 6], 15, -1560198380), d = c(d, g, s, v, n[f + 13], 21, 1309151649), v = c(v, d, g, s, n[f + 4], 6, -145523070), s = c(s, v, d, g, n[f + 11], 10, -1120210379), g = c(g, s, v, d, n[f + 2], 15, 718787259), d = c(d, g, s, v, n[f + 9], 21, -343485551), v = r(v, i), d = r(d, a), g = r(g, h), s = r(s, l); return [v, d, g, s] } function i(n) { var r, t = "", e = 32 * n.length; for (r = 0; r < e; r += 8)t += String.fromCharCode(n[r >> 5] >>> r % 32 & 255); return t } function a(n) { var r, t = []; for (t[(n.length >> 2) - 1] = void 0, r = 0; r < t.length; r += 1)t[r] = 0; var e = 8 * n.length; for (r = 0; r < e; r += 8)t[r >> 5] |= (255 & n.charCodeAt(r / 8)) << r % 32; return t } function h(n) { var r, t, e = "0123456789abcdef", u = ""; for (t = 0; t < n.length; t += 1)r = n.charCodeAt(t), u += e.charAt(r >>> 4 & 15) + e.charAt(15 & r); return u } function l(n) { return unescape(encodeURIComponent(n)) } function v(n) { return function (n) { return i(f(a(n), 8 * n.length)) }(l(n)) } function d(n, r) { return function (n, r) { var t, e, u = a(n), o = [], c = []; for (o[15] = c[15] = void 0, u.length > 16 && (u = f(u, 8 * n.length)), t = 0; t < 16; t += 1)o[t] = 909522486 ^ u[t], c[t] = 1549556828 ^ u[t]; return e = f(o.concat(a(r)), 512 + 8 * r.length), i(f(c.concat(e), 640)) }(l(n), l(r)) } return function (n, r, t) { return r ? t ? d(r, n) : h(d(r, n)) : t ? v(n) : h(v(n)) } }() });
define('core/math/builtin', ["require", "exports", "core/vendor/d3-color", "core/math/quadrature", "core/lib/md5", "core/math/mathshim", "core/math/mathshim", "core/math/distance", "core/math/distance", "core/math/tofraction", "core/math/poi", "./maybe-rational", "./builtin-common"], function (require, t, r, n, e, a, u, o, i, f, h, c, s) { "use strict"; function l(t, r, n) { return Math.max(r, Math.min(n, t)) } function M(r, n) { r = Math.round(r), n = Math.round(n); var e = t.gcd(r, n); return Math.abs(r / e * n) } function v(t) { return p(t + 1) } function p(t) { if (t < 0) return Math.PI / (P(Math.PI * t) * p(1 - t)); if (t > 170) return 1 / 0; var r, n = Math.round(t) === t; return r = t < 15 ? g(t) : t < 120 ? function (t) { var r = t - 1; return Math.pow(r, r) * Math.exp(T(r) - r) * Math.sqrt(2 * Math.PI * r) }(t) : Math.exp(d(t)), n ? Math.round(r) : r } function g(t) { var r = 1 + t * (4.077131788261185 + t * (7.024675027156382 + t * (6.657107767450176 + t * (3.766266976716022 + t * (1.2792371666711133 + t * (.24304596436338005 + .020049769312165774 * t)))))), n = 1 + t * (4.154347453162709 + t * (7.270007565107539 + t * (6.97805297331391 + t * (3.989651532924167 + t * (1.367176195613119 + t * (.26175627691546965 + .021742722739397567 * t)))))); return Math.E * Math.pow((1 + t) / Math.E, 1 + t) / (t * Math.sqrt(1 + t)) * (r / n) } function d(t) { var r = t - 1; return r * (Math.log(r) - 1) + .5 * Math.log(2 * Math.PI * r) + T(r) } function m(t, r) { if (t !== Math.floor(t)) return NaN; if (t < 0) return NaN; if (0 === t) return 1 / I(r); var n = P(r); if (1 === t) return -1 / (n * n); var e = w(r); if (2 === t) return 2 * e / (n * n * n); for (var a = [0, 2], u = [], o = 3; o <= t; o++) { u = []; for (var i = 0; i < o; i++) { var f = 0, h = 0; i > 0 && (f = (o - i + 1) * a[i - 1]), i + 2 < o && (h = (i + 1) * a[i + 1]), u.push(-(f + h)) } a = u } var c = 0; for (i = t - 1; i >= 0; i--)c = u[i] + e * c; return c / Math.pow(n, t + 1) } function N(t, r) { return 0 === r ? NaN : (n = r === Math.E ? Math.log(t) : 2 === r && Math.log2 ? Math.log2(t) : 10 === r && Math.log10 ? Math.log10(t) : Math.log(t) / Math.log(r), Math.pow(r, Math.round(n)) === t ? Math.round(n) : n); var n } Object.defineProperty(t, "__esModule", { value: !0 }), t.uniquePerm = t.elementsAt = t.select = t.polygon = t.hsv = t.rgb = t.distance = t.quad = t.stdevp = t.stdev = t.spearman = t.rank = t.validateSampleCount = t.validateRangeLength = t.corr = t.cov = t.covp = t.variance = t.mad = t.varp = t.argMax = t.argMin = t.median = t.lowerQuartileIndex = t.upperQuartileIndex = t.lowerQuantileIndex = t.upperQuantileIndex = t.quartileIndex = t.sortPerm = t.quartile = t.quantile = t.listMax = t.listMin = t.length = t.stats = t.ittest = t.ttest = t.itscore = t.tscore = t.invUniform = t.invT = t.invBinom = t.invPoisson = t.invNorm = t.erfcx = t.erf = t.uniformcdf = t.uniformpdf = t.poissoncdf = t.poissonpdf = t.binompdf = t.binomcdf = t.poissonSample = t.binomSample = t.tSample = t.normalSample = t.uniformSample = t.randomPerm = t.shuffle = t.random = t.normalpdf = t.normalcdf = t.tcdf = t.tpdf = t.total = t.mean = t.acoth = t.acsch = t.asech = t.coth = t.csch = t.sech = t.asec = t.acsc = t.acot = t.cot = t.csc = t.sec = t.tan = t.cos = t.sin = t.nthroot = t.common_log = t.log_base = t.log = t.polyGamma = t.cotDerivative = t.bernoulliTable = t.lnGamma = t.gamma = t.factorial = t.nPr = t.nCr = t.listLCM = t.listGCD = t.lcm = t.mod = t.pow = t.gcd = t.toFraction = t.hypot = t.sign = t.sqrtxsqm1 = t.sqrtxsqp1 = t.log1p = t.expm1 = t.atanh = t.asinh = t.acosh = t.tanh = t.sinh = t.cosh = t.md5Spyable = void 0, t.md5Spyable = e.default, Object.defineProperty(t, "cosh", { enumerable: !0, get: function () { return u.cosh } }), Object.defineProperty(t, "sinh", { enumerable: !0, get: function () { return u.sinh } }), Object.defineProperty(t, "tanh", { enumerable: !0, get: function () { return u.tanh } }), Object.defineProperty(t, "acosh", { enumerable: !0, get: function () { return u.acosh } }), Object.defineProperty(t, "asinh", { enumerable: !0, get: function () { return u.asinh } }), Object.defineProperty(t, "atanh", { enumerable: !0, get: function () { return u.atanh } }), Object.defineProperty(t, "expm1", { enumerable: !0, get: function () { return u.expm1 } }), Object.defineProperty(t, "log1p", { enumerable: !0, get: function () { return u.log1p } }), Object.defineProperty(t, "sqrtxsqp1", { enumerable: !0, get: function () { return u.sqrtxsqp1 } }), Object.defineProperty(t, "sqrtxsqm1", { enumerable: !0, get: function () { return u.sqrtxsqm1 } }), Object.defineProperty(t, "sign", { enumerable: !0, get: function () { return u.sign } }), Object.defineProperty(t, "hypot", { enumerable: !0, get: function () { return i.hypot } }), t.toFraction = f.default, t.gcd = s.gcd, t.pow = s.pow, t.mod = function (t, r) { var n = t % r; return t * r < 0 && 0 !== n ? n + r : n }, t.lcm = M, t.listGCD = function (r) { if (0 === r.length) return NaN; for (var n = r[0], e = 1; e < r.length; e++)n = t.gcd(n, r[e]); return n }, t.listLCM = function (t) { if (0 === t.length) return NaN; for (var r = t[0], n = 1; n < t.length; n++)r = M(r, t[n]); return r }, t.nCr = function (t, r) { if (t = Math.round(t), (r = Math.round(r)) > t || t < 0 || r < 0) return 0; if (r === 1 / 0 || t === 1 / 0) return NaN; r > t - r && (r = t - r); for (var n = 1, e = 0; e < r; e++)n *= (t - e) / (e + 1); return Math.round(n) }, t.nPr = function (t, r) { if (t = Math.round(t), (r = Math.round(r)) > t || t < 0 || r < 0) return 0; if (r === 1 / 0 || t === 1 / 0) return NaN; for (var n = 1, e = 0; e < r; e++)n *= t - e; return n }, t.factorial = v, t.gamma = p, t.lnGamma = function (t) { return t < 0 ? NaN : t < 15 ? Math.log(g(t)) : d(t) }, t.bernoulliTable = [1 / 6, -1 / 30, 1 / 42, -1 / 30, 5 / 66, -691 / 2730, 7 / 6, -3617 / 510, 43867 / 798, -174611 / 330, 854513 / 138, -236364091 / 2730, 8553103 / 6, -23749461029 / 870], t.cotDerivative = m, t.polyGamma = function r(n, e) { if (n < 0) return NaN; if (n !== Math.floor(n)) return NaN; var a = n % 2 == 0 ? -1 : 1; if (e < 0) return -a * r(n, 1 - e) - Math.pow(Math.PI, n + 1) * m(n, Math.PI * e); for (var u = v(n), o = 0, i = Math.pow(e, -(n + 1)); e < 10;)o += i, e++, i = Math.pow(e, -(n + 1)); o += 0 === n ? -Math.log(e) : i * e / n, o += .5 * i; for (var f = t.bernoulliTable, h = n + 1, c = 2, s = i * e * h / c, l = 1 / (e * e), M = 1; M <= 14; M++)o += (s *= l) * f[M - 1], s *= ++h / ++c, s *= ++h / ++c; return u * a * o }, t.log = function (t) { var r = Math.log(t); return Math.exp(Math.round(r)) === t ? Math.round(r) : r }, t.log_base = N, t.common_log = function (t) { return N(t, 10) }, t.nthroot = function (r, n) { return t.pow(r, 1 / n) }; var b = 1 / Math.PI; function q(t) { return !(t > 1e12) && Math.round(b * t) * Math.PI === t } function x(t) { if (t > 1e12) return !1; var r = Math.round(2 * b * t); return r % 2 == 1 && r * Math.PI == 2 * t } function P(t) { return q(Math.abs(t)) ? 0 : Math.sin(t) } function w(t) { return x(Math.abs(t)) ? 0 : Math.cos(t) } function I(t) { var r = Math.abs(t); return q(r) ? 0 : x(r) ? 1 / 0 : Math.tan(t) } function y(t) { for (var r = 0, n = 0; n < t.length; n++)r += t[n]; return r / t.length } function S(t) { return t > 50 ? Math.exp(.5 * ((1 - t) * a.log1p(-1 / (t - 1)) - 1) + O(.5 * (t - 1)) - O(.5 * (t - 2))) * Math.sqrt((1 - 1 / t) / (2 * Math.PI)) : p((t + 1) / 2) / (p(t / 2) * Math.sqrt(t * Math.PI)) } function j(t, r, n) { if (void 0 === n && (n = t - r), Math.abs(n) < .1 * (t + r)) for (var e = n / (t + r), a = n * n / (t + r), u = 2 * t * e, o = 1; o < 10; o++) { var i = a + (u *= e * e) / (2 * o + 1); if (i == a) return i; a = i } return t * Math.log(t / r) + r - t } t.sin = P, t.cos = w, t.tan = I, t.sec = function (t) { return x(Math.abs(t)) ? 1 / 0 : 1 / Math.cos(t) }, t.csc = function (t) { return q(Math.abs(t)) ? 1 / 0 : 1 / Math.sin(t) }, t.cot = function (t) { var r = Math.abs(t); return q(r) ? 1 / 0 : x(r) ? 0 : 1 / Math.tan(t) }, t.acot = function (t) { return Math.PI / 2 - Math.atan(t) }, t.acsc = function (t) { return Math.asin(1 / t) }, t.asec = function (t) { return Math.acos(1 / t) }, t.sech = function (t) { return 1 / a.cosh(t) }, t.csch = function (t) { return 1 / a.sinh(t) }, t.coth = function (t) { return 1 / a.tanh(t) }, t.asech = function (t) { return a.acosh(1 / t) }, t.acsch = function (t) { return a.asinh(1 / t) }, t.acoth = function (t) { return a.atanh(1 / t) }, t.mean = y, t.total = function (t) { for (var r = 0, n = 0; n < t.length; n++)r += t[n]; return r }; var F = [0, .08106146679532726, .0413406959554093, .02767792568499834, .020790672103765093, .016644691189821193, .013876128823070748, .01189670994589177, .010411265261972096, .009255462182712733, .00833056343336287, .007573675487951841, .00694284010720953, .006408994188004207, .0059513701127588475, .005554733551962801]; function O(t) { return t > 15 ? T(t) : t < 0 ? NaN : t === Math.floor(t) ? F[t] : Math.log(v(t) / (Math.pow(t, t) * Math.exp(-t) * Math.sqrt(2 * Math.PI * t))) } function T(t) { var r = t * t; return (.08333333333333333 - (.002777777777777778 - (.0007936507936507937 - (.0005952380952380953 - .0008417508417508417 / r) / r) / r) / r) / t } function Q(t, r) { return r <= 0 ? NaN : S(r) * Math.pow(1 + t * t / r, -(r + 1) / 2) } function C(t, r) { if (r > 0) return 1 - C(t, -r); if (r === -1 / 0) return 0; if (0 === r) return .5; if (t >= 40 && r > -1) return .5 + S(t) * function (t, r) { for (var n = r * r / t, e = r, a = e, u = 1; u <= 15; u++)a += e *= -(2 * u - 1) / (2 * u + 1) * (.5 * (t + 1) + u - 1) / u * n; return a }(t, r); if (r / t < -1e3) { var n = r * r; return S(t) * Math.pow(t, .5 * (t - 1)) * Math.pow(Math.abs(r), -t) * (1 - t * t * (t + 1) * (1 / (2 + t) + t * (t + 3) / (4 * (4 + t) * n)) / (2 * n)) } var e = Math.sqrt(r * r + t); return function (t, r, n) { if (t < 0 || t > 1) throw new RangeError("First argument must be between 0 and 1."); if (1 === r && 1 === n) return t; if (0 === t) return 0; if (1 === t) return 1; if (0 === r) return 1; if (0 === n) return 0; var e = O(r + n) - O(r) - O(n) - j(r, (r + n) * t) - j(n, (r + n) * (1 - t), (r + n) * t - r), a = Math.exp(e) * Math.sqrt(r * n / (2 * Math.PI * (r + n))); return t < (r + 1) / (r + n + 2) ? a * R(t, r, n) / r : 1 - a * R(1 - t, n, r) / n }((r + e) / (2 * e), t / 2, t / 2) } function E(t, r, n) { return n <= 0 ? NaN : t === -1 / 0 ? C(n, r) : t > 0 && r > 0 ? C(n, -t) - C(n, -r) : C(n, r) - C(n, t) } function R(t, r, n) { var e = Math.pow(2, -52), a = 1e-300, u = r + n, o = r + 1, i = r - 1, f = 1, h = 1 - u * t / o; Math.abs(h) < a && (h = a); for (var c = h = 1 / h, s = 1; s <= 100; s++) { var l = 2 * s, M = s * (n - s) * t / ((i + l) * (r + l)); h = 1 + M * h, Math.abs(h) < a && (h = a), f = 1 + M / f, Math.abs(f) < a && (f = a), c *= (h = 1 / h) * f, h = 1 + (M = -(r + s) * (u + s) * t / ((r + l) * (o + l))) * h, Math.abs(h) < a && (h = a), f = 1 + M / f, Math.abs(f) < a && (f = a); var v = (h = 1 / h) * f; if (c *= v, Math.abs(v - 1) <= e) return c } return c } function _(t, r, n) { return (t - r) / (Math.SQRT2 * Math.abs(n)) } function G(t) { return t < 0 ? .5 * Math.exp(-t * t) * K(-t) : 1 - .5 * Math.exp(-t * t) * K(t) } function A(r) { var n = t.md5Spyable(r); return (4294967296 * (2097151 & parseInt(n.slice(0, 8), 16)) + parseInt(n.slice(8, 16), 16)) / 9007199254740992 } function D(t, r) { for (var n = r.length - 1; n > 0; n--) { var e = t + "::sc" + n, a = Math.floor(A(e) * (n + 1)), u = r[n]; r[n] = r[a], r[a] = u } } function L(t, r, n) { return A(t) * (n - r) + r } function k(t, r, n) { return t >= r ? 1 : t < 0 ? 0 : t < Math.floor((r + 1) * n) ? B(t, r, n) : 1 - B(r - t - 1, r, 1 - n) } function B(t, r, n) { for (var e = (1 - n) / n, a = U(t, r, n), u = a; t > 0 && u + (a *= t / (r - t + 1) * e) !== u; t--)u += a; return u } function U(t, r, n) { if (t = Math.round(t), (r = l(Math.round(r), 0, 1 / 0)) === 1 / 0) return NaN; if (n = l(n, 0, 1), t < 0 || t > r) return 0; if (0 === n) return 0 === t ? 1 : 0; if (1 === n) return t === r ? 1 : 0; if (0 === t) return Math.exp(r * a.log1p(-n)); if (t === r) return Math.pow(n, r); var e = O(r) - O(t) - O(r - t) - j(t, r * n) - j(r - t, r * (1 - n), r * n - t); return Math.exp(e) * Math.sqrt(r / (2 * Math.PI * t * (r - t))) } function z(t, r) { return r < 0 ? NaN : (t = Math.round(t)) < 0 ? 0 : 0 === r ? 0 === t ? 1 : 0 : 0 === t ? Math.exp(-r) : Math.exp(-O(t) - j(t, r)) / Math.sqrt(2 * Math.PI * t) } function H(t, r) { if (isNaN(t) || isNaN(r)) return NaN; if (t === 1 / 0) return 1; if ((t = Math.floor(t)) < 0) return 0; if (0 === r) return 1; if (t + 1 > 12 && 2.35 * (t + 1) > r && .3 * (t + 1) < r) return function (t, r) { for (var n = r / t, e = a.sign(r - t) * Math.sqrt(2 * j(1, n)), u = [1, -.3333333333333333, .08333333333333333, -.014814814814814815, .0011574074074074073, .0003527336860670194, -.0001787551440329218, 3919263178522438e-20, -2185448510679992e-21, -185406221071516e-20, 8.296711340953087e-7, -1.7665952736826078e-7, 6.707853543401498e-9, 1.0261809784240309e-8, -4.382036018453353e-9, 9.14769958223679e-10, -25514193994946248e-27, -5830772132550426e-26, 24361948020667415e-27, -50276692801141755e-28, 11004392031956135e-29, 3371763262400985e-28, -1392388722418162e-28, 28534893807047445e-30, -5139111834242572e-31, -19752288294349442e-31, 8099521156704561e-31], o = u.length - 2, i = 0, f = 0, h = 0, c = 0; o >= 0; o--)c = e * c + (h = (o + 2) * i / t + u[o + 1]), i = f, f = h; if (c *= t / (t + i), r < t) { var s = Math.exp(-.5 * t * e * e) * (.5 * K(-e * Math.sqrt(t / 2)) - c / Math.sqrt(2 * Math.PI * t)); return isFinite(s) ? 1 - s : 1 } var l = Math.exp(-.5 * t * e * e) * (.5 * K(e * Math.sqrt(t / 2)) + c / Math.sqrt(2 * Math.PI * t)); return isFinite(l) ? l : 0 }(t + 1, r); if (t + 1 >= r) { var n = function (t, r) { var n = Math.pow(2, -52), e = 1e-300, a = 1 / t, u = 1 / e, o = 1 / t, i = 2, f = 0, h = t, c = -(t - 1), s = 0; do { 0 === (o = o * (c -= 1) * r + (h += 1)) && (o = e), 0 === (u = h + c * r / u) && (u = e), a *= f = u * (o = 1 / o), 0 === (o = o * (s += 1) * r + (h += 1)) && (o = e), 0 === (u = h + s * r / u) && (u = e), a *= f = u * (o = 1 / o), i += 2 } while (i < 100 && Math.abs(f - 1) > n); return a }(t + 1, r); return isFinite(n) ? 1 - r * z(t, r) * n : 1 } n = function (t, r) { var n = Math.pow(2, -52), e = 1e-300, a = r + 1 - t, u = 1 / a, o = 1 / e, i = 1 / a, f = 2, h = 0, c = a; do { var s = -(f - 1) * (f - t - 1); 0 === (i = i * s + (c += 2)) && (i = e), 0 === (o = c + s / o) && (o = e), u *= h = o * (i = 1 / i), f += 1 } while (f < 100 && Math.abs(h - 1) > n); return u }(t + 1, r); return isFinite(n) ? r * z(t, r) * n : 0 } function J(t, r, n) { return n <= r ? NaN : t < r ? 0 : t > n ? 1 : (t - r) / (n - r) } function K(t) { if (t < 0) return t < -6.1 ? 2 * Math.exp(t * t) : 2 * Math.exp(t * t) - K(-t); if (t > 50) { var r = .5641895835477563, n = t * t; return t > 5e7 ? r / t : r * (n * (n + 4.5) + 2) / (t * (n * (n + 5) + 3.75)) } return (.9999999999999999 + t * (2.224574423459406 + t * (2.444115549920689 + t * (1.7057986861852539 + t * (.8257463703357973 + t * (.28647031042892007 + t * (.07124513844341643 + t * (.012296749268608364 + t * (.001347817214557592 + 7263959403471071e-20 * t))))))))) / (1 + t * (3.352953590554884 + t * (5.227518529742423 + t * (5.003720878235473 + t * (3.266590890998987 + t * (1.5255421920765353 + t * (.5185887413188858 + t * (.12747319185915415 + t * (.02185979575963238 + t * (.0023889438122503674 + .00012875032817508128 * t)))))))))) } function V(t) { var r, n, e; return t > .5 ? -V(1 - t) : .5 === t ? 0 : t < 0 ? NaN : 0 === t ? -1 / 0 : (e = t < .02425 ? (((((-.00778489400243029 * (r = Math.sqrt(-2 * Math.log(t))) - .322396458041136) * r - 2.40075827716184) * r - 2.54973253934373) * r + 4.37466414146497) * r + 2.93816398269878) / ((((.00778469570904146 * r + .32246712907004) * r + 2.445134137143) * r + 3.75440866190742) * r + 1) : (((((-39.6968302866538 * (n = (r = t - .5) * r) + 220.946098424521) * n - 275.928510446969) * n + 138.357751867269) * n - 30.6647980661472) * n + 2.50662827745924) * r / (((((-54.4760987982241 * n + 161.585836858041) * n - 155.698979859887) * n + 66.8013118877197) * n - 13.2806815528857) * n + 1)) - Math.sqrt(2 * Math.PI) * (.5 * K(-e / Math.SQRT2) - Math.exp(.5 * e * e) * t) } function W(t, r) { if (r <= 0 || t < 0 || t > 1) return NaN; if (0 === t) return 0; if (1 === t) return 1 / 0; for (var n = 1, e = 1, a = 1; Math.exp(-r) * e < t;) { if (e + (n *= r / a) === e) return 1 / 0; e += n, a += 1 } return a - 1 } function X(t, r, n) { if (r !== Math.round(r)) return NaN; if (n < 0 || n > 1) return NaN; if (t < 0 || t > 1) return NaN; if (0 === t) return 0; if (1 === t) return r; if (0 === r) return 0; if (1 === n) return r; if (0 === n) return 0; for (var e = n / (1 - n), a = Math.pow(1 - n, r), u = a, o = 1; u < t;) { if (u + (a *= (r - o + 1) / o * e) === u) return r; if (o > r) return r; u += a, o += 1 } return o - 1 } function Y(t, r) { var n = 4 * r * (1 - r); switch (t) { case 1: return Math.tan(Math.PI * (r - .5)); case 2: return 2 * (r - .5) * Math.sqrt(2 / n); case 4: var e = Math.cos(Math.acos(Math.sqrt(n)) / 3) / Math.sqrt(n); return 2 * a.sign(r - .5) * Math.sqrt(e - 1); default: throw new Error("_invTSimple() must be called with 1, 2, or 4 df.") } } function Z(t, r) { var n = Mt(t); return (y(t) - r) * Math.sqrt(t.length) / n } function $(t, r) { var n = t.length, e = y(t), a = Mt(t), u = r.length, o = y(r), i = Mt(r); return (e - o) / (Math.sqrt(((n - 1) * a * a + (u - 1) * i * i) / (n + u - 2)) * Math.sqrt(1 / n + 1 / u)) } function tt(t, r, n) { return n < 0 ? E(-1 / 0, t, r) : n > 0 ? E(-1 / 0, -t, r) : 2 * E(-1 / 0, -Math.abs(t), r) } function rt(t) { if (t.length < 1) return NaN; var r = t[0]; if (isNaN(r)) return NaN; for (var n = 1; n < t.length; n++) { if (isNaN(t[n])) return NaN; t[n] < r && (r = t[n]) } return r } function nt(t) { if (t.length < 1) return NaN; var r = t[0]; if (isNaN(r)) return NaN; for (var n = 1; n < t.length; n++) { if (isNaN(t[n])) return NaN; t[n] >= r && (r = t[n]) } return r } function et(t, r) { if (!isFinite(r) || r < 0 || r > 1) return NaN; if (t.some(isNaN)) return NaN; if (0 === t.length) return NaN; var n = t.length, e = ut(t), a = r * (n - 1); return Math.floor(a) === a ? t[e[a]] : (Math.ceil(a) - a) * t[e[Math.floor(a)]] + (a - Math.floor(a)) * t[e[Math.ceil(a)]] } function at(t, r) { if (!isFinite(r) || r < 0 || r > 4) return NaN; if (t.some(isNaN)) return NaN; var n = ut(t), e = ot(t, r), a = Math.floor(e), u = Math.ceil(e); return (t[n[a]] + t[n[u]]) / 2 } function ut(t) { for (var r = t.length, n = [], e = 0; e < r; e++)n.push(e); return n.sort(function (r, n) { return c.asFloat(c.sub(t[r], t[n])) }), n } function ot(t, r) { r = Math.round(r); var n, e = t.length, a = e % 2 == 1; return 1 === e ? 0 : (0 === r && (n = 0), 2 === r && (n = (e - 1) / 2), 4 === r && (n = e - 1), 1 === r && (n = a ? (e + 1) / 4 - 1 : (e + 2) / 4 - 1), 3 === r && (n = a ? (3 * e + 3) / 4 - 1 : (3 * e + 2) / 4 - 1), void 0 === n ? NaN : n) } function it(t) { return et(t, .5) } function ft(t) { for (var r = y(t), n = 0, e = 0; e < t.length; e++) { var a = t[e] - r; n += a * a } return n / t.length } function ht(t) { var r = t.length; return ft(t) * r / (r - 1) } function ct(t, r) { var n = Math.min(t.length, r.length); t.length !== n && (t = t.slice(0, n)), r.length !== n && (r = r.slice(0, n)); for (var e = y(t), a = y(r), u = 0, o = 0; o < n; o++)u += (t[o] - e) * (r[o] - a); return u / n } function st(t, r) { var n = Math.min(t.length, r.length); t.length !== n && (t = t.slice(0, n)), r.length !== n && (r = r.slice(0, n)); for (var e = y(t), a = y(r), u = 0, o = 0, i = 0, f = 0; f < n; f++) { var h = t[f] - e, c = r[f] - a; u += h * h, o += c * c, i += h * c } return i / Math.sqrt(u * o) } function lt(t) { var r = t.length; if (0 === r) return []; for (var n = [], e = [], a = 0; a < r; a++)e.push([t[a], a]); e.sort(function (t, r) { var n = t[0], e = r[0]; return n === 1 / 0 && e === 1 / 0 || n === -1 / 0 && e === -1 / 0 ? 0 : n - e }); for (var u = 0, o = 1, i = 1; u < r;) { for (var f = u; f < r - 1 && e[f][0] === e[f + 1][0];)f += 1; i = f - u + 1; var h = void 0; for (f = 0; f < i; f++)n[h = e[u + f][1]] = isNaN(t[h]) ? NaN : o + .5 * (i - 1); o += i, u += i } return n } function Mt(t) { return Math.sqrt(ht(t)) } function vt(t, r, n) { return [l(Math.round(t), 0, 255), l(Math.round(r), 0, 255), l(Math.round(n), 0, 255)] } function pt(t) { if (Array.isArray(t)) return "[" + t.map(pt).join(",") + "]"; switch (typeof t) { case "string": return t; case "boolean": case "number": return t.toString(); case "object": if ("object" == typeof (e = t) && e && "Action" === e.type) { var r = []; for (var n in t.updateRules) r.push('"' + n + '": ' + pt(t.updateRules[n].value)); return "{" + r.join(",") + "}" } return t.n + "/" + t.d; default: return t }var e } t.tpdf = Q, t.tcdf = E, t.normalcdf = function (t, r, n, e) { var a = _(r, n, e); if (t === -1 / 0) return G(a); var u = _(t, n, e); return t > 0 && r > 0 ? G(-u) - G(-a) : G(a) - G(u) }, t.normalpdf = function (t, r, n) { return 1 / Math.sqrt(2 * Math.PI * n * n) * Math.exp(-(t - r) * (t - r) / (2 * n * n)) }, t.random = A, t.shuffle = function (t, r) { var n = r.slice(); return D(t, n), n }, t.randomPerm = function (t, r) { for (var n = [], e = 0; e < r; e++)n.push(e); return D(t, n), n }, t.uniformSample = L, t.normalSample = function (t, r, n) { var e, a, u, o, i = 0; do { e = t + "::sc" + i, i += 1, a = 2 * L(e, 0, 1) - 1, e = t + "::sc" + i, i += 1, o = a * a + (u = 2 * L(e, 0, 1) - 1) * u } while (o >= 1 || 0 === o); return r + n * a * Math.sqrt(-2 * Math.log(o) / o) }, t.tSample = function (t, r) { if (r <= 0) return NaN; var n, e, a, u, o = 0; do { n = t + "::sc" + o, o += 1, e = 2 * L(n, 0, 1) - 1, n = t + "::sc" + o, o += 1, u = e * e + (a = 2 * L(n, 0, 1) - 1) * a } while (u > 1); var i = e * e / u, f = r * (Math.pow(u, -2 / r) - 1); return n = t + "::sc" + o, o += 1, (L(n, 0, 1) < .5 ? -1 : 1) * Math.sqrt(i * f) }, t.binomSample = function (t, r, n) { return (r = l(Math.round(r), 0, 1 / 0)) === 1 / 0 ? NaN : (n = l(n, 0, 1), X(L(t, 0, 1), r, n)) }, t.poissonSample = function (t, r) { return r <= 0 ? NaN : W(L(t, 0, 1), r) }, t.binomcdf = function (t, r, n, e) { return (n = l(Math.round(n), 0, 1 / 0)) === 1 / 0 ? NaN : (e = l(e, 0, 1), r < 0 ? 0 : (t = Math.ceil(t), r = Math.floor(r), t === -1 / 0 ? k(r, n, e) : k(r, n, e) - k(t - 1, n, e))) }, t.binompdf = U, t.poissonpdf = z, t.poissoncdf = function (t, r, n) { return n <= 0 ? NaN : (t = Math.ceil(t), (r = Math.floor(r)) < 0 ? 0 : t === -1 / 0 ? H(r, n) : H(r, n) - H(t - 1, n)) }, t.uniformpdf = function (t, r, n) { return n <= r ? NaN : t < r || t > n ? 0 : 1 / (n - r) }, t.uniformcdf = function (t, r, n, e) { return J(r, n, e) - J(t, n, e) }, t.erf = function (t) { var r = -t * t; return r < -750 ? t >= 0 ? 1 : -1 : t >= .065 ? 1 - Math.exp(r) * K(t) : t <= -.065 ? Math.exp(r) * K(-t) - 1 : t * (1.1283791670955126 + r * (.37612638903183754 + r * (.11283791670955126 + r * (.026866170645131252 + .005223977625442188 * r)))) }, t.erfcx = K, t.invNorm = V, t.invPoisson = W, t.invBinom = X, t.invT = function t(r, n) { return isNaN(n) || n <= 0 || r < 0 || r > 1 ? NaN : 0 === r ? -1 / 0 : 1 === r ? 1 / 0 : 1 === n || 2 === n || 4 === n ? Y(n, r) : .5 === r ? 0 : r > .5 ? function (t, r, n, e) { if (!isFinite(n) || !isFinite(e)) return NaN; var a = n, u = e; for (; ;) { var o = h.floatMiddle(a, u), i = C(t, o); if (o === a || o === u) return i > r ? a : u; i < r ? a = o : u = o } }(n, r, n > 1 ? V(r) : Y(1, r), n > 1 ? Y(1, r) : Math.pow(Q(0, n) * Math.pow(n, (n - 1) / 2) / (1 - r), 1 / n)) : -t(1 - r, n) }, t.invUniform = function (t, r, n) { return t < 0 || t > 1 || n <= r ? NaN : 0 === t ? r : 1 === t ? n : r + t * (n - r) }, t.tscore = Z, t.itscore = $, t.ttest = function (t, r) { 1 === arguments.length && (r = 0); var n = Z(t, r), e = t.length - 1; return { lessThan: tt(n, e, -1), greaterThan: tt(n, e, 1), notEqual: tt(n, e, 0) } }, t.ittest = function (t, r) { var n = $(t, r), e = t.length + r.length - 2; return { lessThan: tt(n, e, -1), greaterThan: tt(n, e, 1), notEqual: tt(n, e, 0) } }, t.stats = function (t) { return { min: rt(t), q1: at(t, 1), median: it(t), q3: at(t, 3), max: nt(t) } }, t.length = function (t) { return t.length }, t.listMin = rt, t.listMax = nt, t.quantile = et, t.quartile = at, t.sortPerm = ut, t.quartileIndex = ot, t.upperQuantileIndex = function (t, r) { return ut(t)[Math.ceil(r * (t.length - 1))] + 1 }, t.lowerQuantileIndex = function (t, r) { return ut(t)[Math.floor(r * (t.length - 1))] + 1 }, t.upperQuartileIndex = function (t, r) { return ut(t)[Math.ceil(ot(t, r))] + 1 }, t.lowerQuartileIndex = function (t, r) { return ut(t)[Math.floor(ot(t, r))] + 1 }, t.median = it, t.argMin = function (t) { if (t.length < 1) return 0; var r = t[0]; if (isNaN(r)) return 0; for (var n = 0, e = 1; e < t.length; e++) { if (isNaN(t[e])) return 0; t[e] < r && (n = e, r = t[e]) } return n + 1 }, t.argMax = function (t) { if (t.length < 1) return 0; var r = t[0]; if (isNaN(r)) return 0; for (var n = 0, e = 1; e < t.length; e++)if (t[e] >= r) { if (isNaN(t[e])) return 0; n = e, r = t[e] } return n + 1 }, t.varp = ft, t.mad = function (t) { for (var r = y(t), n = 0, e = 0; e < t.length; e++)n += Math.abs(t[e] - r); return n / t.length }, t.variance = ht, t.covp = ct, t.cov = function (t, r) { var n = Math.min(t.length, r.length); return ct(t, r) * n / (n - 1) }, t.corr = st, t.validateRangeLength = function (t, r, n, e) { for (var a = t[0], u = 2; u < t.length; u++) { var i = c.asFloat(c.div(c.sub(t[u], a), n)); if (!o.approx(i, u, 10)) return 0 } var f = c.asFloat(e); for (u = 0; u < r.length - 1; u++) { i = c.asFloat(c.div(c.sub(r[u], a), n)); if (!o.approx(i, f - r.length + u, 10)) return 0 } return !isFinite(f) || f < t.length || f < r.length ? 0 : f }, t.validateSampleCount = function (t) { return t < 0 || !isFinite(t) ? 0 : t }, t.rank = lt, t.spearman = function (t, r) { var n = Math.min(t.length, r.length); return t.length !== n && (t = t.slice(0, n)), r.length !== n && (r = r.slice(0, n)), st(lt(t), lt(r)) }, t.stdev = Mt, t.stdevp = function (t) { return Math.sqrt(ft(t)) }, t.quad = n.quad, t.distance = function (t, r) { return o.hypot(r[0] - t[0], r[1] - t[1]) }, t.rgb = vt, t.hsv = function (t, n, e) { t = l(t, 0, 360), n = l(n, 0, 1); var a = (e = l(e, 0, 1)) * (1 - n / 2); n = 0 === a || 1 === a ? 0 : (e - a) / Math.min(a, 1 - a); var u = r.hsl(t, n, a).rgb(); return vt(u.r, u.g, u.b) }, t.polygon = function (t) { return t }, t.select = function (t, r) { for (var n = [], e = 0; e < t.length; e++)r[e] && n.push(t[e]); return n }, t.elementsAt = function (t, r) { for (var n = [], e = 0, a = r; e < a.length; e++) { var u = a[e]; n.push(t[u]) } return n }, t.uniquePerm = function (t) { for (var r = [], n = {}, e = 0; e < t.length; e++) { var a = pt(t[e]); n.hasOwnProperty(a) || (n[a] = !0, r.push(e)) } return r } });
define('core/math/functions', ["require", "exports", "core/math/builtin"], function (require, e, t) { "use strict"; function n(e) { delete e.fn } function r(e) { e.fn = i(e.args, e.source, e.constants) } function i(e, n, r) { var i = e.join(","); return new Function("BuiltIn", "_C", "return (function(" + i + '){"use strict"; ' + n + "})")(t, r) } Object.defineProperty(e, "__esModule", { value: !0 }), e.closureFunctionWithBuiltIn = e.rehydrateCompiledFunction = e.dehydrateCompiledFunction = e.rehydrateGraphData = e.dehydrateGraphData = void 0, e.dehydrateGraphData = function (e) { for (var t = 0, r = e; t < r.length; t++) { var i = r[t].compiled; i && n(i) } }, e.rehydrateGraphData = function (e) { for (var t = 0, n = e; t < n.length; t++) { var i = n[t].compiled; i && r(i) } }, e.dehydrateCompiledFunction = n, e.rehydrateCompiledFunction = r, e.closureFunctionWithBuiltIn = i });
define('core/math/ir/instructions', ["require", "exports", "./opcodes"], function (require, e, n) { "use strict"; function t(e) { return e.type <= n.MAX_LEAF_OPCODE } Object.defineProperty(e, "__esModule", { value: !0 }), e.endsBlock = e.beginsBlock = e.isInternalInstruction = e.isLeafInstruction = void 0, e.isLeafInstruction = t, e.isInternalInstruction = function (e) { return !t(e) }, e.beginsBlock = function (e) { switch (e.type) { case n.BeginIntegral: case n.BeginBroadcast: case n.BeginLoop: return !0; default: return !1 } }, e.endsBlock = function (e) { switch (e.type) { case n.EndLoop: case n.EndIntegral: case n.EndBroadcast: return !0; default: return !1 } } });
define('core/math/ir/features/print', ["require", "exports", "../instructions", "../opcodes", "core/math/types", "../../context-types"], function (require, e, r, t, n, s) { "use strict"; function a(e, r) { var s = e.getInstruction(r); switch (s.type === t.Noop && s.removedInstructionForDebuggingOnly && (s = s.removedInstructionForDebuggingOnly), s.type) { case t.Noop: return c(s.type); case t.LoadArg: return c(s.type) + " " + n.repr(s.valueType) + " " + e.argNames[r]; case t.SymbolicVar: return c(s.type) + " " + n.repr(s.valueType); case t.Constant: return c(s.type) + " " + n.repr(s.valueType) + " " + o(s.value); case t.NativeFunction: case t.Distribution: return c(s.type) + " " + n.repr(s.valueType) + " " + s.symbol + " " + s.args.join(" "); case t.ExtendSeed: return c(s.type) + " " + n.repr(s.valueType) + " " + s.tag + " " + s.args.join(" "); case t.BroadcastResult: return c(s.type) + " " + n.repr(s.valueType) + " " + s.args.join(" ") + (s.isConstantBroadcast ? " (constant)" : ""); case t.Add: case t.Subtract: case t.Multiply: case t.Divide: case t.RawExponent: case t.Exponent: case t.Negative: case t.OrderedPair: case t.OrderedPairAccess: case t.BeginLoop: case t.EndLoop: case t.BeginIntegral: case t.EndIntegral: case t.BeginBroadcast: case t.EndBroadcast: case t.Equal: case t.Less: case t.Greater: case t.LessEqual: case t.GreaterEqual: case t.And: case t.Piecewise: case t.List: case t.ListAccess: case t.DeferredListAccess: case t.InboundsListAccess: case t.BlockVar: case t.Action: return c(s.type) + " " + n.repr(s.valueType) + " " + s.args.join(" "); default: throw new Error("Unexpected opcode " + s.type) } } function c(e) { switch (e) { case t.Noop: return "Noop"; case t.Constant: return "Constant"; case t.Add: return "Add"; case t.Subtract: return "Subtract"; case t.Multiply: return "Multiply"; case t.Divide: return "Divide"; case t.Exponent: return "Exponent"; case t.RawExponent: return "RawExponent"; case t.Negative: return "Negative"; case t.OrderedPair: return "OrderedPair"; case t.OrderedPairAccess: return "OrderedPairAccess"; case t.BeginLoop: return "BeginLoop"; case t.EndLoop: return "EndLoop"; case t.BeginIntegral: return "BeginIntegral"; case t.EndIntegral: return "EndIntegral"; case t.BeginBroadcast: return "BeginBroadcast"; case t.EndBroadcast: return "EndBroadcast"; case t.Equal: return "Equal"; case t.Less: return "Less"; case t.Greater: return "Greater"; case t.LessEqual: return "LessEqual"; case t.GreaterEqual: return "GreaterEqual"; case t.And: return "And"; case t.Piecewise: return "Piecewise"; case t.List: return "List"; case t.ListAccess: return "ListAccess"; case t.DeferredListAccess: return "DeferredListAccess"; case t.InboundsListAccess: return "InboundsListAccess"; case t.NativeFunction: return "NativeFunction"; case t.Distribution: return "Distribution"; case t.LoadArg: return "LoadArg"; case t.BlockVar: return "BlockVar"; case t.BroadcastResult: return "BroadcastResult"; case t.SymbolicVar: return "SymbolicVar"; case t.ExtendSeed: return "ExtendSeed"; case t.Action: return "Action"; default: throw new Error("Unexpected opcode " + e.type) } } function o(e) { if (Array.isArray(e)) return "[" + e.map(o).join(",") + "]"; switch (typeof e) { case "string": return e; case "boolean": case "number": return e.toString(); case "object": if (s.isActionCompilerValue(e)) { var r = []; for (var t in e.updateRules) r.push('"' + t + '": ' + o(e.updateRules[t].value)); return "{" + r.join(", ") + "}" } return e.n + "/" + e.d; default: throw new Error("Unexpected value: " + e) } } function i(e, r) { var t = e.toString(); return u(r - t.length) + t } function u(e) { for (var r = "", t = 0; t < e; t++)r += " "; return r } Object.defineProperty(e, "__esModule", { value: !0 }), e.printValue = e.printOp = e.printInstruction = e.print = void 0, e.print = function (e) { for (var n = "", s = (e.instructionsLength() - 1).toString().length, c = 0, o = !1, d = 0; d < e.instructionsLength(); d++) { var p = e.getInstruction(d), l = e.comments[d] || "", g = p.type === t.Noop && p.removedInstructionForDebuggingOnly; if ((r.endsBlock(p) || g && r.endsBlock(g)) && (c -= 1), p.type !== t.Noop || g) { o = !1; var y = g ? " [X]" : "    "; n += i(d, s) + ":" + y + " " + u(2 * c) + a(e, d) + (l ? "\t\t# " + l : "") + "\n" } else o || (n += i(d, s) + ": " + u(2 * c) + "...\n"), o = !0; (r.beginsBlock(p) || g && r.beginsBlock(g)) && (c += 1) } return n }, e.printInstruction = a, e.printOp = c, e.printValue = o });
define('core/math/ir/features/is-constant', ["require", "exports", "../opcodes", "./print"], function (require, t, n, s) { "use strict"; function o(t) { return t.type === n.Constant } function r(t) { return t.type === n.BroadcastResult && t.isConstantBroadcast } Object.defineProperty(t, "__esModule", { value: !0 }), t.isConstantOrConstantBroadcast = t.isConstantBroadcast = t.assertConstant = t.isConstant = void 0, t.isConstant = o, t.assertConstant = function (t) { if (!o(t)) throw new Error("Programming error: expected constant instruction but found " + s.printOp(t.type) + " instead.") }, t.isConstantBroadcast = r, t.isConstantOrConstantBroadcast = function (t) { return o(t) || r(t) } });
define('core/math/ir/features/depends-on-outer-variable', ["require", "exports", "../instructions", "./is-constant"], function (require, t, n, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.dependsOnOuterVariable = void 0, t.dependsOnOuterVariable = function (t, e, s) { var i = t.getInstruction(s); if (!n.isLeafInstruction(i)) for (var a = 0, o = i.args; a < o.length; a++) { var u = o[a]; if (!r.isConstantOrConstantBroadcast(t.getInstruction(u))) return !0 } if (e < s) return !r.isConstantOrConstantBroadcast(t.getInstruction(e)); for (var f = [!0], c = s + 1; c <= e; c++)f.push(!1); for (var d = [e]; d.length;) { if (!f[(c = d.pop()) - s]) { f[c - s] = !0; var g = t.getInstruction(c); if (!n.isLeafInstruction(g)) for (var v = 0, l = g.args; v < l.length; v++) { if ((u = l[v]) < s) { if (!r.isConstantOrConstantBroadcast(t.getInstruction(u))) return !0 } else f[u - s] || d.push(u) } } } return !1 } });
define('core/math/ir/features/reconstitute-ir', ["require", "exports", "core/math/types"], function (require, e, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.reconstituteIR = void 0, e.reconstituteIR = function e(r, n, o) { if (t.isList(n)) { for (var s = [], i = 0; i < o.length; i++)s.push(e(r, t.elementType(n), o[i])); return r.ConstantOfType(n, s) } switch (n) { case t.Number: return r.Constant(o); case t.Bool: case t.Point: case t.RGBColor: return r.ConstantOfType(n, o); default: throw new Error("Cannot reconstitute value of a " + t.prettyPrint(n) + ".") } } });
define('core/math/ir/features/list-length', ["require", "exports", "../opcodes", "core/math/types", "./print"], function (require, t, n, e, r) { "use strict"; function s(t, n) { var e = i(t, n); if (!(e < 0)) return e } function i(t, s, a) { var o, u = a && a[s]; if (u) return u; var c, g = t.getInstruction(s); switch (g.type) { case n.List: c = g.args.length; break; case n.Constant: c = g.value.length; break; case n.BroadcastResult: c = null !== (o = g.constantLength) && void 0 !== o ? o : -1 }return void 0 === c && (c = function (t, s, a) { switch (s.type) { case n.Piecewise: var o = i(t, s.args[1], a); return o === i(t, s.args[2], a) ? o : -1; case n.NativeFunction: switch (s.symbol) { case "elementsAt": return i(t, s.args[1], a); case "sortPerm": return i(t, s.args[0], a); case "shuffle": return i(t, s.args[1], a); default: return -1 }default: if (e.isList(s.valueType)) return -1; throw new Error("Programming Error: cannot find the list length of " + r.printOp(s.type) + " " + e.prettyPrint(s.valueType) + ".") } }(t, g, a = a || {})), a && (a[s] = c), c } function a(t, r) { var s = t.getInstruction(r); if (!e.isList(s.valueType)) throw new Error("Programming Error: cannot find the list length of " + t.printInstruction(r)); switch (s.type) { case n.List: return t.Constant(s.args.length); case n.Constant: return t.Constant(s.value.length); case n.BroadcastResult: var i = t.getInstruction(s.args[0]); return t.getInstruction(i.args[0]).args[0]; case n.NativeFunction: switch (s.symbol) { case "elementsAt": return a(t, s.args[1]); case "sortPerm": return a(t, s.args[0]); case "shuffle": return a(t, s.args[1]) } }return t.SyntheticNativeFunction("length", [r]) } Object.defineProperty(t, "__esModule", { value: !0 }), t.minListLengthIndex = t.listLengthIndex = t.getConstantListLength = t.assertConstantListLength = void 0, t.assertConstantListLength = function (t, n, e) { var i = s(t, n); if (void 0 === i) throw new Error(e + '\nNon-constant instruction: "' + r.printInstruction(t, a(t, n)) + '"'); return i }, t.getConstantListLength = s, t.listLengthIndex = a, t.minListLengthIndex = function (t, n) { for (var r = [], i = 0, o = n; i < o.length; i++) { var u = o[i]; e.isList(t.getInstruction(u).valueType) && r.push(u) } if (0 !== r.length) { if (1 === r.length) return a(t, r[0]); for (var c, g = [], h = 0, l = r; h < l.length; h++) { var f = l[h]; g.push(s(t, f)) } for (var v = 1 / 0, p = 0; p < g.length; p++) { var L = r[p], d = g[p]; if (void 0 === d) return t.SyntheticNativeFunction("min", [t.List(r.map(function (n) { return a(t, n) }))]); d < v && (c = L, v = d) } return void 0 !== c ? a(t, c) : t.Constant(v) } } });
define('core/math/ir/features/contains-nan-value', ["require", "exports", "core/math/types", "core/math/maybe-rational"], function (require, e, t, n) { "use strict"; function a(e, a) { switch (e) { case t.Number: return n.isNanFloat(a); case t.Point: var r = a, o = r[0], i = r[1]; return n.isNanFloat(o) || n.isNanFloat(i); case t.RGBColor: var s = a, u = s[0], c = s[1], l = s[2]; return n.isNanFloat(u) || n.isNanFloat(c) || n.isNanFloat(l); case t.Action: return 0 === Object.keys(a.updateRules).length; case t.Bool: return !1; default: throw new Error("Type cannot contain a NaN value: " + t.prettyPrint(e) + ".") } } Object.defineProperty(e, "__esModule", { value: !0 }), e.containsNanValue = void 0, e.containsNanValue = function (e, n) { if (t.isList(e)) { for (var r = t.elementType(e), o = 0; o < n.length; o++)if (a(r, n[o])) return !0; return !1 } return a(e, n) } });
define('core/math/ir/features/interpret', ["require", "exports", "tslib", "core/math/maybe-rational", "../opcodes", "core/math/types", "../instructions", "../builtin-table", "./as-value", "./nan-of-type", "../../builtin", "../../errormsg"], function (require, r, e, t, a, n, s, u, o, c, i, l) { "use strict"; function g(r, e) { return t.add(r, e) } function d(r, e) { return t.sub(r, e) } function p(r, e) { return t.mul(r, e) } function f(r, e) { return t.div(r, e) } function v(r, e) { return t.pow(r, e) } function h(r, e) { return v(r, e) } function y(r) { return t.neg(r) } function m(r, e) { return [r, e] } function E(r, e) { return r[t.asFloat(e) - 1] } function L(r, e) { return t.asFloat(r) === t.asFloat(e) } function A(r, e) { return t.asFloat(r) < t.asFloat(e) } function I(r, e) { return t.asFloat(r) > t.asFloat(e) } function b(r, e) { return t.asFloat(r) <= t.asFloat(e) } function F(r, e) { return t.asFloat(r) >= t.asFloat(e) } function B(r) { return r } function w(r, e, a) { var n = Math.floor(t.asFloat(a)) - 1; return !isFinite(n) || n < 0 || n >= e.length ? c.nanOfType(r) : e[n] } function R(r, e) { return r[Math.floor(t.asFloat(e)) - 1] } function q(r, e, a) { return t.isRational(a) && (a = t.asFloat(a)), e + "::" + r + a } function P(r, e) { switch (r) { case "mod": return t.mod(e[0], e[1]); case "abs": return t.abs(e[0]); case "sqrt": return t.sqrt(e[0]); case "nthroot": return t.nthroot(e[0], e[1]); case "total": return t.total(e[0]); case "length": return e[0].length; case "validateRangeLength": var a = e[0], n = e[1], s = e[2], c = e[3]; if (0 === (g = i.validateRangeLength(a, n, s, c))) throw l.nonArithmeticRange(); return g; case "validateSampleCount": var g; c = o.compilerValueToRuntimeValue(e[0]); if (0 === (g = i.validateSampleCount(c)) && 0 !== c) throw l.badSampleSize(); return g; case "select": case "elementsAt": case "uniquePerm": case "sortPerm": var d = u.BuiltInTable[r]; return i[d.symbol].apply(null, e); default: return ("Math" === (d = u.BuiltInTable[r]).module ? Math : i)[d.symbol].apply(null, o.compilerValueToRuntimeValue(e)) } } function T(r, e, a) { if (e.constantLength) return e.constantLength; var n = e.args[0], s = r.getInstruction(n).args[0], u = r.getInstruction(s); return t.asFloat(M(r, u.args[0], a)) } function x(r, e, t, a) { var s = r.getInstruction(e), u = T(r, s, a); if (!isFinite(t) || t < 0 || t >= u) return c.nanOfType(n.elementType(s.valueType)); var o = s.args[0], i = e - o, l = r.getInstruction(o), g = l.args[0], d = l.args[i]; a[g] = t + 1; for (var p = M(r, d, a), f = g; f <= o; f++)a[f] = void 0; return p } function S(r, n, s) { var u = M(r, n.args[1], s), o = n.args[0], c = r.getInstruction(o); if (c.type === a.BroadcastResult) return x(r, o, t.asFloat(u) - 1, s); if (c.type === a.Piecewise) { var i = M(r, c.args[0], s); return S(r, e.__assign(e.__assign({}, n), { args: [i ? c.args[1] : c.args[2], n.args[1]] }), s) } var l = M(r, n.args[0], s); return w(n.valueType, l, u) } function M(r, e, a) { var n = a[e]; if (void 0 !== n) return n; var s = O(r, e, a); return "number" == typeof s && s === Math.floor(s) && (s = t.maybeRational(s, 1)), a[e] = s, s } function O(r, e, t) { var n = r.getInstruction(e); switch (n.type) { case a.Constant: return n.value; case a.Add: return g(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Subtract: return d(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Multiply: return p(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Divide: return f(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Exponent: return v(M(r, n.args[0], t), M(r, n.args[1], t)); case a.RawExponent: return h(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Negative: return y(M(r, n.args[0], t)); case a.OrderedPair: return m(M(r, n.args[0], t), M(r, n.args[1], t)); case a.OrderedPairAccess: return E(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Equal: return L(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Less: return A(M(r, n.args[0], t), M(r, n.args[1], t)); case a.Greater: return I(M(r, n.args[0], t), M(r, n.args[1], t)); case a.LessEqual: return b(M(r, n.args[0], t), M(r, n.args[1], t)); case a.GreaterEqual: return F(M(r, n.args[0], t), M(r, n.args[1], t)); case a.And: return M(r, n.args[0], t) && M(r, n.args[1], t); case a.ExtendSeed: return q(n.tag, M(r, n.args[0], t), M(r, n.args[1], t)); case a.Piecewise: var u = M(r, n.args[0], t); return M(r, u ? n.args[1] : n.args[2], t); case a.NativeFunction: for (var o = [], c = 0, i = n.args; c < i.length; c++) { var l = i[c]; o.push(M(r, l, t)) } return P(n.symbol, o); case a.List: o = []; for (var B = 0, w = n.args; B < w.length; B++) { l = w[B]; o.push(M(r, l, t)) } return o; case a.ListAccess: case a.DeferredListAccess: case a.InboundsListAccess: return S(r, n, t); case a.BroadcastResult: return function (r, e, t) { for (var a = r.getInstruction(e), n = [], s = T(r, a, t) - 1; s >= 0; s--)n[s] = x(r, e, s, t); return n }(r, e, t); case a.BlockVar: var R = n.args[0], O = r.getInstruction(R).args[0], D = e - R, N = r.getInstruction(R).args[D], V = []; V[N] = !0; for (var _ = N; _ >= O; _--)if (V[_]) { var C = r.getInstruction(_); if (!s.isLeafInstruction(C)) for (var G = 0, k = C.args; G < k.length; G++) { (l = k[G]) < O ? M(r, l, t) : V[l] = !0 } } var W = r.copy(); W.truncate(O); for (_ = 0; _ < O; _++) { var j = t[_], z = r.getInstruction(_); if (void 0 !== j) { var H = z.valueType; W.replaceInstructionWithConstant(_, { type: a.Constant, valueType: H, value: j }) } } var J = []; for (_ = O; _ < e; _++) { var K = r.getInstruction(_); if (s.isLeafInstruction(K)) J.push(W.copyInstruction(K)); else { for (var Q = [], U = 0, X = K.args; U < X.length; U++) { l = X[U]; Q.push(l < O ? l : J[l - O]) } K.type === a.DeferredListAccess ? J.push(W.InboundsListAccess(Q)) : J.push(W.copyInstructionWithArgs(K, Q)) } } return W.Noop(), W.replaceInstructionWithBlockVar(W.returnIndex, { type: a.BlockVar, valueType: n.valueType, args: [R < O ? R : J[R - O]] }), W.close().getCompiledFunction().fn(); case a.BeginLoop: case a.EndLoop: case a.BeginIntegral: case a.EndIntegral: case a.BeginBroadcast: case a.EndBroadcast: case a.Distribution: case a.Noop: case a.LoadArg: case a.SymbolicVar: case a.Action: throw new Error("Programming Error: cannot interpret opcode " + n.type); default: throw new Error("Programming Error: unexpected opcode " + n.type) } } Object.defineProperty(r, "__esModule", { value: !0 }), r._interpretRecursive = r.interpretBroadcastElements = r.interpretBroadcastElement = r.interpret = r.NativeFunction = r.ExtendSeed = r.InboundsListAccess = r.DeferredListAccess = r.ListAccess = r.List = r.And = r.GreaterEqual = r.LessEqual = r.Greater = r.Less = r.Equal = r.OrderedPairAccess = r.OrderedPair = r.Negative = r.RawExponent = r.Exponent = r.Divide = r.Multiply = r.Subtract = r.Add = void 0, r.Add = g, r.Subtract = d, r.Multiply = p, r.Divide = f, r.Exponent = v, r.RawExponent = h, r.Negative = y, r.OrderedPair = m, r.OrderedPairAccess = E, r.Equal = L, r.Less = A, r.Greater = I, r.LessEqual = b, r.GreaterEqual = F, r.And = function (r, e) { return r && e }, r.List = B, r.ListAccess = w, r.DeferredListAccess = function (r, e) { return R(r, e) }, r.InboundsListAccess = R, r.ExtendSeed = q, r.NativeFunction = P, r.interpret = function (r, e) { return M(r, e, Array(e + 1)) }, r.interpretBroadcastElement = function (r, e, t) { return x(r, e, t, Array(e + 1)) }, r.interpretBroadcastElements = function (r, e, t) { for (var a = Array(e + 1), n = [], s = 0, u = t; s < u.length; s++) { var o = u[s]; n.push(x(r, e, o, a)) } return n }, r._interpretRecursive = O });
define('core/math/ir/features/find-dependency-symbols', ["require", "exports", "../instructions", "../opcodes"], function (require, e, o, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.findDependencySymbols = void 0, e.findDependencySymbols = function (e, r) { for (var n = [], a = [], t = 0; t < r; t++)a.push(!1); for (a.push(!0), t = r; t >= 0; t--)if (a[t]) { var i = e.getInstruction(t); if (i.type === s.LoadArg) n.push({ symbol: e.argNames[t], scope: "free" }); else if (o.beginsBlock(i)) switch (i.type) { case s.BeginIntegral: n.push({ symbol: i.callData.indexSymbol, scope: "integral" }); break; case s.BeginLoop: n.push({ symbol: i.callData.indexSymbol, scope: i.callData.type }); break; case s.BeginBroadcast: if (i.listComprehensionCallData) for (var l = 0, c = i.listComprehensionCallData.inputListSymbols; l < c.length; l++) { var p = c[l]; n.push({ symbol: p, scope: "comprehension" }) } break; default: throw new Error("Programming Error: unexpected loop instruction " + i.type) } else i.type === s.SymbolicVar && i.symbol && n.push({ symbol: i.symbol, scope: "symbolic-var" }); if (!o.isLeafInstruction(i)) for (var y = 0, u = i.args; y < u.length; y++) { a[u[y]] = !0 } } return n.reverse() } });
define('core/math/ir/features/fuse-broadcast', ["require", "exports", "../opcodes", "core/math/types", "../instructions", "./interpret", "./list-length", "../../errormsg", "./find-dependency-symbols"], function (require, t, r, e, n, s, i, o, u) { "use strict"; function a(t, r, n) { if (n.valueType === e.ListOfDistribution) { var a = i.getConstantListLength(t, r); if (null == a) throw o.variableLengthDistributionList(u.findDependencySymbols(t, r)); for (var c = [], f = 0; f < a; f++) { var d = t.InboundsListAccess([r, t.Constant(f + 1)]); c.push(d) } return t.List(c) } var p = s.interpret(t, r); return r === t.returnIndex && t.popInstruction(), t.ConstantOfType(n.valueType, p) } Object.defineProperty(t, "__esModule", { value: !0 }), t.fuseBroadcast = void 0, t.fuseBroadcast = function (t, e) { var s = t.getInstruction(e); if (s.type !== r.BroadcastResult) return e; if (s.isConstantBroadcast) return a(t, e, s); for (var i = s.args[0], o = t.getInstruction(i), u = o.args[0], c = !1, f = u + 1; f < i; f++) { var d = t.getInstruction(f); if (d.type === r.DeferredListAccess && d.args[1] === u) { c = !0; break } } if (!c) return e; for (var p = [], g = u; g <= i + o.args.length - 1; g++) { var v = t.getInstruction(g); if (n.isLeafInstruction(v)) p.push(t.copyInstruction(v)); else { for (var l = [], y = 0, I = v.args; y < I.length; y++) { var h = I[y]; l.push(h >= u ? p[h - u] : h) } v.type === r.DeferredListAccess ? p.push(t.InboundsListAccess(l)) : p.push(t.copyInstructionWithArgs(v, l)) } } var L = t.getInstruction(t.returnIndex); return L.type === r.BroadcastResult && L.isConstantBroadcast ? a(t, t.returnIndex, L) : t.returnIndex } });
define('core/math/ir/features/element-at', ["require", "exports", "./list-length", "./interpret", "../opcodes", "core/math/types", "./nan-of-type"], function (require, t, e, n, s, a, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.elementsAt = t.elementAt = void 0, t.elementAt = function (t, r, o) { var i = t.getInstruction(r); if (a.isList(i.valueType)) { var p = e.getConstantListLength(t, r); if (o = Math.floor(o), isNaN(o) || o < 0 || void 0 !== p && o >= p) { var l = a.elementType(i.valueType); return t.NanOfType(l) } return i.type === s.List ? i.args[o] : i.type === s.Constant && a.isList(i.valueType) ? t.ConstantOfType(a.elementType(i.valueType), i.value[o]) : i.type === s.BroadcastResult && i.isConstantBroadcast ? t.ConstantOfType(a.elementType(i.valueType), n.interpretBroadcastElement(t, r, o)) : void 0 !== p ? t.InboundsListAccess([r, t.Constant(o + 1)]) : t.ListAccess([r, t.Constant(o + 1)]) } if (i.valueType === a.Point) return isNaN(o) || o < 0 || o > 2 ? t.Constant(NaN) : i.type === s.OrderedPair ? i.args[o] : i.type === s.Constant ? t.Constant(i.value[o]) : t.OrderedPairAccess([r, t.Constant(o + 1)]); throw new Error("Cannot access elements of " + a.prettyPrint(i.valueType)) }, t.elementsAt = function (t, o, i) { var p = t.getInstruction(o); if (0 === i.length) return t.ConstantOfType(p.valueType, []); if (p.type === s.Constant && a.isList(p.valueType)) { for (var l = [], u = a.elementType(p.valueType), y = 0, c = i; y < c.length; y++) { var v = c[y], f = Math.floor(v); isNaN(f) || f < 0 || f >= e.assertConstantListLength(t, o, "Programming error: expected Constant list instruction to have constant length.") ? l.push(r.nanOfType(u)) : l.push(p.value[f]) } return t.ConstantOfType(p.valueType, l) } if (p.type === s.List) { l = []; for (var T = 0, h = i; T < h.length; T++) { v = h[T], f = Math.floor(v); if (isNaN(f) || f < 0 || f >= e.assertConstantListLength(t, o, "Programming error: expected List instruction to have constant length.")) { var d = a.elementType(p.valueType); l.push(t.NanOfType(d)) } else l.push(p.args[f]) } return t.List(l) } if (p.type === s.BroadcastResult && p.isConstantBroadcast) return t.ConstantOfType(p.valueType, n.interpretBroadcastElements(t, o, i)); for (var g = [], C = !0, L = e.getConstantListLength(t, o), m = 0, N = i; m < N.length; m++) { v = N[m], f = Math.floor(v); g.push(t.Constant(f + 1)), (isNaN(f) || f < 0 || void 0 === L || f >= L) && (C = !1) } var O = [o, t.List(g)]; return C ? t.InboundsListAccess(O) : t.ListAccess(O) } });
define('core/math/ir/features/constant-collapse', ["require", "exports", "../opcodes", "../instructions", "core/math/types", "core/math/maybe-rational", "./depends-on-outer-variable", "./is-constant", "./as-value", "./reconstitute-ir", "./list-length", "./contains-nan-value", "./interpret", "./fuse-broadcast", "./element-at", "../../builtin"], function (require, t, n, e, r, s, a, o, u, i, c, p, l, g, I, v) { "use strict"; function y(t, n) { for (var e = [], r = 0, s = n; r < s.length; r++) { var a = s[r], u = t.getInstruction(a); if (!o.isConstant(u)) return; e.push(u.value) } return e } Object.defineProperty(t, "__esModule", { value: !0 }), t.constantCollapse = void 0, t.constantCollapse = function (t) { if (t.instructionsLength() - 1 !== t.returnIndex) throw new Error("Programming Error: only the final instruction in a chunk can be constant collapsed"); var d = t.getInstruction(t.returnIndex); if (e.isLeafInstruction(d)) return t.returnIndex; switch (d.type) { case n.Add: var C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.Constant(l.Add(C.value, f.value))) : C.type === n.Constant && 0 === s.asFloat(C.value) ? (t.popInstruction(), d.args[1]) : f.type === n.Constant && 0 === s.asFloat(f.value) ? (t.popInstruction(), d.args[0]) : t.returnIndex; case n.Subtract: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.Constant(l.Subtract(C.value, f.value))) : C.type === n.Constant && 0 === s.asFloat(C.value) ? (t.popInstruction(), t.Negative([d.args[1]])) : f.type === n.Constant && 0 === s.asFloat(f.value) ? (t.popInstruction(), d.args[0]) : t.returnIndex; case n.Multiply: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.Constant(l.Multiply(C.value, f.value))) : C.type === n.Constant && 1 === s.asFloat(C.value) ? (t.popInstruction(), d.args[1]) : f.type === n.Constant && 1 === s.asFloat(f.value) ? (t.popInstruction(), d.args[0]) : t.returnIndex; case n.Divide: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.Constant(l.Divide(C.value, f.value))) : f.type === n.Constant && 1 === s.asFloat(f.value) ? (t.popInstruction(), d.args[0]) : t.returnIndex; case n.Exponent: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); if (C.type === n.Constant && f.type === n.Constant) return t.popInstruction(), t.Constant(l.Exponent(C.value, f.value)); if (C.type === n.Constant && C.valueType === r.Number) { if ((x = s.asFloat(C.value)) === Math.E) return t.popInstruction(), t.SyntheticNativeFunction("exp", [d.args[1]]); if (x > 0) return t.popInstruction(), t.RawExponent(d.args) } if (f.type === n.Constant && f.valueType === r.Number) { var x; if (1 === (x = s.asFloat(f.value))) return t.popInstruction(), d.args[0]; if (x === Math.floor(x)) return t.popInstruction(), t.RawExponent(d.args); if (s.isRational(f.value)) { var h = f.value, T = h.n; if (h.d % 2 == 1) { t.popInstruction(); var L = t.RawExponent([t.SyntheticNativeFunction("abs", [d.args[0]]), d.args[1]]); return T % 2 == 0 ? L : t.Multiply([t.SyntheticNativeFunction("sign", [d.args[0]]), L]) } } } return t.returnIndex; case n.RawExponent: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.Constant(l.Exponent(C.value, f.value))) : f.type === n.Constant && 1 === s.asFloat(f.value) ? (t.popInstruction(), d.args[0]) : t.returnIndex; case n.Negative: return (C = t.getInstruction(d.args[0])).type === n.Constant ? (t.popInstruction(), t.Constant(l.Negative(C.value))) : t.returnIndex; case n.Equal: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.ConstantOfType(r.Bool, l.Equal(C.value, f.value))) : t.returnIndex; case n.Less: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.ConstantOfType(r.Bool, l.Less(C.value, f.value))) : t.returnIndex; case n.Greater: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.ConstantOfType(r.Bool, l.Greater(C.value, f.value))) : t.returnIndex; case n.LessEqual: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.ConstantOfType(r.Bool, l.LessEqual(C.value, f.value))) : t.returnIndex; case n.GreaterEqual: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.ConstantOfType(r.Bool, l.GreaterEqual(C.value, f.value))) : t.returnIndex; case n.And: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && f.type === n.Constant ? (t.popInstruction(), t.ConstantOfType(r.Bool, l.And(C.value, f.value))) : t.returnIndex; case n.Piecewise: return (C = t.getInstruction(d.args[0])).type === n.Constant ? (t.popInstruction(), C.value ? d.args[1] : d.args[2]) : t.returnIndex; case n.OrderedPairAccess: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.OrderedPair && f.type === n.Constant ? (t.popInstruction(), C.args[s.asFloat(f.value) - 1]) : C.type === n.Constant && C.valueType === r.Point && f.type === n.Constant ? (t.popInstruction(), t.Constant(C.value[s.asFloat(f.value) - 1])) : t.returnIndex; case n.List: if (function (t, n) { for (var e = 0, r = n; e < r.length; e++) { var s = r[e], a = t.getInstruction(s); if (!o.isConstant(a)) return !1 } return !0 }(t, d.args)) { t.popInstruction(); for (var E = [], b = 0, A = d.args; b < A.length; b++) { var m = A[b]; E.push(t.getInstruction(m).value) } return t.ConstantOfType(d.valueType, E) } return t.returnIndex; case n.ListAccess: case n.InboundsListAccess: var O = d.args[0], N = t.getInstruction(O), F = t.getInstruction(d.args[1]); if (N.type === n.Piecewise && F.type === n.Constant) { var B = d.type === n.ListAccess ? t.ListAccess([N.args[1], d.args[1]]) : t.InboundsListAccess([N.args[1], d.args[1]]), w = d.type === n.ListAccess ? t.ListAccess([N.args[2], d.args[1]]) : t.InboundsListAccess([N.args[2], d.args[1]]); return t.Piecewise([N.args[0], B, w]) } if (N.type === n.BroadcastResult) { if (F.type === n.Constant && N.isConstantBroadcast && N.valueType !== r.ListOfDistribution) return t.ConstantOfType(d.valueType, l.interpret(t, t.returnIndex)); t.popInstruction(); var q = N.args[0], P = O - q, R = (et = t.getInstruction(q)).args[0], M = void 0, S = void 0; if (d.type === n.InboundsListAccess) M = d.args[1]; else { var V = c.getConstantListLength(t, O); if (F.type === n.Constant && F.valueType === r.Number && void 0 !== V) { var D = s.asFloat(F.value), G = Math.floor(D); if (G < 1 || G > V) return t.NanOfType(d.valueType); M = D === G ? d.args[1] : t.Constant(G) } else { var k = t.Constant(1), _ = t.getInstruction(R).args[0], j = t.SyntheticNativeFunction("floor", [d.args[1]]), U = t.GreaterEqual([j, k]), W = t.LessEqual([j, _]); M = t.Piecewise([U, t.Piecewise([W, j, _]), k]), S = { one: k, lengthIndex: _, roundedIndex: j, greaterEqualIndex: U, lessEqualIndex: W } } } if (et.args[P] < R) return et.args[P]; for (var z = [M], H = R + 1; H <= et.args[P]; H++) { var J = t.getInstruction(H); if (e.isLeafInstruction(J)) z.push(t.copyInstruction(J)); else { for (var K = [], Q = 0, X = J.args; Q < X.length; Q++) { m = X[Q]; K.push(m >= R ? z[m - R] : m) } J.type === n.DeferredListAccess ? z.push(t.InboundsListAccess(K)) : z.push(t.copyInstructionWithArgs(J, K)) } } if (S) { U = S.greaterEqualIndex, W = S.lessEqualIndex, _ = S.lengthIndex, k = S.one; var Y = r.elementType(N.valueType), Z = t.NanOfType(Y), $ = z[z.length - 1], tt = t.And([t.And([U, W]), t.GreaterEqual([_, k])]); return t.Piecewise([tt, $, Z]) } return z[z.length - 1] } if (F.type === n.Constant && F.valueType === r.Number) { if (N.type === n.List) { t.popInstruction(); var nt = Math.floor(s.asFloat(F.value)) - 1; return isNaN(nt) || nt < 0 || nt >= N.args.length ? t.NanOfType(d.valueType) : N.args[nt] } if (N.type === n.Constant) { t.popInstruction(); nt = Math.floor(s.asFloat(F.value)) - 1; return isNaN(nt) || nt < 0 || nt >= N.value.length ? t.NanOfType(d.valueType) : t.ConstantOfType(r.elementType(N.valueType), N.value[nt]) } return t.returnIndex } return t.returnIndex; case n.BlockVar: var et = t.getInstruction(d.args[0]); if (!e.endsBlock(et)) return t.returnIndex; P = t.returnIndex - d.args[0]; if (a.dependsOnOuterVariable(t, et.args[P], et.args[0])) return t.returnIndex; var rt = t.copy(); rt.close(); E = rt.getCompiledFunction().fn(); return t.popInstruction(), i.reconstituteIR(t, d.valueType, E); case n.NativeFunction: switch (d.symbol) { case "nthroot": if (void 0 !== (gt = y(t, d.args))) return t.Constant(s.nthroot(gt[0], gt[1])); var st = t.getInstruction(d.args[1]); return st.type === n.Constant && st.valueType === r.Number ? t.Exponent([d.args[0], t.Constant(s.reciprocal(st.value))]) : t.returnIndex; case "length": return void 0 !== (V = c.getConstantListLength(t, d.args[0])) ? (t.popInstruction(), t.Constant(V)) : t.returnIndex; case "select": if (o.isConstant(t.getInstruction(d.args[1]))) { t.popInstruction(); var at = u.asValue(t, d.args[1]), ot = []; for (H = 0; H < at.length; H++)at[H] && ot.push(H); return I.elementsAt(t, d.args[0], ot) } return t.returnIndex; case "shuffle": var ut = d.args[0]; N = d.args[1]; if (void 0 !== (V = c.getConstantListLength(t, N)) && o.isConstant(t.getInstruction(ut))) { t.popInstruction(); var it = v.randomPerm(u.asValue(t, ut), V); return I.elementsAt(t, N, it) } return t.returnIndex; case "elementsAt": var ct = d.args[0], pt = d.args[1]; if (o.isConstant(t.getInstruction(pt))) { t.popInstruction(); var lt = u.asValue(t, pt); return I.elementsAt(t, ct, lt) } return t.returnIndex; default: var gt; return void 0 === (gt = y(t, d.args)) ? t.returnIndex : (t.popInstruction(), t.ConstantOfType(d.valueType, l.NativeFunction(d.symbol, gt))) }case n.ExtendSeed: var It = t.getInstruction(d.args[0]), vt = t.getInstruction(d.args[1]); return o.isConstant(It) && o.isConstant(vt) ? t.ConstantOfType(r.SeedType, l.ExtendSeed(d.tag, u.asValue(t, d.args[0]), u.asValue(t, d.args[1]))) : t.returnIndex; case n.OrderedPair: C = t.getInstruction(d.args[0]), f = t.getInstruction(d.args[1]); return C.type === n.Constant && C.valueType === r.Number && f.type === n.Constant && f.valueType === r.Number ? t.ConstantOfType(r.Point, [C.value, f.value]) : t.returnIndex; case n.BroadcastResult: return void 0 !== (V = c.getConstantListLength(t, t.returnIndex)) && 0 === V ? (t.popInstruction(), t.ConstantOfType(d.valueType, [])) : t.returnIndex; case n.Action: for (var yt = 0, dt = d.args; yt < dt.length; yt++) { m = dt[yt]; if (!o.isConstantOrConstantBroadcast(t.getInstruction(m))) return t.returnIndex } t.popInstruction(); var Ct = {}; for (H = 0; H < d.symbols.length; H++) { var ft = d.symbols[H], xt = t.getInstruction(d.args[H]); if (xt.type === n.BroadcastResult && (xt = t.getInstruction(g.fuseBroadcast(t, d.args[H]))), xt.type !== n.Constant) throw new Error("Expected instruction to be constant"); var ht = xt.valueType; E = xt.value; p.containsNanValue(ht, E) || (Ct[ft] = { value: E, valueType: ht }) } return t.ConstantOfType(r.Action, { type: "Action", updateRules: Ct }); case n.EndLoop: case n.EndIntegral: case n.BeginBroadcast: case n.EndBroadcast: case n.DeferredListAccess: case n.Distribution: case n.BeginIntegral: case n.BeginLoop: return t.returnIndex; default: throw new Error("Unexpected opcode " + d.type) } } });
define('core/math/ir/features/type-check', ["require", "exports", "core/math/errormsg", "../opcodes", "core/math/types", "../builtin-table", "../instructions"], function (require, e, r, t, a, s, n) { "use strict"; function i(e, r) { for (var t = [], s = 0, n = r; s < n.length; s++) { var i = n[s]; t.push(a.prettyPrint(e.getInstruction(i).valueType)) } return t } function u(e, r, t) { for (var s = 0; s < r.length; s++) { var n = e.getInstruction(r[s]).valueType, i = t[s]; if (!a.isSubType(n, i)) return !1 } return !0 } Object.defineProperty(e, "__esModule", { value: !0 }), e.typeCheck = e.argIsTypeOrListOfType = e.argTypesMatch = e.extractScalarValueTypes = e.extractValueTypes = void 0, e.extractValueTypes = i, e.extractScalarValueTypes = function (e, r) { for (var t = [], s = 0, n = r; s < n.length; s++) { var i = n[s], u = e.getInstruction(i).valueType, o = a.isList(u) ? a.elementType(u) : u; t.push(a.prettyPrint(o)) } return t }, e.argTypesMatch = u, e.argIsTypeOrListOfType = function (e, r, t) { return a.isTypeOrListOfType(e.getInstruction(r).valueType, t) }, e.typeCheck = function (e, o) { var c = e.getInstruction(o); if (!n.isLeafInstruction(c)) switch (c.type) { case t.Add: var p = [a.Number, a.Number]; if (!u(e, c.args, p)) throw r.addTypeError(i(e, c.args)); return; case t.Subtract: p = [a.Number, a.Number]; if (!u(e, c.args, p)) throw r.subtractTypeError(i(e, c.args)); return; case t.Multiply: p = [a.Number, a.Number]; if (!u(e, c.args, p)) throw r.multiplyTypeError(i(e, c.args)); return; case t.Divide: p = [a.Number, a.Number]; if (!u(e, c.args, p)) throw r.divideTypeError(i(e, c.args)); return; case t.Exponent: case t.RawExponent: p = [a.Number, a.Number]; if (!u(e, c.args, p)) throw r.exponentTypeError(i(e, c.args)); return; case t.Negative: p = [a.Number]; if (!u(e, c.args, p)) throw r.negativeTypeError(i(e, c.args)); return; case t.Equal: case t.Less: case t.Greater: case t.LessEqual: case t.GreaterEqual: p = [a.Number, a.Number]; if (!u(e, c.args, p)) throw r.comparatorTypeError(i(e, c.args)); return; case t.And: p = [a.Bool, a.Bool]; if (!u(e, c.args, p)) throw r.andTypeError(i(e, c.args)); return; case t.Piecewise: if (e.getInstruction(c.args[0]).valueType !== a.Bool) throw r.piecewiseConditionTypeError(i(e, c.args)); if (!a.isSubType(e.getInstruction(c.args[1]).valueType, c.valueType) || !a.isSubType(e.getInstruction(c.args[2]).valueType, c.valueType)) throw r.piecewiseBranchTypeError([a.prettyPrint(e.getInstruction(c.args[1]).valueType), a.prettyPrint(e.getInstruction(c.args[2]).valueType)]); return; case t.OrderedPair: for (var g = 0, y = c.args; g < y.length; g++) { var l = y[g]; if ((m = e.getInstruction(l).valueType) !== a.Number) throw r.pointTypeError(a.prettyPrint(m)) } return; case t.OrderedPairAccess: p = [a.Point, a.Number]; if (!u(e, c.args, p)) throw r.orderedPairAccessTypeError(i(e, c.args)); return; case t.BeginIntegral: var T = e.getInstruction(c.args[0]).valueType, v = e.getInstruction(c.args[1]).valueType; if (T !== a.Number) throw r.integralLowerBoundTypeError([a.prettyPrint(T)]); if (v !== a.Number) throw r.integralUpperBoundTypeError([a.prettyPrint(v)]); return; case t.EndIntegral: var f = e.getInstruction(c.args[1]).valueType; if (f !== a.Number) throw r.integralArgumentTypeError([a.prettyPrint(f)]); return; case t.List: if (0 === c.args.length) return; var d = e.getInstruction(c.args[0]).valueType; if (!a.hasListType(d)) throw r.listTypeError([a.prettyPrint(d)]); for (var h = 0, b = c.args; h < b.length; h++) { l = b[h]; var m = e.getInstruction(l).valueType; if (!a.hasListType(m)) throw r.listTypeError([a.prettyPrint(m)]); if (m !== d) throw r.heterogeneousList() } return; case t.ListAccess: case t.DeferredListAccess: case t.InboundsListAccess: var w = e.getInstruction(c.args[0]).valueType, I = a.isList(w), E = e.getInstruction(c.args[1]).valueType === a.Number; if (!I || !E) throw r.indexTypeError(i(e, c.args)); return; case t.NativeFunction: var L = c.args, N = c.symbol, P = s.BuiltInTable[N], B = (p = P.argumentTypes, c.callData.errorSymbol); if (!u(e, c.args, p)) { if ("doubleReducer" === P.tag) { if (!a.isList(e.getInstruction(L[0]).valueType) || !a.isList(e.getInstruction(L[1]).valueType)) throw r.nonListDoubleReducer(B) } else if ("parameterizedReducer" === P.tag && !a.isList(e.getInstruction(L[0]).valueType)) throw r.nonListParameterizedReducer(B); var O = L; throw r.functionTypeError(B, i(e, O)) } return; case t.ExtendSeed: if (e.getInstruction(c.args[0]).valueType !== a.SeedType || e.getInstruction(c.args[1]).valueType !== a.SeedType && e.getInstruction(c.args[1]).valueType !== a.Number) throw r.parseError(); return; case t.Action: for (var x = 0, S = c.args; x < S.length; x++) { l = S[x]; var A = e.getInstruction(l).valueType; if (!a.isTypeOrListOfType(A, a.Number) && !a.isTypeOrListOfType(A, a.Point)) throw r.updateRuleTypeError(a.prettyPrint(A)) } for (var R = {}, D = 0, V = c.symbols; D < V.length; D++) { if (R[N = V[D]]) throw r.duplicateUpdateRules(N); R[N] = !0 } return; case t.BroadcastResult: case t.BlockVar: case t.BeginBroadcast: case t.EndBroadcast: case t.BeginLoop: case t.EndLoop: case t.Distribution: return; default: throw new Error("Unexpected opcode: " + c.type) } } });
define('core/math/ir/features/count-references', ["require", "exports", "../opcodes", "../instructions"], function (require, e, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.countReferences = void 0, e.countReferences = function (e) { for (var t = [], s = 0; s < e.instructionsLength(); s++) { t.push(0); var o = e.getInstruction(s); if (!r.isLeafInstruction(o)) if (r.endsBlock(o) && o.type !== n.EndIntegral) for (var i = 0, c = o.args; i < c.length; i++) { t[c[i]] = 1 / 0 } else for (var u = 0, f = o.args; u < f.length; u++) { t[f[u]] += 1 } } return t } });
define('core/math/ir/features/emit-js', ["require", "exports", "../opcodes", "./print", "../instructions", "core/math/maybe-rational", "core/math/types", "../builtin-table", "./count-references", "core/math/context-types", "./as-value", "./nan-of-type"], function (require, e, r, n, t, a, s, o, c, u, i, g) { "use strict"; function d(e) { return "_" + e } function l(e, r) { var n = r[e]; return void 0 !== n ? n : d(e) } function p(e, t, a, c, u, p) { var v = a + 1; switch (t.type) { case r.Noop: case r.BlockVar: case r.BroadcastResult: case r.EndIntegral: case r.Action: return { source: "", nextIdx: v }; case r.BeginIntegral: return { source: f(e, t, a, c, u, p), nextIdx: t.endIndex }; case r.LoadArg: return u[a] = e.argNames[a], { source: "", nextIdx: v }; case r.BeginBroadcast: return { source: x(e, t, a, u), nextIdx: v }; case r.EndBroadcast: return { source: I(e, t, a, u), nextIdx: v }; case r.BeginLoop: return { source: y(e, t, a, u), nextIdx: v }; case r.EndLoop: return { source: h(e, t, a, u), nextIdx: v }; default: var m = function (e, t, a) { switch (e.type) { case r.Constant: return e.valueType === s.Number || e.valueType === s.Bool || e.valueType === s.Point ? B(e.value) : (a.push(i.compilerValueToRuntimeValue(e.value)), "_C[" + (a.length - 1) + "]"); case r.Add: return l(e.args[0], t) + "+" + l(e.args[1], t); case r.Subtract: return l(e.args[0], t) + "-" + l(e.args[1], t); case r.Multiply: return l(e.args[0], t) + "*" + l(e.args[1], t); case r.Divide: return l(e.args[0], t) + "/" + l(e.args[1], t); case r.Exponent: return "BuiltIn.pow(" + l(e.args[0], t) + "," + l(e.args[1], t) + ")"; case r.RawExponent: return "Math.pow(" + l(e.args[0], t) + "," + l(e.args[1], t) + ")"; case r.Negative: return "-" + l(e.args[0], t); case r.Equal: return l(e.args[0], t) + "===" + l(e.args[1], t); case r.Less: return l(e.args[0], t) + "<" + l(e.args[1], t); case r.Greater: return l(e.args[0], t) + ">" + l(e.args[1], t); case r.LessEqual: return l(e.args[0], t) + "<=" + l(e.args[1], t); case r.GreaterEqual: return l(e.args[0], t) + ">=" + l(e.args[1], t); case r.And: return l(e.args[0], t) + "&&" + l(e.args[1], t); case r.Piecewise: return l(e.args[0], t) + "?" + l(e.args[1], t) + ":" + l(e.args[2], t); case r.OrderedPair: return "[" + l(e.args[0], t) + "," + l(e.args[1], t) + "]"; case r.OrderedPairAccess: return l(e.args[0], t) + "[" + l(e.args[1], t) + "-1]"; case r.List: return "[" + e.args.map(function (e) { return l(e, t) }).join(",") + "]"; case r.DeferredListAccess: case r.Distribution: case r.SymbolicVar: throw new Error("Programming Error: expect " + n.printOp(e.type) + " to be removed before emitting code."); case r.ListAccess: var c = l(e.args[0], t); return "(Math.floor(" + (u = l(e.args[1], t)) + ")>=1&&Math.floor(" + u + ")<=" + c + ".length)?" + c + "[Math.floor(" + u + ")-1]:" + B(g.nanOfType(e.valueType)); case r.InboundsListAccess: var u; return (c = l(e.args[0], t)) + "[" + (u = l(e.args[1], t)) + "-1]"; case r.NativeFunction: var d = o.BuiltInTable[e.symbol], p = e.args.map(function (e) { return l(e, t) }).join(","); return d.module + "." + d.symbol + "(" + p + ")"; case r.ExtendSeed: return l(e.args[0], t) + "+'::" + e.tag + "'+" + l(e.args[1], t); case r.LoadArg: case r.Noop: case r.BeginIntegral: case r.EndIntegral: case r.BeginLoop: case r.EndLoop: case r.BeginBroadcast: case r.EndBroadcast: case r.BlockVar: case r.BroadcastResult: case r.Action: throw new Error("Unexpected opcode " + e.type); default: throw new Error("Unexpected opcode " + e.type) } }(t, u, p); return c[a] <= 1 ? (u[a] = "(" + m + ")", { source: "", nextIdx: v }) : { source: d(a) + "=" + m + ";\n", nextIdx: v } } } function f(e, r, n, t, a, s) { var o = "BuiltIn.quad("; o += function (e, r, n, t, a, s) { var o = r.endIndex, c = "function(" + d(n) + ") {\n"; c += v(e, n + 1, o - 1, t); for (var u = n + 1; u < o;) { var i = e.getInstruction(u), g = p(e, i, u, t, a, s); c += g.source, u = g.nextIdx } return c + "return " + l(e.getInstruction(o).args[1], a) + ";\n}" }(e, r, n, t, a, s), o += "," + l(r.args[0], a) + "," + l(r.args[1], a) + ")"; var c = r.endIndex; return t[c + 1] <= 1 ? (a[c + 1] = o, "") : d(c + 1) + "=" + o + ";" } function v(e, n, a, s) { for (var o = "", c = !1, u = n; u <= a; u++) { var i = e.getInstruction(u); if (i.type !== r.Noop && i.type !== r.EndBroadcast && i.type !== r.EndLoop) if (i.type !== r.BeginIntegral) s[u] <= 1 && !t.beginsBlock(i) && !t.endsBlock(i) && i.type !== r.BlockVar && i.type !== r.BroadcastResult || (c ? o += "," : (o += "var ", c = !0), o += d(u)); else { var g = i.endIndex; u = s[g + 1] <= 1 ? g + 1 : g } } return c && (o += ";\n"), o } function x(e, n, t, a) { for (var s = d(t), o = e.getInstruction(n.endIndex), c = l(n.args[0], a), u = "", i = 1; i < o.args.length; i++) { var g = n.endIndex + i; if (e.getInstruction(g).type === r.BroadcastResult) u += d(g) + "=[];\n" } return u += "for(" + s + "=1;" + s + "<=" + c + ";" + s + "++){\n" } function I(e, n, t, a) { for (var s = "", o = 1; o < n.args.length; o++) { var c = t + o; if (!(c >= e.instructionsLength())) if (e.getInstruction(c).type === r.BroadcastResult) s += d(t + o) + ".push(" + l(n.args[o], a) + ");\n" } return s += "}\n" } function y(e, n, t, a) { for (var s = d(t), o = "" + l(n.args[0], a), c = "" + l(n.args[1], a), u = "if(!isFinite(" + c + "-" + o + ")){\n", i = 2; i < n.args.length; i++) { var p = n.endIndex + i - 1; if (!(p >= e.instructionsLength())) { var f = e.getInstruction(p); if (f.type === r.BlockVar) u += d(p) + "=" + B(g.nanOfType(f.valueType)) + ";\n" } } u += "}else{\n"; for (i = 2; i < n.args.length; i++) { var v = t + i - 1; if (e.getInstruction(v).type === r.BlockVar) u += d(v) + "=" + l(n.args[i], a) + ";\n" } return u += "for(" + s + "=" + o + ";" + s + "<=" + c + ";" + s + "++){\n" } function h(e, n, t, a) { for (var s = "", o = 1; o < n.args.length; o++) { var c = n.args[0] + o; if (e.getInstruction(c).type === r.BlockVar) s += d(c) + "=" + l(n.args[o], a) + ";\n" } s += "}\n"; for (o = 1; o < n.args.length; o++) { var u = t + o; if (!(u >= e.instructionsLength())) if (e.getInstruction(u).type === r.BlockVar) s += d(u) + "=" + l(n.args[0] + o, a) + ";\n" } return s += "}\n" } function B(e) { if (Array.isArray(e)) return "[" + e.map(B).join(",") + "]"; switch (typeof e) { case "boolean": case "number": return e.toString(); case "string": return "" + JSON.stringify(e); case "object": if (u.isActionCompilerValue(e)) throw new Error("Action values cannot be compiled"); return a.asFloat(e).toString(); default: throw new Error("Unexpected value: " + e) } } Object.defineProperty(e, "__esModule", { value: !0 }), e.emitJS = void 0, e.emitJS = function (e) { for (var r = c.countReferences(e), n = [], t = [], a = v(e, e.argNames.length, e.instructionsLength() - 1, r), s = 0; s < e.instructionsLength();) { var o = e.getInstruction(s), u = p(e, o, s, r, n, t); a += u.source, s = u.nextIdx } return { source: a += "return " + l(e.returnIndex, n) + ";", constants: t } } });
define('core/math/ir/features/get-value-type', ["require", "exports", "../opcodes", "core/math/types"], function (require, e, s, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getValueType = void 0, e.getValueType = function (e, a, c) { switch (a) { case s.Add: case s.Subtract: case s.Multiply: case s.Divide: case s.Exponent: case s.RawExponent: case s.Negative: case s.OrderedPairAccess: case s.BeginIntegral: case s.BeginLoop: case s.BeginBroadcast: return t.Number; case s.Equal: case s.Less: case s.Greater: case s.LessEqual: case s.GreaterEqual: case s.And: return t.Bool; case s.Piecewise: var r = e.getInstruction(c[1]).valueType, n = e.getInstruction(c[2]).valueType; return r === t.EmptyList && t.isList(n) ? n : r; case s.OrderedPair: return t.Point; case s.List: if (0 === c.length) return t.EmptyList; var i = e.getInstruction(c[0]).valueType; return t.hasListType(i) ? t.listType(i) : t.ListOfAny; case s.ListAccess: case s.DeferredListAccess: case s.InboundsListAccess: var o = e.getInstruction(c[0]).valueType; return t.isList(o) ? t.elementType(o) : t.Any; case s.ExtendSeed: return t.SeedType; case s.Action: return t.Action; case s.Constant: case s.LoadArg: case s.NativeFunction: case s.Distribution: case s.BlockVar: case s.BroadcastResult: case s.SymbolicVar: case s.Noop: case s.EndIntegral: case s.EndBroadcast: case s.EndLoop: return t.Any; default: throw new Error("Unexpected opcode " + a) } } });
define('core/math/ir/features/drop-unreferenced-instructions', ["require", "exports", "../instructions"], function (require, e, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.dropUnreferencedInstructions = void 0, e.dropUnreferencedInstructions = function (e) { for (var r = [], t = 0; t < e.instructionsLength(); t++)r.push(!1); for (r[e.returnIndex] = !0, t = e.instructionsLength() - 1; t >= 0; t--)if (r[t]) { var i = e.getInstruction(t); if (!n.isLeafInstruction(i)) for (var o = 0, s = i.args; o < s.length; o++) { r[s[o]] = !0 } } else e.replaceInstructionWithNoop(t) } });
define('core/math/ir/features/copy-instruction', ["require", "exports", "../opcodes"], function (require, e, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.copyInstructionWithArgs = e.copyInstruction = void 0, e.copyInstruction = function (e, r) { return e.pushLeafInstruction(r) }, e.copyInstructionWithArgs = function (e, t, s) { switch (t.type) { case r.Add: return e.Add(s); case r.Subtract: return e.Subtract(s); case r.Multiply: return e.Multiply(s); case r.Divide: return e.Divide(s); case r.Exponent: return e.Exponent(s); case r.RawExponent: return e.RawExponent(s); case r.Negative: return e.Negative(s); case r.Equal: return e.Equal(s); case r.Less: return e.Less(s); case r.Greater: return e.Greater(s); case r.LessEqual: return e.LessEqual(s); case r.GreaterEqual: return e.GreaterEqual(s); case r.And: return e.And(s); case r.Piecewise: return e.Piecewise(s); case r.BlockVar: return e.BlockVar(t.valueType, s); case r.BroadcastResult: return e.BroadcastResult(t.valueType, s); case r.OrderedPair: return e.OrderedPair(s); case r.OrderedPairAccess: return e.OrderedPairAccess(s); case r.NativeFunction: return e.NativeFunction(t.symbol, t.callData, s); case r.Distribution: return e.Distribution(t.symbol, s); case r.BeginIntegral: return e.BeginIntegral(t.callData, s); case r.EndIntegral: return e.EndIntegral(s); case r.BeginBroadcast: return e.BeginBroadcast(s); case r.EndBroadcast: return e.EndBroadcast(s); case r.BeginLoop: return e.BeginLoop(t.callData, s); case r.EndLoop: return e.EndLoop(s); case r.List: return e.List(s); case r.ListAccess: return e.ListAccess(s); case r.DeferredListAccess: return e.DeferredListAccess(s); case r.InboundsListAccess: return e.InboundsListAccess(s); case r.ExtendSeed: return e.ExtendSeed(t.tag, s); case r.Action: return e.Action(t.symbols, s); default: throw new Error("Unexpected opcode " + t.type) } } });
define('core/math/ir/features/convert-to-broadcast', ["require", "exports", "core/math/errormsg", "../opcodes", "core/math/types", "./list-length", "../instructions", "../builtin-table", "./fuse-broadcast", "./is-constant", "./as-value", "./copy-instruction"], function (require, r, e, t, s, n, a, c, o, i, u, d) { "use strict"; function g(r, e, a) { for (var c = e.args, g = !1, l = [], p = 0; p < c.length; p++)if (!a || a[p]) { var h = c[p], v = r.getInstruction(h).valueType; s.isList(v) && -1 === l.indexOf(h) && l.push(h), v === s.EmptyList && (g = !0) } if (0 === l.length) return r.returnIndex; if (e.type === t.Piecewise && -1 == l.indexOf(e.args[0]) && l.indexOf(e.args[1]) >= 0 && l.indexOf(e.args[2]) >= 0) { var I = o.fuseBroadcast(r, e.args[1]), y = o.fuseBroadcast(r, e.args[2]); return I !== e.args[1] || y !== e.args[2] ? d.copyInstructionWithArgs(r, e, [e.args[0], I, y]) : r.returnIndex } r.popInstruction(); var m = n.minListLengthIndex(r, l); if (void 0 === m) throw new Error("Programming Error: expected minListLength to be defined for " + l.length + " lists"); var L = m; if (i.isConstant(r.getInstruction(L)) && 0 === u.asValue(r, L) && g) return r.ConstantOfType(s.EmptyList, []); for (var x = r.BeginBroadcast([L]), B = [], E = 0, b = l; E < b.length; E++) { var w = b[E]; B.push(f(r, w, x)) } var A = []; for (p = 0; p < c.length; p++) { h = c[p]; if (a && !a[p]) A.push(h); else { var T = l.indexOf(h); A.push(-1 === T ? h : B[T]) } } var O = r.copyInstructionWithArgs(e, A), P = r.EndBroadcast([x, O]); return r.BroadcastResult(s.listType(r.getInstruction(O).valueType), [P]) } function f(r, e, s) { return r.getInstruction(e).type == t.BroadcastResult ? r.DeferredListAccess([e, s]) : r.InboundsListAccess([e, s]) } Object.defineProperty(r, "__esModule", { value: !0 }), r.deferredOrInboundsAccess = r.convertToBroadcast = void 0, r.convertToBroadcast = function (r) { if (r.instructionsLength() - 1 !== r.returnIndex) throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast"); var n = r.getInstruction(r.returnIndex); if (a.isLeafInstruction(n)) return r.returnIndex; switch (n.type) { case t.Add: case t.Subtract: case t.Multiply: case t.Divide: case t.Exponent: case t.RawExponent: case t.Equal: case t.Less: case t.Greater: case t.LessEqual: case t.GreaterEqual: case t.And: case t.OrderedPair: case t.Negative: case t.Piecewise: case t.OrderedPairAccess: return g(r, n); case t.Distribution: return o.fuseBroadcast(r, g(r, n)); case t.NativeFunction: var i = c.BuiltInTable[n.symbol]; switch (i.tag) { case "default": case "trig": case "inverseTrig": case "color": return g(r, n); case "never-broadcast": for (var u = [], d = !1, f = 0, l = n.args; f < l.length; f++) { var p = l[f], h = o.fuseBroadcast(r, p); h !== p ? (d = !0, u.push(h)) : u.push(p) } return d ? r.copyInstructionWithArgs(n, u) : r.returnIndex; case "reducer": if (function (r, e) { for (var t = 0, n = e; t < n.length; t++) { var a = n[t]; if (s.isList(r.getInstruction(a).valueType)) return !0 } return !1 }(r, n.args)) { if (1 === n.args.length) { var v = n.args[0], I = o.fuseBroadcast(r, v); return I !== v ? r.copyInstructionWithArgs(n, [I]) : r.returnIndex } return g(r, n) } r.popInstruction(); var y = function (r, e) { var t = r.getInstruction(e[0]).valueType; if (!s.hasListType(t)) return s.ListOfAny; for (var n = 0, a = e; n < a.length; n++) { var c = a[n]; if (r.getInstruction(c).valueType !== t) return s.ListOfAny } return s.listType(t) }(r, n.args); if (!s.isSubType(y, i.argumentTypes[0])) throw e.functionTypeError(n.callData.errorSymbol, [s.prettyPrint(y)]); var m = r.List(n.args); return r.copyInstructionWithArgs(n, [m]); case "doubleReducer": if (2 !== n.args.length) throw new Error("Programming error: double reducers must have two arguments"); var L = o.fuseBroadcast(r, n.args[0]), x = o.fuseBroadcast(r, n.args[1]); return L !== n.args[0] || x !== n.args[1] ? r.copyInstructionWithArgs(n, [L, x]) : r.returnIndex; case "parameterizedReducer": if (2 !== n.args.length) throw new Error("Programming error: double reducers must have two arguments"); return (L = o.fuseBroadcast(r, n.args[0])) === n.args[0] ? g(r, n, [!1, !0]) : r.copyInstructionWithArgs(n, [L, n.args[1]]); default: var B = i.tag; throw new Error("Programming Error: unexpected tag " + B) }case t.ListAccess: case t.DeferredListAccess: case t.InboundsListAccess: return g(r, n, [!1, !0]); case t.BeginIntegral: case t.EndIntegral: case t.BeginLoop: case t.EndLoop: return r.returnIndex; case t.List: case t.BlockVar: case t.BeginBroadcast: case t.EndBroadcast: case t.BroadcastResult: case t.ExtendSeed: case t.Action: return r.returnIndex; default: throw new Error("Unexpected opcode " + n.type) } }, r.deferredOrInboundsAccess = f });
define('core/math/ir/features/to-dot', ["require", "exports", "../instructions", "./print", "../opcodes"], function (require, t, n, r, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (t) { var i = []; i.push("digraph {"); for (var s = 0; s < t.instructionsLength(); s++) { (o = t.getInstruction(s)).type !== e.Noop && i.push(s + ' [label="' + s + ": " + r.printInstruction(t, s) + '"];') } for (s = 0; s < t.instructionsLength(); s++) { var o = t.getInstruction(s); if (n.isInternalInstruction(o)) for (var u = 0, c = o.args; u < c.length; u++) { var p = c[u]; i.push(s + " -> " + p + ";") } } return i.push("}"), i.join("\n") } });
define('core/math/ir/features/get-dependency-mask', ["require", "exports", "../instructions"], function (require, e, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getDependencyMask = void 0, e.getDependencyMask = function (e, n) { for (var t = [], s = 0; s < e.instructionsLength(); s++)t.push(!1); t[n] = !0; for (var i = 0; i <= 1; i++) { var o = !1; for (s = n + 1; s < e.instructionsLength(); s++) { var a = e.getInstruction(s); if (!r.isLeafInstruction(a) && !t[s]) { for (var u = !1, c = 0, f = a.args; c < f.length; c++) { if (t[f[c]]) { u = !0; break } } t[s] = u, u && r.endsBlock(a) && !t[a.args[0]] && (t[a.args[0]] = !0, o = !0) } } if (!o) break } return t } });
define('core/math/ir/features/polynomial-order', ["require", "exports", "../opcodes", "core/math/maybe-rational", "./get-dependency-mask", "../instructions"], function (require, e, r, a, s, t) { "use strict"; function n(e, r, a) { var t = a.allowRestriction, n = a.allowClosedBlockReferences; return { chunk: e, argIndex: r, orderTable: [], mask: s.getDependencyMask(e, r), allowRestriction: t, allowClosedBlockReferences: n } } function c(e, s) { var n = e.orderTable[s]; if (void 0 !== n) return n; var o = function (e, s) { var n = e.chunk, o = e.mask, i = e.argIndex, l = e.allowRestriction; if (!e.allowClosedBlockReferences && n.isInClosedBlock(s)) return 1 / 0; if (s === i) return 1; var u = n.getInstruction(s); if (t.beginsBlock(u) || t.endsBlock(u)) return 1 / 0; switch (u.type) { case r.Add: case r.Subtract: case r.Less: case r.LessEqual: case r.Greater: case r.GreaterEqual: var d = u.args, f = d[0], v = d[1]; return Math.max(c(e, f), c(e, v)); case r.Multiply: var p = u.args; f = p[0], v = p[1]; return c(e, f) + c(e, v); case r.Negative: return c(e, u.args[0]); case r.Divide: var g = u.args; f = g[0]; return c(e, v = g[1]) > 0 ? 1 / 0 : c(e, f); case r.Exponent: case r.RawExponent: var y = u.args, k = (f = y[0], v = y[1], n.getInstruction(v)); if (0 === c(e, f) && 0 === c(e, v)) return 0; if (k.type === r.Constant) { var m = a.asFloat(k.value); return m === Math.round(m) && m > 0 ? c(e, f) * m : 1 / 0 } return 1 / 0; case r.Piecewise: if (!o[s]) return 0; var x = n.getInstruction(u.args[2]); return l && x.type === r.Constant && isNaN(a.asFloat(x.value)) ? c(e, u.args[1]) : 1 / 0; case r.LoadArg: case r.Noop: case r.Constant: case r.Equal: case r.And: case r.OrderedPair: case r.OrderedPairAccess: case r.List: case r.ListAccess: case r.DeferredListAccess: case r.InboundsListAccess: case r.NativeFunction: case r.Distribution: case r.BroadcastResult: case r.BlockVar: case r.SymbolicVar: case r.ExtendSeed: case r.Action: return o[s] ? 1 / 0 : 0; default: throw new Error("Unexpected opcode " + u.type) } }(e, s); return e.orderTable[s] = o, o } Object.defineProperty(e, "__esModule", { value: !0 }), e.instructionOrder = e.polynomialOrderContext = e.polynomialOrder = void 0, e.polynomialOrder = function (e, r, a) { var s = e.argNames.indexOf(r); return -1 === s ? 0 : c(n(e, s, a), e.returnIndex) }, e.polynomialOrderContext = n, e.instructionOrder = c });
define('core/math/ir/features/get-polynomial-coefficients', ["require", "exports", "../chunk", "../opcodes", "core/math/maybe-rational", "./polynomial-order", "../instructions", "./copy-instruction"], function (require, e, n, r, t, a, s, o) { "use strict"; function i(e) { var t, a, i = e.chunk, c = e.argIndex; if (i.isInClosedBlock(c)) throw new Error("Programming Error: cannot find polynomial coefficients of an instruction in a closed block"); c >= 0 && c < i.argNames.length ? (t = i.argNames.slice(), a = i.argTypes.slice(), t.splice(c, 1), a.splice(c, 1)) : (t = i.argNames, a = i.argTypes); for (var u = new n.Chunk({ argNames: t, argTypes: a }), l = [], p = 0; p < i.instructionsLength(); p++) { var d = i.getInstruction(p); if (d.type === r.LoadArg) p < c || c < 0 ? l.push(p) : p === c ? l.push(u.SymbolicVar(i.argTypes[p])) : l.push(p - 1); else if (s.isLeafInstruction(d)) l.push(o.copyInstruction(u, d)); else { for (var f = [], g = 0, h = d.args; g < h.length; g++) { var y = h[g]; f.push(l[y]) } l.push(o.copyInstructionWithArgs(u, d, f)) } } var m = u.Constant(0), v = u.Constant(1), C = u.Constant(NaN); return { chunk: i, newChunk: u, orderCtx: e, coefficientTable: [], mask: e.mask, valueMap: l, argIndex: c, zero: m, one: v, nan: C } } function c(e, n) { var s, o = e.newChunk, i = e.orderCtx, u = e.coefficientTable, l = e.mask, p = e.valueMap, d = e.argIndex, f = e.zero, g = e.one, h = e.nan, y = u[n]; if (void 0 !== y) return y; for (s = l[n] ? n === d ? [f, g] : a.instructionOrder(i, n) > 2 ? [h] : function (e, n) { var a, s = e.chunk.getInstruction(n), o = e.newChunk; switch (s.type) { case r.Add: for (var i = s.args, u = i[0], l = i[1], p = c(e, u), d = c(e, l), f = p.length - 1, g = d.length - 1, h = [], y = 0; y <= Math.max(f, g); y++)f >= y && g >= y ? h.push(o.Add([p[y], d[y]])) : h.push(f > g ? p[y] : d[y]); return h; case r.Subtract: case r.Less: case r.LessEqual: case r.Greater: case r.GreaterEqual: var m = s.args; u = m[0], l = m[1]; s.type !== r.Less && s.type != r.LessEqual || (u = (a = [l, u])[0], l = a[1]); p = c(e, u), d = c(e, l), f = p.length - 1, g = d.length - 1, h = []; for (var v = 0; v <= Math.max(f, g); v++)f >= v && g >= v ? h.push(o.Subtract([p[v], d[v]])) : h.push(f > g ? p[v] : o.Negative([d[v]])); return h; case r.Negative: p = c(e, u = s.args[0]), h = []; for (var C = 0; C < p.length; C++)h.push(o.Negative([p[C]])); return h; case r.Multiply: for (var w = s.args, x = (u = w[0], l = w[1], p = c(e, u), d = c(e, l), f = p.length - 1, g = d.length - 1, h = [], 0); x <= f; x++)for (var I = 0; I <= g; I++)if (!(x + I > 2)) { var k = o.Multiply([p[x], d[I]]), E = h[x + I]; h[x + I] = void 0 === E ? k : o.Add([E, k]) } return h; case r.Divide: for (var L = s.args, b = (u = L[0], l = L[1], p = c(e, u), d = c(e, l), h = [], 0); b < p.length; b++)h.push(o.Divide([p[b], d[0]])); return h; case r.Exponent: case r.RawExponent: var A = s.args; u = A[0], l = A[1], p = c(e, u), d = c(e, l); if (0 === (f = p.length - 1)) return [o.RawExponent([p[0], d[0]])]; var M = o.getInstruction(d[0]); switch (t.asFloat(M.value)) { case 0: return [o.Constant(0)]; case 1: return p; case 2: return [o.Multiply([p[0], p[0]]), o.Multiply([o.Constant(2), o.Multiply([p[0], p[1]])]), o.Multiply([p[1], p[1]])] }case r.Piecewise: return c(e, s.args[1]); case r.Noop: case r.BeginBroadcast: case r.LoadArg: case r.Constant: case r.Equal: case r.And: case r.OrderedPair: case r.OrderedPairAccess: case r.List: case r.ListAccess: case r.DeferredListAccess: case r.InboundsListAccess: case r.NativeFunction: case r.Distribution: case r.BeginIntegral: case r.EndIntegral: case r.BeginLoop: case r.EndLoop: case r.EndBroadcast: case r.BroadcastResult: case r.BlockVar: case r.SymbolicVar: case r.ExtendSeed: case r.Action: throw new Error("Cannot find polynomial coefficients of opcode " + s.type + " that depends on symbol."); default: throw new Error("Unexpected opcode " + s.type) } }(e, n) : [p[n]]; s.length > 1;) { var m = o.getInstruction(s[s.length - 1]); if (m.type !== r.Constant || 0 !== t.asFloat(m.value)) break; s.pop() } if (0 === s.length) throw new Error("Programming Error: coefficients cannot be empty"); return u[n] = s, s } Object.defineProperty(e, "__esModule", { value: !0 }), e.instructionCoefficients = e.polynomialCoefficientContext = e.getPolynomialCoefficients = void 0, e.getPolynomialCoefficients = function (e, n) { var t = e.argNames.indexOf(n), s = i(a.polynomialOrderContext(e, t, { allowRestriction: !0, allowClosedBlockReferences: !1 })); if (a.instructionOrder(s.orderCtx, e.returnIndex) > 2) throw new Error("Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2"); for (var o = c(s, e.returnIndex), u = !1, l = 0; l < e.instructionsLength(); l++)e.getInstruction(l).type === r.Piecewise && s.mask[l] && (u = !0); return { chunk: s.newChunk, coefficients: o, mappedArgIndex: s.valueMap[t], mappedReturnIndex: s.valueMap[e.returnIndex], isRestrictedPolynomial: u } }, e.polynomialCoefficientContext = i, e.instructionCoefficients = c });
define('core/math/ir/features/lift-point-operations', ["require", "exports", "../opcodes", "core/math/types", "../instructions"], function (require, e, r, s, a) { "use strict"; function t(e, r) { return e.getInstruction(r).valueType === s.Point } function n(e, r) { return e.getInstruction(r).valueType === s.Number } Object.defineProperty(e, "__esModule", { value: !0 }), e.liftPointOperations = void 0, e.liftPointOperations = function (e) { if (e.instructionsLength() - 1 !== e.returnIndex) throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast"); var s = e.getInstruction(e.returnIndex); if (a.isLeafInstruction(s)) return e.returnIndex; switch (s.type) { case r.Add: if (t(e, s.args[0]) && t(e, s.args[1])) { var c = e.Constant(1), i = e.Constant(2); return e.OrderedPair([e.Add([e.OrderedPairAccess([s.args[0], c]), e.OrderedPairAccess([s.args[1], c])]), e.Add([e.OrderedPairAccess([s.args[0], i]), e.OrderedPairAccess([s.args[1], i])])]) } return e.returnIndex; case r.Subtract: if (t(e, s.args[0]) && t(e, s.args[1])) { c = e.Constant(1), i = e.Constant(2); return e.OrderedPair([e.Subtract([e.OrderedPairAccess([s.args[0], c]), e.OrderedPairAccess([s.args[1], c])]), e.Subtract([e.OrderedPairAccess([s.args[0], i]), e.OrderedPairAccess([s.args[1], i])])]) } return e.returnIndex; case r.Negative: if (t(e, s.args[0])) { c = e.Constant(1), i = e.Constant(2); return e.OrderedPair([e.Negative([e.OrderedPairAccess([s.args[0], c])]), e.Negative([e.OrderedPairAccess([s.args[0], i])])]) } return e.returnIndex; case r.Multiply: if (t(e, s.args[0]) && n(e, s.args[1])) { c = e.Constant(1), i = e.Constant(2); return e.OrderedPair([e.Multiply([e.OrderedPairAccess([s.args[0], c]), s.args[1]]), e.Multiply([e.OrderedPairAccess([s.args[0], i]), s.args[1]])]) } if (n(e, s.args[0]) && t(e, s.args[1])) { c = e.Constant(1), i = e.Constant(2); return e.OrderedPair([e.Multiply([s.args[0], e.OrderedPairAccess([s.args[1], c])]), e.Multiply([s.args[0], e.OrderedPairAccess([s.args[1], i])])]) } return e.returnIndex; case r.Divide: if (t(e, s.args[0]) && n(e, s.args[1])) { c = e.Constant(1), i = e.Constant(2); return e.OrderedPair([e.Divide([e.OrderedPairAccess([s.args[0], c]), s.args[1]]), e.Divide([e.OrderedPairAccess([s.args[0], i]), s.args[1]])]) } return e.returnIndex; case r.Exponent: case r.RawExponent: case r.Equal: case r.Less: case r.Greater: case r.LessEqual: case r.GreaterEqual: case r.And: case r.OrderedPair: case r.Piecewise: case r.OrderedPairAccess: case r.NativeFunction: case r.Distribution: case r.ListAccess: case r.DeferredListAccess: case r.InboundsListAccess: case r.BeginIntegral: case r.EndIntegral: case r.BeginLoop: case r.EndLoop: case r.List: case r.BlockVar: case r.BeginBroadcast: case r.EndBroadcast: case r.BroadcastResult: case r.ExtendSeed: case r.Action: return e.returnIndex; default: throw new Error("Unexpected opcode " + s.type) } } });
define('core/math/policy', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.defaultPolicy = void 0; var n = ["Sum", "Product", "Integral", "List", "Derivative", "Piecewise", "Exponent", "PercentOf", "FunctionDefinition", "UpdateRule"]; e.defaultPolicy = { assignmentForbidden: function (e) { return !0 }, graphingEnabled: function () { return !1 }, isValidSlider: function (e) { return !1 }, sliderVariables: function (e) { return [] }, ansEnabled: function () { return !1 }, disabledFeatures: function () { return n }, dimensionVarsEnabled: function () { return !1 } } });
define('core/math/ir/features/substitute', ["require", "exports", "../instructions", "./copy-instruction", "../opcodes"], function (require, r, t, n, e) { "use strict"; function s(r, n) { var o = r.chunk, a = r.argMap, u = r.start; if (n < u) return n; var c = a[n - u]; if (void 0 !== c) return c; var g = i(r, n); r.argMap[n - u] = g; var f = o.getInstruction(n); if (t.beginsBlock(f)) switch (f.type) { case e.BeginBroadcast: case e.BeginIntegral: break; case e.BeginLoop: for (var p = f.args.length - 2, v = 0; v < p; v++)s(r, n + 1 + v); break; default: throw new Error("Programming Error. Unexpected OpCode: " + f.type) } else if (t.endsBlock(f)) for (p = f.args.length - 1, v = 0; v < p; v++)s(r, n + 1 + v); return g } function i(r, e) { var i = r.chunk, o = r.start, a = i.getInstruction(e); if (t.endsBlock(a)) for (var u = a.args[0], c = u; c <= e; c++) { var g = i.getInstruction(c); if (!t.isLeafInstruction(g)) for (var f = 0, p = g.args; f < p.length; f++) { (h = p[f]) < u && s(r, h) } } if (t.isLeafInstruction(a)) return n.copyInstruction(i, a); for (var v = [], d = 0, l = a.args; d < l.length; d++) { var h = l[d]; v.push(s(r, h)) } var I = r.argMap[e - o]; return void 0 !== I ? I : n.copyInstructionWithArgs(i, a, v) } Object.defineProperty(r, "__esModule", { value: !0 }), r._substituteInstruction = r.substitute = void 0, r.substitute = function (r, t, n, e) { return s(function (r, t, n) { return { chunk: r, argMap: t, start: n } }(r, [t], n), e) }, r._substituteInstruction = i });
define('core/math/ir/dependencies', ["require", "exports", "core/math/builtinframe"], function (require, e, n) { "use strict"; function r(e, n) { return "FunctionDefinition" === n.type && (n = n._expression), i(e, n, {}) } function t(e, n, r) { for (var i = [], p = [], f = 0, o = n.scopes; f < o.length; f++) { for (var d = t(e, o[f], r), u = 0, a = d.freeDependencies; u < a.length; u++) { var c = a[u]; -1 === i.indexOf(c) && -1 === n.definitions.indexOf(c) && i.push(c) } for (var l = 0, y = d.updateSymbols; l < y.length; l++) { c = y[l]; -1 === p.indexOf(c) && p.push(c) } } for (var h = 0, g = n.dependencies; h < g.length; h++) { for (var v = s(e, g[h], r), D = 0, S = v.freeDependencies; D < S.length; D++) { c = S[D]; -1 === i.indexOf(c) && -1 === n.definitions.indexOf(c) && i.push(c) } for (var m = 0, b = v.updateSymbols; m < b.length; m++) { c = b[m]; -1 === p.indexOf(c) && p.push(c) } } return { freeDependencies: i, updateSymbols: p } } function i(e, n, r) { if ("Slider" === n.type || "Assignment" === n.type) return i(e, n._expression, r); var s = t(e, n.getScope(), r), p = s.freeDependencies, f = s.updateSymbols, o = n.getUpdateSymbols(); if (o.length > 0) { f = f.slice(); for (var d = 0, u = o; d < u.length; d++) { var a = u[d]; -1 === f.indexOf(a) && f.push(a) } } return { freeDependencies: p, updateSymbols: f } } function s(e, r, t) { if (t[r]) return t[r]; if (n[r]) return t[r] = { freeDependencies: [], updateSymbols: [] }, t[r]; var s = e[r]; return s ? (t[r] = { freeDependencies: [r], updateSymbols: [] }, t[r] = i(e, s, t), t[r]) : (t[r] = { freeDependencies: [r], updateSymbols: [] }, t[r]) } Object.defineProperty(e, "__esModule", { value: !0 }), e.getCacheKeys = e.analyzeDependencies = e.getFreeDependencies = e.FRAME_SENTINEL = void 0, e.FRAME_SENTINEL = {}, e.getFreeDependencies = function (e, n) { return r(e, n).freeDependencies }, e.analyzeDependencies = r, e.getCacheKeys = function (n, r) { for (var t = {}, i = r.getDependencies().slice(); i.length;) { var s = i.pop(); if (!t.hasOwnProperty(s)) { var p = n[s]; if (p === e.FRAME_SENTINEL) return; t[s] = p, p && p.getDependencies && Array.prototype.push.apply(i, p.getDependencies()) } } return function (e) { var n = []; for (var r in e) n.push([r, e[r]]); return n }(t) } });
define('core/math/ir/features/take-derivative', ["require", "exports", "core/math/builtinframe", "tslib", "core/math/errormsg", "../scope", "../instructions", "../opcodes", "./get-dependency-mask", "core/math/policy", "core/math/baseparser", "../build-ir", "./copy-instruction", "core/math/types", "./substitute", "./list-length", "../dependencies", "core/math/maybe-rational"], function (require, t, e, r, n, a, s, x, i, o, u, c, p, y, l, d, f, g) { "use strict"; function v(t, e, r) { for (var n = t.chunk, a = t.valueMap, i = t.derivativeMap, o = t.backwardMask, u = e; u <= r; u++) { var c = n.getInstruction(u); if (o[u] && s.beginsBlock(c) && -1 !== c.endIndex) switch (c.type) { case x.BeginIntegral: u = _(t, u); continue; case x.BeginLoop: case x.BeginBroadcast: u = h(t, u); continue }a.push(m(t, u)), i.push(I(t, u)) } return r } function _(t, e) { var n = t.chunk, a = t.forwardMask, x = t.valueMap, i = t.derivativeMap, o = t.ZERO, u = n.getInstruction(e), c = u.endIndex, y = n.getInstruction(c), d = o; if (a[u.args[1]]) { var f = x[u.args[1]]; d = n.Add([d, n.Multiply([i[u.args[1]], l.substitute(n, f, e, y.args[1])])]) } if (a[u.args[0]]) { f = x[u.args[0]]; d = n.Subtract([d, n.Multiply([i[u.args[0]], l.substitute(n, f, e, y.args[1])])]) } if (function (t, e, r) { var n = t.getInstruction(e), a = t.getInstruction(n.endIndex); if (a.args[1] < e + 1) return r[a.args[1]]; for (var x = e + 1; x <= a.args[1]; x++) { var i = t.getInstruction(x); if (!s.isLeafInstruction(i)) for (var o = 0, u = i.args; o < u.length; o++) { var c = u[o]; if (c < e && r[c]) return !0 } } return !1 }(n, e, a)) { var g = x.slice(); g.push(p.copyInstructionWithArgs(n, u, [g[u.args[0]], g[u.args[1]]])), i.push(o), v(r.__assign(r.__assign({}, t), { valueMap: g, mustCopy: !0 }), e + 1, c - 1); var _ = p.copyInstructionWithArgs(n, y, [g[y.args[0]], i[y.args[1]]]); i.push(_), d = n.Add([d, p.copyInstructionWithArgs(n, n.getInstruction(c + 1), [_])]) } else for (var h = e; h <= c; h++)i.push(o); if (function (t, e, r) { for (var n = t.getInstruction(e), a = e; a <= n.endIndex; a++) { var x = t.getInstruction(a); if (!s.isLeafInstruction(x)) for (var i = 0, o = x.args; i < o.length; i++) { var u = o[i]; if (r[u] !== u) return !0 } } return !1 }(n, e, x)) { var I = r.__assign(r.__assign({}, t), { mustCopy: !0 }); for (h = e; h <= c + 1; h++)x.push(m(I, h)) } else for (h = e; h <= c + 1; h++)x.push(h); return i.push(d), c + y.args.length - 1 } function h(t, e) { var n = t.chunk, a = t.derivativeMap, s = t.valueMap, i = t.ZERO, o = n.getInstruction(e), u = o.endIndex, c = n.getInstruction(u); if (o.type === x.BeginBroadcast) s.push(p.copyInstructionWithArgs(n, o, o.args)), a.push(i); else { var y = []; y.push(s[o.args[0]], s[o.args[1]]); for (var l = 2; l < o.args.length; l++)y.push(s[o.args[l]], a[o.args[l]]); s.push(p.copyInstructionWithArgs(n, o, y)), a.push(i); for (l = 2; l < o.args.length; l++)s.push(p.copyInstructionWithArgs(n, n.getInstruction(e + l - 1), [s[e]])), a.push(p.copyInstructionWithArgs(n, n.getInstruction(e + l - 1), [s[e]])) } v(r.__assign(r.__assign({}, t), { mustCopy: !0 }), a.length, u - 1); var d = []; d.push(s[c.args[0]]); for (l = 1; l < c.args.length; l++)d.push(s[c.args[l]], a[c.args[l]]); s.push(p.copyInstructionWithArgs(n, c, d)), a.push(i); for (l = 1; l < c.args.length; l++)s.push(p.copyInstructionWithArgs(n, n.getInstruction(u + l), [s[u]])), a.push(p.copyInstructionWithArgs(n, n.getInstruction(u + l), [s[u]])); return u + c.args.length - 1 } function m(t, e) { var r = t.chunk, n = t.valueMap, a = t.mustCopy, x = r.getInstruction(e); if (s.isLeafInstruction(x)) return a ? p.copyInstruction(r, x) : e; for (var i = [], o = !1, u = 0, c = x.args; u < c.length; u++) { var y = c[u]; i.push(n[y]), n[y] !== y && (o = !0) } return o || a ? p.copyInstructionWithArgs(r, x, i) : e } function I(t, e) { var r = t.chunk, n = t.derivativeVarIndex, a = t.forwardMask, i = t.backwardMask, o = t.valueMap, u = t.derivativeMap, c = t.ZERO, l = t.ONE, f = t.NAN, v = r.getInstruction(e); if (!i[e]) return c; if (e === n) { if (y.isList(v.valueType)) { var _ = d.listLengthIndex(r, e), h = r.BeginBroadcast([_]), m = r.EndBroadcast([h, l]); return r.BroadcastResult(y.ListOfNumber, [m]) } return l } if (s.beginsBlock(v) || s.endsBlock(v) || v.type === x.BlockVar || v.type === x.BroadcastResult || v.type === x.Equal || v.type === x.Greater || v.type === x.Less || v.type === x.GreaterEqual || v.type === x.LessEqual || v.type === x.And || v.type === x.Distribution || v.type === x.ExtendSeed || v.type === x.Action) return c; if (!a[e] || s.isLeafInstruction(v)) return v.valueType !== y.Number ? r.Multiply([c, o[e]]) : v.type !== x.Constant || isFinite(g.asFloat(v.value)) ? c : f; if (v.type === x.List || v.type === x.OrderedPair) { for (var I = [], b = 0, M = v.args; b < M.length; b++) { var A = M[b]; I.push(u[A]) } return p.copyInstructionWithArgs(r, v, I) } if (v.type === x.Piecewise) return p.copyInstructionWithArgs(r, v, [o[v.args[0]], u[v.args[1]], u[v.args[2]]]); for (var q = c, w = [], E = 0, N = v.args; E < N.length; E++) { var k = N[E]; w.push(o[k]) } for (var L = 0; L < v.args.length; L++)if (a[v.args[L]]) { var O = u[v.args[L]]; if (O !== c) { var T = z(t, v, L, w, O); T !== c && (q = q === c ? T : r.Add([T, q])) } } return q } function z(t, r, n, s, i) { var u = t.chunk, y = t.ZERO, l = t.ONE, d = t.NAN; switch (r.type) { case x.Add: return i; case x.Subtract: switch (n) { case 0: return i; default: return u.Negative([i]) }case x.Multiply: switch (n) { case 0: return u.Multiply([i, s[1]]); default: return u.Multiply([s[0], i]) }case x.Divide: switch (n) { case 0: return u.Divide([i, s[1]]); default: return u.Multiply([s[0], u.Divide([u.Negative([i]), u.Multiply([s[1], s[1]])])]) }case x.Negative: return u.Negative([i]); case x.Exponent: case x.RawExponent: switch (n) { case 0: return u.Multiply([u.Multiply([s[1], u.Exponent([s[0], u.Subtract([s[1], l])])]), i]); default: return u.Multiply([u.Piecewise([u.Equal([s[0], y]), u.Piecewise([u.GreaterEqual([s[1], y]), y, d]), u.Multiply([u.SyntheticNativeFunction("ln", [s[0]]), u.Exponent([s[0], s[1]])])]), i]) }case x.NativeFunction: return function (t, r, n, s) { for (var x = Object.create(e), i = a.Scope({}, -1), u = 0; u < n.length; u++) { var p = b[u]; a.setSymbol(i, p, n[u]), x[p] = f.FRAME_SENTINEL } return a.setSymbol(i, "x_1", s), x.x_1 = f.FRAME_SENTINEL, c.addToIR(c.Ctx(o.defaultPolicy, x, t, i, void 0), r) }(u, A[r.symbol][n], s, i); case x.ListAccess: case x.DeferredListAccess: case x.InboundsListAccess: case x.OrderedPairAccess: switch (n) { case 0: return p.copyInstructionWithArgs(u, r, [i, s[1]]); default: return y }default: throw new Error("Unimplemented derivative for opcode " + r.type) } } Object.defineProperty(t, "__esModule", { value: !0 }), t.takeDerivative = void 0, t.takeDerivative = function (t, e, r) { var a = t.getInstruction(e); if (!y.isTypeOrListOfType(a.valueType, y.Number) && !y.isTypeOrListOfType(a.valueType, y.Point)) throw n.derivativeTypeError([y.prettyPrint(a.valueType)]); var o = t.getInstruction(r); if (!y.isTypeOrListOfType(o.valueType, y.Number) && o.type !== x.Noop) throw n.parseError(); var u = t.Constant(0); if (e < r) return u; for (var c = t.Constant(1), p = t.Constant(NaN), l = i.getDependencyMask(t, r), d = function (t, e) { for (var r = [], n = 0; n < e; n++)r.push(!1); r.push(!0); for (n = e; n >= 0; n--)if (r[n]) { var a = t.getInstruction(n); if (!s.isLeafInstruction(a)) if (a.type === x.Piecewise) r[a.args[1]] = !0, r[a.args[2]] = !0; else for (var i = 0, o = a.args; i < o.length; i++) { r[o[i]] = !0 } } return r }(t, e), f = [], g = [], _ = 0; _ < r; _++)g.push(_), f.push(u); return v({ chunk: t, derivativeVarIndex: r, forwardMask: l, backwardMask: d, valueMap: g, derivativeMap: f, mustCopy: !1, ZERO: u, ONE: c, NAN: p }, r, e), f[e] }; var b = ["x", "y", "z", "u"], M = { exp: ["\\exp(x)*x_1"], ln: ["\\{x >= 0: x_1/x \\}"], log: ["\\{x >= 0: x_1/(x*\\ln(10)) \\}"], sqrt: ["x_1/(2*\\sqrt{x})"], rtxsqpone: ["x*x_1/\\rtxsqpone(x)"], rtxsqmone: ["x*x_1/\\rtxsqmone(x)"], sin: ["\\cos(x)*x_1"], cos: ["-\\sin(x)*x_1"], tan: ["\\sec(x)^2*x_1"], arcsin: ["x_1/\\sqrt{1 - x^2}"], arccos: ["-x_1/\\sqrt{1 - x^2}"], sinh: ["\\cosh(x)*x_1"], cosh: ["\\sinh(x)*x_1"], tanh: ["(\\sech(x))^2*x_1"], arcsinh: ["x_1/\\sqrt{x^2 + 1}"], arccosh: ["\\{ x > 0: x_1/\\rtxsqmone(x) \\}"], arctanh: ["\\{ \\abs(x) < 1: x_1/(1 - x^2) \\}"], csc: ["-\\cot(x)*\\csc(x)*x_1"], sec: ["\\tan(x)*\\sec(x)*x_1"], cot: ["-\\csc(x)^2*x_1"], arccsc: ["-x_1/(\\abs(x)*\\rtxsqmone(x))"], arcsec: ["x_1/(\\abs(x)*\\rtxsqmone(x))"], arccot: ["-x_1/(1+x^2)"], csch: ["-\\coth(x)*\\csch(x)*x_1"], sech: ["-\\tanh(x)*\\sech(x)*x_1"], coth: ["-(\\csch(x))^2*x_1"], arccsch: ["-x_1/(\\abs(x)*\\rtxsqpone(x))"], arcsech: ["\\{ x >= 0: -x_1/(x*\\sqrt{1 - x^2}) \\}"], arccoth: ["\\{ \\abs(x) > 1 : x_1/(1 - x^2) \\}"], factorial: ["(x)!*\\polyGamma(0, x + 1)*x_1"], floor: ["\\{ \\mod(x, 1) > 0: 0*x_1 \\}"], ceil: ["\\{ \\mod(x, 1) > 0: 0*x_1 \\}"], round: ["\\{ \\abs(\\mod(x, 1) - 0.5) > 0: 0*x_1 \\}"], abs: ["\\{ \\abs(x) > 0: \\sign(x)*x_1 \\}"], sign: ["\\{ \\abs(x) > 0: 0*x_1 \\}"], distance: ["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/\\distance(x,y)", "((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/\\distance(x,y)"], mean: ["\\mean(x_1)"], total: ["\\total(x_1)"], length: ["0"], var: ["2*\\cov(x, x_1)"], varp: ["2*\\cov(x, x_1)*(\\length(x)-1)/\\length(x)"], stdev: ["\\cov(x, x_1)/\\stdev(x)"], stdevp: ["\\covp(x, x_1)/\\stdevp(x)"], mad: ["\\mean(\\sign(x-\\mean(x))*(x_1 - \\mean(x_1)))"], min: ["x_1[\\argmin(x)]"], max: ["x_1[\\argmax(x)]"], median: ["0.5*(x_1[\\lowerQuantileIndex(x, 0.5)] + x_1[\\upperQuantileIndex(x, 0.5)])"], argmin: ["0/0"], argmax: ["0/0"], gcd: ["0/0"], lcm: ["0/0"], erf: ["\\frac{2x_1}{\\sqrt{\\pi }}e^{-x^2}"], invNorm: ["\\frac{x_1}{\\pdf(\\normaldist(0,1),\\invNorm(x))}"], logbase: ["\\{x > 0: \\frac{x_1}{x*\\ln(y)} \\}", "\\frac{-\\log_{y}(x)*x_1}{y*\\ln(y)}"], nthroot: ["x^{1/y - 1}/y*x_1", "-\\frac{x^{1/y}*\\ln(x)*x_1}{y^2}"], hypot: ["x_1*x/\\hypot(x,y)", "x_1*y/\\hypot(x,y)"], polyGamma: ["0/0", "\\polyGamma(1 + x, y)*x_1"], mod: ["\\{ \\abs(\\mod(x, y)) > 0: x_1 \\}", "\\{ \\mod(x/y, 1) > 0: -\\floor(x/y)*x_1 \\}"], cov: ["\\cov(x_1, y)", "\\cov(x, x_1)"], covp: ["\\covp(x_1, y)", "\\covp(x, x_1)"], corr: ["(\\cov(x_1, y) - (\\cov(x, y)*\\cov(x, x_1)/\\var(x)))/(\\stdevp(x)\\stdevp(y))", "(\\cov(x, x_1) - (\\cov(x, y)*\\cov(y, x_1)/\\var(y)))/(\\stdevp(x)\\stdevp(y))"], spearman: ["0/0", "0/0"], quantile: ["\\{ \\floor(y*(\\length(x)-1)) = y*(\\length(x)-1) :   x_1[\\upperQuantileIndex(x, y)],  (\\ceil(y*(\\length(x)-1)) - y*(\\length(x)-1))*x_1[\\lowerQuantileIndex(x, y)] +   (y*(\\length(x)-1) - \\floor(y*(\\length(x)-1)))*x_1[\\upperQuantileIndex(x, y)]\\}", "\\{ \\floor(y*(\\length(x)-1)) < y*(\\length(x)-1) :   (x[\\upperQuantileIndex(x, y)] - x[\\lowerQuantileIndex(x, y)])*x_1\\}"], quartile: ["0.5*(x_1[\\lowerQuartileIndex(x, y)] + x_1[\\upperQuartileIndex(x, y)])", "0/0"], tscore: ["\\frac{\\sqrt{\\length(x)}(\\stdev(x)*\\mean(x_1)-(\\mean(x)-y)*\\frac{\\cov(x,x_1)}{\\stdev(x)})}{\\stdev(x)^2}", "-x_1*\\sqrt{\\length(x)}/\\stdev(x)"], quartileIndex: ["0/0", "0/0"], upperQuartileIndex: ["0/0", "0/0"], lowerQuartileIndex: ["0/0", "0/0"], upperQuantileIndex: ["0/0", "0/0"], lowerQuantileIndex: ["0/0", "0/0"], nCr: ["0/0", "0/0"], nPr: ["0/0", "0/0"], arctan: ["x_1*y/(y^2+x^2)", "-x_1*x/(y^2+x^2)"], poissonpdf: ["0/0", "x_1\\frac{e^{-y}(\\floor(x)-y)y^{(\\floor(x)-1)}}{(\\floor(x))!}"], invPoisson: ["0/0", "0/0"], tpdf: ["x_1*\\pdf(\\tdist(y),x)*\\frac{-(y+1)*x}{y+x^2}", "x_1*\\frac{1}{2}\\pdf(\\tdist(y),x)(  \\frac{x^2-1}{y + x^2} + \\ln(\\frac{y}{y + x^2}) +   \\polyGamma(0, \\frac{1+y}{2}) - \\polyGamma(0, y/2))"], invT: ["x_1/\\pdf(\\tdist(y),\\invT(x, y))", "0/0"], tcdf: ["-x_1*\\pdf(\\tdist(z),x)", "x_1*\\pdf(\\tdist(z),y)", "0/0"], poissoncdf: ["0/0", "0/0", "x_1\\sum _{n=\\max(0,\\floor(\\min(x,y)))}^{\\floor(\\max(x,y))}\\frac{e^{-z}(n-z)z^{(n-1)}}{n!}"], normalpdf: ["-x_1*\\frac{x-y}{z^2} \\pdf(\\normaldist(y,z),x)", "x_1*\\frac{x-y}{z^2} \\pdf(\\normaldist(y,z),x)", "x_1*(\\frac{(x-y-z)*(x-y+z)}{z^3}) \\pdf(\\normaldist(y,z),x)"], binompdf: ["0/0", "0/0", "\\{0<=z<=1: x_1*\\pdf(\\binomialdist(y,z),x)*(\\frac{\\round(x)}{z}-\\frac{\\round(y)-\\round(x)}{1-z}), 0 \\}"], invBinom: ["0/0", "0/0", "0/0"], uniformpdf: ["0", "\\{y<=x: \\frac{x_1}{(z-y)^2}, 0\\}", "\\{z>=x: -\\frac{x_1}{(z-y)^2}, 0\\}"], invUniform: ["\\{y<=x<=z: x_1*(z-y), 0\\}", "\\{y<=x<=z: x_1*(1-x), 0\\}", "\\{y<=x<=z: x_1*x, 0\\}"], normalcdf: ["-x_1\\pdf(\\normaldist(z,u), x)", "x_1\\pdf(\\normaldist(z,u), y)", "-x_1*(\\pdf(\\normaldist(z,u), y) - \\pdf(\\normaldist(z,u), x))", "x_1*(  \\{\\abs(y)=1/0:0,\\frac{z-y}{u}\\pdf(\\normaldist(z,u),y)\\} -   \\{\\abs(x)=1/0:0,\\frac{z-x}{u}\\pdf(\\normaldist(z,u),x)\\})"], binomcdf: ["0/0", "0/0", "0/0", "\\{0<=u<=1: x_1*\\sum _{n=\\max(0,\\round(\\min(x,y)))}^{\\round(\\max(x,y))}(  \\pdf(\\binomialdist(z,u),n)*(\\frac{n}{u}-\\frac{\\round(z)-n}{1-u})), 0 \\}"], uniformcdf: ["\\{z>u: 0/0, -x_1\\pdf(\\uniformdist(z,u), x)\\}", "\\{z>u: 0/0, x_1\\pdf(\\uniformdist(z,u), y)\\}", "\\{z>u: 0/0, x_1*(\\frac{\\{z<x<u:u-x,0\\} + \\{z<y<u:y-u,0\\}}{(u-z)^2})\\}", "\\{z>u: 0/0, x_1*(\\frac{\\{z<x<u:x-z,0\\} + \\{z<y<u:z-y,0\\}}{(u-z)^2})\\}"], normalSample: ["0/0", "0/0", "0/0"], uniformSample: ["0/0", "0/0", "0/0"], tSample: ["0/0", "0/0"], poissonSample: ["0/0", "0/0"], binomSample: ["0/0", "0/0", "0/0"], rgb: ["0/0", "0/0", "0/0"], hsv: ["0/0", "0/0", "0/0"], polygon: ["\\polygon(x_1)"], validateRangeLength: ["0", "0", "0", "\\{\\validateRangeLength(x,y,z,u) \\ge 1: x_1, 0\\}"], validateSampleCount: ["\\{x<0:0,1\\}*x_1"], select: ["\\select(x_1, y)", "0*\\select(x,y)"], shuffle: ["0*y", "\\shuffle(x, x_1)"], sortPerm: ["0*x"], elementsAt: ["\\elementsAt(x_1, y)", "0*\\elementsAt(x,y)"], uniquePerm: ["0*\\uniquePerm(x)"] }, A = {}; for (var q in M) { for (var w = q, E = M[w], N = [], k = 0; k < E.length; k++) { var L = E[k]; N.push(u.parse(L, {})) } A[w] = N } });
define('core/math/ir/features/bound-domain', ["require", "exports", "core/math/domaintypes", "core/math/types", "core/math/maybe-rational", "../opcodes", "./polynomial-order", "./get-polynomial-coefficients", "../instructions", "./is-constant", "./as-value"], function (require, e, a, n, t, r, s, i, o, c, u) { "use strict"; function l(e, m) { var f = e.domainTable, d = f[m]; if (void 0 !== d) return d; var v = function (e, m) { var f = e.chunk, d = e.mask, v = e.orderCtx, p = f.getInstruction(m); if (o.isLeafInstruction(p)) { if (p.type === r.Constant) if (p.valueType == n.Number) { if (isNaN(t.asFloat(p.value))) return a.emptyDomain() } else if (p.valueType === n.ListOfNumber) for (var y = 0, g = p.value; y < g.length; y++) { var D = g[y]; if (isNaN(t.asFloat(D))) return a.unknownDomain() } return a.allReals() } switch (p.type) { case r.And: case r.Add: case r.Subtract: case r.Multiply: case r.Divide: case r.Exponent: case r.RawExponent: case r.Negative: case r.BlockVar: case r.BroadcastResult: case r.OrderedPair: case r.OrderedPairAccess: case r.NativeFunction: case r.Distribution: case r.BeginIntegral: case r.EndIntegral: case r.BeginBroadcast: case r.EndBroadcast: case r.BeginLoop: case r.EndLoop: case r.ListAccess: case r.DeferredListAccess: case r.InboundsListAccess: case r.ExtendSeed: case r.Action: for (var k = a.allReals(), b = 0, N = p.args; b < N.length; b++) { var w = N[b]; k = a.intersectDomains(k, l(e, w)) } return k; case r.List: if (!d[m]) return a.allReals(); var C = l(e, p.args[0]); if ("known" !== C.type) return a.unknownDomain(); for (var h = 1; h < p.args.length; h++) { if ("known" !== (k = l(e, p.args[h])).type) return a.unknownDomain(); if (k.bounds[0] !== C.bounds[0] || k.bounds[1] !== C.bounds[1]) return a.unknownDomain() } return C; case r.Equal: return d[m] ? a.unknownDomain() : a.allReals(); case r.Piecewise: var x = f.getInstruction(p.args[2]); return x.type === r.Constant && x.valueType === n.Number && isNaN(t.asFloat(x.value)) ? a.intersectDomains(l(e, p.args[0]), l(e, p.args[1])) : a.unknownDomain(); case r.Less: case r.Greater: case r.LessEqual: case r.GreaterEqual: if (!d[m]) return a.allReals(); if (s.instructionOrder(v, m) > 1) return a.unknownDomain(); var E = e.coefficientCtx; void 0 === E && (E = i.polynomialCoefficientContext(v), e.coefficientCtx = E); var L = E.newChunk, R = i.instructionCoefficients(E, m), B = R[0], I = R[1]; if (!c.isConstant(L.getInstruction(B))) return a.unknownDomain(); var A = u.asValue(L, B); if (isNaN(A)) return a.emptyDomain(); for (var O = a.allReals(), q = 0, T = p.args; q < T.length; q++) { w = T[q]; O = a.intersectDomains(O, l(e, w)) } if (void 0 === I) return p.type === r.LessEqual || p.type === r.GreaterEqual ? A >= 0 ? O : a.emptyDomain() : A > 0 ? O : a.emptyDomain(); var F = u.asValue(L, I); return a.intersectDomains(O, a.linearPositiveDomain(A, F)) } }(e, m); return f[m] = v, v } Object.defineProperty(e, "__esModule", { value: !0 }), e.boundDomain = void 0, e.boundDomain = function (e, i, o) { var c = e.argNames.indexOf(i); if (-1 === c) { var u = e.getInstruction(o); return u.type === r.Constant && u.valueType === n.Number && isNaN(t.asFloat(u.value)) ? a.emptyDomain() : a.allReals() } return l(function (e) { var a = e.chunk, n = e.mask; return { chunk: a, mask: n, orderCtx: e, domainTable: [] } }(s.polynomialOrderContext(e, c, { allowRestriction: !0, allowClosedBlockReferences: !1 })), o) } });
define('core/math/ir/features/find-linear-subset', ["require", "exports", "../opcodes", "core/math/types", "../instructions"], function (require, e, r, s, a) { "use strict"; function t(e, r, s) { var t = e.getInstruction(s), n = function (e) { for (var r = [], s = 0; s < e; s++)r.push(!1); return r }(e.argNames.length); if (a.isLeafInstruction(t)) return n; for (var c = 0, u = t.args; c < u.length; c++)for (var o = r[u[c]], i = 0; i < o.length; i++)n[i] = n[i] || o[i]; return n } function n(e, s, t, n) { var u = e.getInstruction(n); if (a.isLeafInstruction(u)) return c(e.argNames.length); switch (u.type) { case r.Add: case r.Subtract: case r.Negative: case r.List: for (var o = c(e.argNames.length), i = 0; i < u.args.length; i++)for (var g = t[u.args[i]], d = 0; d < g.length; d++)o[d] = o[d] && g[d]; return o; case r.Divide: for (var f = [], h = t[u.args[0]], l = s[u.args[1]], p = 0; p < h.length; p++)f.push(h[p] && !l[p]); return f; case r.Multiply: for (var v = t[u.args[0]].slice(), L = t[u.args[1]].slice(), E = s[u.args[0]], I = s[u.args[1]], N = 0, m = 0, b = 0; b < v.length; b++) { var x = v[b] && !I[b], A = L[b] && !E[b]; v[b] = x, L[b] = A, x && (N += 1), A && (m += 1) } return N >= m ? v : L; case r.Piecewise: var B = s[u.args[0]], y = t[u.args[1]], w = t[u.args[2]], q = []; for (n = 0; n < B.length; n++)q.push(!B[n] && y[n] && w[n]); return q; case r.ListAccess: case r.DeferredListAccess: case r.InboundsListAccess: var P = t[u.args[0]], S = s[u.args[1]], D = []; for (n = 0; n < S.length; n++)D.push(P[n] && !S[n]); return D; case r.BroadcastResult: var O = u.args[0], G = n - O; return t[e.getInstruction(O).args[G]]; case r.OrderedPair: case r.OrderedPairAccess: case r.Exponent: case r.RawExponent: case r.Less: case r.LessEqual: case r.Greater: case r.GreaterEqual: case r.Equal: case r.And: case r.NativeFunction: case r.Distribution: case r.BeginIntegral: case r.EndIntegral: case r.BeginLoop: case r.EndLoop: case r.BeginBroadcast: case r.EndBroadcast: case r.BlockVar: case r.ExtendSeed: case r.Action: for (var M = [], R = 0, _ = s[n]; R < _.length; R++) { var j = _[R]; M.push(!j) } return M; default: throw new Error("Unexpected opcode " + u.type) } } function c(e) { for (var r = [], s = 0; s < e; s++)r.push(!0); return r } Object.defineProperty(e, "__esModule", { value: !0 }), e.findLinearSubset = void 0, e.findLinearSubset = function (e) { for (var r = [], a = [], c = 0; c < e.argNames.length; c++) { for (var u = [], o = [], i = 0; i < e.argNames.length; i++)u.push(e.argTypes[i] === s.Number), o.push(c === i); a.push(o), r.push(u) } for (c = e.argNames.length; c <= e.returnIndex; c++)a.push(t(e, a, c)), r.push(n(e, a, r, c)); return r[e.returnIndex] } });
define('core/math/ir/features/derive-regression-restrictions', ["require", "exports", "../opcodes", "core/math/types", "../instructions", "./is-constant", "./as-value", "./polynomial-order", "./get-polynomial-coefficients", "core/math/domaintypes", "./list-length"], function (require, n, e, t, i, o, r, s, a, u, c) { "use strict"; function l(n, e, t, i, o, r) { if ("known" !== e.type) return t; if (e.bounds[0] === -1 / 0 && e.bounds[1] === 1 / 0) return t; var s = n.And([n.LessEqual([n.Constant(e.bounds[0]), i]), n.LessEqual([i, n.Constant(e.bounds[1])])]); return n.Multiply([t, n.Piecewise([s, o, r])]) } function f(n, e) { for (var t = [], i = 0; i < n.argNames.length; i++)t.push(i); var o = []; for (i = 0; i <= e; i++)o.push(p(n, t, o, i)); return o[e] } function g(n) { return n.type === e.NativeFunction && ("sin" === n.symbol || "cos" === n.symbol) } function v(n) { for (var e = 1 / 0, t = -1 / 0, i = n.length, o = 0, r = n; o < r.length; o++) { var s = r[o]; e = Math.min(e, s), t = Math.max(t, s) } return { min: e, max: t, length: i } } function p(n, e, t, o) { for (var r = n.getInstruction(o), s = function (n) { for (var e = [], t = 0; t < n; t++)e.push(!1); return e }(e.length), a = 0; a < e.length; a++)if (e[a] === o) return s[a] = !0, s; if (i.isLeafInstruction(r)) return s; for (var u = 0, c = r.args; u < c.length; u++)for (var l = t[c[u]], f = 0; f < l.length; f++)s[f] = s[f] || l[f]; return s } Object.defineProperty(n, "__esModule", { value: !0 }), n.deriveRegressionRestrictions = void 0, n.deriveRegressionRestrictions = function (n) { var i = n.getInstruction(n.returnIndex); if (i.type !== e.BroadcastResult) return n; var h = i.args[0], d = n.returnIndex - h, m = n.getInstruction(h), C = m.args[0], y = m.args[d], w = [], x = []; w.push(C); var I = c.assertConstantListLength(n, n.returnIndex, "Programming error: cannot optimize regression on non-constant-length list"); x.push({ min: 1, max: I, length: I }); for (var k = !1, R = !1, b = C + 1; b <= y; b++) { if ((W = n.getInstruction(b)).type === e.ListAccess || W.type === e.InboundsListAccess || W.type === e.DeferredListAccess) { if (W.args[1] !== C) continue; var L = W.args[0]; if (n.getInstruction(L).valueType !== t.ListOfNumber) continue; if (!o.isConstant(n.getInstruction(L))) continue; var D = v(r.asValue(n, L)); if (!isFinite(D.min) || !isFinite(D.max)) continue; w.push(b), x.push(D) } else g(W) ? k = !0 : W.type !== e.Exponent && W.type !== e.RawExponent || (R = !0) } if (0 === w.length) return n; if (!R && !k) return n; var O = [], P = []; for (b = 0; b < n.argNames.length; b++)P.push(b), O.push(u.allReals()); var N = [], B = []; for (b = 0; b <= y; b++)N.push(p(n, P, N, b)), B.push(p(n, w, B, b)); for (b = 0; b <= y; b++) { if ((W = n.getInstruction(b)).type === e.Piecewise) for (var E = N[b], F = 0; F < E.length; F++)E[F] && (O[F] = u.unknownDomain()); else if (W.type === e.Exponent || W.type === e.RawExponent) { var M = !1, V = !1; for (F = 0; F < w.length; F++)B[W.args[0]][F] && (M = !0), B[W.args[1]][F] && (V = !0); if (M) continue; if (!V) continue; E = N[W.args[0]]; var A = 0, q = void 0; for (F = 0; F < E.length; F++)E[F] && (q = F, A += 1); if (1 !== A) continue; if (void 0 === q) continue; var _ = P[q], j = s.polynomialOrderContext(n.copy().reopenFinalBlock(), _, { allowRestriction: !1, allowClosedBlockReferences: !1 }); if (1 !== s.instructionOrder(j, W.args[0])) continue; var z = a.polynomialCoefficientContext(j), T = a.instructionCoefficients(z, W.args[0]), G = T[0]; if (void 0 === (en = T[1])) continue; var H = r.asValue(z.newChunk, en), J = r.asValue(z.newChunk, G); O[q] = u.intersectDomains(O[q], u.linearPositiveDomain(J, H)) } } if (k) for (var K = n.copy().reopenFinalBlock(), Q = 0; Q < w.length; Q++) { var S = s.polynomialOrderContext(K, w[Q], { allowRestriction: !1, allowClosedBlockReferences: !1 }), U = a.polynomialCoefficientContext(S); for (b = C + 1; b <= y; b++) { var W; if (g(W = K.getInstruction(b))) { var X = W.args[0]; if (1 !== s.instructionOrder(S, X)) continue; var Y = a.instructionCoefficients(U, X)[1]; if (void 0 === Y) continue; var Z = f(U.newChunk, Y), $ = (q = void 0, 0); for (F = 0; F < Z.length; F++)Z[F] && (q = F, $ += 1); if (1 !== $) continue; if (void 0 === q) continue; var nn = s.polynomialOrderContext(U.newChunk, q, { allowRestriction: !1, allowClosedBlockReferences: !1 }); if (1 !== s.instructionOrder(nn, Y)) continue; var en, tn = a.polynomialCoefficientContext(nn), on = a.instructionCoefficients(tn, Y); G = on[0]; if (void 0 === (en = on[1]) || !o.isConstant(tn.newChunk.getInstruction(G)) || !o.isConstant(tn.newChunk.getInstruction(en))) continue; J = r.asValue(tn.newChunk, G), H = r.asValue(tn.newChunk, en); var rn = (x[Q].max - x[Q].min) / Math.min(x[Q].length - 1, 31), sn = Math.PI / rn; if (!isFinite(sn)) continue; if (sn <= 0) continue; O[q] = u.intersectDomains(O[q], u.linearPositiveDomain(J, H)), O[q] = u.intersectDomains(O[q], u.linearPositiveDomain(sn - J, -H)) } } } for (var an = !1, un = 0, cn = O; un < cn.length; un++) { var ln = cn[un]; if ("known" !== ln.type) return n; ln.bounds[0] === -1 / 0 && ln.bounds[1] === 1 / 0 || (an = !0) } if (!an) return n; var fn = n.copy(), gn = n.returnIndex, vn = fn.Constant(1), pn = fn.Constant(NaN); for (F = 0; F < fn.argNames.length; F++)gn = l(fn, O[F], gn, F, vn, pn); return fn.close(), fn } });
define('core/math/ir/chunk', ["require", "exports", "core/math/errormsg", "core/math/types", "core/math/maybe-rational", "core/math/functions", "./opcodes", "./builtin-table", "./features/constant-collapse", "./features/type-check", "./features/emit-js", "./features/get-value-type", "./features/is-constant", "./features/list-length", "./features/drop-unreferenced-instructions", "./features/convert-to-broadcast", "./features/print", "./features/to-dot", "./features/fuse-broadcast", "./features/polynomial-order", "./features/get-polynomial-coefficients", "./features/copy-instruction", "./features/lift-point-operations", "./features/element-at", "./features/take-derivative", "./features/bound-domain", "./features/find-linear-subset", "./features/derive-regression-restrictions", "./features/as-value", "./features/depends-on-outer-variable", "./features/nan-of-type", "./features/find-dependency-symbols"], function (require, t, e, n, r, s, i, o, u, a, p, c, h, y, l, g, f, d, v, I, T, m, b, L, x, k, V, C, A, B, N, D) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Chunk = void 0; var E = 1e4, S = function () { function t(t) { if (this.instructions = [], this.blockMask = [], this.comments = [], t.argNames.length !== t.argTypes.length) throw new Error("Programming Error: length of argNames must match length of argTypes"); this.argNames = t.argNames, this.argTypes = t.argTypes; for (var e = 0; e < this.argTypes.length; e++) { var n = this.argTypes[e]; this.LoadArg(n) } this.returnIndex = -1 } return t.prototype.addComments = function (t) { for (var e in t) { var n = this.comments[e] || ""; this.comments[e] = n + t[e] } return this }, t.prototype.instructionsLength = function () { return this.instructions.length }, t.prototype.getInstruction = function (t) { return this.instructions[t] }, t.prototype.popInstruction = function () { return this.instructions.pop() }, t.prototype.truncate = function (t) { this.instructions.length = t, this.blockMask.length = t, this.comments.length = t }, t.prototype.pushInstructionChecked = function (t) { if (this.instructions.length >= 32768) throw e.deeplyNested(); this.instructions.push(t), this.returnIndex = this.instructions.length - 1 }, t.prototype.pushLeafInstruction = function (t) { return this.pushInstructionChecked(t), this.returnIndex }, t.prototype.pushInstruction = function (t) { return this.checkInstructionArguments(t), this.pushInstructionChecked(t), this.returnIndex = g.convertToBroadcast(this), this.returnIndex = b.liftPointOperations(this), a.typeCheck(this, this.returnIndex), this.returnIndex = u.constantCollapse(this), this.returnIndex }, t.prototype.checkInstructionArguments = function (t) { for (var e = 0, n = t.args; e < n.length; e++) { var r = n[e]; if (this.blockMask[r]) throw new Error("Programming Error: cannot reference an instruction in a closed block") } }, t.prototype.markClosedBlock = function (t, e) { for (var n = t; n < e; n++)this.blockMask[n] = !0 }, t.prototype.LoadArg = function (t) { return this.pushLeafInstruction({ type: i.LoadArg, valueType: t }) }, t.prototype.BlockVar = function (t, e) { return this.pushInstruction({ type: i.BlockVar, valueType: t, args: e }) }, t.prototype.SymbolicVar = function (t, e) { return this.pushLeafInstruction({ type: i.SymbolicVar, valueType: t, symbol: e }) }, t.prototype.BroadcastResult = function (t, e) { var n = e[0], r = this.instructions[n], s = r.args[0], o = this.instructions.length - n, u = r.args[o], a = !B.dependsOnOuterVariable(this, u, s), p = this.getInstruction(s).args[0], c = this.getInstruction(p); return this.pushInstruction({ type: i.BroadcastResult, valueType: t, args: e, isConstantBroadcast: a, constantLength: h.isConstant(c) ? A.asValue(this, p) : void 0 }) }, t.prototype.Constant = function (t) { return this.ConstantOfType(n.Number, t) }, t.prototype.ConstantOfType = function (t, s) { if ("number" == typeof s && (s = r.maybeRational(s, 1)), n.isList(t) && s.length > E) throw e.maxListSize(E.toLocaleString()); return this.pushLeafInstruction({ type: i.Constant, valueType: t, value: s }) }, t.prototype.NanOfType = function (t) { if (t === n.Distribution) { var e = this.Constant(NaN); return this.Distribution("uniformdist", [e, e]) } return this.ConstantOfType(t, N.nanOfType(t)) }, t.prototype.Add = function (t) { var e = i.Add, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Subtract = function (t) { var e = i.Subtract, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Multiply = function (t) { var e = i.Multiply, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Divide = function (t) { var e = i.Divide, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Exponent = function (t) { var e = i.Exponent, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.RawExponent = function (t) { var e = i.RawExponent, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Negative = function (t) { var e = i.Negative, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Equal = function (t) { var e = i.Equal, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Less = function (t) { var e = i.Less, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Greater = function (t) { var e = i.Greater, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.LessEqual = function (t) { var e = i.LessEqual, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.GreaterEqual = function (t) { var e = i.GreaterEqual, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.And = function (t) { var e = i.And, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.Piecewise = function (t) { var e = i.Piecewise, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.OrderedPair = function (t) { var e = i.OrderedPair, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.OrderedPairAccess = function (t) { var e = i.OrderedPairAccess, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.List = function (t) { var n = i.List, r = c.getValueType(this, n, t); if (t.length > E) throw e.maxListSize(E.toLocaleString()); return this.pushInstruction({ type: n, valueType: r, args: t }) }, t.prototype.ListAccess = function (t) { var e = i.ListAccess, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.DeferredListAccess = function (t) { var e = i.DeferredListAccess, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.InboundsListAccess = function (t) { var e = i.InboundsListAccess, n = c.getValueType(this, e, t); return this.pushInstruction({ type: e, valueType: n, args: t }) }, t.prototype.NativeFunction = function (t, e, n) { var r = this, s = i.NativeFunction, u = o.BuiltInTable[t].returnType, a = "function" == typeof u ? u(n.map(function (t) { return r.getInstruction(t).valueType })) : u; return this.pushInstruction({ type: s, valueType: a, args: n, symbol: t, callData: e }) }, t.prototype.SyntheticNativeFunction = function (t, e) { var n = this, r = i.NativeFunction, s = o.BuiltInTable[t].returnType, u = "function" == typeof s ? s(e.map(function (t) { return n.getInstruction(t).valueType })) : s, a = { errorSymbol: t, providedArity: e.length, isDotCall: !1 }; return this.pushInstruction({ type: r, valueType: u, args: e, symbol: t, callData: a }) }, t.prototype.Distribution = function (t, e) { var r = i.Distribution, s = n.Distribution; return this.pushInstruction({ type: r, valueType: s, args: e, symbol: t }) }, t.prototype.BeginIntegral = function (t, e) { var n = i.BeginIntegral, r = c.getValueType(this, n, []); return this.pushInstruction({ type: n, valueType: r, args: e, endIndex: -1, callData: t }) }, t.prototype.EndIntegral = function (t) { var e = i.EndIntegral, n = c.getValueType(this, e, t), r = t[0], s = this.getInstruction(r); this.instructions[r] = { type: s.type, valueType: s.valueType, args: s.args, endIndex: this.instructionsLength(), callData: s.callData }; var o = this.pushInstruction({ type: e, valueType: n, args: t }); return this.markClosedBlock(r, o), o }, t.prototype.BeginBroadcast = function (t, n) { var r = i.BeginBroadcast, s = c.getValueType(this, r, []), o = this.getInstruction(t[0]); if (h.isConstant(o) && A.asValue(this, t[0]) > E) throw e.maxListSize(E.toLocaleString()); return this.pushInstruction({ type: r, valueType: s, endIndex: -1, args: t, listComprehensionCallData: n }) }, t.prototype.EndBroadcast = function (t) { var e = i.EndBroadcast, n = c.getValueType(this, e, t), r = t[0], s = this.getInstruction(r), o = { type: s.type, valueType: s.valueType, args: s.args, endIndex: this.instructionsLength() }; this.instructions[r] = o; var u = this.pushInstruction({ type: e, valueType: n, args: t }); return this.markClosedBlock(r, u), u }, t.prototype.BeginLoop = function (t, e) { var n = i.BeginLoop, r = c.getValueType(this, n, e); return this.pushInstruction({ type: n, valueType: r, args: e, endIndex: -1, callData: t }) }, t.prototype.EndLoop = function (t) { var e = i.EndLoop, n = c.getValueType(this, e, t), r = t[0], s = this.getInstruction(r); this.instructions[r] = { type: s.type, valueType: s.valueType, args: s.args, endIndex: this.instructionsLength(), callData: s.callData }; var o = this.pushInstruction({ type: e, valueType: n, args: t }); return this.markClosedBlock(r, o), o }, t.prototype.ExtendSeed = function (t, e) { var r = i.ExtendSeed, s = n.SeedType; return this.pushInstruction({ type: r, valueType: s, args: e, tag: t }) }, t.prototype.Noop = function () { var t = i.Noop, e = n.Any; return this.pushLeafInstruction({ type: t, valueType: e }) }, t.prototype.Action = function (t, e) { return this.pushInstruction({ type: i.Action, valueType: n.Action, args: e, symbols: t }) }, t.prototype.replaceInstructionWithConstant = function (t, e) { this.instructions[t] = e, this.blockMask[t] = void 0 }, t.prototype.replaceInstructionWithBlockVar = function (t, e) { this.instructions[t] = e }, t.prototype.reopenFinalBlock = function () { var t = this.getInstruction(this.returnIndex); if (t.type !== i.BroadcastResult) return this; for (var e = t.args[0], n = this.getInstruction(e).args[0]; n < e; n++)this.blockMask[n] = void 0; return this.truncate(e), this }, t.prototype.isInClosedBlock = function (t) { return this.blockMask[t] }, t.prototype.copy = function () { var e = new t({ argNames: this.argNames, argTypes: this.argTypes }); return e.instructions = this.instructions.slice(), e.blockMask = this.blockMask.slice(), e.comments = this.comments.slice(), e.returnIndex = this.returnIndex, e }, t.prototype.close = function () { return this.returnIndex = v.fuseBroadcast(this, this.returnIndex), l.dropUnreferencedInstructions(this), this }, t.prototype.copyInstruction = function (t) { return m.copyInstruction(this, t) }, t.prototype.copyInstructionWithArgs = function (t, e) { return m.copyInstructionWithArgs(this, t, e) }, t.prototype.replaceInstructionWithNoop = function (t) { this.instructions[t] = { type: i.Noop, valueType: n.Any } }, t.prototype.getReturnType = function () { return this.instructions[this.returnIndex].valueType }, t.prototype.isConstant = function () { return h.isConstant(this.instructions[this.returnIndex]) }, t.prototype.asValue = function () { return A.asValue(this, this.returnIndex) }, t.prototype.asCompilerValue = function () { var t = this.instructions[this.returnIndex]; switch (t.type) { case i.Constant: return t.value; default: throw new Error("Unexpected opcode " + t.type + ".") } }, t.prototype.getConstantListLength = function () { return y.getConstantListLength(this, this.returnIndex) }, t.prototype.getListLengthDependencies = function () { var t = this.copy(), e = y.listLengthIndex(t, t.returnIndex); return D.findDependencySymbols(t, e) }, t.prototype.elementAt = function (t) { var e = this.copy(), n = e.returnIndex; return e.returnIndex = L.elementAt(e, n, t), e.close(), e }, t.prototype.getCompiledFunction = function (t) { var e; if (t) { e = t.slice(); for (var n = 0, r = this.argNames; n < r.length; n++) { var i = r[n]; -1 === e.indexOf(i) && e.push(i) } } else e = this.argNames; var o = p.emitJS(this), u = o.source, a = o.constants; return { args: e, source: u, constants: a, fn: s.closureFunctionWithBuiltIn(e, u, a) } }, t.prototype.polynomialOrder = function (t, e) { return I.polynomialOrder(this, t, e) }, t.prototype.getPolynomialCoefficients = function (t) { return T.getPolynomialCoefficients(this, t) }, t.prototype.takeDerivative = function (t) { var e = this.copy(), n = this.argNames.indexOf(t); return -1 === n ? (e.Constant(0), e.close(), e) : (e.returnIndex = x.takeDerivative(e, e.returnIndex, n), e.close(), e) }, t.prototype.deriveRegressionRestrictions = function () { return C.deriveRegressionRestrictions(this) }, t.prototype.boundDomain = function (t) { return k.boundDomain(this, t, this.returnIndex) }, t.prototype.findLinearSubset = function (t) { for (var e = V.findLinearSubset(this), n = [], r = 0, s = t; r < s.length; r++) { var i = s[r], o = this.argNames.indexOf(i); if (-1 === o) throw new Error("Programming Error: findLinearSubset called with a non-dependency"); n.push(e[o]) } return n }, t.prototype.print = function () { return f.print(this) }, t.prototype.printInstruction = function (t) { return f.printInstruction(this, t) }, t.prototype.toDot = function () { return d.default(this) }, t.prototype.getLiveArgNames = function () { for (var t = [], e = 0; e < this.argNames.length; e++) { this.instructions[e].type === i.LoadArg && t.push(this.argNames[e]) } return t }, t }(); t.Chunk = S });
define('core/math/ir/distribution-table', ["require", "exports", "./features/list-length"], function (require, t, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.randomSampleFromList = t.DistributionTable = void 0, t.DistributionTable = { normaldist: { pdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("normalpdf", i.concat(r.args)) }, cdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("normalcdf", i.concat(r.args)) }, mean: function (t, n, i) { return t.getInstruction(n).args[0] }, median: function (n, i, r) { return t.DistributionTable.normaldist.mean(n, i, r) }, stdev: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("abs", [r.args[1]]) }, var: function (t, n, i) { var r = t.getInstruction(n); return t.Multiply([r.args[1], r.args[1]]) }, quantile: function (t, n, i) { var r = t.getInstruction(n); return t.Add([t.Multiply([t.SyntheticNativeFunction("invNorm", i), t.SyntheticNativeFunction("abs", [r.args[1]])]), r.args[0]]) }, random: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("normalSample", [i[0], r.args[0], r.args[1]]) } }, tdist: { pdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("tpdf", i.concat(r.args)) }, cdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("tcdf", i.concat(r.args)) }, mean: function (t, n, i) { return t.Constant(0) }, median: function (t, n, i) { return t.Constant(0) }, stdev: function (n, i, r) { return n.SyntheticNativeFunction("sqrt", [t.DistributionTable.tdist.var(n, i, r)]) }, var: function (t, n, i) { var r = t.getInstruction(n), e = t.Constant(2), a = r.args[0]; return t.Piecewise([t.GreaterEqual([a, e]), t.Divide([a, t.Subtract([a, e])]), t.Constant(NaN)]) }, quantile: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("invT", [i[0], r.args[0]]) }, random: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("tSample", [i[0], r.args[0]]) } }, poissondist: { pdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("poissonpdf", i.concat(r.args)) }, cdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("poissoncdf", i.concat(r.args)) }, mean: function (t, n, i) { return t.getInstruction(n).args[0] }, median: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("invPoisson", [t.Constant(.5), r.args[0]]) }, stdev: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("sqrt", [r.args[0]]) }, var: function (n, i, r) { return t.DistributionTable.poissondist.mean(n, i, r) }, quantile: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("invPoisson", [i[0], r.args[0]]) }, random: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("poissonSample", [i[0], r.args[0]]) } }, binomialdist: { pdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("binompdf", i.concat(r.args)) }, cdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("binomcdf", i.concat(r.args)) }, mean: function (t, n, i) { var r = t.getInstruction(n); return t.Multiply([r.args[0], r.args[1]]) }, median: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("invBinom", [t.Constant(.5), r.args[0], r.args[1]]) }, stdev: function (n, i, r) { return n.SyntheticNativeFunction("sqrt", [t.DistributionTable.binomialdist.var(n, i, r)]) }, var: function (t, n, i) { var r = t.getInstruction(n).args, e = r[0], a = r[1]; return t.Multiply([e, t.Multiply([a, t.Subtract([t.Constant(1), a])])]) }, quantile: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("invBinom", [i[0], r.args[0], r.args[1]]) }, random: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("binomSample", [i[0], r.args[0], r.args[1]]) } }, uniformdist: { pdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("uniformpdf", i.concat(r.args)) }, cdf: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("uniformcdf", i.concat(r.args)) }, mean: function (t, n, i) { var r = t.getInstruction(n); return t.Divide([t.Add([r.args[0], r.args[1]]), t.Constant(2)]) }, median: function (n, i, r) { return t.DistributionTable.uniformdist.mean(n, i, r) }, stdev: function (n, i, r) { return n.SyntheticNativeFunction("sqrt", [t.DistributionTable.uniformdist.var(n, i, r)]) }, var: function (t, n, i) { var r = t.getInstruction(n), e = t.Subtract([r.args[1], r.args[0]]); return t.Divide([t.Multiply([e, e]), t.Constant(12)]) }, quantile: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("invUniform", [i[0], r.args[0], r.args[1]]) }, random: function (t, n, i) { var r = t.getInstruction(n); return t.SyntheticNativeFunction("uniformSample", [i[0], r.args[0], r.args[1]]) } } }, t.randomSampleFromList = function (t, i, r) { var e = r[0], a = t.Constant(0), o = t.Constant(1); if (0 === n.getConstantListLength(t, i)) return t.Constant(NaN); var u = n.listLengthIndex(t, i); return t.InboundsListAccess([i, t.Add([t.SyntheticNativeFunction("floor", [t.Multiply([t.SyntheticNativeFunction("uniformSample", [e, a, o]), u])]), o])]) } });
define('core/math/ir/features/depends-on-instruction', ["require", "exports", "../instructions"], function (require, r, n) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.dependsOnInstruction = void 0, r.dependsOnInstruction = function (r, e, t) { if (e === t) return !0; if (e < t) return !1; for (var i = [!0], u = t + 1; u <= e; u++)i.push(!1); for (var s = [e]; s.length;) { if (!i[(u = s.pop()) - t]) { i[u - t] = !0; var o = r.getInstruction(u); if (!n.isLeafInstruction(o)) for (var f = 0, c = o.args; f < c.length; f++) { var a = c[f]; if (a === t) return !0; a < t || (i[a - t] || s.push(a)) } } } return !1 } });
define('core/math/cache-stats', ["require", "exports"], function (require, e) { "use strict"; var a; Object.defineProperty(e, "__esModule", { value: !0 }), e.markCacheRead = e.markCacheWrite = e.markCacheMiss = e.markCacheHit = e.setCacheStatStore = void 0, e.setCacheStatStore = function (e) { a = e }, e.markCacheHit = function () { a && (a.cacheHits += 1) }, e.markCacheMiss = function () { a && (a.cacheMisses += 1) }, e.markCacheWrite = function () { a && (a.cacheWrites += 1) }, e.markCacheRead = function () { a && (a.cacheReads += 1) } });
define('core/math/ir/build-ir', ["require", "exports", "parsenodes", "core/math/builtinframe", "core/math/errormsg", "./scope", "./chunk", "core/math/types", "core/math/maybe-rational", "./opcodes", "./builtin-table", "./features/list-length", "./features/is-constant", "./features/type-check", "./distribution-table", "./features/fuse-broadcast", "./features/find-dependency-symbols", "./features/element-at", "./features/take-derivative", "./features/substitute", "./features/convert-to-broadcast", "./features/copy-instruction", "./features/depends-on-instruction", "./dependencies", "../cache-stats", "./features/nan-of-type"], function (require, e, t, r, n, i, a, s, o, u, c, l, d, p, y, f, g, v, m, h, b, T, L, S, I, w) { "use strict"; function A(e, t, r, n, i) { return { policy: e, frame: t, chunk: r, scope: n, parentNode: i } } function E(e) { var t = e.policy, r = e.frame, n = e.argNames, s = e.argTypes, o = new a.Chunk({ argNames: n, argTypes: s }); return A(t, r, o, function (e) { for (var t = i.Scope({}, -1), r = 0; r < e.argNames.length; r++)i.setSymbol(t, e.argNames[r], r); return t }(o), void 0) } function x(e, t, r) { if ("FunctionDefinition" === t.type) for (var i = 0, a = r; i < a.length; i++) { var o = a[i]; if (-1 !== t._argSymbols.indexOf(o) || t._symbol === o) throw n.updateRuleLocalLHS(o); if (t._sybmol === o) throw n.updateRuleFunctionLHS(o) } for (var u = [], c = 0, l = r; c < l.length; c++) { o = l[c]; e.frame[o] || u.push(o) } if (u.length) { var d = U(e, u[0]).setDependencies(e.chunk.argNames.concat(u)); throw e.chunk.isConstant() && e.chunk.getReturnType() === s.Action && d.setActionValue(e.chunk.asValue()), d } } function C(e, a) { var c; if (I.markCacheRead(), _(e.frame, a)) I.markCacheHit(), c = e.chunk.copyInstruction(a.__IRCache.instruction); else { I.markCacheMiss(); var y = e.chunk.instructionsLength(), g = e.policy, v = e.frame, T = e.chunk, E = e.scope, x = e.parentNode; if (c = function (e, a) { var c = e.policy, y = e.frame, g = e.chunk, v = e.scope, T = e.parentNode; switch (a.type) { case "Constant": var I = a._constantValue, E = "boolean" == typeof I ? s.Bool : s.Number; return g.ConstantOfType(E, I); case "MixedNumber": return g.Constant(a._constantValue); case "Negative": return g.Negative(function (e, t) { return [C(e, t[0])] }(e, a.args)); case "Add": return g.Add(D(e, a.args)); case "Subtract": return g.Subtract(D(e, a.args)); case "Multiply": return g.Multiply(D(e, a.args)); case "Divide": return g.Divide(D(e, a.args)); case "Exponent": return g.Exponent(D(e, a.args)); case "Comparator['=']": return g.Equal(D(e, a.args)); case "Comparator['>']": return g.Greater(D(e, a.args)); case "Comparator['<']": return g.Less(D(e, a.args)); case "Comparator['>=']": return g.GreaterEqual(D(e, a.args)); case "Comparator['<=']": return g.LessEqual(D(e, a.args)); case "And": return g.And(D(e, a.args)); case "PercentOf": return g.Divide([g.Multiply(D(e, a.args)), g.Constant(100)]); case "ParenSeq": return function (e, t) { for (var r, i, a, o, u = e.chunk, c = e.policy, l = B(e, t.args), d = !1, p = 0; p < l.length; p++) { var y = u.getInstruction(l[p]).valueType; if (y === s.Action) { if (d = !0, void 0 !== o) throw n.combineTypeError([s.prettyPrint(o), s.prettyPrint(s.Action)]) } else { if (d) throw n.combineTypeError([s.prettyPrint(s.Action), s.prettyPrint(y)]); o = y } } if (d) return V(e, l); var f = null !== (a = null === (i = (r = c).dimensions) || void 0 === i ? void 0 : i.call(r)) && void 0 !== a ? a : 2; if (2 !== f) throw new Error("3D points not implemented."); if (l.length !== f) throw n.badTupleDimensions(f); return u.OrderedPair(l) }(e, a); case "BareSeq": return function (e, t) { var r = e.chunk, i = B(e, t.args); if (i.length < 2) throw n.unexpectedSymbol(","); for (var a = r.getInstruction(i[0]).valueType, o = 1; o < i.length; o++) { var u = r.getInstruction(i[o]).valueType; if (a !== u) throw n.combineTypeError([s.prettyPrint(a), s.prettyPrint(u)]) } if (a === s.Number) throw 2 === i.length ? n.malformedPoint() : n.malformedList(); return a === s.Action ? V(e, i) : r.List(i) }(e, a); case "OrderedPairAccess": return g.OrderedPairAccess(D(e, a.args)); case "UpdateRule": var x = y[ne = a._symbol]; if (x) { if (x.isError) throw x; if ("Assignment" !== x.type && "Slider" !== x.type) throw U(e, ne) } return g.Action([ne], [C(e, a.args[1])]); case "List": if (a.getDependencies().length > 0) return g.List(B(e, a.args)); if (0 === a.args.length) return g.ConstantOfType(s.EmptyList, []); for (var N = g.instructionsLength(), F = [], O = void 0, _ = void 0, R = 0, k = a.args; R < k.length; R++) { var M = C(e, k[R]), H = g.getInstruction(M); if (void 0 === O) { if (O = H.valueType, !s.hasListType(O)) throw n.listTypeError([s.prettyPrint(O)]); _ = s.listType(O) } else if (H.valueType !== O) throw n.heterogeneousList(); if (H.type !== u.Constant) throw new Error("Programming error: expected list with no dependencies to constant collapse."); F.push(H.value), g.truncate(N) } return g.ConstantOfType(_, F); case "ListAccess": var j = C(e, a.args[0]), z = g.getInstruction(j); if ("Range" === a.args[1].type && 0 === a.args[1].args[1].length) { if (!s.isList(z.valueType)) throw n.indexTypeError([s.prettyPrint(z.valueType), s.prettyPrint(s.Number)]); var W = l.listLengthIndex(g, j), G = q(e, C(e, a.args[1].args[0]), g.List([W]), { stepMustBePositive: !0 }); return g.ListAccess([j, G]) } G = C(e, a.args[1]); var K = g.getInstruction(G); if (!s.isList(z.valueType)) throw n.indexTypeError([s.prettyPrint(z.valueType), s.prettyPrint(K.valueType)]); return K.valueType === s.ListOfBool ? g.SyntheticNativeFunction("select", [j, G]) : g.ListAccess([j, G]); case "Range": var J = D(e, a.args); return q(e, J[0], J[1], { stepMustBePositive: !1 }); case "ListComprehension": return function (e, t) { for (var r = e.policy, a = e.frame, o = e.chunk, c = e.scope, d = e.parentNode, p = t._body, y = [], f = o.Constant(1), g = Object.create(a), v = 0, m = t._inputLists; v < m.length; v++) { var h = m[v]._symbol; g[h] = n.badListComprehensionInputDependency(h) } for (var b = i.childScope(c), T = t._inputLists.length - 1; T >= 0; T--) { var L = t._inputLists[T], I = L._symbol, w = C(A(r, g, o, b, d), L.args[1]), E = o.getInstruction(w); if (!s.isList(E.valueType)) throw n.listComprehensionInputListTypeError(I, s.prettyPrint(E.valueType)); var x = l.listLengthIndex(o, w); y.push({ symbol: I, assignedList: w, lengthIndex: x }), f = o.Multiply([f, x]) } var N = o.Constant(1), F = o.BeginBroadcast([f], { inputListSymbols: y.map(function (e) { return e.symbol }) }), O = i.childScope(c); i.setSymbol(O, t._index._symbol, F); var _ = N; for (T = y.length - 1; T >= 0; T--) { var D = y[T], B = (I = D.symbol, w = D.assignedList, x = D.lengthIndex, void 0); if (1 === y.length) B = F; else { var P = o.SyntheticNativeFunction("floor", [o.Divide([o.Subtract([F, N]), _])]); B = o.Add([o.SyntheticNativeFunction("mod", [P, x]), N]), T > 0 && (_ = o.Multiply([_, x])) } var R = i.getSymbol(O, I); if (void 0 !== a[I] || void 0 !== R && o.getInstruction(R).type !== u.LoadArg) throw n.shadowedListComprehensionInput(I); i.setSymbol(O, I, o.ListAccess([w, B])) } for (var k = Object.create(a), M = 0, V = y; M < V.length; M++) { k[V[M].symbol] = S.FRAME_SENTINEL } var U = C(A(r, k, o, O, d), p), q = o.getInstruction(U); if (!s.hasListType(q.valueType)) throw n.listTypeError([s.prettyPrint(q.valueType)]); var H = o.EndBroadcast([F, U]); return o.BroadcastResult(s.listType(q.valueType), [H]) }(e, a); case "Piecewise": var Q = function (e, t) { return [C(e, t[0]), C(e, t[1]), C(e, t[2])] }(e, a.args), X = g.getInstruction(Q[0]), Y = g.getInstruction(Q[1]), Z = g.getInstruction(Q[2]); if (X.type === u.Constant && X.valueType === s.Bool && s.typesMatch(Y.valueType, Z.valueType)) { var $ = Q[X.value ? 1 : 2], ee = g.getInstruction($), te = Y.valueType !== s.EmptyList ? Y.valueType : Z.valueType; return ee.valueType === s.EmptyList && te !== s.EmptyList ? g.ConstantOfType(te, []) : $ } if (!s.typesMatch(Y.valueType, Z.valueType) && d.isConstant(Z) && Z.valueType === s.Number && o.isNanFloat(Z.value) && w.isNanableValueType(Y.valueType)) { var re = g.NanOfType(Y.valueType); Q = [Q[0], Q[1], re] } return g.Piecewise(Q); case "Ans": case "Identifier": var ne = a._symbol, ie = a._errorSymbol; if ("Ans" === a.type && -1 !== g.argNames.indexOf(ne)) throw n.ansUndefined(); G = i.getSymbol(v, ne); var ae = y[ne]; if (void 0 !== G) { if (v.symbolMap.hasOwnProperty(ne)) return G; if (void 0 === ae || ae === S.FRAME_SENTINEL) return G } if (void 0 === ae) { if (r[a._symbol]) throw r[a._symbol].isFunction ? n.functionUnsupported(ie) : n.constantUnsupported(ie); throw new Error("Programming Error: reached undefined symbol " + ne) } if (ae.isError) throw ae; if (ae.isFunction) throw n.identifierAsFunction(ie); var se = C(A(c, y, g, v, void 0), ae); return i.setSymbol(v, ne, se), se; case "FunctionCall": case "SeededFunctionCall": Q = B(e, a.args); return P(e, a._symbol, a._errorSymbol, Q); case "FunctionExponent": return y[tt = a.args[0]._symbol] && y[tt].isFunction ? C(e, t.Exponent([t.FunctionCall(tt, [a.args[1]]), a.args[2]])) : C(e, t.Multiply([a.args[0], t.Exponent([a.args[1], a.args[2]])])); case "FunctionFactorial": return y[tt = a.args[0]._symbol] && y[tt].isFunction ? C(e, t.FunctionCall("\\factorial", [t.FunctionCall(tt, [a.args[1]])])) : C(e, t.Multiply([a.args[0], t.FunctionCall("\\factorial", [a.args[1]])])); case "DotAccess": var oe = a.args[0], ue = a.args[1]; if (("Identifier" === ue.type || "FunctionCall" === ue.type) && y[ue._symbol] && y[ue._symbol].isFunction) return P(e, ne = ue._symbol, ie = ue._errorSymbol, Q = B(e, "Identifier" === ue.type ? [oe] : [oe].concat(ue.args)), { dotLHSIndex: Q[0] }); if ("SeededFunctionCall" === ue.type) return P(e, ne = ue._symbol, ie = ue._errorSymbol, Q = B(e, [ue.seed, oe].concat(ue.args.slice(1))), { dotLHSIndex: Q[1] }); throw n.unexpectedSymbol("."); case "Seed": return g.ConstantOfType(s.SeedType, a._stringValue); case "ExtendSeed": return g.ExtendSeed(a.tag, D(e, a.args)); case "Integral": var ce = a._differential._symbol, le = i.getSymbol(v, ce); if (void 0 !== y[ce] || void 0 !== le && g.getInstruction(le).type !== u.LoadArg) throw n.shadowedIntegrationVariable(ce); (xe = Object.create(y))[ce] = n.badIntegralBoundDependency(ce); var de = C(Ne = A(c, xe, g, i.childScope(v), T), a.args[1]), pe = C(Ne, a.args[2]), ye = g.getInstruction(de), fe = g.getInstruction(pe), ge = g.SymbolicVar(s.Number, ce), ve = i.childScope(v); i.setSymbol(ve, ce, ge); var me = Object.create(y); me[ce] = S.FRAME_SENTINEL; var he = C(A(c, me, g, ve, T), a.args[3]); if (!L.dependsOnInstruction(g, he, ge)) return g.Multiply([he, g.Subtract([pe, de])]); var be = de; void 0 !== (Ue = void 0 !== (Re = l.minListLengthIndex(g, [de, pe, he])) ? g.BeginBroadcast([Re]) : void 0) && s.isList(ye.valueType) && (be = b.deferredOrInboundsAccess(g, de, Ue)); var Te = pe; void 0 !== Ue && s.isList(fe.valueType) && (Te = b.deferredOrInboundsAccess(g, pe, Ue)); var Le = g.BeginIntegral({ indexSymbol: ce }, [be, Te]), Se = h.substitute(g, Le, ge, he), Ie = g.getInstruction(Se); void 0 !== Ue && s.isList(Ie.valueType) && (Se = b.deferredOrInboundsAccess(g, Se, Ue)); var we = g.EndIntegral([Le, Se]), Ae = g.BlockVar(s.Number, [we]); if (void 0 !== Ue) { var Ee = g.EndBroadcast([Ue, Ae]); return g.BroadcastResult(s.ListOfNumber, [Ee]) } return Ae; case "Sum": case "Product": ce = a._index._symbol, le = i.getSymbol(v, ce); if (void 0 !== y[ce] || void 0 !== le && g.getInstruction(le).type !== u.LoadArg) throw n.shadowedIndex(ce); var xe, Ce = "Sum" === a.type; (xe = Object.create(y))[ce] = Ce ? n.badSumBoundDependency(ce) : n.badProductBoundDependency(ce); var Ne, Fe = C(Ne = A(c, xe, g, i.childScope(v), T), a.args[1]), Oe = C(Ne, a.args[2]); if (!p.argIsTypeOrListOfType(g, Fe, s.Number)) { var _e = p.extractScalarValueTypes(g, [Fe]); throw Ce ? n.sumLowerBoundTypeError(_e) : n.productLowerBoundTypeError(_e) } if (!p.argIsTypeOrListOfType(g, Oe, s.Number)) { _e = p.extractScalarValueTypes(g, [Oe]); throw Ce ? n.sumUpperBoundTypeError(_e) : n.productUpperBoundTypeError(_e) } de = g.SyntheticNativeFunction("round", [Fe]), pe = g.SyntheticNativeFunction("round", [Oe]), ye = g.getInstruction(de), fe = g.getInstruction(pe); if (ye.type === u.Constant && ye.valueType === s.Number && !isFinite(o.asFloat(ye.value))) throw Ce ? n.sumInfiniteBoundError() : n.productInfiniteBoundError(); if (fe.type === u.Constant && fe.valueType === s.Number && !isFinite(o.asFloat(fe.value))) throw Ce ? n.sumInfiniteBoundError() : n.productInfiniteBoundError(); var De = g.SymbolicVar(s.Number, ce), Be = i.childScope(v); i.setSymbol(Be, ce, De); var Pe = Object.create(y); Pe[ce] = S.FRAME_SENTINEL; var Re, ke = C(A(c, Pe, g, Be, T), a.args[3]); if (!L.dependsOnInstruction(g, ke, De)) { var Me = g.Add([g.Subtract([pe, de]), g.Constant(1)]); Me = g.SyntheticNativeFunction("max", [Me, g.Constant(0)]); var Ve = Ce ? g.Multiply([ke, Me]) : g.Exponent([ke, Me]); return g.Piecewise([g.Less([Me, g.Constant(1 / 0)]), Ve, g.Constant(NaN)]) } if (!p.argIsTypeOrListOfType(g, ke, s.Number)) { _e = p.extractScalarValueTypes(g, [ke]); throw Ce ? n.sumArgumentTypeError(_e) : n.productArgumentTypeError(_e) } if (void 0 !== (Re = l.minListLengthIndex(g, [de, pe, ke])) && L.dependsOnInstruction(g, Re, De)) throw Ce ? n.variableLengthSumBodyDependsOnIndex(ce) : n.variableLengthProductBodyDependsOnIndex(ce); var Ue; be = de; void 0 !== (Ue = void 0 !== Re ? g.BeginBroadcast([Re]) : void 0) && s.isList(ye.valueType) && (be = b.deferredOrInboundsAccess(g, de, Ue)); Te = pe; null != Ue && s.isList(fe.valueType) && (Te = b.deferredOrInboundsAccess(g, pe, Ue)); var qe = g.Constant(Ce ? 0 : 1), He = (Le = g.BeginLoop({ type: Ce ? "sum" : "product", indexSymbol: ce }, [be, Te, qe]), g.BlockVar(s.Number, [Le])), je = h.substitute(g, Le, De, ke), ze = g.getInstruction(je); void 0 !== Ue && s.isList(ze.valueType) && (je = b.deferredOrInboundsAccess(g, je, Ue)); var We = Ce ? g.Add([He, je]) : g.Multiply([He, je]), Ge = (we = g.EndLoop([Le, We]), g.BlockVar(s.Number, [we])); if (void 0 !== Ue) { Ee = g.EndBroadcast([Ue, Ge]); return g.BroadcastResult(s.ListOfNumber, [Ee]) } return Ge; case "Derivative": var Ke = C(e, t.Identifier(a._symbol)); if (!p.argIsTypeOrListOfType(g, Ke, s.Number)) throw n.derivativeVariableTypeError(a._symbol, p.extractScalarValueTypes(g, [Ke])); var Je = void 0, Qe = void 0; if ((rt = g.getInstruction(Ke)).type === u.LoadArg && rt.valueType === s.Number) Je = e, Qe = Ke; else { var Xe = i.childScope(v); Qe = g.SymbolicVar(rt.valueType), i.setSymbol(Xe, a._symbol, Qe); var Ye = Object.create(y); Ye[a._symbol] = S.FRAME_SENTINEL, Je = A(c, Ye, g, Xe, T) } for (var Ze = 1; "Derivative" === a.args[0].type && a.args[0]._symbol === a._symbol;)Ze += 1, a = a.args[0]; for (var $e = f.fuseBroadcast(g, C(Je, a.args[0])), et = 0; et < Ze; et++)$e = m.takeDerivative(g, $e, Qe); return Qe === Ke ? $e : h.substitute(g, Ke, Qe, $e); case "Prime": var tt; if (!y[(tt = a.args[0])._symbol]) throw n.functionNotDefined(tt._symbol); var rt; Ke = C(e, tt.args[0]), Qe = void 0; Qe = (rt = g.getInstruction(Ke)).type === u.LoadArg && rt.valueType === s.Number ? Ke : g.SymbolicVar(rt.valueType); Q = void 0; if ("logbase" === tt._symbol) { if (2 !== tt.args.length) throw n.primedFunctionArity(); Q = [Qe, C(e, tt.args[1])] } else { if (1 !== tt.args.length) throw n.primedFunctionArity(); Q = [Qe] } $e = f.fuseBroadcast(g, P(e, tt._symbol, tt._errorSymbol, Q)); for (var nt = 0; nt < a.order; nt++)$e = m.takeDerivative(g, $e, Qe); return Qe === Ke ? $e : h.substitute(g, Ke, Qe, $e); case "Slider": return e.chunk.Constant(a.getConcreteTree(c, y).asCompilerValue()); case "Assignment": return C(e, a._expression); case "FunctionDefinition": for (var it = 0; it < a._argSymbols.length; it++) { if (y[a._argSymbols[it]]) throw n.parameterAlreadyDefined(a._argSymbols[it]); if (a._argSymbols[it] === a._symbol) throw n.parameterAlreadyDefined(a._argSymbols[it]) } return C(e, a._expression); default: throw new Error("Programming error, unimplemented node type " + a.type) } }(A(g, v, T, E, a), a), !F(a, x)) { var R = T.getInstruction(c); R.type === u.BroadcastResult && R.isConstantBroadcast && (c = f.fuseBroadcast(T, c)) } O(e, a, c = N(e, y, c)) } return e.chunk.returnIndex = c, c } function N(e, t, r) { var n = e.chunk, i = e.scope; if (r <= t) return r; var a = n.getInstruction(r); return d.isConstant(a) ? (n.truncate(Math.max(t, i.maxIndex + 1)), T.copyInstruction(n, a)) : r } function F(e, t) { if (!t) return !1; if (!e.getScope || !t.getScope) return !1; var n = t.getScope().dependencies, i = e.getScope().dependencies; if (i.length === n.length) return !0; for (var a = 0, s = 0, o = i; s < o.length; s++) { var u = o[s]; r[u] || (a += 1) } for (var c = 0, l = 0, d = n; l < d.length; l++) { u = d[l]; r[u] || (c += 1) } return a === c } function O(e, t, r) { var n = e.frame, i = e.chunk, a = e.parentNode, s = i.getInstruction(r); if (d.isConstant(s) && !F(t, a)) { var o = S.getCacheKeys(n, t); o && (I.markCacheWrite(), t.__IRCache = { keys: o, instruction: s }) } } function _(e, t) { if (!t.__IRCache) return !1; for (var r = 0, n = t.__IRCache.keys; r < n.length; r++) { var i = n[r], a = i[0], s = i[1]; if (e[a] !== s) return !1 } return !0 } function D(e, t) { return [C(e, t[0]), C(e, t[1])] } function B(e, t) { for (var r = [], n = 0, i = t; n < i.length; n++) { var a = i[n]; r.push(C(e, a)) } return r } function P(e, a, m, h, b) { var T = e.policy, L = e.frame, I = e.chunk, w = e.scope, E = e.parentNode, x = i.getSymbol(w, a); if (void 0 !== x) { if (1 == h.length) return I.Multiply([x, h[0]]); throw I.getInstruction(x).type === u.LoadArg ? n.functionNotDefined(m) : I.getInstruction(x).valueType === s.Distribution ? n.distributionAsFunction(m) : n.variableAsFunction(m) } var N = L[a]; if (N && N.isError) throw N; if (void 0 === N || !N.isFunction) { if (r[a] && r[a].isFunction) { if ("logbase" === a && L.ln && L.log) throw n.logbaseUnsupported(); throw n.functionUnsupported(m) } if (N) { var F = C(e, N); if (I.getInstruction(F).valueType === s.Distribution) throw n.distributionAsFunction(m) } if (1 == h.length) return I.Multiply([C(e, t.Identifier(a)), h[0]]); throw N ? n.variableAsFunction(m) : new Error("Programming Error: reached undefined symbol " + a) } if ("FunctionDefinition" === N.type) { if (b && void 0 !== b.dotLHSIndex) throw n.illegalDotCall(m); if (h.length !== N._argSymbols.length) throw n.wrongArity(m, N._argSymbols.length, h.length); for (var O = i.childScope(w), _ = Object.create(L), D = 0; D < N._argSymbols.length; D++)i.setSymbol(O, N._argSymbols[D], h[D]), _[N._argSymbols[D]] = S.FRAME_SENTINEL; return C(A(T, _, I, O, E), N._expression) } if (c.CompilerFunctionTable.hasOwnProperty(a)) return function (e, t, r, i, a) { var m = e.chunk, h = !(!a || void 0 === a.dotLHSIndex), b = c.CompilerFunctionTable[t]; if (b.fallthroughUnlessDistribution && (0 === i.length || m.getInstruction(i[0]).valueType === s.EmptyList || !s.isTypeOrListOfType(m.getInstruction(i[0]).valueType, s.Distribution))) return k(e, t, r, i, a); var T = b.minArity, L = b.maxArity, S = b.allowDotCall; if (a && void 0 !== a.dotLHSIndex) { if (!S) throw n.illegalDotCall(r); R(m, a.dotLHSIndex, "." + r) } var I, w = i.length; if (w < T) throw function (e, t, r, i, a) { var s = a.isDotCall; s && (r -= 1, i -= 1, t = "." + t); var o = c.CompilerFunctionTable[e]; o.isSeeded && (r -= 1, i -= 1); var u = void 0; s && o.dotMinArityExampleArgs ? u = t + o.dotMinArityExampleArgs : o.minArityExampleArgs && (u = t + o.minArityExampleArgs); switch (e) { case "pdf": return s ? n.wrongArity(t, r, i, u) : n.pdfWrongArity(); case "cdf": return s ? n.wrongArity(t, r, i, u) : n.cdfRequiresArguments(); case "tdist": return n.tdistWrongArity(); case "random": return n.randomArity(); case "round": case "midpoint": case "normaldist": case "poissondist": case "binomialdist": case "uniformdist": case "mean": case "median": case "stdev": case "var": case "quantile": case "sort": case "shuffle": case "join": case "unique": case "polygon": return n.wrongArity(t, r, i, u); case "histogram": case "dotplot": case "boxplot": case "ttest": case "ittest": case "stats": case "det": case "inv": case "transpose": case "rref": case "trace": throw n.parseError(); default: throw new Error("Unexpected compiler function " + e) } }(t, r, T, w, { isDotCall: h }); if (w > L) throw function (e, t, r, i, a) { var s = a.isDotCall; s && (r -= 1, i -= 1, t = "." + t); var o = c.CompilerFunctionTable[e]; o.isSeeded && (r -= 1, i -= 1); var u = void 0; s && o.dotMaxArityExampleArgs ? u = t + o.dotMaxArityExampleArgs : o.maxArityExampleArgs && (u = t + o.maxArityExampleArgs); switch (e) { case "pdf": return s ? n.wrongArity(t, r, i, u) : n.pdfWrongArity(); case "cdf": return s ? n.wrongArity(t, r, i, u) : n.cdfTooManyArguments(); case "tdist": return n.tdistWrongArity(); case "random": return n.randomArity(); case "round": case "midpoint": case "normaldist": case "poissondist": case "binomialdist": case "uniformdist": case "mean": case "median": case "stdev": case "var": case "quantile": case "sort": case "shuffle": case "join": case "unique": case "polygon": return n.wrongArity(t, r, i, u); case "histogram": case "dotplot": case "boxplot": case "ttest": case "ittest": case "stats": case "det": case "inv": case "transpose": case "rref": case "trace": throw n.parseError(); default: throw new Error("Unexpected compiler function " + e) } }(t, r, L, w, { isDotCall: h }); if ("cdf" === t) I = 2 === w ? [i[0], m.Constant(-1 / 0), i[1]] : i; else if ("random" === t) if (1 === w || w < 4 && !s.isList(m.getInstruction(i[1]).valueType) && m.getInstruction(i[1]).valueType !== s.Distribution) { var A = m.Distribution("uniformdist", [m.Constant(0), m.Constant(1)]); I = [i[0], A].concat(i.slice(1)) } else I = i; else I = M(m, i, b); switch (t) { case "round": if (1 === I.length) return m.SyntheticNativeFunction("round", I); if (!p.argIsTypeOrListOfType(m, I[0], s.Number) || !p.argIsTypeOrListOfType(m, I[1], s.Number)) throw n.functionTypeError(r, p.extractScalarValueTypes(m, I)); var E = m.SyntheticNativeFunction("round", [I[1]]), x = m.RawExponent([m.Constant(10), E]); return m.Divide([m.SyntheticNativeFunction("round", [m.Multiply([I[0], x])]), x]); case "midpoint": if (!p.argIsTypeOrListOfType(m, I[0], s.Point) || !p.argIsTypeOrListOfType(m, I[1], s.Point)) throw n.functionTypeError(r, p.extractScalarValueTypes(m, I)); var C = m.Constant(o.maybeRational(1, 2)); return m.Multiply([C, m.Add(I)]); case "normaldist": case "tdist": case "poissondist": case "binomialdist": case "uniformdist": for (var N = 0, F = I; N < F.length; N++) { var O = F[N]; if (!p.argIsTypeOrListOfType(m, O, s.Number)) throw n.functionTypeError(r, p.extractScalarValueTypes(m, i)) } return m.Distribution(t, I); case "pdf": case "cdf": case "mean": case "median": case "stdev": case "var": case "quantile": var _ = I[0], D = m.getInstruction(_); if (!s.isTypeOrListOfType(D.valueType, s.Distribution)) throw n.functionTypeError(r, p.extractScalarValueTypes(m, i)); for (var B = I.slice(1), P = 0, V = B; P < V.length; P++) { O = V[P]; if (!s.isTypeOrListOfType(m.getInstruction(O).valueType, s.Number)) throw n.functionTypeError(r, p.extractScalarValueTypes(m, i)) } if (s.isList(D.valueType)) { for (var U = [], H = 1 / 0, j = 0, z = I; j < z.length; j++) { O = z[j]; var W = f.fuseBroadcast(m, O); U.push(W); var G = m.getInstruction(W); if (s.isList(G.valueType)) { if (void 0 === (se = l.getConstantListLength(m, W))) throw n.variableLengthDistributionList(g.findDependencySymbols(m, W)); H = Math.min(H, se) } } for (var K = [], J = 0; J < H; J++) { var Q = v.elementAt(m, U[0], J), X = m.getInstruction(Q); if (X.type !== u.Distribution) throw n.parseError(); for (var Y = [], Z = 0, $ = U.slice(1); Z < $.length; Z++) { O = $[Z]; s.isList(m.getInstruction(O).valueType) ? Y.push(v.elementAt(m, O, J)) : Y.push(O) } K.push(y.DistributionTable[X.symbol][t](m, Q, Y)) } return m.List(K) } if (D.type !== u.Distribution) throw n.parseError(); return y.DistributionTable[D.symbol][t](m, _, B); case "random": var ee = I[0], te = (_ = I[1], m.getInstruction(I[0])); D = m.getInstruction(_); if (te.valueType !== s.SeedType) throw n.parseError(); if (D.valueType === s.ListOfDistribution) throw n.randomFromBroadcastDistribution(); var re = void 0; if (s.isList(D.valueType)) re = y.randomSampleFromList; else { if (D.valueType !== s.Distribution) throw n.randomArity(); if (D.type !== u.Distribution) throw n.parseError(); re = y.DistributionTable[D.symbol][t] } if (I.length > 2) { var ne = I[2]; if (m.getInstruction(ne).valueType !== s.Number) throw n.randomArity(); if (4 === I.length) { var ie = m.getInstruction(I[3]); if (ie.valueType !== s.Number) throw n.randomArity(); if (!d.isConstant(ie)) throw n.variableSeed(g.findDependencySymbols(m, I[3])); ee = m.ExtendSeed("us", [ee, I[3]]) } var ae = m.Constant(1), se = m.SyntheticNativeFunction("round", [m.SyntheticNativeFunction("validateSampleCount", [ne])]), oe = m.BeginBroadcast([se]); ee = m.ExtendSeed("lc", [ee, m.Subtract([oe, ae])]); var ue = re(m, _, [ee]), ce = m.EndBroadcast([oe, ue]); return m.BroadcastResult(s.listType(m.getInstruction(ue).valueType), [ce]) } return re(m, _, [ee]); case "shuffle": ee = I[0]; var le = I[1], de = I[2]; if (!s.isList(m.getInstruction(le).valueType) || void 0 !== de && m.getInstruction(de).valueType !== s.Number) throw n.functionTypeError(r, p.extractValueTypes(m, i.slice(1))); if (void 0 !== de) { if (!d.isConstant(m.getInstruction(de))) throw n.variableSeed(g.findDependencySymbols(m, de)); ee = m.ExtendSeed("us", [ee, de]) } return m.SyntheticNativeFunction("shuffle", [ee, le]); case "sort": var pe = 2 === I.length ? I[1] : I[0], ye = m.getInstruction(pe); if (!s.isList(m.getInstruction(I[0]).valueType) || ye.valueType !== s.ListOfNumber && ye.valueType !== s.EmptyList) throw n.functionTypeError(r, p.extractValueTypes(m, i)); if (0 === l.getConstantListLength(m, pe)) return pe; var fe = m.SyntheticNativeFunction("min", [l.listLengthIndex(m, I[0]), l.listLengthIndex(m, pe)]); return pe = m.ListAccess([pe, q(e, m.List([m.Constant(1)]), m.List([fe]), { stepMustBePositive: !0 })]), m.SyntheticNativeFunction("elementsAt", [I[0], m.SyntheticNativeFunction("sortPerm", [pe])]); case "join": for (var ge = [], ve = !0, me = 0, he = I; me < he.length; me++) { O = he[me]; var be = m.getInstruction(O); d.isConstantOrConstantBroadcast(be) || (ve = !1); var Te = be.valueType; if (Te !== s.EmptyList) if (s.isList(Te)) ge.push({ isList: !0, index: O, elementType: s.elementType(Te) }); else { if (!s.hasListType(Te)) throw n.functionTypeError(r, p.extractValueTypes(m, i)); ge.push({ isList: !1, index: O, elementType: Te }) } } if (0 === ge.length) return m.ConstantOfType(s.EmptyList, []); for (var Le = 0, Se = ge; Le < Se.length; Le++) { if ((Ee = Se[Le]).elementType !== ge[0].elementType) throw n.functionTypeError(r, p.extractValueTypes(m, i)) } if (ve) { for (var Ie = [], we = 0, Ae = ge; we < Ae.length; we++) { var Ee = Ae[we], xe = m.getInstruction(f.fuseBroadcast(m, Ee.index)); d.assertConstant(xe), Ee.isList ? Ie.push.apply(Ie, xe.value) : Ie.push(xe.value) } return m.ConstantOfType(s.listType(ge[0].elementType), Ie) } for (var Ce = m.Constant(0), Ne = m.Constant(1), Fe = {}, Oe = 0, _e = ge; Oe < _e.length; Oe++) { (Ee = _e[Oe]).isList && void 0 === Fe[Ee.index] && (Fe[Ee.index] = l.listLengthIndex(m, Ee.index)) } for (var De = m.SyntheticNativeFunction("total", ge.map(function (e) { return e.isList ? Fe[e.index] : Ne })), Be = (oe = m.BeginBroadcast([De]), Ce), Pe = [], Re = [], ke = 0, Me = ge; ke < Me.length; ke++) { var Ve = (Ee = Me[ke]).isList ? m.ListAccess([Ee.index, m.Subtract([oe, Be])]) : Ee.index; if (Re.push(Ve), Ee !== ge[ge.length - 1]) { se = Ee.isList ? Fe[Ee.index] : Ne; Be = m.Add([Be, se]), Pe.push(m.LessEqual([oe, Be])) } } var Ue = Re[Re.length - 1]; for (J = Re.length - 2; J >= 0; J--)Ue = m.Piecewise([Pe[J], Re[J], Ue]); ce = m.EndBroadcast([oe, Ue]); return m.BroadcastResult(s.listType(ge[0].elementType), [ce]); case "unique": var qe = I[0], He = m.getInstruction(qe); if (!s.isList(He.valueType) || He.valueType === s.ListOfDistribution) throw n.functionTypeError("unique", [s.prettyPrint(He.valueType)]); return m.SyntheticNativeFunction("elementsAt", [qe, m.SyntheticNativeFunction("uniquePerm", [qe])]); case "polygon": var je = void 0, ze = I.map(function (e) { return m.getInstruction(e) }); if (1 === ze.length) { if ((He = ze[0]).valueType !== s.ListOfPoint) throw n.polygonListTypeError([s.prettyPrint(He.valueType)]); je = I[0] } else if (2 === ze.length && s.isTypeOrListOfType(ze[0].valueType, s.Number) && s.isTypeOrListOfType(ze[1].valueType, s.Number)) { if (ze[0].valueType === s.Number && ze[1].valueType === s.Number) throw n.polygonTwoNumbersError(); je = m.OrderedPair(I) } else { if (!ze.every(function (e) { return e.valueType === s.Point })) throw n.polygonPointArgsError(); je = m.List(I) } return m.SyntheticNativeFunction("polygon", [je]); case "histogram": case "dotplot": case "boxplot": case "ttest": case "ittest": case "stats": case "det": case "inv": case "transpose": case "rref": case "trace": throw n.unexpectedSymbol(r); default: throw new Error("Programming Error: unexpected compiler function " + t) } }(e, a, m, h, b); if (c.BuiltInTable.hasOwnProperty(a)) return k(e, a, m, h, b); throw n.functionUnsupported(m) } function R(e, t, r) { var i = e.getInstruction(t).valueType; if (!s.isList(i) && i !== s.Distribution) throw n.dotLHSTypeError(r, s.prettyPrint(i)) } function k(e, r, i, a, s) { var o = e.chunk, u = c.BuiltInTable[r], l = !(!s || void 0 === s.dotLHSIndex), d = a.length, p = u.minArity, y = u.maxArity, f = u.allowDotCall; if (s && void 0 !== s.dotLHSIndex) { if (!f) throw n.illegalDotCall(i); R(o, s.dotLHSIndex, "." + i) } if ("logbase" === r && 2 !== d) throw n.wrongArity(i, 1, d - 1); if (d > y) throw l && (p -= 1, y -= 1, d -= 1, i = "." + i), "doubleReducer" === u.tag ? n.wrongDoubleReducerArity(i) : "parameterizedReducer" === u.tag ? n.wrongParameterizedReducerArity(i) : "color" === u.tag ? n.colorArity(i) : n.wrongArity(i, y, d); if (d < p) throw l && (p -= 1, y -= 1, d -= 1, i = "." + i), "reducer" === u.tag && 0 === d ? n.zeroArgReducer(i) : "doubleReducer" === u.tag ? n.wrongDoubleReducerArity(i) : "parameterizedReducer" === u.tag ? n.wrongParameterizedReducerArity(i) : "color" === u.tag ? n.colorArity(i) : n.wrongArity(i, p, d); var g = M(o, a, u), v = { errorSymbol: i, providedArity: d, isDotCall: l }; switch (u.tag) { case "default": case "reducer": case "doubleReducer": case "parameterizedReducer": case "color": case "never-broadcast": return o.NativeFunction(r, v, g); case "trig": var m = C(e, t.Identifier("trigAngleMultiplier")), h = o.Multiply([g[0], m]); return o.NativeFunction(r, v, [h]); case "inverseTrig": m = C(e, t.Identifier("trigAngleMultiplier")); var b = o.NativeFunction(r, v, g); return o.Divide([b, m]); default: var T = u.tag; throw new Error("Programming Error: unexpected tag " + T) } } function M(e, t, r) { var n = r.minArity, i = r.defaultArguments; if (!i) return t; if (!(t.length - n < i.length)) return t; for (var a = t.slice(); a.length - n < i.length;)a.push(e.copyInstruction(i[a.length - n])); return a } function V(e, t) { for (var r = e.chunk, i = [], a = [], s = 0, o = t; s < o.length; s++) { var c = o[s], l = r.getInstruction(c); switch (l.type) { case u.Action: Array.prototype.push.apply(i, l.symbols), Array.prototype.push.apply(a, l.args); break; case u.Constant: var d = l.value.updateRules; for (var p in d) i.push(p), a.push(r.ConstantOfType(d[p].valueType, d[p].value)); break; default: var y = g.findDependencySymbols(r, c); throw y.length > 0 ? n.actionMergeFreeVariable(y) : n.parseError() } } return r.Action(i, a) } function U(e, t) { var r = e.frame[t]; return e.policy.assignmentForbidden(t) ? n.updateRuleIllegalLHS(t) : r === S.FRAME_SENTINEL ? n.updateRuleLocalLHS(t) : r && "FunctionDefinition" === r.type ? n.updateRuleFunctionLHS(t) : n.updateRuleUndefinedLHS(t).allowExport() } function q(e, t, r, i) { var a, o = i.stepMustBePositive, u = e.chunk, c = u.getInstruction(t), d = u.getInstruction(r), p = l.assertConstantListLength(u, t, "Programming error: expected range start list to have constant length."), y = l.assertConstantListLength(u, r, "Programming error: expected range start list to have constant length."); if (c.valueType !== s.ListOfNumber || d.valueType !== s.ListOfNumber) throw n.nonArithmeticRange(); var f = u.Constant(1), g = u.Constant(0), v = u.ListAccess([t, f]), m = u.ListAccess([t, u.Constant(2)]), h = u.ListAccess([r, u.Constant(y)]), b = u.Subtract([h, v]), T = p > 1 ? u.Subtract([m, v]) : u.Piecewise([u.GreaterEqual([b, g]), f, u.Constant(-1)]), L = u.Add([f, u.SyntheticNativeFunction("round", [u.Divide([b, T])])]), S = u.SyntheticNativeFunction("validateRangeLength", [t, r, T, L]); o && (S = u.Piecewise([u.GreaterEqual([T, g]), S, g])); var I = u.BeginBroadcast([S]), w = u.Add([v, u.Multiply([T, u.Subtract([I, f])])]), A = u.EndBroadcast([I, w]); return u.addComments(((a = {})[v] = "start", a[m] = "second", a[h] = "last", a[L] = "proposedLength", a[T] = "step", a[w] = "body", a)), u.BroadcastResult(s.listType(u.getInstruction(w).valueType), [A]) } Object.defineProperty(e, "__esModule", { value: !0 }), e.isCacheValid = e.maybeCacheIR = e.hasSameUserDependenciesAsParent = e.maybeDropIntermediates = e.addToIR = e.checkForUndefinedUpdateSymbols = e.buildIR = e.buildIRContext = e.Ctx = void 0, e.Ctx = A, e.buildIRContext = E, e.buildIR = function (e, t) { var r = e.policy, n = e.frame, i = e.argNames, a = e.argTypes, o = S.analyzeDependencies(n, t), u = o.freeDependencies, c = o.updateSymbols; if (i || (i = u), !a) { a = []; for (var l = 0; l < i.length; l++)a.push(s.Number) } var d = E({ policy: r, frame: n, argNames: i, argTypes: a }); return C(d, t), e.wrapInList && !s.isList(d.chunk.getReturnType()) && d.chunk.List([d.chunk.returnIndex]), d.chunk.close(), x(d, t, c), d.chunk }, e.checkForUndefinedUpdateSymbols = x, e.addToIR = C, e.maybeDropIntermediates = N, e.hasSameUserDependenciesAsParent = F, e.maybeCacheIR = O, e.isCacheValid = _ });
define('core/math/features/buildIRExpression', ['require', 'core/math/ir/build-ir', 'core/math/parsenode/base', 'core/math/parsenode/irexpression', 'core/math/errormsg', 'core/math/parsenode/error'], function (require) { "use strict"; var r = require("core/math/ir/build-ir").buildIR, e = require("core/math/parsenode/base"), t = require("core/math/parsenode/irexpression"), o = require("core/math/errormsg"), i = require("core/math/parsenode/error"); e.prototype.buildIRExpression = function (i, n, s) { try { var a = r({ policy: i, frame: n, wrapInList: s && s.wrapInList }, this); return new t(a) } catch (r) { return r instanceof e ? r : o.parseError() } }, i.prototype.buildIRExpression = function () { return this } });
define('core/math/features/typeCheck', ['require', 'parsenodes', 'core/math/types', 'core/math/errormsg'], function (require) { "use strict"; var t = require("parsenodes"), e = require("core/math/types"), i = require("core/math/errormsg"), o = e.isOneOf; function s(t) { for (var i = [], o = 0; o < t.length; o++)i.push(e.prettyPrint(t[o].valueType)); return i } function r(t, s) { var r = s.length, h = s[0]; if (r < 2) throw i.methodRequiresList(this._symbol); if (!o(h.valueType, [e.ListOfNumber, e.EmptyList])) throw i.methodRequiresList(this._symbol); if (r > 2) throw i.tooManyArguments(this._symbol, 2) } var h = { Object3D: function (t, e) { if (e.length < 3) throw i.wrongArity(this._symbol, 3, e.length) }, Histogram: r, DotPlot: r, BoxPlot: function (t, s) { var r = s.length, h = s[0]; if (0 === r) throw i.methodRequiresList(this._symbol); if (!o(h.valueType, [e.ListOfNumber, e.EmptyList])) throw i.methodRequiresList(this._symbol); if (r > 1) throw i.methodRequiresList(this._symbol) }, TTest: function (t, o) { var r = this._symbol; if (0 === o.length) throw i.methodRequiresList(r); if (o[0].valueType === e.EmptyList) throw i.ttestListTooShort(r); if (o[0].valueType !== e.ListOfNumber) throw i.methodRequiresList(r); if (o.length > 2) throw i.tooManyArguments(r, 2); if (o[0].length < 2) throw i.ttestListTooShort(r); if (o[1] && o[1].valueType !== e.Number) throw i.functionTypeError(r, s(o)) }, IndependentTTest: function (t, o) { var r = this._symbol; if (2 !== o.length) throw i.wrongDoubleReducerArity(r); if (!e.isList(o[0].valueType) || !e.isList(o[1].valueType)) throw i.nonListDoubleReducer(r); if (o[0].valueType === e.EmptyList || o[1].valueType === e.EmptyList) throw i.ttestListTooShort("ittest"); if (o[0].valueType !== e.ListOfNumber || o[1].valueType !== e.ListOfNumber) throw i.functionTypeError(r, s(o)); if (o[0].length < 2 || o[1].length < 2) throw i.ttestListTooShort("ittest") }, Stats: function (t, o) { var r = o.length, h = o[0]; if (0 === r) throw i.methodRequiresList(this._symbol); if (h.valueType === e.EmptyList) throw i.functionTypeError(this._symbol, s(o)); if (h.valueType !== e.ListOfNumber) throw i.methodRequiresList(this._symbol); if (r > 1) throw i.methodRequiresList(this._symbol) } }; for (var n in h) t[n].prototype.typeCheck = h[n] });
define('core/math/features/repr', ['require', 'parsenodes'], function (require) { "use strict"; var r = require("parsenodes"), t = function (r, t, e) { e = e || 0; var i = Array(e + 1).join("  "), n = i + "  "; return "[\n" + n + r.map(function (r) { return r.repr(t, e + 1) }).join(",\n" + n) + "\n" + i + "]" }, e = function (r, t) { return "" + (t = t || "") + r }; r.Expression.prototype.repr = function (r, i) { return e(this.type, r) + "(" + t(this.args, r, i) + ")" }, r.IRExpression.prototype.repr = function (r, t) { t = t || 0; var i = Array(t + 1).join("  "), n = i + "  ", s = this._chunk.print().split("\n"); return s.pop(), e(this.type, r) + "(`\n" + n + s.join("\n" + n) + "\n" + i + "`)" }, r.DoubleInequality.prototype.repr = function (r, t) { t = t || 0; var i = Array(t + 1).join("  "), n = i + "  "; return e(this.type, r) + "([\n" + n + this.args[0].repr(r, t + 1) + ",\n" + n + "'" + this.args[1] + "',\n" + n + this.args[2].repr(r, t + 1) + ",\n" + n + "'" + this.args[3] + "',\n" + n + this.args[4].repr(r, t + 1) + "\n" + i + "])" }, r.Identifier.prototype.repr = function (r) { return e(this.type, r) + "('" + this._symbol + "')" }, r.Constant.prototype.repr = function (r) { return e(this.type, r) + "(" + this.asValue() + ")" }, r.ExtendSeed.prototype.repr = function (r, i) { return e(this.type, r) + "('" + this.tag + "', " + t(this.args, r, i) + ")" }, r.Seed.prototype.repr = function (r) { return e(this.type, r) + "(" + this.asValue() + ")" }, r.FunctionCall.prototype.repr = function (r, i) { return e(this.type, r) + "('" + this._symbol + "', " + t(this.args, r, i) + ")" }, r.Assignment.prototype.repr = function (t, i) { return e(this.type, t) + "(" + r.Identifier(this._symbol).repr(t, i) + ", " + this._expression.repr(t, i) + ")" }, r.Regression.prototype.repr = r.Equation.prototype.repr = function (r, t) { return e(this.type, r) + "(" + this._lhs.repr(r, t) + ", " + this._rhs.repr(r, t) + ")" }, r.FunctionDefinition.prototype.repr = function (i, n) { return e(this.type, i) + "(" + r.Identifier(this._symbol).repr(i, n) + ", " + t(this._argSymbols.map(function (t) { return r.Identifier(t) }), i, n) + ", " + this._expression.repr(i, n) + ")" }, r.Error.prototype.repr = function (r, t) { return e(this.type, r) + "('" + this._msg + "')" }, r.Derivative.prototype.repr = function (r, i) { return e(this.type, r) + "('" + this._symbol + "', " + t(this.args, r, i) + ")" }, r.SolvedEquation.prototype.repr = function (r, t) { return e(this.type, r) + "('" + this._symbol + "', " + this._expression.repr(r, t) + ")" }, r.OptimizedRegression.prototype.repr = function (r, t) { return e(this.type, r) + "(" + JSON.stringify(this.parameters) + ", " + JSON.stringify(this.residuals) + ", " + JSON.stringify(this.statistics) + ", " + this.model.repr(r, t + 1) + ", " + JSON.stringify({ isModelValid: this.isModelValid, residualVariable: this.residualVariable, residualSuggestionId: this.residualSuggestionId, shouldSuggestLogMode: this.shouldSuggestLogMode, isLinear: this.isLinear, parameterWarning: this.parameterWarning }) + ")" }, r.Table.prototype.repr = function (r, i) { return e(this.type, r) + "(" + t(this.columns, r, i) + ")" }, r.TableColumn.prototype.repr = function (r, i) { return e(this.type, r) + "(" + this.header.repr(r, i) + ", " + this.length + ", " + t(this.values, r, i) + ")" }, r.Image.prototype.repr = function (r, t) { var i = Array(t + 1).join("  "), n = i + "  "; return e(this.type, r) + "({\n" + n + "center: " + this.center.repr(r, t + 1) + ",\n" + n + "radianAngle: " + this.radianAngle.repr(r, t + 1) + ",\n" + n + "width: " + this.width.repr(r, t + 1) + ",\n" + n + "height: " + this.height.repr(r, t + 1) + "},\n" + n + "opacity: " + this.opacity.repr(r, t + 1) + ",\n" + n + JSON.stringify(this.moveStrategy) + "\n" + i + "})" }, r.Ticker.prototype.repr = function (r, t) { var i = Array(t + 1).join("  "), n = i + "  "; return e(this.type, r) + "({\n" + n + "handler: " + this.handler.repr(r, t + 1) + ",\n" + n + "minStep: " + this.minStep.repr(r, t + 1) + "\n" + i + "})" }, r.Slider.prototype.repr = function (r, t) { var i = Array(t + 1).join("  "), n = i + "  "; return e(this.type, r) + "({\n" + n + "sliderAssignment: " + this.sliderAssignment.repr(r, t + 1) + ",\n" + n + "sliderMin: " + (this.sliderMin && this.sliderMin.repr(r, t + 1)) + ",\n" + n + "sliderMax: " + (this.sliderMax && this.sliderMax.repr(r, t + 1)) + ",\n" + n + "sliderStep: " + (this.sliderStep && this.sliderStep.repr(r, t + 1)) + "},\n" + i + ")" } });
define('core/math/features/substitute', ['require', 'parsenodes'], function (require) { "use strict"; var t = require("parsenodes"), i = function (t, i) { return t.map(function (t) { return t.substitute(i) }) }, r = { Identifier: function (t) { return t[this._symbol] ? t[this._symbol] : this }, FunctionCall: function (r) { var n = r[this._symbol]; if (n) { if ("Identifier" === n.type) return t.FunctionCall(n, i(this.args, r)); if ("Constant" === n.type) return t.Multiply([n, 1 === this.args.length ? this.args[0].substitute(r) : t.Constant(NaN)]) } return t.Expression.prototype.substitute.call(this, r) }, Constant: function (t) { return this }, Expression: function (t) { return this.copyWithArgs(i(this.args, t)) }, Derivative: function (r) { var n = r[this._symbol]; if (n) { if ("Identifier" === n.type) return t.Derivative(n, i(this.args, r)); throw new Error("Cannot substitute for a derivative variable with a non-Identifier") } return t.Derivative(this._symbol, i(this.args, r)) } }; for (var n in r) t[n].prototype.substitute = r[n] });
define('core/math/features/simpleFunctionExpression', ['require', 'parsenodes'], function (require) { "use strict"; var n = require("parsenodes"); n.Expression.prototype.simpleFunctionExpression = function () { return this }, n.Assignment.prototype.simpleFunctionExpression = function () { return this._expression }, n.FunctionDefinition.prototype.simpleFunctionExpression = function () { return this._expression }, n.Equation.prototype.simpleFunctionExpression = function () { return this.asComparator().simpleFunctionExpression() } });
define('core/math/distribution-spec', ["require", "exports", "core/math/baseparser", "tslib"], function (require, t, i, s) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.getFunctionSpecFromTree = t.parseToplevelFunction = t.DistributionParameterDefaultsMap = void 0, t.DistributionParameterDefaultsMap = { normaldist: { type: "distribution", symbol: "normaldist", params: ["mean", "stdev"], defaults: ["0", "1"], discrete: !1 }, tdist: { type: "distribution", symbol: "tdist", params: ["dof"], defaults: [void 0], discrete: !1 }, binomialdist: { type: "distribution", symbol: "binomialdist", params: ["trials", "probsuccess"], defaults: [void 0, "0.5"], discrete: !0 }, poissondist: { type: "distribution", symbol: "poissondist", params: ["mean"], defaults: [void 0], discrete: !0 }, uniformdist: { type: "distribution", symbol: "uniformdist", params: ["min", "max"], defaults: ["0", "1"], discrete: !1 } }; var e = { Histogram: { type: "visualization", symbol: "histogram", params: ["data", "binwidth"], defaults: [void 0, "1"] }, DotPlot: { type: "visualization", symbol: "dotplot", params: ["data", "binwidth"], defaults: [void 0, "1"] }, BoxPlot: { type: "visualization", symbol: "boxplot", params: ["data"], defaults: [void 0] } }; function a(i) { var a = i, o = e[a.type]; if (!o) switch ("Assignment" === a.type && (a = a._expression), a.type) { case "FunctionCall": o = t.DistributionParameterDefaultsMap[a._symbol]; break; default: return }if (o) { for (var r = {}, n = o.params, d = a.args, l = 0; l < n.length; l++) { var u = d[l]; r[n[l]] = u && u.getInputString() || "" } return s.__assign(s.__assign({}, o), { span: a.getInputSpan(), values: r }) } } t.parseToplevelFunction = function (t) { return a(i.parse(t, { trailingComma: !0 })) }, t.getFunctionSpecFromTree = a });
define('core/lib/number-to-latex', ["require", "exports"], function (require, e) { "use strict"; function r(e) { var r = e + ""; if (/\d+\.?\d*e[\+\-]*\d+/i.test(r)) { var t = String(r).toLowerCase().split("e"), n = parseFloat(t[0]), i = parseInt(t[1], 10), a = Math.abs(i), o = Math.abs(n).toString().split("."); if (i < 0) r = "0." + new Array(a).join("0") + o.join(""); else { var f = o[1]; f && (a -= f.length), r = o.join("") + new Array(a + 1).join("0") } n < 0 && (r = "-" + r) } return r } Object.defineProperty(e, "__esModule", { value: !0 }), e.numberToStatsConfidenceLatex = e.numberToDecimalString = void 0, e.default = function (e) { if ("string" == typeof e) return e; if (void 0 === e) return ""; if (isNaN(e)) return "\\frac{0}{0}"; if (e === 1 / 0) return "\\infty"; if (e === -1 / 0) return "-\\infty"; var r = e + ""; return r = (r = r.replace(/^1e\+?([-\d]+)/, "10^{$1}")).replace(/([-\d\.]+)e\+?([-\d]+)/, "$1\\cdot 10^{$2}") }, e.numberToDecimalString = r, e.numberToStatsConfidenceLatex = function (e, t) { void 0 === t && (t = 2); var n, i = r(e), a = i.indexOf("."); if (-1 === a) return i; for (var o = a + 1; o < i.length; o++)if (n) { if (i[o] !== n) break } else { if ("0" !== i[o] && "9" !== i[o]) break; n = i[o] } return i.substr(0, Math.max(a + 5, o + t)) } });
define('core/math/ir/features/value-to-latex', ["require", "exports", "core/math/types", "../../../lib/number-to-latex"], function (require, e, t, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.valueToLatex = void 0, e.valueToLatex = function e(a, i) { if (t.isList(a)) { for (var u = [], n = 0; n < i.length; n++)u.push(e(t.elementType(a), i[n])); return "\\left[" + u.join(",") + "\\right]" } switch (a) { case t.Number: return r.default(i); case t.Point: var o = i, l = o[0], f = o[1]; return "\\left(" + r.default(l) + "," + r.default(f) + "\\right)"; default: throw new Error("Cannot serialize a value of type " + t.prettyPrint(a) + ".") } } });
define('core/math/ir/features/action-to-latex', ["require", "exports", "../../../lib/label", "./value-to-latex"], function (require, e, t, a) { "use strict"; function o(e, o) { var i = e.updateRules[o], r = i.valueType, u = i.value; return t.identifierToLatex(o) + "=" + a.valueToLatex(r, u) } Object.defineProperty(e, "__esModule", { value: !0 }), e.actionLatexForSymbol = e.actionToLatex = void 0, e.actionToLatex = function (e) { var t = {}; for (var a in e.updateRules) t[a] = o(e, a); return t }, e.actionLatexForSymbol = o });
define('core/math/evaluationstate', ["require", "exports", "core/vendor/d3-color", "parsenodes", "tslib", "core/math/errormsg", "core/types/graphmode", "core/lib/label", "core/math/distribution-spec", "./types", "./ir/features/action-to-latex"], function (require, e, r, i, a, t, n, s, o, l, u) { "use strict"; function d(e) { return e.isError ? e.getError() : void 0 === e.asValue() ? "" : +e.asValue() } function c() { return { operator: "=", variables: [] } } function p(e, r, i) { var a = e.variables; if (a && a.length) { for (var t = {}, n = 0, s = a; n < s.length; n++) { t[o = s[n]] = !0 } for (var o in i) t[o] = !0; i = t } e.variables = r.sliderVariables(Object.keys(i)) } function g(e, r) { if (r.blocksExport) return !1; var i = r.getDependencies(); if (0 === i.length) return !1; for (var a = 0, t = i; a < t.length; a++) { var n = t[a]; if (!e.validActionVariable(n)) return !1 } return !0 } Object.defineProperty(e, "__esModule", { value: !0 }), e.isErrorExportableActionDefinition = e.addSliderPrompts = e.EvaluationState = e.defaultEvaluationState = void 0, e.defaultEvaluationState = c, e.EvaluationState = function (e, c, v) { if (c.isTable) return function (e, r, i) { for (var a = [], t = 0; t < r.columns.length; t++) { var n = i.columns[t], s = n.isError ? [] : n.values.map(d), o = { dependent: !n.isIndependent, discrete: !!n.isIndependent, values: s }; n.isError && (o.error = n.getError()), a.push(o) } return { column_data: a } }(0, c, v); if (c.isImage) return function (e, r, a) { var t = { variables: [], errorMap: {}, dimensions: {} }; if (a.center.isError && (t.errorMap.center = !0), a.radianAngle.isError && (t.errorMap.angle = !0), a.width.isError && (t.errorMap.width = !0), a.height.isError && (t.errorMap.height = !0), a.opacity.isError && (t.errorMap.opacity = !0), a.center.isError || a.radianAngle.isError || a.width.isError || a.height.isError || a.opacity.isError) return t.variables = r.getSliderVariables(e, a), t; t.dimensions.x = [], t.dimensions.y = [], t.dimensions.radianAngle = [], t.dimensions.width = [], t.dimensions.height = [], t.dimensions.opacity = []; var s = [a.center, a.radianAngle, a.width, a.height, a.opacity]; return s.some(function (e) { return e && e.valueType && l.isList(e.valueType) }) && (t.is_concrete_list = !0), i.List.eachArgs(s, function (e) { var r = e[0].asValue(), i = +e[1].asValue(), a = Math.atan2(Math.sin(i), Math.cos(i)); t.dimensions.x.push(+r[0]), t.dimensions.y.push(+r[1]), t.dimensions.radianAngle.push(a), t.dimensions.width.push(+e[2].asValue()), t.dimensions.height.push(+e[3].asValue()), t.dimensions.opacity.push(Math.max(0, Math.min(1, +e[4].asValue()))) }), (e.graphingEnabled() ? r.getGraphMode(e, a) : n.NONE) !== n.NONE && (t.is_graphable = !0), a.moveStrategy && (t.move_strategy = a.moveStrategy), r.center && ("Identifier" === r.center.type ? (t.center_reference_id = r.center.referencedStatementId, t.center_reference_symbol = r.center._symbol) : "ParenSeq" === r.center.type && a.center.valueType === l.Point && (t.center_is_point_literal = !0)), t }(e, c, v); if (c instanceof i.Ticker) return function (e, r, i) { for (var n, s = i.handler, o = i.minStep, l = {}, u = {}, d = 0, c = s.getDependencies(); d < c.length; d++) { var v = c[d]; e.validActionVariable(v) || (l[v] = !0) } for (var f = 0, m = o.getDependencies(); f < m.length; f++)u[v = m[f]] = !0; if (o.isError) n = { status: "error", error: o.getError() }; else { var h = o.asValue(); n = "number" == typeof h && !isNaN(h) && h >= 0 ? { status: "valid", value: h } : { status: "error", error: t.tickerMinStepNonNegativeNumber().getError() } } var b = Object.keys(l); b.length > 0 && (s = t.tooManyVariables(b).setDependencies(s.getDependencies())); var _ = { handler: s.isError && !g(e, s) ? { status: "error", error: s.getError() } : s.isEmptyAction ? { status: "empty" } : { status: "maybe-valid" }, minStep: n, variables: [] }; return p(_, e, a.__assign(a.__assign({}, l), u)), _ }(e, 0, v); var f = { operator: "=", variables: [] }; if (v.isError && (!(c instanceof i.FunctionDefinition) || v.blocksExport)) return f.error = v.getError(), f.variables = c.getSliderVariables(e, v), f.is_single_identifier = c instanceof i.Identifier, v.actionValue && (f.action_value = u.actionToLatex(v.actionValue)), f; if (v.valueType === l.RGBColor && 0 === v.getDependencies().length) { var m = v.asValue(); f.rgb_value = r.rgb(m[0], m[1], m[2]).formatHex() } v.valueType === l.Action && 0 === v.getDependencies().length && (f.action_value = u.actionToLatex(v.asValue())), v.moveStrategy && (f.move_strategy = v.moveStrategy, f.default_drag_mode = v.defaultDragMode), c.isInequality() && (f.is_inequality = !0), f.operator = c.getOperator(), v instanceof i.SolvedEquation ? !0 !== v._expression.asValue() && !1 !== v._expression.asValue() && (f.assignment = v._symbol) : c instanceof i.Assignment && (f.assignment = c._symbol); var h = e.graphingEnabled() ? c.getGraphMode(e, v) : n.NONE; if (h !== n.NONE) { f.is_graphable = !0, f.expression_type = c.getExpressionType(h, v.valueType), v.isShadeBetween() && (f.is_shade_between = !0); var b = c.tableInfo(e, v); b && (f.is_tableable = !0, f.table_info = b) } if (void 0 !== v.valueType && l.isList(v.valueType) && (f.is_concrete_list = !0, v.valueType === l.ListOfColor && 0 === v.getDependencies().length)) { var _ = v.asValue(); _ && (f.rgb_value = _.map(function (e) { return r.rgb(e[0], e[1], e[2]).formatHex() })) } f.variables = f.is_graphable ? [] : c.getSliderVariables(e, v), f.is_single_identifier = c instanceof i.Identifier, v.isConstant && (f.constant_value = v.asValue()); var y = v.getEvaluationInfo(); if (!y || "=" !== f.operator || c.isConstant || c.isFunction || v.valueType === l.Bool || v.valueType === l.ListOfBool || c instanceof i.Equation || c instanceof i.And || (f.is_evaluable = !0, f.zero_values = y), v instanceof i.OptimizedRegression) { var E = v, V = {}; for (var S in E.parameters) E.parameters.hasOwnProperty(S) && (V[s.identifierToLatex(S)] = +E.parameters[S].asValue()); f.is_regression = !0, f.regression = { parameters: V, residualVariable: s.identifierToLatex(E.residualVariable), residualSuggestionId: E.residualSuggestionId, shouldSuggestLogMode: E.shouldSuggestLogMode, isLinear: E.isLinear, statistics: E.statistics, parameterWarning: E.parameterWarning } } var x = o.getFunctionSpecFromTree(c); return x && x.discrete && (f.is_discrete_distribution = !0), f }, e.addSliderPrompts = p, e.isErrorExportableActionDefinition = g });
define('core/math/workerconfig', [], function () { "use strict"; return { pointsOfInterest: !0, plotSingleVariableImplicitEquations: !0, plotImplicits: !0, plotInequalities: !0, sliders: !0 } });
define('core/math/statementanalysis', ['require', 'core/math/evaluationstate', 'pjs', 'core/types/graphmode', 'core/math/workerconfig'], function (require) { "use strict"; var e = require("core/math/evaluationstate").EvaluationState, t = require("pjs"), r = require("core/types/graphmode"), i = require("core/math/workerconfig"); return t(function (t) { t.init = function (t, r, i) { this.policy = t, this.rawTree = r, this.concreteTree = i, this.evaluationState = e(t, r, i) }, t.exportTo = function (e, t) { this.rawTree.exportTo(e, this.concreteTree, t) }, t.graph = function (e) { return this.rawTree.tryGraph(this.policy, this.concreteTree, e) }, t.getGraphMode = function () { return this.rawTree.getGraphMode(this.policy, this.concreteTree) }, t.getGraphInfo = function () { return this.rawTree.getGraphInfo(this.policy, this.concreteTree) }, t.shouldIntersect = function () { if (!this.evaluationState.is_graphable) return !1; if (!this.rawTree.userData.shouldGraph) return !1; if (!i.pointsOfInterest) return !1; var e = this.getGraphMode(); return e === r.X || e === r.Y } }) });
define('core/math/expression-types', ["require", "exports"], function (require, i) { "use strict"; var s; Object.defineProperty(i, "__esModule", { value: !0 }), i.isClickableExpressionType = i.getReconciledExpressionProps = i.EXPRESSION_PROP_DEFAULTS = i.ExpressionType = void 0, function (i) { i.X_OR_Y = "X_OR_Y", i.SINGLE_POINT = "SINGLE_POINT", i.POINT_LIST = "POINT_LIST", i.PARAMETRIC = "PARAMETRIC", i.POLAR = "POLAR", i.IMPLICIT = "IMPLICIT", i.POLYGON = "POLYGON", i.HISTOGRAM = "HISTOGRAM", i.DOTPLOT = "DOTPLOT", i.BOXPLOT = "BOXPLOT", i.TTEST = "TTEST", i.STATS = "STATS", i.CUBE = "CUBE", i.SPHERE = "SPHERE" }(s = i.ExpressionType || (i.ExpressionType = {})), i.EXPRESSION_PROP_DEFAULTS = { X_OR_Y: { points: !1, lines: !0, fill: !1 }, SINGLE_POINT: { points: !0, lines: !1, fill: !1 }, POINT_LIST: { points: !0, lines: !1, fill: !1 }, PARAMETRIC: { points: !1, lines: !0, fill: !1 }, POLAR: { points: !1, lines: !0, fill: !1 }, IMPLICIT: { points: !1, lines: !0, fill: !1 }, POLYGON: { points: !1, lines: !0, fill: !0 }, HISTOGRAM: { points: !1, lines: !0, fill: !0 }, DOTPLOT: { points: !0, lines: !1, fill: !1 }, BOXPLOT: { points: !1, lines: !0, fill: !1 }, TTEST: { points: !1, lines: !1, fill: !1 }, STATS: { points: !1, lines: !1, fill: !1 }, CUBE: { points: !1, lines: !1, fill: !0 }, SPHERE: { points: !1, lines: !1, fill: !0 } }, i.getReconciledExpressionProps = function (e, T) { if (void 0 === e) return { points: !1, lines: !1, fill: !1 }; var l = i.EXPRESSION_PROP_DEFAULTS[e]; switch (e) { case s.SINGLE_POINT: return { points: !0, lines: !1, fill: !1 }; case s.POINT_LIST: case s.DOTPLOT: return { points: void 0 === T.points ? l.points : T.points, lines: void 0 === T.lines ? l.lines : T.lines, fill: !1 }; case s.PARAMETRIC: case s.POLYGON: case s.X_OR_Y: case s.POLAR: case s.IMPLICIT: case s.HISTOGRAM: case s.BOXPLOT: case s.TTEST: case s.STATS: case s.CUBE: case s.SPHERE: return { points: !1, lines: void 0 === T.lines ? l.lines : T.lines, fill: void 0 === T.fill ? l.fill : T.fill }; default: return e } }, i.isClickableExpressionType = function (i) { if (void 0 === i) return !1; switch (i) { case s.SINGLE_POINT: case s.POINT_LIST: case s.PARAMETRIC: case s.POLYGON: case s.X_OR_Y: case s.POLAR: case s.IMPLICIT: return !0; case s.HISTOGRAM: case s.BOXPLOT: case s.DOTPLOT: case s.TTEST: case s.STATS: case s.CUBE: case s.SPHERE: return !1; default: return i } } });
define('core/math/ir/features/reapply-restrictions', ["require", "exports", "../instructions", "../opcodes", "./get-dependency-mask"], function (require, e, r, n, t) { "use strict"; function s(e, r) { for (var n = [], t = 0, s = r; t < s.length; t++) { var i = s[t]; n.push(e[i]) } return n } Object.defineProperty(e, "__esModule", { value: !0 }), e.reapplyRestrictions = void 0, e.reapplyRestrictions = function (e, i) { for (var p = [], o = e.returnIndex, u = t.getDependencyMask(e, i.mappedArgIndex), c = function (e, t, s) { for (var i = [], p = 0; p < s; p++)i.push(!1); i[s] = t[s]; for (p = s; p >= 0; p--)if (i[p] && t[p]) { var o = e.getInstruction(p); if (o.type === n.Piecewise) i[o.args[1]] = !0; else if (!r.isLeafInstruction(o)) for (var u = 0, c = o.args; u < c.length; u++) { i[c[u]] = !0 } } return i }(e, u, i.mappedReturnIndex), a = o, f = e.NanOfType(e.getReturnType()), d = 0; d < i.mappedReturnIndex; d++) { var g = e.getInstruction(d); if (d !== i.mappedArgIndex) if (u[d] || e.isInClosedBlock(d)) if (r.isLeafInstruction(g)) p.push(e.copyInstruction(g)); else { var l = s(p, g.args); p.push(e.copyInstructionWithArgs(g, l)), g.type === n.Piecewise && c[d] && (a = e.Piecewise([l[0], a, f])) } else p.push(d); else p.push(o) } return a } });
define('core/math/ir/features/solve', ["require", "exports", "parsenodes", "core/math/workerconfig", "core/math/parsenode/irexpression", "core/math/errormsg", "../build-ir", "../dependencies", "core/math/comparators", "../opcodes", "./fuse-broadcast", "./reapply-restrictions", "core/math/types", "core/math/maybe-rational"], function (require, e, i, r, t, a, n, s, c, l, o, u, d, v) { "use strict"; function f(e, i) { return i ? function (e) { var i = e.chunk, r = e.coefficients, t = r[0], a = r[1], n = r[2], s = i.Constant(v.maybeRational(0, 1)); void 0 === n && (n = s); void 0 === a && (a = s); void 0 === t && (t = s); var c = i.Constant(v.maybeRational(2, 1)), l = i.Constant(NaN), o = i.Constant(v.maybeRational(1e305, 1)), u = i.Negative([o]), d = i.Multiply([c, n]), f = i.Negative([a]), p = i.Subtract([i.Multiply([a, a]), i.Multiply([c, i.Multiply([d, t])])]), g = i.SyntheticNativeFunction("sqrt", [p]), m = i.Divide([i.Add([f, g]), d]), y = i.Divide([i.Subtract([f, g]), d]), b = i.Negative([i.Divide([t, a])]), h = i.Equal([n, s]), w = i.Greater([n, s]), P = i.Equal([a, s]), I = i.Greater([a, s]), N = i.Less([a, s]), O = i.Greater([t, s]), q = i.Less([p, s]); return [i.Piecewise([h, i.Piecewise([N, b, l]), i.Piecewise([w, y, l])]), i.Piecewise([h, i.Piecewise([P, i.Piecewise([O, u, l]), l]), i.Piecewise([w, i.Piecewise([q, u, l]), m])]), i.Piecewise([h, i.Piecewise([P, i.Piecewise([O, o, l]), l]), i.Piecewise([w, i.Piecewise([q, o, l]), y])]), i.Piecewise([h, i.Piecewise([I, b, l]), i.Piecewise([w, m, l])])] }(e) : function (e) { var i = e.chunk, r = e.coefficients, t = r[0], a = r[1], n = r[2], s = i.Constant(v.maybeRational(0, 1)), c = i.Constant(NaN); if (void 0 === n) { void 0 === a && (a = s); var o = i.Negative([i.Divide([t, a])]), u = i.Equal([a, s]); return [i.Piecewise([u, c, o])] } var d = i.Constant(v.maybeRational(2, 1)), f = i.Multiply([d, n]), p = i.Negative([a]), g = i.Subtract([i.Multiply([a, a]), i.Multiply([d, i.Multiply([f, t])])]), m = i.Equal([n, s]), y = i.getInstruction(g); if (y.type === l.Constant && 0 === v.asFloat(y.value)) return [i.Piecewise([m, c, i.Divide([p, f])])]; var b = i.SyntheticNativeFunction("sqrt", [g]), h = i.Less([a, s]), w = i.Greater([a, s]), P = i.Divide([i.Add([p, b]), f]), I = i.Divide([i.Subtract([p, b]), f]); o = i.Negative([i.Divide([t, a])]); return [i.Piecewise([m, i.Piecewise([h, o, c]), I]), i.Piecewise([m, i.Piecewise([w, o, c]), P])] }(e) } Object.defineProperty(e, "__esModule", { value: !0 }), e.trySolve = void 0, e.trySolve = function (e, v) { try { return function (e, v) { for (var p = e.policy, g = e.frame, m = s.getFreeDependencies(g, v), y = [], b = 0; b < m.length; b++)y.push(d.Number); var h = n.buildIRContext({ policy: p, frame: g, argNames: m, argTypes: y }), w = h.chunk, P = n.addToIR(h, v.args[0]), I = n.addToIR(h, v.args[1]), N = v.getOperator(), O = "=" !== N; switch (N) { case "<": w.Less([P, I]); break; case ">": w.Greater([P, I]); break; case "<=": w.LessEqual([P, I]); break; case ">=": w.GreaterEqual([P, I]); break; case "=": w.Equal([P, I]) }if (w.returnIndex = o.fuseBroadcast(w, w.returnIndex), w.isConstant()) return new t(w.close()); var q = w.getInstruction(P).type !== l.LoadArg || -1 !== s.getFreeDependencies(g, v.args[1]).indexOf(w.argNames[P]); if (!r.plotImplicits && q) throw a.implicitsDisabled(); -1 === c.table[N].direction ? w.Subtract([I, P]) : w.Subtract([P, I]); w.close(); var D = w.getLiveArgNames(); if (0 === D.length) throw a.parseError(); if (1 === D.length && !O && !r.plotSingleVariableImplicitEquations) return a.singleVariableImplicitEquationsDisabled(); if (D.length > 2) return a.tooManyVariables(p.sliderVariables(D)).setDependencies(D); if (O && !p.validInequalityVariables(D)) return a.invalidInequalityVariables().setDependencies(D); var C = function (e, i) { var r = e.chunk, t = e.policy, a = r.argNames, n = d.isList(r.getReturnType()), s = []; e: for (var c = 0; c < a.length; c++) { var l = a[c], o = a.length > 1 && !t.validSolvedVariable(l); s[c] = { localFrames: [], effectiveOrder: 0, variableOfInterest: l }; var u = !i; if (o) s[c].effectiveOrder = 1 / 0; else { var v = n ? r.getConstantListLength() : 1; if (null == v) throw new Error("Programming error: cannot solve a variable-length list expression"); for (var f = 0; f < v; f++) { var p = n ? r.elementAt(f) : r; if (p.polynomialOrder(l, { allowRestriction: u, allowClosedBlockReferences: !1 }) > 2) { s[c].effectiveOrder = 1 / 0; continue e } var g = p.getPolynomialCoefficients(l); s[c].localFrames.push(g), s[c].effectiveOrder = Math.max(s[c].effectiveOrder, g.coefficients.length - 1) } } } return 1 === a.length ? s[0] : ("y" === a[0] && (s = [s[1], s[0]]), 0 === s[0].effectiveOrder ? s[1] : 0 === s[1].effectiveOrder ? s[0] : s[s[0].effectiveOrder < s[1].effectiveOrder ? 0 : 1]) }(h, O), E = C.localFrames, R = C.effectiveOrder, S = C.variableOfInterest; if (p.complicatedPolarImplicit(S, R)) return a.complicatedPolarImplicit().setDependencies(D); if (!p.validImplicitVariables(D)) return a.invalidImplicitVariables(); if (R > 2) return new t(w.close()); for (var k = [], L = 1, M = 0, x = E; M < x.length; M++) { var V = x[M], F = f(V, O); L = F.length; for (var G = 0, A = F; G < A.length; G++) { var T = A[G], B = V.chunk.copy(); B.returnIndex = T, V.isRestrictedPolynomial && (B.returnIndex = u.reapplyRestrictions(B, V)), B.close(), k.push(new t(B)) } } return i.SolvedEquation(S, i.List(k), L) }(e, v) } catch (e) { return e instanceof i.Base ? e : a.parseError() } } });
define('numeric', [], function () { "use strict"; var r = "undefined" == typeof exports ? function () { } : exports; return "undefined" != typeof global && (global.numeric = r), r.version = "1.2.6", r._myIndexOf = function (r) { var n, e = this.length; for (n = 0; n < e; ++n)if (this[n] === r) return n; return -1 }, r.myIndexOf = Array.prototype.indexOf ? Array.prototype.indexOf : r._myIndexOf, r.precision = 4, r.largeArray = 50, r.compile = function () { var n = Array.prototype.slice.call(arguments), e = n.pop(); return e = "return function (" + n.join(",") + ") {" + e + "}", new Function(["numeric"], e)(r) }, r._dim = function (r) { for (var n = []; "object" == typeof r;)n.push(r.length), r = r[0]; return n }, r.dim = function (n) { var e; return "object" == typeof n ? "object" == typeof (e = n[0]) ? "object" == typeof e[0] ? r._dim(n) : [n.length, e.length] : [n.length] : [] }, r.mapreduce = function (n, e) { return r.compile("x", "accum", "_s", "_k", 'if(typeof accum === "undefined") accum = ' + e + ';\nif(typeof x === "number") { var xi = x; ' + n + '; return accum; }\nif(typeof _s === "undefined") _s = numeric.dim(x);\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i,xi;\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) {\n        accum = arguments.callee(x[i],accum,_s,_k+1);\n    }    return accum;\n}\nfor(i=_n-1;i>=1;i-=2) { \n    xi = x[i];\n    ' + n + ";\n    xi = x[i-1];\n    " + n + ";\n}\nif(i === 0) {\n    xi = x[i];\n    " + n + "\n}\nreturn accum;") }, r.mapreduce2 = function (n, e) { return r.compile("x", "var n = x.length;\nvar i,xi;\n" + e + "\nfor(i=n-1;i!==-1;--i) { \n    xi = x[i];\n    " + n + "\n}\nreturn accum;") }, r.rep = function (n, e, t) { void 0 === t && (t = 0); var i, o = n[t], a = Array(o); if (t === n.length - 1) { for (i = o - 2; i >= 0; i -= 2)a[i + 1] = e, a[i] = e; return -1 === i && (a[0] = e), a } for (i = o - 1; i >= 0; i--)a[i] = r.rep(n, e, t + 1); return a }, r.dotMMsmall = function (r, n) { var e, t, i, o, a, f, u, c, s, m, l; for (o = r.length, a = n.length, f = n[0].length, u = Array(o), e = o - 1; e >= 0; e--) { for (c = Array(f), s = r[e], i = f - 1; i >= 0; i--) { for (m = s[a - 1] * n[a - 1][i], t = a - 2; t >= 1; t -= 2)l = t - 1, m += s[t] * n[t][i] + s[l] * n[l][i]; 0 === t && (m += s[0] * n[0][i]), c[i] = m } u[e] = c } return u }, r._getCol = function (r, n, e) { var t; for (t = r.length - 1; t > 0; --t)e[t] = r[t][n], e[--t] = r[t][n]; 0 === t && (e[0] = r[0][n]) }, r.dotMMbig = function (n, e) { var t, i, o, a = r._getCol, f = e.length, u = Array(f), c = n.length, s = e[0].length, m = new Array(c), l = r.dotVV; for (--f, i = --c; -1 !== i; --i)m[i] = Array(s); for (i = --s; -1 !== i; --i)for (a(e, i, u), o = c; -1 !== o; --o)0, t = n[o], m[o][i] = l(t, u); return m }, r.dotMV = function (n, e) { var t, i = n.length, o = (e.length, Array(i)), a = r.dotVV; for (t = i - 1; t >= 0; t--)o[t] = a(n[t], e); return o }, r.dotVM = function (r, n) { var e, t, i, o, a, f, u; for (i = r.length, o = n[0].length, a = Array(o), t = o - 1; t >= 0; t--) { for (f = r[i - 1] * n[i - 1][t], e = i - 2; e >= 1; e -= 2)u = e - 1, f += r[e] * n[e][t] + r[u] * n[u][t]; 0 === e && (f += r[0] * n[0][t]), a[t] = f } return a }, r.dotVV = function (r, n) { var e, t, i = r.length, o = r[i - 1] * n[i - 1]; for (e = i - 2; e >= 1; e -= 2)t = e - 1, o += r[e] * n[e] + r[t] * n[t]; return 0 === e && (o += r[0] * n[0]), o }, r.dot = function (n, e) { var t = r.dim; switch (1e3 * t(n).length + t(e).length) { case 2002: return e.length < 10 ? r.dotMMsmall(n, e) : r.dotMMbig(n, e); case 2001: return r.dotMV(n, e); case 1002: return r.dotVM(n, e); case 1001: return r.dotVV(n, e); case 1e3: return r.mulVS(n, e); case 1: return r.mulSV(n, e); case 0: return n * e; default: throw new Error("numeric.dot only works on vectors and matrices") } }, r.diag = function (r) { var n, e, t, i, o = r.length, a = Array(o); for (n = o - 1; n >= 0; n--) { for (i = Array(o), e = n + 2, t = o - 1; t >= e; t -= 2)i[t] = 0, i[t - 1] = 0; for (t > n && (i[t] = 0), i[n] = r[n], t = n - 1; t >= 1; t -= 2)i[t] = 0, i[t - 1] = 0; 0 === t && (i[0] = 0), a[n] = i } return a }, r.getDiag = function (r) { var n, e = Math.min(r.length, r[0].length), t = Array(e); for (n = e - 1; n >= 1; --n)t[n] = r[n][n], t[--n] = r[n][n]; return 0 === n && (t[0] = r[0][0]), t }, r.identity = function (n) { return r.diag(r.rep([n], 1)) }, r.pointwise = function (n, e, t) { void 0 === t && (t = ""); var i, o, a = [], f = /\[i\]$/, u = "", c = !1; for (i = 0; i < n.length; i++)f.test(n[i]) ? u = o = n[i].substring(0, n[i].length - 3) : o = n[i], "ret" === o && (c = !0), a.push(o); return a[n.length] = "_s", a[n.length + 1] = "_k", a[n.length + 2] = 'if(typeof _s === "undefined") _s = numeric.dim(' + u + ');\nif(typeof _k === "undefined") _k = 0;\nvar _n = _s[_k];\nvar i' + (c ? "" : ", ret = Array(_n)") + ";\nif(_k < _s.length-1) {\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee(" + n.join(",") + ",_s,_k+1);\n    return ret;\n}\n" + t + "\nfor(i=_n-1;i!==-1;--i) {\n    " + e + "\n}\nreturn ret;", r.compile.apply(null, a) }, r.pointwise2 = function (n, e, t) { void 0 === t && (t = ""); var i, o, a = [], f = /\[i\]$/, u = "", c = !1; for (i = 0; i < n.length; i++)f.test(n[i]) ? u = o = n[i].substring(0, n[i].length - 3) : o = n[i], "ret" === o && (c = !0), a.push(o); return a[n.length] = "var _n = " + u + ".length;\nvar i" + (c ? "" : ", ret = Array(_n)") + ";\n" + t + "\nfor(i=_n-1;i!==-1;--i) {\n" + e + "\n}\nreturn ret;", r.compile.apply(null, a) }, r._biforeach = function r(n, e, t, i, o) { var a; if (i !== t.length - 1) for (a = t[i] - 1; a >= 0; a--)r("object" == typeof n ? n[a] : n, "object" == typeof e ? e[a] : e, t, i + 1, o); else o(n, e) }, r._biforeach2 = function r(n, e, t, i, o) { if (i === t.length - 1) return o(n, e); var a, f = t[i], u = Array(f); for (a = f - 1; a >= 0; --a)u[a] = r("object" == typeof n ? n[a] : n, "object" == typeof e ? e[a] : e, t, i + 1, o); return u }, r._foreach = function r(n, e, t, i) { var o; if (t !== e.length - 1) for (o = e[t] - 1; o >= 0; o--)r(n[o], e, t + 1, i); else i(n) }, r._foreach2 = function r(n, e, t, i) { if (t === e.length - 1) return i(n); var o, a = e[t], f = Array(a); for (o = a - 1; o >= 0; o--)f[o] = r(n[o], e, t + 1, i); return f }, r.ops2 = { add: "+", sub: "-", mul: "*", div: "/", mod: "%", and: "&&", or: "||", eq: "===", neq: "!==", lt: "<", gt: ">", leq: "<=", geq: ">=", band: "&", bor: "|", bxor: "^", lshift: "<<", rshift: ">>", rrshift: ">>>" }, r.opseq = { addeq: "+=", subeq: "-=", muleq: "*=", diveq: "/=", modeq: "%=", lshifteq: "<<=", rshifteq: ">>=", rrshifteq: ">>>=", bandeq: "&=", boreq: "|=", bxoreq: "^=" }, r.mathfuns = ["abs", "acos", "asin", "atan", "ceil", "cos", "exp", "floor", "log", "round", "sin", "sqrt", "tan", "isNaN", "isFinite"], r.mathfuns2 = ["atan2", "pow", "max", "min"], r.ops1 = { neg: "-", not: "!", bnot: "~", clone: "" }, r.mapreducers = { any: ["if(xi) return true;", "var accum = false;"], all: ["if(!xi) return false;", "var accum = true;"], sum: ["accum += xi;", "var accum = 0;"], prod: ["accum *= xi;", "var accum = 1;"], norm2Squared: ["accum += xi*xi;", "var accum = 0;"], norminf: ["accum = max(accum,abs(xi));", "var accum = 0, max = Math.max, abs = Math.abs;"], norm1: ["accum += abs(xi);", "var accum = 0, abs = Math.abs;"], sup: ["accum = max(accum,xi);", "var accum = -Infinity, max = Math.max;"], inf: ["accum = min(accum,xi);", "var accum = Infinity, min = Math.min;"] }, function () { var n, e; for (n = 0; n < r.mathfuns2.length; ++n)e = r.mathfuns2[n], r.ops2[e] = e; for (n in r.ops2) if (r.ops2.hasOwnProperty(n)) { e = r.ops2[n]; var t, i, o = ""; -1 !== r.myIndexOf.call(r.mathfuns2, n) ? (o = "var " + e + " = Math." + e + ";\n", t = function (r, n, t) { return r + " = " + e + "(" + n + "," + t + ")" }, i = function (r, n) { return r + " = " + e + "(" + r + "," + n + ")" }) : (t = function (r, n, t) { return r + " = " + n + " " + e + " " + t }, i = r.opseq.hasOwnProperty(n + "eq") ? function (r, n) { return r + " " + e + "= " + n } : function (r, n) { return r + " = " + r + " " + e + " " + n }), r[n + "VV"] = r.pointwise2(["x[i]", "y[i]"], t("ret[i]", "x[i]", "y[i]"), o), r[n + "SV"] = r.pointwise2(["x", "y[i]"], t("ret[i]", "x", "y[i]"), o), r[n + "VS"] = r.pointwise2(["x[i]", "y"], t("ret[i]", "x[i]", "y"), o), r[n] = r.compile("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric." + n + "VV, VS = numeric." + n + "VS, SV = numeric." + n + 'SV;\nvar dim = numeric.dim;\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof x === "object") {\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\n  else ' + i("x", "y") + "\n}\nreturn x;\n"), r[e] = r[n], r[n + "eqV"] = r.pointwise2(["ret[i]", "x[i]"], i("ret[i]", "x[i]"), o), r[n + "eqS"] = r.pointwise2(["ret[i]", "x"], i("ret[i]", "x"), o), r[n + "eq"] = r.compile("var n = arguments.length, i, x = arguments[0], y;\nvar V = numeric." + n + "eqV, S = numeric." + n + 'eqS\nvar s = numeric.dim(x);\nfor(i=1;i!==n;++i) { \n  y = arguments[i];\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\n  else numeric._biforeach(x,y,s,0,S);\n}\nreturn x;\n') } for (n = 0; n < r.mathfuns2.length; ++n)e = r.mathfuns2[n], delete r.ops2[e]; for (n = 0; n < r.mathfuns.length; ++n)e = r.mathfuns[n], r.ops1[e] = e; for (n in r.ops1) r.ops1.hasOwnProperty(n) && (o = "", e = r.ops1[n], -1 !== r.myIndexOf.call(r.mathfuns, n) && Math.hasOwnProperty(e) && (o = "var " + e + " = Math." + e + ";\n"), r[n + "eqV"] = r.pointwise2(["ret[i]"], "ret[i] = " + e + "(ret[i]);", o), r[n + "eq"] = r.compile("x", 'if(typeof x !== "object") return ' + e + "x\nvar i;\nvar V = numeric." + n + "eqV;\nvar s = numeric.dim(x);\nnumeric._foreach(x,s,0,V);\nreturn x;\n"), r[n + "V"] = r.pointwise2(["x[i]"], "ret[i] = " + e + "(x[i]);", o), r[n] = r.compile("x", 'if(typeof x !== "object") return ' + e + "(x)\nvar i;\nvar V = numeric." + n + "V;\nvar s = numeric.dim(x);\nreturn numeric._foreach2(x,s,0,V);\n")); for (n = 0; n < r.mathfuns.length; ++n)e = r.mathfuns[n], delete r.ops1[e]; for (n in r.mapreducers) r.mapreducers.hasOwnProperty(n) && (e = r.mapreducers[n], r[n + "V"] = r.mapreduce2(e[0], e[1]), r[n] = r.compile("x", "s", "k", e[1] + 'if(typeof x !== "object") {    xi = x;\n' + e[0] + '\n    return accum;\n}if(typeof s === "undefined") s = numeric.dim(x);\nif(typeof k === "undefined") k = 0;\nif(k === s.length-1) return numeric.' + n + "V(x);\nvar xi;\nvar n = x.length, i;\nfor(i=n-1;i!==-1;--i) {\n   xi = arguments.callee(x[i]);\n" + e[0] + "\n}\nreturn accum;\n")) }(), r.inv = function (n) { var e, t, i, o, a, f, u, c = r.dim(n), s = Math.abs, m = c[0], l = c[1], h = r.clone(n), d = r.identity(m); for (f = 0; f < l; ++f) { var p = -1, y = -1; for (a = f; a !== m; ++a)(u = s(h[a][f])) > y && (p = a, y = u); for (t = h[p], h[p] = h[f], h[f] = t, o = d[p], d[p] = d[f], d[f] = o, n = t[f], u = f; u !== l; ++u)t[u] /= n; for (u = l - 1; -1 !== u; --u)o[u] /= n; for (a = m - 1; -1 !== a; --a)if (a !== f) { for (e = h[a], i = d[a], n = e[f], u = f + 1; u !== l; ++u)e[u] -= t[u] * n; for (u = l - 1; u > 0; --u)i[u] -= o[u] * n, i[--u] -= o[u] * n; 0 === u && (i[0] -= o[0] * n) } } return d }, r.det = function (n) { var e = r.dim(n); if (2 !== e.length || e[0] !== e[1]) throw new Error("numeric: det() only works on square matrices"); var t, i, o, a, f, u, c, s, m = e[0], l = 1, h = r.clone(n); for (i = 0; i < m - 1; i++) { for (o = i, t = i + 1; t < m; t++)Math.abs(h[t][i]) > Math.abs(h[o][i]) && (o = t); for (o !== i && (c = h[o], h[o] = h[i], h[i] = c, l *= -1), a = h[i], t = i + 1; t < m; t++) { for (u = (f = h[t])[i] / a[i], o = i + 1; o < m - 1; o += 2)s = o + 1, f[o] -= a[o] * u, f[s] -= a[s] * u; o !== m && (f[o] -= a[o] * u) } if (0 === a[i]) return 0; l *= a[i] } return l * h[i][i] }, r.transpose = function (r) { var n, e, t, i, o, a = r.length, f = r[0].length, u = Array(f); for (e = 0; e < f; e++)u[e] = Array(a); for (n = a - 1; n >= 1; n -= 2) { for (i = r[n], t = r[n - 1], e = f - 1; e >= 1; --e)(o = u[e])[n] = i[e], o[n - 1] = t[e], (o = u[--e])[n] = i[e], o[n - 1] = t[e]; 0 === e && ((o = u[0])[n] = i[0], o[n - 1] = t[0]) } if (0 === n) { for (t = r[0], e = f - 1; e >= 1; --e)u[e][0] = t[e], u[--e][0] = t[e]; 0 === e && (u[0][0] = t[0]) } return u }, r.negtranspose = function (r) { var n, e, t, i, o, a = r.length, f = r[0].length, u = Array(f); for (e = 0; e < f; e++)u[e] = Array(a); for (n = a - 1; n >= 1; n -= 2) { for (i = r[n], t = r[n - 1], e = f - 1; e >= 1; --e)(o = u[e])[n] = -i[e], o[n - 1] = -t[e], (o = u[--e])[n] = -i[e], o[n - 1] = -t[e]; 0 === e && ((o = u[0])[n] = -i[0], o[n - 1] = -t[0]) } if (0 === n) { for (t = r[0], e = f - 1; e >= 1; --e)u[e][0] = -t[e], u[--e][0] = -t[e]; 0 === e && (u[0][0] = -t[0]) } return u }, r.norm2 = function (n) { return Math.sqrt(r.norm2Squared(n)) }, r.linspace = function (r, n, e) { if (void 0 === e && (e = Math.max(Math.round(n - r) + 1, 1)), e < 2) return 1 === e ? [r] : []; var t, i = Array(e); for (t = --e; t >= 0; t--)i[t] = (t * n + (e - t) * r) / e; return i }, r.getBlock = function (n, e, t) { var i = r.dim(n); return function r(n, o) { var a, f = e[o], u = t[o] - f, c = Array(u); if (o === i.length - 1) { for (a = u; a >= 0; a--)c[a] = n[a + f]; return c } for (a = u; a >= 0; a--)c[a] = r(n[a + f], o + 1); return c }(n, 0) }, r.setBlock = function (n, e, t, i) { var o = r.dim(n); return function r(n, i, a) { var f, u = e[a], c = t[a] - u; if (a === o.length - 1) for (f = c; f >= 0; f--)n[f + u] = i[f]; for (f = c; f >= 0; f--)r(n[f + u], i[f], a + 1) }(n, i, 0), n }, r.getRange = function (r, n, e) { var t, i, o, a, f = n.length, u = e.length, c = Array(f); for (t = f - 1; -1 !== t; --t)for (c[t] = Array(u), o = c[t], a = r[n[t]], i = u - 1; -1 !== i; --i)o[i] = a[e[i]]; return c }, r.blockMatrix = function (n) { var e = r.dim(n); if (e.length < 4) return r.blockMatrix([n]); var t, i, o, a, f, u = e[0], c = e[1]; for (t = 0, i = 0, o = 0; o < u; ++o)t += n[o][0].length; for (a = 0; a < c; ++a)i += n[0][a][0].length; var s = Array(t); for (o = 0; o < t; ++o)s[o] = Array(i); var m, l, h, d, p, y = 0; for (o = 0; o < u; ++o) { for (m = i, a = c - 1; -1 !== a; --a)for (m -= (f = n[o][a])[0].length, h = f.length - 1; -1 !== h; --h)for (p = f[h], l = s[y + h], d = p.length - 1; -1 !== d; --d)l[m + d] = p[d]; y += n[o][0].length } return s }, r.tensor = function (n, e) { if ("number" == typeof n || "number" == typeof e) return r.mul(n, e); var t = r.dim(n), i = r.dim(e); if (1 !== t.length || 1 !== i.length) throw new Error("numeric: tensor product is only defined for vectors"); var o, a, f, u, c = t[0], s = i[0], m = Array(c); for (a = c - 1; a >= 0; a--) { for (o = Array(s), u = n[a], f = s - 1; f >= 3; --f)o[f] = u * e[f], o[--f] = u * e[f], o[--f] = u * e[f], o[--f] = u * e[f]; for (; f >= 0;)o[f] = u * e[f], --f; m[a] = o } return m }, r.epsilon = 2220446049250313e-31, r.LU = function (n, e) { e = e || !1; var t, i, o, a, f, u, c, s, m, l = Math.abs, h = n.length, d = h - 1, p = new Array(h); for (e || (n = r.clone(n)), o = 0; o < h; ++o) { for (c = o, m = l((u = n[o])[o]), i = o + 1; i < h; ++i)m < (a = l(n[i][o])) && (m = a, c = i); for (p[o] = c, c != o && (n[o] = n[c], n[c] = u, u = n[o]), f = u[o], t = o + 1; t < h; ++t)n[t][o] /= f; for (t = o + 1; t < h; ++t) { for (s = n[t], i = o + 1; i < d; ++i)s[i] -= s[o] * u[i], s[++i] -= s[o] * u[i]; i === d && (s[i] -= s[o] * u[i]) } } return { LU: n, P: p } }, r.LUsolve = function (n, e) { var t, i, o, a, f, u = n.LU, c = u.length, s = r.clone(e), m = n.P; for (t = c - 1; -1 !== t; --t)s[t] = e[t]; for (t = 0; t < c; ++t)for (o = m[t], m[t] !== t && (f = s[t], s[t] = s[o], s[o] = f), a = u[t], i = 0; i < t; ++i)s[t] -= s[i] * a[i]; for (t = c - 1; t >= 0; --t) { for (a = u[t], i = t + 1; i < c; ++i)s[t] -= s[i] * a[i]; s[t] /= a[t] } return s }, r.solve = function (n, e, t) { return r.LUsolve(r.LU(n, t), e) }, r });
define('core/math/qr', ["require", "exports"], function (require, r) { "use strict"; function t(r, t) { for (var n = r.length, e = t.length, a = 0, l = 0, h = e - n; h < e; h++)a += r[h + n - e] * t[h], l += r[h + n - e] * r[h + n - e]; var o = a / l; for (h = e - n; h < e; h++)t[h] = 2 * o * r[h + n - e] - t[h] } function n(r, t, n) { for (var e = r.length, a = t.length, l = 0, h = 0, o = a - e; o < a; o++)l += r[o + e - a] * t[o][n], h += r[o + e - a] * r[o + e - a]; var f = l / h; for (o = a - e; o < a; o++)t[o][n] = 2 * f * r[o + e - a] - t[o][n] } function e(r, t, n, e) { var a = Array(r.length - t); if (1 === a.length) return a[0] = 1, a; if (0 === e) { a[0] = 1; for (var l = 1; l < a.length; l++)a[l] = 0; return a } var h = r[t][n] < 0 ? -1 : 1; a[0] = r[t][n] + h * Math.sqrt(e); for (var o = t + 1; o < r.length; o++)a[o - t] = r[o][n]; return a } function a(r, t, n) { for (var e = 0; t < r.length; t++)e += r[t][n] * r[t][n]; return e } function l(r, n, e) { for (var a = r.reflectors, l = r.r, h = r.p, o = n.slice(), f = 0; f < a.length; f++)t(a[f], o); for (f = a.length; f < l[0].length; f++)o[f] = 0; o.length = l[0].length; var g = Math.pow(2, -52), i = e.regularize ? g * Math.abs(l[0][0]) * Math.max(l.length, l[0].length) : 0; for (f = a.length - 1; f >= 0; f--) { var u = l[f]; if (Math.abs(u[f]) <= i) o[f] = 0; else { for (var v = f + 1; v < a.length; v++)o[f] -= o[v] * u[v]; o[f] /= u[f] } } for (f = h.length - 1; f >= 0; f--)if (h[f] !== f) { var c = o[f]; o[f] = o[h[f]], o[h[f]] = c } return o } function h(r) { var t = r.r, n = Math.min(t.length, t[0].length), e = t[0][0], a = t[n - 1][n - 1]; return 0 === e ? 1 / 0 : Math.abs(e / a) } Object.defineProperty(r, "__esModule", { value: !0 }), r.isNumericallyFullRank = r.conditionNumber = r.qrSolve = r.qr = void 0, r.qr = function (r, t) { if (!t || !t.mutateInput) { var l = r; r = Array(r.length); for (var h = 0; h < l.length; h++)r[h] = l[h].slice() } for (var o = Math.min(r.length, r[0].length), f = Array(o), g = [], i = 0; i < o; i++) { for (var u = -1 / 0, v = i, c = i; c < r[i].length; c++) { var s = a(r, i, c); s > u && (u = s, v = c) } if (f[i] = v, v !== i) for (h = 0; h < r.length; h++) { var y = r[h][v]; r[h][v] = r[h][i], r[h][i] = y } var M = e(r, i, i, u); for (c = i; c < r[i].length; c++)n(M, r, c); g.push(M) } return { reflectors: g, r: r, p: f } }, r.qrSolve = function (r, t, n) { return Array.isArray(t[0]) ? function (r, t, n) { for (var e = Array(r.r[0].length), a = 0; a < e.length; a++)e[a] = Array(t[0].length); for (var h = Array(t.length), o = 0; o < t[0].length; o++) { for (a = 0; a < t.length; a++)h[a] = t[a][o]; var f = l(r, h, n); for (a = 0; a < f.length; a++)e[a][o] = f[a] } return e }(r, t, n) : l(r, t, n) }, r.conditionNumber = h, r.isNumericallyFullRank = function (r) { var t = Math.pow(2, -52); return Math.max(r.r.length, r.r[0].length) * t * h(r) < 1 } });
define('core/math/least-squares', ["require", "exports", "numeric", "core/math/distance", "./qr"], function (require, r, e, n, t) { "use strict"; function a(r, e) { for (var n = [], t = 0; t < e; t++)n.push(r); return n } function i(r, e) { for (var n = o(r, e), t = 0, a = 0, i = n; a < i.length; a++) { var u = i[a]; t += u * u } return t / n.length } function o(r, e) { return r.apply(void 0, e) } function u(r, e) { for (var n = [], t = 0, a = r; t < a.length; t++) { var i = a[t].apply(void 0, e); n.push(i) } return n } function s(r, e) { for (var n = [], t = 0; t < r.length; t++)e[t] && n.push(r[t]); return n } function l(r, e, n) { for (var t = [], a = 0, i = 0; a < r.length; a++) { var o = 0; n[a] && (o = e[i], i += 1), t.push(r[a] + o) } return t } function v(r, n, v, f) { var S, p = f.maxIterations, g = f.linearSubset || a(!1, v.length), h = e.not(g), d = s(n, g), M = s(n, h), c = v, E = 0, m = .001; if (e.any(g)) { S = { Jv: G = e.transpose(u(d, c)), F: N = t.qr(G) }; var q = o(r, c); c = l(c, e.neg(t.qrSolve(N, q, { regularize: !0 })), g) } for (var b = !1, x = i(r, c); E < p && !b && isFinite(x);) { q = o(r, c); var y = u(M, c), z = e.transpose(y), I = void 0, F = void 0; if (S) { var N = S.F, G = S.Jv; I = e.dot(y, e.sub(q, e.dot(G, t.qrSolve(N, q, { regularize: !0 })))), F = e.dot(y, e.sub(z, e.dot(G, t.qrSolve(N, z, { regularize: !0 })))) } else I = e.dot(y, q), F = e.dot(y, z); for (var L = c, J = !1; E < p && !b && !J;) { E += 1; var O = e.add(F, e.diag(a(m, M.length))); L = l(c, e.neg(e.solve(O, I, !0)), h), b = e.all(e.eq(L, c)); var P = void 0; if (S) { P = { Jv: G = e.transpose(u(d, L)), F: N = t.qr(G) }; var R = o(r, L); L = l(L, e.neg(t.qrSolve(N, R, { regularize: !0 })), g) } var k = i(r, L); (J = k < x) ? (c = L, x = k, S = P, m *= .1) : (m = Math.max(m, 1e-64), m *= 2) } } return { solution: c, MSE: x } } Object.defineProperty(r, "__esModule", { value: !0 }), r.testOnlyExports = r.optimizeNonLinear = r.optimizeLinear = r.tryRoundingSmallParametersToZero = r.evaluateMeanSquare = void 0, r.evaluateMeanSquare = i, r.tryRoundingSmallParametersToZero = function (r, e) { var n = e.solution.map(function (r) { return Math.abs(r) < 1e-6 ? 0 : r }), t = i(r, n); return isFinite(e.MSE) && !isFinite(e.MSE) || t < e.MSE || e.MSE !== e.MSE + Math.pow(.5, 8) * (t - e.MSE) ? e : { solution: n, MSE: t } }, r.optimizeLinear = function (r, n) { for (var s = a(0, n.length), l = u(n, s), v = t.qr(e.transpose(l), { mutateInput: !0 }), f = 0; f < 2; f++) { var S = o(r, s), p = e.neg(t.qrSolve(v, S, { regularize: !1 })); s = e.add(s, p) } var g = i(r, s); if (t.isNumericallyFullRank(v)) return { solution: s, MSE: g }; var h = a(0, n.length); for (f = 0; f < 2; f++) { S = o(r, h), p = e.neg(t.qrSolve(v, S, { regularize: !0 })); h = e.add(h, p) } var d = i(r, h); return .999 * d <= g ? { solution: h, MSE: d } : { solution: s, MSE: g } }; var f = [18.9, .105, .0113, .089, 4.414, .373, .06, .149, 1.84, 9.26, 5, .7, .2, 1.13, 2.61, 1, .007, 30, 120, 1500, 4e-4, 7.23, -1, -.0081, -.03, -28.6, -1.71, -.4, -6.94, -.777, -500], S = function (r) { for (var e = [], n = 0; n < f.length; n++) { for (var t = [], a = 0; a < r; a++)t[a] = 0 === n && 1 !== r ? 0 : 1 === n && 1 !== r ? 1 : f[503 * (n * r + a) % f.length]; e.push(t) } return e }, p = function (r, e, n, t, a) { for (var i = [], o = 0, u = n; o < u.length; o++) { var s = u[o]; i.push({ soln: v(r, e, s, a), initialGuess: s }) } i.sort(function (r, e) { return isNaN(r.soln.MSE) ? 1 : isNaN(e.soln.MSE) ? -1 : r.soln.MSE - e.soln.MSE }); for (var l = [], f = 0; f < t; f++)l.push(i[f].initialGuess); return l }; function g(r, e, n, t) { if (!e) return r; if ("known" !== e.type) return r; var a = e.bounds; return a[0] === -1 / 0 && a[1] === 1 / 0 ? r : a[0] === -1 / 0 ? a[1] - Math.exp(-r) : a[1] === 1 / 0 ? a[0] + Math.exp(r) : n / (t - 1) * a[1] + (t - 1 - n) / (t - 1) * a[0] } var h = [3, 5, 7, 11, 13, 17, 19]; function d(r, e) { for (var n = [], t = 0; t < r.length; t++) { for (var a = r[t], i = [], o = 0; o < a.length; o++) { var u = h[o % h.length] * t % r.length; i.push(g(a[o], e[o], u, r.length)) } n.push(i) } return n } r.optimizeNonLinear = function (r, e, t) { t || (t = {}); var a = t.linearSubset, i = t.bounds, o = t.preferredInitialGuess, u = S(e.length); i && (u = d(u, i)); var s = p(r, e, u, 5, { maxIterations: 3, linearSubset: a }), l = v(r, e, p(r, e, s, 1, { maxIterations: 60, linearSubset: a })[0], { maxIterations: 250, linearSubset: a }); if (!o) return l; var f = v(r, e, o, { maxIterations: 100, linearSubset: a }); return isFinite(f.MSE) && (f.MSE < l.MSE || n.approx(f.MSE, l.MSE, 8)) ? f : l }, r.testOnlyExports = { generateInitialGuesses: S, mapInitialGuesses: d } });
define('core/math/ir/features/reparameterize-regression', ["require", "exports", "core/math/builtin", "../opcodes", "core/math/types", "../instructions", "./is-constant", "./as-value", "./polynomial-order", "./get-polynomial-coefficients", "./copy-instruction", "core/math/maybe-rational", "./list-length"], function (require, e, r, t, a, n, i, s, o, u, c, l, v) { "use strict"; function p(e) { return { chunk: e, isLazy: !0 } } function f(e) { return e.slice() } function h(e) { if (!e.isLazy) return e; var r = e.chunk.copy(); return r.reopenFinalBlock(), { chunk: r, forwardParameterMap: f, reverseParameterMap: f, isLazy: !1, valueMap: F(e.chunk.instructionsLength()), replacementMask: N(e.chunk.argNames.length) } } function d(e) { var r = e.chunk, t = e.forwardParameterMap, a = e.reverseParameterMap, n = e.isLazy, i = e.valueMap, s = e.replacementMask, o = e.didShiftScale; return { chunk: r.copy(), forwardParameterMap: t, reverseParameterMap: a, isLazy: n, valueMap: i.slice(), replacementMask: s.slice(), didShiftScale: o } } function g(e) { for (var r = 1 / 0, t = -1 / 0, a = e.length, n = 0, i = e; n < i.length; n++) { var s = i[n]; r = Math.min(r, s), t = Math.max(t, s) } return { min: r, max: t, length: a } } function m(e, r, t, a) { if (void 0 !== t) { var i = e.getInstruction(a); if (n.isLeafInstruction(i)) for (var s = 0, o = t; s < o.length; s++) { (v = o[s]).valueMap[a] = a } else for (var u = 0, l = t; u < l.length; u++) { for (var v, p = (v = l[u]).chunk, f = v.valueMap, h = [], d = 0, g = 0, m = i.args; g < m.length; g++) { var M = m[g]; if (f[M] !== M) { if ((d += 1) > 1) return void (t.length = 0) } else for (var y = r[M], k = 0; k < y.length; k++)if (y[k] && v.replacementMask[k]) return void (t.length = 0); h.push(f[M]) } f[a] = d > 0 ? c.copyInstructionWithArgs(p, i, h) : a } } } function M(e, r) { for (var t, a = e.listAccessDependencyTable, n = e.listAccesses, i = e.listStatisticsTable, s = a[r], o = 0; o < s.length; o++)if (s[o]) { if (t) return; t = { listAccessIndex: n[o], listStatistics: i[o] } } return t } function y(e, r) { for (var t = 0, a = e.listAccessDependencyTable[r]; t < a.length; t++) { if (a[t]) return !0 } return !1 } function k(e, r) { for (var a, n = [], i = 0; i <= r; i++) { if (e.getInstruction(i).type === t.LoadArg) { var s = N(e.argNames.length); s[i] = !0, n.push(s) } else n.push(L(e, n, e.argNames.length, i)) } var o = n[r]; for (i = 0; i < o.length; i++)if (o[i]) { if (void 0 !== a) return; a = i } return a } function x(e, a, n, i, s) { var o = e.chunk, u = k(o, n); if (void 0 !== u) { var c = w(e, n, u); if (void 0 !== c) { var l = o.getInstruction(i), v = l.args[0]; if (void 0 !== (c = b(c, v, s))) { var p = c.chunk, f = c.valueMap, h = p.getInstruction(f[v]); if (h.type === t.Add) { var d = h.args[1], g = p.getInstruction(h.args[0]); if (g.type === t.Multiply) { var m = g.args, M = m[0], y = m[1], x = u, P = d, C = M, I = y, L = p.Multiply([C, I]), N = p.SyntheticNativeFunction("cos", [L]), F = p.SyntheticNativeFunction("sin", [L]), S = "sin" === l.symbol ? p.Add([p.Multiply([x, F]), p.Multiply([P, N])]) : p.Subtract([p.Multiply([x, N]), p.Multiply([P, F])]); f[a] = S; var A = c.replacementMask.slice(); return A[u] = !0, A[M] = !0, A[d] = !0, { chunk: p, forwardParameterMap: function (e) { var r = c.forwardParameterMap(e), t = r[u], a = r[d], n = t * Math.cos(a), i = t * Math.sin(a); return r[u] = n, r[d] = i, r }, reverseParameterMap: function (e) { var t = e.slice(), a = e[u], n = e[d], i = r.hypot(a, n), s = Math.atan2(n, a); return t[u] = i, t[d] = s, c.reverseParameterMap(t) }, valueMap: f, replacementMask: A, isLazy: !1 } } } } } } } function P(e, r, n, i) { var s = e.chunk, o = s.getInstruction(r).args, u = o[0], c = o[1], v = s.getInstruction(u); if (v.type === t.Constant && v.valueType === a.Number && l.asFloat(v.value) > 0) { var p = h(e), f = p.chunk, d = p.valueMap, g = f.Multiply([f.SyntheticNativeFunction("ln", [d[u]]), d[c]]); return d[c] = g, d[r] = f.SyntheticNativeFunction("exp", [g]), I(p, r, c, n, i) || p } var m = k(s, u); if (void 0 !== m) { var M = w(e, u, m); if (void 0 !== M) { var y = M.chunk, x = M.valueMap, P = y.Multiply([x[u], x[c]]); x[c] = P, x[r] = y.SyntheticNativeFunction("exp", [P]); var C = M.replacementMask.slice(); C[m] = !0; var b = { chunk: y, forwardParameterMap: function (e) { var r = M.forwardParameterMap(e), t = r[m], a = Math.log(t); return r[m] = a, r }, reverseParameterMap: function (e) { var r = e.slice(), t = r[m], a = Math.exp(t); return r[m] = a, M.reverseParameterMap(r) }, isLazy: !1, valueMap: x, replacementMask: C }; return I(b, r, c, n, i) || b } } } function C(e, r, t, a, n, i) { if (e.isLazy || !e.didShiftScale) { var s = e.isLazy ? e : d(e), o = k(e.chunk, t); if (void 0 !== o) { var u = w(e, t, o); if (void 0 !== u) { var c = u.chunk, l = u.valueMap, v = c.getInstruction(l[a]).args[0], p = c.Add([v, l[t]]); l[t] = p, l[r] = c.SyntheticNativeFunction("exp", [p]); var f = u.replacementMask.slice(); f[o] = !0; var g = h(s); g.valueMap[r] = g.chunk.Multiply([g.valueMap[t], g.valueMap[a]]); var m = { chunk: c, forwardParameterMap: function (e) { var r = u.forwardParameterMap(e), t = r[o], a = Math.log(t); return r[o] = a, r }, reverseParameterMap: function (e) { var r = e.slice(), t = r[o], a = Math.exp(t); return r[o] = a, u.reverseParameterMap(r) }, isLazy: !1, valueMap: l, replacementMask: f }, M = d(m); return M.forwardParameterMap = function (e) { var r = u.forwardParameterMap(e), t = r[o], a = Math.log(-t); return r[o] = a, r }, M.reverseParameterMap = function (e) { var r = e.slice(), t = r[o], a = -Math.exp(t); return r[o] = a, u.reverseParameterMap(r) }, m = I(m, r, t, n, i) || m, (M = I(M, r, t, n, i) || M).valueMap[r] = M.chunk.Negative([M.valueMap[r]]), [g, m, M] } } } } function I(e, r, a, n, i) { var s = function (e, r, a, n) { var i = b(e, r, a); if (void 0 === i) return; var s = i.chunk, o = i.valueMap, u = s.getInstruction(o[r]); if (u.type !== t.Add) return; var c = u.args[1], l = s.getInstruction(u.args[0]); if (l.type !== t.Multiply) return; var v = l.args, p = v[0], f = v[1], h = n.min, d = n.max, g = d - h, m = .5 * (d + h), M = s.Divide([s.Subtract([f, s.Constant(m)]), s.Constant(g)]), y = s.Add([s.Multiply([p, M]), c]); function k(e) { var r = i.forwardParameterMap(e), t = r[p], a = r[c], n = t * g, s = a + m * t; return r[p] = n, r[c] = s, r } function x(e) { var r = e.slice(), t = e[p], a = e[c], n = t / g, s = a - n * m; return r[p] = n, r[c] = s, i.reverseParameterMap(r) } return o[r] = y, { chunk: s, forwardParameterMap: k, reverseParameterMap: x, isLazy: !1, valueMap: o, replacementMask: i.replacementMask, didShiftScale: !0 } }(e, a, n, i); if (void 0 !== s) return s.valueMap[r] = s.chunk.SyntheticNativeFunction("exp", [s.valueMap[a]]), s } function w(e, r, n) { var i = e.chunk, s = o.polynomialOrderContext(i, n, { allowRestriction: !1, allowClosedBlockReferences: !1 }); if (1 === o.instructionOrder(s, r)) { var c = u.polynomialCoefficientContext(s), v = u.instructionCoefficients(c, r), p = v[0], f = v[1]; if (void 0 !== f) { var d = c.newChunk.getInstruction(p); if (d.type === t.Constant && d.valueType === a.Number) { var g = c.newChunk.getInstruction(f); if (g.type === t.Constant && g.valueType === a.Number) { var m = h(e), M = m.chunk, y = m.valueMap, k = l.asFloat(d.value), x = l.asFloat(g.value); y[r] = n; var P = m.replacementMask.slice(); return P[n] = !0, { chunk: M, forwardParameterMap: function (e) { var r = m.forwardParameterMap(e), t = r[n], a = k + x * t; return r[n] = a, r }, reverseParameterMap: function (e) { var r = e.slice(), t = (r[n] - k) / x; return r[n] = t, m.reverseParameterMap(r) }, isLazy: !1, valueMap: y, replacementMask: P } } } } } } function b(e, r, n) { var i = e.chunk, s = e.isLazy ? r : e.valueMap[r], c = o.polynomialOrderContext(i, n, { allowRestriction: !1, allowClosedBlockReferences: !0 }); if (1 === o.instructionOrder(c, s)) { e.isLazy && (c = o.polynomialOrderContext(i.copy().reopenFinalBlock(), n, { allowRestriction: !1, allowClosedBlockReferences: !1 })); var v = u.polynomialCoefficientContext(c), p = u.instructionCoefficients(v, s), f = p[0], d = p[1]; if (void 0 !== d) { for (var g, m, M = v.newChunk, y = Math.max(d, f), k = [], x = 0; x <= y; x++) { if (M.getInstruction(x).type === t.LoadArg) { var P = N(M.argNames.length); P[x] = !0, k.push(P) } else k.push(L(M, k, M.argNames.length, x)) } for (x = 0; x < i.argNames.length; x++)if (k[d][x]) { if (void 0 !== g) return; g = x } else if (k[f][x]) { if (void 0 !== m) return; m = x } if (void 0 !== g && void 0 !== m) { var C = o.polynomialOrderContext(M, g, { allowRestriction: !1, allowClosedBlockReferences: !1 }); if (1 === o.instructionOrder(C, d)) { var I = o.polynomialOrderContext(M, m, { allowRestriction: !1, allowClosedBlockReferences: !1 }); if (1 === o.instructionOrder(I, f)) { var w = u.polynomialCoefficientContext(C), b = u.polynomialCoefficientContext(I), F = u.instructionCoefficients(w, d), S = F[0], A = F[1], z = w.newChunk.getInstruction(S); if (z.type === t.Constant && z.valueType === a.Number) { var R = w.newChunk.getInstruction(A); if (R.type === t.Constant && R.valueType === a.Number) { var O = h(e), T = O.chunk, B = O.valueMap, D = T.Add([T.Multiply([g, n]), m]); B[r] = D; var E = M.copy(); E.List([d, f]); var _ = E.close().getCompiledFunction().fn, j = l.asFloat(z.value), q = l.asFloat(R.value), V = u.instructionCoefficients(b, f), W = V[0], G = V[1], H = b.newChunk.copy(); H.List([W, G]); var J = H.close().getCompiledFunction().fn, K = O.replacementMask.slice(); return K[g] = !0, K[m] = !0, { chunk: T, forwardParameterMap: function (e) { var r = O.forwardParameterMap(e), t = _.apply(null, r), a = t[0], n = t[1]; return r[g] = a, r[m] = n, r }, reverseParameterMap: function (e) { var r = e.slice(), t = e[g], a = e[m], n = (t - j) / q, i = e.slice(); i[g] = n, i.splice(m, 1); var s = J.apply(null, i), o = (a - s[0]) / s[1]; return r[g] = n, r[m] = o, O.reverseParameterMap(r) }, isLazy: !1, valueMap: B, replacementMask: K } } } } } } } } } function L(e, r, t, a) { var i = e.getInstruction(a), s = N(t); if (n.isLeafInstruction(i)) return s; for (var o = 0, u = i.args; o < u.length; o++)for (var c = r[u[o]], l = 0; l < c.length; l++)s[l] = s[l] || c[l]; return s } function N(e) { for (var r = [], t = 0; t < e; t++)r.push(!1); return r } function F(e) { for (var r = [], t = 0; t < e; t++)r.push(t); return r } function S(e) { return e.type === t.NativeFunction && ("sin" === e.symbol || "cos" === e.symbol) } Object.defineProperty(e, "__esModule", { value: !0 }), e.reparameterizeRegression = void 0, e.reparameterizeRegression = function (e) { var r = e.getInstruction(e.returnIndex); if (r.type === t.BroadcastResult) { var o = r.args[0], u = e.returnIndex - o, c = e.getInstruction(o); if (2 === c.args.length) { var l = c.args[0], f = c.args[u], h = [], d = []; h.push(l), d.push({ min: 1, max: v.assertConstantListLength(e, e.returnIndex, "Programming error: cannot optimize regression on non-constant-length list"), length: v.assertConstantListLength(e, e.returnIndex, "Programming error: cannot optimize regression on non-constant-length list") }); for (var k = !1, w = !1, b = l + 1; b <= f; b++) { if ((D = e.getInstruction(b)).type === t.ListAccess || D.type === t.InboundsListAccess || D.type === t.DeferredListAccess) { if (D.args[1] !== l) continue; var F = D.args[0]; if (e.getInstruction(F).valueType !== a.ListOfNumber) continue; if (!i.isConstant(e.getInstruction(F))) continue; var A = g(s.asValue(e, F)); if (!isFinite(A.min) || !isFinite(A.max)) continue; h.push(b), d.push(A) } else if (D.type === t.NativeFunction) "exp" === D.symbol ? w = !0 : S(D) && (k = !0); else if (D.type === t.Exponent || D.type === t.RawExponent) w = !0; else if (n.beginsBlock(D) || n.endsBlock(D)) return } if (0 !== h.length && (w || k)) { var z = []; for (b = 0; b <= f; b++) { if (-1 !== (ie = h.indexOf(b))) (O = N(h.length))[ie] = !0, z.push(O); else z.push(L(e, z, h.length, b)) } var R = []; for (b = 0; b <= e.returnIndex; b++) { var O; if ((D = e.getInstruction(b)).type === t.LoadArg) (O = N(e.argNames.length))[b] = !0, R.push(O); else R.push(L(e, R, e.argNames.length, b)) } var T = { listAccessDependencyTable: z, listAccesses: h, listStatisticsTable: d }, B = void 0; for (b = l + 1; b <= e.returnIndex; b++) { var D; switch ((D = e.getInstruction(b)).type) { case t.NativeFunction: if ("exp" === D.symbol) { var E = D.args[0], _ = M(T, E); if (void 0 === _) { m(e, R, B, b); break } var j = _.listStatistics, q = _.listAccessIndex; (ve = I(p(e), b, E, q, j)) ? B = [ve] : m(e, R, B, b) } break; case t.Exponent: case t.RawExponent: var V = D.args, W = V[0], G = M(T, V[1]); if (void 0 === G || y(T, W)) { m(e, R, B, b); break } var H = G.listStatistics, J = G.listAccessIndex; (ve = P(p(e), b, J, H)) ? B = [ve] : m(e, R, B, b); break; case t.Multiply: if (B && B.length > 1) { m(e, R, B, b); break } var K = B && B.length > 0 ? B[0] : p(e), Q = D.args, U = Q[0], X = Q[1], Y = K.isLazy ? U : K.valueMap[U], Z = K.isLazy ? X : K.valueMap[X], $ = K.chunk.getInstruction(Y), ee = K.chunk.getInstruction(Z), re = void 0, te = void 0, ae = void 0; if ($.type === t.NativeFunction) re = U, ae = $, te = X; else { if (ee.type !== t.NativeFunction) { m(e, R, B, b); break } re = X, ae = ee, te = U } var ne = M(T, re); if (void 0 === ne || y(T, te)) { m(e, R, B, b); break } var ie = ne.listAccessIndex, se = ne.listStatistics; if ("exp" === ae.symbol) { var oe = C(K, b, te, re, ie, se); if (oe) { B = oe; break } } else if (S(ae)) { if (ve = x(K, b, te, re, ie)) { B = [ve]; break } } m(e, R, B, b); break; default: m(e, R, B, b) } } if (void 0 !== B && 0 !== B.length) { for (var ue = [], ce = 0, le = B; ce < le.length; ce++) { var ve = le[ce]; ue.push({ chunk: ve.chunk.close(), forwardParameterMap: ve.forwardParameterMap, reverseParameterMap: ve.reverseParameterMap }) } return ue } } } } } });
define('core/math/parsenode-from-value', ["require", "exports", "parsenodes", "core/math/types"], function (require, e, r, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.parseNodeFromValue = void 0, e.parseNodeFromValue = function e(t, s) { switch (t) { case o.Number: case o.Bool: return r.Constant(s); case o.SeedType: return r.Seed(s); case o.Point: return r.ParenSeq([e(o.Number, s[0]), e(o.Number, s[1])]); case o.RGBColor: return r.FunctionCall("rgb", [e(o.Number, s[0]), e(o.Number, s[1]), e(o.Number, s[2])]); case o.EmptyList: case o.ListOfNumber: case o.ListOfBool: case o.ListOfPoint: case o.ListOfColor: case o.ListOfPolygon: case o.ErrorType: for (var n = [], a = o.elementType(t), i = 0, c = s; i < c.length; i++) { var u = c[i]; n.push(e(a, u)) } return r.List(n); case o.Polygon: return r.FunctionCall("\\polygon", [e(o.ListOfPoint, s)]); case o.Any: case o.Distribution: case o.ListOfAny: case o.ListOfDistribution: case o.Action: throw new Error("Programming error: cannot create parse node from valueType: " + o.repr(t)); default: var l = t; throw new Error("Programming error: unexpected valueType: " + o.repr(l)) } } });
define('core/math/ir/features/optimize-regression', ["require", "exports", "parsenodes", "core/math/builtin", "core/math/parsenode/irexpression", "tslib", "core/math/errormsg", "core/math/distance", "core/lib/label", "core/math/types", "core/math/least-squares", "./reparameterize-regression", "core/math/ir/build-ir", "../../parsenode-from-value"], function (require, e, r, i, n, t, a, s, o, u, l, f, p, d) { "use strict"; function v(e, r, i) { for (var n, t, a = e.policy, s = e.frame, o = 0, l = r._rhs.getDependencies(); o < l.length; o++) { var f = l[o]; if (!i.hasOwnProperty(f)) { var p = s[f]; if (p && ("Assignment" === p.type && (p = p._expression), p.buildIRExpression)) { var d = p.buildIRExpression(a, s); if (!d.isError && d.valueType === u.ListOfNumber) { if (void 0 !== n) { n = void 0, t = void 0; break } 0 === d.getDependencies().length && (n = f, t = d) } } } } var v = Object.create(s); void 0 !== n && (v[n] = void 0); var c = r._rhs.buildIRExpression(a, v), g = Object.create(v); for (var m in i) g[m] = i[m]; var h = r._rhs.buildIRExpression(a, g); return t ? { node: c, substituted: h, listNode: t, isValid: !0 } : { node: c, substituted: h, listNode: t, isValid: !1 } } function c(e, r) { var i = r.getDependencies(), n = r.getCompiledFunction(i).fn; if (i.length) { for (var a = r.findLinearSubset(i), s = a.every(function (e) { return e }), o = [], u = 0, f = i; u < f.length; u++) { var p = f[u]; o.push(r.takeDerivative(p).getCompiledFunction(i).fn) } if (s) return t.__assign(t.__assign({}, l.tryRoundingSmallParametersToZero(n, l.optimizeLinear(n, o))), { isLinear: s }); for (var d = [], v = 0, c = i; v < c.length; v++) { p = c[v]; d.push(r.boundDomain(p)) } var g = { linearSubset: a, bounds: d, preferredInitialGuess: e }; return t.__assign(t.__assign({}, l.tryRoundingSmallParametersToZero(n, l.optimizeNonLinear(n, o, g))), { isLinear: s }) } return { solution: [], MSE: l.evaluateMeanSquare(n, []), isLinear: !0 } } function g(e, i) { for (var n = {}, t = i.getDependencies(), a = 0; a < t.length; a++)n[t[a]] = r.Constant(e[a]); return n } function m(e, n, t, o, f, p) { if (o.getDependencies().length) throw a.optimizationError(); var d = function (e) { var r = 0; return e.eachElement(function (e) { var i = +e.asValue(); r += i * i }), r / e.length }(o); if (!isFinite(d)) throw a.optimizationError(); if (n.getDependencies().length > 0) return { RMSE: Math.sqrt(d) }; var v = u.isList(n.valueType) ? i.varp(n.asValue()) : 0; if (n.getDependencies().length || !isFinite(v) || v <= 0 || !e.isLhsSimple) return { RMSE: Math.sqrt(d) }; var c = 1 - d / v; if (t.isValid) { var g = [], m = [], h = f && (p === L.LINLOG || p === L.LOGLOG); r.List.eachArgs([t.listNode, n], function (e) { g.push(h ? Math.log(+e[0].asValue()) : +e[0].asValue()), m.push(+e[1].asValue()) }); var E = i.corr(g, m); if (s.approx(function (e, r) { function i(i, n) { for (var t = [], a = 0; a < e.length; a++)t.push(r[a] - (i * e[a] + n)); return t } var n = [function () { return e.map(function (e) { return -e }) }, function () { return e.map(function () { return -1 }) }]; return l.optimizeLinear(i, n) }(g, m).MSE, d, 8)) return { r: E, rsquared: E * E } } return { Rsquared: c } } function h(e, r) { var i = e.length, n = e[0], t = r[0], a = e[i - 1], o = r[i - 1]; if (!(isFinite(n) && isFinite(a) && isFinite(t) && isFinite(o))) return !1; if (o - t == 0) return !1; var u = a - n; if (0 === u) return !1; for (var l = 1; l < i - 1; l++) { var f = e[l], p = r[l], d = (o * (f - n) + t * (a - f)) / u; if (!s.approx(p, d, 5)) return !1 } return !0 } Object.defineProperty(e, "__esModule", { value: !0 }), e.tryOptimize = void 0, e.tryOptimize = function (e, i) { try { return function (e, i) { var n, t = e.policy, s = e.frame, l = e.exportFrame, f = e.lastExportFrame, p = e.priorAnalysis, d = i._lhs.buildIRExpression(t, s), c = i._rhs.buildIRExpression(t, s); if (d.isError) throw d; if (c.isError) throw c; if (d.valueType !== u.Number && d.valueType !== u.ListOfNumber || c.valueType !== u.Number && c.valueType !== u.ListOfNumber) throw a.regressionTypeError([u.prettyPrint(d.valueType), u.prettyPrint(c.valueType)]); var g = i._difference.buildIRExpression(t, s, { wrapInList: !0 }); if (g.isError) throw g; for (var N = 0, b = g.getDependencies(); N < b.length; N++) { var y = b[N]; if (!t.validRegressionParameter(y)) throw a.invalidRegressionParameter(y) } var R, _ = function (e, r, i) { var n = []; r || (r = {}); i || (i = {}); for (var t = 0, a = e; t < a.length; t++) { var s = a[t], u = o.identifierToLatex(s); i[s] && isFinite(i[s].asValue()) ? n.push(+i[s].asValue()) : r.hasOwnProperty(u) && isFinite(+r[u]) ? n.push(+r[u]) : n.push(1) } return n }(g.getDependencies(), i.userData.regressionParameters, f), D = O(_, g), I = D.parameters, x = D.isLinear, M = D.parameterWarning, w = { policy: t, frame: s }, V = v(w, i, I), T = E(w, i._difference, I), F = function (e, i, n) { if (!e.isLhsSimple) return L.NONE; if (!n.isValid) return L.NONE; var t = n.substituted; if (t.isError) return L.NONE; if (t.valueType !== u.Number) return L.NONE; var a = t.getDependencies(); if (1 !== a.length) return L.NONE; if (isFinite(n.node.polynomialOrder(a[0]))) return L.NONE; var s = t.getCompiledFunction(a).fn, o = n.listNode; if (t.valueType !== u.Number) return L.NONE; var l = o.mapElements(function (e) { return +e.asValue() }); if (l.length < 3) return L.NONE; l.sort(function (e, r) { return e - r }); var f = l.map(s), p = f.map(Math.log), d = l.map(Math.log), v = !0; return r.List.wrap(i).eachElement(function (e) { isFinite(Math.log(+e.asValue())) || (v = !1) }), h(l, p) && v ? L.LOGLIN : h(d, p) && v ? L.LOGLOG : h(d, f) ? L.LINLOG : L.NONE }(i, d, V); if (!i.userData.isLogModeRegression || F !== L.LOGLIN && F !== L.LOGLOG) R = m(i, d, V, T, i.userData.isLogModeRegression, F); else { var S = i._logDifference.buildIRExpression(t, s, { wrapInList: !0 }); if (S.isError) throw S; var G = i._logLhs.buildIRExpression(t, s, { wrapInList: !0 }); if (G.isError) throw G; I = (n = O(_, S)).parameters, x = n.isLinear, M = n.parameterWarning, V = v(w, i, I), T = E(w, i._difference, I), R = m(i, G, V, E(w, i._logDifference, I), i.userData.isLogModeRegression, F) } var P = function (e, r) { if (e.userData && e.userData.residualVariable) { var i = o.latexToIdentifier(e.userData.residualVariable); if (!r[i]) return i } for (var n, t = e.getDependencies(), a = 0, s = t; a < s.length; a++) { var u = s[a].match(/_(.*)/); if (u && !r[n = "e_" + u[1]]) return n } var l = 1; for (; ;) { if (!r[n = "e_" + l]) return n; l++ } }(i, l), z = function (e, r, i) { var n, t = e._rhs.getDependencies(); for (var a in i) if (i.hasOwnProperty(a)) { var s = i[a].concreteTree; if (s.isTable && s.columns[0]) { var o = i[a].rawTree.columns; if (o && o.length) { var u = o[0].getExports(); if (1 === u.length && -1 !== t.indexOf(u[0])) { for (var l = 1; l < o.length; l++)if (-1 !== o[l].getDependencies().indexOf(r)) return; n = n || a } } } } return n || void 0 }(i, P, p); return i.userData.residualVariable = o.identifierToLatex(P), r.OptimizedRegression(I, T, R, V.substituted, { isModelValid: V.isValid, residualVariable: P, residualSuggestionId: z, shouldSuggestLogMode: F !== L.NONE, isLinear: x, parameterWarning: M }) }(e, i) } catch (e) { return e instanceof r.Error ? e : a.parseError() } }; var L = { NONE: 0, LOGLIN: 1, LOGLOG: 2, LINLOG: 3 }; function E(e, r, i) { var n = e.policy, t = e.frame, a = Object.create(t); for (var s in i) i.hasOwnProperty(s) && (a[s] = i[s]); var o = p.buildIR({ policy: n, frame: a, wrapInList: !0 }, r); return d.parseNodeFromValue(o.getReturnType(), o.asCompilerValue()) } function O(e, r) { var i, t, a = r._chunk; if (a && (t = f.reparameterizeRegression(a)), !t || 0 === t.length) return { parameters: g((i = c(e, r = r.deriveRegressionRestrictions())).solution, r), isLinear: i.isLinear, parameterWarning: !1 }; for (var s = r.getDependencies(), o = r.getCompiledFunction(s).fn, u = 1 / 0, p = {}, d = !1, v = 0, m = t; v < m.length; v++) { var h = m[v], L = new n(h.chunk); if (L = L.deriveRegressionRestrictions(), (i = c(h.forwardParameterMap(e), L)).MSE < u) { var E = h.reverseParameterMap(i.solution), O = l.evaluateMeanSquare(o, E); if (p && (!isFinite(O) || O >= u)) { isFinite(O) || (d = !0); continue } u = i.MSE, p = g(E, r) } } return { parameters: p, isLinear: !1, parameterWarning: d } } });
define('core/math/features/analyze', ['require', 'underscore', 'parsenodes', 'core/math/statementanalysis', 'core/math/builtin', 'core/math/builtinframe', 'core/math/errormsg', 'core/math/comparators', 'core/math/types', 'core/types/graphmode', 'core/math/expression-types', 'core/math/distribution-spec', 'core/math/workerconfig', 'core/math/ir/features/solve', 'core/math/ir/features/optimize-regression', 'core/math/ir/dependencies'], function (require) { "use strict"; var e = require("underscore"), t = require("parsenodes"), i = require("core/math/statementanalysis"), r = require("core/math/builtin"), n = require("core/math/builtinframe"), a = require("core/math/errormsg"), s = require("core/math/comparators"), o = require("core/math/types"), l = require("core/types/graphmode"), c = require("core/math/expression-types").ExpressionType, u = require("core/math/distribution-spec").DistributionParameterDefaultsMap, h = require("core/math/workerconfig"), p = require("core/math/ir/features/solve").trySolve, d = require("core/math/ir/features/optimize-regression").tryOptimize, y = require("core/math/ir/dependencies").getFreeDependencies; function v(e, t, r, n) { if (n.isError) return i(e, r, n); var s = n.getDependencies(); switch (n.valueType) { case o.Distribution: case o.ListOfDistribution: case o.EmptyList: return i(e, r, n); case o.RGBColor: case o.ListOfColor: case o.Action: case o.Polygon: case o.ListOfPolygon: return s.length ? i(e, r, a.tooManyVariables(r.getSliderVariables(e, n)).setDependencies(s)) : i(e, r, n); case o.Point: case o.ListOfPoint: if (s.length) { if (!e.validParametricVariables(s)) { var l = r.getSliderVariables(e, n); return i(e, r, a.tooManyVariables(l).setDependencies(l)) } return i(e, r, n) } return i(e, r, n); case o.Number: case o.ListOfNumber: return 0 === s.length ? i(e, r, n) : s.length <= e.dimensions() - 1 ? e.validExpressionVariables(s) ? i(e, r, n) : i(e, r, a.equationRequired(e.implicitDependency(s)).setDependencies(s)) : e.validImplicitVariables(s) ? i(e, r, a.equationRequired().setDependencies(s)) : i(e, r, a.tooManyVariables(r.getSliderVariables(e, n)).setDependencies(s)); default: return i(e, r, a.parseError()) } } function f(e) { return t.FunctionCall("pdf", [e, t.Identifier("x")]) } function g(e, t) { var r = this.tryGetConcreteTree(e, t), n = r.getDependencies(); return n.length ? i(e, this, a.tooManyVariables(this.getSliderVariables(e, r)).setDependencies(n)) : i(e, this, this.tryGetConcreteTree(e, t)) } function b(e) { return function (t, r) { var n = this.tryGetConcreteTree(t, r), s = n.getDependencies(); if (s.length) return i(t, this, a.tooManyVariables(this.getSliderVariables(t, n)).setDependencies(s)); var o = i(t, this, this.tryGetConcreteTree(t, r)); if (!n.isError) { o.evaluationState.expression_type = c.TTEST; var l = n.args.map(function (e) { return e.asValue() }); o.evaluationState.ttest_results = e.apply(null, l) } return o } } function m(e, t) { return e.filter(function (e) { return !t[e] }) } t.Base.prototype.analyze = function (e, t) { return i(e, this, this.tryGetConcreteTree(e, t)) }, t.FunctionCall.prototype.analyze = function (e, t) { return v(e, 0, this, u[this._symbol] && 0 === y(t, this).length ? f(this).tryGetConcreteTree(e, t) : this.tryGetConcreteTree(e, t)) }, t.Expression.prototype.analyze = function (e, t) { return v(e, 0, this, this.tryGetConcreteTree(e, t)) }, t.FunctionDefinition.prototype.analyze = function (e, t) { if (n[this._symbol]) return this.asEquation().analyze(e, t); var r = this._symbol.split("_")[0]; if (n[r] && n[r].isFunction) return i(e, this, a.cannotRedefine(this._symbol, r)); var s = this.tryGetConcreteTree(e, t); if (s.isError) return i(e, this, s); var o = this._argSymbols, l = s.getDependencies(); if (-1 !== l.indexOf(this._symbol)) return i(e, this, a.selfReferentialFunction(this._symbol)); var c = l.filter(function (e) { return -1 === o.indexOf(e) }); if (e.unplottablePolarFunction(this._symbol, l)) return i(e, this, a.unplottablePolarFunction()); if (c.some(e.assignmentForbidden)) return i(e, this, a.addArgumentsToDefinition(c, this._symbol, o).setDependencies(l)); if (c.length) { var u = this.getSliderVariables(e, s); return i(e, this, a.tooManyVariables(u).setDependencies(u)) } return i(e, this, s) }, t.Assignment.prototype.analyze = function (e, r, s) { var l, c = this._symbol; if (!e.validLHS(c)) return i(e, this, a.invalidLHS(c)); if (n[c]) return this.asEquation().analyze(e, r); if (this._expression instanceof t.FunctionCall && u[this._expression._symbol] && 0 === y(r, this).length) l = f(this._expression).tryGetConcreteTree(e, r); else { var h = Object.create(r); h[c] = e.validSolvedVariable(c) ? void 0 : a.invalidImplicitVariables(), l = this.tryGetConcreteTree(e, h) } if (l.isError) return i(e, this, l); var p = l.getDependencies(); if (this.isEquation(l)) return this.asEquation().analyze(e, r); var d = l.valueType === o.RGBColor || l.valueType === o.ListOfColor; if (p.length > 1 || d && p.length) { var v = this.getSliderVariables(e, l); return d || v.length ? i(e, this, a.tooManyVariables(v).allowExport().setDependencies(v)) : i(e, this, l) } var g = this.getMoveStrategy(e, r, l, s, this.userData); if (g) { var b = this.getDefaultDragMode(g); return i(e, this, t.MovablePoint([l.elementAt(0), l.elementAt(1)], g, b)) } return i(e, this, l) }, t.Regression.prototype.analyze = function (e, t, r, n, a) { return i(e, this, d({ policy: e, frame: t, exportFrame: r, lastExportFrame: n, priorAnalysis: a }, this)) }, t.Histogram.prototype.analyze = g, t.Object3D.prototype.analyze = g, t.DotPlot.prototype.analyze = g, t.BoxPlot.prototype.analyze = g, t.TTest.prototype.analyze = b(r.ttest), t.IndependentTTest.prototype.analyze = b(r.ittest), t.Stats.prototype.analyze = function (e, t) { var n = this.tryGetConcreteTree(e, t), s = n.getDependencies(); if (s.length) return i(e, this, a.tooManyVariables(this.getSliderVariables(e, n)).setDependencies(s)); var o = i(e, this, this.tryGetConcreteTree(e, t)); if (!n.isError) { o.evaluationState.expression_type = c.STATS; var l = n.args.map(function (e) { return e.asValue() }); o.evaluationState.stats_results = r.stats.apply(null, l) } return o }, t.Equation.prototype.analyze = t.BaseComparator.prototype.analyze = function (e, r) { var n = "=" !== this.getOperator(); if (!h.plotInequalities && n) return i(e, this, a.inequalitiesDisabled()); var s = p({ policy: e, frame: r }, this.asComparator()); if (s.isError) return i(e, this, s); if (s instanceof t.SolvedEquation && s.getDependencies().length) { var o = s.getDependencies().concat(s._symbol); if (!e.validImplicitVariables(o)) return i(e, this, a.invalidImplicitVariables().setDependencies(o)) } return this.getGraphMode(e, s) !== l.IMPLICIT || e.validImplicitVariables(s.getDependencies()) ? i(e, this, s) : i(e, this, a.invalidImplicitVariables().setDependencies(s.getDependencies())) }, t.DoubleInequality.prototype.analyze = function (e, t) { if (!h.plotInequalities) return i(e, this, a.inequalitiesDisabled()); var r = this.tryGetConcreteTree(e, t); if (r.isError) return i(e, this, r); var n = r.getDependencies(); return s.table[this._operators[0]].direction !== s.table[this._operators[1]].direction ? i(e, this, a.mismatchedDoubleInequality()) : e.validDoubleInequalitySymbol(r._symbol) && e.validDoubleInequalityVariables(n) ? n.length > 2 ? i(e, this, a.tooManyVariables(this.getSliderVariables(e, r)).setDependencies(n)) : -1 !== r._expressions[0].getDependencies().indexOf(r._symbol) || -1 !== r._expressions[1].getDependencies().indexOf(r._symbol) ? i(e, this, a.complicatedDoubleInequality().setDependencies(n)) : i(e, this, r) : i(e, this, a.invalidDoubleInequalityVariables().setDependencies(n)) }, t.And.prototype.analyze = function (e, t) { var r = this.tryGetConcreteTree(e, t); if (r.isError) return i(e, this, r); var n = r.getDependencies(); return n.length ? e.validDoubleInequalityVariables(n) ? i(e, this, a.complicatedDoubleInequality().setDependencies(n)) : i(e, this, a.tooManyVariables(this.getSliderVariables(e, r)).setDependencies(n)) : i(e, this, r) }, t.ParenSeq.prototype.analyze = function (e, r, n) { var a = this.tryGetConcreteTree(e, r); if (a.isError) return i(e, this, a); var s = this.getMoveStrategy(e, r, a, n, this.userData); if (s) { var o = this.getDefaultDragMode(s), l = a.asCompilerValue(), c = [t.Constant(l[0]), t.Constant(l[1])]; return i(e, this, t.MovablePoint(c, s, o)) } return v(e, 0, this, a) }, t.Table.prototype.analyze = function (e, r) { for (var n = Object.create(r), s = Object.create(n), o = [], l = function (e) { for (var i = {}, r = 0; r < e.length; r++) { var n = e[r]; if (n.header instanceof t.Identifier) { var a = n.header._symbol; void 0 === i[a] && (i[a] = 0), i[a] += 1 } } return i }(this.columns), c = 0; c < this.columns.length; c++) { var u = this.columns[c]; if (u.header instanceof t.Identifier) { var h = u.header._symbol, p = n[h], d = l[h] > 1; p && p.isError && (p.isTableCycleWithoutGlobalDefinition || p.isMultiplyDefinedByTables && !d) && (n[h] = void 0) } var y = u.analyze(e, n, s); if (0 === c) if (y.concreteTree.isIndependent) { var v = y.concreteTree.getDependencies()[0]; e.validFirstColumnVariable(v) ? s[v] = void 0 : y = i(e, u, a.invalidFirstTableColumn()) } else y = i(e, u, a.invalidDependentFirstTableColumn()); if (y.concreteTree.isIndependent) y.rawTree.exportToLocal(y.concreteTree, n); else if (!y.concreteTree.isError) { var f = m(y.concreteTree.header.getDependencies(), n); f.length && (y = i(e, u, a.tooManyVariables(f).setDependencies(f))) } o.push(y.concreteTree) } var g = t.Table(o), b = i(e, this, g); return b.evaluationState.is_graphable = !0, b }, t.TableColumn.prototype.analyze = function (e, t, r) { var n = this.header.tableError(); if (n) return i(e, this, a.invalidTableHeader(n)); var s = this.tryGetConcreteTree(e, t, r); if (s.isError) return i(e, this, s); if (s.header.isError) return i(e, this, s.header); if (s.values.isError) return i(e, this, s.values); for (var o = 0; o < s.values.length; o++)if (!s.values[o].isError) { var l = this.values[o] && this.values[o].tableError(); if (l) s.values[o] = a.invalidTableEntry(l); else { var c = s.values[o].getDependencies(); c.length && (s.values[o] = a.tooManyVariables(c).setDependencies(c)) } } return i(e, this, s) }, t.Image.prototype.analyze = function (e, r, n) { var s = this.tryGetConcreteTree(e, r); if (s.radianAngle.isError || s.center.isError || s.width.isError || s.height.isError || s.opacity.isError) return i(e, this, s); var o = s.center.getDependencies(), l = s.radianAngle.getDependencies(), c = s.width.getDependencies(), u = s.height.getDependencies(), h = s.opacity.getDependencies(); return o.length || l.length || c.length || u.length || h.length ? i(e, this, t.Image({ center: o.length ? a.tooManyVariables(l).setDependencies(o) : s.center, radianAngle: l.length ? a.tooManyVariables(l).setDependencies(l) : s.radianAngle, width: c.length ? a.tooManyVariables(c).setDependencies(c) : s.width, height: u.length ? a.tooManyVariables(u).setDependencies(u) : s.height, opacity: h.length ? a.tooManyVariables(h).setDependencies(h) : s.opacity })) : (s.moveStrategy = this.getMoveStrategy(e, r, s, n, this.userData), i(e, this, s)) }, t.Slider.prototype.analyze = function (t, r) { var n, s = this.tryGetConcreteTree(t, r), o = s.sliderInfo; if (o.missingVars.length) { var l = e.unique(o.missingVars); n = i(t, this, a.tooManyVariables(t.sliderVariables(l)).setDependencies(l).allowExport()) } else n = i(t, this, s); var c = n.evaluationState; if (h.sliders) { c.assignment = o.exportedSymbol, c.slider_min_number = o.values.min, c.slider_max_number = o.values.max, c.slider_step_number = o.values.step, c.slider_min_valid = o.valids.min, c.slider_max_valid = o.valids.max, c.slider_step_valid = o.valids.step; var u = c.slider_min_valid && c.slider_max_valid && c.slider_step_valid; c.is_slider = !0, c.raw_slider_latex = this.getInputString(), c.is_slidable = u, c.is_animatable = c.is_slidable && !c.is_graphable, o.errMsg && (c.error = o.errMsg.getError()) } return delete c.is_evaluable, delete c.zero_values, n } });
define('core/math/features/analyzeFourFunction', ['require', 'parsenodes', 'core/math/statementanalysis', 'core/math/errormsg', 'core/math/builtinframe'], function (require) { "use strict"; var n = require("parsenodes"), t = require("core/math/statementanalysis"), e = require("core/math/errormsg"), r = require("core/math/builtinframe"); function o(n, r) { return t(n, this, e.inequalitiesUnsupported()) } n.Base.prototype.analyzeFourFunction = function (n, r) { var o = this.tryGetConcreteTree(n, r); return o.isError ? t(n, this, o) : t(n, this, e.parseError()) }, n.Expression.prototype.analyzeFourFunction = function (n, o) { var i = this.tryGetConcreteTree(n, o); if (i.isError) return t(n, this, i); var u = i.getDependencies(); if (u.length > 0) { var s, a = u[0], p = r[a]; return s = p ? p.isFunction ? e.functionUnsupported(a) : e.constantUnsupported(a) : e.variablesUnsupported(a), t(n, this, s) } return t(n, this, i) }, n.Assignment.prototype.analyzeFourFunction = function (n, r) { return t(n, this, e.assignmentsUnsupported()) }, n.FunctionDefinition.prototype.analyzeFourFunction = function (n, r) { return t(n, this, e.functionDefinitionsUnsupported()) }, n.Equation.prototype.analyzeFourFunction = function (n, r) { return t(n, this, e.equationsUnsupported()) }, n.And.prototype.analyzeFourFunction = o, n.DoubleInequality.prototype.analyzeFourFunction = o, n.BaseComparator.prototype.analyzeFourFunction = o, n.Regression.prototype.analyzeFourFunction = function (n, r) { return t(n, this, e.regressionsUnsupported()) }, n.ParenSeq.prototype.analyzeFourFunction = function (n, r) { return t(n, this, e.pointsUnsupported()) } });
define('core/math/features/analyzeScientific', ['require', 'parsenodes', 'core/math/statementanalysis', 'core/math/errormsg', 'core/math/builtinframe'], function (require) { "use strict"; var t = require("parsenodes"), e = require("core/math/statementanalysis"), i = require("core/math/errormsg"), n = require("core/math/builtinframe"); function r(t, n) { return e(t, this, i.inequalitiesUnsupported()) } t.Base.prototype.analyzeScientific = function (t, n) { var r = this.tryGetConcreteTree(t, n); return r.isError ? e(t, this, r) : e(t, this, i.parseError()) }, t.Expression.prototype.analyzeScientific = function (t, n) { var r = this.tryGetConcreteTree(t, n); if (r.isError) return e(t, this, r); var s = r.getDependencies(); return s.length > 0 ? e(t, this, i.tooManyVariables(s)) : e(t, this, r) }, t.Assignment.prototype.analyzeScientific = function (t, r) { var s = this._symbol; if (n[s]) return e(t, this, i.cannotRedefine(s)); var o = Object.create(r); o[s] = i.equationsUnsupported(); var a = this.tryGetConcreteTree(t, o); if (a.isError) return e(t, this, a); var c = a.getDependencies(); return this.isEquation(a) ? e(t, this, i.equationsUnsupported()) : c.length > 0 ? e(t, this, i.tooManyVariables(c)) : e(t, this, a) }, t.FunctionDefinition.prototype.analyzeScientific = function (t, r) { if (n[this._symbol]) return e(t, this, i.cannotRedefine(this._symbol)); var s = this.tryGetConcreteTree(t, r); if (s.isError) return e(t, this, s); var o = this._argSymbols, a = s.getDependencies(); if (-1 !== a.indexOf(this._symbol)) return e(t, this, i.selfReferentialFunction(this._symbol)); var c = a.filter(function (t) { return -1 === o.indexOf(t) }); return c.length ? e(t, this, i.addArgumentsToDefinition(c, this._symbol, o)) : e(t, this, s) }, t.Equation.prototype.analyzeScientific = function (t, n) { return e(t, this, i.equationsUnsupported()) }, t.And.prototype.analyzeScientific = r, t.DoubleInequality.prototype.analyzeScientific = r, t.BaseComparator.prototype.analyzeScientific = r, t.Regression.prototype.analyzeScientific = function (t, n) { return e(t, this, i.regressionsUnsupported()) }, t.ParenSeq.prototype.analyzeScientific = function (t, n) { return e(t, this, i.pointsUnsupported()) } });
define('core/math/features/analyzeSingleExpressionScientific', ['require', 'parsenodes', 'core/math/statementanalysis', 'core/math/errormsg', 'core/math/builtinframe'], function (require) { "use strict"; var e = require("parsenodes"), n = require("core/math/statementanalysis"), i = require("core/math/errormsg"), t = require("core/math/builtinframe"); function r(e, t) { return n(e, this, i.inequalitiesUnsupported()) } e.Base.prototype.analyzeSingleExpressionScientific = function (e, t) { var r = this.tryGetConcreteTree(e, t); return r.isError ? n(e, this, r) : n(e, this, i.parseError()) }, e.Expression.prototype.analyzeSingleExpressionScientific = function (e, r) { var s = this.tryGetConcreteTree(e, r); if (s.isError) return n(e, this, s); var o = s.getDependencies(); if (o.length > 0) { var p, a = o[0], c = t[a]; return p = c ? c.isFunction ? i.functionUnsupported(a) : i.constantUnsupported(a) : i.variablesUnsupported(a), n(e, this, p) } return n(e, this, s) }, e.Assignment.prototype.analyzeSingleExpressionScientific = function (e, t) { return n(e, this, i.assignmentsUnsupported()) }, e.FunctionDefinition.prototype.analyzeSingleExpressionScientific = function (e, t) { return n(e, this, i.functionDefinitionsUnsupported()) }, e.Equation.prototype.analyzeSingleExpressionScientific = function (e, t) { return n(e, this, i.equationsUnsupported()) }, e.And.prototype.analyzeSingleExpressionScientific = r, e.DoubleInequality.prototype.analyzeSingleExpressionScientific = r, e.BaseComparator.prototype.analyzeSingleExpressionScientific = r, e.Regression.prototype.analyzeSingleExpressionScientific = function (e, t) { return n(e, this, i.regressionsUnsupported()) }, e.ParenSeq.prototype.analyzeSingleExpressionScientific = function (e, t) { return n(e, this, i.pointsUnsupported()) } });
define('core/lib/dragmode', ["require", "exports"], function (require, e) { "use strict"; var r; Object.defineProperty(e, "__esModule", { value: !0 }), e.reconcileDragMode = e.DragMode = void 0, function (e) { e.NONE = "NONE", e.X = "X", e.Y = "Y", e.XY = "XY", e.AUTO = "AUTO" }(r = e.DragMode || (e.DragMode = {})), e.reconcileDragMode = function (e, n) { var t = function (e) { return e ? "none" === e[0].type && "none" === e[1].type ? r.NONE : "none" === e[1].type ? r.X : "none" === e[0].type ? r.Y : r.XY : r.NONE }(n); switch (e) { case r.NONE: return r.NONE; case r.AUTO: case r.XY: return t; case r.X: return t === r.X || t === r.XY ? r.X : r.NONE; case r.Y: return t === r.Y || t === r.XY ? r.Y : r.NONE; default: return r.NONE } } });
define('core/math/features/getgraphmode', ['require', 'parsenodes', 'core/types/graphmode', 'core/lib/dragmode', 'core/lib/dragmode', 'core/math/types'], function (require) { "use strict"; var e = require("parsenodes"), t = require("core/types/graphmode"), r = require("core/lib/dragmode").reconcileDragMode, o = require("core/lib/dragmode").DragMode, n = require("core/math/types"); function s(e, s) { if (s.isMovablePoint && function (e, t) { var n; return n = e && e.hasOwnProperty("dragMode") ? e.dragMode === o.AUTO ? t.defaultDragMode : e.dragMode : t.defaultDragMode, r(n, t.moveStrategy) }(this.userData, s) !== o.NONE) return t.XYPOINT_MOVABLE; var i = s.getDependencies(); switch (s.valueType) { case n.Point: case n.ListOfPoint: return 0 === i.length ? t.XYPOINT : e.validParametricVariables(i) ? 2 === e.dimensions() ? t.PARAMETRIC : t.PARAMETRIC_CURVE_3D : t.NONE; case n.Number: case n.ListOfNumber: return 2 === e.dimensions() && 1 === i.length ? t.Y : 3 === e.dimensions() && 2 === i.length ? t.Z_3D : t.NONE; case n.Polygon: case n.ListOfPolygon: return t.POLYGON; default: return t.NONE } } function i(e, r) { var o = r._expression.getDependencies(); if (o.length > 1) return t.NONE; if (r._expression.isList && 0 === r._expression.length) return t.NONE; var n = r._symbol; return e.graphMode(n, o) } function a(e, r) { return r.isError ? t.NONE : t.VISUALIZATION } e.Base.prototype.getGraphMode = function (e, r) { return t.NONE }, e.Expression.prototype.getGraphMode = s, e.Equation.prototype.getGraphMode = e.BaseComparator.prototype.getGraphMode = function (r, o) { var n = o.getDependencies(); return o.isConstant ? t.NONE : o instanceof e.SolvedEquation ? 0 === n.length ? r.graphableAsConstant(o._symbol) ? r.constantGraphMode(o._symbol) : t.NONE : i(r, o) : 1 === n.length || 2 === n.length ? t.IMPLICIT : t.NONE }, e.DoubleInequality.prototype.getGraphMode = function (e, t) { return e.constantGraphMode(t._symbol) }, e.Assignment.prototype.getGraphMode = function (r, o) { if (o instanceof e.SolvedEquation) return i(r, o); if (this.isEquation(o)) return this.asEquation().getGraphMode(r, o); var a = o.getDependencies(); switch (o.valueType) { case n.Number: case n.ListOfNumber: case n.EmptyList: switch (a.length) { case 0: return r.graphableAsConstant(this._symbol) ? r.constantGraphMode(this._symbol) : t.NONE; case 1: return o.valueType !== n.ListOfNumber || r.graphableListVariables(this._symbol, a[0]) ? this.isSlider ? t.NONE : r.graphMode(this._symbol, a) : t.NONE; case 2: return 3 === r.dimensions() && "z" === this._symbol ? t.Z_3D : t.NONE; default: return t.NONE }break; default: return s.call(this, r, o) } }, e.FunctionDefinition.prototype.getGraphMode = function (e, r) { if (1 !== this._argSymbols.length) return t.NONE; var o = e.graphMode(this._symbol, this._argSymbols), s = r.getDependencies(); switch (r.valueType) { case n.Number: case n.ListOfNumber: switch (s.length) { case 0: return o; case 1: return s[0] !== this._argSymbols[0] ? t.NONE : o; default: return t.NONE }break; default: return t.NONE } }, e.Regression.prototype.getGraphMode = function (e, r) { return this.isLhsSimple && r.isModelValid ? 1 !== r.model.getDependencies().length ? t.NONE : t.Y : t.NONE }, e.Object3D.prototype.getGraphMode = function (e, r) { return r.isError ? t.NONE : t.OBJECT3D }, e.Histogram.prototype.getGraphMode = a, e.DotPlot.prototype.getGraphMode = a, e.BoxPlot.prototype.getGraphMode = a, e.Image.prototype.getGraphMode = function (e, r) { return this.userData.showPoints ? this.center.isError || this.radianAngle.isError || this.width.isError || this.height.isError || this.opacity.isError ? t.NONE : t.XYPOINT : t.NONE } });
define('core/lib/color-helpers', ["require", "exports"], function (require, e) { "use strict"; function r(e) { return t(e) ? (e.match(/^#([A-Fa-f0-9]{3})$/g) && (e = "#" + e[1] + e[1] + e[2] + e[2] + e[3] + e[3]), e.toLowerCase()) : e } function t(e) { return "string" == typeof e && (e.match(/^#([A-Fa-f0-9]{3})$/g) || e.match(/^#([A-Fa-f0-9]{6})$/g)) } Object.defineProperty(e, "__esModule", { value: !0 }), e.colors = e.getDisplayColor = e.mutateOpacity = e.parseHex = e.invertColor = e.shadeColor = e.isValidHexColor = e.normalizeColor = void 0, e.normalizeColor = r, e.isValidHexColor = t, e.shadeColor = function (e, a) { if (!t(e = r(e))) return e; a > 1 && (a = 1), a < -1 && (a = -1); var o = parseInt(e.slice(1), 16), n = a < 0 ? 0 : 255, i = a < 0 ? -1 * a : a, l = o >> 16, c = o >> 8 & 255, s = 255 & o; return "#" + (16777216 + 65536 * (Math.round((n - l) * i) + l) + 256 * (Math.round((n - c) * i) + c) + (Math.round((n - s) * i) + s)).toString(16).slice(1) }, e.invertColor = function (e) { if (!t(e = r(e))) return e; var a = "0123456789abcdef"; return "#" + e.slice(1).split("").map(function (e) { return a[15 - a.indexOf(e)] }).join("") }, e.parseHex = function (e) { if (3 === (e = e.replace(/#/, "")).length) var r = parseInt(e.slice(0, 1) + e.slice(0, 1), 16), t = parseInt(e.slice(1, 2) + e.slice(1, 2), 16), a = parseInt(e.slice(2, 3) + e.slice(2, 3), 16); else if (6 === e.length) r = parseInt(e.slice(0, 2), 16), t = parseInt(e.slice(2, 4), 16), a = parseInt(e.slice(4, 6), 16); else r = 0, t = 0, a = 0; return { r: r, g: t, b: a } }, e.mutateOpacity = function (e, r) { var t = /(rgba\([\d]+\,\ ?[\d]+\,\ ?[\d]+\,\ ?)[\d.]+(\))/; return e.match(t) ? e.replace(t, "$1" + r + "$2") : e }, e.getDisplayColor = function (e, r) { if (r && r.colorLatexValue) { var t = r.colorLatexValue; return Array.isArray(t) ? t[0] : t } return e.color }, e.colors = { RED: "#c74440", BLUE: "#2d70b3", GREEN: "#388c46", PURPLE: "#6042a6", ORANGE: "#fa7e19", BLACK: "#000000", GRAY: "#aaaaaa" } });
define('core/math/features/getgraphinfo', ['require', 'parsenodes', 'core/math/domaintypes', 'core/math/types', 'core/lib/color-helpers'], function (require) { "use strict"; var e = require("parsenodes"), t = require("core/math/domaintypes"), n = require("core/math/types"), a = require("core/lib/color-helpers").getDisplayColor; function r(e) { switch (e.valueType) { case n.Number: return o(e); case n.Point: var t = o(e.elementAt(0)), a = o(e.elementAt(1)); if (!t || !a) return; return [t, a]; default: return } } function o(e) { var t = e.getDependencies(); switch (t.length) { case 0: return [+e.asValue(), 0]; case 1: if (e.polynomialOrder(t[0]) > 1) return; var n = e.getPolynomialCoefficients(t[0]); return [n[0] ? +n[0].asValue() : 0, n[1] ? +n[1].asValue() : 0]; default: return } } e.Base.prototype.getGraphInfo = function (e, n) { var o, i, s = n.getDependencies(); switch (s.length) { case 0: o = r(n), i = n.boundDomain("x"); break; case 1: "known" === (i = n.boundDomain(s[0])).type && (o = r(n)); break; case 2: i = t.unknownDomain() }return { graphMode: this.getGraphMode(e, n), color: a(this.userData, this.metaData), pointStyle: this.userData.pointStyle, lineStyle: this.userData.lineStyle, operator: this.getOperator(), isLinear: !!o, linearCoefficients: o, domainBound: i } } });
define('core/math/features/getMoveStrategy', ["require", "exports", "parsenodes", "core/math/types", "core/math/maybe-rational", "core/math/functions"], function (require, e, t, n, i, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var a = t.Constant(i.maybeRational(0, 1)); function o(e, t, n, i, r) { return { type: "updateSliderNonlinear", inputString: e, id: t, initialValue: n.constant_value, min: n.slider_min_number, max: n.slider_max_number, compiled: i, hasLinearComponent: r } } function s(e, t, n, i, r, o) { for (var s = t.getDependencies(), p = 0, u = s; p < u.length; p++) { if (r[u[p]]) return } for (var c = s.length - 1; c >= 0; c--) { var d = s[c]; if (!o[d]) { var f = i[d]; if (void 0 !== f) { var l = n[d]; if (1 === l.order) { var g = l.tree.getPolynomialCoefficients(d), y = g[1] || a, v = g[0] || a; if (v.isConstant && y.isConstant) if (isFinite(v.asValue()) && isFinite(y.asValue())) if (0 !== y.asValue()) return { symbol: d, id: f, coefficients: [-v.asValue() / y.asValue(), 1 / y.asValue()] } } } } } } function p(e, t) { var n = function (e) { for (var t = {}, n = 0; n < e.length; n++)t[e[n]] = !0; return t }(e), i = {}; for (var r in t) { var a = t[r].evaluationState.assignment; t[r].evaluationState.is_slidable && n[a] && (i[a] = r) } return i } function u(e, t, n, i) { for (var r = [], a = 0; a < n.length; a++) { var o = n[a], s = {}; r.push(s); for (var p = 0; p < i.length; p++) { var u = i[p], c = Object.create(t); c[u] = void 0; var d = o.tryGetConcreteTree(e, c); d.isError ? s[u] = { tree: d, order: 1 / 0 } : s[u] = { tree: d, order: d.polynomialOrder(u) } } } return r } function c(e, t, n) { for (var i = 0; i < e.length; i++) { var r = e[i]; 0 !== t[r].order && (n[r] = !0) } } t.Base.prototype.getMoveStrategy = function () { }, t.Assignment.prototype.getMoveStrategy = function (e, n, i, r, a) { if (this._expression instanceof t.ParenSeq) return this._expression.getMoveStrategy(e, n, i, r, a) }, t.ParenSeq.prototype.getMoveStrategy = function (e, t, i, a, d) { if (i.valueType === n.Point && 0 === i.getDependencies().length) { for (var f = p(this.getDependencies(), a), l = Object.keys(f), g = this.args, y = u(e, t, g, l), v = [], h = {}, S = {}, m = 0; m < 2; m++) { var C = g[m], b = C.getInputString(); if (C.isConstant) v[m] = { type: "updateCoordinate", inputString: b }; else { var _ = s(0, C, y[m], f, h, S); _ && (v[m] = { type: "updateSlider", inputString: b, id: _.id, coefficients: _.coefficients }, h[_.symbol] = !0, c(l, y[m], S)), v[m] || (v[m] = { type: "none", inputString: b }) } } var D, I = v[0], P = v[1]; if ("none" === I.type && "updateSlider" === P.type) for (var V = 0, M = g[0].getDependencies(); V < M.length; V++) { f[x = M[V]] === P.id && (D = x) } else if ("updateSlider" === I.type && "none" === P.type) for (var O = 0, j = g[1].getDependencies(); O < j.length; O++) { var x; f[x = j[O]] === I.id && (D = x) } else "none" === I.type && "none" === P.type && 1 === l.length && (D = l[0]); if (!D) return "none" !== I.type || "none" !== P.type ? v : void 0; var q, F = f[D]; try { var T = Object.create(t); T[D] = void 0, q = this.getConcreteTree(e, T).getCompiledFunction() } catch (e) { return } return r.dehydrateCompiledFunction(q), [o(g[0].getInputString(), F, a[F].evaluationState, q, "updateSlider" === I.type || "updateSlider" === P.type), { type: "none", inputString: g[1].getInputString() }] } }, t.Image.prototype.getMoveStrategy = function (e, t, i, r, a) { if (i.center.valueType === n.Point && 0 === i.center.getDependencies().length && i.width.isConstant && i.height.isConstant && i.radianAngle.isConstant && i.opacity.isConstant) { var o = p(this.getDependencies(), r), d = Object.keys(o), f = [this.width, this.height]; "ParenSeq" === this.center.type ? f.push(this.center.args[0], this.center.args[1]) : "Identifier" === this.center.type && (this.center.referencedStatementId = function (e, t) { for (var n in t) if (t[n].evaluationState.assignment === e) return n }(this.center._symbol, r)); for (var l = {}, g = {}, y = u(e, t, f, d), v = [], h = [2, 3, 0, 1], S = 0; S < h.length; S++) { var m = h[S], C = f[m]; if (C) { var b = C.getInputString(); if (C.isConstant) v[m] = { type: "updateCoordinate", inputString: b }; else { var _ = s(0, C, y[m], o, l, g); _ && (v[m] = { type: "updateSlider", inputString: b, id: _.id, coefficients: _.coefficients }, l[_.symbol] = !0, c(d, y[m], g)), v[m] || (v[m] = { type: "none", inputString: b }) } } else v[m] = { type: "none", inputString: "" } } if ("none" !== v[0].type || "none" !== v[1].type || "none" !== v[2].type || "none" !== v[3].type) return v } } });
define('core/math/features/getDefaultDragMode', ['require', 'parsenodes', 'core/lib/dragmode'], function (require) { "use strict"; var e = require("parsenodes"), t = require("core/lib/dragmode").DragMode; e.Base.prototype.getMoveStrategy = function () { return t.NONE }, e.Assignment.prototype.getDefaultDragMode = function (e) { return "none" !== e[0].type && "none" !== e[1].type ? t.XY : "none" !== e[0].type ? t.X : "none" !== e[1].type ? t.Y : t.NONE }, e.ParenSeq.prototype.getDefaultDragMode = function (e) { return "updateSlider" === e[0].type && "updateSlider" === e[1].type ? t.XY : "updateSlider" === e[0].type ? t.X : "updateSlider" === e[1].type ? t.Y : "updateSliderNonlinear" === e[0].type && e[0].hasLinearComponent ? t.X : t.NONE } });
define('core/math/features/tableinfo', ['require', 'parsenodes', 'core/math/types', 'core/lib/label', 'core/math/distribution-spec'], function (require) { "use strict"; var e = require("parsenodes"), t = e.List, n = require("core/math/types"), i = require("core/lib/label"), r = require("core/math/distribution-spec").getFunctionSpecFromTree; e.Base.prototype.tableInfo = function (e, t) { return !1 }, e.Identifier.prototype.tableInfo = function (e, t) { return !!e.validFirstColumnVariable(this._symbol) && { independent_variable: this._symbol, dependent_column: this.getInputString(), by_reference: !1 } }, e.Expression.prototype.tableInfo = function (e, i) { var o = i.getDependencies(); if (r(this)) return !1; switch (i.valueType) { case n.Point: case n.ListOfPoint: return 0 === o.length && ((!i.isMovablePoint || "updateSlider" !== i.moveStrategy[0].type && "updateSlider" !== i.moveStrategy[1].type) && { independent_variable: "x", dependent_column: "y", by_reference: !1, values: t.wrap(i).asValue() }); case n.Number: if (1 !== o.length) return !1; var a = o[0]; return !!e.validFirstColumnVariable(a) && { independent_variable: a, dependent_column: this.getInputString(), by_reference: !1 }; default: return !1 } }, e.Assignment.prototype.tableInfo = function (t, n) { if (n instanceof e.SolvedEquation) return !1; if (!this.getInputString().length) return !1; if (r(this)) return !1; var o, a = n.getDependencies(); if (a.length > 1) return !1; if (0 === a.length) { if (!t.tableableAsConstant(this._symbol)) return !1; o = t.implicitIndependent(this._symbol) } else o = a[0]; return !!t.validFirstColumnVariable(o) && { independent_variable: o, dependent_column: t.assignmentForbidden(this._symbol) ? i.trimLatex(this.getInputString().replace(/[^=]*=/, "")) : i.trimLatex(this.getInputString().split("=")[0]), by_reference: !t.assignmentForbidden(this._symbol) } }, e.FunctionDefinition.prototype.tableInfo = function (e, t) { if (1 !== this._argSymbols.length) return !1; if (!this.getInputString().length) return !1; if (t.getDependencies().length > 1) return !1; var n = this._argSymbols[0]; if (!e.validFirstColumnVariable(n)) return !1; var r = e.assignmentForbidden(this._symbol); return { independent_variable: n, dependent_column: r ? i.trimLatex(this.getInputString().replace(/[^=]*=/, "")) : i.trimLatex(this.getInputString().split("=")[0]), by_reference: !r } }, e.BaseComparator.prototype.tableInfo = function (e, t) { return !1 }, e.DoubleInequality.prototype.tableInfo = function (e, t) { return !1 }, e.Equation.prototype.tableInfo = function (e, t) { return !1 } });
define('core/math/features/tableerror', ['require', 'parsenodes', 'core/lib/worker-i18n'], function (require) { "use strict"; var r = require("parsenodes"), e = require("core/lib/worker-i18n"); r.Base.prototype.tableError = function () { return this.isInequality() ? e.s("shared-calculator-error-table-inequality-supplement") : !(this instanceof r.Expression || this instanceof r.IRExpression) && e.s("shared-calculator-error-table-generic-supplement") }, r.List.prototype.tableError = function () { return e.s("shared-calculator-error-table-list-supplement") }, r.Equation.prototype.tableError = r.Assignment.prototype.tableError = function () { return e.s("shared-calculator-error-table-equation-supplement") }, r.FunctionDefinition.prototype.tableError = function () { return e.s("shared-calculator-error-table-function-definition-supplement") }, r.Regression.prototype.tableError = function () { return e.s("shared-calculator-error-table-regression-supplement") } });
define('core/math/curve-accumulator', ["require", "exports", "core/math/distance"], function (require, t, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Accumulator = void 0; var i = function () { function t(t) { t ? (this.xtolerance = t.xtolerance || t.tolerance || 0, this.ytolerance = t.ytolerance || t.tolerance || 0, this.ztolerance = t.ztolerance || t.tolerance || 0, this.map = t.map) : this.xtolerance = this.ytolerance = this.ztolerance = 0, this.segments = [], this.segment = [], this.pivotPoint = void 0, this.pendingPoint = void 0 } return t.prototype.colinear = function (t, i, n) { this.map && (t = this.map(t), i = this.map(i), n = this.map(n)); var s = e.pointToSegmentParameter(n[0], n[1], n[2] || 0, t[0], t[1], t[2] || 0, i[0], i[1], i[2] || 0); if (s < 1) return !1; var h = [t[0] + s * (i[0] - t[0]), t[1] + s * (i[1] - t[1]), 3 === t.length ? t[2] + s * (i[2] - t[2]) : 0]; return Math.abs(n[0] - h[0]) <= this.xtolerance && Math.abs(n[1] - h[1]) <= this.ytolerance && (2 === t.length || Math.abs(n[2] - h[2]) <= this.ztolerance) }, t.prototype.addPoint = function (t) { if (this.dimensions = t.length, this.xtolerance < 0 && this.ytolerance < 0 && (2 === this.dimensions || this.ztolerance < 0)) this.segment.push.apply(this.segment, t); else if (this.segment.length) { var i = 2 === this.dimensions ? [this.segment[this.segment.length - 2], this.segment[this.segment.length - 1]] : [this.segment[this.segment.length - 3], this.segment[this.segment.length - 2], this.segment[this.segment.length - 1]]; if (t[0] !== i[0] || t[1] !== i[1] || t[2] !== i[2]) { if (!this.pivotPoint || !this.pendingPoint) return this.pivotPoint = t, void (this.pendingPoint = t); (!this.colinear(i, this.pivotPoint, t) || e.hypot(i[0] - t[0], i[1] - t[1], (i[2] || 0) - (t[2] || 0)) < e.hypot(i[0] - this.pendingPoint[0], i[1] - this.pendingPoint[1], (i[2] || 0) - (this.pendingPoint[2] || 0))) && (this.flushPending(), this.pivotPoint = t), this.pendingPoint = t } } else this.segment.push.apply(this.segment, t) }, t.prototype.flushPending = function () { this.pendingPoint && (this.segment.push.apply(this.segment, this.pendingPoint), this.pivotPoint = void 0, this.pendingPoint = void 0) }, t.prototype.breakSegment = function () { this.flushPending(), this.segment.length > (this.dimensions || 2) && this.segments.push(this.segment), this.segment = [] }, t.prototype.getSegments = function () { return this.breakSegment(), this.segments }, t.prototype.finish = function () { return { segments: this.getSegments(), resolved: !0 } }, t }(); t.Accumulator = i });
define('core/math/implicit-plotter', ["require", "exports", "core/math/distance", "./curve-accumulator"], function (require, e, r, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.displayTriangles = e.traceContours = e.triangulate = e.buildQuadTree = e.sampleImplicitDiagnostic = e.sampleImplicit = void 0; var n = Math.pow(2, 14); function t(e, r) { var i = Math.pow(2, -5), n = u(r, i), t = u(r, 2 * i), c = v(e, n, t), a = k(c.root, e, n); return { paddedDomain: n, rootDomain: t, quadTree: c, triangles: a, contours: I(a, e, n) } } function c(e, r, i) { return { x: e, y: r, z: i } } function a(e, r, i) { return { x: e, y: r, isZero: i } } function s(e, r, i) { return { vertices: [e, r, i], visited: !1, next: void 0 } } function u(e, r) { var i = (1 + r) * e.xmin - r * e.xmax, n = (1 + r) * e.xmax - r * e.xmin; return { xmin: i, ymin: (1 + r) * e.ymin - r * e.ymax, xmax: n, ymax: (1 + r) * e.ymax - r * e.ymin, xtolerance: e.xtolerance, ytolerance: e.ytolerance } } function o(e, r) { return { depth: e, vertices: r, children: void 0, center: void 0 } } function l(e, r, i) { e.center = p(e.vertices[0], e.vertices[1], e.vertices[2], e.vertices[3], r, i) } function v(e, r, i) { var t = function (e, r) { var i = r.xmin, n = r.xmax, t = r.ymin, c = r.ymax; return o(0, [m(i, c, e), m(n, c, e), m(n, t, e), m(i, t, e)]) }(e, i), c = [], a = []; a.push(t); var s = 1, u = !0; e: for (; a.length;) { var v = c; c = a, a = v; for (var h = void 0; h = c.pop();)if (d(h, e, r)) { if (f(h, e), !h.children) { u = !1; break e } if (a.push(h.children[0]), a.push(h.children[1]), a.push(h.children[2]), a.push(h.children[3]), (s += 3) >= n) { u = !1; break e } } else l(h, e, r) } for (var x = 0; x < c.length; x++)l(c[x], e, r); for (x = 0; x < a.length; x++)l(a[x], e, r); return { root: t, resolved: u } } function f(e, r) { var i = e.depth + 1, n = e.vertices[0], t = e.vertices[1], c = e.vertices[2], a = e.vertices[3], s = y(n, t, r), u = y(t, c, r), l = y(c, a, r), v = y(a, n, r), f = y(n, c, r); e.children = [o(i, [n, s, f, v]), o(i, [s, t, u, f]), o(i, [f, u, c, l]), o(i, [v, f, l, a])] } function d(e, r, i) { if (e.depth < 5) return !0; if (function (e, r) { return e.vertices[0].x < r.xmin || e.vertices[0].y > r.ymax || e.vertices[2].x > r.xmax || e.vertices[2].y < r.ymin }(e, i)) return !1; if (function (e, r) { if (e.vertices[1].x - e.vertices[0].x < 10 * r.xtolerance) return !0; if (e.vertices[0].y - e.vertices[3].y < 10 * r.ytolerance) return !0; return !1 }(e, i)) return !1; var n = e.vertices[0], t = e.vertices[1], c = e.vertices[2], a = e.vertices[3]; if (isNaN(n.z) && isNaN(t.z) && isNaN(c.z) && isNaN(a.z)) return !1; if (isNaN(n.z) || isNaN(t.z) || isNaN(c.z) || isNaN(a.z)) return !0; var s = p(n, t, c, a, r, i), u = N(n, t, r, i), o = N(t, c, r, i), l = N(c, a, r, i), v = N(a, n, r, i); return x(n, u, r) || x(t, u, r) || x(t, o, r) || x(c, o, r) || x(c, l, r) || x(a, l, r) || x(a, v, r) || x(n, v, r) || h(n, u, s, r, i) || h(u, t, s, r, i) || h(t, o, s, r, i) || h(o, c, s, r, i) || h(c, l, s, r, i) || h(l, a, s, r, i) || h(a, v, s, r, i) || h(v, n, s, r, i) } function h(e, i, n, t, c) { if (e.z > 0 == i.z > 0 && i.z > 0 == n.z > 0) return !1; var a, s, u, o; if (e.z > 0 == i.z > 0) { if ((a = y(e, i, t)).z > 0 != e.z > 0) return !0; s = b(e, n, t, c), u = b(i, n, t, c), o = b(a, n, t, c) } else if (i.z > 0 == n.z > 0) { if ((a = y(i, n, t)).z > 0 != i.z > 0) return !0; s = b(i, e, t, c), u = b(n, e, t, c), o = b(a, e, t, c) } else { if ((a = y(n, e, t)).z > 0 != n.z > 0) return !0; s = b(n, i, t, c), u = b(e, i, t, c), o = b(a, i, t, c) } var l = c.xtolerance, v = c.ytolerance; return r.pointToSegment(v * o.x, l * o.y, v * s.x, l * s.y, v * u.x, l * u.y) > l * v } function x(e, r, i) { if (isNaN(e.z) && isNaN(r.z)) return !1; if (isNaN(e.z) || isNaN(r.z)) return e.z > 0 || r.z > 0; var n = 4 * y(e, r, i).z - r.z - 3 * e.z, t = 1e-4, c = (i(.9999 * e.x + t * r.x, .9999 * e.y + t * r.y) - e.z) / t, a = Math.max(Math.abs(e.z), Math.abs(r.z)); return Math.abs(n - c) > .125 * a } function z(e, r) { return e.x < r.xmin || e.x > r.xmax || e.y < r.ymin || e.y > r.ymax } function m(e, r, i) { return c(e, r, i(e, r)) } function y(e, r, i) { return m(.5 * (e.x + r.x), .5 * (e.y + r.y), i) } function N(e, r, i, n) { if (z(e, n) || z(r, n)) return y(e, r, i); if (isNaN(e.z) || isNaN(r.z)) return function (e, r, i, n) { if (isNaN(e.z) === isNaN(r.z)) return y(e, r, i); if (isNaN(e.z)) { var t = e; e = r, r = t } var a = e.x, s = r.x, u = e.y, o = r.y, l = e.z, v = n.xtolerance, f = n.ytolerance; for (; Math.abs(a - s) > v || Math.abs(u - o) > f;) { var d = .5 * (a + s), h = .5 * (u + o), x = i(d, h); isNaN(x) === isNaN(l) ? (a = d, u = h, l = x) : (s = d, o = h) } return c(a, u, l) }(e, r, i, n); if (e.z > 0 != r.z > 0) return y(e, r, i); var t = .01, a = i(.99 * e.x + t * r.x, .99 * e.y + t * r.y) - e.z, s = r.z - i(t * e.x + .99 * r.x, t * e.y + .99 * r.y); return isNaN(a) || isNaN(s) || a > 0 == s > 0 ? y(e, r, i) : g(c(e.x, e.y, a), c(r.x, r.y, s), i) } function p(e, r, i, n, t, c) { var a = N(e, i, t, c); return e.z > 0 == i.z > 0 && a.z > 0 != e.z > 0 ? a : (a = N(r, n, t, c), r.z > 0 == n.z > 0 && a.z > 0 != r.z > 0 ? a : y(e, i, t)) } function g(e, r, i) { if (isNaN(e.z)) return r; if (isNaN(r.z)) return e; if (isFinite(e.z) || isFinite(r.z)) { if (isFinite(e.z)) { if (isFinite(r.z)) { var n = 1 - e.z / r.z, t = 1 - r.z / e.z; return m(e.x / n + r.x / t, e.y / n + r.y / t, i) } return e } return r } return y(e, r, i) } function b(e, r, i, n) { var t = e.x, s = r.x, u = e.y, o = r.y, l = e.z, v = r.z, f = n.xtolerance, d = n.ytolerance; if (z(e, n) || z(r, n)) { var h = y(e, r, i); return a(h.x, h.y, !1) } for (; Math.abs(t - s) > f || Math.abs(u - o) > d;) { var x = .5 * (t + s), m = .5 * (u + o), N = i(x, m); N > 0 == l > 0 ? (t = x, u = m, l = N) : (s = x, o = m, v = N) } if (isNaN(l)) return a(s, o, !1); if (isNaN(v)) return a(t, u, !1); var p = g(c(t, u, l), c(s, o, v), i), b = 0 === l || 0 === v || 0 === p.z || p.z >= l == v >= p.z && Math.abs(p.z) < 1e250; return a(p.x, p.y, b) } function k(e, r, i) { var n = { triangles: [], edgeCache: {}, domain: i, fn: r }; return M(e, n), n.triangles } function M(e, r) { e.children && (M(e.children[0], r), M(e.children[1], r), M(e.children[2], r), M(e.children[3], r), A(e.children[0], e.children[1], r), A(e.children[3], e.children[2], r), S(e.children[1], e.children[2], r), S(e.children[0], e.children[3], r)) } function A(e, r, i) { e.children && r.children ? (A(e.children[1], r.children[0], i), A(e.children[2], r.children[3], i)) : e.children ? (A(e.children[1], r, i), A(e.children[2], r, i)) : r.children ? (A(e, r.children[0], i), A(e, r.children[3], i)) : function (e, r, i) { if (!e.center || !r.center) return; var n, t; e.depth >= r.depth ? (n = N(e.vertices[1], e.vertices[2], i.fn, i.domain), t = T(e.vertices[1], r.center, e.vertices[2], e.center, n)) : (n = N(r.vertices[0], r.vertices[3], i.fn, i.domain), t = T(r.vertices[0], r.center, r.vertices[3], e.center, n)); D(t, i.edgeCache, i.domain); for (var c = 0; c < 4; c++)i.triangles.push(t[c]) }(e, r, i) } function S(e, r, i) { e.children && r.children ? (S(e.children[2], r.children[1], i), S(e.children[3], r.children[0], i)) : e.children ? (S(e.children[2], r, i), S(e.children[3], r, i)) : r.children ? (S(e, r.children[1], i), S(e, r.children[0], i)) : function (e, r, i) { if (!e.center || !r.center) return; var n, t; e.depth >= r.depth ? (n = N(e.vertices[3], e.vertices[2], i.fn, i.domain), t = T(e.vertices[2], r.center, e.vertices[3], e.center, n)) : (n = N(r.vertices[1], r.vertices[0], i.fn, i.domain), t = T(r.vertices[1], r.center, r.vertices[0], e.center, n)); D(t, i.edgeCache, i.domain); for (var c = 0; c < 4; c++)i.triangles.push(t[c]) }(e, r, i) } function T(e, r, i, n, t) { return [s(e, t, r), s(r, t, i), s(i, t, n), s(n, t, e)] } function C(e, r, i) { return e.z > 0 && !z(e, i) && (!(r.z > 0) || z(r, i)) } function w(e, r) { return e.x + "," + e.y + "," + r.x + "," + r.y } function D(e, r, i) { F(e[0], e[1], e[2], w(e[1].vertices[2], e[1].vertices[0]), r, i), F(e[1], e[2], e[3], w(e[2].vertices[0], e[2].vertices[2]), r, i), F(e[2], e[3], e[0], w(e[3].vertices[2], e[3].vertices[0]), r, i), F(e[3], e[0], e[1], w(e[0].vertices[0], e[0].vertices[2]), r, i) } function F(e, r, i, n, t, c) { var a = r.vertices[0], s = r.vertices[1], u = r.vertices[2]; C(s, u, c) && (r.next = i), C(a, s, c) && (r.next = e), C(u, a, c) && function (e, r, i) { i[r] ? e.next = i[r] : i[r] = e }(r, n, t), C(a, u, c) && function (e, r, i) { i[r] ? i[r].next = e : i[r] = e }(r, n, t) } function I(e, r, n) { for (var t = { fillAccumulator: new i.Accumulator(n), strokeAccumulator: new i.Accumulator(n), fn: r, domain: n }, c = 0; c < e.length; c++) { var a = e[c]; a.next && !a.visited && q(a, t) } return { strokeSegments: t.strokeAccumulator.finish().segments, fillSegments: t.fillAccumulator.finish().segments } } function q(e, r) { for (; ;) { var i = e.vertices[0], n = e.vertices[1], t = e.vertices[2]; if (P(i, n, r), P(n, t, r), P(t, i, r), e.visited) break; if (!e.next) break; e.visited = !0, e = e.next } r.strokeAccumulator.breakSegment(), r.fillAccumulator.breakSegment() } function P(e, r, i) { if (C(e, r, i.domain)) { var n = b(e, r, i.fn, i.domain); i.fillAccumulator.addPoint([n.x, n.y]), n.isZero ? i.strokeAccumulator.addPoint([n.x, n.y]) : i.strokeAccumulator.breakSegment() } } e.sampleImplicit = function (e, r) { var i = t(e, r); return { segments: i.contours.strokeSegments, fillSegments: i.contours.fillSegments, resolved: i.quadTree.resolved } }, e.sampleImplicitDiagnostic = t, e.buildQuadTree = v, e.triangulate = k, e.traceContours = I, e.displayTriangles = function (e) { for (var r = [], i = 0; i < e.length; i++) { var n = e[i]; r.push([n.vertices[0].x, n.vertices[0].y, n.vertices[1].x, n.vertices[1].y, n.vertices[2].x, n.vertices[2].y, n.vertices[0].x, n.vertices[0].y]) } return r } });
define('core/math/poi-finding-accumulator', ["require", "exports", "core/math/workerconfig", "tslib", "./curve-accumulator", "./poi"], function (require, e, t, i, r, s) { "use strict"; function u(e) { return Math.abs(e) < 5e-8 } Object.defineProperty(e, "__esModule", { value: !0 }); var f = function (e) { function r(t, i, r) { var s = e.call(this, t) || this; return s.domain = t, s.fn = i, s.derivative = r, s.poiData = { zeros: { x: [], y: [] }, intercept: { x: [], y: [] }, extrema: { x: [], y: [] } }, s.zeroBuffer = [], s.extremumBuffer = [], s } return i.__extends(r, e), r.prototype.getPOI = function () { return t.pointsOfInterest ? (void 0 !== this.fn && (this.poiData.intercept = this.findIntercept(this.fn)), this.poiData) : { zeros: { x: [], y: [] }, intercept: { x: [], y: [] }, extrema: { x: [], y: [] } } }, r.prototype.addLinearZero = function (e) { var t = -e[0] / e[1]; this.isOutsideDomain(t) || (this.poiData.zeros = { x: [t], y: [0] }) }, r.prototype.addLinearIntercept = function (e) { this.isOutsideDomain(0) || (this.poiData.intercept = { x: [0], y: [e[0]] }) }, r.prototype.isOutsideDomain = function (e) { return !this.domain || void 0 === this.domain.min || void 0 === this.domain.max || (e < this.domain.min || e > this.domain.max || isNaN(e)) }, r.prototype.addPoint = function (t) { 0 === this.segment.length && u(t[1]) && (this.poiData.zeros.x.push(t[0]), this.poiData.zeros.y.push(t[1])), this.updateZeroBuffer(t), this.updateExtremumBuffer(t), e.prototype.addPoint.call(this, t) }, r.prototype.updateZeroBuffer = function (e) { if (this.fn) if (isFinite(e[0]) && isFinite(e[1])) switch (this.zeroBuffer.length) { case 0: if (u(e[1])) return; return void this.zeroBuffer.push(e); case 1: return 0 === e[1] ? void this.zeroBuffer.push(e) : e[1] > 0 != this.zeroBuffer[0][1] > 0 ? ((t = s.bisectZero(this.zeroBuffer[0][0], this.zeroBuffer[0][1], e[0], e[1], this.fn)) && (this.poiData.zeros.x.push(t[0]), this.poiData.zeros.y.push(t[1])), this.zeroBuffer.length = 0, void this.zeroBuffer.push(e)) : (this.zeroBuffer.length = 0, void this.zeroBuffer.push(e)); case 2: if (0 === e[1]) return; var t; return e[1] > 0 != this.zeroBuffer[0][1] > 0 ? ((t = s.flatCenter(this.zeroBuffer[0][0], this.zeroBuffer[0][1], this.zeroBuffer[1][0], this.zeroBuffer[1][1], e[0], e[1], this.fn)) && (this.poiData.zeros.x.push(t[0]), this.poiData.zeros.y.push(t[1])), this.zeroBuffer.length = 0, void this.zeroBuffer.push(e)) : (this.zeroBuffer.length = 0, void this.zeroBuffer.push(e)) } else this.zeroBuffer.length = 0 }, r.prototype.updateExtremumBuffer = function (e) { if (this.fn) if (isFinite(e[0]) && isFinite(e[1])) switch (this.extremumBuffer.length) { case 0: return void this.extremumBuffer.push(e); case 1: return e[1] === this.extremumBuffer[0][1] && (this.extremumBuffer.length = 0), void this.extremumBuffer.push(e); case 2: if (e[1] === this.extremumBuffer[1][1]) return void this.extremumBuffer.push(e); if (e[1] > this.extremumBuffer[1][1] != this.extremumBuffer[1][1] > this.extremumBuffer[0][1]) { if (t = this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0], this.extremumBuffer[0][1], this.extremumBuffer[1][0], this.extremumBuffer[1][1], e[0], e[1])) this.poiData.extrema.x.push(t[0]), this.poiData.extrema.y.push(t[1]), !!!s.bisectJump(this.extremumBuffer[0][0], this.extremumBuffer[0][1], t[0], t[1], e[0], e[1], this.fn, this.ytolerance) && t[0] > this.segment[this.segment.length - 2] && (this.pendingPoint = t); return this.extremumBuffer.shift(), void this.extremumBuffer.push(e) } return this.extremumBuffer.shift(), void this.extremumBuffer.push(e); case 3: if (e[1] === this.extremumBuffer[1][1]) return; if (e[1] > this.extremumBuffer[1][1] != this.extremumBuffer[1][1] > this.extremumBuffer[0][1]) { var t = void 0, i = .5 * (this.extremumBuffer[1][0] + this.extremumBuffer[2][0]), r = this.fn(i); return (t = r === this.extremumBuffer[1][1] ? s.flatCenter(this.extremumBuffer[0][0], this.extremumBuffer[0][1], this.extremumBuffer[1][0], this.extremumBuffer[1][1], e[0], e[1], this.fn) : this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0], this.extremumBuffer[1][1], i, r, this.extremumBuffer[2][0], this.extremumBuffer[2][1])) && (this.poiData.extrema.x.push(t[0]), this.poiData.extrema.y.push(t[1])), this.extremumBuffer.shift(), this.extremumBuffer.shift(), void this.extremumBuffer.push(e) } return this.extremumBuffer.shift(), this.extremumBuffer.shift(), void this.extremumBuffer.push(e) } else this.zeroBuffer.length = 0 }, r.prototype.bisectExtremumUsingDerivative = function (e, t, i, r, u, f) { if (this.fn) { var h; if (this.derivative) { var n = this.derivative(e), m = this.derivative(u); if (!isNaN(n) && !isNaN(m) && n < 0 != m < 0) { var o = s.bisectZero(e, n, u, m, this.derivative); o && (h = [o[0], this.fn(o[0])]) } } return h || (h = s.bisectExtremum(e, t, i, r, u, f, this.fn)), h } }, r.prototype.breakSegment = function () { this.zeroBuffer.length = 0, this.extremumBuffer.length = 0, this.flushPending(), this.segment.length > 2 && (this.segments.push(this.segment), u(this.segment[this.segment.length - 1]) && (this.poiData.zeros.x.push(this.segment[this.segment.length - 2]), this.poiData.zeros.y.push(this.segment[this.segment.length - 1]))), this.segment = [] }, r.prototype.findIntercept = function (e) { if (!e) return { x: [], y: [] }; var t = e(0); return isFinite(t) ? { x: [0], y: [e(0)] } : { x: [], y: [] } }, r.prototype.finish = function () { return { segments: this.getSegments(), resolved: !0, poi: this.getPOI() } }, r }(r.Accumulator); e.default = f });
define('core/math/copy-defined-pois', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); e.default = function (e) { for (var r = [], t = [], u = e.length, n = 0; n < u; n++)r.push(e[n][0]), t.push(e[n][1]); return { defined: { x: r, y: t } } } });
define('core/math/plotter', ["require", "exports", "tslib", "core/math/distance", "./poi", "./implicit-plotter", "./curve-accumulator", "./poi-finding-accumulator", "core/types/graphmode", "./domaintypes", "core/math/copy-defined-pois"], function (require, e, n, i, t, r, a, o, s, m, c) { "use strict"; function l(e, n) { var i = new o.default(n), t = e[0] + n.min * e[1], r = e[0] + n.max * e[1]; return isFinite(t) && isFinite(r) ? (i.addPoint([n.min, t]), i.addPoint([n.max, r]), i.addLinearZero(e), i.addLinearIntercept(e), i.finish()) : i.finish() } function u(e, i) { var t = e(i); return { segments: [n.__spreadArray(n.__spreadArray([], t), t)], resolved: !0 } } function d(e, n, r) { var a = r.fn, o = r.jumpTolerance, s = e[0], m = e[1], c = n[0], l = n[1], u = i.mean(s, c), d = a(u); return t.bisectJump(s, m, u, d, c, l, a, o) } Object.defineProperty(e, "__esModule", { value: !0 }), e.errorBranch = void 0, e.errorBranch = function (e) { return { graphMode: s.ERROR, error: e, segments: [] } }; var p = function (e, n, i) { var t = i.fn, r = i.jumpTolerance, a = i.accumulator; if (!isFinite(r) || r <= 0) return n; var o = d(e, n, i); if (!o) return n; for (var s = (n[0] - e[0]) / 10, m = [-s, s], c = n, l = 0; l < m.length; l++) { var u = e[0] + m[l], p = t(u); isFinite(p) || (u = e[0], p = e[1], u = e[0], p = e[1]); var f = n[0] + m[l], h = t(f); if (isFinite(h) ? c = [f, h] : (f = n[0], h = n[1]), d([u, p], [f, h], i)) { var v = o[0], g = o[1]; return a.addPoint(v), a.breakSegment(), a.addPoint(g), n } } return c }, f = function (e, n, i) { this.derivative = i, this.accumulator = new o.default(n, e, i), this.fn = e, this.jumpTolerance = n.ytolerance || n.tolerance || 0 }; function h(e, n, i) { var t = n, r = e(t); return isFinite(r) || (r = e(t = n + i)), isFinite(r) || (r = e(t = n - i)), [t, r] } function v(e, n, i) { var r, a, o, s, m, c, l, u = new f(e, n, i), d = n.step / 10, v = n.min, g = [l = (r = h(e, v, d))[0], c = r[1]]; isFinite(c) && u.accumulator.addPoint([l, c]); for (var x = Math.ceil((n.max - n.min) / n.step), y = 1; y <= x; y++)l = (a = h(e, v = (x - y) / x * n.min + y / x * n.max, d))[0], c = a[1], isFinite(c) && isFinite(g[1]) ? (l = (o = p(g, [l, c], u))[0], c = o[1], u.accumulator.addPoint([l, c])) : isFinite(c) && !isFinite(g[1]) ? (m = t.bisectFinite(g[0], g[1], l, c, e)) && (m[0] !== l && u.accumulator.addPoint(m), l = (s = p(m, [l, c], u))[0], c = s[1], u.accumulator.addPoint([l, c])) : !isFinite(c) && isFinite(g[1]) && (m = t.bisectFinite(g[0], g[1], l, c, e)) && ((m = p(g, m, u))[0] !== g[0] && u.accumulator.addPoint(m), u.accumulator.breakSegment()), g = [l, c]; return u.accumulator.finish() } function g(e, n, i, t) { var r, a, o, s = n.min, m = n.max - n.min, c = n.xtolerance && n.ytolerance ? Math.min(n.xtolerance, n.ytolerance) : n.tolerance ? n.tolerance : 0, l = Math.floor(m / (Math.PI / i)); function u(e, n) { var r = n % 2 == 0 ? 1 : -1; if (!t && -1 === r) return !1; for (var a = n * (Math.PI / i), o = [s, s + 1, s + 2, s + 3], m = !1, l = 0, u = o.length; l < u; l++) { var d = e(o[l]), p = e(o[l] + a); if (isFinite(d) && isFinite(p) && (m = !0), isFinite(d) !== isFinite(p) || Math.abs(d - r * p) > c) return !1 } return !!m } for (r = 1; r <= l; r++)if (u(e, r)) { for (o = r, a = 2; a * r <= l; a++)u(e, a * r) || (o = void 0); if (o) break } return o ? o * (Math.PI / i) : null } function x(e) { return [e[1] * Math.cos(e[0]), e[1] * Math.sin(e[0])] } function y(e, n) { return n.map = x, v(e, n) } function F(e, n) { if (n.max < n.min) return { segments: [], resolved: !0 }; var i, t = new a.Accumulator(n), r = n.min, o = e(r); return isFinite(o[0]) && isFinite(o[1]) && t.addPoint(o), function (e, n) { for (var i = e.min, t = e.max, r = e.step, a = t - i, o = Math.ceil(a / r), s = a / o, m = 0; m < o; m++)n(i + m * s); n(t) }(n, function (n) { i = e(n), w(e, r, o, n, i, 10, t), r = n, o = i }), t.finish() } function w(e, n, t, r, a, o, s) { if (r !== n) { var m = s.xtolerance, c = s.ytolerance, l = s.ztolerance, u = i.mean(n, r), d = e(u), p = isFinite(t[0]) && isFinite(t[1]) && (2 === t.length || isFinite(t[2])), f = isFinite(a[0]) && isFinite(a[1]) && (2 === a.length || isFinite(a[2])), h = isFinite(d[0]) && isFinite(d[1]) && (2 === d.length || isFinite(d[2])); if (0 === o || u === n || u === r) return s.breakSegment(), void (f && s.addPoint(a)); if (p || f) if (p === f) { if (p && h && f) { var v = i.pointToSegmentParameter(d[0], d[1], d[2] || 0, t[0], t[1], t[2] || 0, a[0], a[1], a[2] || 0); if (v > .2 && v < .8 && Math.abs(d[0] - (t[0] + v * (a[0] - t[0]))) <= m && Math.abs(d[1] - (t[1] + v * (a[1] - t[1]))) <= c && (2 === t.length || Math.abs(d[2] - (t[2] + v * (a[2] - t[2]))) <= l)) return void s.addPoint(a) } t[0] === d[0] && t[1] === d[1] || w(e, n, t, u, d, o - 1, s), a[0] === d[0] && a[1] === d[1] || w(e, u, d, r, a, o - 1, s) } else { for (var g = n, x = r, y = t, F = a; n !== u && u !== r;)h == p ? (n = u, t = d, p = h) : (r = u, a = d, f = h), d = e(u = n + (r - n) / 2), h = isFinite(d[0]) && isFinite(d[1]) && (2 === d.length || isFinite(d[2])); p ? (w(e, g, y, n, t, o - 1, s), s.breakSegment()) : (s.breakSegment(), s.addPoint(a), w(e, r, a, x, F, o - 1, s)) } } } function P(e, n, i) { var t = e.viewport.xmin, r = e.viewport.xmax, a = e.viewport.ymin, o = e.viewport.ymax, c = n.lineWidth; if (c > 3) { var l = c * (r - t) / e.screen.width, u = c * (o - a) / e.screen.height; t -= l, r += l, a -= u, o += u } var d, p, f = e.trigAngleMultiplier || 1, h = e.oversample || 4, v = 1 / h * (r - t) / e.screen.width, x = 1 / h * (o - a) / e.screen.height, y = n.domainBound; switch (n.graphMode) { case s.X: switch ((d = m.intersectDomains(m.knownDomain([a, o]), y)).type) { case "empty": return !1; case "known": a = d.bounds[0], o = d.bounds[1] }p = { min: a, max: o, xtolerance: x, ytolerance: v, step: x }; break; case s.Y: switch ((d = m.intersectDomains(m.knownDomain([t, r]), y)).type) { case "empty": return !1; case "known": t = d.bounds[0], r = d.bounds[1] }p = { min: t, max: r, xtolerance: v, ytolerance: x, step: v }; break; case s.POLAR: if (!n.domain) throw new Error("Expected polar graph to have domain"); if (p = { min: n.domain.min, max: n.domain.max, step: 2 * Math.PI / f / 1e3, tolerance: Math.min(v, x) }, !n.domain.isExplicit) { var F = g(i, p, f, "=" === n.operator); F && (p.max = p.min + F) } p.step = Math.max(p.step, (p.max - p.min) / 11999); break; case s.PARAMETRIC: case s.PARAMETRIC_CURVE_3D: var w = n.domain ? n.domain.min : 0, P = n.domain ? n.domain.max : 1, M = n.domain ? n.domain.step : .01; switch ((d = m.intersectDomains(m.knownDomain([w, P]), y)).type) { case "empty": return !1; case "known": w = d.bounds[0], P = d.bounds[1] }p = { min: w, max: P, step: M, xtolerance: v, ytolerance: x, ztolerance: Math.min(v, x) }; break; case s.IMPLICIT: p = { xmin: t, xmax: r, ymin: a, ymax: o, xtolerance: v, ytolerance: x }; break; case s.Z_3D: return { xmin: -10, xmax: 10, ymin: -10, ymax: 10 }; default: return !1 }return p } function M(e, n, i) { var t, r, a, o, m = [], c = null; switch (i) { case s.POLAR: c = x; break; case s.X: c = function (e) { return [e[1], e[0]] } }for (t = 0; t < e.length; t++)for (o = e[t], r = 0; r < o.length; r += 2)a = [o[r], o[r + 1]], c && (a = c(a)), m.push(a[0], a[1]); for (t = n.length - 1; t >= 0; t--)for (r = (o = n[t]).length - 2; r >= 0; r -= 2)a = [o[r], o[r + 1]], c && (a = c(a)), m.push(a[0], a[1]); return m } function b(e) { for (var n = [], i = {}, t = 0; t < e.length; t++) { var r = e[t], a = r[0], o = r[1]; isNaN(a) || isNaN(o) ? i[t] = !0 : n.push(r) } return { points: n, droppedIndices: i } } e.default = { sampleLinear: l, sampleXY: v, findPiPeriod: g, samplePolar: y, sampleParametricRecursive: F, subsampleParametricRecursive: w, validateViewState: function (e) { if (!e) return !1; var n = e.viewport.xmin, i = e.viewport.xmax, t = e.viewport.ymin, r = e.viewport.ymax; return !(!isFinite(n) || !isFinite(i) || i <= n) && (!(!isFinite(t) || !isFinite(r) || r <= t) && (!(!isFinite(e.screen.width) || e.screen.width <= 0) && !(!isFinite(e.screen.height) || e.screen.height <= 0))) }, computeDomain: P, computeGraphData: function (e) { var n, i, t, a = e.viewState, o = e.graphInfo, m = e.compiled, c = e.derivative, d = m.fn, p = P(a, o, d), f = o.graphMode; if (p) { switch (f) { case s.X: case s.Y: var h = c ? c.fn : void 0; n = o.isLinear ? l(o.linearCoefficients, p) : v(d, p, h); break; case s.POLAR: n = y(d, p); break; case s.IMPLICIT: n = r.sampleImplicit(d, p); break; case s.PARAMETRIC: p.step || (p.step = (p.max - p.min) / 1e3), n = p.max === p.min ? u(d, p.min) : o.isLinear ? function (e, n) { var i = l(e[0], n), t = l(e[1], n); return i.segments.length && t.segments.length && 4 === i.segments[0].length && 4 === t.segments[0].length ? { segments: [[i.segments[0][1], t.segments[0][1], i.segments[0][3], t.segments[0][3]]], resolved: !0 } : { segments: [], resolved: !0 } }(o.linearCoefficients, p) : F(d, p); break; case s.PARAMETRIC_CURVE_3D: return p.step || (p.step = (p.max - p.min) / 1e3), n = p.max === p.min ? u(d, p.min) : F(d, p), { graphMode: s.PARAMETRIC_CURVE_3D, segments: n.segments, cacheKey: m.source + ":" + JSON.stringify(p), color: o.color, style: "dummy" }; case s.Z_3D: return { meshData: function (e, n) { for (var i = e.fn, t = n.xmin, r = n.xmax, a = n.ymin, o = 30, s = (r - t) / 30, m = (n.ymax - a) / o, c = [], l = [], u = [], d = s / 1e3, p = m / 1e3, f = 0; f < 30; f++)for (var h = 0; h < o; h++) { var v = t + f * s, g = a + h * m, x = i(v, g); c.push(v, g, x); var y = (i(v + d, g) - x) * p, F = (i(v, g + p) - x) * d, w = -d * p, P = Math.sqrt(y * y + F * F + w * w); l.push(y / P, F / P, w / P) } for (f = 0; f < 29; f++)for (h = 0; h < 29; h++) { var M = h * o + f, b = h * o + f + 1, I = (h + 1) * o + f, k = (h + 1) * o + f + 1; u.push(M, I, b), u.push(I, k, b) } return { cacheKey: e.source + ":" + JSON.stringify(n), positions: new Float32Array(c), normals: new Float32Array(l), faces: new Int16Array(u) } }(m, p), color: o.color, graphMode: s.Z_3D, poi: { zeros: { x: [], y: [] }, extrema: { x: [], y: [] }, intercept: { x: [], y: [] } }, compiled: m, style: "dummy" }; default: throw new Error("Programming Error: unexpected graphmode " + f) }t = n.poi } else n = { segments: [], resolved: !0 }; if ((!t || t.zeros.x.length + t.extrema.x.length + t.intercept.x.length > 250) && (t = { zeros: { x: [], y: [] }, extrema: { x: [], y: [] }, intercept: { x: [], y: [] } }), f === s.X) for (var g in t) if (t.hasOwnProperty(g)) { var x = g; i = t[x].y, t[x].y = t[x].x, t[x].x = i } var w = { segments: n.segments, resolved: n.resolved, graphMode: f, color: o.color, style: o.lineStyle, lineWidth: o.lineWidth, lineOpacity: o.lineOpacity, listIndex: o.listIndex, operator: o.operator, poi: t, compiled: m }; if (f === s.POLAR) { var M = p; w.sampledDomain = { min: M.min, max: M.max, step: M.step } } return n.fillSegments && (w.fillSegments = n.fillSegments), w }, computeDiscreteGraphData: function (e) { var n, i = e.viewState, t = e.graphInfo, r = e.compiled, a = e.maxOverride, o = e.showPoint, m = r.fn, l = P(i, t, m); l || (n = { segments: [], resolved: !0 }); var u = l, d = u.min, p = u.max, f = u.step, h = b((n = function (e) { for (var n = e.fn, i = e.domain, t = i.min, r = i.max, a = Math.floor(t), o = Math.ceil(r), s = [], m = a; m <= o; m++) { var c = n(m); isFinite(m) && isFinite(c) && s.push([m, c]) } return { segments: s, resolved: !0 } }({ fn: m, domain: { min: Math.max(d, 0), max: void 0 !== a ? Math.min(a, p) : p, step: f } })).segments); return { segments: [h.points], droppedIndices: h.droppedIndices, graphMode: s.XYPOINT, color: t.color, style: t.pointStyle, poi: c.default(n.segments), showPoint: o } }, polygonsFromSegments: function (e, n, t) { for (var r = function (e) { var n = e[e.length - 1]; return n[n.length - 2] }, a = [], o = 0, s = 0, m = [], c = [], l = -1 / 0, u = -1 / 0; ;) { if (l <= u) { if (o >= n.length) break; c.push(n[o++]) } if (u <= l) { if (s >= e.length) break; m.push(e[s++]) } if (l = r(c), u = r(m), i.approx(l, u, 4)) { a.push(M(m, c, t)), c = [], m = []; var d = Math.max(l, u); l = d, u = d } } return a }, dropUndefinedPoints: b } });
define('core/types/styles', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LineStyle = e.PointStyle = void 0, function (e) { e.POINT = "POINT", e.OPEN = "OPEN", e.CROSS = "CROSS" }(e.PointStyle || (e.PointStyle = {})), function (e) { e.SOLID = "SOLID", e.DASHED = "DASHED", e.DOTTED = "DOTTED" }(e.LineStyle || (e.LineStyle = {})) });
define('core/math/cdf-branches', ["require", "exports", "tslib", "core/lib/deepCopy", "core/math/plotter", "core/math/domaintypes", "core/types/styles"], function (require, e, o, n, i, t, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.makeContinuousCDFTopBranches = e.makeDiscreteCDFTopBranches = void 0; function d(e) { var o = e.viewState, d = e.graphInfo, r = e.compiled, s = e.bounds, p = e.included, u = e.showPoint, c = n.default(d), h = t.intersectDomains(d.domainBound, t.knownDomain(s)); if ("known" === h.type) return c.domainBound = h, c.pointStyle = p ? a.PointStyle.POINT : a.PointStyle.OPEN, i.default.computeDiscreteGraphData({ graphInfo: c, viewState: o, compiled: r, showPoint: u, maxOverride: void 0 }) } e.makeDiscreteCDFTopBranches = function (e) { var n, i = e.viewState, t = e.graphInfo, a = e.compiled, r = e.bounds, s = e.maxOverride, p = e.showPoint, u = r[0], c = r[1], h = []; u = Math.ceil(u), c = Math.floor(c); var l, v, m, f, w, S = void 0 !== s ? s : 1 / 0; if (u === -1 / 0 && c >= S) n = d({ bounds: [u, S], included: !0, viewState: i, graphInfo: t, compiled: a, showPoint: p }), h.push(n); else if (u === -1 / 0 && c < 1 / 0) n = d({ bounds: [u, c], included: !0, viewState: i, graphInfo: t, compiled: a, showPoint: p }), h.push(n), h.push(d({ bounds: [c + 1, S], included: !1, viewState: i, graphInfo: t, compiled: a, showPoint: p })); else if (u > -1 / 0 && c >= S) n = d({ bounds: [u, S], included: !0, viewState: i, graphInfo: t, compiled: a, showPoint: p }), h.push(d({ bounds: [-1 / 0, u - 1], included: !1, viewState: i, graphInfo: t, compiled: a, showPoint: p })), h.push(n); else { n = d({ bounds: [u, c], included: !0, viewState: i, graphInfo: t, compiled: a, showPoint: p }); var g = d({ bounds: [-1 / 0, u - 1], included: !1, viewState: i, graphInfo: t, compiled: a, showPoint: p }), I = d({ bounds: [c + 1, S], included: !1, viewState: i, graphInfo: t, compiled: a, showPoint: p }); h.push(n); var b = void 0; g && I && (v = I, m = (l = g).segments[0], f = v.segments[0], w = [o.__spreadArray(o.__spreadArray([], m), f)], b = o.__assign(o.__assign({}, l), { segments: w }), h.push(b)) } return { cdfTopBranch: n, topBranches: h } }; e.makeContinuousCDFTopBranches = function (e) { var o = e.viewState, d = e.graphInfo, r = e.compiled, s = e.derivative, p = e.bounds; return { cdfTopBranch: function (e) { var o = e.viewState, d = e.graphInfo, r = e.compiled, s = e.derivative, p = e.bounds, u = n.default(d), c = t.intersectDomains(d.domainBound, t.knownDomain(p)); if ("known" === c.type) return u.domainBound = c, u.lineStyle = a.LineStyle.SOLID, i.default.computeGraphData({ graphInfo: u, viewState: o, compiled: r, derivative: s }) }({ bounds: [p[0], p[1]], viewState: o, graphInfo: d, compiled: r, derivative: s }), topBranches: [i.default.computeGraphData({ viewState: o, graphInfo: d, compiled: r, derivative: s })] } } });
define('core/types/opacity', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.HIGH = e.DEFAULT = e.LOW = void 0, e.LOW = .2, e.DEFAULT = .4, e.HIGH = .8 });
define('core/types/slider-loop-modes', ["require", "exports"], function (require, e) { "use strict"; var o; Object.defineProperty(e, "__esModule", { value: !0 }), e.getSliderIcon = e.SliderLoopMode = void 0, function (e) { e.LOOP_FORWARD_REVERSE = "LOOP_FORWARD_REVERSE", e.LOOP_FORWARD = "LOOP_FORWARD", e.PLAY_ONCE = "PLAY_ONCE", e.PLAY_INDEFINITELY = "PLAY_INDEFINITELY" }(o = e.SliderLoopMode || (e.SliderLoopMode = {})), e.getSliderIcon = function (e) { switch (e) { case o.LOOP_FORWARD: return "dcg-icon-arrow-one-way"; case o.LOOP_FORWARD_REVERSE: return "dcg-icon-arrow-two-way"; case o.PLAY_ONCE: return "dcg-icon-arrow-once"; case o.PLAY_INDEFINITELY: return "dcg-icon-arrow-infinite" } } });
define('core/types/label-sizes', ["require", "exports"], function (require, e) { "use strict"; var i; Object.defineProperty(e, "__esModule", { value: !0 }), e.maybeMigrateLabelSizeEnumToLatex = e.LabelSize = void 0, function (e) { e.SMALL = "small", e.MEDIUM = "medium", e.LARGE = "large" }(i = e.LabelSize || (e.LabelSize = {})), e.maybeMigrateLabelSizeEnumToLatex = function (e) { return e === i.SMALL ? ".85" : e === i.MEDIUM ? "1" : e === i.LARGE ? "1.35" : void 0 } });
define('core/types/label-orientations', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LabelOrientation = void 0, function (e) { e.DEFAULT = "default", e.CENTER = "center", e.CENTER_AUTO = "center_auto", e.AUTO_CENTER = "auto_center", e.ABOVE = "above", e.ABOVE_LEFT = "above_left", e.ABOVE_RIGHT = "above_right", e.ABOVE_AUTO = "above_auto", e.BELOW = "below", e.BELOW_LEFT = "below_left", e.BELOW_RIGHT = "below_right", e.BELOW_AUTO = "below_auto", e.LEFT = "left", e.AUTO_LEFT = "auto_left", e.RIGHT = "right", e.AUTO_RIGHT = "auto_right" }(e.LabelOrientation || (e.LabelOrientation = {})) });
define('core/lib/default-spec', ["require", "exports", "underscore", "core/lib/deepCopy"], function (require, e, r, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.populateDefaults = e.stripDefaultsAndMaybeReturnUndefined = e.stripDefaults = void 0, e.stripDefaults = function (e, t) { var n = {}; for (var a in t) t.hasOwnProperty(a) && (r.isEqual(e[a], t[a]) || (n[a] = t[a])); return n }, e.stripDefaultsAndMaybeReturnUndefined = function (e, t) { var n = void 0, a = {}; for (var u in t) t.hasOwnProperty(u) && (r.isEqual(e[u], t[u]) || (a[u] = t[u], n = a)); return n }, e.populateDefaults = function (e, r) { r || (r = {}); var n = {}; for (var a in e) e.hasOwnProperty(a) && !r.hasOwnProperty(a) && (n[a] = t.default(e[a])); for (var a in r) r.hasOwnProperty(a) && (n[a] = r[a]); return n } });
define('core/lib/copy-properties', ["require", "exports", "core/lib/deepCopy"], function (require, r, e) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.makeTrueMap = r.extractPropertiesLike = r.copyAllProperties = r.copyProperties = void 0, r.copyProperties = function (r) { var o = r.from, t = r.to, i = r.props; for (var n in i) i[n] && o.hasOwnProperty(n) && (t[n] = e.default(o[n])) }, r.copyAllProperties = function (r, e) { for (var o in r) r.hasOwnProperty(o) && (e[o] = r[o]) }, r.extractPropertiesLike = function (r, e) { var o = {}; for (var t in e) e.hasOwnProperty(t) && (o[t] = r[t]); return o }, r.makeTrueMap = function (r) { var e = {}; for (var o in r) r.hasOwnProperty(o) && (e[o] = !0); return e } });
define('core/graphing-calc/json/expression', ["require", "exports", "tslib", "core/types/opacity", "core/types/styles", "core/lib/dragmode", "core/types/slider-loop-modes", "core/types/label-sizes", "core/types/label-orientations", "core/lib/default-spec", "../../lib/copy-properties"], function (require, e, i, a, l, t, s, r, n, o, d) { "use strict"; var L; function D(i) { return d.extractPropertiesLike(i, e.DEFAULTS_DYNAMIC) } Object.defineProperty(e, "__esModule", { value: !0 }), e.computeParsableState = e.areDynamicPropertiesStrictEqual = e.extractDynamicProperties = e.stripDefaults = e.inflateDefaults = e.SLIDER_DEFAULTS = e.DEFAULTS = e.DEFAULTS_DYNAMIC = e.DEFAULT_SLIDER_PERIOD = e.EditableLabelMode = e.CLICKABLEINFO_DEFAULTS = e.VIZ_DEFAULTS = e.CDF_DEFAULTS = void 0, e.CDF_DEFAULTS = { show: !1, min: "", max: "" }, e.VIZ_DEFAULTS = { breadth: "", axisOffset: "", alignedAxis: "x", showBoxplotOutliers: !0, binAlignment: "center", dotplotXMode: "exact", histogramMode: "" }, e.CLICKABLEINFO_DEFAULTS = { enabled: !1, latex: "" }, function (e) { e.None = "NONE", e.Math = "MATH", e.Text = "TEXT" }(L = e.EditableLabelMode || (e.EditableLabelMode = {})), e.DEFAULT_SLIDER_PERIOD = 4e3, e.DEFAULTS_DYNAMIC = { polarDomain: { min: "", max: "" }, parametricDomain: { min: "", max: "" }, cdf: e.CDF_DEFAULTS, colorLatex: "", description: "", fillOpacity: "" + a.DEFAULT, lineOpacity: "", pointOpacity: "", pointSize: "", lineWidth: "", labelAngle: "", vizProps: e.VIZ_DEFAULTS, clickableInfo: e.CLICKABLEINFO_DEFAULTS }, e.DEFAULTS = i.__assign(i.__assign({ folderId: "", latex: "", color: "", showLabel: !1, label: "", hidden: !1, secret: !1, dragMode: t.DragMode.AUTO, labelSize: "", labelOrientation: n.LabelOrientation.DEFAULT, suppressTextOutline: !1, interactiveLabel: !1, editableLabelMode: L.None, residualVariable: "", isLogModeRegression: !1, pointStyle: l.PointStyle.POINT, lineStyle: l.LineStyle.SOLID, regressionParameters: {}, displayEvaluationAsFraction: !1, slider: {} }, e.DEFAULTS_DYNAMIC), { points: void 0, lines: void 0, fill: void 0 }), e.SLIDER_DEFAULTS = { hardMin: !1, hardMax: !1, animationPeriod: e.DEFAULT_SLIDER_PERIOD, loopMode: s.SliderLoopMode.LOOP_FORWARD_REVERSE, playDirection: 1, isPlaying: !1, min: "-10", max: "10", step: "" }, e.inflateDefaults = function (a) { return i.__assign(i.__assign(i.__assign({}, e.DEFAULTS), a), { slider: i.__assign(i.__assign({}, e.SLIDER_DEFAULTS), a.slider), cdf: i.__assign(i.__assign({}, e.CDF_DEFAULTS), a.cdf), vizProps: i.__assign(i.__assign({}, e.VIZ_DEFAULTS), a.vizProps), clickableInfo: i.__assign(i.__assign({}, e.CLICKABLEINFO_DEFAULTS), a.clickableInfo) }) }, e.stripDefaults = function (a) { var l = o.stripDefaults(e.DEFAULTS, i.__assign(i.__assign({}, a), { slider: o.stripDefaults(e.SLIDER_DEFAULTS, a.slider) })), t = o.stripDefaultsAndMaybeReturnUndefined(e.CDF_DEFAULTS, a.cdf); void 0 === t ? delete l.cdf : l.cdf = t; var s = o.stripDefaultsAndMaybeReturnUndefined(e.VIZ_DEFAULTS, a.vizProps); void 0 === s ? delete l.vizProps : l.vizProps = s; var r = o.stripDefaultsAndMaybeReturnUndefined(e.CLICKABLEINFO_DEFAULTS, a.clickableInfo); return void 0 === r ? delete l.clickableInfo : l.clickableInfo = r, l }, e.extractDynamicProperties = D, e.areDynamicPropertiesStrictEqual = function (i, a) { for (var l in e.DEFAULTS_DYNAMIC) if (e.DEFAULTS_DYNAMIC.hasOwnProperty(l) && i[l] !== a[l]) return !1; return !0 }, e.computeParsableState = function (e) { var a = r.maybeMigrateLabelSizeEnumToLatex(e.labelSize), l = a || e.labelSize; return i.__assign({ type: "statement", id: e.id, latex: e.latex, label: e.label, color: e.color, fill: e.fill, points: e.points, lines: e.lines, pointStyle: e.pointStyle, lineStyle: e.lineStyle, dragMode: e.dragMode, labelSize: l, labelOrientation: e.labelOrientation, suppressTextOutline: e.suppressTextOutline, interactiveLabel: e.interactiveLabel, editableLabelMode: e.editableLabelMode, residualVariable: e.residualVariable, regressionParameters: e.regressionParameters, isLogModeRegression: e.isLogModeRegression, showLabel: e.showLabel, shouldGraph: e.hidden, slider: { min: e.slider.hardMin ? e.slider.min : "", max: e.slider.hardMax ? e.slider.max : "", softMin: e.slider.hardMin ? "" : e.slider.min, softMax: e.slider.hardMax ? "" : e.slider.max, step: e.slider.step, isPlayingOnce: e.slider.isPlaying && e.slider.loopMode === s.SliderLoopMode.PLAY_ONCE } }, D(e)) } });
define('core/math/features/getListIdx', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getListIdxFromBranchIdx = void 0, e.getListIdxFromBranchIdx = function (e, r) { var t; switch (r) { case "solvedEquation": t = 2; break; case "baseComparator": t = 4; break; default: t = 1 }return Math.floor(e / t) } });
define('core/types/point-size', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.DOTPLOT_DEFAULT = e.DEFAULT = void 0, e.DEFAULT = 9, e.DOTPLOT_DEFAULT = 14 });
define('core/math/features/graph', ["require", "exports", "parsenodes", "core/math/comparators", "core/math/parsenode/irexpression", "tslib", "core/math/errormsg", "core/math/builtin", "core/math/plotter", "core/types/graphmode", "core/lib/dragmode", "core/math/expression-types", "core/math/cdf-branches", "core/math/copy-defined-pois", "core/math/distribution-spec", "core/graphing-calc/json/expression", "core/types/opacity", "core/lib/color-helpers", "core/types/styles", "core/math/types", "../ir/opcodes", "core/math/ir/features/as-value", "./getListIdx", "core/types/point-size"], function (require, e, t, a, i, o, r, s, n, l, p, u, h, c, d, m, g, f, y, v, D, x, L, b) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var O = t.List; function I(e, t, a) { for (var i = 1 / 0, o = 0, r = t; o < r.length; o++) { var s = e[r[o]]; Array.isArray(s) && s.length < i && (i = s.length) } var n = 1; return "solvedEquation" === a ? n = 2 : "baseComparator" === a && (n = 4), n * i } function M(e, t, a) { return Array.isArray(e) ? e[L.getListIdxFromBranchIdx(t, a)] : e } function P(e, t) { for (var a = 1 / 0, i = -1 / 0, o = 1 / 0, r = -1 / 0, s = 0, n = t; s < n.length; s++)for (var l = n[s], p = 0; p < l.length; p += 2) { var u = l[p], h = l[p + 1]; u < a && (a = u), u > i && (i = u), h < o && (o = h), h > r && (r = h) } if (isFinite(a) && isFinite(o)) return { type: e, xmin: a, ymin: o, xmax: i, ymax: r } } function V(e, t) { if (void 0 !== e && "binomialdist" === e.symbol && t instanceof i) { var a = t._chunk, o = a.getInstruction(a.returnIndex); if (o.type === D.NativeFunction && "binompdf" === o.symbol) return x.asValue(a, o.args[1]) } } function A(e, t, a) { var i = {}; a -= .5 * t; for (var o = e.length - 1; o >= 0; o--) { var r = e[o], s = Math.floor((r - a) / t); i[s] ? i[s].data.push(r) : i[s] = { id: s, data: [r], min: s * t + a, max: s * t + a + t, center: s * t + a + t / 2 } } return i } t.Base.prototype._graph = function (e, a, r, p, g) { var y = this; if (a instanceof t.SolvedEquation) return this._graph(e, a._expression, r, p, 2 === a.branchMultiplier ? "solvedEquation" : void 0); function b(e) { var t = e.editableLabelMode; return t === m.EditableLabelMode.Text || t === m.EditableLabelMode.Math } var P = a.getExpressionType(p.graphMode, a.valueType), A = u.getReconciledExpressionProps(P, { points: this.userData.points, lines: this.userData.lines, fill: this.userData.fill }); switch (p.graphMode) { case l.XYPOINT_MOVABLE: var E = n.default.dropUndefinedPoints([a.asValue()]), F = E.points, S = E.droppedIndices, N = this.userData.shouldGraph && A.points, C = this.userData.showLabel && !N; return N ? [{ segments: [F], graphMode: p.graphMode, droppedIndices: S, color: f.getDisplayColor(this.userData, this.metaData), style: this.userData.pointStyle, showLabel: !!this.userData.showLabel, labelSize: this.metaData.computedLabelSize, labelAngle: this.metaData.computedLabelAngle, labelOrientation: this.userData.labelOrientation, pointOpacity: this.metaData.computedPointOpacity, suppressTextOutline: this.userData.suppressTextOutline, editableLabel: b(this.userData), labels: this.computedLabels || [], poi: c.default(F), movablePointInfo: [] }] : C ? [{ segments: [F], graphMode: l.XYPOINT, color: f.getDisplayColor(this.userData, this.metaData), style: this.userData.pointStyle, showLabel: !!this.userData.showLabel, nakedLabel: !0, labelSize: this.metaData.computedLabelSize, labelAngle: this.metaData.computedLabelAngle, labelOrientation: this.userData.labelOrientation, pointOpacity: this.metaData.computedPointOpacity, suppressTextOutline: this.userData.suppressTextOutline, editableLabel: b(this.userData), labels: this.computedLabels || [], poi: c.default(F), showPoint: !1 }] : []; case l.XYPOINT: var B = [], w = this.userData.shouldGraph && A.points, _ = this.userData.shouldGraph && A.lines, z = ["colorLatexValue"]; w && z.push("computedPointOpacity", "computedPointSize"), (this.userData.showLabel || w) && z.push("computedLabelSize", "computedLabelAngle"); var G = I(this.metaData, z, g), W = O.wrap(a).asValue(); W.length > G && (W.length = G); var Y = this.userData.showLabel && !w && !_, R = n.default.dropUndefinedPoints(W); return (this.userData.showLabel || w) && B.push({ segments: [R.points], graphMode: p.graphMode, droppedIndices: R.droppedIndices, color: this.metaData.colorLatexValue || this.userData.color, style: this.userData.pointStyle, showLabel: !!this.userData.showLabel, showPoint: w, labelSize: this.metaData.computedLabelSize, labelAngle: this.metaData.computedLabelAngle, labelOrientation: this.userData.labelOrientation, pointSize: this.metaData.computedPointSize, pointOpacity: this.metaData.computedPointOpacity, suppressTextOutline: this.userData.suppressTextOutline, interactiveLabel: !!this.userData.interactiveLabel, editableLabel: b(this.userData), nakedLabel: Y, labels: this.computedLabels || [], poi: c.default(W) }), _ && B.push({ segments: T(W), graphMode: l.PARAMETRIC, color: f.getDisplayColor(this.userData, this.metaData), style: this.userData.lineStyle, lineWidth: this.metaData.computedLineWidth, lineOpacity: this.metaData.computedLineOpacity, poi: {} }), B; case l.PARAMETRIC: case l.PARAMETRIC_CURVE_3D: var X = this.userData, q = this.metaData, k = []; z = ["colorLatexValue"]; A.lines && z.push("computedLineOpacity", "computedLineWidth"), A.fill && z.push("computedFillOpacity"); var U = I(this.metaData, z, g); B = O.wrap(a).mapElements(function (t, a) { if (a >= U) return { segments: [], poi: {}, graphMode: l.X, color: "" }; var i = L.getListIdxFromBranchIdx(a, g), o = M(y.metaData.computedLineWidth, a, g), s = M(y.metaData.computedLineOpacity, a, g), u = y.metaData.colorLatexValue ? M(y.metaData.colorLatexValue, a, g) : y.userData.color; if (0 === t.getDependencies().length) { var h = n.default.dropUndefinedPoints([t.asValue()]), d = h.points, m = h.droppedIndices; return { segments: [d], graphMode: l.XYPOINT, droppedIndices: m, color: f.getDisplayColor(X, q), style: X.lineStyle, lineWidth: o, lineOpacity: s, poi: c.default(d) } } var v = t.getCompiledFunction(), D = y.getGraphInfo(e, t); return D.graphMode = p.graphMode, D.domain = { min: y.metaData.evaluatedDomainMin, max: y.metaData.evaluatedDomainMax }, D.style = y.userData.lineStyle, D.lineWidth = o, D.lineOpacity = s, D.color = u, D.listIndex = i, n.default.computeGraphData({ viewState: r, graphInfo: D, compiled: v }) }); if (A.fill) { if (B.forEach(function (e, t) { t >= U || k.push({ segments: e.segments, color: y.metaData.colorLatexValue ? M(y.metaData.colorLatexValue, t, g) : y.userData.color, fillOpacity: M(y.metaData.computedFillOpacity, t, g), listIndex: L.getListIdxFromBranchIdx(t, g), graphMode: l.POLYGONFILL, poi: {} }) }), !A.lines) return k; B = B.concat(k) } return B; case l.X: case l.Y: case l.IMPLICIT: case l.POLAR: case l.Z_3D: var j = [], Z = a.valueType === v.Number, J = I(this.metaData, ["computedLineOpacity", "computedLineWidth", "colorLatexValue", "fillOpacity"], g); return O.wrap(a).eachElement(function (t, a) { if (!(a >= J)) { var u, c = p.graphMode === l.IMPLICIT || p.graphMode === l.Z_3D ? t.getCompiledFunction(["x", "y"]) : t.getCompiledFunction(), m = d.getFunctionSpecFromTree(y), f = m && m.discrete, v = function (e, t) { if (!e) return; if (!(t instanceof i)) return; var a = t._chunk, o = a.getInstruction(a.returnIndex); if (o.type !== D.NativeFunction) return; var r = e.discrete ? "discreteDistribution" : "continuousDistribution"; if ("binomialdist" === e.symbol && "binompdf" === o.symbol) { var n = x.asValue(a, o.args[1]), l = x.asValue(a, o.args[2]); return { type: r, xmin: 0, xmax: n, ymin: 0, ymax: h = s.binompdf(l * n, n, l) } } if ("poissondist" === e.symbol && "poissonpdf" === o.symbol) { return { type: r, xmin: 0, xmax: 2.5 * (p = x.asValue(a, o.args[1])), ymin: 0, ymax: h = Math.max(s.poissonpdf(Math.floor(p), p), s.poissonpdf(Math.ceil(p), p)) } } if ("normaldist" === e.symbol && "normalpdf" === o.symbol) { var p = x.asValue(a, o.args[1]), u = x.asValue(a, o.args[2]), h = s.normalpdf(p, p, u); return { type: r, xmin: p - 2 * Math.abs(u), xmax: p + 2 * Math.abs(u), ymin: 0, ymax: h } } if ("uniformdist" === e.symbol && "uniformpdf" === o.symbol) { var c = x.asValue(a, o.args[1]), d = x.asValue(a, o.args[2]), m = (p = (c + d) / 2, d - c); return { type: r, xmin: c - m / 3, xmax: d + m / 3, ymin: 0, ymax: h = s.uniformpdf(p, c, d) } } if ("tdist" === e.symbol && "tpdf" === o.symbol) { var g = x.asValue(a, o.args[1]); return { type: r, xmin: -3, xmax: 3, ymin: 0, ymax: h = s.tpdf(0, g) } } return }(m, t); try { u = t.getCompiledDerivative() } catch (e) { } var b = y.getGraphInfo(e, t); b.listIndex = L.getListIdxFromBranchIdx(a, g), b.graphMode = p.graphMode, b.style = y.userData.lineStyle, b.lineWidth = M(y.metaData.computedLineWidth, a, g), b.lineOpacity = M(y.metaData.computedLineOpacity, a, g); var O = M(y.metaData.computedFillOpacity, a, g); b.fillOpacity = O, p.graphMode === l.POLAR && (b.domain = { min: y.metaData.evaluatedDomainMin, max: y.metaData.evaluatedDomainMax, isExplicit: y.metaData.isExplicitDomain }); var I = y.metaData.colorLatexValue ? M(y.metaData.colorLatexValue, a, g) : y.userData.color; b.color = I; var P = y.metaData.evaluatedCDFMin, A = y.metaData.evaluatedCDFMax; if (isNaN(P) || isNaN(A) || !Z) if (f) { var E = n.default.computeDiscreteGraphData({ viewState: r, graphInfo: b, compiled: c, showPoint: y.userData.shouldGraph, maxOverride: V(m, t) }); v && (E.boundingBox = v), j.push(E) } else { var F = void 0 === y.userData.lines || y.userData.lines, S = { viewState: r, graphInfo: b, compiled: c, derivative: u }; E = n.default.computeGraphData(S); if (v && (E.boundingBox = v), E.fillSegments) { E.fillSegments; var T = o.__rest(E, ["fillSegments"]); F || (T.lineWidth = 0), j.push(T) } else F || (E.lineWidth = 0), j.push(E); b.graphMode === l.IMPLICIT && "=" !== b.operator && j.push({ graphMode: l.POLYGONFILL, segments: E.fillSegments, poi: {}, listIndex: b.listIndex, color: I, fillOpacity: O }) } else if (f) { var N = { viewState: r, graphInfo: b, compiled: c, bounds: [P, A], maxOverride: V(m, t), showPoint: y.userData.shouldGraph }, C = (w = h.makeDiscreteCDFTopBranches(N)).cdfTopBranch; if ((_ = w.topBranches).forEach(function (e) { e && v && (e.boundingBox = v) }), _.every(function (e) { return void 0 !== e }) && (j = _, C && C.segments[0].length)) { var B = []; C.segments[0].forEach(function (e) { isNaN(e[0]) || isNaN(e[1]) || B.push([e[0], 0, e[0], e[1]]) }), j.push({ graphMode: l.PARAMETRIC, segments: B, boundingBox: v, poi: {}, color: I }) } } else { var w, _; N = { viewState: r, graphInfo: b, compiled: c, derivative: u, bounds: [P, A] }, C = (w = h.makeContinuousCDFTopBranches(N)).cdfTopBranch; if ((_ = w.topBranches).forEach(function (e) { e && v && (e.boundingBox = v) }), j = _, C && C.segments.length) { for (var z = void 0, G = void 0, W = 0; W < C.segments.length; W++) { if ((Y = C.segments[W]).length >= 4) { z = Y[0]; break } } for (W = C.segments.length - 1; W >= 0; W--) { var Y; if ((Y = C.segments[W]).length >= 4) { G = Y[Y.length - 2]; break } } if (void 0 !== z && void 0 !== G && isFinite(z) && isFinite(G)) { var R = n.default.polygonsFromSegments(C.segments, [[z, 0, G, 0]], C.graphMode); j.push({ graphMode: l.POLYGONFILL, segments: R, poi: {}, color: I }) } } } } }), j; case l.POLYGON: B = []; var H = void 0 === this.userData.lines || this.userData.lines, K = void 0 === this.userData.fill || this.userData.fill; if (!K && !H) return B; G = I(this.metaData, ["computedLineOpacity", "computedLineWidth", "colorLatexValue", "fillOpacity"], g); var Q = a.asValue(); v.isList(a.valueType) || (Q = [Q]); for (var $ = 0; $ < Q.length; $++)if (!($ > G - 1)) { var ee = Q[$]; if (ee.length) { var te = this.getGraphInfo(e, a), ae = L.getListIdxFromBranchIdx($, g), ie = M(this.metaData.computedLineWidth, $, g), oe = M(this.metaData.computedLineOpacity, $, g), re = M(this.metaData.computedFillOpacity, $, g), se = this.metaData.colorLatexValue ? M(this.metaData.colorLatexValue, $, g) : this.userData.color, ne = T(ee = o.__spreadArray(o.__spreadArray([], ee), [ee[0]])); ne.length && (K && B.push({ segments: ne, graphMode: l.POLYGONFILL, poi: {}, color: se, fillOpacity: re, style: te.style, listIndex: ae }), H && B.push({ segments: ne, graphMode: l.PARAMETRIC, poi: {}, color: se, style: this.userData.lineStyle, lineWidth: ie, lineOpacity: oe, listIndex: ae })) } } return B; case l.POLYGONFILL: case l.VISUALIZATION: case l.OBJECT3D: case l.NONE: case l.ERROR: return !1; default: var le = p.graphMode; throw new Error("Unexpected graphMode: " + le) } }, t.Base.prototype.tryGraph = function (e, a, i) { try { return this.graph(e, a, i) } catch (e) { var o = e instanceof t.Error ? e.getError() : r.parseError().getError(); return [n.errorBranch(o)] } }, t.Base.prototype.graph = function (e, t, a) { var i = this.getGraphInfo(e, t); return this._graph(e, t, a, i) }, t.BaseComparator.prototype.graph = function (e, i, o) { var r = this.getGraphInfo(e, i), s = r.graphMode, p = "baseComparator", u = void 0 === this.userData.lines || this.userData.lines; if (s === l.IMPLICIT) return this._graph(e, i, o, r); if (s === l.NONE) return !1; if (!(i instanceof t.SolvedEquation)) return !1; var h = this.getOperator(), c = [], d = [], m = !0; i._expression.eachElement(function (e) { c.push(e.getCompiledFunction()); try { d.push(e.getCompiledDerivative()) } catch (e) { m = !1 } }), m || (d = void 0); for (var g = [], f = [-1, 0, 0, 1], y = I(this.metaData, ["computedLineWidth", "computedLineOpacity", "computedFillOpacity", "colorLatexValue"], p), v = Math.min(c.length, y), D = 0; D < v; D++) { var x = this.getGraphInfo(e, i._expression.args[D]); x.graphMode = s, x.listIndex = L.getListIdxFromBranchIdx(D, p), x.style = this.userData.lineStyle, x.color = this.metaData.colorLatexValue ? M(this.metaData.colorLatexValue, D, p) : this.userData.color, r.graphMode === l.POLAR && (x.domain = { min: this.metaData.evaluatedDomainMin, max: this.metaData.evaluatedDomainMax, isExplicit: this.metaData.isExplicitDomain }); var b = n.default.computeGraphData({ viewState: o, graphInfo: x, compiled: c[D], derivative: d ? d[D] : void 0 }); b.lineWidth = M(this.metaData.computedLineWidth, D, p), b.lineOpacity = M(this.metaData.computedLineOpacity, D, p), b.fillOpacity = M(this.metaData.computedFillOpacity, D, p), b.operator = a.get(a.table[h].inclusive, f[D % 4]), u || (b.lineWidth = 0), g.push(b) } for (D = 0; D < v; D += 4) { var O = n.default.polygonsFromSegments(g[D + 1].segments, g[D + 2].segments, s); g.push({ graphMode: l.POLYGONFILL, listIndex: g[D].listIndex, segments: O, poi: {}, fillOpacity: g[D].fillOpacity, color: g[D].color }) } return g }, t.DoubleInequality.prototype.graph = function (e, t, i) { var o = this, r = this.getGraphInfo(e, t); if (r.graphMode === l.NONE) return !1; var s = [], p = a.get(a.table[this._operators[0]].inclusive, 0), u = a.get(a.table[this._operators[1]].inclusive, 0), h = this.userData, c = this.metaData, d = void 0 === h.lines || h.lines, m = ["colorLatexValue", "computedFillOpacity"]; d && m.push("computedLineWidth", "computedLineOpacity"); var g = I(c, m); return O.eachArgs(t._expressions, function (t, a) { if (!(a >= g)) { t[0].userData = t[1].userData = h, t[0].metaData = t[1].metaData = c; var m = o.metaData.colorLatexValue ? M(c.colorLatexValue, a) : h.color, f = M(c.computedLineWidth, a), y = M(c.computedLineOpacity, a), v = M(c.computedFillOpacity, a), D = o._graph(e, t[0], i, r)[0]; D.listIndex = a, D.operator = p, D.color = m, D.lineWidth = f, D.lineOpacity = y, s.push(D); var x = o._graph(e, t[1], i, r)[0]; x.listIndex = a, x.operator = u, x.color = m, x.lineWidth = f, x.lineOpacity = y, s.push(x); var L = n.default.polygonsFromSegments(D.segments, x.segments, D.graphMode); d || (D.lineWidth = 0, x.lineWidth = 0), s.push({ graphMode: l.POLYGONFILL, listIndex: D.listIndex, segments: L, lineOpacity: y, fillOpacity: v, poi: {}, color: m }) } }), s }, t.Regression.prototype.graph = function (e, t, a) { var i = this.getGraphInfo(e, t); return this._graph(e, t.model, a, i) }; var E = function (e) { var t = []; return O.wrap(e).eachElement(function (e) { t.push(e.args.map(function (e) { return e.asValue() })) }), t }; function F(e) { return Array.prototype.concat.apply([], e) } function S(e, t, a) { return !!e && (0 === t && 0 === a ? "none" !== e[2].type || "none" !== e[3].type : 0 !== t && 0 !== a ? "none" !== e[0].type && "none" !== e[1].type : 0 !== t ? "none" !== e[0].type : 0 !== a && "none" !== e[1].type) } function T(e) { for (var t = [], a = [], i = 0, o = e; i < o.length; i++) { var r = o[i], s = r[0], n = r[1]; isNaN(s) || isNaN(n) ? (t.length >= 4 && a.push(t), t = []) : t.push(s, n) } return t.length >= 4 && a.push(t), a } t.Object3D.prototype.graph = function (e, t, a) { var i = this.getGraphInfo(e, t); return [{ segments: [E(t)], color: i.color, objectName: this._symbol, graphMode: l.OBJECT3D }] }, t.Histogram.prototype.graph = function (e, t, a) { var i = this.getGraphInfo(e, t), o = t.args[0].asValue(), r = t.args[1].asValue(), s = A(o, r, this.userData.vizProps && "left" === this.userData.vizProps.binAlignment ? r / 2 : 0), n = 1; this.userData.vizProps && "density" === this.userData.vizProps.histogramMode ? n = 1 / (o.length * r) : this.userData.vizProps && "relative" === this.userData.vizProps.histogramMode && (n = 1 / o.length); var p = [], u = []; for (var h in s) { var c = s[h], d = c.data.length; u.push([c.min, 0 * n, c.min, d * n, c.max, d * n, c.max, 0 * n]); var m = 0; s[c.id + 1] && (m = s[c.id + 1].data.length); var f = [c.min, 0 * n, c.min, d * n, c.max, d * n]; m < d && f.push(c.max, m * n), p.push(f) } var y = P("histogram", u); return y && r && (y.binWidth = r), [{ segments: u, graphMode: l.POLYGONFILL, boundingBox: y, poi: {}, color: i.color, fillOpacity: g.DEFAULT }, { segments: p, graphMode: l.Y, poi: { zeros: { x: [], y: [] }, extrema: { x: [], y: [] }, intercept: { x: [], y: [] } }, color: i.color }] }, t.DotPlot.prototype.graph = function (e, t, a) { var i, o = this.getGraphInfo(e, t), r = t.args[1].asValue(), s = this.userData.vizProps && "left" === this.userData.vizProps.binAlignment ? r / 2 : 0, n = A(t.args[0].asValue(), r, s), p = !1, u = []; for (var h in n) for (var d = (g = n[h]).data.length - 1; d >= 0; d--)g.center !== g.data[d] && (p = !0); if (this.userData.vizProps && "exact" === this.userData.vizProps.dotplotXMode) for (var h in n) { (i = (g = n[h]).data).reverse(); for (var m = 0; m < i.length; m++)u.push([i[m], m + 1]) } else for (var h in n) { var g; i = (g = n[h]).data; for (m = 0; m < i.length; m++)u.push([g.center, m + 1]) } var f = P("dotplot", u); f && r && (f.ymin = 0, f.xmin -= .5 * r, f.xmax += .5 * r, f.binWidth = r); var y = this.metaData, v = y.computedPointOpacity, D = y.computedPointSize, x = M(v, 0), L = this.userData.pointSize ? M(D, 0) : b.DOTPLOT_DEFAULT; return [{ segments: [u], graphMode: l.XYPOINT, boundingBox: f, poi: c.default(u), color: o.color, style: this.userData.pointStyle, pointSize: L, pointOpacity: x, showPoint: !0, needsDotplotXMode: p }] }, t.BoxPlot.prototype.graph = function (e, t, a) { var i = this.getGraphInfo(e, t), o = this.metaData.evaluatedAxisOffset, r = this.metaData.evaluatedBreadth, n = t.args[0].asValue(); if (isNaN(r) || isNaN(o)) return !1; var p = Math.min.apply(null, n), u = Math.max.apply(null, n), h = s.quartile(n, 1), d = s.quartile(n, 2), m = s.quartile(n, 3), g = o, f = g - r / 2, v = g + r / 2, D = r / 10, x = []; if (this.userData.vizProps.showBoxplotOutliers) { var L = m - h, b = h - 1.5 * L, O = m + 1.5 * L; p = 1 / 0, u = -1 / 0, n.forEach(function (e) { b <= e && e < p && (p = e), u < e && e <= O && (u = e), (e < b || e > O) && x.push([e, g]) }) } var I = [[h, f, m, f, m, v, h, v, h, f], [d, f, d, v], [h, g, p, g], [m, g, u, g], [p, g - D, p, g + D], [u, g - D, u, g + D]]; if (this.userData.vizProps && "y" === this.userData.vizProps.alignedAxis) { for (var M = 0, V = I; M < V.length; M++)for (var A = V[M], E = 0; E < A.length; E += 2) { var F = A[E]; A[E] = A[E + 1], A[E + 1] = F } for (var S = 0, T = x; S < T.length; S++) { var N = T[S]; F = N[0]; N[0] = N[1], N[1] = F } } var C = [{ segments: I, graphMode: l.PARAMETRIC, boundingBox: P("boxplot", I.concat(x)), poi: {}, color: i.color }]; return x.length && C.push({ segments: [x], graphMode: l.XYPOINT, color: i.color, style: y.PointStyle.OPEN, showPoint: !0, poi: c.default(x) }), C }, t.Table.prototype.isValueDraggable = function (e, t, a) { if (!e.columns[t].isIndependent) return !1; var i = this.columns[t].values, o = i && i[a]; return !(!o || !isFinite(o.asValue()) || 0 !== o.getDependencies().length) }, t.Table.prototype.graph = function (e, t, a) { var i = {}; if (t.columns[0].isError) return i; for (var o = t.columns[0], r = o.values, s = 1; s < this.columns.length; s++) { var n = t.columns[s]; if (!n.isError) { var u = this.columns[s].header.userData, h = this.columns[s].header.metaData; if (!u.hidden) { for (var d = I(h, ["colorLatexValue", "computedPointSize", "computedPointOpacity"]), m = u.dragMode, g = m === p.DragMode.X || m === p.DragMode.XY, y = m === p.DragMode.Y || m === p.DragMode.XY, v = !!u.points, D = !!u.lines, x = n.isDiscrete(o), L = D && x, b = D && !x, O = [], M = [], P = [], V = [], A = [], E = [], S = 1 / 0, T = -1 / 0, N = 1 / 0, C = -1 / 0, B = {}, w = 0; w < r.length; w++) { var _ = r[w], z = n.values[w]; if (_ && z && isFinite(_.asValue()) && isFinite(z.asValue())) { var G = _.asValue(), W = z.asValue(); if (v) { if (w >= d) continue; var Y = g && this.isValueDraggable(t, 0, w), R = y && this.isValueDraggable(t, s, w); Y || R ? (P.push([G, W]), V.push({ index: w, dragX: Y, dragY: R })) : M.push([G, W]) } L && E.push([G, W]), G < S && (S = G), G > T && (T = G), W < N && (N = W), W > C && (C = W) } else B[w] = !0, L && (E.length > 1 && A.push(E), E = []) } var X = { type: "table", xmin: S, xmax: T, ymin: N, ymax: C }; if (P.length && O.push({ graphMode: l.XYPOINT_MOVABLE, segments: [P], color: h.colorLatexValue || u.color, tableId: u.tableId, poi: c.default(P), movablePointInfo: V, boundingBox: X, pointOpacity: h.computedPointOpacity }), M.length && O.push({ segments: [M], droppedIndices: B, graphMode: l.XYPOINT, showPoint: !0, poi: c.default(M), color: h.colorLatexValue || u.color, pointSize: h.computedPointSize, pointOpacity: h.computedPointOpacity, style: u.pointStyle, tableId: u.tableId, boundingBox: X }), (A.length || E.length) && (A.push(E), O.push({ segments: A.map(F), graphMode: l.PARAMETRIC, poi: {}, color: f.getDisplayColor(u, h), style: u.lineStyle, lineWidth: Array.isArray(h.computedLineWidth) ? h.computedLineWidth[0] : h.computedLineWidth, lineOpacity: Array.isArray(h.computedLineOpacity) ? h.computedLineOpacity[0] : h.computedLineOpacity, tableId: u.tableId, boundingBox: X })), b) { var q = this.columns[s].header.graph(e, t.columns[s].continuousConcreteTree, a); q.length && Array.prototype.push.apply(O, q) } O.length && (i[u.id] = O) } } } return i }, t.Image.prototype.graph = function (e, t, a) { var i = []; if (!(t.center.valueType === v.Point && 0 === t.center.getDependencies().length && t.radianAngle.isConstant && t.width.isConstant && t.height.isConstant && t.opacity.isConstant)) return i; for (var o = [], r = [], s = t.width.asValue() / 2, n = t.height.asValue() / 2, p = t.radianAngle.asValue(), u = -1; u <= 1; u++)for (var h = -1; h <= 1; h++) { var d = t.center.asValue(), m = d[0], g = d[1], y = [m + u * s * Math.cos(p) + h * n * Math.sin(p), g - u * s * Math.sin(p) + h * n * Math.cos(p)]; S(t.moveStrategy, u, h) && (o.push(y), r.push([u, h])) } return i.push({ segments: [o], scaleFactors: [r], graphMode: l.XYPOINT_MOVABLE, color: f.getDisplayColor(this.userData, this.metaData), style: this.userData.style, poi: c.default(o), movablePointInfo: [], pointOpacity: 1 }), i } });
define('core/math/features/elementAt', ['require', 'parsenodes'], function (require) { "use strict"; var t = require("parsenodes"); t.List.prototype.elementAt = function (e) { return (e = Math.floor(e)) >= 0 && e < this.args.length ? this.args[e] : t.Constant(NaN) }, t.List.prototype.eachElement = function (t) { for (var e = 0; e < this.length; e++)t(this.elementAt(e), e) }, t.List.prototype.mapElements = function (t) { for (var e = [], n = 0; n < this.length; n++)e.push(t(this.elementAt(n), n)); return e }, t.ParenSeq.prototype.elementAt = function (e) { return e < 0 || e > this.args.length - 1 ? t.Constant(NaN) : this.args[e] } });
define('core/math/features/printLatex', ['require', 'parsenodes', 'core/lib/label', 'core/lib/number-to-latex'], function (require) { "use strict"; var t = require("parsenodes"), r = require("core/lib/label"), i = require("core/lib/number-to-latex").default; function e(t) { switch (t) { case ">": return ">"; case "<": return "<"; case ">=": return "\\ge "; case "<=": return "\\le "; case "=": return "=" } } function n(t) { return t.printLatex() } function a(t) { return t.isConstant && !0 === t.asValue() } t.Identifier.prototype.printLatex = function () { return r.identifierToLatex(this._symbol) + " " }, t.Constant.prototype.printLatex = function () { return i(this.asValue()) }, t.Ticker.prototype.printLatex = function () { return "\\ticker\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.Negative.prototype.printLatex = function () { return "-\\left(" + this.args[0].printLatex() + "\\right)" }, t.Add.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)+\\left(" + this.args[1].printLatex() + "\\right)" }, t.PercentOf.prototype.printLatex = function () { return this.args[0].printLatex() + " \\% \\operatorname{of} " + this.args[1].printLatex() }, t.Subtract.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)-\\left(" + this.args[1].printLatex() + "\\right)" }, t.Multiply.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)*\\left(" + this.args[1].printLatex() + "\\right)" }, t.Divide.prototype.printLatex = function () { return "\\frac{" + this.args[0].printLatex() + "}{" + this.args[1].printLatex() + "}" }, t.Exponent.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)^{" + this.args[1].printLatex() + "}" }, t.Assignment.prototype.printLatex = function () { return r.identifierToLatex(this._symbol) + "=" + this._expression.printLatex() }, t.Equation.prototype.printLatex = function () { return this._lhs.printLatex() + "=" + this._rhs.printLatex() }, t.BaseComparator.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)" + e(this.operator) + "\\left(" + this.args[1].printLatex() + "\\right)" }, t.DoubleInequality.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)" + e(this.args[1]) + this.args[2].printLatex() + e(this.args[3]) + "\\left(" + this.args[4].printLatex() + "\\right)" }, t.And.prototype.printLatex = function () { if (!(this.args[0] instanceof t.BaseComparator && this.args[1] instanceof t.BaseComparator)) throw new Error("Not implemented"); if (this.args[0].args[1].printLatex() !== this.args[1].args[0].printLatex()) throw new Error("Not implemented"); return "\\left(" + this.args[0].args[0].printLatex() + "\\right)" + e(this.args[0].operator) + "\\left(" + this.args[0].args[1].printLatex() + "\\right)" + e(this.args[1].operator) + "\\left(" + this.args[1].args[1].printLatex() + "\\right)" }, t.FunctionCall.prototype.printLatex = function () { switch (this._symbol) { case "sqrt": return "\\sqrt{" + this.args[0].printLatex() + "}"; case "nthroot": return "\\sqrt[" + this.args[1].printLatex() + "]{" + this.args[0].printLatex() + "}"; case "logbase": return "\\log_{" + this.args[1].printLatex() + "}\\left(" + this.args[0].printLatex() + "\\right)"; default: return r.identifierToLatex(this._symbol) + "\\left(" + this.args.map(n).join(", ") + "\\right)" } }, t.SeededFunctionCall.prototype.printLatex = function () { return r.identifierToLatex(this._symbol) + "\\left(" + this.args.slice(1).map(n).join(", ") + "\\right)" }, t.DotAccess.prototype.printLatex = function () { return "(" + this.args[0].printLatex() + ").(" + this.args[1].printLatex() + ")" }, t.Prime.prototype.printLatex = function () { switch (this.args[0]._symbol) { case "logbase": return "\\log_{" + this.args[0].args[1].printLatex() + "}" + Array(this.order + 1).join("'") + "\\left(" + this.args[0].args[0].printLatex() + "\\right)"; default: return r.identifierToLatex(this.args[0]._symbol) + Array(this.order + 1).join("'") + "\\left(" + this.args[0].args.map(n).join(", ") + "\\right)" } }, t.List.prototype.printLatex = function () { return "\\left[" + this.args.map(n).join(", ") + "\\right]" }, t.Range.prototype.printLatex = function () { return "\\left[" + this.args[0].args.map(n).join(", ") + " ... " + this.args[1].args.map(n).join(", ") + "\\right]" }, t.UpdateRule.prototype.printLatex = function () { return this.args[0].printLatex() + "\\to(" + this.args[1].printLatex() + ")" }, t.ListAccess.prototype.printLatex = function () { return "\\left(" + this.args[0].printLatex() + "\\right)\\left[" + this.args[1].printLatex() + "\\right]" }, t.ParenSeq.prototype.printLatex = function () { return "\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.BareSeq.prototype.printLatex = function () { return this.args.map(n).join(", ") }, t.Sum.prototype.printLatex = function () { return "\\sum_{" + this.args[0].printLatex() + "=" + this.args[1].printLatex() + "}^{" + this.args[2].printLatex() + "}\\left(" + this.args[3].printLatex() + "\\right)" }, t.Product.prototype.printLatex = function () { return "\\prod_{" + this.args[0].printLatex() + "=" + this.args[1].printLatex() + "}^{" + this.args[2].printLatex() + "}\\left(" + this.args[3].printLatex() + "\\right)" }, t.Integral.prototype.printLatex = function () { return "\\int_{" + this.args[1].printLatex() + "}^{" + this.args[2].printLatex() + "}\\left(" + this.args[3].printLatex() + "\\right)d" + this.args[0].printLatex() }, t.FunctionExponent.prototype.printLatex = function () { return this.args[0].printLatex() + "\\left(" + this.args[1].printLatex() + "\\right)^{" + this.args[2].printLatex() + "}" }, t.FunctionFactorial.prototype.printLatex = function () { return this.args[0].printLatex() + "\\left(" + this.args[1].printLatex() + "\\right)!" }, t.Piecewise.prototype.printLatex = function () { var r = this; if (a(r.args[0])) return r.args[1].printLatex(); for (var i, e = ["\\left\\{"]; ;) { if (a(r.args[0])) { e.push(r.args[1].printLatex()); break } if (e.push(r.args[0].printLatex(), ": "), (i = r.args[2]).isConstant && i.isNaN()) { e.push(r.args[1].printLatex()); break } if (e.push(r.args[1].printLatex(), ", "), !(r.args[2] instanceof t.Piecewise)) { e.push(r.args[2].printLatex()); break } r = r.args[2] } return e.push("\\right\\}"), e.join("") }, t.FunctionDefinition.prototype.printLatex = function () { return r.identifierToLatex(this._symbol) + "\\left(" + this._argSymbols.map(r.identifierToLatex).join(", ") + "\\right) = " + this._expression.printLatex() }, t.Derivative.prototype.printLatex = function () { return "\\frac{d}{d" + r.identifierToLatex(this._symbol) + "}\\left(" + this.args[0].printLatex() + "\\right)" }, t.Regression.prototype.printLatex = function () { return "\\left(" + this._lhs.printLatex() + "\\right)\\sim\\left(" + this._rhs.printLatex() + "\\right)" }, t.Histogram.prototype.printLatex = function () { return "\\histogram\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.Object3D.prototype.printLatex = function () { return "\\" + this._symbol + "\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.DotPlot.prototype.printLatex = function () { return "\\dotplot\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.BoxPlot.prototype.printLatex = function () { return "\\boxplot\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.TTest.prototype.printLatex = function () { return "\\TTest\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.IndependentTTest.prototype.printLatex = function () { return "\\IndependentTTest\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.Stats.prototype.printLatex = function () { return "\\Stats\\left(" + this.args.map(n).join(", ") + "\\right)" }, t.AssignmentExpression.prototype.printLatex = function () { return r.identifierToLatex(this._symbol) + "=" + this.args[1].printLatex() }, t.ListComprehension.prototype.printLatex = function () { return "\\left[" + this._body.printLatex() + "\\operatorname{for}" + this._inputLists.map(n).join(", ") + "\\right]" } });
define('core/math/features/getExpressionType', ['require', 'parsenodes', 'core/types/graphmode', 'core/math/expression-types', 'core/math/types'], function (require) { "use strict"; var e = require("parsenodes"), t = require("core/types/graphmode"), o = require("core/math/expression-types").ExpressionType, r = require("core/math/types"); e.Base.prototype.getExpressionType = function (e, p) { return e === t.X || e === t.Y ? o.X_OR_Y : e === t.XYPOINT || e === t.XYPOINT_MOVABLE ? p === r.Point ? o.SINGLE_POINT : o.POINT_LIST : e === t.PARAMETRIC || e === t.PARAMETRIC_CURVE_3D ? o.PARAMETRIC : e === t.POLAR ? o.POLAR : e === t.IMPLICIT ? o.IMPLICIT : r.isTypeOrListOfType(p, r.Polygon) ? o.POLYGON : o.X_OR_Y }, e.Histogram.prototype.getExpressionType = function (e, t) { return o.HISTOGRAM }, e.Object3D.prototype.getExpressionType = function (e, t) { return o.CUBE }, e.DotPlot.prototype.getExpressionType = function (e, t) { return o.DOTPLOT }, e.BoxPlot.prototype.getExpressionType = function (e, t) { return o.BOXPLOT } });
define('core/math/parser', ["require", "exports", "tslib", "core/math/baseparser", "core/math/features/getConcreteTree", "core/math/features/buildIRExpression", "core/math/features/typeCheck", "core/math/features/repr", "core/math/features/substitute", "core/math/features/simpleFunctionExpression", "core/math/features/analyze", "core/math/features/analyzeFourFunction", "core/math/features/analyzeScientific", "core/math/features/analyzeSingleExpressionScientific", "core/math/features/getgraphmode", "core/math/features/getgraphinfo", "core/math/features/getMoveStrategy", "core/math/features/getDefaultDragMode", "core/math/features/tableinfo", "core/math/features/tableerror", "core/math/features/graph", "core/math/features/elementAt", "core/math/features/printLatex", "core/math/features/getExpressionType"], function (require, e, t, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), t.__exportStar(r, e) });
define('lib/named-colors', ['require'], function (require) { "use strict"; return { aliceblue: [240, 248, 255], antiquewhite: [250, 235, 215], aqua: [0, 255, 255], aquamarine: [127, 255, 212], azure: [240, 255, 255], beige: [245, 245, 220], bisque: [255, 228, 196], black: [0, 0, 0], blanchedalmond: [255, 235, 205], blue: [0, 0, 255], blueviolet: [138, 43, 226], brown: [165, 42, 42], burlywood: [222, 184, 135], cadetblue: [95, 158, 160], chartreuse: [127, 255, 0], chocolate: [210, 105, 30], coral: [255, 127, 80], cornflowerblue: [100, 149, 237], cornsilk: [255, 248, 220], crimson: [220, 20, 60], cyan: [0, 255, 255], darkblue: [0, 0, 139], darkcyan: [0, 139, 139], darkgoldenrod: [184, 134, 11], darkgray: [169, 169, 169], darkgreen: [0, 100, 0], darkgrey: [169, 169, 169], darkkhaki: [189, 183, 107], darkmagenta: [139, 0, 139], darkolivegreen: [85, 107, 47], darkorange: [255, 140, 0], darkorchid: [153, 50, 204], darkred: [139, 0, 0], darksalmon: [233, 150, 122], darkseagreen: [143, 188, 143], darkslateblue: [72, 61, 139], darkslategray: [47, 79, 79], darkslategrey: [47, 79, 79], darkturquoise: [0, 206, 209], darkviolet: [148, 0, 211], deeppink: [255, 20, 147], deepskyblue: [0, 191, 255], dimgray: [105, 105, 105], dimgrey: [105, 105, 105], dodgerblue: [30, 144, 255], firebrick: [178, 34, 34], floralwhite: [255, 250, 240], forestgreen: [34, 139, 34], fuchsia: [255, 0, 255], gainsboro: [220, 220, 220], ghostwhite: [248, 248, 255], gold: [255, 215, 0], goldenrod: [218, 165, 32], gray: [128, 128, 128], green: [0, 128, 0], greenyellow: [173, 255, 47], grey: [128, 128, 128], honeydew: [240, 255, 240], hotpink: [255, 105, 180], indianred: [205, 92, 92], indigo: [75, 0, 130], ivory: [255, 255, 240], khaki: [240, 230, 140], lavender: [230, 230, 250], lavenderblush: [255, 240, 245], lawngreen: [124, 252, 0], lemonchiffon: [255, 250, 205], lightblue: [173, 216, 230], lightcoral: [240, 128, 128], lightcyan: [224, 255, 255], lightgoldenrodyellow: [250, 250, 210], lightgray: [211, 211, 211], lightgreen: [144, 238, 144], lightgrey: [211, 211, 211], lightpink: [255, 182, 193], lightsalmon: [255, 160, 122], lightseagreen: [32, 178, 170], lightskyblue: [135, 206, 250], lightslategray: [119, 136, 153], lightslategrey: [119, 136, 153], lightsteelblue: [176, 196, 222], lightyellow: [255, 255, 224], lime: [0, 255, 0], limegreen: [50, 205, 50], linen: [250, 240, 230], magenta: [255, 0, 255], maroon: [128, 0, 0], mediumaquamarine: [102, 205, 170], mediumblue: [0, 0, 205], mediumorchid: [186, 85, 211], mediumpurple: [147, 112, 219], mediumseagreen: [60, 179, 113], mediumslateblue: [123, 104, 238], mediumspringgreen: [0, 250, 154], mediumturquoise: [72, 209, 204], mediumvioletred: [199, 21, 133], midnightblue: [25, 25, 112], mintcream: [245, 255, 250], mistyrose: [255, 228, 225], moccasin: [255, 228, 181], navajowhite: [255, 222, 173], navy: [0, 0, 128], oldlace: [253, 245, 230], olive: [128, 128, 0], olivedrab: [107, 142, 35], orange: [255, 165, 0], orangered: [255, 69, 0], orchid: [218, 112, 214], palegoldenrod: [238, 232, 170], palegreen: [152, 251, 152], paleturquoise: [175, 238, 238], palevioletred: [219, 112, 147], papayawhip: [255, 239, 213], peachpuff: [255, 218, 185], peru: [205, 133, 63], pink: [255, 192, 203], plum: [221, 160, 221], powderblue: [176, 224, 230], purple: [128, 0, 128], rebeccapurple: [102, 51, 153], red: [255, 0, 0], rosybrown: [188, 143, 143], royalblue: [65, 105, 225], saddlebrown: [139, 69, 19], salmon: [250, 128, 114], sandybrown: [244, 164, 96], seagreen: [46, 139, 87], seashell: [255, 245, 238], sienna: [160, 82, 45], silver: [192, 192, 192], skyblue: [135, 206, 235], slateblue: [106, 90, 205], slategray: [112, 128, 144], slategrey: [112, 128, 144], snow: [255, 250, 250], springgreen: [0, 255, 127], steelblue: [70, 130, 180], tan: [210, 180, 140], teal: [0, 128, 128], thistle: [216, 191, 216], tomato: [255, 99, 71], turquoise: [64, 224, 208], violet: [238, 130, 238], wheat: [245, 222, 179], white: [255, 255, 255], whitesmoke: [245, 245, 245], yellow: [255, 255, 0], yellowgreen: [154, 205, 50] } });
define('lib/color-distance', ['require', 'underscore', 'lib/named-colors'], function (require) { "use strict"; var r = require("underscore"), t = require("lib/named-colors"); function n(n) { var a, i = [], u = n.toLowerCase(); if ("rgb" === u.slice(0, 3)) try { i = u.replace(/[^\d,]/g, "").split(",").slice(0, 3), i = r.map(i, function (r) { return parseInt(r, 10) }) } catch (r) { e(n) } else if ("#" === u[0]) { u = u.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/, function (r, t, n, e) { return t + t + n + n + e + e }); try { i = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/.exec(u).slice(1), i = r.map(i, function (r) { return parseInt(r, 16) }) } catch (r) { e(n) } } else i = t[u]; return a = i, r.isArray(a) && 3 === a.length && r.every(a, function (r) { return Number.isInteger(r) && r >= 0 && r <= 255 }) || e(n), { R: i[0], G: i[1], B: i[2] } } function e(r) { throw new Error("Invalid color string: " + r) } function a(t) { var n = t.R, e = t.G, a = t.B, i = []; return i[0] = .49 * n + .31 * e + .2 * a, i[1] = .17697 * n + .8124 * e + .01063 * a, i[2] = .01 * e + .99 * a, { X: (i = r.map(i, function (r) { return r / .17697 }))[0], Y: i[1], Z: i[2] } } function i(r) { var t = r.X, n = r.Y, e = r.Z, a = []; return a[0] = 116 * u(n / 100) - 16, a[1] = 500 * (u(t / 95.047) - u(n / 100)), a[2] = 200 * (u(n / 100) - u(e / 108.883)), { L: a[0], a: a[1], b: a[2] } } function u(r) { var t = 6 / 29; return r > Math.pow(t, 3) ? Math.pow(r, 1 / 3) : r / (3 * t * t) + 4 / 29 } function c(r, t) { return function (r, t) { var n = r.L, e = r.a, a = r.b, i = t.L, u = t.a, c = t.b, f = n - i, o = Math.sqrt(e * e + a * a), s = o - Math.sqrt(u * u + c * c), l = e - u, d = a - c, h = f / 1, p = s / (1 * (1 + .045 * o)), v = Math.sqrt(l * l + d * d - s * s) / (1 * (1 + .015 * o)); return Math.sqrt(h * h + p * p + v * v) }(i(a(n(r))), i(a(n(t)))) } return { str2rgb: n, difference: c, closestColor: function (t, n) { var e = r.map(n, function (r) { return c(t, r) }), a = r.min(e); return n[e.indexOf(a)] }, isLightColor: function (r) { if ("string" != typeof r || !r) return !1; try { return c(r, "#fff") < 20 } catch (r) { return !1 } } } });
define('expressions/colors', ["require", "exports", "lib/color-distance", "core/lib/color-helpers"], function (require, r, o, l) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.colorValueToBackgroundValue = r.colorValueHasSomeLightColor = r.colorValueHasOnlyLightColor = r.getColorName = r.all = r.BLACK = r.ORANGE = r.PURPLE = r.GREEN = r.BLUE = r.RED = void 0; r.RED = l.colors.RED, r.BLUE = l.colors.BLUE, r.GREEN = l.colors.GREEN, r.PURPLE = l.colors.PURPLE, r.ORANGE = l.colors.ORANGE, r.BLACK = l.colors.BLACK, r.all = [r.RED, r.BLUE, r.GREEN, r.PURPLE, r.ORANGE, r.BLACK], r.getColorName = function (r, o) { switch (o) { case l.colors.RED: return r.s("graphing-calculator-text-color-red"); case l.colors.BLUE: return r.s("graphing-calculator-text-color-blue"); case l.colors.GREEN: return r.s("graphing-calculator-text-color-green"); case l.colors.PURPLE: return r.s("graphing-calculator-text-color-purple"); case l.colors.ORANGE: return r.s("graphing-calculator-text-color-orange"); case l.colors.BLACK: return r.s("graphing-calculator-text-color-black"); case l.colors.GRAY: return r.s("graphing-calculator-text-color-gray"); default: return r.s("graphing-calculator-text-color-unknown") } }; var e = function (r) { if (!Array.isArray(r)) return [r]; for (var o = Array(Math.min(r.length, 10)), l = 0; l < o.length; l++)o[l] = r[Math.round(l * r.length / o.length)]; return o }; r.colorValueHasOnlyLightColor = function (r) { return e(r).every(o.isLightColor) }; r.colorValueHasSomeLightColor = function (r) { return e(r).some(o.isLightColor) }; r.colorValueToBackgroundValue = function (r) { var o = e(r); if (0 === o.length) return l.colors.BLACK; if (1 === o.length) return o[0]; var t = 30 / o.length; return "linear-gradient(to right" + o.reduce(function (r, o, l) { return r + ", " + o + " " + l * t + "px, " + o + " " + (l + 1) * t + "px" }, "") + ")" } });
define('graphing-calc/api/sanitize-expression', ["require", "exports", "core/types/styles", "core/lib/dragmode", "core/types/label-sizes", "core/types/label-orientations", "core/lib/number-to-latex", "lib/console"], function (require, e, i, n, t, a, r, o) { "use strict"; function l(e, i) { for (var n in i) if (i.hasOwnProperty(n) && i[n] === e) return !0; return !1 } function d(i) { return l(i, e.SanitizedPointStyle) } function s(i) { return l(i, e.SanitizedLineStyle) } function p(i) { return l(i, e.SanitizedDragMode) } function y(e) { return { id: e.id, latex: e.latex, color: e.color, hidden: e.hidden, pointStyle: e.pointStyle, pointSize: e.pointSize, pointOpacity: e.pointOpacity, lineStyle: e.lineStyle, lineWidth: e.lineWidth, lineOpacity: e.lineOpacity, points: e.points, lines: e.lines, dragMode: e.dragMode, values: e.values.slice() } } function O(e, i) { return e.hasOwnProperty("id") ? e.id + "" : i.generateId() } function c(i, n) { var t = { type: "expression", id: O(i, n) }; if (t.type = "expression", t.id = O(i, n), i.hasOwnProperty("latex") && (t.latex = i.latex + ""), i.hasOwnProperty("color") && (t.color = i.color + ""), i.hasOwnProperty("points") && (t.points = !!i.points), i.hasOwnProperty("lines") && (t.lines = !!i.lines), i.hasOwnProperty("style") && (o.warn("As of API v1.1 the 'style' property is deprecated and has been split into 'pointStyle' and 'lineStyle'."), d(i.style) ? t.pointStyle = i.style : s(i.style) ? t.lineStyle = i.style : o.warn("Invalid style: '" + i.style + "'.")), i.hasOwnProperty("pointStyle") && (d(i.pointStyle) ? t.pointStyle = i.pointStyle : o.warn("Invalid pointStyle: '" + i.pointStyle + "'.")), i.hasOwnProperty("pointSize") && (t.pointSize = "" + i.pointSize), i.hasOwnProperty("pointOpacity") && (t.pointOpacity = "" + i.pointOpacity), i.hasOwnProperty("lineStyle") && (s(i.lineStyle) ? t.lineStyle = i.lineStyle : o.warn("Invalid lineStyle: '" + i.lineStyle + "'.")), i.hasOwnProperty("lineWidth") && (t.lineWidth = "" + i.lineWidth), i.hasOwnProperty("lineOpacity") && (t.lineOpacity = "" + i.lineOpacity), i.hasOwnProperty("hidden") && (t.hidden = !!i.hidden), i.hasOwnProperty("secret") && (t.secret = !!i.secret), i.hasOwnProperty("sliderBounds") && i.sliderBounds && (t.slider = { min: r.default(i.sliderBounds.min), max: r.default(i.sliderBounds.max), step: r.default(i.sliderBounds.step) }, t.slider.min && (t.slider.hardMin = !0), t.slider.max && (t.slider.hardMax = !0)), i.hasOwnProperty("playing")) { var a = i.playing; "boolean" != typeof a ? o.warn("Invalid value for 'playing'. Expected a boolean but got '" + a + "'.") : (t.slider || (t.slider = {}), t.slider.isPlaying = a) } return i.hasOwnProperty("parametricDomain") && i.parametricDomain ? (t.parametricDomain = { min: r.default(i.parametricDomain.min), max: r.default(i.parametricDomain.max) }, i.hasOwnProperty("domain") && o.warn("Both 'parametricDomain' and the deprecated 'domain' property were specified. Using 'parametricDomain'.")) : i.hasOwnProperty("domain") && (o.warn("The 'domain' property is deprecated.Use 'parametricDomain' to specify the domain for parametric functions"), t.parametricDomain = { min: r.default(i.domain.min), max: r.default(i.domain.max) }), i.hasOwnProperty("polarDomain") && i.polarDomain && (t.polarDomain = { min: r.default(i.polarDomain.min), max: r.default(i.polarDomain.max) }), i.hasOwnProperty("dragMode") && (p(i.dragMode) ? t.dragMode = i.dragMode : o.warn("Invalid dragMode: '" + i.dragMode + "'.")), i.hasOwnProperty("label") && (t.label = i.label + ""), i.hasOwnProperty("showLabel") && (t.showLabel = !!i.showLabel), i.hasOwnProperty("labelSize") && ("string" == typeof i.labelSize ? t.labelSize = i.labelSize : o.warn("Invalid labelSize: " + i.labelSize)), i.hasOwnProperty("labelOrientation") && (l(i.labelOrientation, e.SanitizedLabelOrientation) ? t.labelOrientation = i.labelOrientation : o.warn("Invalid labelOrientation: " + i.labelOrientation)), i.hasOwnProperty("fill") && (t.fill = !!i.fill), i.hasOwnProperty("fillOpacity") && (t.fillOpacity = "" + i.fillOpacity), t } function m(i, t) { var a = { id: O(i, t) }; return i.hasOwnProperty("latex") && (a.latex = i.latex + ""), i.hasOwnProperty("color") && (a.color = i.color + ""), i.hasOwnProperty("hidden") && (a.hidden = !!i.hidden), i.hasOwnProperty("points") && (a.points = !!i.points), i.hasOwnProperty("lines") && (a.lines = !!i.lines), i.hasOwnProperty("values") && i.values && (a.values = i.values.map(function (e) { return e + "" })), i.hasOwnProperty("pointStyle") && (d(i.pointStyle) ? a.pointStyle = i.pointStyle : o.warn("Invalid pointStyle: '" + i.pointStyle + "'.")), i.hasOwnProperty("pointSize") && (a.pointSize = "" + i.pointSize), i.hasOwnProperty("pointOpacity") && (a.pointOpacity = "" + i.pointOpacity), i.hasOwnProperty("lineStyle") && (s(i.lineStyle) ? a.lineStyle = i.lineStyle : o.warn("Invalid lineStyle: '" + i.lineStyle + "'.")), i.hasOwnProperty("lineWidth") && (a.lineWidth = "" + i.lineWidth), i.hasOwnProperty("lineOpacity") && (a.lineOpacity = "" + i.lineOpacity), i.hasOwnProperty("columnMode") && (o.warn("As of API v1.1 the 'columnMode' property is deprecated and has been split into individual 'points' and 'lines' properties."), i.columnMode === e.SanitizedColumnMode.POINTS_AND_LINES ? (a.points = !0, a.lines = !0) : i.columnMode === e.SanitizedColumnMode.LINES ? (a.points = !1, a.lines = !0) : (a.points = !0, a.lines = !1), a.lines && !a.points && i.hasOwnProperty("dragMode") && i.dragMode !== n.DragMode.NONE && (o.warn("A 'lines' value of true and 'points' value of false is only compatible with a dragMode of 'NONE'. Proceeding by setting 'points' to true."), a.points = !0), l(i.columnMode, e.SanitizedColumnMode) && o.warn("Invalid columnMode: '" + i.columnMode + "'.")), i.hasOwnProperty("dragMode") && (p(i.dragMode) ? a.dragMode = i.dragMode === n.DragMode.AUTO ? n.DragMode.NONE : i.dragMode : o.warn("Invalid dragMode: '" + i.dragMode + "'.")), a } Object.defineProperty(e, "__esModule", { value: !0 }), e.validateItem = e.sanitizeItem = e.SanitizedLabelOrientation = e.SanitizedLabelSize = e.SanitizedColumnMode = e.SanitizedDragMode = e.SanitizedLineStyle = e.SanitizedPointStyle = void 0, e.SanitizedPointStyle = { OPEN: i.PointStyle.OPEN, CROSS: i.PointStyle.CROSS, POINT: i.PointStyle.POINT }, e.SanitizedLineStyle = { SOLID: i.LineStyle.SOLID, DASHED: i.LineStyle.DASHED, DOTTED: i.LineStyle.DOTTED }, e.SanitizedDragMode = { NONE: n.DragMode.NONE, AUTO: n.DragMode.AUTO, X: n.DragMode.X, Y: n.DragMode.Y, XY: n.DragMode.XY }, e.SanitizedColumnMode = { POINTS: "POINTS", LINES: "LINES", POINTS_AND_LINES: "POINTS_AND_LINES" }, e.SanitizedLabelSize = { SMALL: t.LabelSize.SMALL, MEDIUM: t.LabelSize.MEDIUM, LARGE: t.LabelSize.LARGE }, e.SanitizedLabelOrientation = { DEFAULT: a.LabelOrientation.DEFAULT, CENTER: a.LabelOrientation.CENTER, CENTER_AUTO: a.LabelOrientation.CENTER_AUTO, AUTO_CENTER: a.LabelOrientation.AUTO_CENTER, ABOVE: a.LabelOrientation.ABOVE, ABOVE_LEFT: a.LabelOrientation.ABOVE_LEFT, ABOVE_RIGHT: a.LabelOrientation.ABOVE_RIGHT, ABOVE_AUTO: a.LabelOrientation.ABOVE_AUTO, BELOW: a.LabelOrientation.BELOW, BELOW_LEFT: a.LabelOrientation.BELOW_LEFT, BELOW_RIGHT: a.LabelOrientation.BELOW_RIGHT, BELOW_AUTO: a.LabelOrientation.BELOW_AUTO, LEFT: a.LabelOrientation.LEFT, AUTO_LEFT: a.LabelOrientation.AUTO_LEFT, RIGHT: a.LabelOrientation.RIGHT, AUTO_RIGHT: a.LabelOrientation.AUTO_RIGHT }, e.sanitizeItem = function (e) { switch (e.type) { case "expression": return function (e) { var i = { id: e.id, type: e.type }; return ["latex", "color", "lineStyle", "lineWidth", "lineOpacity", "pointStyle", "pointSize", "pointOpacity", "points", "lines", "fill", "fillOpacity", "hidden", "secret", "dragMode", "label", "showLabel", "labelSize", "labelOrientation", "interactiveLabel"].forEach(function (n) { e.hasOwnProperty(n) && (i[n] = e[n]) }), e.hasOwnProperty("parametricDomain") && (i.parametricDomain = { min: e.parametricDomain.min, max: e.parametricDomain.max }), e.hasOwnProperty("polarDomain") && (i.polarDomain = { min: e.polarDomain.min, max: e.polarDomain.max }), e.hasOwnProperty("domain") && (i.domain = { min: e.domain.min, max: e.domain.max }), e.slider && (e.slider.hardMin && (i.sliderBounds = i.sliderBounds || {}, i.sliderBounds.min = e.slider.min), e.slider.hardMax && (i.sliderBounds = i.sliderBounds || {}, i.sliderBounds.max = e.slider.max), e.slider.step && (i.sliderBounds = i.sliderBounds || {}, i.sliderBounds.step = e.slider.step), i.playing = !!e.slider.isPlaying), i }(e); case "table": return function (e) { return { id: e.id, type: e.type, columns: e.columns.map(y) } }(e); case "folder": case "image": return function (e) { return { id: e.id, type: e.type, hidden: e.hidden, secret: e.secret } }(e); case "text": return function (e) { return { id: e.id, type: e.type, secret: e.secret } }(e); default: return e } }, e.validateItem = function (e, i, n) { var t = e.type; if (i && t && t !== i) o.warn("Cannot change type of expression from '" + i + "' to '" + t + "'."); else switch (t) { case void 0: case "expression": return c(e, n); case "image": return function (e, i) { var n = { type: "image", id: O(e, i) }; return e.hasOwnProperty("hidden") && (n.hidden = !!e.hidden), n }(e, n); case "table": return function (e, i) { var n = { type: "table", id: O(e, i) }; return e.hasOwnProperty("columns") && e.columns && (n.columns = e.columns.map(function (e) { return m(e, i) })), n }(e, n); case "folder": return function (e, i) { var n = { type: "folder", id: O(e, i) }; return e.hasOwnProperty("hidden") && (n.hidden = !!e.hidden), n }(e, n); default: return i ? void o.warn("Cannot modify expressions of type: '" + i + "' through the API.") : void o.warn("Invalid expression type: '" + t + "'.") } } });
define('core/graphing-calc/json/graph-settings', ["require", "exports", "tslib"], function (require, i, e) { "use strict"; var s; Object.defineProperty(i, "__esModule", { value: !0 }), i.isGraphSetting = i.publicGraphSettings = i.DefaultGraphSettings = i.AxisArrowModes = void 0, function (i) { i.NONE = "NONE", i.POSITIVE = "POSITIVE", i.BOTH = "BOTH" }(s = i.AxisArrowModes || (i.AxisArrowModes = {})); var r = { showGrid: !0, showXAxis: !0, showYAxis: !0, xAxisStep: 0, yAxisStep: 0, xAxisMinorSubdivisions: 0, yAxisMinorSubdivisions: 0, xAxisArrowMode: s.NONE, yAxisArrowMode: s.NONE, xAxisLabel: "", yAxisLabel: "", xAxisNumbers: !0, yAxisNumbers: !0, polarMode: !1, polarNumbers: !0, degreeMode: !1, randomSeed: "", restrictGridToFirstQuadrant: !1, userLockedViewport: !1 }; i.DefaultGraphSettings = e.__assign(e.__assign({}, r), { squareAxes: !0 }), i.publicGraphSettings = Object.keys(r), i.isGraphSetting = function (i) { return i in r } });
define('main/font_sizes', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.VERY_LARGE = e.LARGE = e.MEDIUM = e.SMALL = e.VERY_SMALL = void 0, e.VERY_SMALL = 9, e.SMALL = 12, e.MEDIUM = 16, e.LARGE = 20, e.VERY_LARGE = 24 });
!function (t) { "use strict"; var e = function (t, n, r) { var o, i, a = document.createElement("img"); if (a.onerror = n, a.onload = function () { !i || r && r.noRevoke || e.revokeObjectURL(i), n && n(e.scale(a, r)) }, e.isInstanceOf("Blob", t) || e.isInstanceOf("File", t)) o = i = e.createObjectURL(t), a._type = t.type; else { if ("string" != typeof t) return !1; o = t, r && r.crossOrigin && (a.crossOrigin = r.crossOrigin) } return o ? (a.src = o, a) : e.readFile(t, function (t) { var e = t.target; e && e.result ? a.src = e.result : n && n(t) }) }, n = window.createObjectURL && window || window.URL && URL.revokeObjectURL && URL || window.webkitURL && webkitURL; e.isInstanceOf = function (t, e) { return Object.prototype.toString.call(e) === "[object " + t + "]" }, e.transformCoordinates = function () { }, e.getTransformedOptions = function (t) { return t }, e.renderImageToCanvas = function (t, e, n, r, o, i, a, c, s, d) { return t.getContext("2d").drawImage(e, n, r, o, i, a, c, s, d), t }, e.hasCanvasOption = function (t) { return t.canvas || t.crop }, e.scale = function (t, n) { n = n || {}; var r, o, i, a, c, s, d, u, f, h = document.createElement("canvas"), g = t.getContext || e.hasCanvasOption(n) && h.getContext, v = t.naturalWidth || t.width, l = t.naturalHeight || t.height, m = v, O = l, b = function () { var t = Math.max((i || m) / m, (a || O) / O); t > 1 && (m = Math.ceil(m * t), O = Math.ceil(O * t)) }, w = function () { var t = Math.min((r || m) / m, (o || O) / O); t < 1 && (m = Math.ceil(m * t), O = Math.ceil(O * t)) }; return g && (d = (n = e.getTransformedOptions(n)).left || 0, u = n.top || 0, n.sourceWidth ? (c = n.sourceWidth, void 0 !== n.right && void 0 === n.left && (d = v - c - n.right)) : c = v - d - (n.right || 0), n.sourceHeight ? (s = n.sourceHeight, void 0 !== n.bottom && void 0 === n.top && (u = l - s - n.bottom)) : s = l - u - (n.bottom || 0), m = c, O = s), r = n.maxWidth, o = n.maxHeight, i = n.minWidth, a = n.minHeight, g && r && o && n.crop ? (m = r, O = o, (f = c / s - r / o) < 0 ? (s = o * c / r, void 0 === n.top && void 0 === n.bottom && (u = (l - s) / 2)) : f > 0 && (c = r * s / o, void 0 === n.left && void 0 === n.right && (d = (v - c) / 2))) : ((n.contain || n.cover) && (i = r = r || i, a = o = o || a), n.cover ? (w(), b()) : (b(), w())), g ? (h.width = m, h.height = O, e.transformCoordinates(h, n), e.renderImageToCanvas(h, t, d, u, c, s, 0, 0, m, O)) : (t.width = m, t.height = O, t) }, e.createObjectURL = function (t) { return !!n && n.createObjectURL(t) }, e.revokeObjectURL = function (t) { return !!n && n.revokeObjectURL(t) }, e.readFile = function (t, e, n) { if (window.FileReader) { var r = new FileReader; if (r.onload = r.onerror = e, r[n = n || "readAsDataURL"]) return r[n](t), r } return !1 }, "function" == typeof define && define.amd ? define('vendor/load-image/load-image', [], function () { return e }) : t.loadImage = e }(this);
!function (t) { "use strict"; "function" == typeof define && define.amd ? define('vendor/load-image/load-image-orientation', ["./load-image"], t) : t(window.loadImage) }(function (t) { "use strict"; var e = t.hasCanvasOption; t.hasCanvasOption = function (t) { return e(t) || t.orientation }, t.transformCoordinates = function (t, e) { var a = t.getContext("2d"), o = t.width, i = t.height, r = e.orientation; if (r) switch (r > 4 && (t.width = i, t.height = o), r) { case 2: a.translate(o, 0), a.scale(-1, 1); break; case 3: a.translate(o, i), a.rotate(Math.PI); break; case 4: a.translate(0, i), a.scale(1, -1); break; case 5: a.rotate(.5 * Math.PI), a.scale(1, -1); break; case 6: a.rotate(.5 * Math.PI), a.translate(0, -i); break; case 7: a.rotate(.5 * Math.PI), a.translate(o, -i), a.scale(-1, 1); break; case 8: a.rotate(-.5 * Math.PI), a.translate(-o, 0) } }, t.getTransformedOptions = function (t) { if (!t.orientation || 1 === t.orientation) return t; var e, a = {}; for (e in t) t.hasOwnProperty(e) && (a[e] = t[e]); switch (t.orientation) { case 2: a.left = t.right, a.right = t.left; break; case 3: a.left = t.right, a.top = t.bottom, a.right = t.left, a.bottom = t.top; break; case 4: a.top = t.bottom, a.bottom = t.top; break; case 5: a.left = t.top, a.top = t.left, a.right = t.bottom, a.bottom = t.right; break; case 6: a.left = t.top, a.top = t.right, a.right = t.bottom, a.bottom = t.left; break; case 7: a.left = t.bottom, a.top = t.right, a.right = t.top, a.bottom = t.left; break; case 8: a.left = t.bottom, a.top = t.left, a.right = t.top, a.bottom = t.right }return t.orientation > 4 && (a.maxWidth = t.maxHeight, a.maxHeight = t.maxWidth, a.minWidth = t.minHeight, a.minHeight = t.minWidth, a.sourceWidth = t.sourceHeight, a.sourceHeight = t.sourceWidth), a } });
!function (e) { "use strict"; "function" == typeof define && define.amd ? define('vendor/load-image/load-image-meta', ["./load-image"], e) : e(window.loadImage) }(function (e) { "use strict"; var i = window.Blob && (Blob.prototype.slice || Blob.prototype.webkitSlice || Blob.prototype.mozSlice); e.blobSlice = i && function () { var e = this.slice || this.webkitSlice || this.mozSlice; return e.apply(this, arguments) }, e.metaDataParsers = { jpeg: { 65505: [] } }, e.parseMetaData = function (i, a, t) { var l = this, n = (t = t || {}).maxMetaDataSize || 262144, o = {}; !!(window.DataView && i && i.size >= 12 && "image/jpeg" === i.type && e.blobSlice) && e.readFile(e.blobSlice.call(i, 0, n), function (i) { var n, r, s, c, g = i.target.result, d = new DataView(g), f = 2, b = d.byteLength - 4, m = f; if (65496 === d.getUint16(0)) { for (; f < b && ((n = d.getUint16(f)) >= 65504 && n <= 65519 || 65534 === n);) { if (f + (r = d.getUint16(f + 2) + 2) > d.byteLength) { console.log("Invalid meta data: Invalid segment size."); break } if (s = e.metaDataParsers.jpeg[n]) for (c = 0; c < s.length; c += 1)s[c].call(l, d, f, r, o, t); m = f += r } !t.disableImageHead && m > 6 && (g.slice ? o.imageHead = g.slice(0, m) : o.imageHead = new Uint8Array(g).subarray(0, m)) } else console.log("Invalid JPEG file: Missing JPEG marker."); a(o) }, "readAsArrayBuffer") || a(o) } });
!function (e) { "use strict"; "function" == typeof define && define.amd ? define('vendor/load-image/load-image-ios', ["./load-image"], e) : e(window.loadImage) }(function (e) { "use strict"; if (window.navigator && window.navigator.platform && /iP(hone|od|ad)/.test(window.navigator.platform)) { var t = e.renderImageToCanvas; e.detectSubsampling = function (e) { var t, a; return e.width * e.height > 1048576 && ((t = document.createElement("canvas")).width = t.height = 1, (a = t.getContext("2d")).drawImage(e, 1 - e.width, 0), 0 === a.getImageData(0, 0, 1, 1).data[3]) }, e.detectVerticalSquash = function (e, t) { var a, n, i, r, d = e.naturalHeight || e.height, o = document.createElement("canvas"), g = o.getContext("2d"); for (t && (d /= 2), o.width = 1, o.height = d, g.drawImage(e, 0, 0), a = g.getImageData(0, 0, 1, d).data, n = 0, i = d, r = d; r > n;)0 === a[4 * (r - 1) + 3] ? i = r : n = r, r = i + n >> 1; return r / d || 1 }, e.renderImageToCanvas = function (a, n, i, r, d, o, g, c, m, h) { if ("image/jpeg" === n._type) { var u, f, w, s, l = a.getContext("2d"), v = document.createElement("canvas"), I = 1024, p = v.getContext("2d"); if (v.width = I, v.height = I, l.save(), (u = e.detectSubsampling(n)) && (i /= 2, r /= 2, d /= 2, o /= 2), f = e.detectVerticalSquash(n, u), u || 1 !== f) { for (r *= f, m = Math.ceil(I * m / d), h = Math.ceil(I * h / o / f), c = 0, s = 0; s < o;) { for (g = 0, w = 0; w < d;)p.clearRect(0, 0, I, I), p.drawImage(n, i, r, d, o, -w, -s, d, o), l.drawImage(v, 0, 0, I, I, g, c, m, h), w += I, g += m; s += I, c += h } return l.restore(), a } } return t(a, n, i, r, d, o, g, c, m, h) } } });
!function (e) { "use strict"; "function" == typeof define && define.amd ? define('vendor/load-image/load-image-exif', ["./load-image", "./load-image-meta"], e) : e(window.loadImage) }(function (e) { "use strict"; e.ExifMap = function () { return this }, e.ExifMap.prototype.map = { Orientation: 274 }, e.ExifMap.prototype.get = function (e) { return this[e] || this[this.map[e]] }, e.getExifThumbnail = function (e, i, t) { var n, a, f; if (t && !(i + t > e.byteLength)) { for (n = [], a = 0; a < t; a += 1)f = e.getUint8(i + a), n.push((f < 16 ? "0" : "") + f.toString(16)); return "data:image/jpeg,%" + n.join("%") } console.log("Invalid Exif data: Invalid thumbnail data.") }, e.exifTagTypes = { 1: { getValue: function (e, i) { return e.getUint8(i) }, size: 1 }, 2: { getValue: function (e, i) { return String.fromCharCode(e.getUint8(i)) }, size: 1, ascii: !0 }, 3: { getValue: function (e, i, t) { return e.getUint16(i, t) }, size: 2 }, 4: { getValue: function (e, i, t) { return e.getUint32(i, t) }, size: 4 }, 5: { getValue: function (e, i, t) { return e.getUint32(i, t) / e.getUint32(i + 4, t) }, size: 8 }, 9: { getValue: function (e, i, t) { return e.getInt32(i, t) }, size: 4 }, 10: { getValue: function (e, i, t) { return e.getInt32(i, t) / e.getInt32(i + 4, t) }, size: 8 } }, e.exifTagTypes[7] = e.exifTagTypes[1], e.getExifValue = function (i, t, n, a, f, g) { var s, r, o, l, u, d, x = e.exifTagTypes[a]; if (x) { if (!((r = (s = x.size * f) > 4 ? t + i.getUint32(n + 8, g) : n + 8) + s > i.byteLength)) { if (1 === f) return x.getValue(i, r, g); for (o = [], l = 0; l < f; l += 1)o[l] = x.getValue(i, r + l * x.size, g); if (x.ascii) { for (u = "", l = 0; l < o.length && "\0" !== (d = o[l]); l += 1)u += d; return u } return o } console.log("Invalid Exif data: Invalid data offset.") } else console.log("Invalid Exif data: Invalid tag type.") }, e.parseExifTag = function (i, t, n, a, f) { var g = i.getUint16(n, a); f.exif[g] = e.getExifValue(i, t, n, i.getUint16(n + 2, a), i.getUint32(n + 4, a), a) }, e.parseExifTags = function (e, i, t, n, a) { var f, g, s; if (t + 6 > e.byteLength) console.log("Invalid Exif data: Invalid directory offset."); else { if (!((g = t + 2 + 12 * (f = e.getUint16(t, n))) + 4 > e.byteLength)) { for (s = 0; s < f; s += 1)this.parseExifTag(e, i, t + 2 + 12 * s, n, a); return e.getUint32(g, n) } console.log("Invalid Exif data: Invalid directory size.") } }, e.parseExifData = function (i, t, n, a, f) { if (!f.disableExif) { var g, s, r, o = t + 10; if (1165519206 === i.getUint32(t + 4)) if (o + 8 > i.byteLength) console.log("Invalid Exif data: Invalid segment size."); else if (0 === i.getUint16(t + 8)) { switch (i.getUint16(o)) { case 18761: g = !0; break; case 19789: g = !1; break; default: return void console.log("Invalid Exif data: Invalid byte alignment marker.") }42 === i.getUint16(o + 2, g) ? (s = i.getUint32(o + 4, g), a.exif = new e.ExifMap, (s = e.parseExifTags(i, o, o + s, g, a)) && !f.disableExifThumbnail && (r = { exif: {} }, s = e.parseExifTags(i, o, o + s, g, r), r.exif[513] && (a.exif.Thumbnail = e.getExifThumbnail(i, o + r.exif[513], r.exif[514]))), a.exif[34665] && !f.disableExifSub && e.parseExifTags(i, o, o + a.exif[34665], g, a), a.exif[34853] && !f.disableExifGps && e.parseExifTags(i, o, o + a.exif[34853], g, a)) : console.log("Invalid Exif data: Missing TIFF marker.") } else console.log("Invalid Exif data: Missing byte alignment offset.") } }, e.metaDataParsers.jpeg[65505].push(e.parseExifData) });
!function (e) { "use strict"; "function" == typeof define && define.amd ? define('vendor/load-image/load-image-exif-map', ["./load-image", "./load-image-exif"], e) : e(window.loadImage) }(function (e) { "use strict"; e.ExifMap.prototype.tags = { 256: "ImageWidth", 257: "ImageHeight", 34665: "ExifIFDPointer", 34853: "GPSInfoIFDPointer", 40965: "InteroperabilityIFDPointer", 258: "BitsPerSample", 259: "Compression", 262: "PhotometricInterpretation", 274: "Orientation", 277: "SamplesPerPixel", 284: "PlanarConfiguration", 530: "YCbCrSubSampling", 531: "YCbCrPositioning", 282: "XResolution", 283: "YResolution", 296: "ResolutionUnit", 273: "StripOffsets", 278: "RowsPerStrip", 279: "StripByteCounts", 513: "JPEGInterchangeFormat", 514: "JPEGInterchangeFormatLength", 301: "TransferFunction", 318: "WhitePoint", 319: "PrimaryChromaticities", 529: "YCbCrCoefficients", 532: "ReferenceBlackWhite", 306: "DateTime", 270: "ImageDescription", 271: "Make", 272: "Model", 305: "Software", 315: "Artist", 33432: "Copyright", 36864: "ExifVersion", 40960: "FlashpixVersion", 40961: "ColorSpace", 40962: "PixelXDimension", 40963: "PixelYDimension", 42240: "Gamma", 37121: "ComponentsConfiguration", 37122: "CompressedBitsPerPixel", 37500: "MakerNote", 37510: "UserComment", 40964: "RelatedSoundFile", 36867: "DateTimeOriginal", 36868: "DateTimeDigitized", 37520: "SubSecTime", 37521: "SubSecTimeOriginal", 37522: "SubSecTimeDigitized", 33434: "ExposureTime", 33437: "FNumber", 34850: "ExposureProgram", 34852: "SpectralSensitivity", 34855: "PhotographicSensitivity", 34856: "OECF", 34864: "SensitivityType", 34865: "StandardOutputSensitivity", 34866: "RecommendedExposureIndex", 34867: "ISOSpeed", 34868: "ISOSpeedLatitudeyyy", 34869: "ISOSpeedLatitudezzz", 37377: "ShutterSpeedValue", 37378: "ApertureValue", 37379: "BrightnessValue", 37380: "ExposureBias", 37381: "MaxApertureValue", 37382: "SubjectDistance", 37383: "MeteringMode", 37384: "LightSource", 37385: "Flash", 37396: "SubjectArea", 37386: "FocalLength", 41483: "FlashEnergy", 41484: "SpatialFrequencyResponse", 41486: "FocalPlaneXResolution", 41487: "FocalPlaneYResolution", 41488: "FocalPlaneResolutionUnit", 41492: "SubjectLocation", 41493: "ExposureIndex", 41495: "SensingMethod", 41728: "FileSource", 41729: "SceneType", 41730: "CFAPattern", 41985: "CustomRendered", 41986: "ExposureMode", 41987: "WhiteBalance", 41988: "DigitalZoomRatio", 41989: "FocalLengthIn35mmFilm", 41990: "SceneCaptureType", 41991: "GainControl", 41992: "Contrast", 41993: "Saturation", 41994: "Sharpness", 41995: "DeviceSettingDescription", 41996: "SubjectDistanceRange", 42016: "ImageUniqueID", 42032: "CameraOwnerName", 42033: "BodySerialNumber", 42034: "LensSpecification", 42035: "LensMake", 42036: "LensModel", 42037: "LensSerialNumber", 0: "GPSVersionID", 1: "GPSLatitudeRef", 2: "GPSLatitude", 3: "GPSLongitudeRef", 4: "GPSLongitude", 5: "GPSAltitudeRef", 6: "GPSAltitude", 7: "GPSTimeStamp", 8: "GPSSatellites", 9: "GPSStatus", 10: "GPSMeasureMode", 11: "GPSDOP", 12: "GPSSpeedRef", 13: "GPSSpeed", 14: "GPSTrackRef", 15: "GPSTrack", 16: "GPSImgDirectionRef", 17: "GPSImgDirection", 18: "GPSMapDatum", 19: "GPSDestLatitudeRef", 20: "GPSDestLatitude", 21: "GPSDestLongitudeRef", 22: "GPSDestLongitude", 23: "GPSDestBearingRef", 24: "GPSDestBearing", 25: "GPSDestDistanceRef", 26: "GPSDestDistance", 27: "GPSProcessingMethod", 28: "GPSAreaInformation", 29: "GPSDateStamp", 30: "GPSDifferential", 31: "GPSHPositioningError" }, e.ExifMap.prototype.stringValues = { ExposureProgram: { 0: "Undefined", 1: "Manual", 2: "Normal program", 3: "Aperture priority", 4: "Shutter priority", 5: "Creative program", 6: "Action program", 7: "Portrait mode", 8: "Landscape mode" }, MeteringMode: { 0: "Unknown", 1: "Average", 2: "CenterWeightedAverage", 3: "Spot", 4: "MultiSpot", 5: "Pattern", 6: "Partial", 255: "Other" }, LightSource: { 0: "Unknown", 1: "Daylight", 2: "Fluorescent", 3: "Tungsten (incandescent light)", 4: "Flash", 9: "Fine weather", 10: "Cloudy weather", 11: "Shade", 12: "Daylight fluorescent (D 5700 - 7100K)", 13: "Day white fluorescent (N 4600 - 5400K)", 14: "Cool white fluorescent (W 3900 - 4500K)", 15: "White fluorescent (WW 3200 - 3700K)", 17: "Standard light A", 18: "Standard light B", 19: "Standard light C", 20: "D55", 21: "D65", 22: "D75", 23: "D50", 24: "ISO studio tungsten", 255: "Other" }, Flash: { 0: "Flash did not fire", 1: "Flash fired", 5: "Strobe return light not detected", 7: "Strobe return light detected", 9: "Flash fired, compulsory flash mode", 13: "Flash fired, compulsory flash mode, return light not detected", 15: "Flash fired, compulsory flash mode, return light detected", 16: "Flash did not fire, compulsory flash mode", 24: "Flash did not fire, auto mode", 25: "Flash fired, auto mode", 29: "Flash fired, auto mode, return light not detected", 31: "Flash fired, auto mode, return light detected", 32: "No flash function", 65: "Flash fired, red-eye reduction mode", 69: "Flash fired, red-eye reduction mode, return light not detected", 71: "Flash fired, red-eye reduction mode, return light detected", 73: "Flash fired, compulsory flash mode, red-eye reduction mode", 77: "Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected", 79: "Flash fired, compulsory flash mode, red-eye reduction mode, return light detected", 89: "Flash fired, auto mode, red-eye reduction mode", 93: "Flash fired, auto mode, return light not detected, red-eye reduction mode", 95: "Flash fired, auto mode, return light detected, red-eye reduction mode" }, SensingMethod: { 1: "Undefined", 2: "One-chip color area sensor", 3: "Two-chip color area sensor", 4: "Three-chip color area sensor", 5: "Color sequential area sensor", 7: "Trilinear sensor", 8: "Color sequential linear sensor" }, SceneCaptureType: { 0: "Standard", 1: "Landscape", 2: "Portrait", 3: "Night scene" }, SceneType: { 1: "Directly photographed" }, CustomRendered: { 0: "Normal process", 1: "Custom process" }, WhiteBalance: { 0: "Auto white balance", 1: "Manual white balance" }, GainControl: { 0: "None", 1: "Low gain up", 2: "High gain up", 3: "Low gain down", 4: "High gain down" }, Contrast: { 0: "Normal", 1: "Soft", 2: "Hard" }, Saturation: { 0: "Normal", 1: "Low saturation", 2: "High saturation" }, Sharpness: { 0: "Normal", 1: "Soft", 2: "Hard" }, SubjectDistanceRange: { 0: "Unknown", 1: "Macro", 2: "Close view", 3: "Distant view" }, FileSource: { 3: "DSC" }, ComponentsConfiguration: { 0: "", 1: "Y", 2: "Cb", 3: "Cr", 4: "R", 5: "G", 6: "B" }, Orientation: { 1: "top-left", 2: "top-right", 3: "bottom-right", 4: "bottom-left", 5: "left-top", 6: "right-top", 7: "right-bottom", 8: "left-bottom" } }, e.ExifMap.prototype.getText = function (e) { var t = this.get(e); switch (e) { case "LightSource": case "Flash": case "MeteringMode": case "ExposureProgram": case "SensingMethod": case "SceneCaptureType": case "SceneType": case "CustomRendered": case "WhiteBalance": case "GainControl": case "Contrast": case "Saturation": case "Sharpness": case "SubjectDistanceRange": case "FileSource": case "Orientation": return this.stringValues[e][t]; case "ExifVersion": case "FlashpixVersion": return String.fromCharCode(t[0], t[1], t[2], t[3]); case "ComponentsConfiguration": return this.stringValues[e][t[0]] + this.stringValues[e][t[1]] + this.stringValues[e][t[2]] + this.stringValues[e][t[3]]; case "GPSVersionID": return t[0] + "." + t[1] + "." + t[2] + "." + t[3] }return String(t) }, function (e) { var t, i = e.tags, r = e.map; for (t in i) i.hasOwnProperty(t) && (r[i[t]] = t) }(e.ExifMap.prototype), e.ExifMap.prototype.getAll = function () { var e, t, i = {}; for (e in this) this.hasOwnProperty(e) && (t = this.tags[e]) && (i[t] = this.getText(t)); return i } });
define('loadImage', ['require', 'vendor/load-image/load-image-orientation', 'vendor/load-image/load-image-meta', 'vendor/load-image/load-image-ios', 'vendor/load-image/load-image-exif', 'vendor/load-image/load-image-exif-map', 'vendor/load-image/load-image'], function (require) { "use strict"; return require("vendor/load-image/load-image-orientation"), require("vendor/load-image/load-image-meta"), require("vendor/load-image/load-image-ios"), require("vendor/load-image/load-image-exif"), require("vendor/load-image/load-image-exif-map"), require("vendor/load-image/load-image") });
define('expressions/image_file_to_data_url', ["require", "exports", "loadImage"], function (require, t, e) { "use strict"; function a(t, e) { for (var a, n = [.92, .86, .8, .7, .6, .5, .4, .3, .2, .1], i = 0; i < n.length; i++)if ((a = t.toDataURL("image/jpeg", n[i])).length < e) return a; return a } Object.defineProperty(t, "__esModule", { value: !0 }), t.imageFileToDataURL = void 0, t.imageFileToDataURL = function (t, n) { e(t, function (e) { if (e.toDataURL) { var i, r = 2e5; if ("image/jpeg" === t.type) i = a(e, r); else if ((i = e.toDataURL()).length > r) i = i.length > .75 * e.width * e.height && !function (t) { for (var e = t.getContext("2d").getImageData(0, 0, t.width, t.height).data, a = 3; a < e.length; a += 4)if (255 !== e[a]) return !0; return !1 }(e) ? a(e, r) : function (t, e) { for (var a, n = t.toDataURL().length, i = t.width, r = t.height, o = document.createElement("canvas"), g = 0; g < 2; g++) { var h = Math.sqrt(e / n); if (i = Math.round(h * i), r = Math.round(h * r), o.height = r, o.width = i, o.getContext("2d").drawImage(t, 0, 0, i, r), (n = (a = o.toDataURL()).length) < e) return a } return a }(e, r); n(null, i) } else n(!0) }, { orientation: !0, canvas: !0, maxWidth: 1600, maxHeight: 1600 }) } });
define('main/graph_settings', ['require', 'pjs', 'underscore', 'underscore_model', 'core/graphing-calc/json/graph-settings', 'console', 'core/graphing-calc/json/graph-settings', 'core/lib/color-helpers'], function (require) { "use strict"; var e = require("pjs"), r = require("underscore"), o = require("underscore_model").UnderscoreModel, t = require("core/graphing-calc/json/graph-settings").AxisArrowModes, i = require("console"), n = require("core/graphing-calc/json/graph-settings").DefaultGraphSettings, s = require("core/lib/color-helpers"), a = e(o, function (e, c, l) { e.init = function () { for (var e in c.init.call(this), this.stateProperties = [], this.cloneProperties = [], this.config = new o, n) n.hasOwnProperty(e) && this.addStateProperty(e, n[e]); this.labelHangingColor = "rgba(150,150,150,1)", this.lastChangedAxis = "x"; var r = this; function t(e, o, t) { function i() { r.setProperty(e, r.config.projectorMode ? t : o) } r.cloneProperties.push(e), r.config.observe("projectorMode", i), i() } function i(e, o, t, i, n) { function s() { var s; s = r.config.projectorMode ? r.highlight ? n : i : r.highlight ? t : o, r.setProperty(e, s) } r.cloneProperties.push(e), r.observe("highlight", s), r.config.observe("projectorMode", s), s() } t("labelSize", 14, 19), t("majorAxisOpacity", .4, 1), t("minorAxisOpacity", .12, .25), t("axisOpacity", .9, .9), t("axisLineWidth", 1.5, 2), t("axisLineOffset", .25, 0), t("pixelsPerLabel", 80, 120), i("curveOpacity", .7, 1, .7, 1), t("globalCurveColor", void 0, void 0), t("disableFill", !1, !1), i("graphLineWidth", 2.5, 3.5, 5, 7), i("pointLineWidth", 9, 11, 15, 17) }, e.addStateProperty = function (e, r) { this[e] = r, this.stateProperties.push(e), this.cloneProperties.push(e) }, l.fromObject = function (e) { var r = a(); return r.cloneProperties.forEach(function (o) { e.hasOwnProperty(o) && r.setProperty(o, e[o]) }), r }, e.registerCallbacks = function (e, r) { var o = this, t = function () { e.redrawAllLayers() }; this.stateProperties.forEach(function (e) { o.observe(e, t) }), this.config.observe("backgroundColor", t), this.config.observe("textColor", t), this.config.observe("invertedColors", t), this.observe("squareAxes", function () { e.viewportController.enforceSquareAxes() }), this.observe("backgroundColor", function () { e.redrawAllLayers() }), this.observe("textColor", function () { e.redrawAllLayers() }), this.config.observe("enableTabindex", function () { e.redrawAllLayers() }), this.config.observeAndSync("projectorMode", function () { e.redrawAllLayers() }) }; var d = function (e, o) { var n; switch (e) { case "xAxisMinorSubdivisions": case "yAxisMinorSubdivisions": o !== (n = Math.round(Math.min(Math.max(0, o), 5))) && i.warn("minorSubdivisions must be an integer between 0 and 5. You provided " + o + ", which we changed to " + n + "."); break; case "degreeMode": case "projectorMode": case "showGrid": case "showXAxis": case "showYAxis": case "xAxisNumbers": case "yAxisNumbers": case "polarNumbers": case "enableTabindex": case "invertedColors": o !== (n = "false" !== o && !!o) && i.warn(e + " must be a Boolean. You provided " + o + " (" + typeof o + "), which we changed to " + n + " (" + typeof n + ")."); break; case "xAxisStep": case "yAxisStep": n = parseFloat(o), isFinite(o) || (n = 0, i.warn(e + " must be a number. You provided " + o + ", which we changed to " + n + ".")); break; case "xAxisArrowMode": case "yAxisArrowMode": (n = t[o]) !== o && (n = t.NONE, i.warn("unknown AxisArrowMode. Allowed values are: \n" + r.keys(t).join("\n"))); break; case "xAxisLabel": case "yAxisLabel": n = o, "string" != typeof o && (n = "", i.warn(e + " must be a string. you provided a " + typeof o + ".")); break; case "randomSeed": n = o, "string" != typeof o && (n = "" + o, i.warn("randomSeed must be a string. you provided a " + typeof o + ".")); break; case "backgroundColor": n = o, "string" != typeof o && (n = "", i.warn(e + " must be a string. you provided a " + typeof o + ".")), n || (n = "#fff"), "#" !== n[0] && (n = "#" + n); break; case "textColor": n = o, "string" != typeof o && (n = "", i.warn(e + " must be a string. you provided a " + typeof o + ".")), n || (n = "#000"), "#" !== n[0] && (n = "#" + n); break; case "fontSize": n = o, "number" != typeof o && (n = parseInt(n, 10), i.warn("fontSize must be a number. Attempted to convert " + o + " to " + n + ".")); break; case "language": n = o, "string" != typeof o && (n = "", i.warn(e + " must be a string. you provided a " + typeof o + ".")), "undefined" != typeof Desmos && Desmos.supportedLanguages.indexOf(o) < 0 && "en" !== o && (n = "en", i.warn(o + " is not currently an available language.")); break; default: n = o }return n }; e._validateSettings = function (e) { var r = {}, o = !1; for (var t in e) this.stateProperties.indexOf(t) >= 0 ? r[t] = d(t, e[t]) : (i.warn('Invalid graph setting "' + t + '".'), o = !0); return o && i.warn("Available graph settings are: \n" + this.stateProperties.join("\n")), r }, e.getBackgroundColor = function () { var e = s.normalizeColor(this.config.backgroundColor || "#fff"); return this.config.invertedColors && "#ffffff" !== e ? s.invertColor(e) : e }, e.getTextColor = function () { var e = s.normalizeColor(this.config.textColor || "#000"); return this.config.invertedColors && "#000000" !== e ? s.invertColor(e) : e }, e.setGraphSettings = function (e) { var r = this._validateSettings(e); for (var o in r) r.hasOwnProperty(o) && ("projectorMode" === o || "invertedColors" === o || "fontSize" === o || "language" === o || "backgroundColor" === o || "textColor" === o ? this.config.setProperty(o, r[o]) : this.setProperty(o, r[o])) } }); return a });
define('scroll_helpers', ['require'], function (require) { return { scrollVisible: function (o, t, r) { var e, i = t.height(), l = o.outerHeight(), n = o.offset(), f = t.offset(); if (!n || !f) return !1; var s = t[0].scrollTop, c = n.top + s - f.top, u = c - r, a = l + c + r - i; return (e = u >= a ? Math.min(Math.max(s, a), u) : .5 * (u + a)) !== s && (t[0].scrollTop = e, t[0].scrollTop != s) } } });
define('bugsnag', ["require", "exports", "tslib"], function (require, e, r) { "use strict"; var t, i; Object.defineProperty(e, "__esModule", { value: !0 }), e.setBeforeSendCB = e.leaveBreadcrumb = e.notify = e.init = void 0; var n = ["UnhandledRejection", "lnrAppboy", "socratic", "MyAppGet", "SymBrowser_", "mobincube_", "_avast_submit", "Cannot redefine property: googletag", "jcarousel", "SyntaxError: Unexpected identifier 'script'", "__gCrWeb.autofill.extractForms", "BrowseITEXT", "Can't find variable: removeAllHighlights", "aAttribruteValue.parentNode.getAttribute", "vid_mate_check", "GetImageTagSrcFromPoint", "Can't find variable: didEnterViewPort", "tinyMCE is not defined"]; function o() { var e = "production"; if (location && location.hostname) { var r = location.hostname.split("."), t = r.slice(0, r.length - 2).join("."); "desmos.com" === r.slice(r.length - 2).join(".") && (e = t && "www" !== t ? t : "production") } return e } e.init = function (e) { if (!t) { var r = 0, a = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (e) { var r = 16 * Math.random() | 0; return ("x" == e ? r : 3 & r | 8).toString(16) }); t = e({ apiKey: "7f7807097671acbc4557e64bbf5eb529", maxBreadcrumbs: 40, appVersion: window.Desmos && window.Desmos.commit, releaseStage: o(), consoleBreadcrumbsEnabled: !1, beforeSend: function (e) { if (e.errorClass) for (var t = 0, o = n; t < o.length; t++) { var s = o[t]; if (-1 !== e.errorClass.indexOf(s)) return void e.ignore() } if (e.errorMessage) for (var c = 0, d = n; c < d.length; c++) { s = d[c]; if (-1 !== e.errorMessage.indexOf(s)) return void e.ignore() } i && i(e), e.isIgnored() || (r += 1, e.metaData.errorNumber = r, e.metaData.pageLoadId = a) } }) } }, e.notify = function (e, r) { t && t.notify(e, r) }, e.leaveBreadcrumb = function (e, i, n, o) { if (i) for (var a in i = r.__assign({}, i)) try { i[a] = JSON.stringify(i[a], null, 2) } catch (e) { i[a] = "[[could not stringify]]" } t && t.leaveBreadcrumb(e, i, n, o) }, e.setBeforeSendCB = function (e) { i = e } });
define('tours/trip', ['require', 'jquery', 'pjs', 'mathquill', 'scroll_helpers', 'bugsnag'], function (require) { "use strict"; var t = require("jquery"), i = require("pjs"), e = require("mathquill"), s = require("scroll_helpers"), o = require("bugsnag"); return i({ init: function (t) { this.settings = t, this.__cachedStepName = null }, ensureTripBlock: function () { if (!this.$tripBlock) { var i = ['<div class="trip-block">', '<div class="trip-interior">', '<a class="trip-close">&times;</a>', '<div class="trip-content"></div>', "</div>", '<div class="trip-arrow"></div>', "</div>"].join(""), e = this, s = this.$tripBlock = t(i); s.css({ top: "-100px" }), t("body").append(s), s.find(".trip-close").on("dcg-tap", function (t) { t.preventDefault(), e.stop() }), this.bindKeyEvents() } }, cleanup: function () { return this.unbindKeyEvents(), this.hideTripBlock(), !1 }, bindKeyEvents: function () { var i = this; t(document).on({ "keydown.Trip": function (t) { i.keyEvent.call(i, t) } }) }, unbindKeyEvents: function () { t(document).off("keydown.Trip") }, keyEvent: function (t) { 27 === t.which && this.stop() }, stop: function () { this.hideTripBlock(), this.settings.onTripStop() }, exitTourBecauseOfError: function (t, i) { var e = "", s = i; do { e = s.selector + e } while (s = s.prevObject); this.stop(), o.notify("TourError: could not find $sel.offset()", { metaData: { message: t, selector: e } }) }, showTripBlock: function (i) { this.ensureTripBlock(), "string" == typeof i.sel && (i.sel = t(i.sel)), i.sel = i.sel.filter(":visible"), i.scrollContainer && s.scrollVisible(i.sel, i.scrollContainer, 0); var o = this.$tripBlock; o.find(".trip-content").html(i.content), o.toggleClass("trip-hidden", !!i.hidden); var n = i.sel, r = n.outerWidth(), l = n.outerHeight(), c = o.outerWidth(), a = o.outerHeight(); if (n.offset()) { this.__cachedMissingSelTime = void 0, o.removeClass("trip-e trip-s trip-w trip-n"); var p = 0; switch (i.position) { case "e": o.addClass("trip-e"), o.css({ left: n.offset().left + r + 10, top: n.offset().top - (a - l) / 2 }); break; case "s": o.addClass("trip-s"); var d = n.offset().left + (r - c) / 2; o.css({ left: d, top: n.offset().top + l + 10 }), d + c > t(window).width() - 1 && (p = t(window).width() - 1 - d - c), d < 1 && (p = 1 - d); break; case "w": o.addClass("trip-w"), o.css({ left: n.offset().left - (10 + c), top: n.offset().top - (a - l) / 2 }); break; default: o.addClass("trip-n"), o.css({ left: n.offset().left + (r - c) / 2, top: n.offset().top - 10 - a }) }o.find(".trip-interior").css("transform", "translate(" + p + "px, 0)"), o.css({ display: "inline-block" }), o.find(".trip-math:not(.dcg-mq-math-mode)").each(function () { e.StaticMath(this) }) } else this.__cachedMissingSelTime ? Date.now() - this.__cachedMissingSelTime > 1e3 && (i.final ? this.stop() : this.exitTourBecauseOfError(i.content, n)) : this.__cachedMissingSelTime = Date.now() }, fadeInTripBlock: function () { this.ensureTripBlock(); var t = this.$tripBlock; setTimeout(function () { t.addClass("trip-is-loaded") }, 0) }, hideTripBlock: function () { this.$tripBlock && this.$tripBlock.removeClass("trip-is-loaded") } }) });
define('tours/tour_manager', ['require', 'pjs', './trip'], function (require) { "use strict"; var t = require("pjs"), i = require("./trip"); return t(function (t, r) { t.init = function () { this.tripManager = new i({ onTripStop: this.stopTour.bind(this) }), this.currentStep = void 0, this.currentTour = void 0 }, t._tripLoop = function () { if (clearTimeout(this.__tripLoopTimeout), this.running) { var t = this; t._advanceTrip(), t.__tripLoopTimeout = setTimeout(t._tripLoop.bind(t), 200) } }, t._advanceTrip = function () { var t = this.currentTour.update(), i = (new Date).getTime(); if (t && this.currentStep && t.content !== this.currentStep.content) { if (this.currentStep.delayBeforeExit) { if (this.throttleTimer && i - this.throttleTimer < this.currentStep.delayBeforeExit) return; if (!this.throttleTimer) return void (this.throttleTimer = i) } t.delayBeforeEnter && (this.currentStep = t, this.throttleTimer = i) } if (!(t && this.currentStep && t.content === this.currentStep.content && this.throttleTimer && i - this.throttleTimer < this.currentStep.delayBeforeEnter) && (this.throttleTimer = null, t && !t.doNotUpdate)) { if (this.currentStep = t, t.final) return void this.finishTour(t, 5); this.tripManager.showTripBlock(t) } }, t.updateNow = t._advanceTrip, t.startTour = function (t) { this.running || (this.currentTour = t, this.running = !0, this._tripLoop(), this.tripManager.fadeInTripBlock()) }, t.closingMsg = function (t, i) { return "<b>" + t + "</b><br>This message will self-destruct in " + i + "..." }, t.finishTour = function (t, i) { clearTimeout(this.__tripLoopTimeout), this.running = !1; var r = this; i < 0 ? r.tripManager.stop() : (t.endingMsg && (t.content = r.closingMsg(t.endingMsg, i)), r.tripManager.showTripBlock(t), setTimeout(function () { r.finishTour(t, i - 1) }, 1e3)) }, t.stopTour = function () { this.running = !1, this.currentStep = void 0, this.currentTour = void 0 } }) });
define('core/math/rational-arithmetic-sequence', ['require', 'core/math/distance', 'core/math/builtin'], function (require) { "use strict"; var n = require("core/math/distance"), t = require("core/math/builtin"); return function (r, a) { var c = t.toFraction(r), i = t.toFraction(a); if (n.approx(c.n / c.d, r) && n.approx(i.n / i.d, a)) { var o = t.lcm(c.d, i.d), e = c.n * (o / c.d); return { nstart: e, nstep: i.n * (o / i.d) - e, lcm: o } } } });
define('core/math/evaluate-single-expression', ["require", "exports", "core/math/builtinframe", "core/math/parsenode/constant", "core/math/policy", "core/math/parser"], function (require, e, t, r, a, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e, c) { if (/^\s*(\-|\+)?([0-9]+(\.[0-9]+)?)\s*$/.test(e)) return parseFloat(e); var i = Object.create(t); return i.trigAngleMultiplier = r(c ? Math.PI / 180 : 1), +o.parse(e).tryGetConcreteTree(a.defaultPolicy, i).asValue() } });
define('lib/rounding', ["require", "exports", "core/math/distance"], function (require, e, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.shortestDecimalBetween = void 0, e.shortestDecimalBetween = function (e, r) { if (!isFinite(e)) return e; if (!isFinite(r)) return r; var i = t.mean(e, r); if (e > 0 != r > 0) return 0; if (0 === e || 0 === r) return 0; var n = e > 0 ? 1 : -1, a = Math.abs(e).toExponential().split("e"), o = Math.abs(r).toExponential().split("e"), s = a[0], l = o[0], u = a[1], f = o[1]; if (f !== u) return n * Math.pow(10, Math.max(parseFloat(u), parseFloat(f))); if (s[0] !== l[0]) return parseFloat(i.toPrecision(1)); for (var p = 1, c = 2; c < Math.min(s.length, l.length) && (p++, s[c] === l[c]); c++); return parseFloat(i.toPrecision(p)) } });
define('core/lib/validate-color', ["require", "exports", "core/vendor/d3-color"], function (require, e, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var o = r.color; e.default = function (e) { return null !== o(e) } });
define('core/math/policyGraphing', ["require", "exports", "./builtinframe", "core/types/graphmode"], function (require, t, r, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.PolicyGraphing3D = t.PolicyGraphing = void 0; var e = function () { function t() { } return t.prototype.dimensions = function () { return 2 }, t.prototype.assignmentForbidden = function (t) { return "x" === t || "y" === t || "theta" === t || "index" === t || "dt" === t || "tmp" === t.slice(0, 3) || r.hasOwnProperty(t) }, t.prototype.isValidSlider = function (t) { return "x" === t || "y" === t || "ans" !== t.slice(0, 3) && !this.assignmentForbidden(t) }, t.prototype.sliderVariables = function (t) { var r = this; return -1 !== t.indexOf("theta") && (t = t.filter(function (t) { return "r" !== t })), t.filter(function (t) { return !r.assignmentForbidden(t) && ("ans" !== t.slice(0, 3) && "_" !== t[0]) }) }, t.prototype.graphingEnabled = function () { return !0 }, t.prototype.ansEnabled = function () { return !1 }, t.prototype.dimensionVarsEnabled = function () { return !0 }, t.prototype.validRegressionParameter = function (t) { return "x" !== t && "y" !== t }, t.prototype.validLHS = function (t) { return "theta" !== t }, t.prototype.unplottablePolarFunction = function (t, r) { return "theta" === t && -1 !== r.indexOf("r") }, t.prototype.validDoubleInequalitySymbol = function (t) { return "x" === t || "y" === t }, t.prototype.validDoubleInequalityVariables = function (t) { return !(t.length > 2) && t.every(this.validDoubleInequalitySymbol) }, t.prototype.validExpressionVariables = function (t) { return 1 === t.length && "x" === t[0] }, t.prototype.validSolvedVariable = function (t) { return "x" === t || "y" === t || "r" === t }, t.prototype.validImplicitVariables = function (t) { switch (t.length) { case 0: return !0; case 1: return "x" === t[0] || "y" === t[0] || "r" === t[0]; case 2: return "x" === t[0] && "y" === t[1] || "y" === t[0] && "x" === t[1] || "r" === t[0] && "theta" === t[1] || "theta" === t[0] && "r" === t[1]; default: return !1 } }, t.prototype.graphableListVariables = function (t, r) { return "x" === t || "y" === t || "r" === t || "x" === r || "y" === r }, t.prototype.validParametricVariable = function (t) { return "t" === t }, t.prototype.validParametricVariables = function (t) { return 1 === t.length && this.validParametricVariable(t[0]) }, t.prototype.validInequalityVariables = function (t) { switch (t.length) { case 1: return "x" === t[0] || "y" === t[0] || "r" === t[0]; case 2: return this.validImplicitVariables(t); default: return !1 } }, t.prototype.validFirstColumnVariable = function (t) { return "y" !== t && "r" !== t && "theta" !== t && !t.match(/y_(\d+)/) }, t.prototype.validActionVariable = function (t) { return "dt" === t || "index" === t }, t.prototype.complicatedPolarImplicit = function (t, r) { return "theta" === t || "r" === t && 1 !== r }, t.prototype.constantGraphMode = function (t) { return "x" === t ? n.X : "r" === t ? n.POLAR : n.Y }, t.prototype.graphMode = function (t, r) { var e = r[0]; return "y" === e || "x" === t ? n.X : "r" === t && "theta" === e ? n.POLAR : n.Y }, t.prototype.tableableAsConstant = function (t) { return "x" !== t && ("r" !== t && "theta" !== t) }, t.prototype.implicitIndependent = function (t) { return "x" }, t.prototype.implicitDependency = function (t) { return 1 !== t.length ? "y" : "y" === t[0] ? "x" : "theta" === t[0] ? "r" : "y" }, t.prototype.graphableAsConstant = function (t) { return "y" === t || "x" === t || "r" === t }, t.prototype.disabledFeatures = function () { return [] }, t }(), i = function () { function t() { } return t.prototype.dimensions = function () { return 3 }, t.prototype.assignmentForbidden = function (t) { return "x" === t || "y" === t || "z" === t || "tmp" === t.slice(0, 3) || r.hasOwnProperty(t) }, t.prototype.isValidSlider = function (t) { return "x" === t || "y" === t || "z" === t || "ans" !== t.slice(0, 3) && !this.assignmentForbidden(t) }, t.prototype.sliderVariables = function (t) { var r = this; return t.filter(function (t) { return !r.assignmentForbidden(t) && "ans" !== t.slice(0, 3) }) }, t.prototype.graphingEnabled = function () { return !0 }, t.prototype.ansEnabled = function () { return !1 }, t.prototype.dimensionVarsEnabled = function () { return !0 }, t.prototype.validRegressionParameter = function (t) { return !1 }, t.prototype.validLHS = function (t) { return !0 }, t.prototype.unplottablePolarFunction = function (t, r) { return !1 }, t.prototype.validDoubleInequalitySymbol = function (t) { return !1 }, t.prototype.validDoubleInequalityVariables = function (t) { return !1 }, t.prototype.validExpressionVariables = function (t) { var r = t.join(""); return "x" === r || "y" === r || "xy" === r || "yx" === r }, t.prototype.validSolvedVariable = function (t) { return "x" === t || "y" === t || "z" === t }, t.prototype.validImplicitVariables = function (t) { return !1 }, t.prototype.graphableListVariables = function (t, r) { return "x" === t || "y" === t || "x" === r || "y" === r }, t.prototype.validParametricVariable = function (t) { return "t" === t }, t.prototype.validParametricVariables = function (t) { return 1 === t.length && this.validParametricVariable(t[0]) }, t.prototype.validInequalityVariables = function (t) { return !1 }, t.prototype.validFirstColumnVariable = function (t) { return !1 }, t.prototype.validActionVariable = function (t) { return "dt" === t || "index" === t }, t.prototype.complicatedPolarImplicit = function (t, r) { return !1 }, t.prototype.constantGraphMode = function (t) { return n.Z_3D }, t.prototype.graphMode = function (t, r) { return "z" === t && this.validExpressionVariables(r) ? n.Z_3D : n.NONE }, t.prototype.tableableAsConstant = function (t) { return "x" !== t && "r" !== t }, t.prototype.implicitIndependent = function (t) { return "x" }, t.prototype.implicitDependency = function (t) { if (2 !== t.length) return "z"; var r = t[0] < t[1] ? t[0] + t[1] : t[1] + t[0]; return "xy" === r ? "z" : "xz" === r ? "y" : "yz" === r ? "x" : "z" }, t.prototype.graphableAsConstant = function (t) { return "z" === t }, t.prototype.disabledFeatures = function () { return [] }, t }(); t.PolicyGraphing = new e, t.PolicyGraphing3D = new i });
define('core/graphing-calc/extract-slider-value-from-latex', ["require", "exports", "core/math/builtinframe", "core/math/parser", "core/math/policyGraphing"], function (require, e, r, t, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.extractSliderValueFromLatex = void 0, e.extractSliderValueFromLatex = function (e) { var i = t.parse(e); if ("Assignment" !== i.type) return NaN; if ("Constant" !== i._expression.type) return NaN; if (!a.PolicyGraphing.validLHS(i._symbol)) return NaN; if (r[i._symbol]) return NaN; var n = i._expression.asValue(); return "number" == typeof n ? n : NaN } });
define('graphing-calc/models/expression', ["require", "exports", "tslib", "core/lib/dragmode", "core/types/slider-loop-modes", "core/types/styles", "core/types/label-sizes", "core/types/label-orientations", "core/math/evaluate-single-expression", "lib/rounding", "core/lib/deepCopy", "core/lib/copy-properties", "./abstract-item", "./list", "underscore", "core/math/expression-types", "core/lib/label", "core/lib/number-to-latex", "core/math/sliders", "core/lib/number-to-latex", "core/lib/validate-color", "core/graphing-calc/json/expression", "core/math/distribution-spec", "core/graphing-calc/extract-slider-value-from-latex"], function (require, e, i, a, t, r, n, l, o, s, d, u, c, p, f, m, g, x, b, S, v, _, D, M) { "use strict"; function L(e) { return void 0 === e ? NaN : +e } function h(e) { var i = e.formula; return !!i && (e.controller.isDecimalToFractionEnabled() && i.hasOwnProperty("constant_value") && g.canDisplayAsFraction(L(i.constant_value))) } function y(e) { var i = e.formula; if (!i) return !1; var a = i.is_evaluable && i.zero_values && i.zero_values.length > 0 && "boolean" != typeof i.zero_values[0].val, t = h(e) && Y(e), r = !!i.rgb_value && e.formula.assignment; return a || t || r } function P(e, i) { if (!isFinite(i)) return e; var a = /=(.*?)([-\.0-9]+)/, t = e.match(a); if (!t) return e; if (parseFloat(t[2]) === i) return e; var r = S.numberToDecimalString(i); return e.replace(a, "=$1" + r) } function T(e) { var i = e.dragMode === a.DragMode.AUTO && void 0 !== e.formula.default_drag_mode ? e.formula.default_drag_mode : e.dragMode; e.dragMode === a.DragMode.AUTO && e.hidden && (i = a.DragMode.NONE), e.reconciledDragMode = a.reconcileDragMode(i, e.formula.move_strategy), e.interactiveLabel && e.reconciledDragMode !== a.DragMode.NONE && H(e, !1) } function E(e, i, a) { if (!e.sliderExists) return NaN; var t = w(e), r = C(e), n = N(e); if (a && void 0 !== a.overwriteStep && (n = a.overwriteStep), i = b.constrainSliderValueLikeEvaluator({ target: i, hardMin: e.slider.hardMin ? t : void 0, hardMax: e.slider.hardMax ? r : void 0, step: n }), !a || !a.ignoreSoftLimits) { if (!e.slider.hardMin && i < t) return t; if (!e.slider.hardMax && i > r) return r } return i } function V(e, i, a) { if (void 0 === a && (a = {}), !e.sliderExists) return NaN; var t = I(e), r = w(e), n = C(e), l = N(e); void 0 === a.overwriteStep && (a.overwriteStep = l || (n - r) / 20); var o = 0; switch (i) { case "min": return E(e, r); case "max": return E(e, n); case "up": o = 1; break; case "down": o = -1; break; case "bigup": o = 5; break; case "bigdown": o = -5; break; default: return i }for (var s = t, d = 0; d < 20; d++) { var u = d / 3 * a.overwriteStep, c = t; if (o > 0) (t = E(e, s + u, a)) > c && (o -= 1); else { if (!(o < 0)) break; (t = E(e, s - u, a)) < c && (o += 1) } } return t } function F(e) { var i = p.getParentFolderModel(e); i && i.hidden || e.formula.expression_type && K(e) ? e.shouldGraph = !1 : e.shouldGraph = !e.hidden } function A(e) { var i = e.formula && e.formula.raw_slider_latex; if (e.sliderExists && e.latex === i) { var a = e.latex; if (e.cachedDisplayLatex.storedLatex === a) { var t = z(e); if (isFinite(t)) { var r = e.controller.getFocusLocation(); r && "expression" === r.type && r.id === e.id || (e.cachedDisplayLatex.valueLatex = P(e.latex, t)) } } else e.cachedDisplayLatex = { storedLatex: e.latex, valueLatex: e.latex } } else e.cachedDisplayLatex = { storedLatex: e.latex, valueLatex: e.latex } } function O(e) { var i = g.value(e); return i.superscript && i.mantissa ? i.mantissa + "^{" + i.superscript + "}" : i.string } function w(e) { if (e.slider.hardMin) { var i = e.formula.slider_min_number; return isFinite(i) ? i : NaN } var a = e.controller.isDegreeMode(), t = o.default(e.slider.min, a), r = I(e), n = N(e), l = e.slider.hardMax ? e.formula.slider_max_number : void 0, s = -10; if (t < s && (s = t), r < s && (s = r), l < s && (s = l), n) { var d = b.constrainSliderValueLikeEvaluator({ target: s, hardMin: void 0, hardMax: l, step: n }); s = d <= s ? d : d - n } return s } function C(e) { if (e.slider.hardMax) { var i = e.formula.slider_max_number; return isFinite(i) ? i : NaN } var a = e.controller.isDegreeMode(), t = o.default(e.slider.max, a), r = I(e), n = N(e), l = e.slider.hardMin ? e.formula.slider_min_number : void 0; return b.computeSoftMax({ storedMax: t, sliderValue: r, step: n, hardMin: l }) } function N(e) { return e.formula.slider_step_number } function z(e) { if (e.formula && e.formula.is_slider) { var i = e.formula.constant_value; if (void 0 !== i) return +i } } function I(e) { var i = e.formula && e.formula.raw_slider_latex; if (e.latex !== i) return M.extractSliderValueFromLatex(e.latex); var a = z(e); return isFinite(a) ? a : NaN } function k(e) { var a = e.cachedViewState; a && _.areDynamicPropertiesStrictEqual(a, e) && a.folderId === e.folderId && a.color === e.color && a.latex === e.latex && a.showLabel === e.showLabel && a.label === e.label && a.hidden === e.hidden && a.secret === e.secret && a.fill === e.fill && a.points === e.points && a.lines === e.lines && a.lineStyle === e.lineStyle && a.pointStyle === e.pointStyle && a.dragMode === e.dragMode && a.labelSize === e.labelSize && a.labelOrientation === e.labelOrientation && a.suppressTextOutline === e.suppressTextOutline && a.interactiveLabel === e.interactiveLabel && a.editableLabelMode === e.editableLabelMode && a.residualVariable === e.residualVariable && a.regressionParameters === e.regressionParameters && a.isLogModeRegression === e.isLogModeRegression && a.displayEvaluationAsFraction === e.displayEvaluationAsFraction && a.slider === e.slider || (e.cachedViewState = i.__assign({ type: e.type, id: e.id, folderId: e.folderId, color: e.color, latex: e.latex, showLabel: e.showLabel, label: e.label, hidden: e.hidden, secret: e.secret, points: e.points, lines: e.lines, lineStyle: e.lineStyle, pointStyle: e.pointStyle, fill: e.fill, dragMode: e.dragMode, labelSize: e.labelSize, labelOrientation: e.labelOrientation, suppressTextOutline: e.suppressTextOutline, interactiveLabel: e.interactiveLabel, editableLabelMode: e.editableLabelMode, residualVariable: e.residualVariable, regressionParameters: e.regressionParameters, isLogModeRegression: e.isLogModeRegression, displayEvaluationAsFraction: e.displayEvaluationAsFraction, slider: e.slider }, _.extractDynamicProperties(e))) } function R(e) { var a, t = e.memoizedUndoRedoStateParams, r = e.cachedViewState, n = e.preTransientState; (e.cachedUndoRedoFullState = r, t && t.viewState === r && t.preTransientState === n) || (e.memoizedUndoRedoStateParams = { viewState: r, preTransientState: n }, delete (a = n ? i.__assign(i.__assign({}, r), { latex: n.latex, slider: i.__assign(i.__assign({}, r.slider), n.slider) }) : i.__assign({}, r)).regressionParameters, delete a.residualVariable, e.cachedUndoRedoDiffState = a) } function U(e) { var i = p.getParentFolderModel(e), a = !(!i || !i.hidden), t = e.cachedViewState, r = e.index, n = e.showLabel && !a, l = e.shouldGraph, o = e.memoizedParsableStateParams; if (!o || o.viewState !== t || o.index !== r || o.showLabel !== n || o.shouldGraph !== l) { e.memoizedParsableStateParams = { viewState: t, index: r, showLabel: n, shouldGraph: l }; var s = _.computeParsableState(t); s.index = r, s.showLabel = n, s.shouldGraph = l, e.cachedParsableState = s } } function G(e) { return !(!e.sliderExists || !e.slider.isPlaying && !e.sliderDragging) || !!e.draggingOnGraphpaper } Object.defineProperty(e, "__esModule", { value: !0 }), e.isPotentiallyMovable = e.blankOutExpressionAfterClearingLatex = e.isClickableAllowed = e.getCDFEvaluation = e.getLabelAngleValue = e.getColorLatexValue = e.isColorLatexValid = e.isLineWidthValid = e.isPointSizeValid = e.isLabelAngleValid = e.isLabelSizeValid = e.isPointOpacityValid = e.isLineOpacityValid = e.isFillOpacityValid = e.isCDFMaxValid = e.isCDFMinValid = e.setCDFMax = e.setCDFMin = e.setShowCDF = e.getCDFMaxPlaceholder = e.getCDFMinPlaceholder = e.getCDFMax = e.getCDFMin = e.shouldShowCDFFooter = e.isListValuedDistribution = e.isPrimaryLatexValid = e.shouldShowCDFCheckbox = e.parseToplevelFunction = e.isDiscreteDistribution = e.isToplevelDistribution = e.isToplevelFunction = e.isStats = e.isTTest = e.isVisualization = e.isHistogram = e.isDotPlot = e.isBoxPlot = e.isPointOrPointList = e.isPointList = e.isSinglePoint = e.isPolar = e.isParametric = e.isRegression = e.isInequality = e.isPolygon = e.hasSlider = e.isNonemptyAction = e.getParametricDomainMax = e.getParametricDomainMin = e.getPolarDomainMax = e.getPolarDomainMin = e.hasDomain = e.areAllVisibilityPropsOff = e.setHidden = e.isDraggableAndHidden = e.hasEditableLabel = e.getEditableLabelMode = e.setEditableLabelMode = e.setInteractiveLabel = e.setSuppressTextOutline = e.setLabelOrientation = e.setLabelAngle = e.setLabelSize = e.setLineStyle = e.setLines = e.setPointStyle = e.setPoints = e.setDragMode = e.setLabelDropdownOpen = e.setColorLatex = e.setLineWidth = e.setPointSize = e.setPointOpacity = e.setLineOpacity = e.setFillOpacity = e.setFill = e.setColor = e.setLogMode = e.setParametricDomainMax = e.setPolarDomainMax = e.setParametricDomainMin = e.setPolarDomainMin = e.setDescription = e.setShowLabel = e.setLabel = e.setEvaluationAsFraction = e.shouldEvaluationDisplayAsFraction = e.setSliderAnimationPeriod = e.setSliderStep = e.setSliderDragging = e.setSliderLoopMode = e.setLatex = e.commitSliderSoftLimits = e.setSliderIsPlaying = e.setSliderMax = e.setSliderMin = e.restoreState = e.onControllerUpdate = e.shouldBlockActionUpdate = e.isTransient = e.getAssignment = e.eachLatex = e.updateCachedParsableState = e.initModel = e.updateCachedUndoRedoState = e.setIsDraggingOnGrapher = e.updateCachedViewState = e.getState = e.isDomainMaxValid = e.isDomainMinValid = e.getDomainMax = e.getDomainMin = e.isSliderStepValid = e.isSliderMaxValid = e.isSliderMinValid = e.needsDotplotXMode = e.isClickableObject = e.setClickableInfoRuleLatex = e.setClickableInfoProp = e.setVizProp = e.getVizProp = e.isVizPropValid = e.isSliderAtEndOfPlayOnce = e.getSliderValue = e.getRawSliderValue = e.getSliderStep = e.getSliderMax = e.getSliderMin = e.getDisplaySliderMax = e.getDisplaySliderMin = e.getDisplayLatex = e.updateDisplayLatex = e.computeShouldGraph = e.onFormulaUpdate = e.getMissingVariables = e.tickSliderStep = e.adjustSliderByDraggingThumb = e.adjustSliderByKeyboard = e.adjustSliderByMovablePoint = e.getSliderSnappedValue = e.computeSliderKeyboardAdjustment = e.computeSliderSnappedValue = e.updateReconciledDragMode = e.isEmpty = e.computeNewSliderLatex = e.getStatsResults = e.getTTestResults = e.getEvaluationValue = e.shouldShowEvaluation = e.isGraphable = e.isRationalizableConstant = e.EvaluationLabelOptions = void 0, e.EvaluationLabelOptions = { smallCutoff: 1e-6, bigCutoff: 1e9, digits: 12 }, e.isRationalizableConstant = h, e.isGraphable = function (e) { return !(!e.formula || !e.formula.is_graphable) }, e.shouldShowEvaluation = y, e.getEvaluationValue = function (e) { var i = e.formula; return y(e) ? i.zero_values && i.zero_values.length ? i.zero_values[0].val : i.rgb_value ? i.rgb_value : i.constant_value : h(e) ? e.formula.constant_value : NaN }, e.getTTestResults = function (e) { var i = e.formula.ttest_results; if (i && isFinite(i.lessThan)) return { lessThan: i.lessThan, greaterThan: i.greaterThan, notEqual: i.notEqual } }, e.getStatsResults = function (e) { var i = e.formula.stats_results; if (i && isFinite(i.min)) return { min: i.min, q1: i.q1, median: i.median, q3: i.q3, max: i.max } }, e.computeNewSliderLatex = P, e.isEmpty = function (e) { return "" === ((e.latex || "") + (e.label || "")).split(" ").join("") }, e.updateReconciledDragMode = T, e.computeSliderSnappedValue = E, e.computeSliderKeyboardAdjustment = V, e.getSliderSnappedValue = function (e, i) { var a = I(e), t = N(e), r = i - a; if (void 0 === t) return i; var n = Math.ceil(Math.abs(r) / t) * t; return r > 0 ? a + n : a - n }, e.adjustSliderByMovablePoint = function (e, i) { if (e.sliderExists) { e.slider.isPlaying && B(e, !1); var a = E(e, i, { ignoreSoftLimits: !0 }); e.latex = P(e.latex, a) } }, e.adjustSliderByKeyboard = function (e, i, a) { if (e.sliderExists) { e.slider.isPlaying && B(e, !1), W(e); var t = V(e, i, a); e.latex = P(e.latex, t) } }, e.adjustSliderByDraggingThumb = function (e, i) { if (e.sliderExists) { e.slider.isPlaying && B(e, !1); var a = E(e, i); e.latex = P(e.latex, a) } }, e.tickSliderStep = function (e, i) { if (e.sliderExists && !e.resetSliderAnimationTargetValue) { var a = e.sliderLastTickTime; if (e.sliderLastTickTime = i, void 0 !== a) { var r = i - a, n = w(e), l = C(e), o = N(e), d = e.slider.animationPeriod, u = e.slider.loopMode; if (isNaN(e.sliderAnimationTargetValue)) { var c = I(e); isNaN(c) || (e.sliderAnimationTargetValue = c) } var p, f, m = o ? o / 2 : 0; if (u === t.SliderLoopMode.LOOP_FORWARD_REVERSE) e.sliderAnimationTargetValue >= l ? q(e, { playDirection: -1 }) : e.sliderAnimationTargetValue <= n && q(e, { playDirection: 1 }); else if (u === t.SliderLoopMode.LOOP_FORWARD) q(e, { playDirection: 1 }), e.sliderAnimationTargetValue >= l + m && (e.sliderAnimationTargetValue = n - m); else if (u === t.SliderLoopMode.PLAY_ONCE) q(e, { playDirection: 1 }); else { if (u !== t.SliderLoopMode.PLAY_INDEFINITELY) throw new Error("Unexpected slider loop mode: " + u); q(e, { playDirection: 1 }) } if (isFinite(r) || (r = 0), u === t.SliderLoopMode.PLAY_INDEFINITELY) p = r / (d / 4), o && (p *= o), e.sliderAnimationTargetValue += p, f = e.sliderAnimationTargetValue, o || (f = s.shortestDecimalBetween(f - .1 * p, f + .1 * p)), f = E(e, f, { ignoreSoftLimits: !0 }), e.latex = P(e.latex, f); else { if (p = (l - n) * (r = Math.min(r, d / 10)) / d, e.sliderAnimationTargetValue += p * e.slider.playDirection, e.sliderAnimationTargetValue = Math.max(n - m, Math.min(l + m, e.sliderAnimationTargetValue)), f = e.sliderAnimationTargetValue, !o) { var g = p / r * (1e3 / 60); f = s.shortestDecimalBetween(f - .1 * g, f + .1 * g) } f = E(e, f), e.latex = P(e.latex, f) } } } }, e.getMissingVariables = function (e) { var i = e.formula; return i ? i.is_single_identifier ? [] : i.variables || [] : [] }, e.onFormulaUpdate = function (e, i) { e.formula = i, e.error = i.error, e.unresolved = !1, i.is_slider ? e.sliderExists && !e.resetSliderAnimationTargetValue || (e.sliderAnimationTargetValue = I(e), e.sliderDragging = !1, e.sliderExists = !0) : e.sliderExists = !1, e.resetSliderAnimationTargetValue = !1; var a = {}; i.is_regression && (a = i.regression.parameters, e.residualVariable = i.regression.residualVariable, e.controller.areLogModeRegressionsForced() && (e.isLogModeRegression = !0)), f.isEqual(e.regressionParameters, a) || (e.regressionParameters = a) }, e.computeShouldGraph = F, e.updateDisplayLatex = A, e.getDisplayLatex = function (e) { return e.cachedDisplayLatex.valueLatex }, e.getDisplaySliderMin = function (e) { return e.slider.hardMin ? e.slider.min : O(w(e)) }, e.getDisplaySliderMax = function (e) { return e.slider.hardMax ? e.slider.max : O(C(e)) }, e.getSliderMin = w, e.getSliderMax = C, e.getSliderStep = N, e.getRawSliderValue = z, e.getSliderValue = I, e.isSliderAtEndOfPlayOnce = function (e) { return e.slider.loopMode === t.SliderLoopMode.PLAY_ONCE && I(e) >= C(e) }, e.isVizPropValid = function (e, i) { return !!e.formula.viz_valids && !!e.formula.viz_valids[i] }, e.getVizProp = function (e, i) { return e.vizProps[i] }, e.setVizProp = function (e, a, t) { var r; e.vizProps = i.__assign(i.__assign({}, e.vizProps), ((r = {})[a] = t, r)) }, e.setClickableInfoProp = function (e, a, t) { var r; e.clickableInfo = i.__assign(i.__assign({}, e.clickableInfo), ((r = {})[a] = t, r)) }, e.setClickableInfoRuleLatex = function (e, a) { e.clickableInfo = i.__assign(i.__assign({}, e.clickableInfo), { latex: a }) }, e.isClickableObject = function (e) { return !!(e.clickableInfo.enabled && le(e) && e.formula.click_handler && "maybe-valid" === e.formula.click_handler.status) }, e.needsDotplotXMode = function (e) { return !!e.__workerNeedsDotplotXMode }, e.isSliderMinValid = function (e) { return !(!e.formula || !e.formula.slider_min_valid) }, e.isSliderMaxValid = function (e) { return !(!e.formula || !e.formula.slider_max_valid) }, e.isSliderStepValid = function (e) { return !(!e.formula || !e.formula.slider_step_valid) }, e.getDomainMin = function (e) { if (!e.formula) return NaN; if (isFinite(e.__workerSampledDomainMin)) return e.__workerSampledDomainMin; var i = e.formula.domain_min_number; return isFinite(i) ? i : NaN }, e.getDomainMax = function (e) { if (!e.formula) return NaN; if (isFinite(e.__workerSampledDomainMax)) return e.__workerSampledDomainMax; var i = e.formula.domain_max_number; return isFinite(i) ? i : NaN }, e.isDomainMinValid = function (e) { return !(!e.formula || !e.formula.domain_min_valid) }, e.isDomainMaxValid = function (e) { return !(!e.formula || !e.formula.domain_max_valid) }, e.getState = function (e, a) { var t = e.cachedViewState; if (a.stripDefaults && "" === e.parametricDomain.min && "" === e.parametricDomain.max || (t = i.__assign(i.__assign({}, t), { domain: { min: "" === e.parametricDomain.min ? "0" : e.parametricDomain.min, max: "" === e.parametricDomain.max ? "1" : e.parametricDomain.max } })), a.stripDefaults) return _.stripDefaults(t); if (void 0 === t.points || void 0 === t.lines || void 0 === t.fill) { var r = d.default(t); return void 0 === r.points && delete r.points, void 0 === r.lines && delete r.lines, void 0 === r.fill && delete r.fill, r } return t }, e.updateCachedViewState = k, e.setIsDraggingOnGrapher = function (e, i) { i && W(e), e.draggingOnGraphpaper = i }, e.updateCachedUndoRedoState = R, e.initModel = function (e, a) { var t = d.default(_.inflateDefaults(e)), r = t.color; return r && v.default(r) || (r = a.getNextColor()), i.__assign(i.__assign(i.__assign({}, t), c.DEFAULTS(a)), { labelDropdownOpen: !1, formula: { error: void 0, operator: "=", variables: [] }, error: void 0, unresolved: !1, color: r, pointStyle: t.pointStyle, lineStyle: t.lineStyle, displayEvaluationAsFraction: t.displayEvaluationAsFraction, shouldGraph: void 0, sliderDragging: void 0, sliderAnimationTargetValue: void 0, resetSliderAnimationTargetValue: !1, sliderLastTickTime: void 0, draggingOnGraphpaper: !1, cachedUndoRedoDiffState: void 0, cachedUndoRedoFullState: void 0, cachedParsableState: void 0, cachedViewState: void 0, cachedDisplayLatex: { storedLatex: "", valueLatex: "" } }) }, e.updateCachedParsableState = U, e.eachLatex = function (e, i) { i(e.latex, "latex", e), i(e.clickableInfo.latex, "clickableInfoLatex", e), i(e.lineWidth, "lineWidth", e), i(e.fillOpacity, "fillOpacity", e), i(e.lineOpacity, "lineOpacity", e), i(e.pointOpacity, "pointOpacity", e), i(e.pointSize, "pointSize", e), i(e.labelAngle, "labelAngle", e), e.labelSize !== n.LabelSize.MEDIUM && e.labelSize !== n.LabelSize.SMALL && e.labelSize !== n.LabelSize.LARGE && i(e.labelSize, "labelSize", e), $(e) && (i(e.parametricDomain.min, "parametricDomainMin", e), i(e.parametricDomain.max, "parametricDomainMax", e)), J(e) && (i(e.polarDomain.min, "polarDomainMin", e), i(e.polarDomain.max, "polarDomainMax", e)), e.sliderExists && (i(e.slider.min, "sliderMin", e), i(e.slider.max, "sliderMax", e), i(e.slider.step, "sliderStep", e)), e.residualVariable && i(e.residualVariable, "residualVariable", e) }, e.getAssignment = function (e) { return e.formula && e.formula.assignment }, e.isTransient = G, e.shouldBlockActionUpdate = function (e) { return !(!e.sliderExists || !e.sliderDragging) || !!e.draggingOnGraphpaper }, e.onControllerUpdate = function (e) { G(e) ? e.preTransientState || (e.preTransientState = { latex: e.latex, slider: { min: e.slider.min, max: e.slider.max, playDirection: e.slider.playDirection } }) : delete e.preTransientState, e.sliderExists && e.slider.isPlaying || (e.sliderLastTickTime = void 0), c.updateIsHiddenFromUI(e), F(e), T(e), k(e), R(e), U(e), A(e) }; var j = i.__assign({ id: !1, type: !1, color: !0, folderId: !0, latex: !0, showLabel: !0, label: !0, hidden: !0, secret: !0, points: !0, lines: !0, lineStyle: !0, pointStyle: !0, fill: !0, dragMode: !0, labelSize: !0, labelOrientation: !0, suppressTextOutline: !0, interactiveLabel: !0, editableLabelMode: !0, residualVariable: !0, regressionParameters: !0, isLogModeRegression: !0, displayEvaluationAsFraction: !0, slider: !0 }, u.makeTrueMap(_.DEFAULTS_DYNAMIC)); function q(e, a) { e.slider = i.__assign(i.__assign({}, e.slider), a) } function B(e, i) { e && (e.slider.isPlaying !== i && (q(e, { isPlaying: i }), i && (W(e), e.sliderAnimationTargetValue = I(e)))) } function W(e) { if (!e.slider.hardMin) { var i = x.default(w(e)); i !== e.slider.min && q(e, { min: i }) } if (!e.slider.hardMax) { var a = x.default(C(e)); a !== e.slider.max && q(e, { max: a }) } } function Y(e) { return e.displayEvaluationAsFraction } function H(e, i) { e.interactiveLabel = i } function K(e) { if (X(e)) return !1; var i = e.points, a = e.lines, t = e.fill, r = m.getReconciledExpressionProps(e.formula.expression_type, { points: i, lines: a, fill: t }); return !r.points && !r.lines && !r.fill } function X(e) { return !!e.formula.is_inequality } function $(e) { return e.formula.expression_type === m.ExpressionType.PARAMETRIC } function J(e) { return e.formula.expression_type === m.ExpressionType.POLAR } function Q(e) { var i = ae(e); return !(!i || "visualization" !== i.type || "boxplot" !== i.symbol) } function Z(e) { var i = ae(e); return !(!i || "visualization" !== i.type || "dotplot" !== i.symbol) } function ee(e) { var i = ae(e); return !(!i || "visualization" !== i.type || "histogram" !== i.symbol) } function ie(e) { var i = ae(e); return !(!i || "distribution" !== i.type) } function ae(e) { if (e.controller.areDistributionsEnabled() && e.latex) return e.cachedParseToplevelFunction && e.cachedParseToplevelFunction.latex === e.latex || (e.cachedParseToplevelFunction = { latex: e.latex, spec: D.parseToplevelFunction(e.latex) }), e.cachedParseToplevelFunction.spec } function te(e) { return re(e) && ie(e) } function re(e) { return !!e.formula.expression_type } function ne(e) { return !!e.formula.is_concrete_list } function le(e) { return !!m.isClickableExpressionType(e.formula.expression_type) && (!e.reconciledDragMode || e.reconciledDragMode === a.DragMode.NONE) } e.restoreState = function (e, i) { u.copyProperties({ from: i, to: e, props: j }), e.resetSliderAnimationTargetValue = !0, e.sliderAnimationTargetValue = void 0 }, e.setSliderMin = function (e, i) { q(e, i ? { hardMin: !0, min: i } : { hardMin: !1, min: "-10" }) }, e.setSliderMax = function (e, i) { q(e, i ? { hardMax: !0, max: i } : { hardMax: !1, max: "10" }) }, e.setSliderIsPlaying = B, e.commitSliderSoftLimits = W, e.setLatex = function (e, i) { var a = M.extractSliderValueFromLatex(i); if (isFinite(a)) { var t = b.determineWhichLimitsAreCompatibleWithValue({ target: a, step: N(e), hardMin: e.slider.hardMin ? w(e) : void 0, hardMax: e.slider.hardMax ? C(e) : void 0 }); t.min || q(e, { hardMin: !1, min: "-10" }), t.max || q(e, { hardMax: !1, max: "10" }), t.step || q(e, { step: "" }) } e.latex = i }, e.setSliderLoopMode = function (e, i) { q(e, { loopMode: i, playDirection: 1 }), i === t.SliderLoopMode.PLAY_INDEFINITELY && q(e, { hardMin: !1, hardMax: !1, min: "", max: "" }), e.sliderAnimationTargetValue = w(e) }, e.setSliderDragging = function (e, i) { i && W(e), e.sliderDragging = i }, e.setSliderStep = function (e, i) { q(e, { step: i }) }, e.setSliderAnimationPeriod = function (e, i) { q(e, { animationPeriod: i }) }, e.shouldEvaluationDisplayAsFraction = Y, e.setEvaluationAsFraction = function (e, i) { e.displayEvaluationAsFraction = i }, e.setLabel = function (e, i) { e.label = i }, e.setShowLabel = function (e, i) { e.showLabel = i }, e.setDescription = function (e, i) { e.description = i }, e.setPolarDomainMin = function (e, a) { e.polarDomain = i.__assign(i.__assign({}, e.polarDomain), { min: a }) }, e.setParametricDomainMin = function (e, a) { e.parametricDomain = i.__assign(i.__assign({}, e.parametricDomain), { min: a }) }, e.setPolarDomainMax = function (e, a) { e.polarDomain = i.__assign(i.__assign({}, e.polarDomain), { max: a }) }, e.setParametricDomainMax = function (e, a) { e.parametricDomain = i.__assign(i.__assign({}, e.parametricDomain), { max: a }) }, e.setLogMode = function (e, i) { e.isLogModeRegression = i }, e.setColor = function (e, i) { v.default(i) && (e.color = i, e.colorLatex = "") }, e.setFill = function (e, i) { e.fill = i }, e.setFillOpacity = function (e, i) { e.fillOpacity !== i && (e.fillOpacity = i) }, e.setLineOpacity = function (e, i) { e.lineOpacity !== i && (e.lineOpacity = i) }, e.setPointOpacity = function (e, i) { e.pointOpacity !== i && (e.pointOpacity = i) }, e.setPointSize = function (e, i) { e.pointSize !== i && (e.pointSize = i) }, e.setLineWidth = function (e, i) { e.lineWidth !== i && (e.lineWidth = i) }, e.setColorLatex = function (e, i) { e.colorLatex !== i && (e.colorLatex = i) }, e.setLabelDropdownOpen = function (e, i) { e.labelDropdownOpen = i }, e.setDragMode = function (e, i) { e.dragMode !== i && (e.dragMode = i) }, e.setPoints = function (e, i) { e.points = i }, e.setPointStyle = function (e, i) { e.pointStyle !== i && (e.pointStyle = i, i !== r.PointStyle.POINT && (e.dragMode = a.DragMode.NONE)) }, e.setLines = function (e, i) { e.lines = i }, e.setLineStyle = function (e, i) { e.lineStyle !== i && (e.lineStyle = i) }, e.setLabelSize = function (e, i) { e.labelSize = i }, e.setLabelAngle = function (e, i) { e.labelAngle = i }, e.setLabelOrientation = function (e, i) { e.labelOrientation = i }, e.setSuppressTextOutline = function (e, i) { e.suppressTextOutline = i }, e.setInteractiveLabel = H, e.setEditableLabelMode = function (e, i) { e.editableLabelMode = i }, e.getEditableLabelMode = function (e) { return e.editableLabelMode }, e.hasEditableLabel = function (e) { var i = e.editableLabelMode; return i === _.EditableLabelMode.Math || i === _.EditableLabelMode.Text }, e.isDraggableAndHidden = function (e) { return !(e.reconciledDragMode === a.DragMode.NONE || !e.hidden) }, e.setHidden = function (e, i) { e.hidden = i, !i && K(e) && (e.lines = e.points = e.fill = void 0) }, e.areAllVisibilityPropsOff = K, e.hasDomain = function (e) { return $(e) || J(e) }, e.getPolarDomainMin = function (e) { return e.polarDomain.min }, e.getPolarDomainMax = function (e) { return e.polarDomain.max }, e.getParametricDomainMin = function (e) { return e.parametricDomain.min }, e.getParametricDomainMax = function (e) { return e.parametricDomain.max }, e.isNonemptyAction = function (e) { return !!e.formula.action_value && Object.keys(e.formula.action_value).length > 0 }, e.hasSlider = function (e) { return !!e.sliderExists }, e.isPolygon = function (e) { return e.formula.expression_type === m.ExpressionType.POLYGON }, e.isInequality = X, e.isRegression = function (e) { return !!e.formula.is_regression }, e.isParametric = $, e.isPolar = J, e.isSinglePoint = function (e) { return e.formula.expression_type === m.ExpressionType.SINGLE_POINT }, e.isPointList = function (e) { return e.formula.expression_type === m.ExpressionType.POINT_LIST }, e.isPointOrPointList = function (e) { return e.formula.expression_type === m.ExpressionType.POINT_LIST || e.formula.expression_type === m.ExpressionType.SINGLE_POINT }, e.isBoxPlot = Q, e.isDotPlot = Z, e.isHistogram = ee, e.isVisualization = function (e) { return Q(e) || Z(e) || ee(e) }, e.isTTest = function (e) { return e.formula.expression_type === m.ExpressionType.TTEST }, e.isStats = function (e) { return e.formula.expression_type === m.ExpressionType.STATS }, e.isToplevelFunction = function (e) { return !!ae(e) }, e.isToplevelDistribution = ie, e.isDiscreteDistribution = function (e) { var i = e.formula; return !!i && !!i.is_discrete_distribution }, e.parseToplevelFunction = ae, e.shouldShowCDFCheckbox = te, e.isPrimaryLatexValid = re, e.isListValuedDistribution = ne, e.shouldShowCDFFooter = function (e) { return !!te(e) && (!ne(e) && e.cdf.show) }, e.getCDFMin = function (e) { return e.cdf.min }, e.getCDFMax = function (e) { return e.cdf.max }, e.getCDFMinPlaceholder = function (e) { var i = L(e.formula.cdf_min_default); return i === -1 / 0 ? "-\\infty" : isFinite(i) ? i + "" : "-\\infty" }, e.getCDFMaxPlaceholder = function (e) { var i = L(e.formula.cdf_max_default); return i === 1 / 0 ? "\\infty" : isFinite(i) ? i + "" : "\\infty" }, e.setShowCDF = function (e, a) { e.cdf = i.__assign(i.__assign({}, e.cdf), { show: a }) }, e.setCDFMin = function (e, a) { e.cdf = i.__assign(i.__assign({}, e.cdf), { min: a }) }, e.setCDFMax = function (e, a) { e.cdf = i.__assign(i.__assign({}, e.cdf), { max: a }) }, e.isCDFMinValid = function (e) { return !!e.formula && !1 !== e.formula.cdf_min_valid }, e.isCDFMaxValid = function (e) { return !!e.formula && !1 !== e.formula.cdf_max_valid }, e.isFillOpacityValid = function (e) { return !!e.formula && !1 !== e.formula.fill_opacity_valid }, e.isLineOpacityValid = function (e) { return !!e.formula && !1 !== e.formula.line_opacity_valid }, e.isPointOpacityValid = function (e) { return !!e.formula && !1 !== e.formula.point_opacity_valid }, e.isLabelSizeValid = function (e) { return !!e.formula && !1 !== e.formula.label_size_valid }, e.isLabelAngleValid = function (e) { return !!e.formula && !1 !== e.formula.label_angle_valid }, e.isPointSizeValid = function (e) { return !!e.formula && !1 !== e.formula.point_size_valid }, e.isLineWidthValid = function (e) { return !!e.formula && !1 !== e.formula.line_width_valid }, e.isColorLatexValid = function (e) { return !!e.formula && !1 !== e.formula.color_latex_valid }, e.getColorLatexValue = function (e) { return e.formula && e.formula.color_latex_value }, e.getLabelAngleValue = function (e) { return e.formula && e.formula.label_angle_value }, e.getCDFEvaluation = function (e) { var i = e.formula && e.formula.cdf_evaluation; return isFinite(i) ? i : 0 }, e.isClickableAllowed = le, e.blankOutExpressionAfterClearingLatex = function (e) { e.showLabel = _.DEFAULTS.showLabel, e.label = _.DEFAULTS.label, e.hidden = _.DEFAULTS.hidden, e.dragMode = _.DEFAULTS.dragMode, e.fill = _.DEFAULTS.fill, e.points = _.DEFAULTS.points, e.pointStyle = _.DEFAULTS.pointStyle, e.lines = _.DEFAULTS.lines, e.lineStyle = _.DEFAULTS.lineStyle, e.slider = _.SLIDER_DEFAULTS, e.latex = "", e.labelSize = n.LabelSize.MEDIUM, e.labelOrientation = l.LabelOrientation.DEFAULT, e.displayEvaluationAsFraction = _.DEFAULTS.displayEvaluationAsFraction, e.suppressTextOutline = !1, e.interactiveLabel = !1, e.editableLabelMode = _.DEFAULTS.editableLabelMode, u.copyAllProperties(_.DEFAULTS_DYNAMIC, e) }, e.isPotentiallyMovable = function (e) { return !!e.formula.move_strategy } });
define('core/graphing-calc/json/folder', ["require", "exports", "tslib", "core/lib/default-spec"], function (require, e, t, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.stripDefaults = e.inflateDefaults = e.DEFAULTS = void 0, e.DEFAULTS = { collapsed: !1, hidden: !1, secret: !1, title: "" }, e.inflateDefaults = function (s) { return t.__assign(t.__assign({}, e.DEFAULTS), s) }, e.stripDefaults = function (t) { return s.stripDefaults(e.DEFAULTS, t) } });
define('graphing-calc/models/folder', ["require", "exports", "tslib", "core/lib/deepCopy", "core/lib/copy-properties", "./abstract-item", "./list", "core/graphing-calc/json/folder"], function (require, e, t, d, i, l, o, a) { "use strict"; function c(e) { e.cachedViewState = { type: e.type, id: e.id, title: e.title, hidden: e.hidden, collapsed: e.collapsed, secret: e.secret } } function n(e) { e.cachedUndoRedoDiffState = e.cachedViewState, e.cachedUndoRedoFullState = e.cachedViewState } Object.defineProperty(e, "__esModule", { value: !0 }), e.setHidden = e.setTitle = e.setCollapsed = e.updateSelectedHiddenChild = e.restoreState = e.onControllerUpdate = e.initModel = e.updateCachedUndoRedoState = e.updateCachedViewState = e.getState = void 0, e.getState = function (e, t) { var d = e.cachedViewState; return t.stripDefaults ? a.stripDefaults(d) : d }, e.updateCachedViewState = c, e.updateCachedUndoRedoState = n, e.initModel = function (e, i) { var o = d.default(a.inflateDefaults(e)); return t.__assign(t.__assign(t.__assign({}, o), l.DEFAULTS(i)), { cachedUndoRedoDiffState: {}, cachedUndoRedoFullState: {}, cachedViewState: {} }) }, e.onControllerUpdate = function (e) { r(e), l.updateIsHiddenFromUI(e), c(e), n(e) }; var s = { id: !1, type: !1, hidden: !0, secret: !0, collapsed: !0, title: !0 }; function r(e) { var t = e.controller, d = t.getSelectedItem(); e.collapsed ? d && "folder" !== d.type && d.folderId === e.id && "none" === l.getDisplayState(d) ? (e.selectedHiddenChild = d, o.setSelected(t.getListModel(), e)) : d !== e && (e.selectedHiddenChild = void 0) : (d === e && e.selectedHiddenChild && o.setSelected(t.getListModel(), e.selectedHiddenChild), e.selectedHiddenChild = void 0) } e.restoreState = function (e, t) { i.copyProperties({ from: t, to: e, props: s }) }, e.updateSelectedHiddenChild = r, e.setCollapsed = function (e, t) { e.collapsed = t }, e.setTitle = function (e, t) { e.title = t }, e.setHidden = function (e, t) { e.hidden = t } });
define('core/graphing-calc/json/text', ["require", "exports", "tslib", "core/lib/default-spec"], function (require, e, t, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.stripDefaults = e.inflateDefaults = e.DEFAULTS = void 0, e.DEFAULTS = { folderId: "", text: "", secret: !1 }, e.inflateDefaults = function (s) { return t.__assign(t.__assign({}, e.DEFAULTS), s) }, e.stripDefaults = function (t) { return s.stripDefaults(e.DEFAULTS, t) } });
define('graphing-calc/models/text', ["require", "exports", "tslib", "./abstract-item", "core/lib/deepCopy", "core/lib/copy-properties", "core/graphing-calc/json/text"], function (require, e, t, a, d, o, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.updateCachedUndoRedoState = e.updateCachedViewState = e.getState = e.restoreState = e.onControllerUpdate = e.initModel = e.setText = void 0, e.setText = function (e, t) { e.text = t }, e.initModel = function (e, o) { var i = d.default(c.inflateDefaults(e)); return t.__assign(t.__assign(t.__assign({}, i), a.DEFAULTS(o)), { cachedUndoRedoDiffState: {}, cachedUndoRedoFullState: {}, cachedViewState: {} }) }, e.onControllerUpdate = function (e) { a.updateIsHiddenFromUI(e), r(e), n(e) }; var i = { id: !1, type: !1, folderId: !0, text: !0, secret: !0 }; function r(e) { e.cachedViewState = { type: e.type, id: e.id, folderId: e.folderId, text: e.text, secret: e.secret } } function n(e) { e.cachedUndoRedoDiffState = e.cachedViewState, e.cachedUndoRedoFullState = e.cachedViewState } e.restoreState = function (e, t) { o.copyProperties({ from: t, to: e, props: i }) }, e.getState = function (e, t) { var a = e.cachedViewState; return t.stripDefaults ? c.stripDefaults(a) : a }, e.updateCachedViewState = r, e.updateCachedUndoRedoState = n });
define('graphing-calc/models/helper-expression', ["require", "exports", "core/math/evaluationstate", "tslib", "underscore", "core/math/evaluationstate"], function (require, e, t, a, u, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.onFormulaUpdate = e.init = e.getGUID = void 0; var r = 0; function l() { return "helper_item_" + r++ } e.getGUID = l, e.init = function (e) { return a.__assign(a.__assign({}, e), { formula: i.defaultEvaluationState(), guid: l(), cachedParsableState: { type: "statement", id: e.id, latex: e.latex, shouldGraph: !1 } }) }, e.onFormulaUpdate = function (e, t, a) { t.formula = a; var i, r = t.proxy, l = { numericValue: r.numericValue, listValue: r.listValue }; a.zero_values && 1 === a.zero_values.length && (i = a.zero_values[0].val), r.numericValue = u.isNumber(i) ? i : NaN, r.listValue = u.isArray(i) ? i.slice(0) : void 0, u.isEqual(r.numericValue, l.numericValue) || e.runAfterDispatch(function () { r.notifyPropertyChange("numericValue") }), u.isEqual(r.listValue, l.listValue) || e.runAfterDispatch(function () { r.notifyPropertyChange("listValue") }) } });
define('core/graphing-calc/json/image', ["require", "exports", "tslib", "core/lib/default-spec", "../../lib/copy-properties"], function (require, e, t, i, a) { "use strict"; function n(t) { return a.extractPropertiesLike(t, e.DEFAULTS_DYNAMIC) } Object.defineProperty(e, "__esModule", { value: !0 }), e.computeParsableState = e.extractDynamicProperties = e.stripDefaults = e.inflateDefaults = e.DEFAULTS = e.DEFAULTS_DYNAMIC = e.CLICKABLEINFO_DEFAULTS = void 0, e.CLICKABLEINFO_DEFAULTS = { enabled: !1, latex: "", hoveredImage: "", depressedImage: "" }, e.DEFAULTS_DYNAMIC = { center: "\\left(0,0\\right)", angle: "0", width: "10", height: "10", opacity: "1", clickableInfo: e.CLICKABLEINFO_DEFAULTS, description: "", draggable: !1 }, e.DEFAULTS = t.__assign({ folderId: "", hidden: !1, secret: !1, foreground: !1, name: "" }, e.DEFAULTS_DYNAMIC), e.inflateDefaults = function (i) { return t.__assign(t.__assign(t.__assign({}, e.DEFAULTS), i), { clickableInfo: t.__assign(t.__assign({}, e.CLICKABLEINFO_DEFAULTS), i.clickableInfo) }) }, e.stripDefaults = function (t) { var a = i.stripDefaults(e.DEFAULTS, t), n = i.stripDefaultsAndMaybeReturnUndefined(e.CLICKABLEINFO_DEFAULTS, t.clickableInfo); return void 0 === n ? delete a.clickableInfo : a.clickableInfo = n, a }, e.extractDynamicProperties = n, e.computeParsableState = function (e) { return t.__assign(t.__assign({ type: "image", id: e.id }, n(e)), { guid: "", index: 0, color: "", shouldGraph: e.hidden, showPoints: !1 }) } });
define('graphing-calc/models/image', ["require", "exports", "tslib", "core/lib/color-helpers", "./abstract-item", "core/lib/deepCopy", "core/lib/copy-properties", "./list", "jquery", "core/graphing-calc/json/image", "core/lib/dragmode", "./expression"], function (require, e, a, r, t, n, o, i, l, d, c, s) { "use strict"; function g(e) { if (e.formula) { var a = e.formula.center_reference_id, r = e.formula.center_reference_symbol; if (a && r) { var t = e.controller.getItemModel(a); if (t && "expression" === t.type && t.formula.assignment === r && s.isSinglePoint(t)) return t } } } function u(e) { var a = g(e); if (!a) return !1; var r = a.reconciledDragMode; return !(!r || r === c.DragMode.NONE) } function f(e) { return !!e.draggable && u(e) } function m(e) { var a = d.computeParsableState(e); a.color = e.color, a.index = e.index, a.guid = e.guid, a.shouldGraph = e.shouldGraph, a.showPoints = e.showPoints, e.cachedParsableState = a } function p(e) { var r = e.cachedViewState.clickableInfo, t = !0, n = !0; if (r && (r.depressedImage === e.clickableInfo.depressedImage && (n = !1), r.hoveredImage === e.clickableInfo.hoveredImage && (t = !1)), t && (e.hoveredImageObj && (l(e.hoveredImageObj).off("load"), delete e.hoveredImageObj), e.clickableInfo.hoveredImage)) { e.hoveredImageObj = new Image; var o = function () { var a = e.controller.getGrapher(); a && a.redrawAllLayers() }, i = function () { }; b(e.hoveredImageObj, e.clickableInfo.hoveredImage, o, i) } if (n && (e.depressedImageObj && (l(e.depressedImageObj).off("load"), delete e.depressedImageObj), e.clickableInfo.depressedImage)) { e.depressedImageObj = new Image; o = function () { var a = e.controller.getGrapher(); a && a.redrawAllLayers() }, i = function () { }; b(e.depressedImageObj, e.clickableInfo.depressedImage, o, i) } if (e.cachedViewState.image_url !== e.image_url) { l(e.imageObj).off("load"), e.imageObj = new Image; b(e.imageObj, e.image_url, function () { e.controller.dispatch({ type: "image-load-success", id: e.id }) }, function () { e.controller.dispatch({ type: "image-load-error", id: e.id }) }) } e.cachedViewState = a.__assign({ type: e.type, id: e.id, folderId: e.folderId, image_url: e.image_url, name: e.name, hidden: e.hidden, foreground: e.foreground, secret: e.secret }, d.extractDynamicProperties(e)) } function h(e) { var r = e.cachedViewState; e.cachedUndoRedoFullState = e.cachedViewState, e.preTransientState && (r = a.__assign(a.__assign({}, r), e.preTransientState)), e.cachedUndoRedoDiffState = r } function b(e, a, r, t) { l(e).on("load.initial-image-load", function () { var a = e.width, t = e.height; 1 === a && 1 === t ? (l(e).off(".initial-image-load"), l(e).on("load", r), e.src = function (e) { var a = document.createElement("canvas"); return a.width = 2, a.height = 2, a.getContext("2d").drawImage(e, 0, 0, 2, 2), a.toDataURL() }(e)) : r() }).on("error", t), /^data:/.test(a) || (e.crossOrigin = "anonymous"), e.src = a } Object.defineProperty(e, "__esModule", { value: !0 }), e.isClickableObject = e.setClickableInfoRuleLatex = e.setClickableInfoProp = e.retryLoading = e.setLoadStatus = e.uploadImageAndGenerateToken = e.uploadImages = e.restoreState = e.initModel = e.updateCachedUndoRedoState = e.setIsDraggingOnGrapher = e.updateCachedViewState = e.getState = e.hasInputError = e.getMissingVariables = e.onFormulaUpdate = e.onControllerUpdate = e.updateCachedParsableState = e.eachLatex = e.setImageURL = e.setForeground = e.setOpacity = e.canConvertToDraggableImage = e.isActuallyDraggable = e.doesImageCenterReferenceDraggablePoint = e.doesImageCenterReferenceExternalPoint = e.getCenterExternalReferencedModel = e.setDraggable = e.setName = e.setDescription = e.getMQAttribute = e.setMQAttribute = e.setSecret = e.setHidden = void 0, e.setHidden = function (e, a) { e.hidden = a }, e.setSecret = function (e, a) { e.secret = a }, e.setMQAttribute = function (e, a, r) { e[a] = r }, e.getMQAttribute = function (e, a) { return e[a] }, e.setDescription = function (e, a) { e.description = a }, e.setName = function (e, a) { e.name = a }, e.setDraggable = function (e, a) { e.draggable = a }, e.getCenterExternalReferencedModel = g, e.doesImageCenterReferenceExternalPoint = function (e) { return !!g(e) }, e.doesImageCenterReferenceDraggablePoint = u, e.isActuallyDraggable = f, e.canConvertToDraggableImage = function (e) { if (!e.formula) return !1; if (!e.formula.center_is_point_literal) return !1; var a = e.formula.move_strategy; if (!a) return !1; var r = a[2], t = a[3], n = r && "none" !== r.type, o = t && "none" !== t.type; return !(!n && !o) }, e.setOpacity = function (e, a) { e.opacity = a }, e.setForeground = function (e, a) { e.foreground = a }, e.setImageURL = function (e, a) { e.image_url = a }, e.eachLatex = function (e, a) { a(e.opacity, "imageOpacity", e), a(e.center, "imageCenter", e), a(e.height, "imageHeight", e), a(e.width, "imageWidth", e), a(e.angle, "imageAngle", e) }, e.updateCachedParsableState = m, e.onControllerUpdate = function (e) { e.draggingOnGraphpaper ? e.preTransientState || (e.preTransientState = { center: e.center, width: e.width, height: e.height }) : delete e.preTransientState, t.updateIsHiddenFromUI(e); var a = i.getParentFolderModel(e); e.shouldGraph = (!a || !a.hidden) && !e.hidden, e.showPoints = e.shouldGraph && i.isItemSelected(e) && "loaded" === e.loadStatus && !f(e) && e.controller.isTraceEnabled(), p(e), h(e), m(e) }, e.onFormulaUpdate = function (e, a) { e.formula = a, e.error = function (e) { var a = { center: e.controller.s("graphing-calculator-error-image-invalid-center"), angle: e.controller.s("graphing-calculator-error-image-invalid-angle"), width: e.controller.s("graphing-calculator-error-image-invalid-width"), height: e.controller.s("graphing-calculator-error-image-invalid-height"), opacity: e.controller.s("graphing-calculator-error-image-invalid-opacity") }; for (var r in e.formula.errorMap) { if (e.formula.errorMap[r]) return a[r] } }(e) }, e.getMissingVariables = function (e) { return e.formula && e.formula.variables || [] }, e.hasInputError = function (e, a) { return !(!e.formula || !e.formula.errorMap) && !!e.formula.errorMap[a] }, e.getState = function (e, a) { var r = e.cachedViewState; return a.stripDefaults ? d.stripDefaults(r) : r }, e.updateCachedViewState = p, e.setIsDraggingOnGrapher = function (e, a) { e.draggingOnGraphpaper = a }, e.updateCachedUndoRedoState = h, e.initModel = function (e, o) { var i = n.default(d.inflateDefaults(e)); return a.__assign(a.__assign(a.__assign({}, i), t.DEFAULTS(o)), { color: r.colors.BLUE, loadStatus: "loading", failures: 0, imageObj: new Image, hoveredImageObj: void 0, depressedImageObj: void 0, shouldGraph: void 0, showPoints: void 0, error: void 0, formula: void 0, draggingOnGraphpaper: !1, cachedViewState: {}, cachedParsableState: {}, cachedUndoRedoDiffState: {}, cachedUndoRedoFullState: {} }) }; var I = a.__assign({ id: !1, type: !1, image_url: !0, name: !0, folderId: !0, hidden: !0, secret: !0, foreground: !0 }, o.makeTrueMap(d.DEFAULTS_DYNAMIC)); e.restoreState = function (e, a) { o.copyProperties({ from: a, to: e, props: I }) }, e.uploadImages = function (e) { for (var a = e.controller, r = e.files, t = e.id, n = { errors: [], tokens: [] }, o = 0; o < r.length; o++) { var i = r[o]; i.type.match("image/*") ? n.tokens.push(_({ controller: a, file: i, id: t })) : n.errors.push(a.s("graphing-calculator-error-image-invalid-file", { file: i.name })) } return n }; var v = 0; function _(e) { var a = e.controller, r = e.file, t = e.id, n = "" + v++; return a.getGraphSettings().config.imageUploadCallback(r, function (e, o) { setTimeout(function () { if (e) a.dispatch({ type: "image-upload-error", token: n, error: e }); else { var i = new Image; b(i, o, function () { var e = i.width, l = i.height, d = Math.max(e, l) / Math.min(e, l); e < l ? (l = 10, e = Math.round(10 * l / d) / 10) : (e = 10, l = Math.round(10 * e / d) / 10), a.dispatch({ type: "image-upload-success", token: n, url: o, width: e + "", height: l + "", name: r.name, id: t }) }, function () { a.dispatch({ type: "image-upload-error", token: n, error: "" }) }) } }) }), n } function S(e, a) { e.loadStatus = a, "loaded" === a && (e.failures = 0), "failed" === a && (e.failures += 1) } e.uploadImageAndGenerateToken = _, e.setLoadStatus = S, e.retryLoading = function (e) { e.imageObj.src = e.imageObj.src, S(e, "loading") }, e.setClickableInfoProp = function (e, r, t) { var n; e.clickableInfo = a.__assign(a.__assign({}, e.clickableInfo), ((n = {})[r] = t, n)) }, e.setClickableInfoRuleLatex = function (e, r) { e.clickableInfo = a.__assign(a.__assign({}, e.clickableInfo), { latex: r }) }, e.isClickableObject = function (e) { return !!(e.clickableInfo.enabled && e.formula && e.formula.click_handler && "maybe-valid" === e.formula.click_handler.status) } });
define('core/graphing-calc/json/ticker', ["require", "exports", "tslib", "core/lib/default-spec"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.inflateDefaults = e.stripDefaults = e.DEFAULTS = void 0, e.DEFAULTS = { handlerLatex: "", minStepLatex: "", open: !1, playing: !1 }, e.stripDefaults = function (t) { return n.stripDefaultsAndMaybeReturnUndefined(e.DEFAULTS, t) }, e.inflateDefaults = function (n) { return t.__assign(t.__assign({}, e.DEFAULTS), n) } });
define('graphing-calc/models/ticker', ["require", "exports", "tslib", "../../core/graphing-calc/json/ticker", "../../core/lib/copy-properties"], function (require, e, t, a, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.eachLatex = e.getMissingVariables = e.getMinStepPackedError = e.getHandlerPackedError = e.updateLastTickTime = e.shouldTick = e.onControllerUpdate = e.onFormulaUpdate = e.restoreState = e.initModel = e.updateCachedUndoRedoState = e.updateCachedViewState = e.getUndoRedoFullState = e.getUndoRedoDiffState = e.getState = e.defaultTicker = void 0; var i = "dcg_ticker_guid_internal"; function n(e) { e.cachedViewState = { handlerLatex: e.handlerLatex, minStepLatex: e.minStepLatex, playing: e.playing, open: e.open } } function o(e) { var t = e.cachedViewState; e.cachedUndoRedoDiffState = t, e.cachedUndoRedoFullState = t } function d(e) { var r = a.inflateDefaults(e); return t.__assign(t.__assign({}, r), { type: "ticker", guid: i, id: "dcg_ticker_guid_internal", avgDelta: 0, lastTickTime: void 0, cachedViewState: {}, cachedParsableState: {}, cachedUndoRedoDiffState: {}, cachedUndoRedoFullState: {}, filteredBySearch: !1 }) } e.defaultTicker = function () { return d(a.DEFAULTS) }, e.getState = function (e, t) { return t.stripDefaults ? a.stripDefaults(e.cachedViewState) : e.cachedViewState }, e.getUndoRedoDiffState = function (e) { return e.cachedUndoRedoDiffState }, e.getUndoRedoFullState = function (e) { return e.cachedUndoRedoFullState }, e.updateCachedViewState = n, e.updateCachedUndoRedoState = o, e.initModel = d, e.restoreState = function (e, t) { r.copyAllProperties(t, e) }, e.onFormulaUpdate = function (e, t) { e.formula = t }, e.onControllerUpdate = function (e) { n(e), o(e), function (e) { e.cachedParsableState = { type: "ticker", id: e.id, handlerLatex: e.handlerLatex, minStepLatex: e.minStepLatex, shouldGraph: !1 } }(e) }, e.shouldTick = function (e, t) { var a, r, i = t.currentFrameTime, n = t.previousFrameTime; if (!e.playing || "maybe-valid" !== (null === (a = e.formula) || void 0 === a ? void 0 : a.handler.status)) return !1; if (null == e.lastTickTime || null == n) return !0; if ("valid" !== (null === (r = e.formula) || void 0 === r ? void 0 : r.minStep.status)) return !1; var o = e.formula.minStep.value, d = e.lastTickTime + o; return i >= d || d - i < (i - n) / 2 }, e.updateLastTickTime = function (e, t) { e.lastTickTime = t }, e.getHandlerPackedError = function (e) { if (e.formula) return "error" === e.formula.handler.status ? e.formula.handler.error : void 0 }, e.getMinStepPackedError = function (e) { if (e.formula) return "error" === e.formula.minStep.status ? e.formula.minStep.error : void 0 }, e.getMissingVariables = function (e) { var t; return (null === (t = e.formula) || void 0 === t ? void 0 : t.variables) || [] }, e.eachLatex = function (e, t) { t(e.handlerLatex, "tickerHandler", e), t(e.minStepLatex, "tickerMinStep", e) } });
define('core/lib/latex-search-helpers', ["require", "exports", "core/math/parser/latex-parser", "core/math/parser/expression-token-tables"], function (require, e, r, a) { "use strict"; function t(e) { return e.replace(/[|\\{}()[\]^$+*?.]/g, "\\$&") } function n(e) { return e.replace(/\\\\right\\(\\*[})\]|])/g, ".*\\\\right\\$1").replace(/ ?\\([}\]])/g, ".*\\$1") } function s(e) { var t; try { t = r.parse(e) } catch (e) { return } if (0 !== t.args.length && !(t.args.length > 2)) { var n = t.args[0]; if (function (e) { switch (e.type) { case "Letter": return !0; case "OperatorName": for (var r = 0, t = e.arg.args; r < t.length; r++)if ("Letter" !== t[r].type) return !1; return !0; case "Cmd": var n = a.commandTable[e.val]; return void 0 === n || "Ln" === n || "Log" === n || "Trig" === n; default: return !1 } }(n)) { var s = void 0; if (t.args.length > 1) { var i = t.args[1]; if ("SupSub" !== i.type) return; var p = i.sup, c = i.sub; if (void 0 !== p) return; if (void 0 === c) return; for (var u = 0, g = c.args; u < g.length; u++) { var f = g[u]; if ("Letter" !== f.type && "Digit" !== f.type) return } s = c } return { base: n, subscript: s } } } } function i(e, a) { var t = s(a); if (void 0 === t) return []; var n, i = []; try { n = r.parse(e) } catch (e) { return i } return u(n, t, i, { wrapInBraces: !1 }), i } function p(e, r, a) { var t = i(e, r); if (0 === t.length) return e; for (var n = "", s = 0, p = 0, c = t; p < c.length; p++) { var u = c[p]; if (n += e.slice(s, u.base.start), u.wrapInBraces && (n += "{"), n += a, s = u.base.end, u.subscript) { for (var g = 0, f = 0, o = u.subscript.start; o >= 0; o--)if ("{" === e[o] && (g += 1), "_" === e[o]) { f = o; break } n += e.slice(s, f), s = u.subscript.end; for (o = u.subscript.end; o < e.length && !(g <= 0); o++)"}" === e[o] && (g -= 1, s = o + 1) } u.wrapInBraces && (n += "}") } return n += e.slice(s, e.length) } function c(e, r) { if (e.args.length !== r.args.length) return !1; for (var a = 0; a < e.args.length; a++) { var t = e.args[a], n = r.args[a]; if (("Letter" !== t.type || "Letter" !== n.type || t.val !== n.val) && ("Digit" !== t.type || "Digit" !== n.type || t.val !== n.val)) return !1 } return !0 } function u(e, r, a, t) { for (var n = t.wrapInBraces, s = r.base, i = r.subscript, p = 0; p < e.args.length; p++) { var g = e.args[p], f = void 0; if (p + 1 < e.args.length) { var o = e.args[p + 1]; "SupSub" === o.type && void 0 !== o.sub && (f = o.sub) } switch (g.type) { case "Letter": case "Cmd": if (s.type !== g.type) break; if (s.val !== g.val) break; i && f && c(i, f) ? a.push({ base: g.span, subscript: f.span, wrapInBraces: n }) : i || f || a.push({ base: g.span, wrapInBraces: n }); break; case "OperatorName": if (s.type !== g.type) break; if (s.arg.args.length !== g.arg.args.length) break; for (var l = !0, v = 0; v < s.arg.args.length; v++) { var b = s.arg.args[v], d = g.arg.args[v]; if ("Letter" !== b.type || "Letter" !== d.type || b.val !== d.val) { l = !1; break } } if (!l) break; i && f && c(i, f) ? a.push({ base: g.span, subscript: f.span, wrapInBraces: n }) : i || f || a.push({ base: g.span, wrapInBraces: n }); break; case "Digit": case "Symbol": case "EscapedSymbol": break; case "LeftRight": case "Sqrt": u(g.arg, r, a, { wrapInBraces: !1 }); break; case "Frac": u(g.num, r, a, { wrapInBraces: !1 }), u(g.den, r, a, { wrapInBraces: !1 }); break; case "SupSub": if (g.sup) { for (var h = !1, y = g.sup.span.start; y >= 0; y--) { var I = g.sup.span.input[y]; if ("^" === I) break; "{" === I && (h = !0) } u(g.sup, r, a, { wrapInBraces: !h }) } break; default: throw new Error("Unexpected token type: " + g.type) } } } Object.defineProperty(e, "__esModule", { value: !0 }), e.replaceIdentifierWithLatex = e.replaceIdentifierWithIdentifier = e.containsIdentifier = e.isSingleIdentifier = e.getFuzzyLatexRegExp = e.addFuzzyMatches = e.escapeForRegex = void 0, e.escapeForRegex = t, e.addFuzzyMatches = n, e.getFuzzyLatexRegExp = function (e) { var r = n(t(e)); return new RegExp(r) }, e.isSingleIdentifier = function (e) { return void 0 !== s(e) }, e.containsIdentifier = function (e, r) { return 0 !== i(e, r).length }, e.replaceIdentifierWithIdentifier = function (e, r, a) { return void 0 === s(a) ? e : p(e, r, a) }, e.replaceIdentifierWithLatex = p });
define('graphing-calc/models/list', ["require", "exports", "lib/color-distance", "tslib", "./expression", "./folder", "./table", "./text", "./helper-expression", "./image", "./ticker", "core/types/graphmode", "core/lib/color-helpers", "underscore", "core/lib/deepCopy", "core/lib/latex-search-helpers"], function (require, e, t, r, a, i, n, o, l, d, s, c, f, u, m, p) { "use strict"; function y(e, t) { return e.__itemModelArray[t] } function _(e, t) { var r; do { if (-1 === --t) return; r = y(e, t) } while (r && !b(r)); return r } function I(e, t) { var r, a = F(e); do { if (++t === a) return; r = y(e, t) } while (r && !b(r)); return r } function g(e) { if ("folder" !== e.type && e.folderId) { var t = k(e.controller.getListModel(), e.folderId); if (t && "folder" === t.type) return t } } function h(e) { if (!e) return !1; if (e.secret) return !0; var t = g(e); return !(!t || !t.secret) } function b(e) { return !x(e) } function x(e) { if (!e) return !0; if (e.filteredBySearch) return !0; if (e.controller.isItemBeingDragged(e.id)) return !1; if (!e.controller.canAdministerSecretFolders() && h(e)) return !0; var t = g(e); return !(!t || !t.collapsed || e.controller.getExpressionSearchStr()) } function v(e) { return e.__itemModelArray } function M(e, t) { for (var r = 0; r < e.__itemModelArray.length; r++) { A(e.__itemModelArray[r], t) } e.ticker.open && (t(e.ticker.handlerLatex, "tickerHandler", e.ticker), t(e.ticker.minStepLatex, "tickerMinStep", e.ticker)) } function A(e, t) { switch (e.type) { case "expression": a.eachLatex(e, t); break; case "table": n.eachLatex(e, t); break; case "image": d.eachLatex(e, t); break; case "ticker": s.eachLatex(e, t); break; case "folder": case "text": break; default: return e } } function S(e, t) { return !!e.replace(/([_^])([a-z0-9])/gi, "$1{$2}").match(t) } function k(e, t) { return e.__itemIdToModel[t] } function L(e, t) { return e.__helperIdToModel[t] } function w(e) { e.__anyDependsOnRandomSeed = !1; for (var t = 0; t < e.__itemModelArray.length; t++) { var r = e.__itemModelArray[t]; if (r && "formula" in r && r.formula && r.formula.depends_on_random_seed) return void (e.__anyDependsOnRandomSeed = !0) } } function B(e) { if (!e.__anyIsAction) if (e.ticker.open) e.__anyIsAction = !0; else for (var t = 0; t < e.__itemModelArray.length; t++) { var r = e.__itemModelArray[t]; if (r && "formula" in r && r.formula) { if ("expression" !== r.type && "image" !== r.type) continue; var a = r.formula; if (a.hasOwnProperty("action_value") || a.hasOwnProperty("click_handler")) return void (e.__anyIsAction = !0) } } } function D(e) { for (var t = !e.controller.canAdministerSecretFolders(), r = 1, a = 1, i = 0; i < e.__itemModelArray.length; i++) { var n = e.__itemModelArray[i]; n.index = i, n.displayIndex = r, h(n) && (n.secretIndex = a, a += 1), t && h(n) || (r += 1) } e.nextDisplayIndex = r } function O(e) { e.__itemModelArray = [], e.__itemIdToModel = {}, e.__helperIdToModel = {}, e.__anyDependsOnRandomSeed = !1 } function F(e) { return e.__itemModelArray.length } function E(e) { return e.selectedItem } function R(e, t) { switch (t.type) { case "expression": return a.initModel(t, e.controller); case "table": return n.initModel(t, e.controller); case "image": return d.initModel(t, e.controller); case "folder": return i.initModel(t, e.controller); case "text": return o.initModel(t, e.controller); default: return t } } function T(e, t) { e.selectedItem = t } function C(e, t, r) { var a = String(t.id); if (e.__itemIdToModel.hasOwnProperty(a)) throw Error("Item with id '" + a + "' is already in list"); e.__itemIdToModel[a] = t, e.__itemModelArray.splice(r, 0, t), D(e) } function P(e, t) { var r = e.__itemModelArray[t]; if ("folder" === r.type) { for (var a = 0, i = r.index + 1; i < e.__itemModelArray.length; i++) { var n = e.__itemModelArray[i]; if ("folder" === n.type || n.folderId !== r.id) break; a += 1, N(n) && T(e, void 0), delete e.__itemIdToModel[n.id], delete e.expressionAnalysis[r.id] } e.__itemModelArray.splice(t, 1 + a) } else e.__itemModelArray.splice(t, 1); N(r) && T(e, void 0), delete e.__itemIdToModel[r.id], delete e.expressionAnalysis[r.id], w(e), D(e) } function N(e) { return e.controller.getListModel().selectedItem === e } Object.defineProperty(e, "__esModule", { value: !0 }), e.collapseAllFolders = e.getMissingVariablesForItem = e.setDragState = e.isItemSelected = e.selectNextItem = e.selectPrevItem = e.removeItemById = e.anyItemIsAction = e.anyItemDependsOnRandomSeed = e.removeItemAtIndex = e.insertItemAtEnd = e.insertItemAtIndex = e.moveItemsTo = e.setSelected = e.onEvaluatorFormulaUpdates = e.onGraphComputed = e.restoreListState = e.modelFromSpec = e.setListState = e.getLargestIntegerId = e.getState = e.getUndoRedoFullState = e.getUndoRedoDiffState = e.getSelected = e.getAllModelsWithSliders = e.hasNoVisibleExpressions = e.getItemCount = e.removeAllItems = e.reindex = e.recomputeAnyItemIsAction = e.clearAnyItemIsAction = e.recomputeAnyItemDependsOnRandomSeed = e.addHelperExpression = e.getHelperExpressionById = e.getItemsByIdentifier = e.getItemById = e.updateDrawOrder = e.findAvailableColumnSubscript = e.renameIdentifierGlobal = e.filterItemsBySearch = e.filterItemsByIdentifierSearch = e.eachLatexForItem = e.eachLatex = e.getAllHelperItemModels = e.getAllItemModels = e.isItemHiddenFromUI = e.isItemSelectable = e.isItemSecret = e.getNumberOfItemsInFolder = e.getParentFolderModel = e.findNextSelectableItem = e.findPrevSelectableItem = e.getLastSelectableItem = e.getFirstSelectableItem = e.getItemByIndex = e.getNextColor = e.areAnyImagesLoading = e.init = void 0, e.init = function (e) { return { controller: e, __itemModelArray: [], __itemIdToModel: {}, __helperIdToModel: {}, __anyDependsOnRandomSeed: !1, __anyIsAction: !1, drawOrder: [], colorIdx: 0, expressionAnalysis: {}, nextDisplayIndex: 1, ticker: s.defaultTicker() } }, e.areAnyImagesLoading = function (e) { for (var t = 0; t < e.__itemModelArray.length; t++) { var r = e.__itemModelArray[t]; if ("image" === r.type && "loading" === r.loadStatus) return !0 } return !1 }, e.getNextColor = function (e) { var t = u.filter(u.values(e.controller.getColors()), function (e) { return e != f.colors.ORANGE }), r = t[e.colorIdx]; return e.colorIdx = (e.colorIdx + 1) % t.length, r }, e.getItemByIndex = y, e.getFirstSelectableItem = function (e) { for (var t = 0; t < e.__itemModelArray.length; t++) { var r = e.__itemModelArray[t]; if (b(r)) return r } }, e.getLastSelectableItem = function (e) { for (var t = e.__itemModelArray.length - 1; t >= 0; t--) { var r = e.__itemModelArray[t]; if (b(r)) return r } }, e.findPrevSelectableItem = _, e.findNextSelectableItem = I, e.getParentFolderModel = g, e.getNumberOfItemsInFolder = function (e, t) { var r = k(e, t); if (!r || "folder" !== r.type) return 0; for (var a = 0, i = e.__itemModelArray.length, n = r.index + 1; n < i; n++) { var o = e.__itemModelArray[n]; if ("folder" === o.type || o.folderId !== t) break; a += 1 } return a }, e.isItemSecret = h, e.isItemSelectable = b, e.isItemHiddenFromUI = x, e.getAllItemModels = v, e.getAllHelperItemModels = function (e) { return u.values(e.__helperIdToModel) }, e.eachLatex = M, e.eachLatexForItem = A, e.filterItemsByIdentifierSearch = function (e, t) { var r = 0, i = p.isSingleIdentifier(t); e.ticker.filteredBySearch = e.ticker.open && !p.containsIdentifier(e.ticker.handlerLatex, t) && !p.containsIdentifier(e.ticker.minStepLatex, t); for (var o = function (o) { if (!i) return o.filteredBySearch = !1, r++, "continue"; switch (o.filteredBySearch = !0, o.type) { case "expression": if (a.eachLatex(o, function (e) { p.containsIdentifier(e, t) && (o.filteredBySearch = !1, r++) }), o.label && o.showLabel) { var l = new RegExp("\\$\\{" + t.replace("{", "\\{?").replace("}", "\\}?") + "\\}"); o.label.match(l) && (o.filteredBySearch = !1, r++) } break; case "table": n.eachLatex(o, function (e) { p.containsIdentifier(e, t) && (o.filteredBySearch = !1, r++) }); break; case "image": d.eachLatex(o, function (e) { p.containsIdentifier(e, t) && (o.filteredBySearch = !1, r++) }); break; case "folder": case "text": break; default: return { value: o } }!o.filteredBySearch && "folder" !== o.type && o.folderId && (e.__itemIdToModel[o.folderId].filteredBySearch = !1, r++) }, l = 0, s = e.__itemModelArray; l < s.length; l++) { var c = o(s[l]); if ("object" == typeof c) return c.value } return r }, e.filterItemsBySearch = function (e, t) { var r = 0, i = p.getFuzzyLatexRegExp(t); e.ticker.filteredBySearch = e.ticker.open && !S(e.ticker.handlerLatex, i) && !S(e.ticker.minStepLatex, i); for (var o = 0; o < e.__itemModelArray.length; o++)if (t) { var l = e.__itemModelArray[o]; switch (l.filteredBySearch = !0, l.type) { case "expression": a.eachLatex(l, function (e) { S(e, i) && (l.filteredBySearch = !1, r++) }), l.label && l.showLabel && ("\\operatorname{label}" === t || t.length > 1 && 0 === "label".indexOf(t) || S(l.label, i)) && (l.filteredBySearch = !1, r++); break; case "table": n.eachLatex(l, function (e) { S(e, i) && (l.filteredBySearch = !1, r++) }); break; case "image": d.eachLatex(l, function (e) { S(e, i) && (l.filteredBySearch = !1, r++) }); break; case "folder": l.title && l.title.indexOf(t) >= 0 && (l.filteredBySearch = !1, r++); break; case "text": l.text.indexOf(t) >= 0 && (l.filteredBySearch = !1, r++); break; default: return l }!l.filteredBySearch && "folder" !== l.type && l.folderId && (e.__itemIdToModel[l.folderId].filteredBySearch = !1, r++) } else e.__itemModelArray[o].filteredBySearch = !1; return r }, e.renameIdentifierGlobal = function (e, t, r, i) { r = r.trim().replace(/_\{([a-zA-Z0-9])\}/g, "_$1"); for (var o = 0; o < e.__itemModelArray.length; o++) { var l = e.__itemModelArray[o]; if ("expression" === l.type && l.showLabel && l.label) { var s = new RegExp("\\$\\{" + t.replace("{", "\\{?").replace("}", "\\}?") + "\\}", "g"); l.label.match(s) && a.setLabel(l, l.label.replace(s, "${" + r.trim() + "}")) } } M(e, function (e, o, l, s) { if (!(i && void 0 !== i.limitToItem && i.limitToItem !== l.id || i && void 0 !== i.limitToFolder && ("ticker" === l.type || "folder" === l.type || i.limitToFolder !== l.folderId))) { var c = p.replaceIdentifierWithIdentifier(e, t, r); if (c !== e) switch (o) { case "latex": a.setLatex(l, c); break; case "lineWidth": a.setLineWidth(l, c); break; case "clickableInfoLatex": a.setClickableInfoRuleLatex(l, c); break; case "fillOpacity": a.setFillOpacity(l, c); break; case "lineOpacity": a.setLineOpacity(l, c); break; case "pointOpacity": a.setPointOpacity(l, c); break; case "pointSize": a.setPointSize(l, c); break; case "labelAngle": a.setLabelAngle(l, c); break; case "labelSize": a.setLabelSize(l, c); break; case "polarDomainMin": a.setPolarDomainMin(l, c); break; case "polarDomainMax": a.setPolarDomainMax(l, c); break; case "parametricDomainMin": a.setParametricDomainMin(l, c); break; case "parametricDomainMax": a.setParametricDomainMax(l, c); break; case "sliderMin": a.setSliderMin(l, c); break; case "sliderMax": a.setSliderMax(l, c); break; case "sliderStep": a.setSliderStep(l, c); break; case "imageOpacity": d.setMQAttribute(l, "opacity", c); break; case "imageCenter": d.setMQAttribute(l, "center", c); break; case "imageHeight": d.setMQAttribute(l, "height", c); break; case "imageWidth": d.setMQAttribute(l, "width", c); break; case "imageAngle": d.setMQAttribute(l, "angle", c); break; case "tickerHandler": l.handlerLatex = c; break; case "tickerMinStep": l.minStepLatex = c; break; case "tableHeader": case "tableCellValue": if (!s || "table" !== l.type) break; n.setCellLatex(l, s.cellLocation, c); break; case "residualVariable": break; default: throw new Error("Unexpected latex location " + o) } } }) }, e.findAvailableColumnSubscript = function (e) { var t = []; M(e, function (e) { if (-1 === e.indexOf("~") && -1 === e.indexOf("\\sim")) for (var r = /_(\d)|_\{(?:\s|\\space)*(\d+)(?:\s|\\space)*\}/g; ;) { var a = r.exec(e); if (!a) break; t.push(parseInt(a[1] || a[2], 10)) } }), t.sort(function (e, t) { return e - t }); for (var r = 1, a = 0; a < t.length; a++)t[a] === r && r++; return r }, e.updateDrawOrder = function (e) { var t = []; u.each(e.__itemModelArray, function (e) { "table" === e.type ? u.each(e.columnModels, function (e) { t.push(e.id) }) : t.push(e.id) }), e.drawOrder = t }, e.getItemById = k, e.getItemsByIdentifier = function (e, t) { for (var r = [], i = 0; i < e.__itemModelArray.length; i++) { var n = e.__itemModelArray[i]; "expression" === n.type && a.getAssignment(n) === t && r.push(n) } return r }, e.getHelperExpressionById = L, e.addHelperExpression = function (e, t) { var r = l.init(t); e.__helperIdToModel[r.id] = r }, e.recomputeAnyItemDependsOnRandomSeed = w, e.clearAnyItemIsAction = function (e) { e.__anyIsAction = !1 }, e.recomputeAnyItemIsAction = B, e.reindex = D, e.removeAllItems = O, e.getItemCount = F, e.hasNoVisibleExpressions = function (e) { return 1 === e.nextDisplayIndex }, e.getAllModelsWithSliders = function (e) { for (var t = [], r = 0; r < e.__itemModelArray.length; r++) { var a = e.__itemModelArray[r]; "expression" === a.type && a.sliderExists && t.push(a) } return t }, e.getSelected = E, e.getUndoRedoDiffState = function (e) { return { list: e.__itemModelArray.map(function (e) { return e.cachedUndoRedoDiffState }), ticker: s.getUndoRedoDiffState(e.ticker) } }, e.getUndoRedoFullState = function (e) { return { list: e.__itemModelArray.map(function (e) { return e.cachedUndoRedoFullState }), ticker: s.getUndoRedoFullState(e.ticker) } }, e.getState = function (e, t) { var r = { list: e.__itemModelArray.map(function (e) { switch (e.type) { case "expression": return a.getState(e, t); case "image": return d.getState(e, t); case "table": return n.getState(e, t); case "folder": return i.getState(e, t); case "text": return o.getState(e, t); default: return e } }) }, l = s.getState(e.ticker, t); return l && (r.ticker = l), r }, e.getLargestIntegerId = function (e) { for (var t = 0, r = /^[0-9]+$/, a = e.list.length - 1; a >= 0; a--) { var i = e.list[a], n = i.id; if (r.test(n)) (l = parseInt(n, 10)) > t && (t = l); if ("table" === i.type && i.columns) for (var o = i.columns.length - 1; o >= 0; o--) { var l; if (n = i.columns[o].id, r.test(n)) (l = parseInt(n, 10)) > t && (t = l) } } return t }, e.setListState = function (e, r, a) { var i, n; for (a || (a = {}), e.colorIdx = 0, O(e), e.expressionAnalysis = {}, i = 0; i < r.list.length; i++) { if (n = R(e, r.list[i]), a.remapColors && "color" in n && n.color) { var o = u.values(e.controller.getColors()); u.contains(o, n.color) || (n.color = t.closestColor(n.color, o)) } e.__itemModelArray.push(n), e.__itemIdToModel[n.id] = n } if (e.ticker = s.initModel(r.ticker), D(e), 1 === e.nextDisplayIndex) { var l = R(e, { type: "expression", id: e.controller.generateId(), color: e.controller.getNextColor() }); C(e, l, e.__itemModelArray.length) } }, e.modelFromSpec = R, e.restoreListState = function (e, t) { var r, l, c = e.__itemIdToModel; for (e.__itemModelArray = [], e.__itemIdToModel = {}, r = 0; r < t.list.length; r++) { var f = t.list[r]; if ((l = c[f.id]) && l.type === f.type) switch (l.type) { case "expression": if (f.type !== l.type) throw new Error("invalid restoration"); a.restoreState(l, f); break; case "table": if (f.type !== l.type) throw new Error("invalid restoration"); n.restoreState(l, f); break; case "image": if (f.type !== l.type) throw new Error("invalid restoration"); d.restoreState(l, f); break; case "folder": if (f.type !== l.type) throw new Error("invalid restoration"); i.restoreState(l, f); break; case "text": if (f.type !== l.type) throw new Error("invalid restoration"); o.restoreState(l, f); break; default: return l } else l = R(e, f); e.__itemModelArray.push(l), e.__itemIdToModel[l.id] = l } t.ticker && s.restoreState(e.ticker, t.ticker), w(e), B(e), D(e) }, e.onGraphComputed = function (e, t, r) { var a, i = k(e, r[0] && r[0].tableId || t); if (i) switch (i.type) { case "expression": var o = !1; i.__workerNeedsDotplotXMode = !1; for (var l = 0; l < r.length; l++) { (p = r[l]).graphMode !== c.Z_3D && p.graphMode !== c.OBJECT3D && p.graphMode !== c.PARAMETRIC_CURVE_3D && (p.graphMode !== c.ERROR ? ("resolved" in p && !p.resolved && (o = !0), p.boundingBox && (a || (a = []), a.push(p.boundingBox)), p.needsDotplotXMode && (i.__workerNeedsDotplotXMode = !0)) : i.error = p.error) } i.unresolved = o, i.boundingBoxes = a; for (var d = 1 / 0, s = -1 / 0, f = 0, u = r; f < u.length; f++) { if ((p = u[f]).graphMode === c.POLAR) { var m = p.sampledDomain; m && (d = Math.min(d, m.min), s = Math.max(s, m.max)) } } return isFinite(d) && (i.__workerSampledDomainMin = d), void (isFinite(s) && (i.__workerSampledDomainMax = s)); case "table": for (l = 0; l < r.length; l++) { var p; (p = r[l]).graphMode !== c.Z_3D && p.graphMode !== c.OBJECT3D && p.graphMode !== c.PARAMETRIC_CURVE_3D && (p.boundingBox && (a || (a = []), a.push(p.boundingBox))) } return void (a && n.setColumnBoundingBoxes(i, t, a)); default: return } }, e.onEvaluatorFormulaUpdates = function (e, t) { var r, i, o, c = m.default(e.expressionAnalysis); for (r in t) if (t.hasOwnProperty(r)) { o = t[r], i = k(e, r); var f = { isGraphable: !!o.is_graphable, isError: !!o.error, errorMessage: o.error ? e.controller.unpack(o.error) : void 0 }; if (i) switch (i.type) { case "expression": if (a.onFormulaUpdate(i, o), o.zero_values && 1 === o.zero_values.length) { var p = o.zero_values[0].val; u.isNumber(p) && (f.evaluation = { type: "Number", value: p }, f.evaluationDisplayed = !0), u.isArray(p) && p.every(u.isNumber) && (f.evaluation = { type: "ListOfNumber", value: p.slice() }, f.evaluationDisplayed = !0) } else o.hasOwnProperty("constant_value") && u.isNumber(o.constant_value) && (f.evaluation = { type: "Number", value: o.constant_value }, f.evaluationDisplayed = !1); break; case "image": d.onFormulaUpdate(i, o); break; case "table": n.onFormulaUpdate(i, o); break; case "folder": case "text": break; default: return i } else if (r === e.ticker.id) s.onFormulaUpdate(e.ticker, o); else { var y = L(e, r); if (!y) continue; l.onFormulaUpdate(e.controller, y, o) } r !== e.ticker.id && (c[r] = f) } w(e), B(e), e.expressionAnalysis = c }, e.setSelected = T, e.moveItemsTo = function (e, t, a, i) { if (t !== a) { var n = e.__itemModelArray.splice(t, i); t < a && (a = a - i + 1), e.__itemModelArray.splice.apply(e.__itemModelArray, r.__spreadArray([a, 0], n)), D(e) } }, e.insertItemAtIndex = C, e.insertItemAtEnd = function (e, t) { C(e, t, F(e)) }, e.removeItemAtIndex = P, e.anyItemDependsOnRandomSeed = function (e) { return e.__anyDependsOnRandomSeed }, e.anyItemIsAction = function (e) { return e.__anyIsAction }, e.removeItemById = function (e, t) { var r = k(e, t); r && P(e, r.index) }, e.selectPrevItem = function (e) { var t = E(e); if (!t) return !1; var r = _(e, t.index); return !!r && (T(e, r), r.index === F(e) - 1 && "expression" === t.type && a.isEmpty(t) && P(e, r.index), !0) }, e.selectNextItem = function (e) { var t = E(e); if (!t) return !1; var r = I(e, t.index); return !!r && (T(e, r), !0) }, e.isItemSelected = N, e.setDragState = function (e, t) { e.dragState = t }, e.getMissingVariablesForItem = function (e) { switch (e.type) { case "expression": return a.getMissingVariables(e); case "image": return d.getMissingVariables(e); case "table": case "text": case "folder": return []; default: return e } }, e.collapseAllFolders = function (e, t) { for (var r = 0, a = v(e); r < a.length; r++) { var n = a[r]; "folder" === n.type && i.setCollapsed(n, t) } } });
define('graphing-calc/models/abstract-item', ["require", "exports", "./list", "graphing-calc/models/expression", "graphing-calc/models/table"], function (require, e, r, t, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getMaybeGradientDisplayColor = e.getDisplayColor = e.getDisplayState = e.updateIsHiddenFromUI = e.setFolderId = e.setSecret = e.DEFAULTS = e.getGUID = void 0; var i = 0; function n() { return "abstract_item_" + i++ } function l(e) { return e.colorLatex ? ("expression" === e.type ? (r = t.getColorLatexValue(e), i = t.isColorLatexValid(e)) : "header" === e.type && (r = o.getColorLatexValue(e), i = o.isColorLatexValid(e)), i && r ? r : e.color) : e.color; var r, i } e.getGUID = n, e.DEFAULTS = function (e) { return { guid: n(), controller: e, index: -1, displayIndex: -1, secretIndex: -1, isHiddenFromUI: !0, renderShell: !0 } }, e.setSecret = function (e, r) { e.secret = r }, e.setFolderId = function (e, r) { "folder" !== e.type && (e.folderId = r) }, e.updateIsHiddenFromUI = function (e) { e.isHiddenFromUI = r.isItemHiddenFromUI(e) }, e.getDisplayState = function (e) { return e.isHiddenFromUI || e.filteredBySearch ? "none" : e.renderShell ? "shell" : "render" }, e.getDisplayColor = function (e) { var r = l(e); return Array.isArray(r) ? r[0] : r }, e.getMaybeGradientDisplayColor = l });
define('core/graphing-calc/json/table', ["require", "exports", "tslib", "core/lib/default-spec", "core/types/styles", "core/lib/dragmode"], function (require, e, t, n, s, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.computeParsableState = e.stripDefaults = e.inflateDefaults = e.COLUMN_DEFAULTS = e.DEFAULTS = void 0, e.DEFAULTS = { folderId: "", secret: !1, columns: [] }, e.COLUMN_DEFAULTS = { latex: "", color: "", hidden: !1, values: [], points: !0, lines: !1, dragMode: i.DragMode.NONE, pointStyle: s.PointStyle.POINT, lineStyle: s.LineStyle.SOLID, colorLatex: "", lineOpacity: "", lineWidth: "", pointOpacity: "", pointSize: "" }, e.inflateDefaults = function (n) { var s = t.__assign(t.__assign({}, e.DEFAULTS), n); return s.columns = s.columns.map(function (n) { return t.__assign(t.__assign({}, e.COLUMN_DEFAULTS), n) }), s }, e.stripDefaults = function (s) { return s = t.__assign(t.__assign({}, s), { columns: s.columns.map(function (t) { return n.stripDefaults(e.COLUMN_DEFAULTS, t) }) }), n.stripDefaults(e.DEFAULTS, s) }, e.computeParsableState = function (e) { return { type: "table", id: e.id, columns: e.columns.map(function (n) { return t.__assign(t.__assign({}, n), { tableId: e.id }) }) } } });
define('graphing-calc/models/table', ["require", "exports", "core/math/rational-arithmetic-sequence", "tslib", "core/types/styles", "core/lib/dragmode", "./abstract-item", "underscore", "core/lib/label", "core/math/evaluate-single-expression", "core/math/distance", "core/lib/deepCopy", "core/lib/copy-properties", "graphing-calc/models/list", "core/graphing-calc/json/table", "core/graphing-calc/json/table", "core/graphing-calc/json/table", "core/lib/validate-color"], function (require, e, o, n, l, t, r, a, i, u, s, c, d, m, p, f, v, g) { "use strict"; function h(e, o, n, l) { l.row = e.rowModels[o], l.row.cells.splice(n, 0, l) } function C(e, o, n) { e.rowModels[o].cells.splice(n, 1) } function M(e) { return isFinite(e) ? i.truncatedLatexLabel(e, { digits: 8, bigCutoff: 1e6, smallCutoff: .001 }) : "\\mathrm{undefined}" } function y(e, o, n) { var l = e.columnModels[o]; l.error = n.error, l.discrete = n.discrete, l.disabled = n.dependent, l.draggable = !n.error && !n.dependent, l.packedErrors = [], l.computedValues = []; for (var t = n.values, r = t.length - 1; r >= 0; r--) { var a = t[r]; l.computedValues[r] = "number" == typeof a ? M(a) : "", l.packedErrors[r] = a && a.key ? a : void 0 } } function x(e) { if (!e.isExpanded) { var o = e.rowModels.length; if (!(o < 30)) return { min: 8, max: o - 5 } } } function S(e, o) { var n = e.columnModels[o]; return { values: e.columns[o].values.slice(), dragMode: n.dragMode, hidden: n.hidden, id: n.id, color: n.color, points: n.points, lines: n.lines, pointStyle: n.pointStyle, lineStyle: n.lineStyle, latex: n.latex, colorLatex: n.colorLatex, lineOpacity: n.lineOpacity, lineWidth: n.lineWidth, pointSize: n.pointSize, pointOpacity: n.pointOpacity } } Object.defineProperty(e, "__esModule", { value: !0 }), e.isColumnEmpty = e.doesCellExist = e.setCellLatex = e.shouldHideColumn = e.mergeBoundingBoxes = e.setColumnBoundingBoxes = e.setColumnHidden = e.setExpanded = e.setColumnColorLatex = e.setColumnColor = e.setColumnDragMode = e.setColumnPointOpacity = e.setColumnPointSize = e.setColumnLineOpacity = e.setColumnLineWidth = e.setColumnLineStyle = e.setColumnLines = e.setColumnPointStyle = e.setColumnPoints = e.getColumnModel = e.getSelectedCell = e.cloneTableAndExtendWithProperties = e.makeTableState = e.buildEntireColumnStructure = e.initModel = e.restoreState = e.computeTableStructureMutation = e.updateCachedUndoRedoState = e.setIsDraggingOnGrapher = e.updateCachedViewState = e.getState = e.stripBlankRowAndColumn = e.addBlankRowAndColumn = e.updateCachedParsableState = e.eachLatex = e.getRowAutoFillValues = e.removeColumn = e.insertBlankColumn = e.removeRow = e.insertBlankRow = e.onFormulaUpdate = e.onControllerUpdate = e.getColorLatexValue = e.isPointOpacityValid = e.isPointSizeValid = e.isLineWidthValid = e.isLineOpacityValid = e.isColorLatexValid = e.isDynamicPropValid = e.makeColumn = e.removeCellFromColumn = e.insertCellToColumn = e.makeRow = e.makeCell = e.getGUID = e.getColumnState = e.getCollapsedRange = e.updateIsCollapsedByFocusLocation = e.setColumnComputedValues = e.formatValueForDisplay = e.removeCellFromRow = e.insertCellToRow = void 0, e.insertCellToRow = h, e.removeCellFromRow = C, e.formatValueForDisplay = M, e.setColumnComputedValues = y, e.updateIsCollapsedByFocusLocation = function (e) { var o = H(e); if (o) { var n = x(e); n ? o.row >= n.min && o.row < n.max && q(e, !0) : e.isExpanded || q(e, !0) } }, e.getCollapsedRange = x, e.getColumnState = S; var w = 0; function _() { return "table_guid_" + w++ } function b() { return { guid: _(), type: "cell", row: void 0, column: void 0 } } function L(e) { return { type: "row", index: e, guid: _(), cells: [] } } function V(e, o, n, l) { var t = e.columnModels[o]; t.cells.splice(n, 0, l), l.column = t, e.columns[t.index].values.splice(n, 0, "") } function O(e, o, n) { var l = e.columnModels[o]; l.cells.splice(n, 1), e.columns[l.index].values.splice(n, 1) } function P(e, o, l) { var t = l.color; t && g.default(t) || (t = e.controller.getNextColor()); var r = n.__assign(n.__assign({}, l), { type: "header", guid: _(), index: o, error: void 0, table: e, color: t, packedErrors: [], computedValues: [], cells: void 0, row: void 0, discrete: void 0, shouldGraph: void 0, disabled: void 0, draggable: void 0 }); return r.cells = r.values.map(function () { var e = b(); return e.column = r, e }), delete r.values, 0 === o && (r.hidden = !0), r } function E(e, o) { var n = e.table.formula; if (!n) return !1; var l = n.column_data[e.index]; return !!l && !!l[o] } function D(e, o) { var n = L(o + 1); e.rowModels.splice(o + 1, 0, n); for (var l = o + 1; l < e.rowModels.length; l++)e.rowModels[l].index = l; for (l = 0; l < e.columnModels.length; l++) { var t = b(); V(e, l, o, t), h(e, o + 1, l, t) } } function I(e, o, l) { var t = n.__assign(n.__assign(n.__assign({}, p.COLUMN_DEFAULTS), l), { values: e.columns[0].values.map(function () { return "" }) }), r = P(e, o, t); e.columnModels.splice(o, 0, r), e.columns.splice(o, 0, t); for (var a = o + 1; a < e.columnModels.length; a++)e.columnModels[a].index = a; for (h(e, 0, o, r), a = 1; a < e.rowModels.length; a++)h(e, a, o, r.cells[a - 1]) } function R(e) { for (var o = v.computeParsableState({ type: "table", id: e.id, secret: e.secret, folderId: e.folderId, columns: e.columnModels.map(function (o) { return S(e, o.index) }) }), n = 0; n < o.columns.length; n++)o.columns[n].hidden = !e.columnModels[n].shouldGraph; e.cachedParsableState = o } function F(e, o) { return (e = c.default(e)).push(n.__assign(n.__assign({}, p.COLUMN_DEFAULTS), { id: o, values: e[0].values.map(function () { return "" }) })), e.forEach(function (e) { e.values.push("") }), e } function k(e) { return (e = c.default(e)).pop(), e.forEach(function (e) { e.values.pop() }), e } function B(e, o) { var l = n.__assign(n.__assign({}, e.cachedViewState), { columns: k(e.cachedViewState.columns) }); return o.stripDefaults ? f.stripDefaults(l) : l } function T(e) { var o = e.columnModels.map(function (o, n) { return S(e, n) }); e.cachedViewState = { id: e.id, type: e.type, folderId: e.folderId, columns: o, secret: e.secret } } function U(e) { var o = n.__assign(n.__assign({}, e.cachedViewState), { columns: k(e.cachedViewState.columns) }); e.cachedUndoRedoFullState = o, e.preTransientState && (o = n.__assign(n.__assign({}, o), e.preTransientState)), e.cachedUndoRedoDiffState = o } function N(e, o) { if (e.columnModels.length - 1 !== o.length) return { type: "start-fresh" }; if (e.columnModels[0].cells.length - 1 !== o[0].values.length) return { type: "start-fresh" }; for (var n = -1, l = o.length - 1; l >= 0; l--) { var t = e.columns[l], r = o[l]; if (t.id !== r.id) return { type: "start-fresh" }; for (var a = t.values, i = r.values, u = i.length - 1; u >= 0; u--)if (a[u] !== i[u] && (-1 === n && (n = u), n !== u)) return { type: "start-fresh" } } return -1 === n ? { type: "none" } : { type: "edit-row", rowIndex: n } } e.getGUID = _, e.makeCell = b, e.makeRow = L, e.insertCellToColumn = V, e.removeCellFromColumn = O, e.makeColumn = P, e.isDynamicPropValid = E, e.isColorLatexValid = function (e) { return E(e, "color_latex_valid") }, e.isLineOpacityValid = function (e) { return E(e, "line_opacity_valid") }, e.isLineWidthValid = function (e) { return E(e, "line_width_valid") }, e.isPointSizeValid = function (e) { return E(e, "point_size_valid") }, e.isPointOpacityValid = function (e) { return E(e, "point_opacity_valid") }, e.getColorLatexValue = function (e) { var o = e.table.formula; if (o) { var n = o.column_data[e.index]; if (n) return n.color_latex_value } }, e.onControllerUpdate = function (e) { e.draggingOnGraphpaper ? e.preTransientState || (e.preTransientState = { columns: B(e, { stripDefaults: !1 }).columns }) : delete e.preTransientState, r.updateIsHiddenFromUI(e); var o = m.getParentFolderModel(e), n = o && o.hidden; a.each(e.columnModels, function (e) { e.shouldGraph = !n && !e.hidden }), T(e), U(e), R(e) }, e.onFormulaUpdate = function (e, o) { e.formula = o; var n, l = e.formula.column_data, t = e.columnModels[0].cells.length, r = e.columnModels.length, a = 0; for (n = 0; n < l.length; n++) { var i = l[n].values.length; i > a && (a = i) } for (n = a - t; n > 0; n--)D(e, t), t++; for (n = 0; n < l.length && n < r; n++) { y(e, n, l[n]) } var u = e.columnModels[e.columnModels.length - 1]; u.disabled = !0, u.error = void 0 }, e.insertBlankRow = D, e.removeRow = function (e, o) { var n = x(e); n && o === n.max - 1 && q(e, !0); for (var l = 0; l < e.columnModels.length; l++)O(e, l, o); for (e.rowModels.splice(o + 1, 1), l = o + 1; l < e.rowModels.length; l++)e.rowModels[l].index = l }, e.insertBlankColumn = I, e.removeColumn = function (e, o) { e.columns.splice(o, 1), e.columnModels.splice(o, 1); for (var n = o; n < e.columnModels.length; n++)e.columnModels[n].index = n; for (n = 0; n < e.rowModels.length; n++)C(e, n, o) }, e.getRowAutoFillValues = function (e, n) { var l, t = e.columnModels.length, r = []; for (l = 0; l < t; l++)r.push(""); var a = e.columns[0].values; if (n > 1) { var i = e.controller.isDegreeMode(), c = u.default(a[0], i), d = u.default(a[1], i); if (isFinite(c) && isFinite(d)) { var m = o(c, d); if (m) { var p = m.nstart, f = p / m.lcm; for (l = 0; l < n; l++) { var v = u.default(a[l], i); if (!s.approx(v, f)) return r; f = (p += m.nstep) / m.lcm } r[0] = ("" + c).length < 8 && ("" + d).length < 8 ? "" + f : "\\frac{" + p + "}{" + m.lcm + "}" } } } return r }, e.eachLatex = function (e, o) { for (var n = 0; n < e.columnModels.length; n++) { o(e.columnModels[n].latex, "tableHeader", e, { cellLocation: { column: n, row: 0 } }); for (var l = e.columns[n], t = 0; t < l.values.length; t++)l.values[t] && o(l.values[t], "tableCellValue", e, { cellLocation: { column: n, row: t + 1 } }) } }, e.updateCachedParsableState = R, e.addBlankRowAndColumn = F, e.stripBlankRowAndColumn = k, e.getState = B, e.updateCachedViewState = T, e.setIsDraggingOnGrapher = function (e, o) { e.draggingOnGraphpaper = o }, e.updateCachedUndoRedoState = U, e.computeTableStructureMutation = N; var z = { id: !1, type: !1, columns: !1, folderId: !0, secret: !0 }, A = { id: !1, values: !1, color: !0, latex: !0, hidden: !0, points: !0, lines: !0, dragMode: !0, lineStyle: !0, pointStyle: !0, colorLatex: !0, lineOpacity: !0, lineWidth: !0, pointSize: !0, pointOpacity: !0 }; function W(e) { e.columnModels = e.columns.map(function (o, n) { return P(e, n, o) }), e.rowModels = [L(0)]; for (var o = 0; o < e.columnModels.length; o++)h(e, 0, o, e.columnModels[o]); for (o = 0; o < e.columnModels[0].cells.length; o++) { var n = L(o + 1); e.rowModels.push(n); for (var l = 0; l < e.columnModels.length; l++)h(e, o + 1, l, e.columnModels[l].cells[o]) } } e.restoreState = function (e, o) { var n = N(e, o.columns); if (d.copyProperties({ from: o, to: e, props: z }), "start-fresh" === n.type) e.columns = F(o.columns, e.controller.generateId()), W(e); else { switch (n.type) { case "none": break; case "edit-row": for (var l = o.columns.length - 1; l >= 0; l--) { K(e, { column: l, row: n.rowIndex + 1 }, o.columns[l].values[n.rowIndex]) } break; default: return n }for (var t = 0; t < o.columns.length; t++)d.copyProperties({ from: o.columns[t], to: e.columnModels[t], props: A }) } }, e.initModel = function (e, o) { var l = c.default(f.inflateDefaults(e)), t = n.__assign(n.__assign(n.__assign({}, l), r.DEFAULTS(o)), { columnModels: void 0, rowModels: void 0, formula: void 0, draggingOnGraphpaper: !1, cachedViewState: {}, cachedParsableState: {}, cachedUndoRedoDiffState: {}, cachedUndoRedoFullState: {}, isExpanded: !1 }); t.columns = F(t.columns, o.generateId()); var a, i = 0; for (a = 0; a < t.columns.length; a++)t.columns[a].values || (t.columns[a].values = []), t.columns[a].values.length > i && (i = t.columns[a].values.length); for (a = 0; a < t.columns.length; a++)for (var u = i - t.columns[a].values.length; u > 0; u--)t.columns[a].values.push(""); return W(t), t }, e.buildEntireColumnStructure = W; var G = ["x", "y", "z", "u", "v", "w"]; function H(e) { var o = e.controller.getFocusLocation(); return o && "table" === o.type && o.id === e.id ? o.location : void 0 } function j(e, o) { for (var n = 0; n < e.columnModels.length; n++) { var l = e.columnModels[n]; if (l.id === o) return l } } function q(e, o) { e.isExpanded = o } function J(e) { var o = []; e.columnModels.forEach(function (e) { e.boundingBoxes && !e.hidden && (o = o.concat(e.boundingBoxes)) }), e.boundingBoxes = o } function K(e, o, n) { if (0 === o.row) { var l = j(e, e.columnModels[o.column].id); if (!l) return; return l.latex = n, void (o.column >= e.columnModels.length - 1 && I(e, o.column + 1, { id: e.controller.generateId(), latex: "", color: e.controller.getNextColor() })) } var t = e.columnModels[o.column]; e.columns[t.index].values[o.row - 1] = n, "" !== n && o.row >= e.columnModels[0].cells.length && D(e, o.row) } e.makeTableState = function (e, o, n) { for (var r = [], a = Math.min(o.length, G.length), u = 0; u < a; u++)r.push({ id: n.generateId(), latex: i.identifierToLatex(G[u] + "_" + e), values: o[u], color: n.getNextColor(), hidden: !1, points: !0, lines: !1, dragMode: t.DragMode.NONE, pointStyle: l.PointStyle.POINT, lineStyle: l.LineStyle.SOLID, colorLatex: "", lineWidth: "", lineOpacity: "", pointOpacity: "", pointSize: "" }); return { id: n.generateId(), type: "table", folderId: "", secret: !1, columns: r } }, e.cloneTableAndExtendWithProperties = function (e, o) { var n = B(e, { stripDefaults: !1 }); if (!n.columns || !o.columns) return o; for (var l = 0; l < o.columns.length; l++) { var t = n.columns[l], r = o.columns[l]; if (t) for (var a in t) t.hasOwnProperty(a) && (r.hasOwnProperty(a) || (r[a] = t[a])) } return o }, e.getSelectedCell = H, e.getColumnModel = j, e.setColumnPoints = function (e, o, n) { var l = j(e, o); l && (l.points = n, n || (l.dragMode = t.DragMode.NONE)) }, e.setColumnPointStyle = function (e, o, n) { var l = j(e, o); l && (l.pointStyle = n) }, e.setColumnLines = function (e, o, n) { var l = j(e, o); l && (l.lines = n) }, e.setColumnLineStyle = function (e, o, n) { var l = j(e, o); l && (l.lineStyle = n) }, e.setColumnLineWidth = function (e, o, n) { var l = j(e, o); l && (l.lineWidth = n) }, e.setColumnLineOpacity = function (e, o, n) { var l = j(e, o); l && (l.lineOpacity = n) }, e.setColumnPointSize = function (e, o, n) { var l = j(e, o); l && (l.pointSize = n) }, e.setColumnPointOpacity = function (e, o, n) { var l = j(e, o); l && (l.pointOpacity = n) }, e.setColumnDragMode = function (e, o, n) { var l = j(e, o); l && (l.dragMode = n, n === t.DragMode.NONE || l.points || (l.points = !0)) }, e.setColumnColor = function (e, o, n) { var l = j(e, o); l && g.default(n) && (l.color = n, l.colorLatex = "") }, e.setColumnColorLatex = function (e, o, n) { var l = j(e, o); l && (l.colorLatex = n) }, e.setExpanded = q, e.setColumnHidden = function (e, o, n) { var l = j(e, o); l && (l.hidden = n, n && J(e)) }, e.setColumnBoundingBoxes = function (e, o, n) { var l = j(e, o); l && (l.boundingBoxes = n, J(e)) }, e.mergeBoundingBoxes = J, e.shouldHideColumn = function (e, o) { var n = j(e, o); return !n || !n.points && !n.lines }, e.setCellLatex = K, e.doesCellExist = function (e, o) { return o.row < e.rowModels.length && o.column < e.columnModels.length }, e.isColumnEmpty = function (e) { if (e.values) for (var o = 0, n = e.values; o < n.length; o++)if ("" !== n[o]) return !1; if (e.computedValues) for (var l = 0, t = e.computedValues; l < t.length; l++)if ("" !== t[l]) return !1; return !0 } });
define('main/propagate_selection', ['require', 'graphing-calc/models/table'], function (require) { "use strict"; var e = require("graphing-calc/models/table"); function t(t) { var d = t && t.id; if (t && "table" === t.type) { var i = e.getSelectedCell(t); if (i) { var l = t.columnModels[i.column]; d = l ? l.id : void 0 } else d = void 0 } if (t && "folder" === t.type) { var r = t.selectedHiddenChild; d = r ? r.id : void 0 } return d } return { getSelectedId: t, propagateSelection: function (e, d, i, l) { var r = t(e.getSelectedItem()); return r !== l && d.select(r), r } } });
define('graphing/canvaslayer', ['require', 'jquery', 'pjs', 'browser'], function (require) { "use strict"; var t = require("jquery"), i = require("pjs"), a = require("browser"); return i(function (i) { i.init = function (i) { this.grapher = i, this.$ = t("<div class='dcg-graph-outer' role='img'></div>").attr("aria-roledescription", this.s("graphing-calculator-narration-graphpaper-label")), this.canvas_node = t("<canvas class='dcg-graph-inner'></canvas>").css("position", "relative").css("display", "block"), this.devicePixelRatio = window.devicePixelRatio || 1, this.ctx = this.canvas_node[0].getContext("2d"), this.resize(0, 0), a.IS_IOS && a.IS_IN_IFRAME && (this.$.css("-webkit-transform", "translate3d(0,-.25px,0)"), this.$.append('<div style="width:1px; height:.5px; pointer-events:none; opacity: 0;" aria-hidden="true">text</div>')), this.$.append(this.canvas_node) }, i.resize = function (t, i, a) { a = a || this.devicePixelRatio, t === this.width && i === this.height || (this.width = t, this.height = i, this.canvas_node.css("width", t + "px").css("height", i + "px").attr("width", t * a).attr("height", i * a), this.ctx = this.canvas_node[0].getContext("2d"), this.ctx.scale(a, a)) }, i.s = function (t, i) { return this.grapher.controller.s(t, i) }, i.getAriaLabel = function (t) { var i = ""; if (0 === t) return this.s("graphing-calculator-narration-empty-graphpaper"); i = 1 === t ? this.s("graphing-calculator-narration-graphpaper-one-graph") : this.s("graphing-calculator-narration-graphpaper-multiple-graphs", { count: t }); var r = this.grapher.getAudioTrace(); r && !r.getAudioTraceActive() && (void 0 !== r.agNavigator.getFirstTraceableSketch({ selectAssociatedExpression: !1 }) && (a.IS_APPLE ? i += " " + this.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-mac") : i += " " + this.s("graphing-calculator-narration-audio-instructions-enter-audio-trace-windows"))); return i }, i.updateAria = function (t, i) { this.$.attr("aria-hidden", !t || !this.grapher.settings.config.graphpaper).attr("tabindex", t && this.grapher.settings.config.graphpaper && this.grapher.settings.config.enableTabindex && i > 0 ? 0 : -1).attr("aria-label", this.getAriaLabel(i)) }, i.redraw = function () { } }) });

define('loadcss!poi', function () { });
define('graphing/constants', ["require", "exports"], function (require, A) { "use strict"; Object.defineProperty(A, "__esModule", { value: !0 }), A.LINE_WIDTH = A.OFFSCREEN_RENDER_MARGIN = A.POI_ALPHA = A.POLAR_ALPHA = A.HIGHLIGHTED_POINT_ALPHA = A.POINT_ALPHA = A.FILL_ALPHA = A.MAX_DOTTED_SEGMENTS = A.ZOOM_FACTOR = A.DOUBLETAP_ZOOM = A.ANIMATE_ZOOM_DURATION = void 0, A.ANIMATE_ZOOM_DURATION = 500, A.DOUBLETAP_ZOOM = 2, A.ZOOM_FACTOR = 1.0625, A.MAX_DOTTED_SEGMENTS = 1e3, A.FILL_ALPHA = .4, A.POINT_ALPHA = .9, A.HIGHLIGHTED_POINT_ALPHA = .6, A.POLAR_ALPHA = .2, A.POI_ALPHA = .01, A.OFFSCREEN_RENDER_MARGIN = 20, A.LINE_WIDTH = 2.5 });
define('graphing/dasheddrawer', ["require", "exports", "./constants", "core/math/distance"], function (require, t, s, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DashedDrawer = void 0; var e = function () { function t(t, i, e) { this.pattern = e, this.replen = this.pattern[0] + this.pattern[1], i / this.replen > s.MAX_DOTTED_SEGMENTS && (this.pattern[0] = i * this.pattern[0] / this.replen / s.MAX_DOTTED_SEGMENTS, this.pattern[1] = i * this.pattern[1] / this.replen / s.MAX_DOTTED_SEGMENTS), this.pstate = 0, this.dstaccum = 0, this.px = null, this.py = null, this.ctx = t } return t.getDashedPattern = function (t, s) { var i = 11 * t.lineWidth / (s ? 3.5 : 2.5); return [i, 7 * i / 11] }, t.getDottedPattern = function (t, s, i) { var e = .5 * t.lineWidth * .1 / (i ? 3.5 : 2.5), h = 8 * e / .1; return s && (h *= 2), [e, h] }, t.getTotalSegmentLength = function (t) { if (t.length < 4) return 0; for (var s, e, h = 0, n = 0, r = t[0], a = t[1]; isNaN(r) || isNaN(a);) { if ((n += 2) >= t.length) return 0; r = t[n], a = t[n + 1] } for (n += 2; n < t.length; n += 2)s = t[n], e = t[n + 1], isNaN(s) || isNaN(e) || (h += i.hypot(s - r, e - a), r = s, a = e); return h }, t.prototype.start = function (t, s) { this.ctx.desmos_batching || this.ctx.beginPath(), this.px = t, this.py = s }, t.prototype.next = function (t, s) { if (null === this.px || null === this.py) throw new Error("Must call start before calling next"); var i = this.pattern[this.pstate], e = Math.sqrt(Math.pow(t - this.px, 2) + Math.pow(s - this.py, 2)); if (e > 1e-5) { for (; e + this.dstaccum >= i;) { var h = t - this.px, n = s - this.py, r = i - this.dstaccum; h *= r / e, n *= r / e, 0 === this.pstate && (this.ctx.moveTo(this.px, this.py), this.ctx.lineTo(this.px + h, this.py + n)), this.dstaccum = 0, this.px += h, this.py += n, this.pstate = 0 === this.pstate ? 1 : 0, i = this.pattern[this.pstate], e -= r } 0 === this.pstate && (this.ctx.moveTo(this.px, this.py), this.ctx.lineTo(t, s)) } this.px = t, this.py = s, this.dstaccum += e }, t.prototype.close = function () { this.ctx.desmos_batching || this.ctx.stroke(), this.pstate = 0, this.dstaccum = 0, this.px = null, this.py = null }, t.prototype.drawSegment = function (t) { for (var s, i, e = 0, h = t[0], n = t[1]; isNaN(h) || isNaN(n);) { if ((e += 2) >= t.length) return; h = t[e], n = t[e + 1] } for (this.start(h, n), e += 2; e < t.length; e += 2)s = t[e], i = t[e + 1], isNaN(s) || isNaN(i) || this.next(s, i); this.close() }, t }(); t.DashedDrawer = e });
define('graphing/viewport', ["require", "exports"], function (require, t) { "use strict"; function i(t, i) { return t + 1e-8 * (i - t) > t && i - t > 1e-300 && i - t < 1e300 } Object.defineProperty(t, "__esModule", { value: !0 }), t.Viewport = void 0; var s = function () { function t(t, i, s, h) { void 0 === t && (t = -10), void 0 === i && (i = 10), void 0 === s && (s = -10), void 0 === h && (h = 10), this.xmin = t, this.xmax = i, this.ymin = s, this.ymax = h } return t.fromObject = function (i) { return new t(i.xmin, i.xmax, i.ymin, i.ymax) }, t.prototype.toObject = function () { return { xmin: this.xmin, ymin: this.ymin, xmax: this.xmax, ymax: this.ymax } }, t.prototype.equals = function (t) { return this.xmin === t.xmin && (this.ymin === t.ymin && (this.xmax === t.xmax && this.ymax === t.ymax)) }, t.prototype.isXValid = function () { return i(this.xmin, this.xmax) }, t.prototype.isYValid = function () { return i(this.ymin, this.ymax) }, t.prototype.isValid = function () { return this.isXValid() && this.isYValid() }, t.prototype.isSquare = function (t) { return Math.abs(t.height - t.width * this.aspectRatio()) < 1 }, t.prototype.aspectRatio = function () { return (this.ymax - this.ymin) / (this.xmax - this.xmin) }, t.prototype.squareXAxis = function (i) { var s = this.xmax - this.xmin, h = this.ymax - this.ymin, a = this.xmin + s / 2, n = h / i.height * i.width; return new t(a - n / 2, a + n / 2, this.ymin, this.ymax) }, t.prototype.squareYAxis = function (i) { var s = this.xmax - this.xmin, h = this.ymax - this.ymin, a = this.ymin + h / 2, n = s / i.width * i.height; return new t(this.xmin, this.xmax, a - n / 2, a + n / 2) }, t.prototype.squareCrop = function (t) { return this.aspectRatio() > t.height / t.width ? this.squareYAxis(t) : this.squareXAxis(t) }, t.prototype.polarDiameter = function () { var t = Math.abs(this.xmax), i = Math.abs(this.xmin), s = Math.abs(this.ymax), h = Math.abs(this.ymin); return 1.5 * Math.max(t, i, s, h) }, t.prototype.largestR = function () { return Math.sqrt(Math.pow(Math.max(-this.xmin, this.xmax), 2) + Math.pow(Math.max(-this.ymin, this.ymax), 2)) }, t.prototype.smallestR = function () { return this.xmin <= 0 && this.xmax >= 0 && this.ymin <= 0 && this.ymax >= 0 ? 0 : this.xmin <= 0 && this.xmax >= 0 ? Math.min(Math.abs(this.ymin), Math.abs(this.ymax)) : this.ymin <= 0 && this.ymax >= 0 ? Math.min(Math.abs(this.xmin), Math.abs(this.xmax)) : Math.sqrt(Math.pow(Math.max(this.xmin, -this.xmax), 2) + Math.pow(Math.max(this.ymin, -this.ymax), 2)) }, t }(); t.Viewport = s });
define('core/types/line-opacity', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.DEFAULT = void 0, e.DEFAULT = .9 });
define('core/types/point-opacity', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.DEFAULT = void 0, e.DEFAULT = .9 });
define('graphing/draw-image-to-ctx', ["require", "exports", "graphing-calc/models/list", "./svg-classes"], function (require, e, a, t) { "use strict"; var r; function i(e, a) { if (r && r.color === a && r.img === e) return r.canvas; r ? (r.color = a, r.img = e) : r = { color: a, img: e, canvas: document.createElement("canvas") }; var t = r.canvas; t.width = 0, t.width = e.width, t.height = e.height; var i = t.getContext("2d"); return i.drawImage(e, 0, 0), i.fillStyle = a, i.globalCompositeOperation = "source-atop", i.fillRect(0, 0, e.width, e.height), t } Object.defineProperty(e, "__esModule", { value: !0 }), e.drawImageToCtx = void 0, e.drawImageToCtx = function (e, r, s) { var l = e.formula; if (l && l.dimensions.x) for (var o = l.dimensions, c = 0; c < o.x.length; c++) { var d = o.x[c], n = o.y[c], g = o.width[c], m = o.height[c], h = o.radianAngle[c]; if (isFinite(d) && isFinite(n) && isFinite(g) && isFinite(m) && isFinite(h)) { t.save(r, "dcg-svg-image"), r.save(), t.restore(r), r.globalAlpha = o.opacity[c]; var b = s.mapy(m) - s.mapy(0), v = s.mapx(g) - s.mapx(0), p = 0 === h ? 1 : Math.abs(v / g * (m / b)), u = s.mapx(d), y = s.mapy(n), O = m < 0 ? -1 : 1, f = g < 0 ? -1 : 1, j = (u - v / 2) * f, x = (y + b * p / 2) * O, w = Math.abs(v), I = Math.abs(b); 0 !== h && (r.translate(u, y), r.scale(1, 1 / p), r.rotate(h), r.translate(-u, -y)), r.scale(f, O); var k, C, F = !1, L = !1, M = e.controller.getGrapher(); M && "2d" === M.type && (F = M.clickableObjectsLayer.shouldDrawHovered(e.id), k = M.clickableObjectsLayer.getHoveredObject(), L = M.clickableObjectsLayer.shouldDrawPressed(e.id), C = M.clickableObjectsLayer.getPressedObject()); var P = e.imageObj, S = P; L && C && C.listIndex == c ? S = e.depressedImageObj ? e.depressedImageObj : i(P, "rgba(50,50,50,0.2)") : F && k && k.listIndex === c && (S = e.hoveredImageObj ? e.hoveredImageObj : i(P, "rgba(200,200,200,0.2)")), r.drawImage(S, j, x, w, I * p), a.isItemSelected(e) && e.controller.isTraceEnabled() && (r.beginPath(), r.rect(j, x, w, I * p), r.restore(), r.save(), r.strokeStyle = "#6993C7", r.lineWidth = 2, r.stroke()), r.restore() } } } });
define('graphing/svg-groups', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.restore = e.setTitle = e.save = void 0, e.save = function (e, t) { var r = e; r._dcgStartNamedGroup && r._dcgStartNamedGroup(t) }, e.setTitle = function (e, t) { var r = e; r._dcgSetTitle && r._dcgSetTitle(t) }, e.restore = function (e) { var t = e; t._dcgEndNamedGroup && t._dcgEndNamedGroup() } });
define('graphing/graphslayer', ["require", "exports", "./clipping", "./dasheddrawer", "./constants", "./viewport", "core/types/graphmode", "core/lib/color-helpers", "core/types/styles", "core/types/line-opacity", "core/types/point-opacity", "core/types/point-size", "./draw-image-to-ctx", "./svg-groups", "./svg-classes", "core/math/distance"], function (require, e, t, i, r, o, a, l, n, s, d, c, h, g, p, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.GraphsLayer = void 0; var y = {}; function f(e) { return void 0 === e && (e = {}), Object.keys(e).length } function u(e, t) { return void 0 === t && (t = {}), 0 === f(t) ? e : e.filter(function (e, i) { return !t[i] }) } function A(e, t) { for (var i = [], r = 0; r < e; r++)i.push(t); return i } var O = function (e, t) { var i = 3; return t && (i += t), new o.Viewport(-i, e.width + i, -i, e.height + i) }, T = function () { function e(e, t) { if (this.getExpressionAriaLabel = t, e.config.plaidMode) for (var i = 0, r = ["RED", "BLUE", "GREEN", "PURPLE", "ORANGE", "BLACK"]; i < r.length; i++) { var o = r[i]; y[l.colors[o]] = document.createElement("img"), y[l.colors[o]].setAttribute("src", "/assets/img/april-fools/" + o.toLowerCase() + ".png") } } return e.prototype.redrawToCtx = function (t, i, r, o, a, l, n, s) { var d = this; g.save(t, "expressions"), a.forEach(function (a) { var c = r[a], p = o[a]; void 0 !== c && c.visible && (g.save(t, "sketch"), i.settings.takingScreenshot && g.setTitle(t, d.getExpressionAriaLabel(a)), e.drawSketchToCtx(r[a], t, i, l, n, s), g.restore(t)), p && p.shouldGraph && p.foreground && h.drawImageToCtx(p, t, i) }), g.restore(t) }, e.eachSegment = function (e, t) { for (var i = 0, r = e.branches; i < r.length; i++) { var o = r[i]; if (o.graphMode !== a.ERROR) for (var l = 0, n = o.segments; l < n.length; l++) { t(o, n[l]) } } }, e.drawSketchToCtx = function (t, i, o, l, h, g) { var p; if (g || (g = {}), t.branches && t.branches.length) { var v = i.lineWidth, u = i.globalAlpha, O = o.settings.globalCurveColor ? o.settings.globalCurveColor : t.color, T = y[O]; if (T && T.complete && T.naturalWidth > 0) { var m = i.createPattern(T, "repeat"); i.fillStyle = m } else i.fillStyle = O; i.strokeStyle = O, i.lineJoin = "round", i.lineCap = "round"; for (var b = !!o.settings.takingScreenshot, L = !!g.showMovablePoints, P = h.getHoveredObject(), S = h.getPressedObject(), x = 0, I = t.branches; x < I.length; x++) { var D = I[x]; if (D.graphMode !== a.XYPOINT && D.graphMode !== a.XYPOINT_MOVABLE && D.graphMode !== a.ERROR) { var w = 1; h.shouldDrawHovered(t.id) && P && P.listIndex === D.listIndex && (w = 1.2), h.shouldDrawPressed(t.id) && S && S.listIndex === D.listIndex && (w = 1.4), !D.color || o.settings.globalCurveColor || Object.keys(y).length || (i.fillStyle = D.color), D.graphMode !== a.POLAR && (i.desmos_batching = !0, i.beginPath()); for (var E = 0, _ = D.segments; E < _.length; E++) { var C = _[E], M = null !== (p = D.graphMode) && void 0 !== p ? p : a.Y; if (M !== a.POLYGONFILL || o.settings.disableFill) { if (M !== a.IMPLICIT) { var F = D.operator, H = "<=" == F || "<" == F; !o.settings.disableFill && ("<" == F || ">" == F || "<=" == F || ">=" == F) && e.fillGraphStrokeToCtx(i, o, C, H, M) } } else e.fillPolygonToCtx(i, o, C, void 0 === D.fillOpacity ? NaN : D.fillOpacity * w) } i.globalAlpha = e._clampedOpacity(void 0 === D.fillOpacity ? NaN : D.fillOpacity * w, r.FILL_ALPHA), D.graphMode !== a.POLAR && (i.fill(), i.desmos_batching = !1), i.globalAlpha = 1 } } e.eachSegment(t, function (l, d) { if (l.graphMode !== a.XYPOINT && l.graphMode !== a.XYPOINT_MOVABLE && l.graphMode !== a.ERROR) { var c = a.Y; l.graphMode && (c = l.graphMode); var g = d, p = void 0 !== l.lineWidth, v = l.lineWidth, y = r.LINE_WIDTH; if (i.strokeStyle = l.color, i.fillStyle = l.color, !p || !(v <= 0) && isFinite(v)) { i.lineWidth = p ? v : y; var f = o.settings.graphLineWidth / y; i.lineWidth *= f, i.globalAlpha *= o.settings.curveOpacity, i.globalAlpha = e._clampedOpacity(1 === o.settings.curveOpacity ? 1 : l.lineOpacity, s.DEFAULT); var u = l.operator, A = "default"; "<" === u || ">" === u || "!=" === u ? A = n.LineStyle.DASHED : "<=" === u || ">=" === u ? A = n.LineStyle.SOLID : t.style === n.LineStyle.DASHED || l.style === n.LineStyle.DASHED ? A = n.LineStyle.DASHED : t.style !== n.LineStyle.DOTTED && l.style !== n.LineStyle.DOTTED || (A = n.LineStyle.DOTTED, p && (i.lineWidth *= 2)); var O = h.getHoveredObject(), T = h.shouldDrawHovered(t.id) && O && O.listIndex === l.listIndex, m = h.getPressedObject(), b = h.shouldDrawPressed(t.id) && m && m.listIndex === l.listIndex; (b || T) && (i.save(), i.lineWidth += 4.5, i.globalAlpha *= b ? .5 : .3, e.drawGraphStrokeToCtx(i, o, g, A, c, u), i.restore()), e.drawGraphStrokeToCtx(i, o, g, A, c, u) } } }.bind(this)), i.lineWidth = v, i.globalAlpha = u, e.eachSegment(t, function (r, n) { if (r.graphMode === a.XYPOINT && r.showPoint || r.graphMode === a.XYPOINT_MOVABLE && b) { var s = n, g = [], p = void 0; if (r.interactiveLabel && t.labels) for (var v = 0, y = t.labels.length; v < y; v++) { var u = t.labels[v], O = l.isOpenPOI(u), T = l.getHoveredPOI() === u; g.push(O || T), !O && T && (p = v) } var m = r.graphMode === a.XYPOINT_MOVABLE && b && !L && 1 === r.pointOpacity, P = 1; "number" == typeof r.pointSize ? P = r.pointSize / c.DEFAULT : Array.isArray(r.pointSize) && (P = r.pointSize.map(function (e) { return e / c.DEFAULT })); var S = void 0; Array.isArray(r.color) && (S = r.color); var x = h.getHoveredObject(), I = h.shouldDrawHovered(t.id), D = h.getPressedObject(), w = h.shouldDrawPressed(t.id), E = r.droppedIndices; if (I || w) { var _ = s.length; E && (_ += f(E)); var C = A(_, 0), M = Array.isArray(P) ? P.slice() : A(_, P); w && D ? (C[D.listIndex] = .5, M[D.listIndex] *= 1.5) : I && x && (C[x.listIndex] = .3, M[x.listIndex] *= 1.5), e.drawPointsToCtx({ ctx: i, projection: o, segment: s, style: r.style, sizeOverrideIdxs: g, opacityOverrideIdx: p, sizeFactor: M, opacityFactor: C, colorOverrides: S, baseOpacity: r.pointOpacity, droppedIndices: E }), i.restore() } e.drawPointsToCtx({ ctx: i, projection: o, segment: s, style: r.style, sizeOverrideIdxs: g, opacityOverrideIdx: p, sizeFactor: P, opacityFactor: 1, colorOverrides: S, baseOpacity: m ? d.DEFAULT : r.pointOpacity, droppedIndices: E }) } }.bind(this)) } }, e.drawGraphStrokeToCtx = function (e, r, o, a, l, s) { var d = t.getClippingGraphType(l, "=" !== s, r.settings), c = t.mapSegmentToCanvas(o, r.viewport, r.screen, d), h = t.clipStrokeEdges(c, O(r.screen, e.lineWidth)); if (0 !== h.length) { if (e.save(), p.save(e, "dcg-svg-curve"), a == n.LineStyle.DASHED) new i.DashedDrawer(e, i.DashedDrawer.getTotalSegmentLength(h), i.DashedDrawer.getDashedPattern(e, !!r.settings.highlight)).drawSegment(h); else if (a == n.LineStyle.DOTTED) new i.DashedDrawer(e, i.DashedDrawer.getTotalSegmentLength(h), i.DashedDrawer.getDottedPattern(e, !!r.settings.config.projectorMode, !!r.settings.highlight)).drawSegment(h); else if (a !== n.LineStyle.SOLID && "default" !== a || 1 !== e.lineWidth) { e.desmos_batching || e.beginPath(), e.moveTo(h[0], h[1]); for (g = 0; g < h.length; g += 2)e.lineTo(h[g], h[g + 1]); e.desmos_batching || e.stroke() } else { if (e.desmos_batching || e.beginPath(), h.length > 4 || h[0] !== h[2] && h[1] !== h[3]) { e.moveTo(h[0], h[1]); for (var g = 0; g < h.length; g += 2)e.lineTo(h[g], h[g + 1]) } else { e.moveTo(v.halfRound(h[0]), v.halfRound(h[1])); for (var g = 0; g < h.length; g += 2)e.lineTo(v.halfRound(h[g]), v.halfRound(h[g + 1])) } e.desmos_batching || e.stroke() } p.restore(e), e.restore() } }, e.mapPointToScreen = function (e, t, i) { var r = e.mapx(t); if (r < -20 || r > e.screen.width + 20) return null; var o = e.mapy(i); return o < -20 || o > e.screen.height + 20 ? null : { x: r, y: o } }, e.drawPointToCtx = function (t, i, o, a, l, s, d, c, h, g) { var v = t.lineWidth, y = t.fillStyle, f = t.strokeStyle, u = e.mapPointToScreen(i, o, a); if (!u) return !1; if (void 0 !== c && (c <= 0 || !isFinite(c))) return !1; p.save(t, "dcg-svg-point"), t.globalAlpha = void 0 !== l ? l : r.POINT_ALPHA, void 0 !== h && (t.globalAlpha *= h), t.desmos_batching || t.beginPath(); var A = i.settings.pointLineWidth; if (d && (A = i.settings.config.projectorMode ? 17 : 11, t.lineWidth = A), void 0 !== c && (A *= c, t.lineWidth = A), g && (t.fillStyle = g, t.strokeStyle = g), s === n.PointStyle.CROSS) { var O = .4 * A; t.moveTo(u.x - O, u.y - O), t.lineTo(u.x + O, u.y + O), t.moveTo(u.x + O, u.y - O), t.lineTo(u.x - O, u.y + O), t.lineWidth = .3 * A } else if (s === n.PointStyle.OPEN) { O = .42 * A; t.moveTo(u.x + O, u.y), t.arc(u.x, u.y, O, 0, 2 * Math.PI, !0), t.closePath(), t.fillStyle = "white", t.lineWidth = .25 * A, t.fill() } else t.moveTo(u.x - .1, u.y - .1), t.lineTo(u.x - .1, u.y + .1), t.lineTo(u.x + .1, u.y + .1), t.lineTo(u.x + .1, u.y - .1); return t.desmos_batching || t.stroke(), t.globalAlpha = 1, t.lineWidth = v, t.fillStyle = y, t.strokeStyle = f, p.restore(t), !0 }, e.drawPointsToCtx = function (t) { var i, o = t.ctx, a = t.projection, l = t.segment, n = t.style, s = t.sizeOverrideIdxs, d = t.opacityOverrideIdx, c = t.sizeFactor, h = t.opacityFactor, g = t.colorOverrides, p = t.baseOpacity, v = t.droppedIndices, y = o.lineWidth; o.lineWidth = a.settings.pointLineWidth, i = Array.isArray(p) ? u(i = p.map(function (t) { return e._clampedOpacity(t, r.POINT_ALPHA) }.bind(this)), v) : e._clampedOpacity(p, r.POINT_ALPHA), Array.isArray(c) && (c = u(c, v)), Array.isArray(h) && (h = u(h, v)), g && (g = u(g, v)); for (var f = 0; f < l.length; f++)e.drawPointToCtx(o, a, l[f][0], l[f][1], d === f ? r.HIGHLIGHTED_POINT_ALPHA : Array.isArray(i) ? i[f] : i, n, s[f], Array.isArray(c) ? c[f] : c, Array.isArray(h) ? h[f] : h, g && g[f]); o.lineWidth = y }, e.fillGraphStrokeToCtx = function (e, i, o, l, n) { e.globalAlpha = n === a.POLAR ? r.POLAR_ALPHA : r.FILL_ALPHA; var s, d = null, c = null; if (n === a.POLAR) { c = t.ALL; var h = l ? 0 : i.viewport.polarDiameter(), g = i.settings.degreeMode ? 180 : 2 * Math.PI; d = t.computePolarFill(o, h, g) } else n === a.Y ? (c = t.Y, s = l ? i.viewport.ymin : i.viewport.ymax, d = t.computeCartesianFill(o, s)) : n === a.X && (c = t.X, s = l ? i.viewport.xmin : i.viewport.xmax, d = t.computeCartesianFill(o, s)); if (null !== d && null !== c) { for (var v = O(i.screen), y = 0, f = d; y < f.length; y++) { var u = f[y], A = t.getClippingGraphType(n, !0, i.settings), T = t.mapSegmentToCanvas(u, i.viewport, i.screen, A), m = t.clipFillEdges(T, v, c, !1); if (m.length >= 6) { p.save(e, "dcg-svg-region"), e.desmos_batching || e.beginPath(), e.moveTo(m[0], m[1]); for (var b = 2; b < m.length; b += 2)e.lineTo(m[b], m[b + 1]); e.lineTo(m[0], m[1]), e.desmos_batching || e.fill(), p.restore(e) } } e.globalAlpha = 1 } }, e._clampedOpacity = function (e, t) { return "number" != typeof e ? t : e < 0 ? 0 : e > 1 ? 1 : isFinite(e) ? e : t }, e.fillPolygonToCtx = function (i, o, a, l) { var n = O(o.screen); i.globalAlpha = e._clampedOpacity(l, r.FILL_ALPHA); var s = t.mapSegmentToCanvas(a, o.viewport, o.screen, t.Y_EQUALS), d = t.clipFillEdges(s, n, t.ALL, !1); if (d.length >= 6) { p.save(i, "dcg-svg-region"), i.desmos_batching || i.beginPath(), i.moveTo(d[0], d[1]); for (var c = 2; c < d.length; c += 2)i.lineTo(d[c], d[c + 1]); i.desmos_batching || i.fill(), p.restore(i) } i.globalAlpha = 1 }, e }(); e.GraphsLayer = T });
define('graphing/poidotslayer', ['require', 'loadcss!poi', 'pjs', './graphslayer', './constants'], function (require) { "use strict"; require("loadcss!poi"); var t = require("pjs"), i = require("./graphslayer").GraphsLayer, e = require("./constants"), n = t(function (t) { t.init = function () { this.savedPOI = [] }, t.redrawToCtx = function (t, i, e, r, o) { var a = []; for (var s in e) { var h = e[s]; if (h.visible) { h.showHighlight && n.drawSketchHighlight(h, t, i, r, o); var l = h.getPOI(); (h.showPOI || l.length && l[0].isAttachedToPlottedPoint()) && a.push.apply(a, n.drawPOIs(l, t, "#AAAAAA", i)) } } this.savedPOI = a }, t.getDrawnPOI = function () { return this.savedPOI } }); return n.drawSketchHighlight = function (t, e, n, r, o) { n.settings.setProperty("highlight", !0), i.drawSketchToCtx(t, e, n, r, o), n.settings.setProperty("highlight", !1) }, n.drawPOIs = function (t, n, r, o) { n.lineWidth = o.settings.pointLineWidth, n.strokeStyle = r || "#AAAAAA", n.fillStyle = r || "#AAAAAA", n.lineJoin = "round", n.lineCap = "round"; var a = n.globalAlpha; n.globalAlpha = e.POI_ALPHA; var s, h, l = [], A = t.length; if (A && t[0].isAttachedToPlottedPoint()) for (s = 0; s < A; s++)h = t[s], i.mapPointToScreen(o, h.x, h.y) && l.push(h); else for (s = 0; s < A; s++)h = t[s], i.drawPointToCtx(n, o, h.x, h.y) && l.push(h); return n.globalAlpha = a, l }, n });
define('graphing/stepnumber', ['require', 'pjs', './svg-classes'], function (require) { "use strict"; var t = require("pjs"), s = require("./svg-classes"), i = document.createElement("canvas").getContext("2d"), e = t(function (t) { t.init = function (t, s) { this._label = t, this._fontSize = s, this._layout = this._computeLayout(t, s) }, t._computeLayout = function (t, s) { var a = {}; return t.superscript ? (a.mantissa_height = s, e.setCtxFontSize(i, a.mantissa_height), a.mantissa_width = i.measureText(t.mantissa).width, a.superscript_height = Math.round(.8 * s), e.setCtxFontSize(i, a.superscript_height), a.superscript_width = i.measureText(t.superscript).width, a.mantissa_x = 0, a.mantissa_y = s / 5, a.superscript_x = a.mantissa_width / 2 + a.superscript_width / 2, a.superscript_y = -s / 4, a.top = a.superscript_y - a.superscript_height / 2, a.bottom = a.mantissa_y + a.mantissa_height / 2, a.left = a.mantissa_x - a.mantissa_width / 2, a.right = a.superscript_x + a.superscript_width / 2) : (a.mantissa_height = s, e.setCtxFontSize(i, s), a.mantissa_width = i.measureText(t.string).width, a.mantissa_x = 0, a.mantissa_y = 0, a.top = a.mantissa_y - a.mantissa_height / 2, a.bottom = a.mantissa_y + a.mantissa_height / 2, a.left = a.mantissa_x - a.mantissa_width / 2, a.right = a.mantissa_x + a.mantissa_width / 2), a }, t.getRect = function () { return this.getRectWhenCenteredAt({ x: 0, y: 0 }) }, t.getRectWhenCenteredAt = function (t) { return { left: this._layout.left + t.x, right: this._layout.right + t.x, top: this._layout.top + t.y, bottom: this._layout.bottom + t.y } }, t.getWidth = function () { return this._layout.right - this._layout.left }, t.getHeight = function () { return this._layout.bottom - this._layout.top }, t.clampBoundsWithinRect = function (t, s) { var i = {}; return t.x + this._layout.left < s.left ? i.x = s.left - this._layout.left : t.x + this._layout.right > s.right ? i.x = s.right - this._layout.right : i.x = t.x, t.y + this._layout.top < s.top ? i.y = s.top - this._layout.top : t.y + this._layout.bottom > s.bottom ? i.y = s.bottom - this._layout.bottom : i.y = t.y, i }, t.getValue = function () { return this._label.value }, t.getMinusWidth = function () { return this.getValue() < 0 ? (e.setCtxFontSize(i, this._fontSize), i.measureText("-1").width - i.measureText("1").width) : 0 }, t.getString = function () { return this._label.superscript ? this._label.mantissa + "^" + this._label.superscript : this._label.string }, t.drawCenteredAt = function (t, i, a) { var n = i.x, r = e.computeBaselineFromCenter(i.y, this._fontSize); a && s.save(t, a), t.save(), a && s.restore(t), e.setCtxFontSize(t, this._fontSize), this._label.superscript ? (t.strokeText(this._label.mantissa, this._layout.mantissa_x + n, this._layout.mantissa_y + r), t.strokeText(this._label.superscript, this._layout.superscript_x + n, this._layout.superscript_y + r), t.fillText(this._label.mantissa, this._layout.mantissa_x + n, this._layout.mantissa_y + r), t.fillText(this._label.superscript, this._layout.superscript_x + n, this._layout.superscript_y + r)) : (t.strokeText(this._label.string, this._layout.mantissa_x + n, this._layout.mantissa_y + r), t.fillText(this._label.string, this._layout.mantissa_x + n, this._layout.mantissa_y + r)), t.restore() } }); return e.computeBaselineFromCenter = function (t, s) { return t + .272 * s }, e.setCtxFontSize = function (t, s) { t.font = s + "px Arial", t.textAlign = "center" }, e });
define('graphing/computestepsizes', ['require', './stepnumber', 'core/lib/label'], function (require) { "use strict"; var t = require("./stepnumber"), e = require("core/lib/label"), i = {}, r = function (t, e, i, r) { var o = Math.ceil(t / i), a = Math.floor(e / i), n = 1 / i; if (!(o > a || a - o > 1e4)) for (var s = o; s <= a; s++)r(s / n) }; function o(t) { return t ? { base: 10, major: [t, 2 * t, 5 * t], minor: [4, 4, 5] } : i.RATIONAL_STEPS } return i.RATIONAL_STEPS = { base: 10, major: [1, 2, 5], minor: [5, 4, 5] }, i.PI_STEPS = { base: 10, major: [Math.PI, 2 * Math.PI, 5 * Math.PI], minor: [4, 4, 5] }, i.PI_FRAC_STEPS = { base: 2, major: [Math.PI / 3], minor: [3] }, i.bestStep = function (t, e) { for (var i, r, o, a, n = 1 / 0, s = 0; s < e.major.length; s++)i = e.major[s], o = Math.ceil(Math.log(t / i) / Math.log(e.base)), (a = i * Math.pow(e.base, o)) < n && (r = (n = a) / e.minor[s]); return { major: n, minor: r } }, i.countStepsInRange = function (t, e, i) { return 1 + (e - t) / i }, i.calculateSpaceBetweenRects = function (t, e) { var i, r; return r = t.right < e.left ? e.left - t.right : e.right < t.left ? t.left - e.right : 0, i = t.bottom < e.top ? e.top - t.bottom : e.bottom < t.top ? t.top - e.bottom : 0, Math.max(i, r) }, i.estimateMajors = function (t) { var e = t.screen.width, i = t.screen.height, r = t.viewport.xmax - t.viewport.xmin, o = t.viewport.ymax - t.viewport.ymin, a = t.settings.pixelsPerLabel; return { majorStepX: a / e * r, majorStepY: a / i * o } }, i.cartesian = function (a) { var n, s = {}, m = Math.abs(a.settings.xAxisStep), S = Math.abs(a.settings.yAxisStep), p = a.viewport.xmax - a.viewport.xmin, v = a.viewport.ymax - a.viewport.ymin, x = e.value(m, p).string.indexOf("Ï") >= 0, u = e.value(S, v).string.indexOf("Ï") >= 0, j = i.countStepsInRange(a.viewport.xmin, a.viewport.xmax, m), h = i.countStepsInRange(a.viewport.ymin, a.viewport.ymax, S), b = i.estimateMajors(a), g = a.settings.labelSize; if (m && m !== Math.PI && j >= 3 && j < 100) { var c = 0; a.settings.xAxisNumbers && r(a.viewport.xmin, a.viewport.xmax, m, function (i) { var r = t(e.value(i, p), g); c = Math.max(r.getWidth(), c) }), n = c + 10, a.settings.xAxisNumbers || (n = 1 === a.settings.xAxisMinorSubdivisions ? 8 : 20), j * n <= a.screen.width && (s.majorStepX = m, s.minorStepX = 3 === m || 5 === m ? 1 : m / 4) } if (S && S !== Math.PI && h >= 3 && h < 100) { var f = 0; a.settings.yAxisNumbers && r(a.viewport.ymin, a.viewport.ymax, S, function (i) { var r = t(e.value(i, v), g); f = Math.max(r.getHeight(), f) }), n = f + 10, a.settings.yAxisNumbers || (n = 1 === a.settings.yAxisMinorSubdivisions ? 8 : 20), h * n <= a.screen.height && (s.majorStepY = S, s.minorStepY = 3 === S || 5 === S ? 1 : S / 4) } if (!s.majorStepX) { var M; M = x ? b.majorStepX >= 1 ? i.PI_STEPS : i.PI_FRAC_STEPS : o(m); var l = i.bestStep(b.majorStepX, M); s.majorStepX = l.major, s.minorStepX = l.minor } if (!s.majorStepY) { var A; A = u ? b.majorStepY >= 1 ? i.PI_STEPS : i.PI_FRAC_STEPS : o(S); var P = i.bestStep(b.majorStepY, A); s.majorStepY = P.major, s.minorStepY = P.minor } if (m === S) { var w = a.screen.width / p / (a.screen.height / v); w >= 1 && w <= 2 ? (s.majorStepX = s.majorStepY, s.minorStepX = s.minorStepY) : w <= 1 && w >= .5 && (s.majorStepY = s.majorStepX, s.minorStepY = s.minorStepX) } return a.settings.xAxisMinorSubdivisions > 0 && (s.minorStepX = s.majorStepX / a.settings.xAxisMinorSubdivisions), a.settings.yAxisMinorSubdivisions > 0 && (s.minorStepY = s.majorStepY / a.settings.yAxisMinorSubdivisions), s }, i.polar = function (t) { var e = i.estimateMajors(t), r = i.bestStep(e.majorStepX, i.RATIONAL_STEPS), o = i.bestStep(e.majorStepY, i.RATIONAL_STEPS), a = r.major > o.major ? r : o; return { majorStepR: a.major, minorStepR: a.minor } }, i });
define('graphing/gridlayer', ['require', 'pjs', './stepnumber', 'core/lib/label', './computestepsizes', 'core/graphing-calc/json/graph-settings', './svg-classes', './svg-groups', 'core/math/distance'], function (require) { "use strict"; var t = require("pjs"), e = require("./stepnumber"), s = require("core/lib/label"), i = require("./computestepsizes"), a = require("core/graphing-calc/json/graph-settings").AxisArrowModes, r = require("./svg-classes"), o = require("./svg-groups"), n = require("core/math/distance").halfRound, h = t(function (t) { t.redrawToCtx = function (t, e, s) { var a, r; o.save(t, "graphpaper"); var n = e.settings.showGrid; if (e.settings.polarMode && n) a = i.polar(e), o.save(t, "grid"), this.drawPolarGrid(t, e, a), o.restore(t), o.save(t, "axis"), this.drawAxes(t, e, s), r = this.drawPolarStepNumbers(t, e, a), this.drawLabels(t, e, r), o.restore(t); else { a = i.cartesian(e), n && (o.save(t, "grid"), this.drawCartesianGrid(t, e, a), o.restore(t)); var h = !n; o.save(t, "axis"), this.drawAxes(t, e, s), r = this.drawCartesianStepNumbers(t, e, a, h), this.drawLabels(t, e, r), o.restore(t) } o.restore(t) }, t.addTextShadow = function (t, e) { t.strokeStyle = e.settings.getBackgroundColor(), t.lineWidth = 3, t.miterLimit = 2 }, t.drawPolarGrid = function (t, e, s) { t.save(); var i = e.settings.minorAxisOpacity, a = 1 - (1 - e.settings.majorAxisOpacity) / (1 - i), o = n(e.mapx(0)), h = n(e.mapy(0)), g = e.screen.height / (e.viewport.ymax - e.viewport.ymin), x = e.screen.width / (e.viewport.xmax - e.viewport.xmin), v = g / x, c = x / g, m = h / v, p = e.viewport.smallestR(), d = e.viewport.largestR(), f = s.minorStepR * Math.max(1, Math.floor(p / s.minorStepR)), u = s.majorStepR * Math.max(1, Math.floor(p / s.majorStepR)); t.lineWidth = 1, t.strokeStyle = "rgba(0, 0 , 0, " + i + ")", l(f, d, s.minorStepR, function (s) { r.save(t, "dcg-svg-minor-gridline"), t.beginPath(), r.restore(t), t.scale(1, v); var i = e.mapx(s) - o; t.moveTo(o + i, m), t.arc(o, m, i, 0, 2 * Math.PI), t.scale(1, c), t.stroke() }), l(0, 359, p > 0 ? 5 : 15, function (s) { if ((0 !== s && 180 !== s || !e.settings.showXAxis) && (90 !== s && 270 !== s || !e.settings.showYAxis)) { r.save(t, "dcg-svg-minor-gridline"), t.beginPath(), r.restore(t), t.moveTo(o, h); var i = e.mapx(d * Math.cos(s * Math.PI / 180)), a = e.mapy(d * Math.sin(s * Math.PI / 180)); t.lineTo(n(i), n(a)), t.stroke() } }), t.lineWidth = 1, t.strokeStyle = "rgba(0, 0 , 0, " + a + ")", l(u, d, s.majorStepR, function (s) { r.save(t, "dcg-svg-major-gridline"), t.beginPath(), r.restore(t), t.scale(1, v); var i = e.mapx(s) - o; t.moveTo(o + i, m), t.arc(o, m, i, 0, 2 * Math.PI), t.scale(1, c), t.stroke() }), t.restore() }, t.drawCartesianGrid = function (t, e, s) { t.save(); var i = e.viewport.xmin, a = e.viewport.ymin, o = e.viewport.xmax, h = e.viewport.ymax, g = e.screen.width, x = e.screen.height, v = x, c = 0; e.settings.restrictGridToFirstQuadrant && (i = 0, a = 0, v = e.mapy(0), c = e.mapx(0)); var m = e.settings.minorAxisOpacity, p = e.settings.majorAxisOpacity; t.lineWidth = 1, t.strokeStyle = "rgba(0, 0 , 0, " + m + ")", r.save(t, "dcg-svg-minor-gridline"), l(i, o, s.minorStepX, function (s) { if (0 !== s || !e.settings.showYAxis) { var i = n(e.mapx(s)); i !== n(0) && i !== n(g) && (t.beginPath(), t.moveTo(i, 0), t.lineTo(i, v), t.stroke()) } }), l(a, h, s.minorStepY, function (s) { if (0 !== s || !e.settings.showXAxis) { var i = n(e.mapy(s)); i !== n(0) && i !== n(x) && (t.beginPath(), t.moveTo(c, i), t.lineTo(g, i), t.stroke()) } }), r.restore(t); var d = 1 - (1 - p) / (1 - m); t.strokeStyle = "rgba(0, 0 , 0, " + d + ")", r.save(t, "dcg-svg-major-gridline"), l(i, o, s.majorStepX, function (s) { if (0 !== s || !e.settings.showYAxis) { var i = n(e.mapx(s)); i !== n(0) && i !== n(g) && (t.beginPath(), t.moveTo(i, 0), t.lineTo(i, v), t.stroke()) } }), l(a, h, s.majorStepY, function (s) { if (0 !== s || !e.settings.showXAxis) { var i = Math.round(e.mapy(s)); i !== n(0) && i !== n(x) && (t.beginPath(), t.moveTo(c, i), t.lineTo(g, i), t.stroke()) } }), r.restore(t), t.restore() }, t.drawAxes = function (t, e, s) { var i = e.settings.axisLineOffset, n = e.settings.axisOpacity.toString(), h = "rgba(127,205,230," + n + ")", l = "rgba(0,0,0," + n + ")", g = e.settings.xAxisArrowMode, x = e.settings.yAxisArrowMode, v = e.settings.showXAxis, c = e.settings.showYAxis, m = Math.round(e.mapx(0)) - i, p = Math.round(e.mapy(0)) - i, d = e.screen.height, f = e.screen.width; function u(e, s, i) { t.save(); var a = Math.PI / 12, r = 8 * Math.max(t.lineWidth, 1.5); t.lineJoin = "round", t.fillStyle = l, t.strokeStyle = l, t.beginPath(), t.moveTo(e, s), t.lineTo(e + Math.cos(i - a) * r, s + Math.sin(i - a) * r), t.lineTo(e + Math.cos(i + a) * r, s + Math.sin(i + a) * r), t.lineTo(e, s), t.lineTo(e + Math.cos(i - a) * r, s + Math.sin(i - a) * r), t.stroke(), t.fill(), t.restore() } var y = d, b = 0; e.settings.restrictGridToFirstQuadrant && (y = p, b = m, g === a.BOTH && (g = a.POSITIVE), x === a.BOTH && (x = a.POSITIVE)), c && (o.save(t, "yaxis"), e.settings.takingScreenshot && o.setTitle(t, e.settings.yAxisLabel || "Y axis"), r.save(t, "dcg-svg-axis-line"), t.lineWidth = 1 * e.settings.axisLineWidth, t.strokeStyle = "y" === s ? h : l, x === a.BOTH ? (t.beginPath(), t.moveTo(m, 2 * e.settings.axisLineWidth), t.lineTo(m, d - 2 * e.settings.axisLineWidth), t.stroke(), u(m, d - e.settings.axisLineWidth, 3 * Math.PI / 2), u(m, e.settings.axisLineWidth, Math.PI / 2)) : x === a.POSITIVE ? (t.beginPath(), t.moveTo(m, 2 * e.settings.axisLineWidth), t.lineTo(m, y), t.stroke(), u(m, e.settings.axisLineWidth, Math.PI / 2)) : (t.beginPath(), t.moveTo(m, 0), t.lineTo(m, y), t.stroke()), r.restore(t), o.restore(t)), v && (o.save(t, "xaxis"), e.settings.takingScreenshot && o.setTitle(t, e.settings.xAxisLabel || "X axis"), r.save(t, "dcg-svg-axis-line"), t.lineWidth = 1 * e.settings.axisLineWidth, t.strokeStyle = "x" === s ? h : l, g === a.BOTH ? (t.beginPath(), t.moveTo(2 * e.settings.axisLineWidth, p), t.lineTo(f - 2 * e.settings.axisLineWidth, p), t.stroke(), u(e.settings.axisLineWidth, p, 0), u(f - e.settings.axisLineWidth, p, Math.PI)) : g === a.POSITIVE ? (t.beginPath(), t.lineTo(b, p), t.lineTo(f - 2 * e.settings.axisLineWidth, p), t.stroke(), u(f - e.settings.axisLineWidth, p, Math.PI)) : (t.beginPath(), t.lineTo(b, p), t.lineTo(f, p), t.stroke()), r.restore(t), o.restore(t)) }, t.drawPolarStepNumbers = function (t, i, a) { t.save(); var o = i.settings.showGrid, n = i.settings.xAxisNumbers && i.settings.showXAxis, h = i.settings.yAxisNumbers && i.settings.showYAxis, v = o && i.settings.polarNumbers, c = i.viewport.largestR(), m = i.viewport.smallestR(), p = i.viewport.xmin, d = i.viewport.xmax, f = i.viewport.ymin, u = i.viewport.ymax, y = i.screen.width, b = i.screen.height, w = { left: 3, right: y - 3, top: 3, bottom: b - 3 }, T = i.settings.labelHangingColor, M = i.settings.getTextColor(), S = i.settings.labelSize, A = S; function L(t, e, s) { var a = Math.sqrt(t * t - e * e); f <= a && a <= u && s.push({ x: i.mapx(e), y: i.mapy(a) }), f <= -a && -a <= u && s.push({ x: i.mapx(e), y: i.mapy(-a) }) } function P(t, e, s) { var a = Math.sqrt(t * t - e * e); p <= a && a <= d && s.push({ x: i.mapx(a), y: i.mapy(e) }), p <= -a && -a <= d && s.push({ x: i.mapx(-a), y: i.mapy(e) }) } this.addTextShadow(t, i), t.fillStyle = M; var k = i.mapx(0), _ = i.mapy(0), W = f <= 0 && 0 <= u && n, R = p <= 0 && 0 <= d && h, O = ""; if (!W && !R && o) { var C, I, j, B, E = Math.abs(k), X = Math.abs(k - y), Y = Math.abs(_), V = Math.abs(_ - b); E <= X ? (C = "left", j = E) : (C = "right", j = X), Y <= V ? (I = "top", B = Y) : (I = "bottom", B = V), n && h ? O = j <= B ? C : I : h ? O = C : n && (O = I) } var F = { left: 0, right: y, top: _ - 1, bottom: _ + 1 }, G = { left: k - 1, right: k + 1, top: 0, bottom: b }; if (l(0, c, a.majorStepR, function (a) { var r = [], o = [], l = [], g = e(s.value(a, c), S), v = g.getRect(); switch (a > 0 ? (R && f <= a && a <= u && o.push({ x: k - v.right - 5, y: i.mapy(a) }), R && f <= -a && -a <= u && o.push({ x: k - v.right - 5, y: i.mapy(-a) }), W && p <= a && a <= d && r.push({ x: i.mapx(a), y: _ - v.top + 3 }), W && p <= -a && -a <= d && r.push({ x: i.mapx(-a), y: _ - v.top + 3 })) : R && !n && f <= a && a <= u ? o.push({ x: k - v.right - 5, y: i.mapy(a) }) : W && !h && p <= a && a <= d && r.push({ x: i.mapx(a), y: _ - v.top + 3 }), O) { case "top": P(a, u, l); break; case "bottom": P(a, f, l); break; case "left": L(a, p, l); break; case "right": L(a, d, l) }r.forEach(function (e) { e = g.clampBoundsWithinRect(e, w), g.drawCenteredAt(t, e, "dcg-svg-axis-value"), x(F, g.getRectWhenCenteredAt(e)) }), o.forEach(function (e) { e = g.clampBoundsWithinRect(e, w), g.drawCenteredAt(t, e, "dcg-svg-axis-value"), x(G, g.getRectWhenCenteredAt(e)) }), l.forEach(function (e) { e = g.clampBoundsWithinRect(e, w), g.drawCenteredAt(t, e, "dcg-svg-axis-value") }) }), v) { var N = Math.ceil(m / a.majorStepR), z = Math.floor(c / a.majorStepR), H = Math.ceil((N + z) / 2) * a.majorStepR; l(0, 359, m > 0 ? 15 : 30, function (a) { var o; o = i.settings.degreeMode ? a.toString() + "Â°" : s.value(a * Math.PI / 180, 2 * Math.PI).string; var n = t.measureText(o).width / 2, h = H / 1.05, l = h * Math.cos(a * Math.PI / 180), x = h * Math.sin(a * Math.PI / 180); if (!(l < p || l > d || x < f || x > u)) { var v = i.mapx(l), c = i.mapy(x); 0 === a || 180 === a ? c -= A : 90 !== a && 270 !== a || (v += n + 3); var m = g(v, 3 + n, y - 3 - n), w = g(c, 3 + A, b - 3 - A); w = e.computeBaselineFromCenter(w, S), r.save(t, "dcg-svg-polar-axis-value"), t.save(), r.restore(t), t.fillStyle = T, e.setCtxFontSize(t, S), t.strokeText(o, m, w), t.fillText(o, m, w), t.restore() } }) } return t.restore(), { x: F, y: G } }, t.drawLabels = function (t, e, s) { var i = e.viewport.xmin, a = e.viewport.xmax, o = e.viewport.ymin, n = e.viewport.ymax, h = e.screen.width, l = e.screen.height, g = (a - i) / h, x = (n - o) / l, c = e.settings.getTextColor(), m = e.mapx(0), p = e.mapy(0), d = e.settings.labelSize, f = e.settings.showXAxis && e.settings.xAxisLabel, u = e.settings.showYAxis && e.settings.yAxisLabel, y = s.x, b = s.y; if (f && y) { var w; if (r.save(t, "dcg-svg-axis-label"), t.save(), r.restore(t), t.fillStyle = c, t.__xLabelOffset && e.settings.isViewportTransient && v(t.__xLabelOffset.xscale, g) && v(t.__xLabelOffset.yscale, x) && (w = { x: t.__xLabelOffset.x + m, y: t.__xLabelOffset.y + p }), this._setAxisLabelFont(t, f, d, e), !w) { var T = h - t.measureText(f).width - 15, M = d; w = y.bottom + M < l ? { x: T, y: y.bottom + M } : { x: T, y: y.top - M / 2 }, t.__xLabelOffset = { x: w.x - m, y: w.y - p, xscale: g, yscale: x } } t.strokeText(f, w.x, w.y), t.fillText(f, w.x, w.y), t.restore() } else t.__xLabelPosition = null; if (u && b) { var S; if (r.save(t, "dcg-svg-axis-label"), t.save(), r.restore(t), t.fillStyle = c, t.__yLabelOffset && e.settings.isViewportTransient && v(t.__yLabelOffset.xscale, g) && v(t.__yLabelOffset.yscale, x) && (S = { x: t.__yLabelOffset.x + m, y: t.__yLabelOffset.y + p }), this._setAxisLabelFont(t, u, d, e), !S) { var A = t.measureText(u).width, L = d, P = A + 5; if (!this._isShortMathyLabel(u)) { var k = A; A = L, L = k, P = .5 * A } var _ = 15 + L; S = b.left - A > 0 ? { x: b.left - P, y: _ } : { x: b.right + A, y: _ }, t.__yLabelOffset = { x: S.x - m, y: S.y - p, xscale: g, yscale: x } } t.translate(S.x, S.y), this._isShortMathyLabel(u) || t.rotate(-Math.PI / 2), t.strokeText(u, 0, 0), t.fillText(u, 0, 0), t.restore() } else t.__yLabelPosition = null }, t._isShortMathyLabel = function (t) { return t.trim().match(/^([a-zA-Z]?)\(?([a-zA-Z]?)\)?$/) }, t._setAxisLabelFont = function (t, e, s, i) { this.addTextShadow(t, i), this._isShortMathyLabel(e) ? t.font = "italic " + Math.round(1.4 * s.toString()) + "px Times" : t.font = Math.round(1.2 * s.toString()) + "px Arial" }, t.drawCartesianStepNumbers = function (t, i, a, o) { t.save(); var n = i.settings.showXAxis, h = i.settings.showYAxis, g = n && i.settings.xAxisNumbers, v = h && i.settings.yAxisNumbers, c = i.viewport.xmin, m = i.viewport.xmax, p = i.viewport.ymin, d = i.viewport.ymax, f = i.screen.width, u = i.screen.height, y = { left: 3, top: 3, right: f - 3, bottom: u - 3 }; i.settings.restrictGridToFirstQuadrant && (c = 0, p = 0); var b = i.settings.labelHangingColor, w = i.settings.getTextColor(), T = i.mapx(0), M = i.mapy(0), S = i.settings.labelSize; this.addTextShadow(t, i); var A = { left: 0, right: f, top: M - 1, bottom: M + 1 }, L = { left: T - 1, right: T + 1, top: 0, bottom: u }, P = !1; if (n && h && (g || v)) { P = !0, t.fillStyle = w; var k = e(s.value(0, 1), S); k.drawCenteredAt(t, { x: T - k.getRect().right - 5, y: M - k.getRect().top + 5 }, "dcg-svg-axis-value") } var _ = [], W = []; if (g && l(c, m, a.majorStepX, function (t) { var i = e(s.value(t, m - c), S); "0" === i.getString() && P || _.push(i) }), v && l(p, d, a.majorStepY, function (t) { var i = e(s.value(t, d - p), S); "0" === i.getString() && P || W.push(i) }), o) { t.save(), r.save(t, "dcg-svg-tickmark"); var R = i.settings.axisLineOffset, O = "rgba(0,0,0," + i.settings.axisOpacity.toString() + ")"; t.lineWidth = i.settings.axisLineWidth, t.strokeStyle = O; var C = Math.round(i.mapy(0)) - R, I = Math.round(i.mapx(0)) - R, j = Math.round(2 * t.lineWidth) - R; t.beginPath(), _.forEach(function (e) { var s = Math.round(i.mapx(e.getValue())) - R; t.moveTo(s, C - j), t.lineTo(s, C + j) }), W.forEach(function (e) { var s = Math.round(i.mapy(e.getValue())) - R; t.moveTo(I - j, s), t.lineTo(I + j, s) }), t.stroke(), r.restore(t), t.restore() } return _.forEach(function (e) { var s = { x: i.mapx(e.getValue()) - .5 * e.getMinusWidth(), y: M - e.getRect().top + 5 }, a = e.clampBoundsWithinRect(s, y); t.fillStyle = s.y === a.y ? w : b; var o = "dcg-svg-axis-value"; s.x !== a.x && (o += " dcg-svg-offcenter-axis-value"), e.drawCenteredAt(t, a, o), x(A, e.getRectWhenCenteredAt(a)), r.restore(t) }), W.forEach(function (e) { var s = { x: T - 5 - e.getRect().right, y: i.mapy(e.getValue()) }, a = e.clampBoundsWithinRect(s, y); t.fillStyle = s.x === a.x ? w : b; var o = "dcg-svg-axis-value"; s.y !== a.y && (o += " dcg-svg-offcenter-axis-value"), e.drawCenteredAt(t, a, o), x(L, e.getRectWhenCenteredAt(a)), r.restore(t) }), t.restore(), { x: A, y: L } } }), l = function (t, e, s, i) { var a = Math.ceil(t / s), r = Math.floor(e / s); if (isFinite(r - a) && !(r - a > 1e4)) for (var o = a; o <= r; o++)i(o * s) }, g = function (t, e, s) { return t < e ? e : t > s ? s : t }, x = function (t, e) { e.left < t.left && (t.left = e.left), e.right > t.right && (t.right = e.right), e.top < t.top && (t.top = e.top), e.bottom > t.bottom && (t.bottom = e.bottom) }, v = function (t, e) { var s = Math.abs(t), i = Math.abs(e); return Math.abs(s - i) <= 1e-4 * (s < i ? i : s) }; return h });
define('vendor/canvas2svg', [], function () { "use strict"; var t, e, r, i, s; function n(t, e) { var r, i = Object.keys(e); for (r = 0; r < i.length; r++)t = t.replace(new RegExp("\\{" + i[r] + "\\}", "gi"), e[i[r]]); return t } function a(t) { var e, r, i; if (!t) throw new Error("cannot create a random attribute name for an undefined object"); e = "ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz", r = ""; do { for (r = "", i = 0; i < 12; i++)r += e[Math.floor(Math.random() * e.length)] } while (t[r]); return r } s = function (t, e) { var r, i, s, n = {}; for (t = t.split(","), e = e || 10, r = 0; r < t.length; r += 2)i = "&" + t[r + 1] + ";", s = parseInt(t[r], e), n[i] = "&#" + s + ";"; return n["\\xa0"] = "&#160;", n }("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro", 32), t = { strokeStyle: { svgAttr: "stroke", canvas: "#000000", svg: "none", apply: "stroke" }, fillStyle: { svgAttr: "fill", canvas: "#000000", svg: null, apply: "fill" }, lineCap: { svgAttr: "stroke-linecap", canvas: "butt", svg: "butt", apply: "stroke" }, lineJoin: { svgAttr: "stroke-linejoin", canvas: "miter", svg: "miter", apply: "stroke" }, miterLimit: { svgAttr: "stroke-miterlimit", canvas: 10, svg: 4, apply: "stroke" }, lineWidth: { svgAttr: "stroke-width", canvas: 1, svg: 1, apply: "stroke" }, globalAlpha: { svgAttr: "opacity", canvas: 1, svg: 1, apply: "fill stroke" }, font: { canvas: "10px sans-serif" }, shadowColor: { canvas: "#000000" }, shadowOffsetX: { canvas: 0 }, shadowOffsetY: { canvas: 0 }, shadowBlur: { canvas: 0 }, textAlign: { canvas: "start" }, textBaseline: { canvas: "alphabetic" }, lineDash: { svgAttr: "stroke-dasharray", canvas: [], svg: null, apply: "stroke" } }, (r = function (t, e) { this.__root = t, this.__ctx = e }).prototype.addColorStop = function (t, e) { var r, i = this.__ctx.__createElement("stop"); i.setAttribute("offset", t), -1 !== e.indexOf("rgba") ? (r = /rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(e), i.setAttribute("stop-color", n("rgb({r},{g},{b})", { r: r[1], g: r[2], b: r[3] })), i.setAttribute("stop-opacity", r[4])) : i.setAttribute("stop-color", e), this.__root.appendChild(i) }, i = function (t, e) { this.__root = t, this.__ctx = e }, (e = function (t) { var r, i = { width: 500, height: 500, enableMirroring: !1 }; if (arguments.length > 1 ? ((r = i).width = arguments[0], r.height = arguments[1]) : r = t || i, !(this instanceof e)) return new e(r); this._randomPostfix = "-" + "xxxxxxxx".replace(/x/g, function (t) { return (16 * Math.random() | 0).toString(16) }), this._svgClassNames = [], this.width = r.width || i.width, this.height = r.height || i.height, this.enableMirroring = void 0 !== r.enableMirroring ? r.enableMirroring : i.enableMirroring, this.canvas = this, this.__document = r.document || document, r.ctx ? this.__ctx = r.ctx : (this.__canvas = this.__document.createElement("canvas"), this.__ctx = this.__canvas.getContext("2d")), this.__setDefaultStyles(), this.__stack = [this.__getStyleState()], this.__groupStack = [], this.__root = this.__document.createElementNS("http://www.w3.org/2000/svg", "svg"), this.__root.setAttribute("version", 1.1), this.__root.setAttribute("xmlns", "http://www.w3.org/2000/svg"), this.__root.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:xlink", "http://www.w3.org/1999/xlink"), this.__root.setAttribute("width", this.width), this.__root.setAttribute("height", this.height), this.__ids = {}, this.__defs = this.__document.createElementNS("http://www.w3.org/2000/svg", "defs"), this.__root.appendChild(this.__defs), this.__currentElement = this.__document.createElementNS("http://www.w3.org/2000/svg", "g"), this.__root.appendChild(this.__currentElement) }).prototype.__createElement = function (t, e, r) { void 0 === e && (e = {}); var i, s, n = this.__document.createElementNS("http://www.w3.org/2000/svg", t), a = Object.keys(e); for (r && (n.setAttribute("fill", "none"), n.setAttribute("stroke", "none")), i = 0; i < a.length; i++)s = a[i], n.setAttribute(s, e[s]); var o = this._svgClassNames && this._svgClassNames[this._svgClassNames.length - 1]; return o && n.setAttribute("class", o), n }, e.prototype.__setDefaultStyles = function () { var e, r, i = Object.keys(t); for (e = 0; e < i.length; e++)this[r = i[e]] = t[r].canvas }, e.prototype.__applyStyleState = function (t) { var e, r, i = Object.keys(t); for (e = 0; e < i.length; e++)this[r = i[e]] = t[r] }, e.prototype.__getStyleState = function () { var e, r, i = {}, s = Object.keys(t); for (e = 0; e < s.length; e++)i[r = s[e]] = this[r]; return i }, e.prototype.__applyStyleToCurrentElement = function (e) { var s = this.__currentElement, a = this.__currentElementsToStyle; a && (s.setAttribute(e, ""), s = a.element, a.children.forEach(function (t) { t.setAttribute(e, "") })); var o, h, l, c, _, p = Object.keys(t); for (o = 0; o < p.length; o++)if (h = t[p[o]], l = this[p[o]], h.apply) if (l instanceof i) { if (l.__ctx) for (; l.__ctx.__defs.childNodes.length;)c = l.__ctx.__defs.childNodes[0].getAttribute("id"), this.__ids[c] = c, this.__defs.appendChild(l.__ctx.__defs.childNodes[0]); s.setAttribute(h.apply, n("url(#{id})", { id: l.__root.getAttribute("id") })) } else if (l instanceof r) s.setAttribute(h.apply, n("url(#{id})", { id: l.__root.getAttribute("id") })); else if (-1 !== h.apply.indexOf(e) && h.svg !== l) if ("stroke" !== h.svgAttr && "fill" !== h.svgAttr || -1 === l.indexOf("rgba")) { var u = h.svgAttr; if ("globalAlpha" === p[o] && (u = e + "-" + h.svgAttr, s.getAttribute(u))) continue; s.setAttribute(u, l) } else { _ = /rgba\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d?\.?\d*)\s*\)/gi.exec(l), s.setAttribute(h.svgAttr, n("rgb({r},{g},{b})", { r: _[1], g: _[2], b: _[3] })); var d = _[4], g = this.globalAlpha; null != g && (d *= g), s.setAttribute(h.svgAttr + "-opacity", d) } }, e.prototype.__closestGroupOrSvg = function (t) { return "g" === (t = t || this.__currentElement).nodeName || "svg" === t.nodeName ? t : this.__closestGroupOrSvg(t.parentNode) }, e.prototype.getSerializedSvg = function (t) { var e, r, i, n, a, o = (new XMLSerializer).serializeToString(this.__root); if (/xmlns="http:\/\/www\.w3\.org\/2000\/svg".+xmlns="http:\/\/www\.w3\.org\/2000\/svg/gi.test(o) && (o = o.replace('xmlns="http://www.w3.org/2000/svg', 'xmlns:xlink="http://www.w3.org/1999/xlink')), t) for (e = Object.keys(s), r = 0; r < e.length; r++)i = e[r], n = s[i], (a = new RegExp(i, "gi")).test(o) && (o = o.replace(a, n)); return o }, e.prototype.getSvg = function () { return this.__root }, e.prototype._dcgStartNamedGroup = function (t) { var e = this.__createElement("g"); e.setAttribute("id", t + this._randomPostfix); var r = this.__closestGroupOrSvg(); this.__groupStack.push(r), r.appendChild(e), this.__currentElement = e }, e.prototype._dcgEndNamedGroup = function () { this.__currentElement = this.__groupStack.pop(), this.__currentElement || (this.__currentElement = this.__root.childNodes[1]) }, e.prototype._dcgSaveClassName = function (t) { this._svgClassNames.push(t), this.__currentElement && "path" === this.__currentElement.tagName && !this.__currentDefaultPath && (this.__currentElement.getAttribute("class") || this.__currentElement.setAttribute("class", t)) }, e.prototype._dcgRestoreClassName = function () { this._svgClassNames.pop() }, e.prototype.save = function () { var t = this.__createElement("g"), e = this.__closestGroupOrSvg(); this.__groupStack.push(e), e.appendChild(t), this.__currentElement = t, this.__stack.push(this.__getStyleState()) }, e.prototype.restore = function () { this.__currentElement = this.__groupStack.pop(), this.__currentElementsToStyle = null, this.__currentElement || (this.__currentElement = this.__root.childNodes[1]); var t = this.__stack.pop(); this.__applyStyleState(t) }, e.prototype.__addTransform = function (t) { var e = this.__closestGroupOrSvg(); if (e.childNodes.length > 0) { "path" === this.__currentElement.nodeName && (this.__currentElementsToStyle || (this.__currentElementsToStyle = { element: e, children: [] }), this.__currentElementsToStyle.children.push(this.__currentElement), this.__applyCurrentDefaultPath()); var r = this.__createElement("g"); e.appendChild(r), this.__currentElement = r } var i = this.__currentElement.getAttribute("transform"); i ? i += " " : i = "", i += t, this.__currentElement.setAttribute("transform", i) }, e.prototype.scale = function (t, e) { void 0 === e && (e = t), this.__addTransform(n("scale({x},{y})", { x: t, y: e })) }, e.prototype.rotate = function (t) { var e = 180 * t / Math.PI; this.__addTransform(n("rotate({angle},{cx},{cy})", { angle: e, cx: 0, cy: 0 })) }, e.prototype.translate = function (t, e) { this.__addTransform(n("translate({x},{y})", { x: t, y: e })) }, e.prototype.transform = function (t, e, r, i, s, a) { this.__addTransform(n("matrix({a},{b},{c},{d},{e},{f})", { a: t, b: e, c: r, d: i, e: s, f: a })) }, e.prototype.beginPath = function () { var t; this.__currentDefaultPath = "", this.__currentPosition = {}, t = this.__createElement("path", {}, !0), this.__closestGroupOrSvg().appendChild(t), this.__currentElement = t }, e.prototype.__applyCurrentDefaultPath = function () { var t = this.__currentElement; "path" === t.nodeName ? t.setAttribute("d", this.__currentDefaultPath) : console.error("Attempted to apply path command to node", t.nodeName) }, e.prototype.__addPathCommand = function (t) { this.__currentDefaultPath += " ", this.__currentDefaultPath += t }, e.prototype.moveTo = function (t, e) { "path" !== this.__currentElement.nodeName && this.beginPath(), this.__currentPosition = { x: t, y: e }, this.__addPathCommand(n("M {x} {y}", { x: t, y: e })) }, e.prototype.closePath = function () { this.__currentDefaultPath && this.__addPathCommand("Z") }, e.prototype.lineTo = function (t, e) { this.__currentPosition = { x: t, y: e }, this.__currentDefaultPath.indexOf("M") > -1 ? this.__addPathCommand(n("L {x} {y}", { x: t, y: e })) : this.__addPathCommand(n("M {x} {y}", { x: t, y: e })) }, e.prototype.bezierCurveTo = function (t, e, r, i, s, a) { this.__currentPosition = { x: s, y: a }, this.__addPathCommand(n("C {cp1x} {cp1y} {cp2x} {cp2y} {x} {y}", { cp1x: t, cp1y: e, cp2x: r, cp2y: i, x: s, y: a })) }, e.prototype.quadraticCurveTo = function (t, e, r, i) { this.__currentPosition = { x: r, y: i }, this.__addPathCommand(n("Q {cpx} {cpy} {x} {y}", { cpx: t, cpy: e, x: r, y: i })) }; var o = function (t) { var e = Math.sqrt(t[0] * t[0] + t[1] * t[1]); return [t[0] / e, t[1] / e] }; return e.prototype.arcTo = function (t, e, r, i, s) { var n = this.__currentPosition && this.__currentPosition.x, a = this.__currentPosition && this.__currentPosition.y; if (void 0 !== n && void 0 !== a) { if (s < 0) throw new Error("IndexSizeError: The radius provided (" + s + ") is negative."); if (n === t && a === e || t === r && e === i || 0 === s) this.lineTo(t, e); else { var h = o([n - t, a - e]), l = o([r - t, i - e]); if (h[0] * l[1] != h[1] * l[0]) { var c = h[0] * l[0] + h[1] * l[1], _ = Math.acos(Math.abs(c)), p = o([h[0] + l[0], h[1] + l[1]]), u = s / Math.sin(_ / 2), d = t + u * p[0], g = e + u * p[1], m = [-h[1], h[0]], f = [l[1], -l[0]], y = function (t) { var e = t[0]; return t[1] >= 0 ? Math.acos(e) : -Math.acos(e) }, v = y(m), x = y(f); this.lineTo(d + m[0] * s, g + m[1] * s), this.arc(d, g, s, v, x) } else this.lineTo(t, e) } } }, e.prototype.stroke = function () { "path" === this.__currentElement.nodeName && this.__currentElement.setAttribute("paint-order", "fill stroke markers"), this.__applyCurrentDefaultPath(), this.__applyStyleToCurrentElement("stroke") }, e.prototype.fill = function () { "path" === this.__currentElement.nodeName && this.__currentElement.setAttribute("paint-order", "stroke fill markers"), this.__applyCurrentDefaultPath(), this.__applyStyleToCurrentElement("fill") }, e.prototype.rect = function (t, e, r, i) { "path" !== this.__currentElement.nodeName && this.beginPath(), this.moveTo(t, e), this.lineTo(t + r, e), this.lineTo(t + r, e + i), this.lineTo(t, e + i), this.lineTo(t, e), this.closePath() }, e.prototype.fillRect = function (t, e, r, i) { var s; s = this.__createElement("rect", { x: t, y: e, width: r, height: i }, !0), this.__closestGroupOrSvg().appendChild(s), this.__currentElement = s, this.__applyStyleToCurrentElement("fill") }, e.prototype.strokeRect = function (t, e, r, i) { var s; s = this.__createElement("rect", { x: t, y: e, width: r, height: i }, !0), this.__closestGroupOrSvg().appendChild(s), this.__currentElement = s, this.__applyStyleToCurrentElement("stroke") }, e.prototype.__clearCanvas = function () { for (var t = this.__closestGroupOrSvg().getAttribute("transform"), e = this.__root.childNodes[1], r = e.childNodes, i = r.length - 1; i >= 0; i--)r[i] && e.removeChild(r[i]); this.__currentElement = e, this.__groupStack = [], t && this.__addTransform(t) }, e.prototype.clearRect = function (t, e, r, i) { if (0 !== t || 0 !== e || r !== this.width || i !== this.height) { var s, n = this.__closestGroupOrSvg(); s = this.__createElement("rect", { x: t, y: e, width: r, height: i, fill: "#FFFFFF" }, !0), n.appendChild(s) } else this.__clearCanvas() }, e.prototype.createLinearGradient = function (t, e, i, s) { var n = this.__createElement("linearGradient", { id: a(this.__ids), x1: t + "px", x2: i + "px", y1: e + "px", y2: s + "px", gradientUnits: "userSpaceOnUse" }, !1); return this.__defs.appendChild(n), new r(n, this) }, e.prototype.createRadialGradient = function (t, e, i, s, n, o) { var h = this.__createElement("radialGradient", { id: a(this.__ids), cx: s + "px", cy: n + "px", r: o + "px", fx: t + "px", fy: e + "px", gradientUnits: "userSpaceOnUse" }, !1); return this.__defs.appendChild(h), new r(h, this) }, e.prototype.__parseFont = function () { var t = /^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-,\'\"\sa-z0-9]+?)\s*$/i.exec(this.font), e = { style: t[1] || "normal", size: t[4] || "10px", family: t[6] || "sans-serif", weight: t[3] || "normal", decoration: t[2] || "normal", href: null }; return "underline" === this.__fontUnderline && (e.decoration = "underline"), this.__fontHref && (e.href = this.__fontHref), e }, e.prototype.__wrapTextLink = function (t, e) { if (t.href) { var r = this.__createElement("a"); return r.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", t.href), r.appendChild(e), r } return e }, e.prototype.__applyText = function (t, e, r, i) { var s, n, a = this.__parseFont(), o = this.__closestGroupOrSvg(), h = this.__createElement("text", { "font-family": a.family, "font-size": a.size, "font-style": a.style, "font-weight": a.weight, "text-decoration": a.decoration, x: e, y: r, "text-anchor": (s = this.textAlign, n = { left: "start", right: "end", center: "middle", start: "start", end: "end" }, n[s] || n.start) }, !0); h.appendChild(this.__document.createTextNode(t)), this.__currentElement = h, this.__applyStyleToCurrentElement(i), o.appendChild(this.__wrapTextLink(a, h)) }, e.prototype.fillText = function (t, e, r) { this.__applyText(t, e, r, "fill") }, e.prototype.strokeText = function (t, e, r) { this.__applyText(t, e, r, "stroke") }, e.prototype.measureText = function (t) { return this.__ctx.font = this.font, this.__ctx.measureText(t) }, e.prototype.arc = function (t, e, r, i, s, a) { if (i !== s) { (i %= 2 * Math.PI) === (s %= 2 * Math.PI) && (s = (s + 2 * Math.PI - .001 * (a ? -1 : 1)) % (2 * Math.PI)); var o = t + r * Math.cos(s), h = e + r * Math.sin(s), l = t + r * Math.cos(i), c = e + r * Math.sin(i), _ = a ? 0 : 1, p = 0, u = s - i; u < 0 && (u += 2 * Math.PI), p = a ? u > Math.PI ? 0 : 1 : u > Math.PI ? 1 : 0, this.lineTo(l, c), this.__addPathCommand(n("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}", { rx: r, ry: r, xAxisRotation: 0, largeArcFlag: p, sweepFlag: _, endX: o, endY: h })), this.__currentPosition = { x: o, y: h } } }, e.prototype.clip = function () { var t = this.__closestGroupOrSvg(), e = this.__createElement("clipPath"), r = a(this.__ids), i = this.__createElement("g"); this.__applyCurrentDefaultPath(), t.removeChild(this.__currentElement), e.setAttribute("id", r), e.appendChild(this.__currentElement), this.__defs.appendChild(e), t.setAttribute("clip-path", n("url(#{id})", { id: r })), t.appendChild(i), this.__currentElement = i }, e.prototype.drawImage = function () { var t, r, i, s, n, a, o, h, l, c, _, p, u, d = Array.prototype.slice.call(arguments), g = d[0], m = 0, f = 0; if (3 === d.length) t = d[1], r = d[2], i = n = g.width, s = a = g.height; else if (5 === d.length) t = d[1], r = d[2], i = d[3], s = d[4], n = g.width, a = g.height; else { if (9 !== d.length) throw new Error("Invalid number of arguments passed to drawImage: " + arguments.length); m = d[1], f = d[2], n = d[3], a = d[4], t = d[5], r = d[6], i = d[7], s = d[8] } o = this.__closestGroupOrSvg(), this.__currentElement; var y = "translate(" + t + ", " + r + ")"; if (g instanceof e) { if ((h = g.getSvg().cloneNode(!0)).childNodes && h.childNodes.length > 1) { for (l = h.childNodes[0]; l.childNodes.length;)u = l.childNodes[0].getAttribute("id"), this.__ids[u] = u, this.__defs.appendChild(l.childNodes[0]); if (c = h.childNodes[1]) { var v, x = c.getAttribute("transform"); v = x ? x + " " + y : y, c.setAttribute("transform", v), o.appendChild(c) } } } else "CANVAS" !== g.nodeName && "IMG" !== g.nodeName || ((_ = this.__createElement("image")).setAttribute("width", i), _.setAttribute("height", s), _.setAttribute("opacity", this.globalAlpha), _.setAttribute("preserveAspectRatio", "none"), (m || f || n !== g.width || a !== g.height) && ((p = this.__document.createElement("canvas")).width = i, p.height = s, p.getContext("2d").drawImage(g, m, f, n, a, 0, 0, i, s), g = p), _.setAttribute("transform", y), _.setAttribute("xlink:href", "CANVAS" === g.nodeName ? g.toDataURL() : g.getAttribute("src")), o.appendChild(_)) }, e.prototype.createPattern = function (t, r) { var s, n = this.__document.createElementNS("http://www.w3.org/2000/svg", "pattern"), o = a(this.__ids); return n.setAttribute("id", o), n.setAttribute("width", t.width), n.setAttribute("height", t.height), "CANVAS" === t.nodeName || "IMG" === t.nodeName ? ((s = this.__document.createElementNS("http://www.w3.org/2000/svg", "image")).setAttribute("width", t.width), s.setAttribute("height", t.height), s.setAttributeNS("http://www.w3.org/1999/xlink", "xlink:href", "CANVAS" === t.nodeName ? t.toDataURL() : t.getAttribute("src")), n.appendChild(s), this.__defs.appendChild(n)) : t instanceof e && (n.appendChild(t.__root.childNodes[1]), this.__defs.appendChild(n)), new i(n, this) }, e.prototype.setLineDash = function (t) { t && t.length > 0 ? this.lineDash = t.join(",") : this.lineDash = null }, e.prototype.ellipse = function (t, e, r, i, s, a, o, h) { if (a !== o) { (a %= 2 * Math.PI) === (o %= 2 * Math.PI) && (o = (o + 2 * Math.PI - .001 * (h ? -1 : 1)) % (2 * Math.PI)); var l = t + Math.cos(-s) * r * Math.cos(o) + Math.sin(-s) * i * Math.sin(o), c = e - Math.sin(-s) * r * Math.cos(o) + Math.cos(-s) * i * Math.sin(o), _ = t + Math.cos(-s) * r * Math.cos(a) + Math.sin(-s) * i * Math.sin(a), p = e - Math.sin(-s) * r * Math.cos(a) + Math.cos(-s) * i * Math.sin(a), u = h ? 0 : 1, d = 0, g = o - a; g < 0 && (g += 2 * Math.PI), d = h ? g > Math.PI ? 0 : 1 : g > Math.PI ? 1 : 0, this.lineTo(_, p), this.__addPathCommand(n("A {rx} {ry} {xAxisRotation} {largeArcFlag} {sweepFlag} {endX} {endY}", { rx: r, ry: i, xAxisRotation: s * (180 / Math.PI), largeArcFlag: d, sweepFlag: u, endX: l, endY: c })), this.__currentPosition = { x: l, y: c } } }, e.prototype._dcgSetTitle = function (t) { var e, r = this.__currentElement, i = !1, s = r.getElementsByTagName("title"); s.length > 0 ? e = s[0] : (e = this.__document.createElementNS("http://www.w3.org/2000/svg", "title"), i = !0), e.textContent = t, i && r.appendChild(e) }, e.prototype.drawFocusRing = function () { }, e.prototype.createImageData = function () { }, e.prototype.getImageData = function () { }, e.prototype.putImageData = function () { }, e.prototype.globalCompositeOperation = function () { }, e.prototype.setTransform = function () { }, e });
define('lib/conditional_blur', ["require", "exports", "touchtracking", "jquery"], function (require, e, t, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function () { if (document.activeElement) { var e = u(document.activeElement); t.elIsFocusable(e) && u(document.activeElement).trigger("blur") } } });
define('lib/aria', ["require", "exports", "browser", "jquery"], function (require, e, a, t) { "use strict"; var r; Object.defineProperty(e, "__esModule", { value: !0 }), e.alert = e.queue = e.clear = void 0; var i = [], n = ""; function l(e) { i.push(e) } e.clear = function () { void 0 !== r && r.empty() }, e.queue = l, e.alert = function (e) { if (void 0 !== e && l(e), void 0 !== r && i.length > 0) { var t = i.join(" ").replace(/ +(?= )/g, ""); r.attr("aria-relevant", n === t && a.IS_APPLE ? "all" : "additions text"), r.empty().text(t), n = t } i.length = 0 }, t(function () { var e = ".dcg-aria-alert"; 0 === t(e).length && t("body").append("<p aria-live='assertive' aria-atomic='true' class='dcg-aria-alert'></p>"), r = t(e) }) });
define('geometry/math/hypot', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = Math.hypot && Math.hypot(1 / 0, NaN) === 1 / 0; function a(t) { return t === 1 / 0 || t === -1 / 0 } t.default = r ? Math.hypot : function (t, r) { if (a(t) || a(r)) return 1 / 0; if (isNaN(t) || isNaN(r)) return NaN; if (0 === t && 0 === r) return 0; if (Math.abs(t) > Math.abs(r)) { var e = r / t; return Math.abs(t) * Math.sqrt(e * e + 1) } e = t / r; return Math.abs(r) * Math.sqrt(e * e + 1) } });
define('lib/priority-queue', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function t(t) { this.comparator = t, this._data = [] } return t.prototype.size = function () { return this._data.length }, t.prototype.queue = function (t) { var a = this._data.length; for (this._data.push(t); a > 0;) { var i = a - 1 >>> 1; if (!(this.comparator(this._data[a], this._data[i]) < 0)) break; var r = this._data[i]; this._data[i] = this._data[a], this._data[a] = r, a = i } }, t.prototype.dequeue = function () { var t = this._data[0], a = this._data.pop(); if (this._data.length > 0 && void 0 !== a) { this._data[0] = a; for (var i = 0, r = this._data.length - 1; ;) { var e = 1 + (i << 1), h = e + 1, s = i; if (e <= r && this.comparator(this._data[e], this._data[s]) < 0 && (s = e), h <= r && this.comparator(this._data[h], this._data[s]) < 0 && (s = h), s === i) break; var o = this._data[s]; this._data[s] = this._data[i], this._data[i] = o, i = s } } return t }, t.prototype.peek = function () { return this._data[0] }, t.prototype.clear = function () { this._data.length = 0 }, t }(); t.default = a });
define('geometry/math/polygon-area-support', ["require", "exports", "lib/priority-queue", "bugsnag"], function (require, e, n, t) { "use strict"; function i(e, n) { var t = e.pt2.y - e.pt1.y, i = e.pt1.x - e.pt2.x, r = n.pt2.y - n.pt1.y, a = n.pt1.x - n.pt2.x, s = t * e.pt1.x + i * e.pt1.y, o = r * n.pt1.x + a * n.pt1.y, u = t * a - r * i; if (0 !== u) return (t * o - r * s) / u } function r(e, n, r) { if (r.scanlineX < n.scanlineX && t.notify("PolygonArea: rightEdge should not be left of leftEdge!", { metaData: { scanlineY: e, leftEdge: n, rightEdge: r } }), !(r.xSlope >= n.xSlope)) { if (n.scanlineX === r.scanlineX) return e; var a = n.pt2.y > n.pt1.y ? n.pt2 : n.pt1, o = r.pt2.y > r.pt1.y ? r.pt2 : r.pt1, u = a.y; if (o.y < a.y) { if (s(u = o.y, n) < o.x) return } else if (a.y < o.y) { var c = s(u, r); if (a.x < c) return } else if (a.x < o.x) return; var d = i(n, r); if (void 0 !== d) return Math.max(Math.min(d, u), e) } } function a(e, n, t, i) { if (t && i) { if (t.id < i.id) { if (t.skipIntersectionWith[i.id]) return } else if (i.skipIntersectionWith[t.id]) return; var a = r(e, t, i); void 0 !== a && (t.id < i.id ? t.skipIntersectionWith[i.id] = !0 : i.skipIntersectionWith[t.id] = !0, n.queue({ type: "x", y: a, edge1: t, edge2: i })) } } function s(e, n) { var t = n.pt1.x, i = n.pt2.x, r = n.pt1.y, a = n.pt2.y; if (r === e) return t; if (a === e) return i; var s = (e - r) / (a - r), o = (1 - s) * t + s * i; if (t < i) { if (o <= t) return t; if (i <= o) return i } else { if (o <= i) return i; if (t <= o) return t } return o } Object.defineProperty(e, "__esModule", { value: !0 }), e.processEvent = e.setupEventQueueAndActiveEdges = e.measureUpwardNonZeroLength = e.measureUpwardEvenOddLength = e.measureDownwardNonZeroLength = e.measureDownwardEvenOddLength = e.computeScanlineX = e.checkForEdgeIntersection = e._stableYIntersectEdges = e._unstableYIntersectEdges = void 0, e._unstableYIntersectEdges = i, e._stableYIntersectEdges = r, e.checkForEdgeIntersection = a, e.computeScanlineX = s, e.measureDownwardEvenOddLength = function (e) { for (var n = 0, t = 0, i = !1, r = 0, a = e; r < a.length; r++) { var s = a[r].scanlineX; i ? (i = !1, n += s - t) : (i = !0, t = s) } return n }, e.measureDownwardNonZeroLength = function (e) { for (var n = 0, t = 0, i = !1, r = 0, a = 0, s = e; a < s.length; a++) { var o = s[a], u = o.scanlineX; o.isClockwise ? r += 1 : r -= 1, 0 === r || i ? 0 === r && i && (i = !1, n += u - t) : (i = !0, t = u) } return n }, e.measureUpwardEvenOddLength = function (e, n) { for (var i = 0, r = 0, a = !1, o = -1 / 0, u = 0, c = n; u < c.length; u++) { var d = c[u], l = s(e, d); l < o ? (l - o < -1e-4 && t.notify("PolygonArea: scanlineX reversed!", { metaData: { scanlineY: e, edge: d, minScanlineX: o, scanlineX: l } }), l = o) : o = l, d.scanlineX = l, a ? (a = !1, i += l - r) : (a = !0, r = l) } return i }, e.measureUpwardNonZeroLength = function (e, n) { for (var i = 0, r = 0, a = !1, o = 0, u = -1 / 0, c = 0, d = n; c < d.length; c++) { var l = d[c], p = s(e, l); p < u ? (p - u < -1e-4 && t.notify("PolygonArea: scanlineX reversed!", { metaData: { scanlineY: e, edge: l, minScanlineX: u, scanlineX: p } }), p = u) : u = p, l.scanlineX = p, l.isClockwise ? o += 1 : o -= 1, 0 === o || a ? 0 === o && a && (a = !1, i += p - r) : (a = !0, r = p) } return i }, e.setupEventQueueAndActiveEdges = function (e) { for (var t = 1, i = new n.default(function (e, n) { return e.y - n.y }), r = e.length - 1; r >= 1; r--) { var a = e[r], s = e[r - 1], o = { id: t++, pt1: a, pt2: s, scanlineX: 0, xSlope: 1 / 0, isClockwise: s.y > a.y, skipIntersectionWith: {} }; s.y > a.y ? (i.queue({ type: "+", y: a.y, edge: o }), i.queue({ type: "-", y: s.y, edge: o }), o.xSlope = (s.x - a.x) / (s.y - a.y), o.scanlineX = a.x) : a.y > s.y && (i.queue({ type: "+", y: s.y, edge: o }), i.queue({ type: "-", y: a.y, edge: o }), o.xSlope = (a.x - s.x) / (a.y - s.y), o.scanlineX = s.x) } return { activeEdges: [], events: i } }, e.processEvent = function (e, n, t) { "x" === e.type ? function (e, n, t) { var i = e.edge1, r = e.edge2, s = e.y, o = t.indexOf(i), u = o + 1; -1 === o || t[u] !== r ? i.id < r.id ? delete i.skipIntersectionWith[r.id] : delete r.skipIntersectionWith[i.id] : (t[o] = r, t[u] = i, a(s, n, t[o - 1], r), a(s, n, i, t[u + 1])) }(e, n, t) : "+" === e.type ? function (e, n, t) { for (var i = e.edge, r = e.y, s = i.xSlope, o = i.scanlineX, u = 0; u < t.length; u++) { var c = t[u]; if (o < c.scanlineX) break; if (o === c.scanlineX && s <= c.xSlope) break } t.splice(u, 0, i), a(r, n, t[u - 1], i), a(r, n, i, t[u + 1]) }(e, n, t) : "-" === e.type && function (e, n, t) { var i = e.edge, r = e.y, s = t.indexOf(i); t.splice(s, 1), a(r, n, t[s - 1], t[s]) }(e, n, t) } });
define('geometry/math/polygon', ["require", "exports", "tslib", "./hypot", "bugsnag", "./polygon-area-support"], function (require, e, n, r, t, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.calculatePaintedNonZeroArea = e.calculatePaintedEvenOddArea = e.calculateSimpleArea = e.calculatePerimeter = e.pointIsWithinNonZeroFill = e.pointIsWithinEvenOddFill = void 0, e.pointIsWithinEvenOddFill = function (e, n) { if (!e) return !1; for (var r = n.x, t = n.y, a = !1, i = e.length - 1; i >= 3; i -= 2) { var l = e[i - 3], u = e[i - 2], o = e[i - 1], c = e[i]; u > t != c > t && r < (o - l) * (t - u) / (c - u) + l && (a = !a) } return a }, e.pointIsWithinNonZeroFill = function (e, r) { if (!e) return !1; for (var t = function (e) { var r = e.slice(0, 2), t = e.slice(-2); return r[0] !== t[0] || r[1] !== t[1] ? n.__spreadArray(n.__spreadArray([], e), r) : e }(e), a = r.x, i = r.y, l = 0, u = t.length - 1; u >= 3; u -= 2) { var o = t[u - 3], c = t[u - 2], s = t[u - 1], d = t[u]; c > i != d > i && a < (s - o) * (i - c) / (d - c) + o && (c > d ? l += 1 : c < d && (l -= 1)) } return 0 !== l }, e.calculatePerimeter = function (e) { for (var n = 0, t = 0; t < e.length - 1; t++)n += r.default(e[t].x - e[t + 1].x, e[t].y - e[t + 1].y); return n }, e.calculateSimpleArea = function (e) { for (var n = 0, r = 0; r < e.length - 1; r++)n += e[r].x * e[r + 1].y - e[r].y * e[r + 1].x; return Math.abs(n) / 2 }, e.calculatePaintedEvenOddArea = function (e) { if (e.length < 4) return 0; if (e[0].x !== e[e.length - 1].x || e[0].y !== e[e.length - 1].y) return 0; var n = a.setupEventQueueAndActiveEdges(e), r = n.events, i = n.activeEdges, l = r.peek(); if (!l) return 0; for (var u, o = 0, c = l.y, s = 0; u = r.dequeue();) { var d = u.y; d < c && t.notify("PolygonArea: scanlineY jumped up vertically", { metaData: { points: e, scanlineY: d, lastScanlineY: c } }), s += .5 * (d - c) * (a.measureUpwardEvenOddLength(d, i) + o), a.processEvent(u, r, i), c = d, o = a.measureDownwardEvenOddLength(i) } return s }, e.calculatePaintedNonZeroArea = function (e) { if (e.length < 4) return 0; if (e[0].x !== e[e.length - 1].x || e[0].y !== e[e.length - 1].y) return 0; var n = a.setupEventQueueAndActiveEdges(e), r = n.events, i = n.activeEdges, l = r.peek(); if (!l) return 0; for (var u, o = 0, c = l.y, s = 0; u = r.dequeue();) { var d = u.y; d < c && t.notify("PolygonArea: scanlineY jumped up vertically", { metaData: { points: e, scanlineY: d, lastScanlineY: c } }), s += .5 * (d - c) * (a.measureUpwardNonZeroLength(d, i) + o), a.processEvent(u, r, i), c = d, o = a.measureDownwardNonZeroLength(i) } return s } });
define('graphing/poicontroller', ["require", "exports", "jquery", "core/math/distance", "lib/rounding", "core/types/graphmode", "core/lib/dragmode", "lib/conditional_blur", "keys", "lib/aria", "core/lib/label", "expressions/colors", "graphing-calc/models/image", "graphing-calc/models/expression", "../geometry/math/polygon", "../graphing-calc/models/list"], function (require, e, t, a, r, i, o, n, s, l, c, d, h, p, g, v) { "use strict"; function m(e) { if (!e) return 0; if ("image" === e.type && e.listIndex) return e.listIndex; if ("poi" in e) return e.poi.pointIdxOnBranch; if ("branchInfo" in e && e.branchInfo.sketch) { var t = e.branchInfo.branch, a = e.branchInfo.sketch.branches[t]; return "listIndex" in a && a.listIndex || 0 } return 0 } Object.defineProperty(e, "__esModule", { value: !0 }), e.POIController = void 0; var b = 0, f = function () { function e(e, t) { this.manager = e, this.controller = e.controller, this.graphSettings = t, this.$ = this.manager.$, this.id = b++, this.graphSettings.config.graphpaper && !this.graphSettings.config.disableMouseInteractions && (this.addTouchEventHandlers(), this.addHoverEventHandler(), this.addKeydownEventHandler(), this.addManualUnhoverListener()) } return e.prototype.remove = function () { this.removeAllGlobalMouseListeners(), this.removeManualUnhoverListener() }, e.prototype.addGlobalMouseListener = function (e, a) { for (var r = e.split(" "), i = 0; i < r.length; i++) { var o = r[i] + ".dcg-poiController-" + this.id; t(document).on(o, a) } }, e.prototype.removeAllGlobalMouseListeners = function () { t(document).off(".dcg-poiController-" + this.id) }, e.prototype.getToleranceByDevice = function (e) { return "touch" === e ? 20 : 10 }, e.prototype.addHoverEventHandler = function () { var e = this; this.$.on("dcg-tapmove", function (a) { if ("touch" !== a.device) { var r, i, o, n = document.elementFromPoint(a.clientX, a.clientY), s = !!n && !!t(n).closest(".dcg-grapher").length, l = e.manager.poiLabelsLayer, c = e.getMouseRelativeToGrapher(a), d = e.getToleranceByDevice(a.device); if (s && (r = e.getFeatureUnderPoint(c, d)), r && "movable-point" === r.type) { var p = r.poi, g = p && p.getMovablePoint(); i = g && g.id } var v, b = 0; r && r.isClickable && (e.manager.movablePointsLayer.isMovingPoint() || e.manager.traceLayer.isTracing() || (o = r.model, b = m(r))), e.manager.clickableObjectsLayer.setHoveredObject(o && { id: o.id, listIndex: b }), r && "poi" === r.type && (r.poi.isAttachedToPlottedPoint() && !r.poi.hasInteractiveLabel() || (v = r.poi)), v !== l.getHoveredPOI() && (e.controller.isTraceEnabled() ? l.setHoveredPOI(v) : l.setHoveredPOI(void 0), e.manager.redrawAllLayers()); var f = !1; if (r && "image" === r.type) { var u = h.isActuallyDraggable(r.model), y = r.isClickable; f = u && !y } var P = !1; r && "draggable-label" === r.type && (P = !0), f || P ? e.manager.setLayerClass("extraMoveCursor", "dcg-mouse-over-movable-point") : e.manager.setLayerClass("extraMoveCursor", ""), e.manager.movablePointsLayer.setHoveredPointId(i) } }) }, e.prototype.addManualUnhoverListener = function () { var e = this, a = function () { var t = e.manager; t.poiLabelsLayer.setHoveredPOI(void 0), t.clickableObjectsLayer.setHoveredObject(void 0), t.redrawAllLayers() }; t(window).on("blur.dcg-poiController-" + this.id, a), this.$.on("mouseleave", a) }, e.prototype.removeManualUnhoverListener = function () { t(window).off(".dcg-poiController-" + this.id) }, e.prototype.addTouchEventHandlers = function () { var e = this; this.$.on("touchstart", function (a) { if (e.isViewportLocked()) { var r = e.getMouseRelativeToGrapher(a), i = e.getToleranceByDevice(a.device), o = e.getFeatureUnderPoint(r, i); o && ("image" !== o.type || v.isItemSelected(o.model) || h.isActuallyDraggable(o.model)) && ("sketch-branch" === o.type && e.graphSettings.config.onlyTraceSelected && !o.sketch.selected || t(a.target).is(":not(input, textarea)") && a.preventDefault()) } else t(a.target).is(":not(input, textarea)") && a.preventDefault() }), this.$.on("dcg-tapstart", function (t) { var a = e.getMouseRelativeToGrapher(t), r = e.getToleranceByDevice(t.device), i = e.getFeatureUnderPoint(a, r); if (i && i.isClickable) { var o = "model" in i && i.model; o ? e.manager.clickableObjectsLayer.setPressedObject({ id: o.id, listIndex: m(i) }) : e.manager.clickableObjectsLayer.setPressedObject(void 0) } else e.manager.clickableObjectsLayer.setPressedObject(void 0); if (i && "editable-label" === i.type) t.handle(); else { if (n.default(), i && "draggable-label" === i.type) return e.startMovingPoint({ type: "draggable-label", label: i.label, startScreenPt: a }), void t.handle(); if (i && "clickable-label" === i.type && t.handle(), i && "image" === i.type && h.isActuallyDraggable(i.model)) { var s = !1; if (i.isClickable && (s = !0), e.startMovingPoint({ type: "image", image: i.model, startScreenPt: a, shouldDelayUntilRealMove: s }), !s) return void t.handle() } if (i && "movable-point" === i.type) return e.startMovingPoint({ type: "poi", poi: i.poi, startScreenPt: a }), t.handle(), void t.handle("do-not-clear-poi-labels"); if (e._togglePOIUnderPoint(a, r)) return t.handle(), void t.handle("do-not-clear-poi-labels"); if (i && "sketch-branch" === i.type && !i.isClickable) { if (!e.graphSettings.config.onlyTraceSelected) { var l = !e.controller.isTraceEnabled(), c = !e.controller.isListEnabled(); if (l && c) return; if (e.selectItemIfNotSecret(i.sketch.id), l) return; return e.startTracingBranch(i.branchInfo, a), t.handle(), void t.handle("do-not-clear-poi-labels") } if (i.sketch.selected) return e.startTracingBranch(i.branchInfo, a), t.handle(), void t.handle("do-not-clear-poi-labels") } i && "image" === i.type || e.controller.dispatch({ type: "set-none-selected" }); var d = e; e.addGlobalMouseListener("dcg-tapmove", function (t) { e.manager.clickableObjectsLayer.isAnObjectPressed() ? a = e.getMouseRelativeToGrapher(t) : d.removeAllGlobalMouseListeners() }), e.addGlobalMouseListener("dcg-tapend dcg-tapcancel", function (t) { d.removeAllGlobalMouseListeners(); var i = e.manager.clickableObjectsLayer.getPressedObject(), o = i && i.id; e.manager.clickableObjectsLayer.setPressedObject(void 0); var n = e.getFeatureUnderPoint(a, r); if (n && n.isClickable) { var s = "model" in n && n.model; s && s.id === o && !t.wasHandled("dragged-clickable-object") && e.controller.dispatch({ type: "clickable-item-clicked", id: s.id, listIndex: m(n) }) } else !n || "sketch-branch" !== n.type || n.sketch.selected ? n && "image" === n.type && e.selectItemIfNotSecret(n.model.id) : e.selectItemIfNotSecret(n.model.id) }) } }) }, e.prototype.isViewportLocked = function () { return this.graphSettings.config.lockViewport || this.graphSettings.userLockedViewport }, e.prototype.addKeydownEventHandler = function () { var e = this; this.$.on("keydown", function (t) { var a = e.manager.movablePointsLayer.getFocusedPoint(); if (a) { var r = s.lookup(t), i = s.lookupChar(t); "Up" === r || "Down" === r || "Left" === r || "Right" === r ? (t.stopPropagation(), t.preventDefault(), e.movePointFromKeyboard(a, t)) : "X" !== i && "Y" !== i && "L" !== i && "C" !== i || e.speakPoint(a, i) } }) }, e.prototype.getMouseRelativeToGrapher = function (e) { var t = this.$[0].getBoundingClientRect(), a = e.touches ? e.touches[0] : e; return { x: a.clientX - t.left, y: a.clientY - t.top } }, e.prototype._getClosestPoint = function (e, t, r) { for (var i, o = r, n = this.manager.getProjection(), s = 0; s < e.length; s++) { var l = e[s], c = n.map_pt(l), d = a.hypot(c.x - t.x, c.y - t.y); d < o && (o = d, i = l) } return i }, e.prototype.getFeatureUnderPoint = function (t, a) { var r = this.manager.poiLabelsLayer, i = this.manager.getProjection(), o = i.reverse_map_pt(t); if (!this.manager.scaleAxis) { var n = r.getInteractiveLabelUnderPoint(t); if (n) switch (n.type) { case "editable": return { type: "editable-label", model: n.model, isClickable: void 0 }; case "draggable": return { type: "draggable-label", label: n.label, isClickable: void 0 }; case "clickable": return { type: "clickable-label", model: n.model, poi: n.poi, isClickable: !0 } }for (var s, l = this.manager.getSketchOrder(), c = {}, d = 1, g = l.length - 1; g >= 0; g--) { var v = l[g], m = this.controller.getItemModel(v), b = d; if (c[v] = b, m) if ("expression" === m.type) { var f = this.manager.getGraphSketch(v); if (!f || !f.visible) continue; var u = f.branches; if (!u || !u.length) continue; if (f.showHighlight && (b = -1 / 0, c[v] = b), !s || s.stackingContext >= b) for (var y = p.isClickableObject(m), P = 0; P < u.length; P++) { var k = e.calculateDistanceFromBranch(u[P], o, i, y); if (k < a) { var L = !1; s ? (b < s.stackingContext || b === s.stackingContext && k < s.distance) && (L = !0) : L = !0, L && (s = { type: "sketch-branch", model: m, sketch: f, distance: k, stackingContext: b, branchInfo: { id: f.id, branch: P, sketch: f } }) } } } else if ("image" === m.type) { var I = this.manager.getGraphImage(v); if (!I) continue; var x = this.getImageInfoUnderMouse(I, o, a); if (!x) continue; I.foreground ? (b = d += 1, c[v] = b, d += 1) : (b = 1 / 0, c[v] = b), (!s || s.stackingContext > b) && (s = { type: "image", model: I, distance: 0, stackingContext: b, listIndex: x.listIndex }) } } var M = [], C = [], w = [], O = s ? s.stackingContext : 1 / 0; this.manager.poiDotsLayer.getDrawnPOI().forEach(function (e) { e.isBareLabel() || (e.isMovable() ? M.push(e) : e.isAttachedToPlottedPoint() ? c[e.sketch.id] <= O && C.push(e) : w.push(e)) }); var S = this._getClosestPoint(M, t, a); if (S) return { type: "movable-point", poi: S, isClickable: void 0 }; var T = this._getClosestPoint(w, t, a); if (T) return { type: "poi", poi: T, isClickable: !1, model: void 0 }; var D = this._getClosestPoint(C, t, a); if (D) { var j = this.controller.getItemModel(D.sketch.id); if (j && "expression" === j.type) if (p.isClickableObject(j)) return { type: "poi", poi: D, isClickable: !0, model: j }; return { type: "poi", poi: D, isClickable: !1, model: void 0 } } if (s) { if ("sketch-branch" === s.type) return { type: "sketch-branch", branchInfo: s.branchInfo, sketch: s.sketch, model: s.model, isClickable: p.isClickableObject(s.model) }; if ("image" === s.type) return { type: "image", model: s.model, isClickable: h.isClickableObject(s.model), listIndex: s.listIndex } } } }, e.prototype._togglePOIUnderPoint = function (e, t) { if (this.controller.isTraceEnabled()) { var a = this.getFeatureUnderPoint(e, t); if (!a) return !1; if (a.isClickable) return !1; var r = "poi" in a && a.poi; return !!r && (!r.isBareLabel() && (this.manager.poiLabelsLayer.isOpenPOI(r) ? (this.manager.poiLabelsLayer.closePOI(r), this.manager.poiLabelsLayer.setHoveredPOI(void 0)) : (this.manager.poiLabelsLayer.openPOI(r), this.speakPoint(r)), this.manager.redrawAllLayers(), !0)) } }, e.prototype.getImageInfoUnderMouse = function (e, t, a) { if (e) { var r = e.formula; if (r) { var i = r.dimensions; if (i.x && i.y && i.width && i.height && i.radianAngle && e.shouldGraph) for (var o = i.x.length - 1; o >= 0; o--) { var n = i.x[o], s = i.y[o], l = i.radianAngle[o], c = n + Math.cos(l) * (t.x - n) - Math.sin(l) * (t.y - s), d = s + Math.sin(l) * (t.x - n) + Math.cos(l) * (t.y - s), h = .5 * Math.abs(i.width[o]), p = .5 * Math.abs(i.height[o]); if (c > n - h && c < n + h && d > s - p && d < s + p) return { listIndex: o } } } } }, e.calculateDistanceFromBranch = function (t, a, r, o) { if (t && t.graphMode === i.POLYGONFILL && o) { for (var n = t.segments, s = 0; s < n.length; s++)if (g.pointIsWithinNonZeroFill(n[s], a)) return 0; return 1 / 0 } var l = e.getBranchesDistanceInfo(t, a, r, o); return l ? l.minDistance : 1 / 0 }, e.getBranchesDistanceInfo = function (e, t, r, o) { var n = r.screen.width / (r.viewport.xmax - r.viewport.xmin), s = r.screen.height / (r.viewport.ymax - r.viewport.ymin), l = t.x, c = t.y, d = !1, h = !1; switch (e.graphMode) { case i.PARAMETRIC: case i.IMPLICIT: if (!o) return; break; case i.POLAR: if (!o) return; h = !0; break; case i.Y: break; case i.X: d = !0; var p = l; l = c, c = p, p = n, n = s, s = p; break; default: return }for (var g, v, m = 1 / 0, b = 1 / 0, f = 0; f < e.segments.length; f++)for (var u = e.segments[f], y = 0; y < u.length - 3; y += 2) { var P = u[y], k = u[y + 1], L = u[y + 2], I = u[y + 3]; if (h) { var x = k, M = P; P = x * Math.cos(M), k = x * Math.sin(M); var C = I, w = L; L = C * Math.cos(w), I = C * Math.sin(w) } var O = a.closestPointOnSegment(0, 0, (P - l) * n, (k - c) * s, (L - l) * n, (I - c) * s), S = a.hypot(O[0], O[1]); O[0] < 0 ? S < m && (m = S, g = O) : S < b && (b = S, v = O) } var T = m < b ? g : v; if (T) { var D = T[0] / n + l, j = T[1] / s + c; return { closestPoint: { x: d ? j : D, y: d ? D : j }, minDistance: Math.min(m, b), secondDistance: Math.max(m, b) } } }, e.getBranchesTracePoint = function (t, a, o) { if (t) { var n = "compiled" in t && t.compiled, s = n && n.fn; if (s) { var l = o.screen.width / (o.viewport.xmax - o.viewport.xmin), c = o.screen.height / (o.viewport.ymax - o.viewport.ymin), d = this.getBranchesDistanceInfo(t, a, o, !1); if (d) { var h = d.minDistance / d.secondDistance; h *= h; var p = t.graphMode === i.Y ? "x" : "y", g = d.closestPoint[p] * (1 - h) + a[p] * h, v = 1 / (2 * l), m = 1 / (2 * c), b = s(g - v), f = s(g), u = s(g + v), y = v * Math.min(1, m / Math.abs(b - f)), P = v * Math.min(1, m / Math.abs(u - f)); isFinite(y) || (y = v), isFinite(P) || (P = v), g = r.shortestDecimalBetween(g - y, g + P); var k = e.fillHole(s, g, l, c, a.x, a.y); return { x: t.graphMode === i.Y ? g : k, y: t.graphMode === i.Y ? k : g } } } } }, e.prototype.startMovingPoint = function (e) { var t = this, a = !1, r = !1; function i() { switch (e.type) { case "poi": return e.poi.getMovablePoint(); case "image": return { sketch: { id: e.image.formula.center_reference_id } }; case "draggable-label": return { sketch: { id: e.label.model.id } }; default: return e } } var o, n = i(), s = this.controller; function l() { r = !0, s.dispatch({ type: "start-moving-point", pointInfo: n }) } e.shouldDelayUntilRealMove || l(), "poi" === e.type ? o = e.poi : "image" === e.type ? o = { x: e.image.formula.dimensions.x[0], y: e.image.formula.dimensions.y[0] } : "draggable-label" === e.type && (o = { x: e.label.x, y: e.label.y }); var c = this.manager.getProjection().map_pt(o), d = e.startScreenPt.x - c.x, h = e.startScreenPt.y - c.y; if ("poi" === e.type) { var p = e.poi, g = p.isMovable() ? p.getMovablePoint() : void 0; this.manager.movablePointsLayer.setPressedPointId(g ? g.id : void 0) } var v = void 0, m = function () { if (v) { r || l(), a = !0; var o = t.manager.getProjection(), n = t.getMouseRelativeToGrapher(v); v = void 0, t.controller.dispatch({ type: "on-move-point", pointInfo: i(), screenPt: { x: n.x - d, y: n.y - h }, previousScreenPt: e.startScreenPt, projection: o }) } }; this.manager.registerMovablePointListener(m), this.addGlobalMouseListener("dcg-tapmove", function (e) { v = e }), this.addGlobalMouseListener("dcg-tapend dcg-tapcancel", function (o) { if (m(), t.manager.deregisterMovablePointListener(), t.removeAllGlobalMouseListeners(), t.manager.movablePointsLayer.setPressedPointId(void 0), r && (o.handle("dragged-clickable-object"), t.controller.dispatch({ type: "stop-moving-point", pointInfo: i() })), "poi" === e.type && !a) { var n = e.poi, s = t.manager.getProjection(), l = t.getToleranceByDevice(o.device), c = s.map_pt(n); t._togglePOIUnderPoint(c, l) } }) }, e.prototype.startTracingBranch = function (t, a) { this.manager.markLabelsDirty(), this.lastScreenPt = a; var r = this.manager.getProjection(), i = r.reverse_map_pt(a), o = t.sketch.branches[t.branch], n = e.getBranchesTracePoint(o, i, r); n && this.speakPoint(n), this.manager.traceLayer.setTraceInfo({ pt: n, branchInfo: t }), this.manager.redrawAllLayers(), this.addGlobalMouseListener("dcg-tapmove", this.handleTraceUpdate.bind(this)), this.addGlobalMouseListener("dcg-tapend dcg-tapcancel", this.stopTracingBranch.bind(this)) }, e.prototype.stopTracingBranch = function (e) { this.manager.markLabelsDirty(); var t = this.manager.poiLabelsLayer.getHoveredPOI(); t && !this.manager.poiLabelsLayer.isOpenPOI(t) && (this.manager.poiLabelsLayer.openPOI(t), this.speakPoint(t), this.manager.redrawAllLayers()), this.lastScreenPt = void 0, this.manager.traceLayer.setTraceInfo(void 0), this.manager.redrawAllLayers(), this.removeAllGlobalMouseListeners() }, e.prototype.handleTraceUpdate = function (t) { if (this.manager.traceLayer.traceInfo) { var a, r = this.manager.getProjection(); if (t) a = this.getMouseRelativeToGrapher(t), this.lastScreenPt = a, this.manager.markLabelsDirty(); else { if (!this.lastScreenPt) return; a = this.lastScreenPt } var i = r.reverse_map_pt(a), o = 1 / 0, n = -1, s = this.manager.traceLayer.traceInfo, l = this.manager.graphSketches[s.branchInfo.sketch.id]; if (l) { s.branchInfo.sketch = l; for (var c = s.branchInfo.sketch.branches, d = 0; d < c.length; d++) { var h = e.calculateDistanceFromBranch(c[d], i, r, !1); h < o && (n = d, o = h) } var p = c[n], g = p ? e.getBranchesTracePoint(p, i, r) : void 0; g && this.speakPoint(g), this.manager.traceLayer.traceInfo.branchInfo.branch = n, this.manager.traceLayer.traceInfo.pt = g, this.manager.redrawAllLayers() } } }, e.fillHole = function (e, t, r, i, o, n) { var s = e(t); if (isFinite(s)) return s; var l = t - 1e-11, c = t + 1e-11, d = e(l), h = e(c); if (isNaN(d) && isNaN(h)) return NaN; if (isNaN(d)) return h; if (isNaN(h)) return d; var p = (o - l) * r, g = (o - c) * r, v = (n - d) * i, m = (n - h) * i; return a.hypot(p, v) < a.hypot(g, m) ? d : h }, e.prototype.hasNonlinearMoveStrategy = function (e) { if (!e || !e.sketch) return !1; var t = this.controller.getItemModel(e.sketch.id); if (!t || "expression" !== t.type || !t.formula) return !1; var a = t.formula.move_strategy; return !(!a || !a[0]) && "updateSliderNonlinear" === a[0].type }, e.prototype.movePointFromKeyboard = function (e, t) { if (t && e && e.sketch) { var a = this.controller.getItemModel(e.sketch.id); if (a && "expression" === a.type) if ("movable-point" === e.type || void 0 !== a.label && a.showLabel && a.reconciledDragMode !== o.DragMode.NONE) { var r, i, n = this.manager.getProjection(), l = n.map_pt({ x: e.x, y: e.y }), c = 0, d = 0, h = s.lookup(t), p = (n.pixelCoordinates.right - n.pixelCoordinates.left) / 40, g = (n.pixelCoordinates.bottom - n.pixelCoordinates.top) / 40, v = "Up" === h || "Down" === h ? g : p; if (v = t.shiftKey ? 5 * v : v, "Up" === h ? (i = "y", d -= v, r = t.shiftKey ? "bigup" : "up") : "Down" === h ? (i = "y", d += v, r = t.shiftKey ? "bigdown" : "down") : "Left" === h ? (i = "x", c -= v, r = t.shiftKey ? "bigdown" : "down") : "Right" === h && (i = "x", c += v, r = t.shiftKey ? "bigup" : "up"), r) { var m, b = { x: l.x + c, y: l.y + d }; "x" === i || this.hasNonlinearMoveStrategy(e) ? m = { x: r } : "y" === i && (m = { y: r }), this.controller.dispatch({ type: "on-move-point", pointInfo: e, screenPt: b, previousScreenPt: l, projection: n, keyboardDirection: m }) } } } }, e.prototype.speakPoint = function (e, t) { if (e && this.manager.getAudioTrace()) { var a = this.manager.getProjection(); if (a) { var r = a.viewport; switch (t) { case "X": l.alert("X: " + c.value(e.x, r.xmax - r.xmin).ariaString); break; case "Y": l.alert("Y: " + c.value(e.y, r.ymax - r.ymin).ariaString); break; case "L": "ariaLabel" in e && e.ariaLabel ? l.alert(e.ariaLabel) : l.alert(this.controller.s("graphing-calculator-narration-poi-graph-point")); break; case "C": "sketch" in e && l.alert(d.getColorName(this.controller, e.sketch.color)) } } } }, e.prototype.selectItemIfNotSecret = function (e) { this.controller.isItemSecret(e) || this.controller.dispatch({ type: "set-selected-id", id: e }) }, e }(); e.POIController = f });
define('core/math/recttransformation', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.RT = void 0; var s = function () { function t(t, s, i, o) { void 0 === t && (t = 0), void 0 === s && (s = 0), void 0 === i && (i = 1), void 0 === o && (o = i), this.tx = t, this.ty = s, this.sx = i, this.sy = o } return t.prototype.toJSON = function () { return { tx: this.tx, ty: this.ty, sx: this.sx, sy: this.sy } }, t.prototype.compose = function (s) { return new t(this.sx * s.tx + this.tx, this.sy * s.ty + this.ty, this.sx * s.sx, this.sy * s.sy) }, t.prototype.translate = function (s, i) { var o = void 0 === i ? s.x : i.x - s.x, n = void 0 === i ? s.y : i.y - s.y; return new t(this.tx + o, this.ty + n, this.sx, this.sy) }, t.prototype.scale = function (s, i) { return t.scale(s, i).compose(this) }, t.prototype.scaleAtPoint = function (s, i, o) { return void 0 === o && (o = i), t.scaleAtPoint(s, i, o).compose(this) }, t.prototype.inverse = function () { return new t(-this.tx / this.sx, -this.ty / this.sy, 1 / this.sx, 1 / this.sy) }, t.prototype.div = function (s) { return new t((this.tx * s.sx - this.sx * s.tx) / s.sx, (this.ty * s.sy - this.sy * s.ty) / s.sy, this.sx / s.sx, this.sy / s.sy) }, t.prototype.conjugate = function (s) { return new t(this.tx * s.sx + s.tx * (1 - this.sx), this.ty * s.sy + s.ty * (1 - this.sy), this.sx, this.sy) }, t.prototype.pow = function (s) { return new t(this.tx * i(this.sx, s), this.ty * i(this.sy, s), Math.pow(this.sx, s), Math.pow(this.sy, s)) }, t.prototype.mapX = function (t) { return this.sx * t + this.tx }, t.prototype.mapY = function (t) { return this.sy * t + this.ty }, t.prototype.mapPoint = function (t) { return { x: this.mapX(t.x), y: this.mapY(t.y) } }, t.prototype.mapRect = function (t) { return { left: this.mapX(t.left), right: this.mapX(t.right), bottom: this.mapY(t.bottom), top: this.mapY(t.top) } }, t.scale = function (s, i) { return void 0 === i && (i = s), new t(0, 0, s, i) }, t.translate = function (s, i) { return (new t).translate(s, i) }, t.scaleAtPoint = function (s, i, o) { return void 0 === o && (o = i), void 0 === o && (o = i), new t(s.x * (1 - i), s.y * (1 - o), i, o) }, t.fromRects = function (s, i) { var o = (i.right - i.left) / (s.right - s.left), n = (i.top - i.bottom) / (s.top - s.bottom); return new t(i.left - o * s.left, i.bottom - n * s.bottom, o, n) }, t.fromJSON = function (s) { return new t(s.tx, s.ty, s.sx, s.sy) }, t }(); function i(t, s) { var i = t - 1; return 1 + i * i * i == 1 ? s * (1 + i * (s - 1) * (.5 + 1 / 6 * i * (s - 2))) : (Math.pow(t, s) - 1) / i } t.RT = s });
define('graphing/projection', ["require", "exports", "core/math/recttransformation"], function (require, t, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Projection = void 0; var o = function () { function t(t, o, i) { this.screen = t, this.viewport = o, this.settings = i, this.mathCoordinates = function (t) { return { left: t.xmin, right: t.xmax, bottom: t.ymin, top: t.ymax } }(o), this.pixelCoordinates = function (t) { return { left: 0, right: t.width, top: 0, bottom: t.height } }(t), this.mathToPixels = e.RT.fromRects(this.mathCoordinates, this.pixelCoordinates), this.pixelsToMath = e.RT.fromRects(this.pixelCoordinates, this.mathCoordinates) } return t.prototype.mapx = function (t) { return this.mathToPixels.mapX(t) }, t.prototype.mapy = function (t) { return this.mathToPixels.mapY(t) }, t.prototype.map_pt = function (t) { return this.mathToPixels.mapPoint(t) }, t.prototype.reverse_mapx = function (t) { return this.pixelsToMath.mapX(t) }, t.prototype.reverse_mapy = function (t) { return this.pixelsToMath.mapY(t) }, t.prototype.reverse_map_pt = function (t) { return this.pixelsToMath.mapPoint(t) }, t.prototype.coordsAreOnscreen = function (t, e, o) { return void 0 === o && (o = 0), t > -o && e > -o && t < this.screen.width + o && e < this.screen.height + o }, t.prototype.closestPointOnScreen = function (t) { var e = this.pixelCoordinates; return { x: Math.min(Math.max(t.x, e.left), e.right), y: Math.min(Math.max(t.y, e.top), e.bottom) } }, t }(); t.Projection = o });
define('jquery.handleevent', ['require', 'jquery'], function (require) { var t = require("jquery"), e = "_*_"; t.Event.prototype.wasHandled = function (n) { n = n || e; var r = this.originalEvent, a = r && r.handledBy; if (a && a[n]) return !0; if (n !== e) return !1; var i = t(this.target).closest("[handleEvent]"); return !(!i.length || i[0] === this.currentTarget) && "false" !== i.attr("handleEvent") }, t.Event.prototype.handle = function (t) { t = t || e; var n = this.originalEvent; if (n) { var r = n.handledBy; r || (r = n.handledBy = {}), r[t] = !0 } } });
!function (e) { "function" == typeof define && define.amd ? define('vendor/jquery.mousewheel', ["jquery"], e) : "object" == typeof exports ? module.exports = e : e(jQuery) }(function (e) { var t, n, i = ["wheel", "mousewheel", "DOMMouseScroll", "MozMousePixelScroll"], o = "onwheel" in document || document.documentMode >= 9 ? ["wheel"] : ["mousewheel", "DomMouseScroll", "MozMousePixelScroll"], l = Array.prototype.slice; if (e.event.fixHooks) for (var s = i.length; s;)e.event.fixHooks[i[--s]] = e.event.mouseHooks; var a = e.event.special.mousewheel = { version: "3.1.9", setup: function () { if (this.addEventListener) for (var t = o.length; t;)this.addEventListener(o[--t], h, !1); else this.onmousewheel = h; e.data(this, "mousewheel-line-height", a.getLineHeight(this)), e.data(this, "mousewheel-page-height", a.getPageHeight(this)) }, teardown: function () { if (this.removeEventListener) for (var e = o.length; e;)this.removeEventListener(o[--e], h, !1); else this.onmousewheel = null }, getLineHeight: function (t) { return parseInt(e(t)["offsetParent" in e.fn ? "offsetParent" : "parent"]().css("fontSize"), 10) }, getPageHeight: function (t) { return e(t).height() }, settings: { adjustOldDeltas: !0 } }; function h(i) { var o = i || window.event, s = l.call(arguments, 1), a = 0, h = 0, d = 0, f = 0; if ((i = e.event.fix(o)).type = "mousewheel", "detail" in o && (d = -1 * o.detail), "wheelDelta" in o && (d = o.wheelDelta), "wheelDeltaY" in o && (d = o.wheelDeltaY), "wheelDeltaX" in o && (h = -1 * o.wheelDeltaX), "axis" in o && o.axis === o.HORIZONTAL_AXIS && (h = -1 * d, d = 0), a = 0 === d ? h : d, "deltaY" in o && (a = d = -1 * o.deltaY), "deltaX" in o && (h = o.deltaX, 0 === d && (a = -1 * h)), 0 !== d || 0 !== h) { if (1 === o.deltaMode) { var c = e.data(this, "mousewheel-line-height"); a *= c, d *= c, h *= c } else if (2 === o.deltaMode) { var m = e.data(this, "mousewheel-page-height"); a *= m, d *= m, h *= m } return f = Math.max(Math.abs(d), Math.abs(h)), (!n || f < n) && (n = f, r(o, f) && (n /= 40)), r(o, f) && (a /= 40, h /= 40, d /= 40), a = Math[a >= 1 ? "floor" : "ceil"](a / n), h = Math[h >= 1 ? "floor" : "ceil"](h / n), d = Math[d >= 1 ? "floor" : "ceil"](d / n), i.deltaX = h, i.deltaY = d, i.deltaFactor = n, i.deltaMode = 0, s.unshift(i, a, h, d), t && clearTimeout(t), t = setTimeout(u, 200), (e.event.dispatch || e.event.handle).apply(this, s) } } function u() { n = null } function r(e, t) { return a.settings.adjustOldDeltas && "mousewheel" === e.type && t % 120 == 0 } e.fn.extend({ mousewheel: function (e) { return e ? this.bind("mousewheel", e) : this.trigger("mousewheel") }, unmousewheel: function (e) { return this.unbind("mousewheel", e) } }) });
define('graphing/viewportcontroller', ["require", "exports", "jquery", "lib/aria", "lib/i18n", "core/math/recttransformation", "./viewport", "core/math/distance", "./constants", "./projection", "keys", "jquery.handleevent", "vendor/jquery.mousewheel"], function (require, t, e, o, r, i, a, n, s, h, p) { "use strict"; function c(t, e) { var o = e.x - t.x, r = e.y - t.y, i = .5 * (t.x + e.x), a = .5 * (t.y + e.y), s = .5 * n.hypot(o, r); return { center: g(i, a), radius: s } } function l(t, e) { return c(e, { x: 2 * t.x - e.x, y: 2 * t.y - e.y }) } function u(t, e) { for (var o = [], r = 0; r < t.length; r++)o.push(g(t[r].pageX - e.left, t[r].pageY - e.top)); return o } function g(t, e) { return { x: t, y: e } } function m(t) { return g(.5 * (t.left + t.right), .5 * (t.bottom + t.top)) } Object.defineProperty(t, "__esModule", { value: !0 }), t.ViewportController = void 0; var d = 0, f = function () { function t(t, e) { var o = this; this.s = r.createDictionaryLookupFunction(function () { return o.grapher.settings.config.language }), this.grapher = t, this.$ = t.$, this.id = d++, this.controller = e, this.isScalingEnabled = !1, this.mousePt = g(0, 0), this.lastScrollZoom = Date.now(), this.preventScrollZoom = !1, this.addMouseWheelEventHandler(), this.addTouchEventHandler() } return t.prototype.remove = function () { e(window).off(".viewportcontroller-" + this.id) }, t.prototype.getViewport = function () { return this.grapher.getProjection().viewport }, t.prototype.getProjection = function () { return this.grapher.getProjection() }, t.prototype.isViewportLocked = function () { var t = this.getProjection().settings; return t.config.lockViewport || t.userLockedViewport }, t.prototype.updateMouse = function (t) { var e = this.$[0].getBoundingClientRect(); this.mousePt = g(t.clientX - e.left, t.clientY - e.top) }, t.prototype.updateScaleAxis = function () { this.isMouseInViewport() && (this.isMouseNearYAxis() ? this.grapher.scaleAxis = "y" : this.isMouseNearXAxis() ? this.grapher.scaleAxis = "x" : this.grapher.scaleAxis = "both"), this.updateCursor(), this.grapher.redrawAllLayers() }, t.prototype.updateCursor = function () { this.$.toggleClass("dcg-scale-horizontal", "x" === this.grapher.scaleAxis), this.$.toggleClass("dcg-scale-vertical", "y" === this.grapher.scaleAxis), this.$.toggleClass("dcg-scale-both", "both" === this.grapher.scaleAxis) }, t.prototype.isMouseNearOrigin = function () { var t = this.getProjection().mathToPixels.mapPoint(g(0, 0)); return Math.abs(this.mousePt.x - t.x) < 50 && Math.abs(this.mousePt.y - t.y) < 50 }, t.prototype.isMouseNearXAxis = function () { var t = this.getProjection(), e = t.pixelCoordinates, o = t.mathToPixels.mapY(0); return o = Math.min(Math.max(e.top, o), e.bottom), Math.abs(this.mousePt.y - o) < 40 && t.settings.showXAxis }, t.prototype.isMouseNearYAxis = function () { var t = this.getProjection(), e = t.pixelCoordinates, o = t.mathToPixels.mapX(0); return o = Math.min(Math.max(e.left, o), e.right), Math.abs(this.mousePt.x - o) < 40 && t.settings.showYAxis }, t.prototype.isMouseInViewport = function () { var t = this.getProjection(), e = t.mathCoordinates, o = t.pixelsToMath.mapPoint(this.mousePt); return o.x >= e.left && o.x <= e.right && o.y >= e.bottom && o.y <= e.top }, t.prototype.getDefaultViewport = function () { return this.controller.getDefaultStateViewport() || this.grapher.getDefaultViewport() }, t.prototype._setViewportWithoutCancellingAnimation = function (t) { if (t.isValid() && !t.equals(this.getViewport())) { var e = this.getProjection(); this.grapher._setProjection(new h.Projection(e.screen, t, e.settings)) } }, t.prototype.setViewport = function (t) { this.cancelAnimation(), this._setViewportWithoutCancellingAnimation(t) }, t.prototype.setScreen = function (t) { var e = this.getProjection(), o = e.settings.squareAxes, r = new h.Projection(t, this.getViewportForScreen(e.viewport, t, o), e.settings); this.grapher._setProjection(r) }, t.prototype.getTransformedViewport = function (t) { var e = this.getProjection(), o = e.pixelsToMath.div(t).mapRect(e.pixelCoordinates); return new a.Viewport(o.left, o.right, o.bottom, o.top) }, t.prototype.transformViewport = function (t) { this.setViewport(this.getTransformedViewport(t)) }, t.prototype.animateTransformation = function (t) { var e = this; this.cancelAnimation(); var o, r = this.getTransformedViewport(t), i = 0, a = function (n) { o || (o = n); var h = (n - o) / s.ANIMATE_ZOOM_DURATION; (i += h) < 1 ? (e.__animationTimeout = requestAnimationFrame(a), e._setViewportWithoutCancellingAnimation(e.getTransformedViewport(t.pow(h))), e.grapher.debounceUserRequestedViewportChange()) : (e.setViewport(r), e.grapher.debounceUserRequestedViewportChange()) }; this.__animationTimeout = requestAnimationFrame(a) }, t.prototype.cancelAnimation = function () { cancelAnimationFrame(this.__animationTimeout) }, t.prototype.addMouseWheelEventHandler = function () { var t, o, r = this, a = !1; e(window).on("scroll.viewportcontroller-" + this.id, function (t) { a = !0 }), e(window).on("mousewheel.viewportcontroller-" + this.id, function (e) { t = e.clientX, o = e.clientY }), e(window).on("mousemove.viewportcontroller-" + this.id, function (e) { if (a) { var r = e.clientX - t, i = e.clientY - o; r * r + i * i < 100 || (a = !1) } }); var n = 0; this.$.mousewheel(function (t, e) { var o = Date.now(); if (r.preventScrollZoom && o - r.lastScrollZoom > 50 && (r.preventScrollZoom = !1), r.lastScrollZoom = o, !r.preventScrollZoom) { var h = r.getProjection(); if (!r.isViewportLocked()) { var p = h.mathToPixels; if (!a) { t.preventDefault(), r.updateMouse(t); var c = p.mapPoint(g(0, 0)), l = r.isMouseNearOrigin() && e > 0 ? c : r.mousePt; if (!(n > 0)) { n += 1, requestAnimationFrame(function () { n-- }); var u = (e = e > 0 ? 1 : -1) > 0 ? s.ZOOM_FACTOR : 1 / s.ZOOM_FACTOR, m = r.grapher.scaleAxis, d = "x" !== m && "both" !== m && m ? 1 : u, f = "y" !== m && "both" !== m && m ? 1 : u; r.transformViewport(i.RT.scaleAtPoint(l, d, f)), r.grapher.debounceUserRequestedViewportChange() } } } } }) }, t.prototype.applyPanTouchChanges = function (t, e) { if (!this.isViewportLocked() && !this.isScalingEnabled) { var o = g(e[0].x - t[0].x, e[0].y - t[0].y); this.transformViewport(i.RT.translate(o)), this.grapher.debounceUserRequestedViewportChange() } }, t.prototype.chooseDragScaleCenter = function () { var t = this.getProjection(), e = t.pixelCoordinates, o = t.mathToPixels.mapX(0), r = t.mathToPixels.mapY(0); return g(o = Math.min(Math.max(e.left, o), e.right), r = Math.min(Math.max(e.top, r), e.bottom)) }, t.prototype.applyScaleTouchChanges = function (t, e) { if (!this.isViewportLocked()) { var o, r, a = this.grapher.scaleAxis; if (2 === t.length && 2 === e.length) o = c(t[0], t[1]), r = c(e[0], e[1]); else { if (1 !== e.length) return; var n = this.chooseDragScaleCenter(); o = l(n, t[0]), r = l(n, e[0]) } var s = r.radius / o.radius, h = "y" === a ? 1 : s, p = "x" === a ? 1 : s, u = i.RT.scaleAtPoint(o.center, h, p).translate(o.center, r.center); this.transformViewport(u), this.grapher.debounceUserRequestedViewportChange() } }, t.prototype.addTouchEventHandler = function () { var t = this, o = [], r = !1, i = !0, a = !0; e(window).on("mousemove.viewportcontroller-" + this.id, function (e) { r || t.isViewportLocked() || (t.updateMouse(e), t.isScalingEnabled && t.updateScaleAxis()) }); var n = function (e) { return t.grapher.scaleAxis || (t.grapher.scaleAxis = function (e) { if (!(e.length < 2)) { var o = t.grapher.getProjection(), r = o.pixelCoordinates, i = o.mathToPixels.mapX(0), a = o.mathToPixels.mapY(0); i = Math.min(Math.max(r.left, i), r.right), a = Math.min(Math.max(r.top, a), r.bottom); var n = e[1].x - e[0].x, s = e[1].y - e[0].y; return Math.abs(e[0].x - i) < 40 && Math.abs(e[1].x - i) < 40 && Math.abs(s) > 3 * Math.abs(n) && o.settings.showYAxis ? "y" : Math.abs(e[0].y - a) < 40 && Math.abs(e[1].y - a) < 40 && Math.abs(n) > 3 * Math.abs(s) && o.settings.showXAxis ? "x" : "both" } }(e)), t.grapher.scaleAxis }, s = function () { t.grapher.scaleAxis && (t.grapher.scaleAxis = void 0, t.grapher.redrawAllLayers(), t.updateCursor()) }, h = function () { t.isScalingEnabled = !1, t.preventScrollZoom = !0, s() }, c = function (e) { if (r && !t.isViewportLocked() && t.grapher && t.grapher.clickableObjectsLayer && !t.grapher.clickableObjectsLayer.isAnObjectPressed()) { var h = u(e.touches, t.$.offset()); if (2 === o.length && 2 === h.length) n(h), t.applyScaleTouchChanges(o, h); else if (1 === o.length && t.isScalingEnabled) { t.updateMouse(e); var p, c, l = t.grapher.scaleAxis, m = t.getProjection().mathToPixels.mapPoint(g(0, 0)), d = i ? 1 : -1, f = a ? 1 : -1; if ("x" !== l && "both" !== l || (p = t.mousePt.x > m.x + 5 * d), "y" !== l && "both" !== l || (c = t.mousePt.y > m.y + 5 * f), "x" === l && i !== p) return; if ("y" === l && a !== c) return; if ("both" === l && i !== p && a !== c) return; t.applyScaleTouchChanges(o, h) } else s(); 1 === o.length && t.applyPanTouchChanges(o, h), t.controller.dispatch({ type: "grapher/drag-move" }), o = h } }, l = function (i) { r && (t.cancelAnimation(), o = u(i.touches, t.$.offset()), 0 === i.touches.length && (r = !1, t.grapher.isDragging = !1, e(document).off(".graphdrag"), t.grapher.debounceUserRequestedViewportChange(), t.controller.dispatch({ type: "grapher/drag-end" })), (0 === i.touches.length || 1 === i.touches.length && !t.isScalingEnabled) && s()) }; this.$.on("dcg-tapstart", function (o) { var n = t.getProjection(); if (!t.isViewportLocked() && !o.wasHandled() && !r && o.touches.length === o.changedTouches.length) { r = !0, t.grapher.isDragging = !0, t.updateMouse(o); var s = n.mathToPixels.mapPoint(g(0, 0)), h = t.grapher.scaleAxis; "x" !== h && "both" !== h || (i = t.mousePt.x > s.x), "y" !== h && "both" !== h || (a = t.mousePt.y > s.y), t.controller.dispatch({ type: "grapher/drag-start" }), e(document).on("dcg-tapmove.graphdrag", c), e(document).on("dcg-tapstart.graphdrag dcg-tapend.graphdrag dcg-tapcancel.graphdrag", l) } }), e(window).on("keydown.viewportcontroller-" + this.id, function (e) { t.isViewportLocked() || (p.lookup(e) !== p.SHIFT || function (t) { return t.altKey || t.ctrlKey || t.metaKey }(e) ? h() : (t.isScalingEnabled = !0, t.grapher.scaleAxis || t.updateScaleAxis())) }), e(window).on("keyup.viewportcontroller-" + this.id + " blur.viewportcontroller-" + this.id, h) }, t.prototype.zoom = function (t) { var e = this.getProjection().pixelCoordinates; if ("in" === t) this.animateTransformation(i.RT.scaleAtPoint(m(e), 2)), o.alert(this.s("graphing-calculator-narration-viewport-zoom-in")); else if ("out" === t) this.animateTransformation(i.RT.scaleAtPoint(m(e), .5)), o.alert(this.s("graphing-calculator-narration-viewport-zoom-out")); else if ("default" === t) { var r = this.getDefaultViewport(); this.animateTransformation(this.getCustomZoomTransformation(r)), o.alert(this.s("graphing-calculator-narration-viewport-zoom-default")) } else if ("square" === t) { var a = this.getSquareViewport(); this.animateTransformation(this.getCustomZoomTransformation(a)), o.alert(this.s("graphing-calculator-narration-viewport-zoom-square")) } }, t.prototype.zoomCustom = function (t) { this.animateTransformation(this.getCustomZoomTransformation(t)), o.alert(this.s("graphing-calculator-narration-viewport-updated")) }, t.prototype.getCustomZoomTransformation = function (t) { var e = this.getProjection().viewport, o = this.getProjection().pixelCoordinates, r = this.getProjection().mathCoordinates, a = (e.xmax - e.xmin) / (t.xmax - t.xmin), n = (e.ymax - e.ymin) / (t.ymax - t.ymin), s = i.RT.fromRects(r, o), h = i.RT.translate(s.mapPoint({ x: 0, y: 0 }), { x: 0, y: 0 }), p = i.RT.scale(a, n), c = i.RT.fromRects({ left: t.xmin, right: t.xmax, bottom: t.ymin, top: t.ymax }, o); return i.RT.translate({ x: 0, y: 0 }, c.mapPoint({ x: 0, y: 0 })).compose(p.compose(h)) }, t.prototype.isZoomRestored = function () { var t = this.getProjection(), e = t.viewport, o = this.getDefaultViewport(), r = .05; return t.settings.squareAxes && Math.abs((e.xmin - o.xmin) / e.xmin) < r && Math.abs((e.xmax - o.xmax) / e.xmax) < r && Math.abs((e.ymin - o.ymin) / e.ymin) < r && Math.abs((e.ymax - o.ymax) / e.ymax) < r }, t.prototype.getViewportForScreen = function (t, e, o) { return o ? "y" == this.getProjection().settings.lastChangedAxis ? t.squareXAxis(e) : t.squareYAxis(e) : t }, t.prototype.getSquareViewport = function () { var t = this.getProjection(); return this.getViewportForScreen(t.viewport, t.screen, !0) }, t.prototype.enforceSquareAxes = function () { var t = this.getProjection(); t.settings.squareAxes && (t.viewport.isSquare(t.screen) || this.setViewport(this.getViewportForScreen(t.viewport, t.screen, !0))) }, t }(); t.ViewportController = f });
define('submodules/dcgview/build-amd/attr-event-handler', [], function () { "use strict"; return function (n, t) { if (null != t) { if ("string" != typeof n) throw new Error("Must pass a string for an EventHandler name"); if ("function" != typeof t) throw new Error("Must pass a function for an EventHandler callback"); return { bindings: { onMount: function (r) { r[n.toLowerCase()] = function (n) { n && t.apply(this, arguments) } } } } } } });
define('submodules/dcgview/build-amd/const', [], function () { "use strict"; return { isConst: function (n) { return !("function" != typeof n || !n.isDCGViewConst) }, makeConst: function (n) { var t = function () { return n }; return t.isDCGViewConst = !0, t } } });
define('submodules/dcgview/build-amd/attr', [], function () { "use strict"; return { update: function (t, e, i) { void 0 === i ? t.removeAttribute(e) : t.setAttribute(e, i + "") } } });
define('submodules/dcgview/build-amd/attr-generic', ["./const", "./attr"], function (t, n) { "use strict"; function e(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var u = e(t), a = e(n); return function (t, n) { var e, r = n(); return u.default.isConst(n) || (e = { onUpdate: function (e) { var u = n(); u !== r && (r = u, a.default.update(e, t, u)) } }), { value: r, bindings: e } } });
define('submodules/dcgview/build-amd/is-event-handler', [], function () { "use strict"; return function (n) { return "o" === n[0] && "n" === n[1] && n[2].toUpperCase() === n[2] } });
define('submodules/dcgview/build-amd/custom-attributes', [], function () { "use strict"; var t = {}; return { isCustomAttribute: function (n) { return t.hasOwnProperty(n) }, add: function (n, r) { t[n] = r }, parse: function (n, r) { return (0, t[n])(r) } } });
define('submodules/dcgview/build-amd/bindings', [], function () { "use strict"; return { add: function (n, i, r) { var t = n._bindings[i]; t ? t.push(r) : n._bindings[i] = [r] }, invoke: function (n, i) { var r = n._bindings[i]; if (r) for (var t = r.length, d = 0; d < t; d++)r[d]() } } });
define('submodules/dcgview/build-amd/warnings', [], function () { "use strict"; var r = []; return { warn: function (n, e) { try { if (e && e._isDCGView) { n += " [" + e._viewName + "]"; var a = e.traceViewHierarchy(); a.ancestors.length > 0 && (n += "\nView Hierarchy:\n" + a.formatted) } throw new Error(n) } catch (n) { console.warn(n); for (var t = 0; t < r.length; t++)r[t](n) } }, addWarningHandler: function (n) { r.push(n) }, removeWarningHandler: function (n) { var e = r; r = []; for (var a = 0; a < e.length; a++) { var t = e[a]; t !== n && r.push(t) } } } });
define('submodules/dcgview/build-amd/bind-attrs', ["./attr-event-handler", "./attr-generic", "./is-event-handler", "./custom-attributes", "./bindings", "./warnings"], function (t, n, i, e, u, a) { "use strict"; function r(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var o = r(t), d = r(n), f = r(i), l = r(e), s = r(u), c = r(a), v = { onMount: !0, didMount: !0, willUnmount: !0, willUpdate: !0, onUpdate: !0, didUpdate: !0 }, b = { willMount: !0, onMount: !0, didMount: !0, willUnmount: !0, onUnmount: !0, didUnmount: !0 }; function m(t, n, i) { var e = !1; return function () { e ? c.default.warn(t + " is a one-time binding but was called multiple times", i) : (e = !0, n.apply(this, arguments)) } } function p(t, n, i) { var e = i.bindings; if (e) for (var u in e) { var a = e[u]; u in v && (a = a.bind(null, n)), u in b && (a = m(u, a, t)), s.default.add(t, u, a) } } function w(t, n) { if ("function" != typeof n) throw new Error('The "' + t + '" attr must be a function. It is: ' + JSON.stringify(n)); return l.default.isCustomAttribute(t) ? l.default.parse(t, n) : f.default(t) ? o.default(t, n) : d.default(t, n) } return function (t, n, i) { if (n) for (var e in n) { var u = w(e, n[e]); if (u) { var a = u.value; void 0 !== a && i.setAttribute(e, a), u.bindings && p(t, i, u) } } } });
define('submodules/dcgview/build-amd/bind-text', ["./bindings"], function (n) { "use strict"; function e(n) { return n && "object" == typeof n && "default" in n ? n : { default: n } } var t = e(n), a = !1; return { bindText: function (n, e, d) { if ("function" != typeof d) throw new Error("bindText expects a function"); var i = d(); null == i && (i = ""); var u = document.createTextNode(i); if (a) { var o = document.createElement("span"); o.appendChild(u), e.appendChild(o) } else e.appendChild(u); t.default.add(n, "onUpdate", function () { var n = d(); null == n && (n = ""), i !== n && (u.nodeValue = n, i = n) }) }, enableSpanWrapping: function () { a = !0 } } });
define('submodules/dcgview/build-amd/dcg-element', ["./bind-attrs", "./bind-text", "./const", "./warnings"], function (t, e, n, r) { "use strict"; function i(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var o = i(t), a = i(e), d = i(n), s = i(r), h = a.default.bindText; function c(t, e) { var n = document.createTextNode(e); t.appendChild(n) } function f(t, e, n) { if (this.tagName = t, this.attrs = e, this.children = n, Array.isArray(this.children)) for (var r = 0; r < this.children.length; r++) { var i = typeof this.children[r]; "object" !== i && "function" !== i || (this.children[r]._parentElement = this) } } return f.prototype._isDCGElement = !0, f.prototype.renderToDocFrag = function (t, e) { if (this._domNode) throw new Error("Cannot remount a DCGElement"); var n = this.children, r = document.createElement(this.tagName); this._domNode = r, o.default(e, this.attrs, r), t.appendChild(r); for (var i = n.length, a = 0; a < i; a++) { var f = n[a]; f._isDCGElement ? f.renderToDocFrag(r, e) : d.default.isConst(f) ? c(r, f()) : "function" == typeof f ? h(e, r, f) : (s.default.warn("Text should be a const or a getter: " + JSON.stringify(f), e), c(r, f)) } }, f });
define('submodules/dcgview/build-amd/create-element', ["./dcg-element"], function (e) { "use strict"; function r(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var t = r(e); function n(e, r) { if (null != e) if (Array.isArray(e)) for (var t = 0; t < e.length; t++)n(e[t], r); else r.push(e) } return function (e, r) { for (var i = [], f = arguments.length - 1, u = 2; u <= f; u++)n(arguments[u], i); if ("string" == typeof e) return new t.default(e, r, i); if (e && e._isDCGViewClass) return new e(r, i); throw new Error("createElement expects a String or DCGViewClass") } });
define('submodules/dcgview/build-amd/mounting', ["./bindings"], function (n) { "use strict"; function e(n) { return n && "object" == typeof n && "default" in n ? n : { default: n } } var o = e(n); function t(n) { n.willMount && n.willMount(), o.default.invoke(n, "willMount"), n._childViews.forEach(t) } function i(n) { n._isMounted = !0, n.onMount && n.onMount(), o.default.invoke(n, "onMount"), n._childViews.forEach(i) } function r(n) { n.didMount && n.didMount(), o.default.invoke(n, "didMount"), n._childViews.forEach(r) } function u(n) { n.willUnmount && n.willUnmount(), o.default.invoke(n, "willUnmount"), n._childViews.forEach(u) } function d(n) { n._isMounted = !1, n._childViews.forEach(d), o.default.invoke(n, "onUnmount"), n.onUnmount && n.onUnmount() } function l(n) { n._childViews.forEach(l), o.default.invoke(n, "didUnmount"), n.didUnmount && n.didUnmount() } return { renderToDocFrag: function (n, e) { if (e && e._childViews.push(this), this.__generatedHTMLBefore) throw new Error("Cannot remount a DCGView"); if (this.__generatedHTMLBefore = !0, this._element.renderToDocFrag(n, this), Array.isArray(this._siblingElements)) for (var o = 0; o < this._siblingElements.length; o++)this._siblingElements[o].renderToDocFrag(n, this) }, findRootNode: function () { for (var n = this._element; n._isDCGView;)n = n._element; return n._domNode }, createNodeForView: function (n, e) { var o = document.createDocumentFragment(); return n.renderToDocFrag(o, e), o.firstChild }, willMount: t, onMount: i, didMount: r, willUnmount: u, onUnmount: d, didUnmount: l, mountToNode: function (n, e, o) { if (!n || !n._isDCGViewClass) throw new Error("Must pass a DCGView class to be mounted"); if (!e || 1 !== e.nodeType) throw new Error("Must pass an HTMLElement for the node"); if (e._mountedDCGView) throw new Error("This node is already mounted by a view"); var u = new n(o), d = document.createDocumentFragment(); return u.renderToDocFrag(d), e.innerHTML = "", t(u), e._mountedDCGView = u, e.appendChild(d), i(u), r(u), u }, unmountFromNode: function (n) { var e = n._mountedDCGView; if (!e) throw new Error("This node is not mounted by a DCGView"); u(e), n.innerHTML = "", delete n._mountedDCGView, d(e), l(e) } } });
define('submodules/dcgview/build-amd/update', ["./bindings", "./warnings"], function (t, i) { "use strict"; function e(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var d = e(t), n = e(i); return { update: function () { if (!this._isMounted) return n.default.warn("Trying to update view that is not mounted. Ignoring update.", this); if (!this.shouldUpdate || this.shouldUpdate()) { if (this.willUpdate && this.willUpdate(), d.default.invoke(this, "willUpdate"), d.default.invoke(this, "onUpdate"), this.onUpdate && this.onUpdate(), this.overrideChildUpdates) this.overrideChildUpdates(); else for (var t = this._childViews, i = t.length, e = 0; e < i; e++)t[e].update(); d.default.invoke(this, "didUpdate"), this.didUpdate && this.didUpdate() } } } });
define('submodules/dcgview/build-amd/spread', [], function () { "use strict"; return function (r) { var e = arguments.length; if (e < 2) return r; for (var n = 1; n < e; n++)for (var t = arguments[n], f = Object.keys(t), u = f.length, i = 0; i < u; i++) { var a = f[i]; r[a] = t[a] } return r } });
define('submodules/dcgview/build-amd/create-class', ["./create-element", "./mounting", "./update", "./const", "./spread"], function (t, e, r, n, o) { "use strict"; function i(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var s = i(t), p = i(e), a = i(r), f = i(n), u = i(o); return function (t) { if (!t) throw new Error("must pass a spec to DCGView.createClass"); if ("function" != typeof t.template) throw new Error("must pass a template function to DCGView.createClass"); var e = function (e, r) { this._viewName = t.viewName || (this.constructor ? this.constructor.name : "Anonymous DCGView"), this._setupProps(e, r), this.init && this.init(), this._callTemplate() }; for (var r in e.prototype._setupProps = function (t, e) { if (t) { for (var r in t) { var n = t[r]; if ("function" != typeof n && void 0 !== n) throw new Error('The "' + r + '" prop must be a function. It is: ' + JSON.stringify(n)) } this.props = t } else this.props = {}; this.children = e, this._childViews = [], this._bindings = {} }, e.prototype._callTemplate = function () { if (this._element = this.template(), !this._element || !this._element._isDCGElement) throw new Error("template() must return a DCGElement"); this._element._parentElement = this }, e.prototype.bindFn = function (t) { return t.bind(this) }, e.prototype.findRootNode = p.default.findRootNode, e.prototype.renderToDocFrag = p.default.renderToDocFrag, e.prototype.const = f.default.makeConst, e.prototype.spread = u.default, e.prototype.createElement = s.default, e.prototype.update = a.default.update, e.prototype.traceViewHierarchy = function () { for (var t = [], e = this._parentElement; e; e = e._parentElement)t.unshift(e); var r = t.concat([this]).filter(function (t) { return !!t._isDCGView && (!(t._isDCGSwitch && t._parentElement && t._parentElement._isDCGIf) && !(t._isDCGIfDefinedWrapper || t._isDCGSwitchWrapper || t._isDCGSwitchUnionWrapper)) }).map(function (t, e) { for (var r = ""; e-- > 0;)r += "  "; return r + "<" + t._viewName + ">" }).join("\n"); return { ancestors: t, formatted: r } }, t) if (t.hasOwnProperty(r)) { if (e.prototype.hasOwnProperty(r)) throw new Error("Cannot override the " + r + "() method"); e.prototype[r] = t[r] } return e._isDCGViewClass = !0, e.prototype._isDCGView = !0, e.prototype._isDCGElement = !0, e } });
define('submodules/dcgview/build-amd/attr-style', ["./const", "./attr"], function (t, r) { "use strict"; function e(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var n = e(t), u = e(r); function o(t) { var r = t(), e = typeof r; if ("string" === e) return r; if (!e || "object" !== e) throw new Error("Unsupported type returned from style getter: " + e); var n = ""; for (var u in r) { var o = r[u]; r.hasOwnProperty(u) && null != o && (n ? n += ";" + u + ":" + o : n = u + ":" + o) } return n } return function (t) { var r, e = o(t); return n.default.isConst(t) || (r = { onUpdate: function (r) { var n = o(t); e !== n && (u.default.update(r, "style", n), e = n) } }), { value: e, bindings: r } } });
define('submodules/dcgview/build-amd/attr-class', ["./const"], function (r) { "use strict"; function e(r) { return r && "object" == typeof r && "default" in r ? r : { default: r } } var t = e(r); function n(r) { var e = r(), t = typeof e; if ("string" === t) return e; if (!t || "object" !== t) throw new Error("Unsupported type returned from class getter: " + t); var n = ""; for (var a in e) { if (e.hasOwnProperty(a)) e[a] && (n ? n += " " + a : n = a) } return n } var a = /^\s+|\s+$/g, s = /\s+/; return function (r) { var e, o = n(r); return t.default.isConst(r) || (e = { onUpdate: function (e) { var t = n(r); o !== t && (e.className === o ? (e.className = t, o = t) : (e.className = function (r, e, t) { for (var n = [], o = r.className.replace(a, "").split(s), i = e.replace(a, "").split(s), u = {}, f = i.length - 1; f >= 0; f--)u[i[f]] = !0; var c = o.length; for (f = 0; f < c; f++) { var l = o[f]; u.hasOwnProperty(l) || n.push(l) } return t ? n.length ? t + " " + n.join(" ") : t : n.join(" ") }(e, o, t), o = t)) } }), { value: o, bindings: e } } });
define('submodules/dcgview/build-amd/attr-lifecycle', ["./const"], function (t) { "use strict"; function e(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var n = e(t); return function (t) { return function (e) { if ("function" != typeof e) throw new Error("The " + t + " attribute expects a function for the value"); if (n.default.isConst(e)) throw new Error("The " + t + " attribute does not expect a const for the value"); var r = { bindings: {} }; return r.bindings[t] = e, r } } });
define('submodules/dcgview/build-amd/longest-subsequence', [], function () { "use strict"; return function (r) { var e, n, a = r.length, t = new Array(a), f = new Array(a + 1), i = 0; for (n = 0; n < a; n++) { if (r[f[i]] < r[n]) e = i + 1; else { for (var o = 1, u = i - 1; o <= u;) { var c = Math.ceil((o + u) / 2); r[f[c]] < r[n] ? o = c + 1 : u = c - 1 } e = o } t[n] = f[e - 1], f[e] = n, e > i && (i = e) } var v = new Array(i), l = f[i]; for (n = i - 1; n >= 0; n--)v[n] = r[l], l = t[l]; return v } });
define('submodules/dcgview/build-amd/compute-key-mutations', ["./longest-subsequence"], function (e) { "use strict"; function r(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var t = r(e); return function (e, r) { var n, o, u = {}, f = [], s = []; for (n = 0; n < r.length; n++)u[o = r[n]] = n; for (n = 0; n < e.length; n++)void 0 === u[o = e[n]] && f.push(o); var i = []; for (n = 0; n < e.length; n++) { var l = u[o = e[n]]; void 0 !== l && i.push(l) } var a = t.default(i), h = {}; for (n = 0; n < a.length; n++)h[o = r[a[n]]] = !0; for (n = r.length - 1; n >= 0; n--)h[o = r[n]] || s.push({ key: o, beforeKey: r[n + 1] }); return { removes: f, inserts: s } } });
define('submodules/dcgview/build-amd/each', ["./create-class", "./compute-key-mutations", "./create-element", "./mounting"], function (e, t, i, n) { "use strict"; function s(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var o = s(e), r = s(t), h = s(i), l = s(n), a = o.default({ viewName: "EachPlaceholder", _isDCGEachPlaceholder: !0, template: function () { return this.createElement("div", { style: this.const("display: none") }) } }), u = o.default({ viewName: "EachWrapper", _isDCGEachWrapper: !0, template: function () { return this.children[0] } }), c = o.default({ viewName: "Each", _isDCGEach: !0, getKeys: function () { this._keyToItem = {}; var e = this.props.items(), t = this.props.keyFunction ? e.map(this.props.keyFunction) : e.slice(0); if (!this._chosenKeyType && t.length && (this._chosenKeyType = typeof t[0], "string" !== this._chosenKeyType && "number" !== this._chosenKeyType)) throw new Error("The key: " + JSON.stringify(t[0]) + " is not a string or number"); for (var i = 0; i < t.length; i++) { var n = t[i]; if (typeof n !== this._chosenKeyType) throw new Error("Keys must be the same type. " + JSON.stringify(n) + " is not a " + this._chosenKeyType); if (n in this._keyToItem) throw new Error("The key: " + JSON.stringify(n) + " is not unique"); this._keyToItem[n] = e[i] } return t }, createViewForKey: function (e) { var t = this._keyToItem[e], i = this.props.viewFunction.call(this, t, e), n = i; return n._isDCGView || (n = this.createElement(u, null, i)), this._keyToView[e] = n, n }, template: function () { this._keyToView = {}, this._keys = this.getKeys(), this._element = this.createElement(a, null), this._siblingElements = []; for (var e = 0; e < this._keys.length; e++) { var t = this._keys[e], i = this.createViewForKey(t); i._parentElement = this._element._parentElement, this._siblingElements.push(i) } return this._element }, detachAllRemovedViews: function () { for (var e, t = this._childViews, i = 0, n = t.length, s = 0; s < n; s++)(e = t[s])._will_be_unmounted_ ? i++ : t[s - i] = e; t.splice(n - i, i) }, overrideChildUpdates: function () { var e = this._keys, t = this.getKeys(); this._keys = t; var i, n, s, o, h, a, u = this._element.findRootNode().parentNode, c = r.default(e, t), y = []; for (i = c.removes.length - 1; i >= 0; i--)a = c.removes[i], y.push(this._keyToView[a]); for (y.forEach(l.default.willUnmount), i = 0; i < c.removes.length; i++)a = c.removes[i], n = this._keyToView[a], delete this._keyToView[a], n._will_be_unmounted_ = !0, u.removeChild(n.findRootNode()); y.length > 0 && this.detachAllRemovedViews(), y.forEach(l.default.onUnmount), y.forEach(l.default.didUnmount); var f = []; for (i = c.inserts.length - 1; i >= 0; i--)(a = c.inserts[i].key) in this._keyToView || (n = this.createViewForKey(a), f.push(n), l.default.createNodeForView(n, this)); for (f.forEach(l.default.willMount), i = 0; i < c.inserts.length; i++)h = c.inserts[i], s = this._keyToView[h.key].findRootNode(), o = void 0 !== h.beforeKey ? this._keyToView[h.beforeKey].findRootNode() : null, u.insertBefore(s, o); f.forEach(l.default.onMount), f.forEach(l.default.didMount); var d = this._childViews, m = d.length - f.length; for (i = 0; i < m; i++)d[i].update() } }); return function (e, t) { return h.default(c, { items: e, keyFunction: t.key, viewFunction: t.item }) } });
define('submodules/dcgview/build-amd/for', ["./create-class", "./compute-key-mutations", "./const", "./mounting"], function (e, t, i, o) { "use strict"; function r(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var n = r(e), s = r(t), h = r(i), a = r(o), c = n.default({ viewName: "ForWrapper", template: function () { return this.children[0] } }); return n.default({ viewName: "For", _isDCGFor: !0, getKeys: function () { this._keyToItem = {}; var e = this.props.each(); if (!Array.isArray(e)) throw new Error("<For each={}> must return an array"); var t = this.props.key ? e.map(this.props.key) : e.slice(0); if (!this._chosenKeyType && t.length && (this._chosenKeyType = typeof t[0], "string" !== this._chosenKeyType && "number" !== this._chosenKeyType)) throw new Error("The key: " + JSON.stringify(t[0]) + " is not a string or number"); for (var i = 0; i < t.length; i++) { var o = t[i]; if (typeof o !== this._chosenKeyType) throw new Error("Keys must be the same type. " + JSON.stringify(o) + " is not a " + this._chosenKeyType); if (o in this._keyToItem) throw new Error("The key: " + JSON.stringify(o) + " is not unique"); this._keyToItem[o] = e[i] } return t }, createViewForKey: function (e) { var t = this._keyToItem[e], i = this._viewFunction.call(this, t, e), o = i; return o._isDCGView || (o = this.createElement(c, null, i)), this._keyToView[e] = o, o }, template: function () { if (this._keyToView = {}, "function" != typeof this.props.each) throw new Error("<For each={}> must be a function"); if (1 !== this.children.length) throw new Error("<For> expects a single child. You passed " + this.children.length); var e = this.children[0]; if (!e || !e._isDCGElement) throw new Error("<For> expects the root node to be a DCGElement. You passed " + JSON.stringify(e)); if (e._isDCGView) throw new Error("<For> expects the root node to not be a DCGView. Pass in something like <div> or <span>"); if (1 !== e.children.length) throw new Error("<For> expects a root node with a single child. You passed " + e.children.length); if (this._viewFunction = e.children[0], this._viewFunction && this._viewFunction._isDCGElement) throw new Error("<For> expects a function that constructs a DCGElement. You passed a DCGElement directly"); if ("function" != typeof this._viewFunction) { var t = JSON.stringify(this._viewFunction); throw new Error("<For> expects a function that constructs a DCGElement. You passed " + t) } if (h.default.isConst(this._viewFunction)) throw new Error("<For> expects a function that constructs a DCGElement. You passed a constant"); this._keys = this.getKeys(); for (var i = [], o = 0; o < this._keys.length; o++) { var r = this._keys[o], n = this.createViewForKey(r); n._parentElement = this, i.push(n) } return e.children = i, e }, detachAllRemovedViews: function () { for (var e, t = this._childViews, i = 0, o = t.length, r = 0; r < o; r++)(e = t[r])._will_be_unmounted_ ? i++ : t[r - i] = e; t.splice(o - i, i) }, overrideChildUpdates: function () { var e = this._keys, t = this.getKeys(); this._keys = t; var i, o, r, n, h, c, l = this.findRootNode(), u = s.default(e, t), f = []; for (i = u.removes.length - 1; i >= 0; i--)c = u.removes[i], f.push(this._keyToView[c]); for (f.forEach(a.default.willUnmount), i = 0; i < u.removes.length; i++)c = u.removes[i], o = this._keyToView[c], delete this._keyToView[c], o._will_be_unmounted_ = !0, l.removeChild(o.findRootNode()); f.length > 0 && this.detachAllRemovedViews(), f.forEach(a.default.onUnmount), f.forEach(a.default.didUnmount); var d = []; for (i = u.inserts.length - 1; i >= 0; i--)(c = u.inserts[i].key) in this._keyToView || (o = this.createViewForKey(c), d.push(o), a.default.createNodeForView(o, this)); for (d.forEach(a.default.willMount), i = 0; i < u.inserts.length; i++)h = u.inserts[i], r = this._keyToView[h.key].findRootNode(), n = void 0 !== h.beforeKey ? this._keyToView[h.beforeKey].findRootNode() : null, l.insertBefore(r, n); d.forEach(a.default.onMount), d.forEach(a.default.didMount); var y = this._childViews, w = y.length - d.length; for (i = 0; i < w; i++)y[i].update() } }) });
define('submodules/dcgview/build-amd/switch', ["./create-class", "./const", "./mounting"], function (e, t, i) { "use strict"; function n(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var s = n(e), r = n(t), o = n(i), h = s.default({ viewName: "SwitchWrapper", _isDCGSwitchWrapper: !0, template: function () { return this.children[0] } }); return s.default({ viewName: "Switch", _isDCGSwitch: !0, updateKey: function () { this._key = this.props.key() }, createView: function () { var e = this._viewFunction(this._key); null == e && (e = this.createElement("div", { style: this.const("display: none") })); var t = this.createElement(h, null, e); return t._parentElement = this, t }, template: function () { if (this._key = void 0, "function" != typeof this.props.key) throw new Error("<Switch key={}> must be a function"); if (1 !== this.children.length) throw new Error("<Switch> expects a single child. You passed " + this.children.length); if (this._viewFunction = this.children[0], this._viewFunction && this._viewFunction._isDCGElement) throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a DCGElement directly"); if ("function" != typeof this._viewFunction) { var e = JSON.stringify(this._viewFunction); throw new Error("<Switch> expects a function that constructs a DCGElement. You passed " + e) } if (r.default.isConst(this._viewFunction)) throw new Error("<Switch> expects a function that constructs a DCGElement. You passed a constant"); return this.updateKey(), this.createView() }, overrideChildUpdates: function () { var e = this._key; if (this.updateKey(), e === this._key) this._element.update(); else { var t = this.findRootNode(), i = document.createTextNode(""); t.parentNode.insertBefore(i, t), o.default.willUnmount(this._element), this._childViews = [], t.parentNode.removeChild(t), o.default.onUnmount(this._element), o.default.didUnmount(this._element), this._element = this.createView(); var n = o.default.createNodeForView(this._element, this); o.default.willMount(this._element), i.parentNode.insertBefore(n, i), i.parentNode.removeChild(i), o.default.onMount(this._element), o.default.didMount(this._element) } } }) });
define('submodules/dcgview/build-amd/switch-union', ["./create-class", "./mounting", "./create-element"], function (e, t, i) { "use strict"; function n(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var r = n(e), a = n(t), s = n(i), o = r.default({ viewName: "SwitchUnionWrapper", _isDCGSwitchUnionWrapper: !0, template: function () { return this.children[0] } }), u = r.default({ viewName: "SwitchUnion", _isDCGSwitchUnion: !0, updateCase: function () { this._case = this.props.getCase() }, createView: function () { var e = this.props.buildChildView(this._case); null == e && (e = this.createElement("div", { style: this.const("display: none") })); var t = this.createElement(o, null, e); return t._parentElement = this, t }, template: function () { return this._case = void 0, this.updateCase(), this.createView() }, overrideChildUpdates: function () { var e = this._case; if (this.updateCase(), e === this._case) this._element.update(); else { var t = this.findRootNode(), i = document.createTextNode(""); t.parentNode.insertBefore(i, t), a.default.willUnmount(this._element), this._childViews = [], t.parentNode.removeChild(t), a.default.onUnmount(this._element), a.default.didUnmount(this._element), this._element = this.createView(); var n = a.default.createNodeForView(this._element, this); a.default.willMount(this._element), i.parentNode.insertBefore(n, i), i.parentNode.removeChild(i), a.default.onMount(this._element), a.default.didMount(this._element) } } }); function l(e, t, i) { return s.default(u, { getCase: function () { var i = t(); return e ? i && i[e] : i }, buildChildView: function (e) { var n = i[e]; if (n) return n(t) } }) } return function (e, t) { return "string" == typeof e ? l.bind(this, e, t) : l(void 0, e, t) } });
define('submodules/dcgview/build-amd/if', ["./create-class", "./const", "./switch"], function (t, e, n) { "use strict"; function i(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var r = i(t), s = i(e), c = i(n); return r.default({ viewName: "If", _isDCGIf: !0, template: function () { if ("function" != typeof this.props.predicate) throw new Error("<If predicate={}> must be a function"); if (1 !== this.children.length) throw new Error("<If> expects a single child. You passed " + this.children.length); if (this._viewFunction = this.children[0], this._viewFunction && this._viewFunction._isDCGElement) throw new Error("<If> expects a function that constructs a DCGElement. You passed a DCGElement directly"); if ("function" != typeof this._viewFunction) { var t = JSON.stringify(this._viewFunction); throw new Error("<If> expects a function that constructs a DCGElement. You passed " + t) } if (s.default.isConst(this._viewFunction)) throw new Error("<If> expects a function that constructs a DCGElement. You passed a constant"); var e = function () { return !!this.props.predicate() }.bind(this), n = function (t) { if (t) return this._viewFunction() }.bind(this); return this.createElement(c.default, { key: e }, n) } }) });
define('submodules/dcgview/build-amd/if-defined', ["./create-class", "./mounting", "./create-element"], function (e, t, i) { "use strict"; function n(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var d = n(e), s = n(t), r = n(i), l = d.default({ viewName: "IfDefinedWrapper", _isDCGIfDefinedWrapper: !0, template: function () { return this.children[0] } }), u = d.default({ viewName: "IfDefined", _isDCGIfDefined: !0, updateIsDefined: function () { this._isDefined = this.props.isDefined() }, createView: function () { var e; this._isDefined && (e = this.props.buildChildView()), null == e && (e = this.createElement("div", { style: this.const("display: none") })); var t = this.createElement(l, null, e); return t._parentElement = this, t }, template: function () { return this._isDefined = void 0, this.updateIsDefined(), this.createView() }, overrideChildUpdates: function () { var e = this._isDefined; if (this.updateIsDefined(), e === this._isDefined) this._element.update(); else { var t = this.findRootNode(), i = document.createTextNode(""); t.parentNode.insertBefore(i, t), s.default.willUnmount(this._element), this._childViews = [], t.parentNode.removeChild(t), s.default.onUnmount(this._element), s.default.didUnmount(this._element), this._element = this.createView(); var n = s.default.createNodeForView(this._element, this); s.default.willMount(this._element), i.parentNode.insertBefore(n, i), i.parentNode.removeChild(i), s.default.onMount(this._element), s.default.didMount(this._element) } } }); return function (e, t) { return r.default(u, { isDefined: function () { return null != e() }, buildChildView: function () { return t(e) } }) } });
define('submodules/dcgview/build-amd/if-else', ["./switch-union"], function (e) { "use strict"; function t(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var n = t(e); return function (e, t) { var u = n.default(function () { return e() ? "true" : "false" }, t); return u._viewName = "IfElse", u } });
define('submodules/dcgview/build-amd/textarea', ["./create-class", "./spread"], function (t, e) { "use strict"; function r(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var o = r(t), i = r(e); return o.default({ viewName: "Textarea", computeValue: function () { var t = this.props.value(); return null == t ? "" : t + "" }, template: function () { if (!this.props.value) throw new Error('<Textarea> expects a "value={}" prop'); if (!this.props.onInput) throw new Error('<Textarea> expects an "onInput={}" prop'); var t = i.default({}, this.props, { onInput: function (t) { this.props.onInput(t.target.value), this._isMounted && this.update() }.bind(this) }); return this.props.disabled && (t.disabled = function () { return !!this.props.disabled() || void 0 }.bind(this)), delete t.value, this.createElement("textarea", t, this.const(this.computeValue())) }, didUpdate: function () { this.rootDOM || (this.rootDOM = this.findRootNode()); var t = this.computeValue(); this.rootDOM.value !== t && (this.rootDOM.value = t) } }) });
define('submodules/dcgview/build-amd/input', ["./create-class", "./spread"], function (t, e) { "use strict"; function i(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var n = i(t), s = i(e); return n.default({ viewName: "Input", computeValue: function () { var t = this.props.value(); return null == t ? "" : t + "" }, template: function () { if (!this.props.value) throw new Error('<Input> expects a "value={}" prop'); if (!this.props.onInput) throw new Error('<Input> expects an "onInput={}" prop'); var t = s.default({}, this.props, { value: this.const(this.computeValue()), onInput: function (t) { this.props.onInput(t.target.value), this._isMounted && this.update() }.bind(this) }); return this.props.onEnterPressed && (t.onKeypress = function (t) { 13 === t.which && this.props.onEnterPressed() }.bind(this)), this.props.disabled && (t.disabled = function () { return !!this.props.disabled() || void 0 }.bind(this)), t.hasOwnProperty("tabindex") || (t.tabindex = function () { return this.props.disabled && this.props.disabled() ? "-1" : "0" }.bind(this)), this.createElement("input", t) }, didUpdate: function () { this.rootDOM || (this.rootDOM = this.findRootNode()); var t = this.computeValue(); this.rootDOM.value !== t && (this.rootDOM.value = t) } }) });
define('submodules/dcgview/build-amd/checkbox', ["./create-class", "./spread"], function (e, t) { "use strict"; function o(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var c = o(e), h = o(t); return c.default({ viewName: "Checkbox", computeChecked: function () { return !!this.props.checked() }, template: function () { if (!this.props.checked) throw new Error('<Checkbox> expects a "checked={}" prop'); if (!this.props.onChange) throw new Error('<Checkbox> expects an "onChange={}" prop'); var e = h.default({}, this.props, { type: this.const("checkbox"), checked: this.const(this.computeChecked() ? "checked" : void 0), onChange: function (e) { this.props.onChange(e.target.checked), this._isMounted && this.update() }.bind(this) }); return this.createElement("input", e) }, didUpdate: function () { this.rootDOM || (this.rootDOM = this.findRootNode()); var e = this.computeChecked(); this.rootDOM.checked !== e && (this.rootDOM.checked = e) } }) });
define('submodules/dcgview/build-amd/components', ["./each", "./for", "./switch", "./switch-union", "./if", "./if-defined", "./if-else", "./textarea", "./input", "./checkbox"], function (e, t, f, u, a, i, d, n, l, c) { "use strict"; function o(e) { return e && "object" == typeof e && "default" in e ? e : { default: e } } var r = o(e), h = o(t), s = o(f), w = o(u), x = o(a), I = o(i), b = o(d), p = o(n), k = o(l), E = o(c); return { Each: r.default, For: h.default, Switch: s.default, SwitchUnion: w.default, If: x.default, IfDefined: I.default, IfElse: b.default, Textarea: p.default, Input: k.default, Checkbox: E.default } });
define('submodules/dcgview/build-amd/class', ["./create-class"], function (t) { "use strict"; function e(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } return e(t).default({ template: function () { } }) });
define('submodules/dcgview/build-amd/dcg-view', ["./create-element", "./create-class", "./mounting", "./spread", "./const", "./custom-attributes", "./attr-style", "./attr-class", "./attr-lifecycle", "./components", "./warnings", "./bind-text", "./class"], function (t, e, d, a, u, n, o, l, r, i, s, m, f) { "use strict"; function c(t) { return t && "object" == typeof t && "default" in t ? t : { default: t } } var C = c(t), b = c(e), p = c(d), A = c(a), U = c(u), w = c(n), g = c(o), M = c(l), W = c(r), y = c(i), H = c(s), N = c(m), v = c(f), F = N.default.enableSpanWrapping, S = { createElement: C.default, createClass: b.default, mountToNode: p.default.mountToNode, unmountFromNode: p.default.unmountFromNode, spread: A.default, const: U.default.makeConst, isConst: U.default.isConst, addCustomAttribute: w.default.add, Components: y.default, addWarningHandler: H.default.addWarningHandler, removeWarningHandler: H.default.removeWarningHandler, _warn: H.default.warn, enableSpanWrapping: F, Class: v.default }; return S.addCustomAttribute("style", g.default), S.addCustomAttribute("class", M.default), S.addCustomAttribute("willMount", W.default("willMount")), S.addCustomAttribute("onMount", W.default("onMount")), S.addCustomAttribute("didMount", W.default("didMount")), S.addCustomAttribute("willUnmount", W.default("willUnmount")), S.addCustomAttribute("onUnmount", W.default("onUnmount")), S.addCustomAttribute("didUnmount", W.default("didUnmount")), S.addCustomAttribute("willUpdate", W.default("willUpdate")), S.addCustomAttribute("onUpdate", W.default("onUpdate")), S.addCustomAttribute("didUpdate", W.default("didUpdate")), S });
define('submodules/dcgview/dcgview', ['require', './build-amd/dcg-view'], function (require) { return require("./build-amd/dcg-view") });
define('lib/urlparser', ["require", "exports"], function (require, e) { "use strict"; function r(e, r) { return new RegExp("[?|&]" + r + "(=|&|;|$)").test(e) } function t(e, r, t) { if (r !== encodeURIComponent(r)) throw new Error("Programming error: parameter name should be URL-safe without encoding."); var n = encodeURIComponent(t); if (e.length) { var a = e.split("#"), o = /\?/.test(e) ? a[0] + "&" + r + "=" + n : a[0] + "?" + r + "=" + n; return void 0 !== a[1] ? o + "#" + a[1] : o } return "?" + r + "=" + n } function n(e, r, t) { var n = new RegExp("([?|&])" + r + "=([^&;]+?)(&|#|;|$)").exec(e); if (!n) return e; var a = n[1], o = "" + a + r + "=" + n[2], u = "" + a + r + "=" + encodeURIComponent(t); return e.replace(o, u) } Object.defineProperty(e, "__esModule", { value: !0 }), e.setParameter = e.deleteParameter = e.replaceParameter = e.pushParameter = e.hasParameter = e.getParameter = void 0, e.getParameter = function (e, r) { var t = new RegExp("[?|&]" + r + "=([^&;]+?)(&|#|;|$)").exec(e); return t ? decodeURIComponent(t[1].replace(/\+/g, "%20")) : null }, e.hasParameter = r, e.pushParameter = t, e.replaceParameter = n, e.deleteParameter = function (e, r) { var t = new RegExp("([?|&])" + r + "=([^&;]+?)(&|#|;|$)").exec(e); if (!t) return e; var n = "" + t[1] + r + "=" + t[2], a = e.replace(n, ""); return "&" === a[0] ? a.replace("&", "?") : a }, e.setParameter = function (e, a, o) { return r(e, a) ? n(e, a, o) : t(e, a, o) } });
define('lib/retain-lang', ["require", "exports", "./parse-query-params", "./urlparser"], function (require, e, r, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.retainLang = e.domainNotDesmos = void 0; var a = /lang=[A-Za-z]+/, s = /(cl|learn|help).desmos.com/, n = /^(?:https?:)?(?:\/\/)?([^\s\/\?]+)/i, o = /(^desmos\.com$)|(\.desmos.com$)/; function i(e) { var r = n.exec(e); if (r) { var t = r[1]; return !o.test(t) } return !1 } e.domainNotDesmos = i, e.retainLang = function (e, n) { var o = r.getQueryParams(), m = ""; return m = void 0 !== n ? n : o.lang ? "" + o.lang : "", "" === e || "" === m || a.test(e) || s.test(e) || i(e) ? e : t.setParameter(e, "lang", m) } });

define('loadcss!dcgview-shim', function () { });
define('dcgview', ["require", "exports", "submodules/dcgview/dcgview", "jquery", "bugsnag", "lib/retain-lang", "loadcss!dcgview-shim"], function (require, n, t, o, u, i) { "use strict"; return t.addWarningHandler(function (n) { return u.notify(n) }), t.addCustomAttribute("href", function (n) { var t = i.retainLang(n()), u = { value: "" + i.retainLang(n()), bindings: { onMount: function (n) { if (!o(n).is("a") && !o(n).is("use")) throw new Error("Cannot have an href on a non-link element.") } } }; return u.bindings.onUpdate = function (o) { var u = i.retainLang(n()); t !== u && (t = u, o.setAttribute("href", u)) }, u }), t.addCustomAttribute("onTap", function (n) { return { value: "", bindings: { onMount: function (t) { o(t).on("dcg-tap", n) } } } }), t.addCustomAttribute("ignoreRealClick", function (n) { return { bindings: { onMount: function (t) { o(t).on("click", function (t) { n() && t.preventDefault() }) } } } }), t.addCustomAttribute("onTapStart", function (n) { return { bindings: { onMount: function (t) { o(t).on("dcg-tapstart", n) } } } }), t.addCustomAttribute("onTapMove", function (n) { return { bindings: { onMount: function (t) { o(t).on("dcg-tapmove", n) } } } }), t.addCustomAttribute("onTapEnd", function (n) { return { bindings: { onMount: function (t) { o(t).on("dcg-tapend", n) } } } }), t.addCustomAttribute("onLongHold", function (n) { return { bindings: { onMount: function (t) { o(t).on("dcg-longhold", n) } } } }), t.addCustomAttribute("manageFocus", function (n) { return void 0 === n() ? {} : { bindings: { onMount: function (t) { n().shouldBeFocused() && t.focus(), t.onfocus = function (t) { n().shouldBeFocused() || n().onFocusedChanged(!0, t) }, t.onblur = function (t) { n().shouldBeFocused() && n().onFocusedChanged(!1, t) } }, onUpdate: function (t) { var o = n().shouldBeFocused(), u = document.activeElement === t; o && !u ? t.focus() : u && !o && t.blur() }, willUnmount: function (n) { n.onfocus = null, n.onblur = null } } } }), t });
define('graphing/screen', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Screen = void 0; var i = function (e, i) { this.width = e, this.height = i }; e.Screen = i });
define('core/math/poi-type', ["require", "exports"], function (require, E) { "use strict"; Object.defineProperty(E, "__esModule", { value: !0 }), E.LABEL = E.TRACE = E.DEFINITION = E.EXTREMUM = E.INTERCEPT = E.ZERO = E.INTERSECTION = void 0, E.INTERSECTION = 1001, E.ZERO = 1002, E.INTERCEPT = 1003, E.EXTREMUM = 1004, E.DEFINITION = 1006, E.TRACE = 1007, E.LABEL = 1008 });
define('graphing/poi', ["require", "exports", "core/math/poi-type", "core/types/graphmode", "core/types/point-opacity"], function (require, t, e, i, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.POI = void 0; var r = 1, s = function () { function t(t, e, i, n, s, h, o) { this.x = t, this.y = e, this.type = i, this.sketch = n, this.branch = s, this.pointIdxOnBranch = h, this.bareLabel = void 0 !== o && o, this.id = r++ } return t.prototype.getLabel = function () { var t = this.sketch && this.sketch.branches[this.branch]; return t && "labels" in t && t.labels && t.labels[this.pointIdxOnBranch] || "" }, t.prototype.getGraphMode = function () { return this.sketch.branches[this.branch].graphMode }, t.prototype.getCompiledFunction = function () { var t = this.sketch.branches[this.branch]; if ("compiled" in t && t.compiled) return t.compiled.fn }, t.prototype.isAttachedToPlottedPoint = function () { return this.type === e.DEFINITION || this.type === e.LABEL }, t.prototype.isMovable = function () { return this.getGraphMode() === i.XYPOINT_MOVABLE }, t.prototype.isPersistent = function () { return this.type === e.LABEL }, t.prototype.getLabelSize = function () { var t = this.sketch && this.sketch.branches[this.branch]; return this.type === e.LABEL && t && "labelSize" in t ? void 0 === t.labelSize ? 1 : t.labelSize : 1 }, t.prototype.getLabelRotation = function () { var t = this.sketch && this.sketch.branches[this.branch]; return this.type === e.LABEL && t && "labelAngle" in t ? void 0 === t.labelAngle ? 0 : t.labelAngle : 0 }, t.prototype.getPointOpacity = function () { var t = this.sketch && this.sketch.branches[this.branch]; return t && "pointOpacity" in t && void 0 !== t.pointOpacity ? t.pointOpacity : this.isMovable() ? 1 : n.DEFAULT }, t.prototype.getTextOutline = function () { if (this.hasEditableLabel()) return !1; var t = this.sketch && this.sketch.branches[this.branch]; return this.type !== e.LABEL || !t || !("suppressTextOutline" in t) || !t.suppressTextOutline }, t.prototype.hasInteractiveLabel = function () { var t = this.sketch && this.sketch.branches[this.branch]; return !(!t || !("interactiveLabel" in t)) && !!t.interactiveLabel }, t.prototype.hasEditableLabel = function () { var t = this.sketch && this.sketch.branches[this.branch]; return !(!t || !("editableLabel" in t)) && !!t.editableLabel }, t.prototype.isBareLabel = function () { return this.bareLabel }, t.prototype.getMovablePoint = function () { return this.sketch.getMovablePointByIndex(this.pointIdxOnBranch) }, t }(); t.POI = s });
define('vendor/mathquill', ["require", "exports", "mathquill"], function (require, e, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.MQ = void 0, e.MQ = i });
define('lib/mathspeak', ["require", "exports", "vendor/mathquill", "jquery"], function (require, t, e, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.getMathspeakFromText = void 0; var n = /`[^`]*`/g, i = /^[\+\-]?[\d]*(\.\d+)?$/, l = e.MQ.StaticMath(r("<span/>")[0]); function a(t) { var e = ""; return i.test(t) ? (/^\+/.test(t) ? (e = "positive ", t = t.slice(1)) : /^\-/.test(t) && (e = "negative ", t = t.slice(1)), e += t.replace(/(\.)([0-9]+)/g, function (t, e, r) { return e + r.split("").join(" ").trim() })) : (l.latex(t), e = l.mathspeak().trim()), e } t.getMathspeakFromText = function (t) { for (var e = "", r = 0, i = function (t) { if (null != t) { var e = t.match(/`/g); return (null != e && e.length || 0) % 2 == 0 } return !0 }(t) ? function (t) { var e = []; if (null == t || 0 == t.length) return e; for (var r, i = 0; r = n.exec(t);) { var l = t.slice(i, r.index); l.length > 0 && e.push({ from: i, to: r.index, type: "text", text: l }), i = r.index + r[0].length, e.push({ from: r.index, to: i, type: "math", text: r[0].slice(1, -1) }) } var a = t.slice(i); return a.length > 0 && e.push({ from: i, to: t.length, type: "text", text: a }), e }(t) : [{ from: 0, to: t.length, type: "text", text: t }]; r < i.length; r++) { var l = i[r]; e += "text" === l.type ? l.text : a(l.text) } return e } });
define('graphing/graphsketch', ["require", "exports", "core/math/poi-type", "core/types/graphmode", "./poi", "core/math/poi-type", "lib/mathspeak"], function (require, e, t, i, s, h, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.GraphSketch = void 0; var o = function () { function e(e, i) { var s = this; this.color = "#000000", this.style = "normal", this.visible = !0, this.showPOI = !1, this.showHighlight = !1, this.selected = !1, this.labels = [], this.id = e, this.branches = void 0 !== i ? i : [], this.getPOI().forEach(function (e) { e.type === t.LABEL && s.labels.push(e) }) } return e.prototype.getPOI = function () { if (this.__cachedPOI) return this.__cachedPOI; this.__cachedPOI = [], this.__cachedPOIIds = {}; for (var e = 0; e < this.branches.length; e++) { var s = this.branches[e]; if (s.graphMode === i.X || s.graphMode === i.Y) (h = s.poi).zeros && this._pushPOI(h.zeros, e, t.ZERO), h.intercept && this._pushPOI(h.intercept, e, t.INTERCEPT), h.extrema && this._pushPOI(h.extrema, e, t.EXTREMUM), h.intersections && this._pushPOI(h.intersections, e, t.INTERSECTION); else if (s.graphMode === i.XYPOINT || s.graphMode === i.XYPOINT_MOVABLE) { var h = s.poi, a = s.graphMode === i.XYPOINT && !0 === s.interactiveLabel; if (!0 === s.showLabel || a) { var o = s.nakedLabel; h.defined && this._pushPOI(h.defined, e, t.LABEL, o) } else h.defined && this._pushPOI(h.defined, e, t.DEFINITION) } } return this.__cachedPOI }, e.prototype.getBranchPOI = function (e) { return this.getPOI().filter(function (t) { return t.branch === e }) }, e.prototype.getMovablePoints = function () { if (this.__cachedMovablePoints) return this.__cachedMovablePoints; this.__cachedMovablePoints = []; var e = this.branches[0]; if (e && 1 === e.segments.length && e.graphMode === i.XYPOINT_MOVABLE) for (var t = e.segments[0], s = 0; s < t.length; s++) { var h = void 0; e.tableId && (h = { tableId: e.tableId, columnId: this.id, rowIndex: e.movablePointInfo[s].index, dragX: e.movablePointInfo[s].dragX, dragY: e.movablePointInfo[s].dragY }); var o = e.scaleFactors ? e.scaleFactors[0][s] : void 0, c = h ? h.rowIndex : s, r = 1 === e.segments.length && e.labels && e.labels[s] ? e.labels[s] : void 0, n = e.hasOwnProperty("pointOpacity") ? e.pointOpacity : 1; this.__cachedMovablePoints.push({ type: "movable-point", id: "movable:[" + this.id + "," + c + "]", sketch: this, color: this.color, pointOpacity: n, tableInfo: h, scaleFactor: o, x: t[s][0], y: t[s][1], label: r, ariaLabel: r && a.getMathspeakFromText(r) }) } return this.__cachedMovablePoints }, e.prototype.getMovablePointByIndex = function (e) { return this.getMovablePoints()[e] }, e.prototype.getStaticLabeledPoints = function () { var e = this; if (this.__cachedStaticLabeledPoints) return this.__cachedStaticLabeledPoints; var t = this.branches[0]; return this.__cachedStaticLabeledPoints = [], this.getPOI().forEach(function (s) { if ((s.type === h.DEFINITION || s.type === h.LABEL) && t.graphMode === i.XYPOINT) { var o = t.showLabel, c = s.getLabel(); (o || "" !== c) && e.__cachedStaticLabeledPoints.push({ type: "static-labeled-point", id: "static[" + e.id + "," + s.id + "]", x: s.x, y: s.y, sketch: s.sketch, label: c, ariaLabel: "" !== c ? a.getMathspeakFromText(c) : void 0 }) } }), this.__cachedStaticLabeledPoints }, e.prototype._pushPOI = function (e, t, i, h) { void 0 === h && (h = !1); for (var a = 0, o = e.x.length; a < o; a++) { var c = new s.POI(e.x[a], e.y[a], i, this, t, a, h); e.intersects && (c.intersects = e.intersects[a]), this.__cachedPOI.push(c), this.__cachedPOIIds[c.id] = c } }, e.prototype.updateIntersections = function (e) { for (var s = this, h = 0, a = this.branches.length; h < a; h++) { (c = this.branches[h]).graphMode !== i.ERROR && (c.poi.intersections = e[h]) } var o = this.__cachedPOI; this.__cachedPOI = [], o.forEach(function (e) { e.type !== t.INTERSECTION ? s.__cachedPOI.push(e) : delete s.__cachedPOIIds[e.id] }); for (h = 0; h < this.branches.length; h++) { var c; if ((c = this.branches[h]).graphMode === i.X || c.graphMode === i.Y) { var r = c.poi; r.intersections && this._pushPOI(r.intersections, h, t.INTERSECTION) } } }, e.prototype.getPOIById = function (e) { return this.__cachedPOIIds[e] }, e.prototype.updateFrom = function (e) { if (e) { this.visible = !0, this.showPOI = e.showPOI, this.showHighlight = e.showHighlight, this.selected = e.selected; var t = this.branches[0].graphMode; if (t === i.XYPOINT || t === i.XYPOINT_MOVABLE) { for (var s = !0, h = 0; h < this.__cachedPOI.length; h++) { var a = e.__cachedPOI[h], o = this.__cachedPOI[h]; if (!a || a.type !== o.type) { s = !1; break } } if (s) for (h = 0; h < this.__cachedPOI.length; h++) { a = e.__cachedPOI[h], o = this.__cachedPOI[h]; delete this.__cachedPOIIds[o.id], this.__cachedPOIIds[a.id] = o, o.id = a.id } } } }, e }(); e.GraphSketch = o });
!function (e) { if ("object" == typeof exports && "undefined" != typeof module) module.exports = e(); else if ("function" == typeof define && define.amd) define('base64', [], e); else { ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).base64js = e() } }(function () { return function e(r, t, n) { function o(i, u) { if (!t[i]) { if (!r[i]) { var a = "function" == typeof require && require; if (!u && a) return a(i, !0); if (f) return f(i, !0); var d = new Error("Cannot find module '" + i + "'"); throw d.code = "MODULE_NOT_FOUND", d } var c = t[i] = { exports: {} }; r[i][0].call(c.exports, function (e) { var t = r[i][1][e]; return o(t || e) }, c, c.exports, e, r, t, n) } return t[i].exports } for (var f = "function" == typeof require && require, i = 0; i < n.length; i++)o(n[i]); return o }({ "/": [function (require, e, r) { "use strict"; r.byteLength = function (e) { return 3 * e.length / 4 - a(e) }, r.toByteArray = function (e) { var r, t, f, i, u, d, c = e.length; u = a(e), d = new o(3 * c / 4 - u), f = u > 0 ? c - 4 : c; var h = 0; for (r = 0, t = 0; r < f; r += 4, t += 3)i = n[e.charCodeAt(r)] << 18 | n[e.charCodeAt(r + 1)] << 12 | n[e.charCodeAt(r + 2)] << 6 | n[e.charCodeAt(r + 3)], d[h++] = i >> 16 & 255, d[h++] = i >> 8 & 255, d[h++] = 255 & i; 2 === u ? (i = n[e.charCodeAt(r)] << 2 | n[e.charCodeAt(r + 1)] >> 4, d[h++] = 255 & i) : 1 === u && (i = n[e.charCodeAt(r)] << 10 | n[e.charCodeAt(r + 1)] << 4 | n[e.charCodeAt(r + 2)] >> 2, d[h++] = i >> 8 & 255, d[h++] = 255 & i); return d }, r.fromByteArray = function (e) { for (var r, n = e.length, o = n % 3, f = "", i = [], u = 16383, a = 0, c = n - o; a < c; a += u)i.push(d(e, a, a + u > c ? c : a + u)); 1 === o ? (r = e[n - 1], f += t[r >> 2], f += t[r << 4 & 63], f += "==") : 2 === o && (r = (e[n - 2] << 8) + e[n - 1], f += t[r >> 10], f += t[r >> 4 & 63], f += t[r << 2 & 63], f += "="); return i.push(f), i.join("") }; for (var t = [], n = [], o = "undefined" != typeof Uint8Array ? Uint8Array : Array, f = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", i = 0, u = f.length; i < u; ++i)t[i] = f[i], n[f.charCodeAt(i)] = i; function a(e) { var r = e.length; if (r % 4 > 0) throw new Error("Invalid string. Length must be a multiple of 4"); return "=" === e[r - 2] ? 2 : "=" === e[r - 1] ? 1 : 0 } function d(e, r, n) { for (var o, f, i = [], u = r; u < n; u += 3)o = (e[u] << 16) + (e[u + 1] << 8) + e[u + 2], i.push(t[(f = o) >> 18 & 63] + t[f >> 12 & 63] + t[f >> 6 & 63] + t[63 & f]); return i.join("") } n["-".charCodeAt(0)] = 62, n["_".charCodeAt(0)] = 63 }, {}] }, {}, [])("/") });
define('bin', ["base64"], function (e) { "use strict"; var n = {}; return { load: function (e, r, i, o) { var t = r.toUrl(e); if (o.isBuild) { var a = require.nodeRequire("fs"); n[e] = a.readFileSync(t).toString("base64"), i() } else { var s = new XMLHttpRequest; s.open("GET", t, !0), s.responseType = "arraybuffer", s.onload = function () { i(s.response) }, s.send() } }, write: function (e, r, i, o) { r in n ? i("define('" + e + "!" + r + "', ['base64'], function (base64) {  return base64.toByteArray('" + n[r] + "').buffer;});") : console.log("ERROR - failed to find file " + r + " in buildMap") } } });

define('bin!graphing/poi.mp3', ['base64'], function (base64) { return base64.toByteArray('//tQxAAAAAAAAAAAAAAAAAAAAAAASW5mbwAAAA8AAAAIAAAHVwAgICAgICAgICAgICBAQEBAQEBAQEBAQEBgYGBgYGBgYGBgYGBggICAgICAgICAgICAoKCgoKCgoKCgoKCgoMDAwMDAwMDAwMDAwODg4ODg4ODg4ODg4OD///////////////8AAAA5TEFNRTMuOThyAaUAAAAALmcAABRAJAiwQgAAQAAAB1cctrbdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/7UMQAAAjsKyK0YYABp52xtx8wAgAgBd34IAhAgnsECEe7QIAAgsPxACDgcBAEHQfD/g+D4PggCAIf///ghLny4Pg+D5+sHz/wf+XPwfB8H3iMHwfwffUCYPvz/Y7Hg/H4/H4/H4HAwADcoDwAP7XfuAFtXrhzjsjOXP8iCYM4IBVoH2DGAhQR2hm5vikA2IVEPX9nQaITi6IiLCKX/fxcg/DdGmS5BP7fIGQ0hw7DQi5Q//8midImXygdJ0tlz/1NAgXIANV6MA2Vy2y27jv/+1LEBIALOHOTvGGAMXWhbnTxGZ+LOa2FNMsDtj9/jUmPqqqARrNvlVjDDoGZqq0T11A0DVqeEnlQk8q4sVEp0FcqdxLoEJ0RPYWvIlQkbGA0Anw6VJJgqRKw1NJaAXkR4ag0/FwCCABbbdbJA0fzVgdvgvu5Px6Rwiv3VllZVDREqmWntLyBDka3sz951iTve+ddHP0/M3P/+ydU4zbqOZOeop5jfu1kwk8VezPeGc1hRMbWrJNv6SO/fH0Mc15KYvKqAAAAdrdsrbBDuBpp4v/7UsQGgguVE2ekjNP5aSBo6YSNgKAQUoCZEBJK8q73G/nhJFFmLY5dNc4b7gjBRyEs5yjJokY9TBoU/pXQBglyNjeiA87V8vkzaw019YTu2fxY0t6gteLMI37f9fYw7UVnWoE4NJOSpQBu3GfVAIVACgw+IikZZAnB7UKlLGnha4PDbIhsBhk4RYmlE2hYZ8NrQ5HnyEUvZxDyVG1hM33ZZH0OlrJV5///3/51qTGtJgxhREVLEfoO1w6686eRAAAAUicksbA1qegZCe2AuEgJ//tSxAkCDF0XSaw8ailyn+l1h4w1BvVY04S56fYY5nGkBZHMGLBjHDUMlORG4wcCT9R6RB+3vM8jVMU1hmlOoXIOMKqotE2HxWYNJq/7EZ2l63NJ+Z2aTA4Yq+7t0PhOxCz9WP1mA3DJZZGDkRfq+qFAGwhwHUAVqBfDiMUlypaMWApR1VoWLChfUpJzkBDMCTf85UZr6jyHa1psZnTS5iKatTVKcX/Ker9zMvM1T0okGyiQcreJbU1tc+Yj/ms3395FBIADkjlkjbAZNdiwgRD/+1LEBwAL8Tdbp6Rh+XmT6XWHjCx5U4sTCtlUidNtS9I7oUx7oxdIZlOghkIQYzB0vxtMs6QgCg4WMVakQMM5HRfrsdIEftM0yfOHnNGkiPRMoWCKSsxsChat8/vYw4c4t+CMMB5AAAAXZrftWiEVdbSgnURZoWvK2KhK9GfCkIGnQKxIqbYJ0JCNFJ3St1wuUNRLW4Kw5VhLVGrmgYKhhRe1qzzC7SqFFyjJlIqXcPD6gw//epZ9bwQFw+s+rdVAFtzl0AAAA3I3JK0QJxtCHv/7UsQGAApAM0WssGFpSCKqNYMMvgZph6CwIhKEt0yEiMwFKpnDBBajVc5jbTM7KayRt3I43h8Ag05kd9AtqO0bItmf/+Aevzf7dx28sK0hvP//3/izNwf1pfEAgANutuOJACSqWvuW+SKNLQSpOQKsrX3XxnZxy2Rus0Q1irPy9Mkg4kZGJFRQUax4R+jsACwavqYd2bmRX/6VnKrLk2Z2VGYwQNCIEasJh7/oBScAAMtBNgBWssKw0uCAgKkVpJirpZyBklUCwqaSIkW6BgIY//tSxBIDSYw3Km0kSoEzi9KAliSw9QNAydBqoFQVEQNBwiJYiBWdDqxiwVBUGqg6JgaBoGj3//////huVcFQsIRoPjBXLBGA8AkCwOhcD4KAmFAtEYcR6E8gD2OAXJ2N//uSJVZVJNRdh0gkLCwuKioqz4sLC3//////4sLC31ioqKpAoqKirOgFqkxBTUUzLjk4LjKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqr/+1LEIwPAAAGkAAAAIAAANIAAAASqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqg==').buffer; });
define('graphing/tonegenerator', ["require", "exports", "bin!./poi.mp3", "browser", "bugsnag", "core/types/graphmode", "graphing/clipping"], function (require, e, t, n, i, a, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getReportedBranch = e.getFirstPlayableBranchIndex = e.canPlayBranch = e.canPlaySketch = void 0; var r = .0015, s = function () { function e(e) { var t = e.audioPointMove, n = e.animationFinished, i = e.audioEnabled; this.audioSpeed = 50, this.audioVolume = .5, this.audioPointMove = t, this.animationFinished = n, this.audioEnabled = i } return e.prototype.suspend = function () { this.playbackSupported && this.audioCtx && (this.stop(), this.audioCtx.suspend()) }, e.prototype.resume = function () { if (!this.audioCtx) { var e = window.AudioContext || window.webkitAudioContext; if (n.IS_IE) this.playbackSupported = !1, this.audioCtx = void 0; else try { this.audioCtx = e ? new e : void 0, this.playbackSupported = !0 } catch (e) { i.notify(e), this.playbackSupported = !1, this.audioCtx = void 0 } } this.playbackSupported && this.audioCtx && ("suspended" === this.audioCtx.state && this.audioCtx.resume(), this.loadPOI()) }, e.prototype.stop = function () { this.playTimeout && (cancelAnimationFrame(this.playTimeout), this.playTimeout = void 0), this.bufferSource && (this.bufferSource.stop(), this.bufferSource.disconnect(), this.bufferSource = void 0), this.animationFinished() }, e.prototype.isAnimating = function () { return void 0 !== this.playTimeout }, e.prototype.getAudioSpeed = function () { return this.audioSpeed }, e.prototype.setAudioSpeed = function (e) { this.audioSpeed = e }, e.prototype.getAudioVolume = function () { return this.audioVolume }, e.prototype.setAudioVolume = function (e) { this.audioVolume = e, void 0 !== this.gainMaster && (this.gainMaster.gain.value = this.audioVolume) }, e.prototype.getPlaybackSupported = function () { return this.playbackSupported }, e.prototype.playBranchByIndex = function (e, t, n) { var i = this; if (!(!this.audioEnabled() || t < 0 || t >= e.branches.length) && f(e.branches[t])) { this.playBranch(e.branches[t], t, n, function () { return i.stop() }) } }, e.prototype.playSketch = function (e, t) { var n = this; if (this.audioEnabled()) { var i = e.branches; if (0 !== i.length) { var a = -1, o = function () { for (a += 1; a < i.length && !f(i[a]);)a += 1; a < i.length ? n.playBranch(i[a], a, t, o) : n.stop() }; o() } } }, e.prototype.playPoint = function (e, t) { if (this.audioEnabled() && this.audioCtx && function (e) { switch (e.graphMode) { case a.X: case a.Y: case a.XYPOINT: case a.XYPOINT_MOVABLE: return !0; default: return !1 } }(e)) { var n = this.audioCtx.sampleRate, i = .075 * n, o = this.audioCtx.createBuffer(2, i, n); !function (e, t, n, i) { for (var o = e.sampleRate, r = e.getChannelData(0), s = e.getChannelData(1), h = t.graphMode, p = g(n, h), c = r.length - 1, f = { amplitude: 0, phase: 0, noiseVal: 0, lowerOctaveGain: 0, upperOctaveGain: 0 }, m = function (e) { switch (e.graphMode) { case a.Y: case a.XYPOINT: case a.XYPOINT_MOVABLE: return { independent: e.x, dependent: e.y }; case a.X: return { independent: e.y, dependent: e.x }; default: throw M(e.graphMode) } }(t), x = m.independent, v = m.dependent, y = u(h, x, p), b = 0; b < r.length; b++) { f = d(f, { independent: x, dependent: v }, p, o, (c - b) / o), r[b] += f.amplitude * y.left, s[b] += f.amplitude * y.right } i && void 0 !== t.intersects && l(i, e, 0, y) }(o, e, t, this.poiBuffer), this.connectBuffer(o) } }, e.prototype.connectBuffer = function (e) { if (this.audioEnabled() && this.audioCtx) { this.gainMaster = this.audioCtx.createGain(), this.gainMaster.connect(this.audioCtx.destination), this.gainMaster.gain.value = this.audioVolume; var t = this.audioCtx.createBufferSource(); this.bufferSource = t, t.buffer = e, t.connect(this.gainMaster), t.start() } }, e.prototype.playBranch = function (e, t, n, i) { var r = this; if (this.audioEnabled() && this.audioCtx) { var s = this.audioSpeed / 10, h = function (e, t, n) { switch (e.graphMode) { case a.Y: for (var i = [], r = 0, s = e.segments; r < s.length; r++) { var u = s[r]; (f = o.clipStrokeEdges(u, t)).length > 2 && i.push(f) } return { graphMode: e.graphMode, segments: i, poi: e.poi }; case a.X: i = []; for (var d = { xmin: t.ymin, xmax: t.ymax, ymin: t.xmin, ymax: t.ymax }, h = 0, p = e.segments; h < p.length; h++) { u = p[h]; (f = o.clipStrokeEdges(u, d)).length > 2 && i.push(f) } return { graphMode: e.graphMode, segments: i, poi: e.poi }; case a.XYPOINT: case a.XYPOINT_MOVABLE: var c = e.segments[0].slice(); c.sort(x); i = []; for (var l = 0; l < c.length; l++) { var f, g = c[l], m = l > 0 ? c[l - 1][0] : -1 / 0, M = l < c.length - 1 ? c[c.length - 1][0] : 1 / 0, v = Math.max(g[0] - .5 * n, .5 * (g[0] + m)), y = Math.min(g[0] + .5 * n, .5 * (g[0] + M)); u = [v, g[1], y, g[1]]; (f = o.clipStrokeEdges(u, t)).length > 2 && i.push(f) } return { graphMode: a.Y, segments: i }; default: throw new Error("Unimplemented graph mode: " + e.graphMode) } }(e, n, (n.xmax - n.xmin) * (.075 / s)); if (h.segments.length) { var p = g(n, h.graphMode), c = m(h), f = c.independentMin, v = c.independentMax, y = this.audioCtx.sampleRate, b = s * (v - f) / (p.independentMax - p.independentMin), C = Math.floor(y * b), P = this.audioCtx.createBuffer(2, C, y); !function (e, t, n, i) { for (var o = e.sampleRate, r = e.getChannelData(0), s = e.getChannelData(1), h = t.graphMode, p = g(n, h), c = m(t), f = c.independentMin, x = c.independentMax, v = x - f, y = 0, b = 0, C = r.length - 1, P = C / o, S = { amplitude: 0, phase: 0, noiseVal: 0, lowerOctaveGain: 0, upperOctaveGain: 0 }, B = 0; B < r.length; B++) { for (var O = u(h, k = (C - B) / C * f + B / C * x, p); y < t.segments.length && t.segments[y][b] < k;)(b += 2) >= t.segments[y].length && (y += 1, b = 0); var w = t.segments[y], I = NaN, T = NaN; if (w && w.length > 2 && b - 2 >= 0 && b + 1 < w.length) { T = (w[w.length - 2] - k) * (P / v); var A = w[b - 2], E = w[b - 1], X = w[b], Y = X - A; I = (X - k) / Y * E + (k - A) / Y * w[b + 1] } S = d(S, { independent: k, dependent: I }, p, o, T), r[B] += S.amplitude * O.left, s[B] += S.amplitude * O.right } if (i && t.poi && t.poi.intersections) for (var N = 0, V = function (e, t) { if (e === a.X) return t.y; if (e === a.Y) return t.x; throw M(e) }(h, t.poi.intersections); N < V.length; N++) { var k = V[N]; l(i, e, B = Math.round((k - f) / (x - f) * C), u(h, k, p)) } }(P, h, n, this.poiBuffer), this.connectBuffer(P); var S = this.audioCtx.currentTime, B = function () { if (void 0 !== r.playTimeout && cancelAnimationFrame(r.playTimeout), r.audioCtx) { var e = r.audioCtx.currentTime - S, n = (b - e) / b * f + e / b * v; r.audioPointMove(t, n), e < b ? r.playTimeout = requestAnimationFrame(B) : i() } }; B() } else requestAnimationFrame(i) } }, e.prototype.loadPOI = function () { var e = this; this.playbackSupported && !this.poiBuffer && this.audioCtx && this.audioCtx.decodeAudioData(t.slice(0), function (t) { e.poiBuffer = t }) }, e }(); function u(e, t, n) { if (e === a.X) return { left: 1, right: 1 }; var i = n.independentMin, o = n.independentMax, r = Math.abs((t - i) / (o - i)); return isFinite(r) || (r = .5), r = Math.max(Math.min(r, 1), 0), { left: Math.cos(Math.PI / 2 * r), right: Math.sin(Math.PI / 2 * r) } } function d(e, t, n, i, a) { var o = t.independent, s = t.dependent, u = e.phase, d = e.noiseVal, p = e.lowerOctaveGain, l = e.upperOctaveGain, f = n.dependentMin, g = n.dependentMax, m = 0, M = 0, x = 0; !isNaN(s) && f <= s && s <= g ? (u += function (e) { return Math.min(Math.max(330 * Math.pow(2, e), 125), 2e3) }((s - f) / (g - f)) / i, a < .006 ? (M = 0, x = 0) : (M = .5, x = o >= 0 ? .15 : 0), s < 0 && (m += .1 * (d = c(d)))) : m += .04 * (d = c(d)); return l += (x - l) / (i * r), { amplitude: m += (p += (M - p) / (i * r)) * h(u) + l * h(2 * u), phase: u, noiseVal: d, lowerOctaveGain: p, upperOctaveGain: l } } function h(e) { return .8782 * (p(e) + .25 * p(2 * e) + .25 * p(3 * e)) } function p(e) { return Math.sin(2 * Math.PI * e) } function c(e) { return (e + .2 * (2 * Math.random() - 1)) / 1.02 } function l(e, t, n, i) { for (var a = e.getChannelData(0), o = t.getChannelData(0), r = t.getChannelData(1), s = 0; s < a.length && s + n < o.length; s++)o[s + n] += a[s] * i.left, r[s + n] += a[s] * i.right } function f(e) { switch (e.graphMode) { case a.X: case a.Y: case a.XYPOINT: case a.XYPOINT_MOVABLE: return e.segments.length > 0; default: return !1 } } function g(e, t) { switch (t) { case a.Y: case a.XYPOINT: case a.XYPOINT_MOVABLE: return { independentMin: e.xmin, independentMax: e.xmax, dependentMin: e.ymin, dependentMax: e.ymax }; case a.X: return { independentMin: e.ymin, independentMax: e.ymax, dependentMin: e.xmin, dependentMax: e.xmax }; default: throw M(t) } } function m(e) { var t = e.segments[0], n = e.segments[e.segments.length - 1]; return { independentMin: t[0], independentMax: n[n.length - 2] } } function M(e) { return "Unexpected graph mode. Received " + e } function x(e, t) { return e[0] - t[0] } e.default = s, e.canPlaySketch = function (e) { if (!e.visible) return !1; for (var t = 0, n = e.branches; t < n.length; t++) { if (f(n[t])) return !0 } return !1 }, e.canPlayBranch = f, e.getFirstPlayableBranchIndex = function (e) { for (var t = 0; t < e.branches.length; t++)if (f(e.branches[t])) return t; return 0 }, e.getReportedBranch = function (e, t) { for (var n = 0, i = 0; i <= t; i++)f(e.branches[i]) && (n += 1); return n } });
define('graphing/audiographnavigator', ["require", "exports", "main/propagate_selection", "tslib", "underscore", "core/types/graphmode", "core/lib/label", "core/math/poi-type", "graphing/tonegenerator", "underscore", "lib/aria"], function (require, e, t, r, n, i, o, a, s, h, p) { "use strict"; function c(e, t, r) { return { x: e.x, y: e.y, branch: e.branch, reportedBranch: r, type: e.type, graphMode: t, intersects: e.intersects } } Object.defineProperty(e, "__esModule", { value: !0 }); var l = function () { function e(e, t, r) { this.grapher = r, this.controller = e, this.audiograph = t, this.reset() } return e.prototype.reset = function () { this.currentPoint = void 0, this.resetToFirstBranch(), this.sampledPoints = [], this.pois = [], this.independent = 0, this.xstep = 0, this.ystep = 0 }, e.prototype.resetToFirstBranch = function () { var e = this.getCurrentSketch(); this.branch = e ? s.getFirstPlayableBranchIndex(e) : 0 }, e.prototype.getBranchPoints = function (e) { var t = []; if (e >= 0) for (var r = 0, n = this.getSampledPoints(); r < n.length; r++) { var i = n[r]; i.branch === e && t.push(i) } return t }, e.prototype.resetTracePoint = function () { this.drawTrace(this.getCurrentPoint()) }, e.prototype.drawTrace = function (e) { var t = this.getCurrentSketch(); if (e && t) { var r = t.branches[this.branch]; if (r) if (r.graphMode !== i.XYPOINT) { var n = { x: e.x, y: e.y }, o = { branchInfo: { branch: e.branch, id: t.id, sketch: t }, pt: n }; h.isEqual(o, this.grapher.traceLayer.getTraceInfo()) || (this.grapher.traceLayer.setTraceInfo(o), this.grapher.redrawAllLayers()) } } }, e.prototype.moveToOrigin = function () { var e = this.getCurrentSketch(); if (e && s.canPlaySketch(e)) { var t = e.branches[this.branch]; if (s.canPlayBranch(t)) { var r = t.graphMode; if (r === i.Y) this.setIndependent("x", 0); else if (r === i.X) this.setIndependent("y", 0); else if (r === i.XYPOINT) { var n = this.getSortedPOI()[0]; this.setIndependent("x", n ? n.x : 0) } } } }, e.prototype.getCurrentSketch = function () { var e, t = this.getSelectedItem(); if (t) { var r = this.audiograph.getFocusedCell(); if ("table" === t.type) { if (r && (e = this.getGraphSketchForTableCell(t, r)), !e) for (var n = 0, i = t.columnModels; n < i.length; n++) { var o = i[n]; if (void 0 !== (e = this.grapher.getGraphSketch(o.id))) break } } else e = this.grapher.getGraphSketch(t.id) } return e }, e.prototype.getFirstTraceableSketch = function (e) { for (var t, r = this.controller.getItemCount(), n = this.controller.shouldAudioTraceReverseExpressions(), i = 0; i < r; i++) { var o = n ? r - 1 - i : i, a = this.controller.getItemModelByIndex(o); if (a && this.canTrace(a)) { var s = n ? this.prevTableColumn(a) : this.nextTableColumn(a); if (s ? (this.audiograph.setFocusedCell(s), t = this.getGraphSketchForTableCell(a, s)) : t = this.grapher.getGraphSketch(a.id), t) { e && e.selectAssociatedExpression && this.controller.dispatch({ type: "set-selected-index", index: o }); break } } } return t }, e.prototype.canTrace = function (e) { if ("image" === e.type) return !1; if ("shouldGraph" in e) { var t = this.grapher.getGraphSketch(e.id); return !!t && s.canPlaySketch(t) } return !1 }, e.prototype.getTraceableExpressionCount = function () { for (var e = 0, t = this.controller.getItemCount(), r = 0; r < t; r++) { var n = this.controller.getItemModelByIndex(r); n && (this.canTrace(n) && e++) } return e }, e.prototype.computeStepSizes = function () { var e = this.grapher.getProjection().viewport; if (e) { this.viewport = e; var t = e.xmin, r = e.xmax; this.xstep = Math.abs(r - t) / 100, this.xscale = r - t; var n = e.ymin, o = e.ymax; this.ystep = Math.abs(o - n) / 100, this.yscale = o - n; var a = this.getCurrentSketch(); if (a && s.canPlaySketch(a)) { var h = a.branches[this.branch]; if (s.canPlayBranch(h)) { var p = h.graphMode; if (p === i.Y) this.independent < t ? this.independent = t : this.independent > r && (this.independent = r); else if (p === i.X) this.independent < n ? this.independent = n : this.independent > o && (this.independent = o); else if (p === i.XYPOINT) { var c = void 0, l = void 0; this.independent < t ? (l = this.getSortedPOI()[0], this.independent = l && void 0 !== l.x ? l.x : 0) : this.independent > r && (l = (c = this.getSortedPOI())[c.length - 1], this.independent = l && void 0 !== l.x ? l.x : 0) } } } } }, e.prototype.getPoint = function (e, t) { var r, n, o, a, h = this.getCurrentSketch(); if (!h || !s.canPlaySketch(h)) return r; var p = 0, c = h.branches[e]; if (c) { var l = s.getReportedBranch(h, e); return "compiled" in c && c.compiled && (a = c.compiled.fn), (o = c.graphMode) === i.Y ? ((n = this.getInterveningPOIs(t, t + this.xstep, e, o)[0]) && n.x === t && n.branch === e || (n = void 0, p = a ? a(t) : 0), n ? r = { x: n.x, y: n.y, type: n.type, typeChain: n.typeChain, branch: n.branch, reportedBranch: l, graphMode: o, intersects: n.intersects } : a && (r = { x: t, y: p, branch: e, reportedBranch: l, graphMode: o })) : o === i.X ? ((n = this.getInterveningPOIs(t, t + this.ystep, e, o)[0]) && n.y === t && n.branch === e || (n = void 0, p = a ? a(t) : 0), n ? r = { x: n.x, y: n.y, type: n.type, typeChain: n.typeChain, branch: n.branch, reportedBranch: l, graphMode: o, intersects: n.intersects } : a && (r = { y: t, x: p, branch: e, reportedBranch: l, graphMode: o })) : o === i.XYPOINT && (r = (n = this.getInterveningPOIs(t, t + this.xstep, e, o)[0]) && n.x === t && n.branch === e ? { x: n.x, y: n.y, type: n.type, typeChain: n.typeChain, branch: n.branch, reportedBranch: l, graphMode: o, intersects: n.intersects } : { x: t, y: NaN, branch: e, reportedBranch: l, graphMode: o }), r } }, e.prototype.getSampledPoints = function () { return 0 === this.sampledPoints.length && this.updateSampledPoints(), this.sampledPoints }, e.prototype.updateSampledPoints = function () { var e = this.getCurrentSketch(); if (e && s.canPlaySketch(e)) { for (var t = [], r = 0; r < e.branches.length; r++) { var n = e.branches[r]; if (s.canPlayBranch(n)) { var a = n.graphMode, h = 0, p = 0, c = 0, l = []; if (a === i.Y || a === i.XYPOINT ? (h = this.viewport.xmin, p = this.viewport.xmax, c = this.xstep) : a === i.X && (h = this.viewport.ymin, p = this.viewport.ymax, c = this.ystep), 0 !== h || 0 !== p || 0 !== c) { for (var d = 0; o.value(h + d * c).value <= p; d++) { var u = o.value(h + d * c).value, v = this.getInterveningPOIs(u, u + c, r, a); if (v.length > 0) l.push.apply(l, v); else { var g = this.getPoint(r, u); g && l.push(g) } } t.push.apply(t, this.removeDuplicates(l, a)) } } } this.sampledPoints = t } }, e.prototype.getCurrentPoint = function () { return this.currentPoint || this.updateCurrentPoint(), this.currentPoint }, e.prototype.updateCurrentPoint = function (e) { if (e) { this.currentPoint = e; var t = e.graphMode; t === i.Y || t === i.XYPOINT ? this.independent = void 0 !== e.x ? e.x : 0 : t === i.X && (this.independent = void 0 !== e.y ? e.y : 0), this.branch = e.branch } else this.currentPoint = this.getPoint(this.branch, this.independent) }, e.prototype.prevPoint = function () { this.moveToPoint(-1) }, e.prototype.nextPoint = function () { this.moveToPoint(1) }, e.prototype.firstPoint = function () { var e = this.getSampledPoints(); e.length > 0 && this.updateCurrentPoint(e[0]) }, e.prototype.lastPoint = function () { var e = this.getSampledPoints(); e.length > 0 && this.updateCurrentPoint(e[e.length - 1]) }, e.prototype.moveToPoint = function (e) { var t = this.getCurrentPoint(); if (t) if (t.graphMode !== i.XYPOINT) { var r = this.getSampledPoints(), n = this.getPointIndex(r, t); if (-1 !== n) { var o = n + e; o <= 0 ? (o = 0, p.queue(this.controller.s("graphing-calculator-narration-audio-trace-first-point"))) : o >= r.length - 1 && (o = r.length - 1, p.queue(this.controller.s("graphing-calculator-narration-audio-trace-last-point"))); var a = r[o]; this.updateCurrentPoint(a) } } else this.moveToPOI(e) }, e.prototype.canMoveToPrevPoint = function () { var e = this.getCurrentPoint(); if (!e) return !1; if (e.graphMode === i.XYPOINT) return this.canMoveToPrevPOI(); var t = this.getSampledPoints(); return this.getPointIndex(t, e) > 0 }, e.prototype.canMoveToNextPoint = function () { var e = this.getCurrentPoint(); if (!e) return !1; if (e.graphMode === i.XYPOINT) return this.canMoveToNextPOI(); var t = this.getSampledPoints(); return this.getPointIndex(t, e) < t.length - 1 }, e.prototype.prevPOI = function () { this.moveToPOI(-1) }, e.prototype.nextPOI = function () { this.moveToPOI(1) }, e.prototype.getSortedPOI = function () { return this.pois && 0 !== this.pois.length || this.updatePOI(), this.pois }, e.prototype.updatePOI = function () { var e, t = [], r = [], o = this.getCurrentSketch(); if (o && s.canPlaySketch(o)) { for (var a = 0; a < o.branches.length; a++) { var h = o.branches[a]; if (h) { var p = s.getReportedBranch(o, a), l = h.graphMode; if (r = [], (e = o.getBranchPOI(a)).length > 0) { l === i.Y || l === i.XYPOINT ? r = n.sortBy(e, "x") : l === i.X && (r = n.sortBy(e, "y")); for (var d = [], u = 0, v = r; u < v.length; u++) { var g = v[u]; d.push(c(g, l, p)) } t.push.apply(t, this.removeDuplicates(d, l)) } } } this.pois = t } }, e.prototype.removeDuplicates = function (e, t) { for (var n = [], i = 0, s = e; i < s.length; i++) { var h = s[i]; if ((h = r.__assign({}, h)).graphMode = t, 0 !== n.length) { var p = n[n.length - 1]; o.value(p.x).value === o.value(h.x).value && o.value(p.y).value === o.value(h.y).value && p.branch === h.branch ? (p.typeChain || (p.typeChain = void 0 !== p.type ? [p.type] : []), void 0 !== h.type && -1 === p.typeChain.indexOf(h.type) && p.typeChain.push(h.type), h.type === a.INTERSECTION && h.intersects && void 0 === p.intersects && (p.intersects = h.intersects)) : n.push(h) } else n.push(h) } return n }, e.prototype.getInterveningPOIs = function (e, t, r, n) { for (var o = [], a = NaN, s = 0, h = this.getSortedPOI(); s < h.length; s++) { var p = h[s]; p && (n !== i.Y && n !== i.XYPOINT || isNaN(p.x) ? n !== i.X || isNaN(p.y) || (a = p.y) : a = p.x, p.branch === r && !isNaN(a) && (e <= a && a < t || t <= a && a < e) && o.push(p)) } return e > t ? o.reverse() : o }, e.prototype.setIndependent = function (e, t) { for (var r = this.getSampledPoints(), n = 0, i = r; n < i.length; n++) { var o = i[n]; if (o && o.hasOwnProperty(e) && o[e] === t) { if ("x" === e) return this.independent = void 0 !== o.x ? o.x : 0, void this.updateCurrentPoint(); if ("y" === e) return this.independent = void 0 !== o.y ? o.y : 0, void this.updateCurrentPoint() } } var a = !0; if (r.length > 0) { var s = r[Math.floor((r.length - 1) / 2)]; s && ("x" === e ? (this.independent = void 0 !== s.x ? s.x : 0, a = !1) : "y" === e && (this.independent = void 0 !== s.y ? s.y : 0, a = !1)) } a && (this.independent = 0), this.resetToFirstBranch(), this.updateCurrentPoint() }, e.prototype.moveToPOI = function (e) { if (this.getCurrentPoint()) { var t = this.getSampledPoints(), r = this.getPOIIndexByDirection(e); -1 === r ? p.queue(this.controller.s("graphing-calculator-narration-audio-trace-no-more-pois")) : this.updateCurrentPoint(t[r]) } }, e.prototype.getPOIIndexByDirection = function (e) { var t = this.getCurrentPoint(); if (!t) return -1; var r = this.getSampledPoints(), n = this.getPointIndex(r, t), o = -1; if (-1 !== n) for (var a = t.graphMode, s = 1 === e ? r.length - 1 : 0, h = n; h !== s + e; h += e) { var p = r[h]; if (((a === i.Y || a === i.XYPOINT) && t.x !== p.x || a === i.X && t.y !== p.y) && void 0 !== p.type) { o = h; break } } return o }, e.prototype.canMoveToPrevPOI = function () { return -1 !== this.getPOIIndexByDirection(-1) }, e.prototype.canMoveToNextPOI = function () { return -1 !== this.getPOIIndexByDirection(1) }, e.prototype.getPointIndex = function (e, t) { var r = -1; if (e.length > 0 && t) for (var n = t.graphMode, o = 0; o < e.length; o++) { var a = e[o]; if (((n === i.Y || n === i.XYPOINT) && a.x === t.x || n === i.X && a.y === t.y) && a.branch === t.branch) { r = o; break } } return r }, e.prototype.prevCurve = function () { this.controller.shouldAudioTraceReverseExpressions() ? this.curveDown() : this.curveUp() }, e.prototype.nextCurve = function () { this.controller.shouldAudioTraceReverseExpressions() ? this.curveUp() : this.curveDown() }, e.prototype.curveUp = function () { var e = this.getSelectedItem(); if (e) { var t = this.prevTableColumn(e); if (t) this.audiograph.setFocusedCell(t); else { var r = e.index, n = this.findPrevTraceableIndex({ index: r, focusTableCell: !0 }); if (-1 !== n) { var i = this.controller.getItemModelByIndex(n); i && this.controller.dispatch({ type: "set-selected-id", id: i.id }) } } (t || this.getSelectedItem() !== e) && this.audiograph.enterAudioTrace() } }, e.prototype.curveDown = function () { var e = this.getSelectedItem(); if (e) { var t = this.nextTableColumn(e); if (t) this.audiograph.setFocusedCell(t); else { var r = e.index, n = this.findNextTraceableIndex({ index: r, focusTableCell: !0 }); if (-1 !== n) { var i = this.controller.getItemModelByIndex(n); i && this.controller.dispatch({ type: "set-selected-id", id: i.id }) } } (t || this.getSelectedItem() !== e) && this.audiograph.enterAudioTrace() } }, e.prototype.canMoveToPrevCurve = function () { var e = this.getSelectedItem(); return !!e && (this.controller.shouldAudioTraceReverseExpressions() ? -1 !== this.findNextTraceableIndex({ index: e.index, focusTableCell: !1 }) : -1 !== this.findPrevTraceableIndex({ index: e.index, focusTableCell: !1 })) }, e.prototype.canMoveToNextCurve = function () { var e = this.getSelectedItem(); return !!e && (this.controller.shouldAudioTraceReverseExpressions() ? -1 !== this.findPrevTraceableIndex({ index: e.index, focusTableCell: !1 }) : -1 !== this.findNextTraceableIndex({ index: e.index, focusTableCell: !1 })) }, e.prototype.findPrevTraceableIndex = function (e) { var t, r = e.index; do { r--; var n = (t = this.controller.getItemModelByIndex(r)) && this.prevTableColumn(t); if (n) return e.focusTableCell && this.audiograph.setFocusedCell(n), r } while (t && !this.canTrace(t)); return t ? r : -1 }, e.prototype.findNextTraceableIndex = function (e) { var t, r = e.index; do { r++; var n = (t = this.controller.getItemModelByIndex(r)) && this.nextTableColumn(t); if (n) return e.focusTableCell && this.audiograph.setFocusedCell(n), r } while (t && !this.canTrace(t)); return t ? r : -1 }, e.prototype.prevTableColumn = function (e) { return this.tableColumn(e, -1) }, e.prototype.nextTableColumn = function (e) { return this.tableColumn(e, 1) }, e.prototype.tableColumn = function (e, t) { var r; if (e && "table" === e.type) { var n = this.audiograph.getFocusedCell(), i = void 0, o = void 0, a = void 0; -1 === t ? (i = n ? Math.max(n.location.column - 1, 0) : NaN, o = n && n.tableId === e.id && !isNaN(i) ? i : e.columnModels.length - 1, a = 0) : (i = n ? Math.min(n.location.column + 1, e.columnModels.length - 1) : NaN, o = n && n.tableId === e.id && !isNaN(i) ? i : 0, a = e.columnModels.length - 1); var s = (a - o) / t; if (isFinite(s) && s >= 0) for (var h = o; h !== a; h += t) { var p = e.columnModels[h]; if (p) if (this.grapher.getGraphSketch(p.id)) { r = { tableId: e.id, location: { column: h, row: 0 } }; break } } } return r }, e.prototype.getGraphSketchForTableCell = function (e, t) { if (e && "table" === e.type && t) { var r = e.columnModels[t.location.column]; return r ? this.grapher.getGraphSketch(r.id) : void 0 } }, e.prototype.getXScale = function () { return this.xscale }, e.prototype.getYScale = function () { return this.yscale }, e.prototype.getSelectedItem = function () { var e = this.controller.getSelectedItem(); return e && "folder" === e.type ? this.controller.getItemModel(t.getSelectedId(e)) : e }, e }(); e.default = l });
define('graphing/audiograph', ["require", "exports", "tslib", "browser", "keys", "lib/aria", "graphing/audiographnavigator", "graphing/tonegenerator", "core/types/graphmode", "core/lib/label", "core/math/poi-type", "graphing-calc/models/expression", "graphing-calc/models/table", "expressions/colors", "lib/mathspeak"], function (require, t, e, r, o, i, a, n, s, l, c, p, u, h, d) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.audioSpeedOptions = void 0, t.audioSpeedOptions = [{ speed: 200, displayedSpeed: "1/4 x" }, { speed: 100, displayedSpeed: "1/2 x" }, { speed: 50, displayedSpeed: "1 x" }, { speed: 25, displayedSpeed: "2 x" }, { speed: 12.5, displayedSpeed: "4 x" }]; var g = function () { function g(t, e) { var r = this; this.grapher = e, this.controller = t, this.audioTraceActive = !1, this.isTracing = !1, this.wasFocusInExpressionsView = !1, this.focusedCell = void 0, this.sliderTraceActive = !1, this.sliderIndex = 0, this.sliderArray = [], this.lastSpokenBranch = 1, this.agNavigator = new a.default(t, this, this.grapher), this.tonegen = new n.default({ audioPointMove: function (t, e) { r.agNavigator.drawTrace(r.agNavigator.getPoint(t, e)) }, animationFinished: function () { r.recomputePoints(), r.isTracing && (r.isTracing = !1, r.controller.dispatch({ type: "render" })) }, audioEnabled: function () { return r.controller.getAudio() } }), this.audioSpeedIndex = 2, this.tonegen.suspend() } return g.prototype.remove = function () { }, g.prototype.handleKeydown = function (t) { var e = t.altKey || t.metaKey, i = t.altKey && !t.metaKey && !t.ctrlKey && !t.shiftKey, a = t.ctrlKey && !t.metaKey && !t.altKey, n = r.IS_APPLE ? a : e, s = n && (61 === t.which || 187 === t.which), l = n && !t.shiftKey && (173 === t.which || 189 === t.which), c = n && !t.shiftKey && "0" === o.lookupChar(t); i && "S" === o.lookupChar(t) ? this.agNavigator.getSelectedItem() && (this.audioTraceActive || this.isFocusInExpressionsView()) && (t.preventDefault(), t.stopPropagation(), this.describeCurve()) : i && "T" === o.lookupChar(t) ? (t.preventDefault(), t.stopPropagation(), this.toggleAudioTrace()) : s ? (t.preventDefault(), t.stopPropagation(), this.zoom("in")) : l ? (t.preventDefault(), t.stopPropagation(), this.zoom("out")) : c ? (t.preventDefault(), t.stopPropagation(), this.zoom("default")) : this.audioTraceActive && (this.sliderTraceActive ? this.sliderTraceKeydown(t) : this.audioTraceKeydown(t)) }, g.prototype.sliderTraceKeydown = function (t) { var e = t.altKey || t.metaKey, r = !e && !t.ctrlKey && !t.shiftKey; r && o.lookup(t) === o.LEFT || "J" === o.lookupChar(t) ? (t.preventDefault(), t.stopPropagation(), this.decrementSliderValue()) : r && o.lookup(t) === o.RIGHT || "L" === o.lookupChar(t) ? (t.preventDefault(), t.stopPropagation(), this.incrementSliderValue()) : r && o.lookup(t) === o.PAGEDOWN ? (t.preventDefault(), t.stopPropagation(), this.decrementBigSliderValue()) : r && o.lookup(t) === o.PAGEUP ? (t.preventDefault(), t.stopPropagation(), this.incrementBigSliderValue()) : e || o.lookup(t) !== o.DOWN && (t.shiftKey || o.lookup(t) !== o.TAB) && "K" !== o.lookupChar(t) ? !e && (o.lookup(t) === o.UP || t.shiftKey && o.lookup(t) === o.TAB || "I" === o.lookupChar(t)) ? (t.preventDefault(), t.stopPropagation(), this.prevSlider()) : r && o.lookup(t) === o.HOME || "U" === o.lookupChar(t) ? (t.preventDefault(), t.stopPropagation(), this.sliderMin()) : r && o.lookup(t) === o.END || "N" === o.lookupChar(t) ? (t.preventDefault(), t.stopPropagation(), this.sliderMax()) : (this.stopAnimations(), this.audioTraceKeydown(t)) : (t.preventDefault(), t.stopPropagation(), this.nextSlider()) }, g.prototype.audioTraceKeydown = function (t) { var e = t.altKey || t.metaKey, r = e && !t.ctrlKey && !t.shiftKey, a = !e && !t.ctrlKey && !t.shiftKey, s = o.lookupChar(t); if (o.lookup(t) === o.UP && r) t.preventDefault(), t.stopPropagation(), i.clear(), this.agNavigator.prevCurve(); else if (o.lookup(t) === o.DOWN && r) t.preventDefault(), t.stopPropagation(), i.clear(), this.agNavigator.nextCurve(); else if (a && o.lookup(t) === o.LEFT || o.lookup(t) === o.UP || "J" === s) t.preventDefault(), t.stopPropagation(), this.controller.dispatch({ type: "keypad/audio-trace", command: "previous-point" }); else if (a && o.lookup(t) === o.RIGHT || o.lookup(t) === o.DOWN || "L" === s) t.preventDefault(), t.stopPropagation(), this.controller.dispatch({ type: "keypad/audio-trace", command: "next-point" }); else if (e || o.lookup(t) !== o.PAGEDOWN && (t.shiftKey || o.lookup(t) !== o.TAB) && "I" !== s) if (!e && (o.lookup(t) === o.PAGEUP || t.shiftKey && o.lookup(t) === o.TAB || "K" === s)) t.preventDefault(), t.stopPropagation(), this.reportAndMoveToPrevPOI(); else if (a && o.lookup(t) === o.HOME || "U" === s) t.preventDefault(), t.stopPropagation(), this.reportAndMoveToFirstPoint(); else if (a && o.lookup(t) === o.END || "N" === s) t.preventDefault(), t.stopPropagation(), this.reportAndMoveToLastPoint(); else if (a && "X" === s) t.preventDefault(), t.stopPropagation(), this.reportX(); else if (a && "P" === s) t.preventDefault(), t.stopPropagation(), this.reportPOICount(); else if (a && "Y" === s) t.preventDefault(), t.stopPropagation(), this.reportY(); else if (a && "T" === s) t.preventDefault(), t.stopPropagation(), this.reportType(); else if (a && "B" === s) t.preventDefault(), t.stopPropagation(), this.reportBranch(); else if (a && "O" === s) t.preventDefault(), t.stopPropagation(), this.reportAndMoveToOrigin(); else if (a && "H" === s) t.preventDefault(), t.stopPropagation(), this.hearGraph(); else if (a && "string" == typeof s && s >= "0" && s <= "9") { if (t.preventDefault(), t.stopPropagation(), i.clear(), !this.controller.getAudio()) return void i.alert(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")); this.tonegen.stop(); var l = this.agNavigator.getCurrentSketch(); if (l) { for (var c = void 0, p = c = 48 === t.which ? 9 : t.which - 49, u = -1, h = 0; h < l.branches.length; h++)if (n.canPlayBranch(l.branches[h]) && (p -= 1), p < 0) { u = h; break } u >= 0 ? this.tonegen.getPlaybackSupported() ? this.tonegen.playBranchByIndex(l, u, this.grapher.getCurrentViewport()) : i.alert(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")) : i.alert(this.controller.s("graphing-calculator-narration-audio-trace-branch-not-found", { branch: c + 1 })) } else i.alert(this.controller.s("graphing-calculator-narration-audio-trace-no-graph-selected")) } else e && "string" == typeof s && s >= "1" && s <= "5" ? (t.preventDefault(), t.stopPropagation(), this.controller.dispatch({ type: "set-audio-trace-speed", speed: parseInt(s, 10) - 1 })) : t.altKey || t.ctrlKey || t.metaKey || "V" !== s ? a && "A" === s ? (t.preventDefault(), t.stopPropagation(), i.clear(), this.queueAnimatingPoints(!0), i.alert()) : a && "S" === s && this.controller.isListEnabled() ? (t.preventDefault(), t.stopPropagation(), this.toggleSliderTrace()) : a && "C" === s ? (t.preventDefault(), t.stopPropagation(), this.reportColor()) : a && this.exitAudioTrace() : (t.preventDefault(), t.stopPropagation(), this.controller.getAudio() ? t.shiftKey ? this.controller.dispatch({ type: "keypad/audio-trace", command: "volume-down" }) : this.controller.dispatch({ type: "keypad/audio-trace", command: "volume-up" }) : i.alert(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play"))); else t.preventDefault(), t.stopPropagation(), this.reportAndMoveToNextPOI(); this.controller.dispatch({ type: "render" }) }, g.prototype.describeCurve = function () { var t = this; i.clear(); var e = this.agNavigator.getCurrentSketch(); if (e) { i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-color", { color: h.getColorName(this.controller, e.color) })); var r = n.getReportedBranch(e, e.branches.length - 1); r > 1 && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-branch-count", { branches: r })); for (var o = !1, a = !1, l = 0, p = e.branches; l < p.length; l++) { var u = p[l]; if (1 === r && u.segments.length > 0 && u.hasOwnProperty("operator")) { if (u.graphMode === s.Y) { if (">" === u.operator || ">=" === u.operator) { i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-above")); break } if ("<" === u.operator || "<=" === u.operator) { i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-below")); break } } else if (u.graphMode === s.X) { if (">" === u.operator || ">=" === u.operator) { i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-right")); break } if ("<" === u.operator || "<=" === u.operator) { i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-left")); break } } } else r > 1 && (u.graphMode === s.Y || u.graphMode === s.X ? "<" !== u.operator && "<=" !== u.operator && ">" !== u.operator && ">=" !== u.operator || (o = !0) : u.graphMode === s.POLYGONFILL && (a = !0)) } o && a && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-description-shading-in-regions")); var d = e.getPOI(); if (d.length > 0) { for (var g = [], y = 0, f = d; y < f.length; y++) { var v = f[y]; void 0 === g[v.type] ? g[v.type] = 1 : g[v.type] += 1 } g.forEach(function (e, r) { r === c.INTERSECTION ? i.queue(1 === e ? t.controller.s("graphing-calculator-narration-audio-trace-description-one-intersection") : t.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intersections", { count: e })) : r === c.ZERO ? i.queue(1 === e ? t.controller.s("graphing-calculator-narration-audio-trace-description-one-root") : t.controller.s("graphing-calculator-narration-audio-trace-description-multiple-roots", { count: e })) : r === c.INTERCEPT ? i.queue(1 === e ? t.controller.s("graphing-calculator-narration-audio-trace-description-one-intercept") : t.controller.s("graphing-calculator-narration-audio-trace-description-multiple-intercepts", { count: e })) : r === c.EXTREMUM ? i.queue(1 === e ? t.controller.s("graphing-calculator-narration-audio-trace-description-one-extremum") : t.controller.s("graphing-calculator-narration-audio-trace-description-multiple-extrema", { count: e })) : r === c.LABEL && i.queue(1 === e ? t.controller.s("graphing-calculator-narration-audio-trace-description-one-label") : t.controller.s("graphing-calculator-narration-audio-trace-description-multiple-labels", { count: e })) }) } i.alert() } else i.alert(this.controller.s("graphing-calculator-narration-audio-trace-description-unavailable")) }, g.prototype.queueCoordinates = function (t, e, r) { if (void 0 === r && (r = !1), t) { var o = this.agNavigator.getCurrentSketch(); (t.hasOwnProperty("branch") && o && o.branches.length > 1 && this.lastSpokenBranch !== t.reportedBranch || "branch" === e) && "number" == typeof t.reportedBranch && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-property-branch-number", { branch: t.reportedBranch })), this.lastSpokenBranch = t.reportedBranch ? t.reportedBranch : t.branch + 1, t.hasOwnProperty("type") && !e ? i.queue(this.controller.s("graphing-calculator-narration-audio-trace-property-type-before-coordinates", { type: this.describePOI(t) })) : "type" === e && i.queue(this.describePOI(t)), e && "x" !== e || i.queue(this.controller.s("graphing-calculator-narration-audio-trace-property-x", { x: l.value(t.x, this.agNavigator.getXScale()).ariaString })), e && "y" !== e || i.queue(this.controller.s("graphing-calculator-narration-audio-trace-property-y", { y: l.value(t.y, this.agNavigator.getYScale()).ariaString })), r && i.alert() } }, g.prototype.describePOI = function (t) { if (t.typeChain) { for (var e = [], r = 0; r < t.typeChain.length; r++)e.push(this.poiTypeToText(t, r)); return e.join(", ") } return this.poiTypeToText(t) }, g.prototype.poiTypeToText = function (t, e) { switch (e && t.typeChain ? t.typeChain[e] : t.type) { case c.INTERSECTION: var r = this.getIntersectingCurves(t); return "" !== r ? this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection-with-curves", { curves: r }) : this.controller.s("graphing-calculator-narration-audio-trace-point-type-intersection"); case c.ZERO: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-root"); case c.INTERCEPT: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-intercept"); case c.EXTREMUM: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-extremum"); case c.DEFINITION: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-definition"); case c.TRACE: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-trace"); case c.LABEL: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-label"); default: return this.controller.s("graphing-calculator-narration-audio-trace-point-type-not-a-poi") } }, g.prototype.getIntersectingCurves = function (t) { return t && t.intersects ? this.getExpressionAriaLabel(t.intersects) : "" }, g.prototype.getExpressionAriaLabel = function (t) { var e = this.controller.getItemModel(t); return e ? "expression" === e.type && e.label ? d.getMathspeakFromText(e.label) : this.controller.isItemSecret(e.id) ? this.controller.s("graphing-calculator-narration-audio-trace-secret-expression", { index: e.secretIndex }) : "table" === e.type && this.focusedCell ? this.controller.s("graphing-calculator-narration-audio-trace-expression-with-column", { index: e.displayIndex, column: this.focusedCell.location.column + 1 }) : this.controller.s("shared-calculator-narration-expression-index", { index: e.displayIndex }) : "" }, g.prototype.exitAudioTrace = function (t) { if (this.audioTraceActive) { if (this.audioTraceActive = !1, this.controller.isKeypadEnabled() && this.controller.dispatch({ type: "keypad/123" }), t || (t = this.controller.s("graphing-calculator-text-audio-trace-off")), this.controller.dispatch({ type: "toast/close" }), this.wasFocusInExpressionsView) { var r = this.agNavigator.getSelectedItem(); r && this.controller.isItemSelectable(r.id) || (r = this.controller.getFirstFullyVisibleItem()), r && this.controller.isItemSelectable(r.id) && this.controller.dispatch({ type: "move-focus-to-item", id: r.id, where: "table" === r.type && void 0 !== this.focusedCell ? e.__assign({ location: "cell" }, this.focusedCell.location) : "end" }) } this.wasFocusInExpressionsView = !1, this.focusedCell = void 0, this.stopAnimations(), this.sliderTraceActive = !1, this.sliderIndex = 0, this.tonegen.stop(), this.tonegen.suspend(), this.agNavigator.reset(), this.lastSpokenBranch = 1, this.grapher.traceLayer.setTraceInfo(void 0), this.grapher.redrawAllLayers(), i.alert(t), this.resumeAnimations() } }, g.prototype.isFocusInExpressionsView = function () { return !!this.controller.getFocusedItem() }, g.prototype.canAudioTraceCurrentExp = function () { var t = this.agNavigator.getSelectedItem(); return !!t && ("table" === t.type ? !!this.agNavigator.getCurrentSketch() : this.agNavigator.canTrace(t)) }, g.prototype.enterAudioTrace = function (t) { var e, o = this, a = this.agNavigator.getSelectedItem(), n = a && "table" !== a.type && !this.agNavigator.canTrace(a) ? this.getExpressionAriaLabel(a.id) : void 0, l = !1; if (this.audioTraceActive || (this.wasFocusInExpressionsView = this.isFocusInExpressionsView(), a && n && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-unsupported-expression", { expression: n })), l = !!n || !this.wasFocusInExpressionsView), l) e = this.agNavigator.getFirstTraceableSketch({ selectAssociatedExpression: !0 }); else if (!n) { if (a && "expression" === a.type && a.formula && a.formula.error) return this.exitAudioTrace(), this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-audio-trace-no-graph-to-trace") } }); if (a && "table" === a.type) { var c = u.getSelectedCell(a); this.focusedCell && this.focusedCell.tableId === a.id && (!c || c.column === this.focusedCell.location.column && c.row === this.focusedCell.location.row) || (this.focusedCell = void 0 !== c ? { tableId: a.id, location: c } : void 0) } else this.focusedCell = void 0; e = this.agNavigator.getCurrentSketch() } if (!e) return this.agNavigator.reset(), this.lastSpokenBranch = 1, this.exitAudioTrace(), this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-audio-trace-no-graph-to-trace") } }); var p = e.branches[0].graphMode; return p === s.IMPLICIT ? (this.exitAudioTrace(), this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-audio-trace-no-implicit-support") } })) : p === s.PARAMETRIC ? (this.exitAudioTrace(), this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-audio-trace-no-parametric-support") } })) : p === s.POLAR ? (this.exitAudioTrace(), this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-audio-trace-no-polar-support") } })) : (this.agNavigator.reset(), this.agNavigator.computeStepSizes(), this.lastSpokenBranch = 1, this.grapher.traceLayer.clearOpenedPOI(), this.grapher.redrawAllLayers(), this.audioTraceActive || (this.controller.isKeypadEnabled() || this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-audio-trace-on"), noAria: !0, onHide: function () { return o.exitAudioTrace() }, hideAfter: 0 } }), n && e && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-tracing-different-expression", { expression: this.getExpressionAriaLabel(e.id) })), i.queue(this.controller.s("graphing-calculator-text-audio-trace-on")), this.controller.getAudio() || i.queue(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")), this.pauseAnimations(), this.queueAnimatingPoints(!1), this.tonegen.resume(), t && t.fromKeypad || (i.queue(this.controller.s("graphing-calculator-narration-audio-trace-instructions-use-arrow-keys")), this.controller.getAudio() && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-instructions-hear-graph")), this.agNavigator.getTraceableExpressionCount() > 1 && (r.IS_APPLE ? i.queue(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-mac")) : i.queue(this.controller.s("graphing-calculator-narration-audio-trace-instructions-expression-navigation-windows"))), r.IS_APPLE ? i.queue(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-mac")) : i.queue(this.controller.s("graphing-calculator-narration-audio-trace-instructions-disable-windows"))), this.wasFocusInExpressionsView && (this.controller.find$(".dcg-graph-outer").one("focusin", function () { setTimeout(function () { i.alert() }, 0) }), this.controller.focusGraphPaper())), this.agNavigator.moveToOrigin(), i.queue(this.getExpressionAriaLabel(e.id)), this.reportAudioTrace({ playSound: !1 }), this.wasFocusInExpressionsView || i.alert(), this.audioTraceActive = !0, void (this.controller.isKeypadEnabled() && this.controller.dispatch({ type: "keypad/audio" }))) }, g.prototype.checkIfSelectedItemChanged = function (t) { this.lastSelectedId !== t && (this.lastSelectedId = t, this.audioTraceActive && (t ? (i.queue(this.getExpressionAriaLabel(t)), this.exitSliderTrace(), this.agNavigator.updatePOI(), this.agNavigator.moveToOrigin(), this.reportAudioTrace(), i.alert()) : this.exitAudioTrace())) }, g.prototype.pauseAnimations = function () { var t = this; this.sliderArray.length = 0, this.controller.getAllModelsWithSliders().forEach(function (e) { e.slider.isPlaying && (t.controller.dispatch({ type: "set-slider-isplaying", id: e.id, isPlaying: !1 }), t.sliderArray.push(e)) }) }, g.prototype.resumeAnimations = function () { if (0 !== this.sliderArray.length) { for (var t = 0; t < this.sliderArray.length; t++) { var e = this.sliderArray[t]; !0 !== e.slider.isPlaying && this.controller.dispatch({ type: "set-slider-isplaying", id: e.id, isPlaying: !0 }) } this.sliderArray.length = 0 } }, g.prototype.stopAnimations = function () { var t = this; this.controller.getAllModelsWithSliders().forEach(function (e) { e.slider.isPlaying && t.controller.dispatch({ type: "set-slider-isplaying", id: e.id, isPlaying: !1 }) }) }, g.prototype.getAnimatingVars = function () { for (var t = [], e = 0; e < this.sliderArray.length; e++)t.push('"' + p.getAssignment(this.sliderArray[e]) + '"'); return t }, g.prototype.hasActiveSliders = function () { for (var t = this.controller.getAllModelsWithSliders(), e = 0; e < t.length; e++)if (t[e].slider.isPlaying) return !0; return !1 }, g.prototype.queueAnimatingPoints = function (t) { 1 === this.sliderArray.length ? i.queue(this.controller.s("graphing-calculator-narration-audio-trace-one-slider-paused")) : this.sliderArray.length > 1 ? i.queue(this.controller.s("graphing-calculator-narration-audio-trace-multiple-sliders-paused", { sliders: this.sliderArray.length })) : t && i.queue(this.controller.s("graphing-calculator-narration-audio-trace-no-sliders-paused")) }, g.prototype.queueSliderLatex = function () { this.hasActiveSliders() || this.tonegen.stop(); var t = this.getSelectedSlider(); t ? i.queue(t.latex) : i.queue(this.controller.s("graphing-calculator-narration-audio-trace-slider-value-unknown")) }, g.prototype.getSelectedSlider = function () { var t = this.controller.getAllModelsWithSliders(); return this.sliderIndex <= t.length - 1 ? t[this.sliderIndex] : null }, g.prototype.incrementSliderValue = function () { this.adjustSlider("up") }, g.prototype.decrementSliderValue = function () { this.adjustSlider("down") }, g.prototype.incrementBigSliderValue = function () { this.adjustSlider("bigup") }, g.prototype.decrementBigSliderValue = function () { this.adjustSlider("bigdown") }, g.prototype.nextSlider = function () { this.adjustSlider("next") }, g.prototype.prevSlider = function () { this.adjustSlider("prev") }, g.prototype.sliderMin = function () { this.adjustSlider("min") }, g.prototype.sliderMax = function () { this.adjustSlider("max") }, g.prototype.adjustSlider = function (t) { var e = this.getSelectedSlider(); if (e) { var r = e.latex, o = this.controller.getAllModelsWithSliders().length; switch (t) { case "up": case "down": case "bigup": case "bigdown": case "min": case "max": this.controller.dispatch({ type: "adjust-slider-by-keyboard", id: e.id, adjustment: t }), this.queueSliderLatex(), i.alert(); break; case "next": return this.sliderIndex++, this.sliderIndex >= o && (i.queue(this.controller.s("graphing-calculator-narration-audio-trace-last-slider")), this.sliderIndex = o - 1), this.queueSliderLatex(), void i.alert(); case "prev": return this.sliderIndex--, this.sliderIndex < 0 && (i.queue(this.controller.s("graphing-calculator-narration-audio-trace-first-slider")), this.sliderIndex = 0), this.queueSliderLatex(), void i.alert() }e.slider.isPlaying || r === e.latex || (this.queueSliderLatex(), i.alert()) } else i.queue(this.controller.s("graphing-calculator-narration-audio-trace-cannot-change-slider-value")) }, g.prototype.toggleAudioTrace = function () { this.audioTraceActive ? this.exitAudioTrace() : this.enterAudioTrace() }, g.prototype.toggleSliderTrace = function () { this.sliderTraceActive ? this.exitSliderTrace() : this.enterSliderTrace() }, g.prototype.enterSliderTrace = function () { this.sliderTraceActive || (this.sliderIndex = 0, 0 !== this.controller.getAllModelsWithSliders().length ? (i.queue(this.controller.s("graphing-calculator-narration-slider-trace-on")), this.queueSliderLatex(), this.sliderTraceActive = !0) : (i.queue(this.controller.s("graphing-calculator-narration-slider-trace-no-sliders")), this.sliderTraceActive = !1), i.alert()) }, g.prototype.exitSliderTrace = function () { this.sliderTraceActive && (i.queue(this.controller.s("graphing-calculator-narration-slider-trace-off")), this.sliderTraceActive = !1, this.sliderIndex = 0, i.alert()) }, g.prototype.recomputePoints = function () { this.audioTraceActive && (this.tonegen.isAnimating() || (this.agNavigator.updatePOI(), this.agNavigator.updateSampledPoints(), this.agNavigator.updateCurrentPoint(), this.agNavigator.resetTracePoint(), this.agNavigator.computeStepSizes())) }, g.prototype.reportAndMoveToPrevPoint = function () { i.clear(), this.agNavigator.prevPoint(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportAndMoveToNextPoint = function () { i.clear(), this.agNavigator.nextPoint(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportAndMoveToOrigin = function () { i.clear(), this.agNavigator.moveToOrigin(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportAndMoveToPrevPOI = function () { i.clear(), this.agNavigator.prevPOI(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportAndMoveToNextPOI = function () { i.clear(), this.agNavigator.nextPOI(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportAndMoveToFirstPoint = function () { i.clear(), this.agNavigator.firstPoint(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportAndMoveToLastPoint = function () { i.clear(), this.agNavigator.lastPoint(), this.reportAudioTrace(), this.controller.dispatch({ type: "render" }) }, g.prototype.reportX = function () { i.clear(), this.reportAudioTrace({ propToSpeak: "x", playSound: !1 }) }, g.prototype.reportY = function () { i.clear(), this.reportAudioTrace({ propToSpeak: "y", playSound: !1 }) }, g.prototype.reportColor = function () { i.clear(); var t = this.agNavigator.getCurrentSketch(); t ? i.queue(h.getColorName(this.controller, t.color)) : i.queue(this.controller.s("graphing-calculator-narration-color-unknown")), i.alert() }, g.prototype.reportPOICount = function () { i.clear(); var t = this.agNavigator.getCurrentSketch(), e = t ? t.getPOI().length : 0; i.alert(this.controller.s("graphing-calculator-narration-audio-trace-poi-count", { x: e })) }, g.prototype.reportType = function () { i.clear(), this.reportAudioTrace({ propToSpeak: "type", playSound: !1 }) }, g.prototype.reportBranch = function () { i.clear(), this.reportAudioTrace({ propToSpeak: "branch", playSound: !1 }) }, g.prototype.describePoint = function () { i.clear(), this.reportAudioTrace({ playSound: !1 }), i.alert() }, g.prototype.playCurrentPoint = function () { var t = this.agNavigator.getCurrentPoint(); t && this.tonegen.playPoint(t, this.grapher.getCurrentViewport()) }, g.prototype.reportAudioTrace = function (t) { var e = this.agNavigator.getCurrentPoint(); if (e) { var r = t && t.propToSpeak, o = this.controller.getAudio() && this.tonegen.getPlaybackSupported() && (!t || void 0 === t.playSound || t.playSound), a = !t || void 0 === t.speakCoordinates || t.speakCoordinates; if (this.tonegen.stop(), o && this.playCurrentPoint(), a) this.queueCoordinates(e, r), setTimeout(function () { i.alert() }, r ? 0 : 100) } }, g.prototype.adjustPlaybackSpeed = function (e) { if (this.controller.getAudio()) { if (!(e < 0 || e >= t.audioSpeedOptions.length)) { this.audioSpeedIndex = e; var r = t.audioSpeedOptions[e]; return this.tonegen.setAudioSpeed(r.speed), i.alert(this.controller.s("graphing-calculator-narration-audio-trace-playback-speed", { speed: r.displayedSpeed })) } } else i.alert(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")) }, g.prototype.speedUp = function () { this.adjustPlaybackSpeed(this.audioSpeedIndex + 1) }, g.prototype.speedDown = function () { this.adjustPlaybackSpeed(this.audioSpeedIndex - 1) }, g.prototype.adjustVolume = function (t) { if (i.clear(), this.controller.getAudio()) { var e = this.tonegen.getAudioVolume(), r = "up" === t ? Math.min(100, Math.round(100 * (e + .1))) : Math.max(0, Math.round(100 * (e - .1))); this.tonegen.setAudioVolume(r / 100), this.playCurrentPoint(), i.alert(this.controller.s("graphing-calculator-narration-audio-trace-volume", { volume: r })) } else i.alert(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")) }, g.prototype.zoom = function (t) { this.grapher.viewportController.zoom(t) }, g.prototype.getFocusedCell = function () { return this.focusedCell }, g.prototype.setFocusedCell = function (t) { this.focusedCell = t }, g.prototype.getAudioTraceActive = function () { return this.audioTraceActive }, g.prototype.hearGraph = function () { if (i.clear(), this.controller.getAudio()) if (this.tonegen.getPlaybackSupported()) { this.tonegen.stop(); var t = this.agNavigator.getCurrentSketch(); t && n.canPlaySketch(t) ? (this.isTracing = !0, this.tonegen.playSketch(t, this.grapher.getCurrentViewport())) : i.alert(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-trace-this-expression")) } else i.alert(this.controller.s("graphing-calculator-narration-audio-trace-unable-to-play")); else i.alert(this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled")) }, g.prototype.stopGraph = function () { this.tonegen.getPlaybackSupported() && this.tonegen.stop() }, g.prototype.getIsTracing = function () { return this.isTracing }, g.prototype.getAudioSpeedIndex = function () { return this.audioSpeedIndex }, g }(); t.default = g });
!function (e, t) { if ("object" == typeof exports && "object" == typeof module) module.exports = t(); else if ("function" == typeof define && define.amd) define('abraham', [], t); else { var r = t(); for (var i in r) ("object" == typeof exports ? exports : e)[i] = r[i] } }(this, function () { return function (e) { var t = {}; function r(i) { if (t[i]) return t[i].exports; var n = t[i] = { i: i, l: !1, exports: {} }; return e[i].call(n.exports, n, n.exports, r), n.l = !0, n.exports } return r.m = e, r.c = t, r.i = function (e) { return e }, r.d = function (e, t, i) { r.o(e, t) || Object.defineProperty(e, t, { configurable: !1, enumerable: !0, get: i }) }, r.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return r.d(t, "a", t), t }, r.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, r.p = "", r(r.s = 26) }([function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(22); t.map = function (e, t) { var r = i.map(e, t); return e.warnings && (r.warnings = e.warnings), r } }, function (e, t) { var r, i, n = e.exports = {}; function s() { throw new Error("setTimeout has not been defined") } function a() { throw new Error("clearTimeout has not been defined") } function o(e) { if (r === setTimeout) return setTimeout(e, 0); if ((r === s || !r) && setTimeout) return r = setTimeout, setTimeout(e, 0); try { return r(e, 0) } catch (t) { try { return r.call(null, e, 0) } catch (t) { return r.call(this, e, 0) } } } !function () { try { r = "function" == typeof setTimeout ? setTimeout : s } catch (e) { r = s } try { i = "function" == typeof clearTimeout ? clearTimeout : a } catch (e) { i = a } }(); var c, l = [], u = !1, h = -1; function p() { u && c && (u = !1, c.length ? l = c.concat(l) : h = -1, l.length && f()) } function f() { if (!u) { var e = o(p); u = !0; for (var t = l.length; t;) { for (c = l, l = []; ++h < t;)c && c[h].run(); h = -1, t = l.length } c = null, u = !1, function (e) { if (i === clearTimeout) return clearTimeout(e); if ((i === a || !i) && clearTimeout) return i = clearTimeout, clearTimeout(e); try { i(e) } catch (t) { try { return i.call(null, e) } catch (t) { return i.call(this, e) } } }(e) } } function m(e, t) { this.fun = e, this.array = t } function y() { } n.nextTick = function (e) { var t = new Array(arguments.length - 1); if (arguments.length > 1) for (var r = 1; r < arguments.length; r++)t[r - 1] = arguments[r]; l.push(new m(e, t)), 1 !== l.length || u || o(f) }, m.prototype.run = function () { this.fun.apply(null, this.array) }, n.title = "browser", n.browser = !0, n.env = {}, n.argv = [], n.version = "", n.versions = {}, n.on = y, n.addListener = y, n.once = y, n.off = y, n.removeListener = y, n.removeAllListeners = y, n.emit = y, n.prependListener = y, n.prependOnceListener = y, n.listeners = function (e) { return [] }, n.binding = function (e) { throw new Error("process.binding is not supported") }, n.cwd = function () { return "/" }, n.chdir = function (e) { throw new Error("process.chdir is not supported") }, n.umask = function () { return 0 } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i, n = ["abs", "ans", "arccosh", "arccot", "arccoth", "arccsc", "arccsch", "arcsec", "arcsech", "arcsinh", "arctanh", "binomialdist", "boxplot", "cdf", "ceil", "corr", "cov", "csch", "distance", "dotplot", "erf", "floor", "gcf", "histogram", "IndependentTTest", "iTTest", "ittest", "lcm", "length", "mad", "mcd", "mcm", "mean", "median", "midpoint", "mod", "nCr", "normaldist", "nPr", "pdf", "poissondist", "polygon", "quantile", "quartile", "random", "round", "sech", "sign", "signum", "sgn", "stdDev", "stddev", "stdDevP", "stddevp", "stdev", "stdevp", "tdist", "total", "TScore", "TScore", "Tscore", "tscore", "tscore", "TTest", "ttest", "var", "variance", "varp"], s = n, a = o(n); function o(e) { var t = e.sort(function (e, t) { return t.length - e.length || t.localeCompare(e) }).join("|"); return new RegExp("(" + t + ")", "g") } t.getAutoOperator = function (e) { for (var t, r = 0, n = "", s = 0, a = e; s < a.length; s++) { var o = a[s]; if ("terminal" !== o.type || !/[A-Za-z]/.test(o.value)) break; n += o.value, r++ } return t = n.replace(i, "\\operatorname{$1}"), { modified: r > 0 && t !== n, terminalCount: r, value: t } }, t.containsValue = function (e) { return -1 !== s.indexOf(e.toLowerCase()) }, t.setOperatorNames = function (e) { if (!Array.isArray(e)) throw new Error("Operator names must be an array, got " + typeof e); for (var t = 0, r = e; t < r.length; t++) { var n = r[t]; if ("string" != typeof n) throw new Error("Operator names must be strings, found " + typeof n) } i = o(s = e) }, t.resetOperatorNames = function () { s = n, i = a } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(2), n = r(14), s = r(15), a = r(16), o = r(0), c = r(23), l = r(25); function u(e) { if (!l.isSixDotCells(e)) throw new Error("EncodingError: Expected input to be six-dot unicode braille characters.") } t.nemethToLatex = function (e, r) { return u(e), a.default(t.UnicodeBraille.toBrailleAscii(e), r) }, t.latexToNemeth = function (e, r) { return r && r.operatorNames ? i.setOperatorNames(r.operatorNames) : i.resetOperatorNames(), o.map(n.default(e), t.UnicodeBraille.coerceToSixDotCells) }, t.uebToLatex = function (e, r) { return u(e), c.default(t.UnicodeBraille.toBrailleAscii(e), r) }, t.latexToUeb = function (e, r) { return r && r.operatorNames ? i.setOperatorNames(r.operatorNames) : i.resetOperatorNames(), o.map(s.default(e), t.UnicodeBraille.coerceToSixDotCells) }, t.UnicodeBraille = { coerceToSixDotCells: l.coerceToSixDotCells, toBrailleAscii: l.toBrailleAscii, toExpandedBrailleAscii: l.toExpandedBrailleAscii }, t.version = "1.0.3" }, function (e, t) { }, function (e, t, r) { (function (e) { function r(e, t) { for (var r = 0, i = e.length - 1; i >= 0; i--) { var n = e[i]; "." === n ? e.splice(i, 1) : ".." === n ? (e.splice(i, 1), r++) : r && (e.splice(i, 1), r--) } if (t) for (; r--; r)e.unshift(".."); return e } var i = /^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/, n = function (e) { return i.exec(e).slice(1) }; function s(e, t) { if (e.filter) return e.filter(t); for (var r = [], i = 0; i < e.length; i++)t(e[i], i, e) && r.push(e[i]); return r } t.resolve = function () { for (var t = "", i = !1, n = arguments.length - 1; n >= -1 && !i; n--) { var a = n >= 0 ? arguments[n] : e.cwd(); if ("string" != typeof a) throw new TypeError("Arguments to path.resolve must be strings"); a && (t = a + "/" + t, i = "/" === a.charAt(0)) } return (i ? "/" : "") + (t = r(s(t.split("/"), function (e) { return !!e }), !i).join("/")) || "." }, t.normalize = function (e) { var i = t.isAbsolute(e), n = "/" === a(e, -1); return (e = r(s(e.split("/"), function (e) { return !!e }), !i).join("/")) || i || (e = "."), e && n && (e += "/"), (i ? "/" : "") + e }, t.isAbsolute = function (e) { return "/" === e.charAt(0) }, t.join = function () { var e = Array.prototype.slice.call(arguments, 0); return t.normalize(s(e, function (e, t) { if ("string" != typeof e) throw new TypeError("Arguments to path.join must be strings"); return e }).join("/")) }, t.relative = function (e, r) { function i(e) { for (var t = 0; t < e.length && "" === e[t]; t++); for (var r = e.length - 1; r >= 0 && "" === e[r]; r--); return t > r ? [] : e.slice(t, r - t + 1) } e = t.resolve(e).substr(1), r = t.resolve(r).substr(1); for (var n = i(e.split("/")), s = i(r.split("/")), a = Math.min(n.length, s.length), o = a, c = 0; c < a; c++)if (n[c] !== s[c]) { o = c; break } var l = []; for (c = o; c < n.length; c++)l.push(".."); return (l = l.concat(s.slice(o))).join("/") }, t.sep = "/", t.delimiter = ":", t.dirname = function (e) { var t = n(e), r = t[0], i = t[1]; return r || i ? (i && (i = i.substr(0, i.length - 1)), r + i) : "." }, t.basename = function (e, t) { var r = n(e)[2]; return t && r.substr(-1 * t.length) === t && (r = r.substr(0, r.length - t.length)), r }, t.extname = function (e) { return n(e)[3] }; var a = "b" === "ab".substr(-1) ? function (e, t, r) { return e.substr(t, r) } : function (e, t, r) { return t < 0 && (t = e.length + t), e.substr(t, r) } }).call(t, r(1)) }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (e) { if (!e.hash) throw e; return { _diagnostic: { expected: e.hash.expected, message: e.message, text: e.hash.text, token: e.hash.token }, location: e.hash.loc } } }, function (e, t, r) { "use strict"; function i(e) { return { type: "command", value: e } } function n() { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return Array.prototype.concat.apply([], e) } Object.defineProperty(t, "__esModule", { value: !0 }), t.terminal = function (e) { return { type: "terminal", value: e } }, t.command = i, t.greek = function (e) { return { type: "greek", value: e } }, t.level = function (e) { return { subscript: e._, superscript: e["^"], type: "level" } }, t.processPrimes = function (e, t) { var r = [], s = e.match(/'+/); if (null !== s) for (var a = s[0].length, o = 0; o < a; o++)r.push(i("\\prime")); return n(r, t) }, t.fraction = function (e, t) { return { type: "fraction", numerator: e, denominator: t } }, t.typeform = function (e, t) { return { name: e, type: "typeform", value: t } }, t.radical = function (e, t) { return { type: "radical", index: t, radicand: e } }, t.group = n }, function (e, t) { e.exports = function (e) { return e.webpackPolyfill || (e.deprecate = function () { }, e.paths = [], e.children || (e.children = []), Object.defineProperty(e, "loaded", { enumerable: !0, get: function () { return e.l } }), Object.defineProperty(e, "id", { enumerable: !0, get: function () { return e.i } }), e.webpackPolyfill = 1), e } }, function (e, t, r) { (function (e, i) { var n = function () { var e = function (e, t, r, i) { for (r = r || {}, i = e.length; i--; r[e[i]] = t); return r }, t = [1, 11], r = [1, 12], i = [1, 13], n = [1, 70], s = [1, 71], a = [1, 69], o = [1, 38], c = [1, 39], l = [1, 59], u = [1, 60], h = [1, 61], p = [1, 62], f = [1, 63], m = [1, 64], y = [1, 65], d = [1, 66], g = [1, 67], v = [1, 68], _ = [1, 40], k = [1, 34], b = [1, 35], E = [1, 36], O = [1, 37], A = [1, 41], x = [1, 42], I = [1, 43], S = [1, 44], L = [1, 45], P = [1, 46], C = [1, 47], $ = [1, 48], R = [1, 49], T = [1, 50], N = [1, 51], w = [1, 52], M = [1, 53], D = [1, 17], F = [1, 54], U = [1, 55], j = [1, 56], G = [1, 57], X = [1, 58], B = [5, 12, 13, 14, 18, 24, 25], K = [5, 11, 12, 13, 14, 15, 17, 18, 20, 21, 23, 24, 25, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 82], Z = [1, 75], V = [5, 11, 12, 13, 14, 15, 17, 18, 20, 21, 23, 24, 25, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 77, 78, 79, 80, 82], H = [5, 11, 12, 13, 14, 15, 17, 18, 20, 21, 23, 24, 25, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82], W = { trace: function () { }, yy: {}, symbols_: { error: 2, sentence: 3, group: 4, EOF: 5, element: 6, index_element: 7, modified_expression: 8, radical: 9, primes: 10, OPEN_MODEXP: 11, MODEXP_UNDER: 12, MODEXP_OVER: 13, CLOSE_MODEXP: 14, RADICAL_INDEX: 15, index_group: 16, OPEN_RADICAL: 17, CLOSE_RADICAL: 18, level: 19, LEVEL: 20, BASELINE: 21, frac: 22, OPEN_FRAC: 23, SLASH: 24, CLOSE_FRAC: 25, subscript_head: 26, number: 27, atom: 28, command: 29, greek: 30, letter: 31, comma: 32, period: 33, space: 34, operation: 35, comparison: 36, level_with_comparison: 37, ellipsis: 38, colon: 39, infinity: 40, integral: 41, factorial: 42, ampersand: 43, question_mark: 44, bracket: 45, ",": 46, ".": 47, "[": 48, "{": 49, "(": 50, "]": 51, "}": 52, ")": 53, LANGLE: 54, RANGLE: 55, PIPE: 56, DOUBLE_PIPE: 57, SPACE: 58, COMMAND: 59, GREEK: 60, LETTER: 61, CAPITAL_LETTER: 62, "+": 63, "-": 64, CDOT: 65, TIMES: 66, "*": 67, "/": 68, DIV: 69, PERCENT: 70, TO: 71, COMPARISON: 72, LEVEL_WITH_COMPARISON: 73, ELLIPSIS: 74, COLON: 75, NUMBER: 76, INFINITY: 77, INTEGRAL: 78, FACTORIAL: 79, "&": 80, PRIMES: 81, "?": 82, unknown: 83, UNKNOWN: 84, $accept: 0, $end: 1 }, terminals_: { 2: "error", 5: "EOF", 11: "OPEN_MODEXP", 12: "MODEXP_UNDER", 13: "MODEXP_OVER", 14: "CLOSE_MODEXP", 15: "RADICAL_INDEX", 17: "OPEN_RADICAL", 18: "CLOSE_RADICAL", 20: "LEVEL", 21: "BASELINE", 23: "OPEN_FRAC", 24: "SLASH", 25: "CLOSE_FRAC", 46: ",", 47: ".", 48: "[", 49: "{", 50: "(", 51: "]", 52: "}", 53: ")", 54: "LANGLE", 55: "RANGLE", 56: "PIPE", 57: "DOUBLE_PIPE", 58: "SPACE", 59: "COMMAND", 60: "GREEK", 61: "LETTER", 62: "CAPITAL_LETTER", 63: "+", 64: "-", 65: "CDOT", 66: "TIMES", 67: "*", 68: "/", 69: "DIV", 70: "PERCENT", 71: "TO", 72: "COMPARISON", 73: "LEVEL_WITH_COMPARISON", 74: "ELLIPSIS", 75: "COLON", 76: "NUMBER", 77: "INFINITY", 78: "INTEGRAL", 79: "FACTORIAL", 80: "&", 81: "PRIMES", 82: "?", 84: "UNKNOWN" }, productions_: [0, [3, 2], [3, 1], [4, 2], [4, 1], [6, 1], [6, 1], [6, 2], [6, 1], [8, 7], [8, 6], [8, 5], [8, 6], [8, 5], [8, 5], [8, 4], [8, 4], [8, 3], [8, 4], [8, 4], [8, 4], [8, 4], [8, 3], [8, 3], [8, 2], [9, 5], [9, 4], [9, 4], [9, 3], [9, 3], [9, 2], [19, 1], [19, 1], [22, 5], [22, 4], [22, 4], [22, 3], [16, 2], [16, 1], [7, 3], [7, 2], [7, 2], [7, 3], [7, 2], [7, 2], [7, 1], [7, 1], [7, 1], [26, 1], [26, 1], [26, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [28, 1], [32, 1], [33, 1], [45, 1], [45, 1], [45, 1], [45, 1], [45, 1], [45, 1], [45, 1], [45, 1], [45, 1], [45, 1], [34, 1], [29, 1], [30, 1], [31, 1], [31, 1], [35, 1], [35, 1], [35, 1], [35, 1], [35, 1], [35, 1], [35, 1], [35, 1], [35, 1], [36, 1], [37, 1], [38, 1], [39, 1], [27, 1], [40, 1], [41, 1], [42, 1], [43, 1], [10, 1], [44, 1], [83, 1]], performAction: function (e, t, r, i, n, s, a) { var o = s.length - 1; switch (n) { case 1: return s[o - 1]; case 2: return i.group(); case 3: case 37: case 41: case 43: case 44: this.$ = i.group(s[o - 1], s[o]); break; case 4: case 38: this.$ = i.group(s[o]); break; case 7: this.$ = i.group(s[o - 1], s[o]); break; case 9: this.$ = i.modified_expression(s[o - 5], s[o - 3], s[o - 1]); break; case 10: this.$ = i.modified_expression(s[o - 4], s[o - 2]); break; case 11: this.$ = i.modified_expression(s[o - 3], s[o - 1]); break; case 12: this.$ = i.modified_expression(s[o - 4], i.group(), s[o - 1]); break; case 13: this.$ = i.modified_expression(s[o - 3], i.group(), s[o - 1]); break; case 14: this.$ = i.modified_expression(s[o - 3], i.group(), i.group()); break; case 15: case 16: this.$ = i.modified_expression(s[o - 2], i.group()); break; case 17: this.$ = i.modified_expression(s[o - 1]); break; case 18: case 19: case 22: case 23: case 24: this.$ = i.modified_expression(i.group()); break; case 20: case 21: i.warnOrError("Multi-level modified expressions are not supported."), this.$ = i.modified_expression(i.group()); break; case 25: this.$ = i.radical(s[o - 1], s[o - 3]); break; case 26: this.$ = i.radical(s[o - 1], i.group()); break; case 27: this.$ = i.radical(i.group(), s[o - 2]); break; case 28: this.$ = i.radical(i.group(), i.group()); break; case 29: this.$ = i.radical(s[o - 1]); break; case 30: this.$ = i.radical(i.group()); break; case 31: this.$ = i.level(s[o]); break; case 32: this.$ = i.baseline(); break; case 33: this.$ = i.fraction(s[o - 3], s[o - 1]); break; case 34: this.$ = i.fraction(s[o - 2], i.group()); break; case 35: this.$ = i.fraction(i.group(), s[o - 1]); break; case 36: this.$ = i.fraction(i.group(), i.group()); break; case 39: this.$ = i.group(i.simple_subscript(s[o - 2], s[o]), s[o - 1]); break; case 40: this.$ = i.simple_subscript(s[o - 1], s[o]); break; case 42: i.warnOrError("Illegal use of Nemeth primes"), this.$ = i.group(i.simple_subscript(s[o - 2], s[o - 1]), s[o]); break; case 67: this.$ = i.terminal(","); break; case 68: this.$ = i.terminal("."); break; case 69: this.$ = i.terminal("["); break; case 70: this.$ = i.terminal("\\{"); break; case 71: this.$ = i.terminal("("); break; case 72: this.$ = i.terminal("]"); break; case 73: this.$ = i.terminal("\\}"); break; case 74: this.$ = i.terminal(")"); break; case 75: this.$ = i.terminal("\\langle "); break; case 76: this.$ = i.terminal("\\rangle "); break; case 77: this.$ = i.terminal("|"); break; case 78: this.$ = i.terminal("\\|"); break; case 79: this.$ = i.terminal(" "); break; case 80: this.$ = i.command(s[o].toLowerCase()); break; case 81: this.$ = i.terminal(i.greek(s[o])); break; case 82: this.$ = i.terminal(s[o].toLowerCase()); break; case 83: this.$ = i.terminal(s[o].toUpperCase()); break; case 84: this.$ = i.terminal("+"); break; case 85: this.$ = i.terminal("-"); break; case 86: this.$ = i.terminal("\\cdot "); break; case 87: this.$ = i.terminal("\\times "); break; case 88: this.$ = i.terminal("*"); break; case 89: this.$ = i.terminal("/"); break; case 90: this.$ = i.terminal("\\div "); break; case 91: this.$ = i.terminal("\\%"); break; case 92: this.$ = i.terminal("\\to "); break; case 93: this.$ = i.comparison(s[o].trim()); break; case 94: this.$ = i.level_with_comparison(s[o].trim()); break; case 95: this.$ = i.terminal("\\ldots "); break; case 96: this.$ = i.terminal(":"); break; case 97: this.$ = i.terminal(s[o]); break; case 98: this.$ = i.terminal("\\infty "); break; case 99: this.$ = i.terminal("\\int "); break; case 100: this.$ = i.terminal("!"); break; case 101: this.$ = i.terminal("\\&"); break; case 102: this.$ = i.primes(s[o]); break; case 103: this.$ = i.terminal("?") } }, table: [{ 3: 1, 4: 2, 5: [1, 3], 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 1: [3] }, { 5: [1, 72] }, { 1: [2, 2] }, e(B, [2, 4], { 6: 4, 7: 5, 8: 6, 9: 7, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 22: 32, 19: 33, 4: 73, 11: t, 15: r, 17: i, 20: n, 21: s, 23: a, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }), e(K, [2, 5]), e(K, [2, 6]), e(K, [2, 8], { 10: 74, 81: Z }), e(V, [2, 45], { 10: 76, 27: 77, 76: D, 81: Z }), e(K, [2, 46], { 10: 78, 81: Z }), e(K, [2, 47], { 10: 79, 81: Z }), { 4: 80, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 12: [1, 82], 13: [1, 81], 14: [1, 83], 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 7: 86, 16: 84, 17: [1, 85], 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 4: 87, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 18: [1, 88], 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, e(H, [2, 48]), e(H, [2, 49]), e(H, [2, 50]), e(H, [2, 97]), e(H, [2, 51]), e(H, [2, 52]), e(H, [2, 53]), e(H, [2, 54]), e(H, [2, 55]), e(H, [2, 56]), e(H, [2, 57]), e(H, [2, 58]), e(H, [2, 59]), e(H, [2, 60]), e(H, [2, 61]), e(H, [2, 62]), e(H, [2, 63]), e(H, [2, 64]), e(H, [2, 65]), e(H, [2, 66]), e(H, [2, 80]), e(H, [2, 81]), e(H, [2, 82]), e(H, [2, 83]), e(H, [2, 67]), e(H, [2, 68]), e(H, [2, 79]), e(H, [2, 84]), e(H, [2, 85]), e(H, [2, 86]), e(H, [2, 87]), e(H, [2, 88]), e(H, [2, 89]), e(H, [2, 90]), e(H, [2, 91]), e(H, [2, 92]), e(H, [2, 93]), e(H, [2, 94]), e(H, [2, 95]), e(H, [2, 96]), e(H, [2, 98]), e(H, [2, 99]), e(H, [2, 100]), e(H, [2, 101]), e(H, [2, 103]), e(H, [2, 69]), e(H, [2, 70]), e(H, [2, 71]), e(H, [2, 72]), e(H, [2, 73]), e(H, [2, 74]), e(H, [2, 75]), e(H, [2, 76]), e(H, [2, 77]), e(H, [2, 78]), { 4: 89, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 24: [1, 90], 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, e(H, [2, 31]), e(H, [2, 32]), { 1: [2, 1] }, e(B, [2, 3]), e(K, [2, 7]), e(K, [2, 102]), e(V, [2, 41], { 27: 91, 76: D }), e(K, [2, 40], { 10: 92, 81: Z }), e(K, [2, 43]), e(K, [2, 44]), { 12: [1, 93], 13: [1, 94], 14: [1, 95] }, { 12: [1, 96], 13: [1, 97], 14: [1, 98] }, { 12: [1, 100], 13: [1, 99], 14: [1, 101] }, e(K, [2, 24]), { 17: [1, 102] }, { 4: 103, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 18: [1, 104], 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 7: 86, 16: 105, 17: [2, 38], 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 18: [1, 106] }, e(H, [2, 30]), { 24: [1, 107] }, { 4: 108, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 25: [1, 109], 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, e(K, [2, 39]), e(K, [2, 42]), { 4: 110, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 13: [1, 111], 14: [1, 112], 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 4: 113, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 14: [1, 114], 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, e(K, [2, 17]), { 14: [1, 115] }, { 14: [1, 116] }, e(K, [2, 22]), { 14: [1, 117] }, { 14: [1, 118] }, e(K, [2, 23]), { 4: 119, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 18: [1, 120], 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 18: [1, 121] }, e(H, [2, 28]), { 17: [2, 37] }, e(H, [2, 29]), { 4: 122, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 25: [1, 123], 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, { 25: [1, 124] }, e(H, [2, 36]), { 13: [1, 125], 14: [1, 126] }, { 4: 127, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 14: [1, 128], 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, e(K, [2, 16]), { 14: [1, 129] }, e(K, [2, 15]), e(K, [2, 18]), e(K, [2, 20]), e(K, [2, 19]), e(K, [2, 21]), { 18: [1, 130] }, e(H, [2, 27]), e(H, [2, 26]), { 25: [1, 131] }, e(H, [2, 34]), e(H, [2, 35]), { 4: 132, 6: 4, 7: 5, 8: 6, 9: 7, 11: t, 14: [1, 133], 15: r, 17: i, 19: 33, 20: n, 21: s, 22: 32, 23: a, 26: 8, 27: 9, 28: 10, 29: 14, 30: 15, 31: 16, 32: 18, 33: 19, 34: 20, 35: 21, 36: 22, 37: 23, 38: 24, 39: 25, 40: 26, 41: 27, 42: 28, 43: 29, 44: 30, 45: 31, 46: o, 47: c, 48: l, 49: u, 50: h, 51: p, 52: f, 53: m, 54: y, 55: d, 56: g, 57: v, 58: _, 59: k, 60: b, 61: E, 62: O, 63: A, 64: x, 65: I, 66: S, 67: L, 68: P, 69: C, 70: $, 71: R, 72: T, 73: N, 74: w, 75: M, 76: D, 77: F, 78: U, 79: j, 80: G, 82: X }, e(K, [2, 11]), { 14: [1, 134] }, e(K, [2, 14]), e(K, [2, 13]), e(H, [2, 25]), e(H, [2, 33]), { 14: [1, 135] }, e(K, [2, 10]), e(K, [2, 12]), e(K, [2, 9])], defaultActions: { 3: [2, 2], 72: [2, 1], 105: [2, 37] }, parseError: function (e, t) { if (!t.recoverable) { var r = new Error(e); throw r.hash = t, r } this.trace(e) }, parse: function (e) { var t = this, r = [0], i = [null], n = [], s = this.table, a = "", o = 0, c = 0, l = 0, u = 2, h = 1, p = n.slice.call(arguments, 1), f = Object.create(this.lexer), m = { yy: {} }; for (var y in this.yy) Object.prototype.hasOwnProperty.call(this.yy, y) && (m.yy[y] = this.yy[y]); f.setInput(e, m.yy), m.yy.lexer = f, m.yy.parser = this, void 0 === f.yylloc && (f.yylloc = {}); var d = f.yylloc; n.push(d); var g = f.options && f.options.ranges; "function" == typeof m.yy.parseError ? this.parseError = m.yy.parseError : this.parseError = Object.getPrototypeOf(this).parseError; for (var v, _, k, b, E, O, A, x, I, S = function () { var e; return "number" != typeof (e = f.lex() || h) && (e = t.symbols_[e] || e), e }, L = {}; ;) { if (k = r[r.length - 1], this.defaultActions[k] ? b = this.defaultActions[k] : (null == v && (v = S()), b = s[k] && s[k][v]), void 0 === b || !b.length || !b[0]) { var P = ""; for (O in I = [], s[k]) this.terminals_[O] && O > u && I.push("'" + this.terminals_[O] + "'"); P = f.showPosition ? "Parse error on line " + (o + 1) + ":\n" + f.showPosition() + "\nExpecting " + I.join(", ") + ", got '" + (this.terminals_[v] || v) + "'" : "Parse error on line " + (o + 1) + ": Unexpected " + (v == h ? "end of input" : "'" + (this.terminals_[v] || v) + "'"), this.parseError(P, { text: f.match, token: this.terminals_[v] || v, line: f.yylineno, loc: d, expected: I }) } if (b[0] instanceof Array && b.length > 1) throw new Error("Parse Error: multiple actions possible at state: " + k + ", token: " + v); switch (b[0]) { case 1: r.push(v), i.push(f.yytext), n.push(f.yylloc), r.push(b[1]), v = null, _ ? (v = _, _ = null) : (c = f.yyleng, a = f.yytext, o = f.yylineno, d = f.yylloc, l > 0 && l--); break; case 2: if (A = this.productions_[b[1]][1], L.$ = i[i.length - A], L._$ = { first_line: n[n.length - (A || 1)].first_line, last_line: n[n.length - 1].last_line, first_column: n[n.length - (A || 1)].first_column, last_column: n[n.length - 1].last_column }, g && (L._$.range = [n[n.length - (A || 1)].range[0], n[n.length - 1].range[1]]), void 0 !== (E = this.performAction.apply(L, [a, c, o, m.yy, b[1], i, n].concat(p)))) return E; A && (r = r.slice(0, -1 * A * 2), i = i.slice(0, -1 * A), n = n.slice(0, -1 * A)), r.push(this.productions_[b[1]][0]), i.push(L.$), n.push(L._$), x = s[r[r.length - 2]][r[r.length - 1]], r.push(x); break; case 3: return !0 } } return !0 } }, q = { EOF: 1, parseError: function (e, t) { if (!this.yy.parser) throw new Error(e); this.yy.parser.parseError(e, t) }, setInput: function (e, t) { return this.yy = t || this.yy || {}, this._input = e, this._more = this._backtrack = this.done = !1, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = "", this.conditionStack = ["INITIAL"], this.yylloc = { first_line: 1, first_column: 0, last_line: 1, last_column: 0 }, this.options.ranges && (this.yylloc.range = [0, 0]), this.offset = 0, this }, input: function () { var e = this._input[0]; return this.yytext += e, this.yyleng++, this.offset++, this.match += e, this.matched += e, e.match(/(?:\r\n?|\n).*/g) ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = this._input.slice(1), e }, unput: function (e) { var t = e.length, r = e.split(/(?:\r\n?|\n)/g); this._input = e + this._input, this.yytext = this.yytext.substr(0, this.yytext.length - t), this.offset -= t; var i = this.match.split(/(?:\r\n?|\n)/g); this.match = this.match.substr(0, this.match.length - 1), this.matched = this.matched.substr(0, this.matched.length - 1), r.length - 1 && (this.yylineno -= r.length - 1); var n = this.yylloc.range; return this.yylloc = { first_line: this.yylloc.first_line, last_line: this.yylineno + 1, first_column: this.yylloc.first_column, last_column: r ? (r.length === i.length ? this.yylloc.first_column : 0) + i[i.length - r.length].length - r[0].length : this.yylloc.first_column - t }, this.options.ranges && (this.yylloc.range = [n[0], n[0] + this.yyleng - t]), this.yyleng = this.yytext.length, this }, more: function () { return this._more = !0, this }, reject: function () { return this.options.backtrack_lexer ? (this._backtrack = !0, this) : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, less: function (e) { this.unput(this.match.slice(e)) }, pastInput: function () { var e = this.matched.substr(0, this.matched.length - this.match.length); return (e.length > 20 ? "..." : "") + e.substr(-20).replace(/\n/g, "") }, upcomingInput: function () { var e = this.match; return e.length < 20 && (e += this._input.substr(0, 20 - e.length)), (e.substr(0, 20) + (e.length > 20 ? "..." : "")).replace(/\n/g, "") }, showPosition: function () { var e = this.pastInput(), t = new Array(e.length + 1).join("-"); return e + this.upcomingInput() + "\n" + t + "^" }, test_match: function (e, t) { var r, i, n; if (this.options.backtrack_lexer && (n = { yylineno: this.yylineno, yylloc: { first_line: this.yylloc.first_line, last_line: this.last_line, first_column: this.yylloc.first_column, last_column: this.yylloc.last_column }, yytext: this.yytext, match: this.match, matches: this.matches, matched: this.matched, yyleng: this.yyleng, offset: this.offset, _more: this._more, _input: this._input, yy: this.yy, conditionStack: this.conditionStack.slice(0), done: this.done }, this.options.ranges && (n.yylloc.range = this.yylloc.range.slice(0))), (i = e[0].match(/(?:\r\n?|\n).*/g)) && (this.yylineno += i.length), this.yylloc = { first_line: this.yylloc.last_line, last_line: this.yylineno + 1, first_column: this.yylloc.last_column, last_column: i ? i[i.length - 1].length - i[i.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + e[0].length }, this.yytext += e[0], this.match += e[0], this.matches = e, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]), this._more = !1, this._backtrack = !1, this._input = this._input.slice(e[0].length), this.matched += e[0], r = this.performAction.call(this, this.yy, this, t, this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = !1), r) return r; if (this._backtrack) { for (var s in n) this[s] = n[s]; return !1 } return !1 }, next: function () { if (this.done) return this.EOF; var e, t, r, i; this._input || (this.done = !0), this._more || (this.yytext = "", this.match = ""); for (var n = this._currentRules(), s = 0; s < n.length; s++)if ((r = this._input.match(this.rules[n[s]])) && (!t || r[0].length > t[0].length)) { if (t = r, i = s, this.options.backtrack_lexer) { if (!1 !== (e = this.test_match(r, n[s]))) return e; if (this._backtrack) { t = !1; continue } return !1 } if (!this.options.flex) break } return t ? !1 !== (e = this.test_match(t, n[i])) && e : "" === this._input ? this.EOF : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". Unrecognized text.\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, lex: function () { var e = this.next(); return e || this.lex() }, begin: function (e) { this.conditionStack.push(e) }, popState: function () { return this.conditionStack.length - 1 > 0 ? this.conditionStack.pop() : this.conditionStack[0] }, _currentRules: function () { return this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1] ? this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules : this.conditions.INITIAL.rules }, topState: function (e) { return (e = this.conditionStack.length - 1 - Math.abs(e || 0)) >= 0 ? this.conditionStack[e] : "INITIAL" }, pushState: function (e) { this.begin(e) }, stateStackSize: function () { return this.conditionStack.length }, options: {}, performAction: function (e, t, r, i) { switch (r) { case 0: return this.begin("modexp"), 11; case 1: return 21; case 2: return this.begin("modexp"), 11; case 3: return 12; case 4: return 13; case 5: return this.popState(), 14; case 6: return 63; case 7: return 64; case 8: return 65; case 9: return 66; case 10: return 67; case 11: return 68; case 12: return 69; case 13: return 54; case 14: return 48; case 15: return 49; case 16: return 50; case 17: return 55; case 18: return 51; case 19: return 52; case 20: return 53; case 21: return 57; case 22: return 56; case 23: return 75; case 24: return 70; case 25: return 71; case 26: case 27: case 28: case 29: case 30: case 31: case 32: case 33: case 34: return 73; case 35: return 72; case 36: case 37: return 73; case 38: case 39: case 40: case 41: case 42: case 43: case 44: case 45: case 46: case 47: return 72; case 48: return 74; case 49: return 20; case 50: return 47; case 51: return 21; case 52: return 81; case 53: return 60; case 54: return 15; case 55: return this.begin("radical"), 17; case 56: return this.popState(), 18; case 57: return 18; case 58: return 78; case 59: return 80; case 60: return 79; case 61: case 62: return 59; case 63: return t.yytext = this.matches[1], 76; case 64: return 23; case 65: return 24; case 66: return 25; case 67: return t.yytext = this.matches[1], 62; case 68: return 61; case 69: return 77; case 70: return 82; case 71: return 46; case 72: return 47; case 73: return 58; case 74: return 5; case 75: return 84 } }, rules: [/^(?:"(?=[^>\]]+%))/, /^(?:")/, /^(?:"(?=[^>\]]+\]|[^>\]]+%))/, /^(?:%)/, /^(?:<)/, /^(?:\])/, /^(?:[+])/, /^(?:[-])/, /^(?:[*])/, /^(?:[@][*])/, /^(?:[@][\#])/, /^(?:[_][/])/, /^(?:[.][/])/, /^(?:[.][.][(])/, /^(?:[@][(])/, /^(?:[.][(])/, /^(?:[(])/, /^(?:[.][.][)])/, /^(?:[@][)])/, /^(?:[.][)])/, /^(?:[)])/, /^(?:[\\][\\])/, /^(?:[\\])/, /^(?:[_][3])/, /^(?:[@][0])/, /^(?:[ ][$]O[ ])/, /^(?:[ ][\^;]+[.]K[ ])/, /^(?:[\^;]+[=])/, /^(?:[ ][\^;]+[/][.]K[ ])/, /^(?:[ ][\^;]+[@][:][@][:][ ])/, /^(?:[ ][\^;]+["]K[:][ ])/, /^(?:[ ][\^;]+[.]1[:][ ])/, /^(?:[ ][\^;]+["]K[ ])/, /^(?:[ ][\^;]+[.]1[ ])/, /^(?:[ ][\^;]+[/][$][L][ ])/, /^(?:[ ][.]K[ ])/, /^(?:[ ][\^;]+[/]?[$][L][ ])/, /^(?:[ ][\^;]+[$]P[ ])/, /^(?:[=])/, /^(?:[ ][/][.]K[ ])/, /^(?:[ ][@][:][@][:][ ])/, /^(?:[ ]["]K[:][ ])/, /^(?:[ ][.]1[:][ ])/, /^(?:[ ]["]K[ ])/, /^(?:[ ][.]1[ ])/, /^(?:[@][:])/, /^(?:[ ][/]?[$][L][ ])/, /^(?:[ ][$]P[ ])/, /^(?:[ ]['][']['][ ])/, /^(?:[\^;]+)/, /^(?:[.]["])/, /^(?:["])/, /^(?:[']+)/, /^(?:[.][,]?[ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/, /^(?:[.]*[<])/, /^(?:[.]*[>])/, /^(?:[.]*\])/, /^(?:[.]*\])/, /^(?:!)/, /^(?:[_]&)/, /^(?:&)/, /^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/, /^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/, /^(?:#?(\d*\.?\d+))/, /^(?:[,]*[?])/, /^(?:[,]*[/])/, /^(?:[,]*#)/, /^(?:[,]([A-Z]))/, /^(?:[A-Z])/, /^(?:[,][=])/, /^(?:[_][8])/, /^(?:[,][ ]?)/, /^(?:[.])/, /^(?:[ ])/, /^(?:$)/, /^(?:.)/], conditions: { radical: { rules: [0, 1, 2, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75], inclusive: !0 }, modexp: { rules: [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75], inclusive: !0 }, INITIAL: { rules: [2, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75], inclusive: !0 } } }; function z() { this.yy = {} } return W.lexer = q, z.prototype = W, W.Parser = z, new z }(); t.parser = n, t.Parser = n.Parser, t.parse = function () { return n.parse.apply(n, arguments) }, t.main = function (i) { i[1] || (console.log("Usage: " + i[0] + " FILE"), e.exit(1)); var n = r(4).readFileSync(r(5).normalize(i[1]), "utf8"); return t.parser.parse(n) }, void 0 !== i && r.c[r.s] === i && t.main(e.argv.slice(1)) }).call(t, r(1), r(8)(e)) }, function (e, t, r) { (function (e, i) { var n = function () { var e = function (e, t, r, i) { for (r = r || {}, i = e.length; i--; r[e[i]] = t); return r }, t = [1, 15], r = [1, 16], i = [1, 17], n = [1, 36], s = [1, 18], a = [1, 37], o = [1, 38], c = [1, 14], l = [1, 46], u = [1, 47], h = [1, 39], p = [1, 40], f = [1, 41], m = [1, 56], y = [1, 42], d = [1, 43], g = [1, 44], v = [1, 45], _ = [1, 54], k = [1, 55], b = [1, 57], E = [1, 58], O = [1, 59], A = [1, 60], x = [1, 61], I = [1, 62], S = [1, 63], L = [1, 64], P = [1, 65], C = [1, 66], $ = [1, 67], R = [1, 68], T = [1, 69], N = [1, 70], w = [1, 71], M = [1, 72], D = [1, 73], F = [1, 74], U = [1, 75], j = [1, 76], G = [1, 48], X = [1, 49], B = [1, 50], K = [1, 51], Z = [1, 52], V = [1, 77], H = [1, 53], W = [5, 14, 18, 19, 29, 52, 53, 54], q = [5, 10, 13, 14, 15, 18, 19, 29, 52, 53, 54], z = [5, 10, 13, 14, 15, 17, 18, 19, 21, 23, 24, 28, 29, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88], Q = [1, 85], Y = [1, 86], J = [1, 87], ee = [10, 13, 15, 17, 21, 23, 24, 28, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88], te = { trace: function () { }, yy: {}, symbols_: { error: 2, sentence: 3, group: 4, EOF: 5, expression_group: 6, delimited_expression: 7, level: 8, radical: 9, LEVEL: 10, basic_token: 11, bracketed_expression: 12, RADICAL_WITH_INDEX: 13, CLOSE_RADICAL: 14, RADICAL: 15, frac: 16, OPEN_FRAC: 17, OVER: 18, CLOSE_FRAC: 19, simple_frac: 20, NUMBER: 21, NUMBER_FRAC_DENOMINATOR: 22, NUMBER_FRAC_NUMERATOR_BAD: 23, NUMBER_FRAC_DENOMINATOR_BAD: 24, atom: 25, lbracket: 26, rbracket: 27, OPEN_GROUP: 28, CLOSE_GROUP: 29, command: 30, greek: 31, letter: 32, comma: 33, period: 34, colon: 35, infinity: 36, integral: 37, factorial: 38, ampersand: 39, question_mark: 40, bracket: 41, space: 42, operation: 43, comparison: 44, ellipsis: 45, primes: 46, ",": 47, ".": 48, "[": 49, "{": 50, "(": 51, "]": 52, "}": 53, ")": 54, SPACE: 55, COMMAND: 56, GREEK: 57, CAPITAL_LETTER: 58, LETTER: 59, PIPE: 60, DOUBLE_PIPE: 61, "+": 62, "-": 63, CDOT: 64, TIMES: 65, "*": 66, DIV: 67, SLASH: 68, PERCENT: 69, TO: 70, "=": 71, NEQ: 72, "<": 73, ">": 74, LEQ: 75, APPROX: 76, GEQ: 77, TILDE: 78, PARALLEL: 79, PERPENDICULAR: 80, ELLIPSIS: 81, COLON: 82, INFINITY: 83, INTEGRAL: 84, FACTORIAL: 85, "&": 86, PRIMES: 87, "?": 88, unknown: 89, UNKNOWN: 90, $accept: 0, $end: 1 }, terminals_: { 2: "error", 5: "EOF", 10: "LEVEL", 13: "RADICAL_WITH_INDEX", 14: "CLOSE_RADICAL", 15: "RADICAL", 17: "OPEN_FRAC", 18: "OVER", 19: "CLOSE_FRAC", 21: "NUMBER", 22: "NUMBER_FRAC_DENOMINATOR", 23: "NUMBER_FRAC_NUMERATOR_BAD", 24: "NUMBER_FRAC_DENOMINATOR_BAD", 28: "OPEN_GROUP", 29: "CLOSE_GROUP", 47: ",", 48: ".", 49: "[", 50: "{", 51: "(", 52: "]", 53: "}", 54: ")", 55: "SPACE", 56: "COMMAND", 57: "GREEK", 58: "CAPITAL_LETTER", 59: "LETTER", 60: "PIPE", 61: "DOUBLE_PIPE", 62: "+", 63: "-", 64: "CDOT", 65: "TIMES", 66: "*", 67: "DIV", 68: "SLASH", 69: "PERCENT", 70: "TO", 71: "=", 72: "NEQ", 73: "<", 74: ">", 75: "LEQ", 76: "APPROX", 77: "GEQ", 78: "TILDE", 79: "PARALLEL", 80: "PERPENDICULAR", 81: "ELLIPSIS", 82: "COLON", 83: "INFINITY", 84: "INTEGRAL", 85: "FACTORIAL", 86: "&", 87: "PRIMES", 88: "?", 90: "UNKNOWN" }, productions_: [0, [3, 2], [3, 1], [4, 3], [4, 2], [4, 1], [4, 2], [4, 1], [7, 1], [7, 1], [8, 2], [8, 2], [8, 2], [9, 4], [9, 3], [9, 3], [9, 2], [9, 4], [9, 3], [9, 2], [16, 5], [16, 4], [16, 4], [16, 3], [16, 2], [20, 2], [20, 1], [20, 1], [11, 1], [11, 1], [11, 1], [6, 2], [6, 2], [6, 1], [6, 1], [12, 3], [12, 2], [12, 3], [12, 2], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [25, 1], [33, 1], [34, 1], [26, 1], [26, 1], [26, 1], [27, 1], [27, 1], [27, 1], [42, 1], [30, 1], [31, 1], [32, 1], [32, 1], [41, 1], [41, 1], [43, 1], [43, 1], [43, 1], [43, 1], [43, 1], [43, 1], [43, 1], [43, 1], [43, 1], [44, 1], [44, 1], [44, 1], [44, 1], [44, 1], [44, 1], [44, 1], [44, 1], [44, 1], [44, 1], [45, 1], [35, 1], [36, 1], [37, 1], [38, 1], [39, 1], [46, 1], [40, 1], [89, 1]], performAction: function (e, t, r, i, n, s, a) { var o = s.length - 1; switch (n) { case 1: return s[o - 1]; case 2: return i.group(); case 3: case 35: this.$ = i.group(s[o - 2], s[o - 1], s[o]); break; case 4: case 6: case 31: case 32: case 36: this.$ = i.group(s[o - 1], s[o]); break; case 5: case 7: case 33: case 34: this.$ = i.group(s[o]); break; case 10: case 11: case 12: this.$ = i.basic_level(s[o - 1], i.group(s[o])); break; case 13: case 17: this.$ = i.radical(s[o - 1], i.group(s[o - 2])); break; case 14: case 15: this.$ = i.radical(i.group(), i.group(s[o - 1])); break; case 16: this.$ = i.radical(i.group(), i.group()); break; case 18: this.$ = i.radical(s[o - 1]); break; case 19: this.$ = i.radical(i.group()); break; case 20: this.$ = i.fraction(s[o - 3], s[o - 1]); break; case 21: this.$ = i.fraction(s[o - 2], i.group()); break; case 22: this.$ = i.fraction(i.group(), s[o - 1]); break; case 23: case 24: this.$ = i.fraction(i.group(), i.group()); break; case 25: this.$ = i.fraction(i.group(i.terminal(i.to_number(s[o - 1]))), i.group(i.terminal(i.to_number(s[o])))); break; case 26: this.$ = i.fraction(i.group(i.terminal(i.to_number(s[o]))), i.group()); break; case 27: this.$ = i.fraction(i.group(), i.group(i.terminal(i.to_number(s[$01])))); break; case 37: this.$ = i.group(s[o - 1]); break; case 38: this.$ = i.group(); break; case 39: this.$ = i.terminal(i.to_number(s[o])); break; case 57: this.$ = i.terminal(","); break; case 58: this.$ = i.terminal("."); break; case 59: this.$ = i.terminal("["); break; case 60: this.$ = i.terminal("\\{"); break; case 61: this.$ = i.terminal("("); break; case 62: this.$ = i.terminal("]"); break; case 63: this.$ = i.terminal("\\}"); break; case 64: this.$ = i.terminal(")"); break; case 65: this.$ = i.terminal(" "); break; case 66: this.$ = i.command("\\" + s[o].trim().toLowerCase()); break; case 67: this.$ = i.terminal(i.greek(s[o])); break; case 68: this.$ = i.terminal(s[o].toUpperCase()); break; case 69: this.$ = i.terminal(s[o].toLowerCase()); break; case 70: this.$ = i.terminal("|"); break; case 71: this.$ = i.terminal("\\|"); break; case 72: this.$ = i.terminal("+"); break; case 73: this.$ = i.terminal("-"); break; case 74: this.$ = i.terminal("\\cdot "); break; case 75: this.$ = i.terminal("\\times "); break; case 76: this.$ = i.terminal("*"); break; case 77: this.$ = i.terminal("\\div "); break; case 78: this.$ = i.terminal("/"); break; case 79: this.$ = i.terminal("\\%"); break; case 80: this.$ = i.terminal("\\to "); break; case 81: this.$ = i.terminal("="); break; case 82: this.$ = i.terminal("\\neq "); break; case 83: this.$ = i.terminal("<"); break; case 84: this.$ = i.terminal(">"); break; case 85: this.$ = i.terminal("\\leq "); break; case 86: this.$ = i.terminal("\\approx "); break; case 87: this.$ = i.terminal("\\geq "); break; case 88: this.$ = i.terminal("\\sim "); break; case 89: this.$ = i.terminal("\\parallel "); break; case 90: this.$ = i.terminal("\\perp "); break; case 91: this.$ = i.terminal("\\ldots "); break; case 92: this.$ = i.terminal(":"); break; case 93: this.$ = i.terminal("\\infty "); break; case 94: this.$ = i.terminal("\\int "); break; case 95: this.$ = i.terminal("!"); break; case 96: this.$ = i.terminal("\\&"); break; case 97: this.$ = i.primes(s[o]); break; case 98: this.$ = i.terminal("?") } }, table: [{ 3: 1, 4: 2, 5: [1, 3], 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 1: [3] }, { 5: [1, 78] }, { 1: [2, 2] }, e(W, [2, 5], { 8: 8, 9: 9, 7: 79, 10: t, 13: r, 15: i }), e(W, [2, 7], { 6: 4, 7: 5, 11: 6, 12: 7, 8: 8, 9: 9, 25: 10, 16: 11, 20: 12, 26: 13, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 4: 80, 10: t, 13: r, 15: i, 17: n, 21: s, 23: a, 24: o, 28: c, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }), e(q, [2, 33], { 11: 6, 12: 7, 25: 10, 16: 11, 20: 12, 26: 13, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 6: 81, 17: n, 21: s, 23: a, 24: o, 28: c, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }), e(q, [2, 34], { 11: 6, 12: 7, 25: 10, 16: 11, 20: 12, 26: 13, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 6: 82, 17: n, 21: s, 23: a, 24: o, 28: c, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }), e(z, [2, 8]), e(z, [2, 9]), e(z, [2, 28]), e(z, [2, 29]), e(z, [2, 30]), { 4: 83, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 27: 84, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 52: Q, 53: Y, 54: J, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 4: 88, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 29: [1, 89], 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 9: 92, 11: 90, 12: 91, 13: r, 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 11: 93, 12: 94, 14: [1, 95], 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 4: 96, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 14: [1, 97], 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, e(z, [2, 39], { 22: [1, 98] }), e(z, [2, 40]), e(z, [2, 41]), e(z, [2, 42]), e(z, [2, 43]), e(z, [2, 44]), e(z, [2, 45]), e(z, [2, 46]), e(z, [2, 47]), e(z, [2, 48]), e(z, [2, 49]), e(z, [2, 50]), e(z, [2, 51]), e(z, [2, 52]), e(z, [2, 53]), e(z, [2, 54]), e(z, [2, 55]), e(z, [2, 56]), { 4: 99, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 15: i, 16: 11, 17: n, 18: [1, 100], 19: [1, 101], 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, e(z, [2, 26]), e(z, [2, 27]), e(ee, [2, 59]), e(ee, [2, 60]), e(ee, [2, 61]), e(z, [2, 66]), e(z, [2, 67]), e(z, [2, 68]), e(z, [2, 69]), e(z, [2, 57]), e(z, [2, 58]), e(z, [2, 92]), e(z, [2, 93]), e(z, [2, 94]), e(z, [2, 95]), e(z, [2, 96]), e(z, [2, 98]), e(z, [2, 70]), e(z, [2, 71]), e(z, [2, 65]), e(z, [2, 72]), e(z, [2, 73]), e(z, [2, 74]), e(z, [2, 75]), e(z, [2, 76]), e(z, [2, 77]), e(z, [2, 78]), e(z, [2, 79]), e(z, [2, 80]), e(z, [2, 81]), e(z, [2, 82]), e(z, [2, 83]), e(z, [2, 84]), e(z, [2, 85]), e(z, [2, 86]), e(z, [2, 87]), e(z, [2, 88]), e(z, [2, 89]), e(z, [2, 90]), e(z, [2, 91]), e(z, [2, 97]), { 1: [2, 1] }, e(W, [2, 4], { 6: 4, 7: 5, 11: 6, 12: 7, 8: 8, 9: 9, 25: 10, 16: 11, 20: 12, 26: 13, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 4: 102, 10: t, 13: r, 15: i, 17: n, 21: s, 23: a, 24: o, 28: c, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }), e(W, [2, 6]), e(q, [2, 31]), e(q, [2, 32]), { 27: 103, 52: Q, 53: Y, 54: J }, e(z, [2, 36]), e(z, [2, 62]), e(z, [2, 63]), e(z, [2, 64]), { 29: [1, 104] }, e(z, [2, 38]), e(z, [2, 10]), e(z, [2, 11]), e(z, [2, 12]), { 4: 105, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 14: [1, 106], 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 4: 108, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 14: [1, 107], 15: i, 16: 11, 17: n, 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, e(z, [2, 16]), { 14: [1, 109] }, e(z, [2, 19]), e(z, [2, 25]), { 18: [1, 110] }, { 4: 111, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 15: i, 16: 11, 17: n, 19: [1, 112], 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, e(z, [2, 24]), e(W, [2, 3]), e(z, [2, 35]), e(z, [2, 37]), { 14: [1, 113] }, e(z, [2, 15]), e(z, [2, 14]), { 14: [1, 114] }, e(z, [2, 18]), { 4: 115, 6: 4, 7: 5, 8: 8, 9: 9, 10: t, 11: 6, 12: 7, 13: r, 15: i, 16: 11, 17: n, 19: [1, 116], 20: 12, 21: s, 23: a, 24: o, 25: 10, 26: 13, 28: c, 30: 19, 31: 20, 32: 21, 33: 22, 34: 23, 35: 24, 36: 25, 37: 26, 38: 27, 39: 28, 40: 29, 41: 30, 42: 31, 43: 32, 44: 33, 45: 34, 46: 35, 47: l, 48: u, 49: h, 50: p, 51: f, 55: m, 56: y, 57: d, 58: g, 59: v, 60: _, 61: k, 62: b, 63: E, 64: O, 65: A, 66: x, 67: I, 68: S, 69: L, 70: P, 71: C, 72: $, 73: R, 74: T, 75: N, 76: w, 77: M, 78: D, 79: F, 80: U, 81: j, 82: G, 83: X, 84: B, 85: K, 86: Z, 87: V, 88: H }, { 19: [1, 117] }, e(z, [2, 23]), e(z, [2, 13]), e(z, [2, 17]), { 19: [1, 118] }, e(z, [2, 21]), e(z, [2, 22]), e(z, [2, 20])], defaultActions: { 3: [2, 2], 78: [2, 1] }, parseError: function (e, t) { if (!t.recoverable) { var r = new Error(e); throw r.hash = t, r } this.trace(e) }, parse: function (e) { var t = this, r = [0], i = [null], n = [], s = this.table, a = "", o = 0, c = 0, l = 0, u = 2, h = 1, p = n.slice.call(arguments, 1), f = Object.create(this.lexer), m = { yy: {} }; for (var y in this.yy) Object.prototype.hasOwnProperty.call(this.yy, y) && (m.yy[y] = this.yy[y]); f.setInput(e, m.yy), m.yy.lexer = f, m.yy.parser = this, void 0 === f.yylloc && (f.yylloc = {}); var d = f.yylloc; n.push(d); var g = f.options && f.options.ranges; "function" == typeof m.yy.parseError ? this.parseError = m.yy.parseError : this.parseError = Object.getPrototypeOf(this).parseError; for (var v, _, k, b, E, O, A, x, I, S = function () { var e; return "number" != typeof (e = f.lex() || h) && (e = t.symbols_[e] || e), e }, L = {}; ;) { if (k = r[r.length - 1], this.defaultActions[k] ? b = this.defaultActions[k] : (null == v && (v = S()), b = s[k] && s[k][v]), void 0 === b || !b.length || !b[0]) { var P = ""; for (O in I = [], s[k]) this.terminals_[O] && O > u && I.push("'" + this.terminals_[O] + "'"); P = f.showPosition ? "Parse error on line " + (o + 1) + ":\n" + f.showPosition() + "\nExpecting " + I.join(", ") + ", got '" + (this.terminals_[v] || v) + "'" : "Parse error on line " + (o + 1) + ": Unexpected " + (v == h ? "end of input" : "'" + (this.terminals_[v] || v) + "'"), this.parseError(P, { text: f.match, token: this.terminals_[v] || v, line: f.yylineno, loc: d, expected: I }) } if (b[0] instanceof Array && b.length > 1) throw new Error("Parse Error: multiple actions possible at state: " + k + ", token: " + v); switch (b[0]) { case 1: r.push(v), i.push(f.yytext), n.push(f.yylloc), r.push(b[1]), v = null, _ ? (v = _, _ = null) : (c = f.yyleng, a = f.yytext, o = f.yylineno, d = f.yylloc, l > 0 && l--); break; case 2: if (A = this.productions_[b[1]][1], L.$ = i[i.length - A], L._$ = { first_line: n[n.length - (A || 1)].first_line, last_line: n[n.length - 1].last_line, first_column: n[n.length - (A || 1)].first_column, last_column: n[n.length - 1].last_column }, g && (L._$.range = [n[n.length - (A || 1)].range[0], n[n.length - 1].range[1]]), void 0 !== (E = this.performAction.apply(L, [a, c, o, m.yy, b[1], i, n].concat(p)))) return E; A && (r = r.slice(0, -1 * A * 2), i = i.slice(0, -1 * A), n = n.slice(0, -1 * A)), r.push(this.productions_[b[1]][0]), i.push(L.$), n.push(L._$), x = s[r[r.length - 2]][r[r.length - 1]], r.push(x); break; case 3: return !0 } } return !0 } }, re = { EOF: 1, parseError: function (e, t) { if (!this.yy.parser) throw new Error(e); this.yy.parser.parseError(e, t) }, setInput: function (e, t) { return this.yy = t || this.yy || {}, this._input = e, this._more = this._backtrack = this.done = !1, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = "", this.conditionStack = ["INITIAL"], this.yylloc = { first_line: 1, first_column: 0, last_line: 1, last_column: 0 }, this.options.ranges && (this.yylloc.range = [0, 0]), this.offset = 0, this }, input: function () { var e = this._input[0]; return this.yytext += e, this.yyleng++, this.offset++, this.match += e, this.matched += e, e.match(/(?:\r\n?|\n).*/g) ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = this._input.slice(1), e }, unput: function (e) { var t = e.length, r = e.split(/(?:\r\n?|\n)/g); this._input = e + this._input, this.yytext = this.yytext.substr(0, this.yytext.length - t), this.offset -= t; var i = this.match.split(/(?:\r\n?|\n)/g); this.match = this.match.substr(0, this.match.length - 1), this.matched = this.matched.substr(0, this.matched.length - 1), r.length - 1 && (this.yylineno -= r.length - 1); var n = this.yylloc.range; return this.yylloc = { first_line: this.yylloc.first_line, last_line: this.yylineno + 1, first_column: this.yylloc.first_column, last_column: r ? (r.length === i.length ? this.yylloc.first_column : 0) + i[i.length - r.length].length - r[0].length : this.yylloc.first_column - t }, this.options.ranges && (this.yylloc.range = [n[0], n[0] + this.yyleng - t]), this.yyleng = this.yytext.length, this }, more: function () { return this._more = !0, this }, reject: function () { return this.options.backtrack_lexer ? (this._backtrack = !0, this) : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, less: function (e) { this.unput(this.match.slice(e)) }, pastInput: function () { var e = this.matched.substr(0, this.matched.length - this.match.length); return (e.length > 20 ? "..." : "") + e.substr(-20).replace(/\n/g, "") }, upcomingInput: function () { var e = this.match; return e.length < 20 && (e += this._input.substr(0, 20 - e.length)), (e.substr(0, 20) + (e.length > 20 ? "..." : "")).replace(/\n/g, "") }, showPosition: function () { var e = this.pastInput(), t = new Array(e.length + 1).join("-"); return e + this.upcomingInput() + "\n" + t + "^" }, test_match: function (e, t) { var r, i, n; if (this.options.backtrack_lexer && (n = { yylineno: this.yylineno, yylloc: { first_line: this.yylloc.first_line, last_line: this.last_line, first_column: this.yylloc.first_column, last_column: this.yylloc.last_column }, yytext: this.yytext, match: this.match, matches: this.matches, matched: this.matched, yyleng: this.yyleng, offset: this.offset, _more: this._more, _input: this._input, yy: this.yy, conditionStack: this.conditionStack.slice(0), done: this.done }, this.options.ranges && (n.yylloc.range = this.yylloc.range.slice(0))), (i = e[0].match(/(?:\r\n?|\n).*/g)) && (this.yylineno += i.length), this.yylloc = { first_line: this.yylloc.last_line, last_line: this.yylineno + 1, first_column: this.yylloc.last_column, last_column: i ? i[i.length - 1].length - i[i.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + e[0].length }, this.yytext += e[0], this.match += e[0], this.matches = e, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]), this._more = !1, this._backtrack = !1, this._input = this._input.slice(e[0].length), this.matched += e[0], r = this.performAction.call(this, this.yy, this, t, this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = !1), r) return r; if (this._backtrack) { for (var s in n) this[s] = n[s]; return !1 } return !1 }, next: function () { if (this.done) return this.EOF; var e, t, r, i; this._input || (this.done = !0), this._more || (this.yytext = "", this.match = ""); for (var n = this._currentRules(), s = 0; s < n.length; s++)if ((r = this._input.match(this.rules[n[s]])) && (!t || r[0].length > t[0].length)) { if (t = r, i = s, this.options.backtrack_lexer) { if (!1 !== (e = this.test_match(r, n[s]))) return e; if (this._backtrack) { t = !1; continue } return !1 } if (!this.options.flex) break } return t ? !1 !== (e = this.test_match(t, n[i])) && e : "" === this._input ? this.EOF : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". Unrecognized text.\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, lex: function () { var e = this.next(); return e || this.lex() }, begin: function (e) { this.conditionStack.push(e) }, popState: function () { return this.conditionStack.length - 1 > 0 ? this.conditionStack.pop() : this.conditionStack[0] }, _currentRules: function () { return this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1] ? this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules : this.conditions.INITIAL.rules }, topState: function (e) { return (e = this.conditionStack.length - 1 - Math.abs(e || 0)) >= 0 ? this.conditionStack[e] : "INITIAL" }, pushState: function (e) { this.begin(e) }, stateStackSize: function () { return this.conditionStack.length }, options: {}, performAction: function (e, t, r, i) { switch (r) { case 0: return void this.begin("captext"); case 1: return 58; case 2: return this.popState(), 58; case 3: return 62; case 4: return 63; case 5: return 64; case 6: return 65; case 7: return 66; case 8: return 67; case 9: return 49; case 10: return 50; case 11: return 51; case 12: return 52; case 13: return 53; case 14: return 54; case 15: return 72; case 16: return 75; case 17: return 76; case 18: return 77; case 19: return 71; case 20: return 73; case 21: return 74; case 22: return 78; case 23: return 69; case 24: return 70; case 25: return 81; case 26: return 13; case 27: return 15; case 28: return 14; case 29: return 10; case 30: return 28; case 31: return 29; case 32: return 84; case 33: return 85; case 34: return 86; case 35: return 17; case 36: return 18; case 37: return 19; case 38: return 79; case 39: return 80; case 40: return 83; case 41: return t.yytext = this.matches[1], 21; case 42: return t.yytext = this.matches[1], 22; case 43: return t.yytext = this.matches[1], 24; case 44: return 68; case 45: return 47; case 46: return 48; case 47: return 87; case 48: return 61; case 49: return 60; case 50: return 82; case 51: case 52: return 56; case 53: return 57; case 54: return t.yytext = this.matches[1], 58; case 55: return 59; case 56: return; case 57: return 88; case 58: return; case 59: return 55; case 60: return 5; case 61: return 90 } }, rules: [/^(?:([,][,])(?=[A-Z]))/, /^(?:[A-Z](?=[A-Z]))/, /^(?:[A-Z])/, /^(?:["][6])/, /^(?:["][-])/, /^(?:["][4])/, /^(?:["][8])/, /^(?:["][9])/, /^(?:["][/])/, /^(?:[.][<])/, /^(?:[_][<])/, /^(?:["][<])/, /^(?:[.][>])/, /^(?:[_][>])/, /^(?:["][>])/, /^(?:["][7][@][:])/, /^(?:[_][@][<])/, /^(?:[\^][9])/, /^(?:[_][@][>])/, /^(?:["][7])/, /^(?:[@][<])/, /^(?:[@][>])/, /^(?:[@][9])/, /^(?:[.][0])/, /^(?:[:][O])/, /^(?:[4][4][4])/, /^(?:[%][9])/, /^(?:[%])/, /^(?:[\+])/, /^(?:[95]+(?=.))/, /^(?:[<])/, /^(?:[>])/, /^(?:!)/, /^(?:[6])/, /^(?:[@]&)/, /^(?:[(])/, /^(?:[.][/])/, /^(?:[)])/, /^(?:#[L])/, /^(?:#-)/, /^(?:#=)/, /^(?:#([A-J4]+))/, /^(?:[/]([A-J4]+))/, /^(?:[#][/]([A-J4]+))/, /^(?:[_]?[/])/, /^(?:[1])/, /^(?:[4])/, /^(?:[7]+)/, /^(?:[_][\\][_][\\])/, /^(?:[_][\\])/, /^(?:[3])/, /^(?:(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?)/, /^(?:(ARG|DET|EXP|IM|INF|LIM|LN|LOG|MAX|MIN|MOD|RE|SUP))/, /^(?:[,]?[.][ABGDEZ\?\:IKLMNXOPRSTUYF\&W])/, /^(?:[,]([A-Z]))/, /^(?:[A-Z])/, /^(?:[,]['])/, /^(?:[8])/, /^(?:[;])/, /^(?:[ ])/, /^(?:$)/, /^(?:.)/], conditions: { captext: { rules: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61], inclusive: !0 }, INITIAL: { rules: [0, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61], inclusive: !0 } } }; function ie() { this.yy = {} } return te.lexer = re, ie.prototype = te, te.Parser = ie, new ie }(); t.parser = n, t.Parser = n.Parser, t.parse = function () { return n.parse.apply(n, arguments) }, t.main = function (i) { i[1] || (console.log("Usage: " + i[0] + " FILE"), e.exit(1)); var n = r(4).readFileSync(r(5).normalize(i[1]), "utf8"); return t.parser.parse(n) }, void 0 !== i && r.c[r.s] === i && t.main(e.argv.slice(1)) }).call(t, r(1), r(8)(e)) }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(2), n = r(7), s = { "~": "\\ ", "\\,": "\\ ", "\\:": "\\ ", "\\;": "\\ ", "\\!": "\\ " }, a = { "\\Vert": "\\|", "\\ge": "\\geq", "\\le": "\\leq", "\\vert": "|" }, o = { "\\space": !0 }; function c(e) { for (var t = [], r = 0, i = e; r < i.length; r++) { var s = i[r]; t.push(n.terminal(s)) } return t } function l(e) { for (var t = 0, r = 0; r < Math.min(3, e.length); r++) { var i = e[r]; "terminal" === i.type && "." === i.value && t++ } return 3 === t } t.default = function e(t) { for (var r = [], u = 0; u < t.length; u++) { var h = t[u]; switch (h.type) { case "command": var p = h.value.slice(1).trim(); a.hasOwnProperty(h.value) ? r.push(n.command(a[h.value])) : i.containsValue(p) ? r.push(n.typeform("operator_name", c(p))) : o[h.value] || r.push(h); break; case "level": var f = { subscript: h.subscript && h.subscript.length > 0 ? e(h.subscript) : void 0, superscript: h.superscript && h.superscript.length > 0 ? e(h.superscript) : void 0, type: h.type }; (f.subscript || f.superscript) && r.push(f); break; case "fraction": r.push({ denominator: e(h.denominator), numerator: e(h.numerator), type: h.type }); break; case "radical": r.push({ index: h.index ? e(h.index) : void 0, radicand: e(h.radicand), type: h.type }); break; case "terminal": l(t.slice(u)) ? (r.push({ type: "command", value: "\\ldots" }), u += 2) : r.push({ type: h.type, value: s.hasOwnProperty(h.value) ? s[h.value] : h.value }); break; case "typeform": r.push(h); break; case "greek": r.push({ type: h.type, value: s.hasOwnProperty(h.value) ? s[h.value] : h.value }); break; default: throw new Error("Unexpected item:\n" + JSON.stringify({ group: t, item: h })) } } return r } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(6), n = r(13), s = r(7); n.parser.yy = s, t.default = function (e) { try { return { isError: !1, value: n.parser.parse(e) } } catch (e) { return { isError: !0, error: i.default(e) } } } }, function (e, t, r) { (function (e, i) { var n = function () { var e = function (e, t, r, i) { for (r = r || {}, i = e.length; i--; r[e[i]] = t); return r }, t = [1, 13], r = [1, 14], i = [1, 15], n = [1, 16], s = [1, 17], a = [1, 21], o = [1, 18], c = [1, 19], l = [1, 20], u = [1, 22], h = [1, 23], p = [1, 28], f = [1, 30], m = [1, 31], y = [1, 32], d = [1, 33], g = [1, 29], v = [5, 21, 27, 38], _ = [5, 19, 21, 22, 23, 24, 25, 26, 27, 28, 32, 33, 34, 35, 36, 37, 38], k = [5, 10, 12, 13, 14, 19, 21, 22, 23, 24, 25, 26, 27, 28, 32, 33, 34, 35, 36, 37, 38], b = [5, 10, 19, 21, 22, 23, 24, 25, 26, 27, 28, 32, 33, 34, 35, 36, 37, 38], E = { trace: function () { }, yy: {}, symbols_: { error: 2, sentence: 3, group: 4, EOF: 5, level: 6, expression: 7, subscript: 8, superscript: 9, _: 10, atom: 11, "^": 12, "PRIMES^": 13, PRIMES: 14, delimited_group: 15, typeform: 16, frac: 17, radical: 18, LEFT: 19, delimiter: 20, RIGHT: 21, FRAC: 22, OPERATOR_NAME: 23, MATHRM: 24, TEXT: 25, RADICAL_OPTARG: 26, CLOSE_OPTARG: 27, RADICAL: 28, curly_group: 29, greek: 30, command: 31, SYMBOL: 32, DELIMITER: 33, DELIMITER_COMMAND: 34, GREEK: 35, COMMAND: 36, "{": 37, "}": 38, $accept: 0, $end: 1 }, terminals_: { 2: "error", 5: "EOF", 10: "_", 12: "^", 13: "PRIMES^", 14: "PRIMES", 19: "LEFT", 21: "RIGHT", 22: "FRAC", 23: "OPERATOR_NAME", 24: "MATHRM", 25: "TEXT", 26: "RADICAL_OPTARG", 27: "CLOSE_OPTARG", 28: "RADICAL", 32: "SYMBOL", 33: "DELIMITER", 34: "DELIMITER_COMMAND", 35: "GREEK", 36: "COMMAND", 37: "{", 38: "}" }, productions_: [0, [3, 2], [3, 1], [4, 3], [4, 2], [4, 1], [4, 2], [4, 1], [6, 2], [6, 2], [6, 1], [6, 1], [8, 2], [9, 2], [9, 2], [9, 1], [7, 1], [7, 1], [7, 1], [7, 1], [7, 1], [15, 5], [15, 4], [17, 3], [16, 2], [16, 2], [16, 2], [18, 4], [18, 3], [18, 2], [18, 2], [11, 1], [11, 1], [11, 1], [11, 1], [11, 1], [20, 1], [20, 1], [30, 1], [31, 1], [29, 3], [29, 2]], performAction: function (e, t, r, i, n, s, a) { var o = s.length - 1; switch (n) { case 1: return s[o - 1]; case 2: return i.group(); case 3: this.$ = i.group(s[o - 2], s[o - 1], s[o]); break; case 4: case 6: this.$ = i.group(s[o - 1], s[o]); break; case 5: case 7: this.$ = i.group(s[o]); break; case 8: this.$ = i.level({ _: i.group(s[o - 1]), "^": i.group(s[o]) }); break; case 9: this.$ = i.level({ _: i.group(s[o]), "^": i.group(s[o - 1]) }); break; case 10: this.$ = i.level({ "^": i.group(s[o]) }); break; case 11: this.$ = i.level({ _: i.group(s[o]) }); break; case 12: case 13: this.$ = s[o]; break; case 14: this.$ = i.processPrimes(s[o - 1], s[o]); break; case 15: this.$ = i.processPrimes(s[o], i.group()); break; case 21: this.$ = i.group(s[o - 3], s[o - 2], s[o]); break; case 22: this.$ = i.group(s[o - 2], s[o]); break; case 23: this.$ = i.fraction(i.group(s[o - 1]), i.group(s[o])); break; case 24: this.$ = i.typeform("operator_name", i.group(s[o])); break; case 25: this.$ = i.typeform("mathrm", i.group(s[o])); break; case 26: this.$ = i.typeform("text", i.group(s[o])); break; case 27: this.$ = i.radical(s[o], i.group(s[o - 2])); break; case 28: this.$ = i.radical(i.group(s[o]), i.group()); break; case 29: case 30: this.$ = i.radical(i.group(s[o])); break; case 35: case 36: this.$ = i.terminal(s[o]); break; case 37: case 39: this.$ = i.command(s[o]); break; case 38: this.$ = i.greek(s[o]); break; case 40: this.$ = s[o - 1]; break; case 41: this.$ = i.group() } }, table: [{ 3: 1, 4: 2, 5: [1, 3], 6: 4, 7: 5, 8: 6, 9: 7, 10: t, 11: 12, 12: r, 13: i, 14: n, 15: 8, 16: 9, 17: 10, 18: 11, 19: s, 20: 25, 22: a, 23: o, 24: c, 25: l, 26: u, 28: h, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 1: [3] }, { 5: [1, 34] }, { 1: [2, 2] }, e(v, [2, 5], { 15: 8, 16: 9, 17: 10, 18: 11, 11: 12, 29: 24, 20: 25, 30: 26, 31: 27, 7: 35, 19: s, 22: a, 23: o, 24: c, 25: l, 26: u, 28: h, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }), e(v, [2, 7], { 6: 4, 7: 5, 8: 6, 9: 7, 15: 8, 16: 9, 17: 10, 18: 11, 11: 12, 29: 24, 20: 25, 30: 26, 31: 27, 4: 36, 10: t, 12: r, 13: i, 14: n, 19: s, 22: a, 23: o, 24: c, 25: l, 26: u, 28: h, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }), e(_, [2, 11], { 9: 37, 12: r, 13: i, 14: n }), e(_, [2, 10], { 8: 38, 10: t }), e(k, [2, 16]), e(k, [2, 17]), e(k, [2, 18]), e(k, [2, 19]), e(k, [2, 20]), { 11: 39, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 11: 40, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 11: 41, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, e(b, [2, 15]), { 20: 42, 33: f, 34: m }, { 11: 43, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 11: 44, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 11: 45, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 11: 46, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 4: 47, 6: 4, 7: 5, 8: 6, 9: 7, 10: t, 11: 12, 12: r, 13: i, 14: n, 15: 8, 16: 9, 17: 10, 18: 11, 19: s, 20: 25, 22: a, 23: o, 24: c, 25: l, 26: u, 27: [1, 48], 28: h, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 11: 49, 17: 50, 20: 25, 22: a, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, e(k, [2, 31]), e(k, [2, 32]), e(k, [2, 33]), e(k, [2, 34]), e(k, [2, 35]), { 4: 51, 6: 4, 7: 5, 8: 6, 9: 7, 10: t, 11: 12, 12: r, 13: i, 14: n, 15: 8, 16: 9, 17: 10, 18: 11, 19: s, 20: 25, 22: a, 23: o, 24: c, 25: l, 26: u, 28: h, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g, 38: [1, 52] }, e(k, [2, 36]), e(k, [2, 37]), e(k, [2, 38]), e(k, [2, 39]), { 1: [2, 1] }, e(v, [2, 4], { 6: 4, 7: 5, 8: 6, 9: 7, 15: 8, 16: 9, 17: 10, 18: 11, 11: 12, 29: 24, 20: 25, 30: 26, 31: 27, 4: 53, 10: t, 12: r, 13: i, 14: n, 19: s, 22: a, 23: o, 24: c, 25: l, 26: u, 28: h, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }), e(v, [2, 6]), e(_, [2, 8]), e(_, [2, 9]), e([5, 12, 13, 14, 19, 21, 22, 23, 24, 25, 26, 27, 28, 32, 33, 34, 35, 36, 37, 38], [2, 12]), e(b, [2, 13]), e(b, [2, 14]), { 4: 54, 6: 4, 7: 5, 8: 6, 9: 7, 10: t, 11: 12, 12: r, 13: i, 14: n, 15: 8, 16: 9, 17: 10, 18: 11, 19: s, 20: 25, 21: [1, 55], 22: a, 23: o, 24: c, 25: l, 26: u, 28: h, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, e(k, [2, 24]), e(k, [2, 25]), e(k, [2, 26]), { 11: 56, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, { 27: [1, 57] }, { 11: 58, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, e(k, [2, 29]), e(k, [2, 30]), { 38: [1, 59] }, e(k, [2, 41]), e(v, [2, 3]), { 21: [1, 60] }, { 20: 61, 33: f, 34: m }, e(k, [2, 23]), { 11: 62, 20: 25, 29: 24, 30: 26, 31: 27, 32: p, 33: f, 34: m, 35: y, 36: d, 37: g }, e(k, [2, 28]), e(k, [2, 40]), { 20: 63, 33: f, 34: m }, e(k, [2, 22]), e(k, [2, 27]), e(k, [2, 21])], defaultActions: { 3: [2, 2], 34: [2, 1] }, parseError: function (e, t) { if (!t.recoverable) { var r = new Error(e); throw r.hash = t, r } this.trace(e) }, parse: function (e) { var t = this, r = [0], i = [null], n = [], s = this.table, a = "", o = 0, c = 0, l = 0, u = 2, h = 1, p = n.slice.call(arguments, 1), f = Object.create(this.lexer), m = { yy: {} }; for (var y in this.yy) Object.prototype.hasOwnProperty.call(this.yy, y) && (m.yy[y] = this.yy[y]); f.setInput(e, m.yy), m.yy.lexer = f, m.yy.parser = this, void 0 === f.yylloc && (f.yylloc = {}); var d = f.yylloc; n.push(d); var g = f.options && f.options.ranges; "function" == typeof m.yy.parseError ? this.parseError = m.yy.parseError : this.parseError = Object.getPrototypeOf(this).parseError; for (var v, _, k, b, E, O, A, x, I, S = function () { var e; return "number" != typeof (e = f.lex() || h) && (e = t.symbols_[e] || e), e }, L = {}; ;) { if (k = r[r.length - 1], this.defaultActions[k] ? b = this.defaultActions[k] : (null == v && (v = S()), b = s[k] && s[k][v]), void 0 === b || !b.length || !b[0]) { var P = ""; for (O in I = [], s[k]) this.terminals_[O] && O > u && I.push("'" + this.terminals_[O] + "'"); P = f.showPosition ? "Parse error on line " + (o + 1) + ":\n" + f.showPosition() + "\nExpecting " + I.join(", ") + ", got '" + (this.terminals_[v] || v) + "'" : "Parse error on line " + (o + 1) + ": Unexpected " + (v == h ? "end of input" : "'" + (this.terminals_[v] || v) + "'"), this.parseError(P, { text: f.match, token: this.terminals_[v] || v, line: f.yylineno, loc: d, expected: I }) } if (b[0] instanceof Array && b.length > 1) throw new Error("Parse Error: multiple actions possible at state: " + k + ", token: " + v); switch (b[0]) { case 1: r.push(v), i.push(f.yytext), n.push(f.yylloc), r.push(b[1]), v = null, _ ? (v = _, _ = null) : (c = f.yyleng, a = f.yytext, o = f.yylineno, d = f.yylloc, l > 0 && l--); break; case 2: if (A = this.productions_[b[1]][1], L.$ = i[i.length - A], L._$ = { first_line: n[n.length - (A || 1)].first_line, last_line: n[n.length - 1].last_line, first_column: n[n.length - (A || 1)].first_column, last_column: n[n.length - 1].last_column }, g && (L._$.range = [n[n.length - (A || 1)].range[0], n[n.length - 1].range[1]]), void 0 !== (E = this.performAction.apply(L, [a, c, o, m.yy, b[1], i, n].concat(p)))) return E; A && (r = r.slice(0, -1 * A * 2), i = i.slice(0, -1 * A), n = n.slice(0, -1 * A)), r.push(this.productions_[b[1]][0]), i.push(L.$), n.push(L._$), x = s[r[r.length - 2]][r[r.length - 1]], r.push(x); break; case 3: return !0 } } return !0 } }, O = { EOF: 1, parseError: function (e, t) { if (!this.yy.parser) throw new Error(e); this.yy.parser.parseError(e, t) }, setInput: function (e, t) { return this.yy = t || this.yy || {}, this._input = e, this._more = this._backtrack = this.done = !1, this.yylineno = this.yyleng = 0, this.yytext = this.matched = this.match = "", this.conditionStack = ["INITIAL"], this.yylloc = { first_line: 1, first_column: 0, last_line: 1, last_column: 0 }, this.options.ranges && (this.yylloc.range = [0, 0]), this.offset = 0, this }, input: function () { var e = this._input[0]; return this.yytext += e, this.yyleng++, this.offset++, this.match += e, this.matched += e, e.match(/(?:\r\n?|\n).*/g) ? (this.yylineno++, this.yylloc.last_line++) : this.yylloc.last_column++, this.options.ranges && this.yylloc.range[1]++, this._input = this._input.slice(1), e }, unput: function (e) { var t = e.length, r = e.split(/(?:\r\n?|\n)/g); this._input = e + this._input, this.yytext = this.yytext.substr(0, this.yytext.length - t), this.offset -= t; var i = this.match.split(/(?:\r\n?|\n)/g); this.match = this.match.substr(0, this.match.length - 1), this.matched = this.matched.substr(0, this.matched.length - 1), r.length - 1 && (this.yylineno -= r.length - 1); var n = this.yylloc.range; return this.yylloc = { first_line: this.yylloc.first_line, last_line: this.yylineno + 1, first_column: this.yylloc.first_column, last_column: r ? (r.length === i.length ? this.yylloc.first_column : 0) + i[i.length - r.length].length - r[0].length : this.yylloc.first_column - t }, this.options.ranges && (this.yylloc.range = [n[0], n[0] + this.yyleng - t]), this.yyleng = this.yytext.length, this }, more: function () { return this._more = !0, this }, reject: function () { return this.options.backtrack_lexer ? (this._backtrack = !0, this) : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, less: function (e) { this.unput(this.match.slice(e)) }, pastInput: function () { var e = this.matched.substr(0, this.matched.length - this.match.length); return (e.length > 20 ? "..." : "") + e.substr(-20).replace(/\n/g, "") }, upcomingInput: function () { var e = this.match; return e.length < 20 && (e += this._input.substr(0, 20 - e.length)), (e.substr(0, 20) + (e.length > 20 ? "..." : "")).replace(/\n/g, "") }, showPosition: function () { var e = this.pastInput(), t = new Array(e.length + 1).join("-"); return e + this.upcomingInput() + "\n" + t + "^" }, test_match: function (e, t) { var r, i, n; if (this.options.backtrack_lexer && (n = { yylineno: this.yylineno, yylloc: { first_line: this.yylloc.first_line, last_line: this.last_line, first_column: this.yylloc.first_column, last_column: this.yylloc.last_column }, yytext: this.yytext, match: this.match, matches: this.matches, matched: this.matched, yyleng: this.yyleng, offset: this.offset, _more: this._more, _input: this._input, yy: this.yy, conditionStack: this.conditionStack.slice(0), done: this.done }, this.options.ranges && (n.yylloc.range = this.yylloc.range.slice(0))), (i = e[0].match(/(?:\r\n?|\n).*/g)) && (this.yylineno += i.length), this.yylloc = { first_line: this.yylloc.last_line, last_line: this.yylineno + 1, first_column: this.yylloc.last_column, last_column: i ? i[i.length - 1].length - i[i.length - 1].match(/\r?\n?/)[0].length : this.yylloc.last_column + e[0].length }, this.yytext += e[0], this.match += e[0], this.matches = e, this.yyleng = this.yytext.length, this.options.ranges && (this.yylloc.range = [this.offset, this.offset += this.yyleng]), this._more = !1, this._backtrack = !1, this._input = this._input.slice(e[0].length), this.matched += e[0], r = this.performAction.call(this, this.yy, this, t, this.conditionStack[this.conditionStack.length - 1]), this.done && this._input && (this.done = !1), r) return r; if (this._backtrack) { for (var s in n) this[s] = n[s]; return !1 } return !1 }, next: function () { if (this.done) return this.EOF; var e, t, r, i; this._input || (this.done = !0), this._more || (this.yytext = "", this.match = ""); for (var n = this._currentRules(), s = 0; s < n.length; s++)if ((r = this._input.match(this.rules[n[s]])) && (!t || r[0].length > t[0].length)) { if (t = r, i = s, this.options.backtrack_lexer) { if (!1 !== (e = this.test_match(r, n[s]))) return e; if (this._backtrack) { t = !1; continue } return !1 } if (!this.options.flex) break } return t ? !1 !== (e = this.test_match(t, n[i])) && e : "" === this._input ? this.EOF : this.parseError("Lexical error on line " + (this.yylineno + 1) + ". Unrecognized text.\n" + this.showPosition(), { text: "", token: null, line: this.yylineno }) }, lex: function () { var e = this.next(); return e || this.lex() }, begin: function (e) { this.conditionStack.push(e) }, popState: function () { return this.conditionStack.length - 1 > 0 ? this.conditionStack.pop() : this.conditionStack[0] }, _currentRules: function () { return this.conditionStack.length && this.conditionStack[this.conditionStack.length - 1] ? this.conditions[this.conditionStack[this.conditionStack.length - 1]].rules : this.conditions.INITIAL.rules }, topState: function (e) { return (e = this.conditionStack.length - 1 - Math.abs(e || 0)) >= 0 ? this.conditionStack[e] : "INITIAL" }, pushState: function (e) { this.begin(e) }, stateStackSize: function () { return this.conditionStack.length }, options: {}, performAction: function (e, t, r, i) { switch (r) { case 0: break; case 1: return this.begin("optarg"), 26; case 2: return this.popState(), 27; case 3: return 23; case 4: return 24; case 5: return 25; case 6: return 28; case 7: return 22; case 8: return 13; case 9: return 14; case 10: return 12; case 11: return 10; case 12: return 19; case 13: return 21; case 14: return 34; case 15: return 33; case 16: return 37; case 17: return 38; case 18: case 19: case 20: return 32; case 21: case 22: return 35; case 23: return 36; case 24: return 32; case 25: return 5 } }, rules: [/^(?:\s+)/, /^(?:(\\sqrt)\s*\[)/, /^(?:\])/, /^(?:(\\operatorname))/, /^(?:(\\mathrm))/, /^(?:(\\text))/, /^(?:(\\sqrt))/, /^(?:(\\frac))/, /^(?:'+\^)/, /^(?:'+)/, /^(?:\^)/, /^(?:[_])/, /^(?:(\\left))/, /^(?:(\\right))/, /^(?:(\\langle|\\rangle|\\vert|\\Vert))/, /^(?:\[|\]|\\\{|\\\}|\(|\)|\||\\\|)/, /^(?:\{)/, /^(?:\})/, /^(?:\\(infty))/, /^(?:\\(int))/, /^(?:!)/, /^(?:\\(alpha|beta|gamma|delta|epsilon|zeta|eta|theta|iota|kappa|lambda|mu|nu|omicron|pi|rho|sigma|tau|xi|upsilon|phi|chi|psi|omega))/, /^(?:\\(Alpha|Beta|Gamma|Delta|Epsilon|Zeta|Eta|Theta|Iota|Kappa|Lambda|Mu|Nu|Omicron|Pi|Rho|Sigma|Tau|Xi|Upsilon|Phi|Chi|Psi|Omega))/, /^(?:\\[A-Za-z]+)/, /^(?:\\.|.)/, /^(?:$)/], conditions: { optarg: { rules: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], inclusive: !0 }, INITIAL: { rules: [0, 1, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25], inclusive: !0 } } }; function A() { this.yy = {} } return E.lexer = O, A.prototype = E, E.Parser = A, new A }(); t.parser = n, t.Parser = n.Parser, t.parse = function () { return n.parse.apply(n, arguments) }, t.main = function (i) { i[1] || (console.log("Usage: " + i[0] + " FILE"), e.exit(1)); var n = r(4).readFileSync(r(5).normalize(i[1]), "utf8"); return t.parser.parse(n) }, void 0 !== i && r.c[r.s] === i && t.main(e.argv.slice(1)) }).call(t, r(1), r(8)(e)) }, function (e, t, r) { "use strict"; var i = this && this.__assign || function () { return (i = Object.assign || function (e) { for (var t, r = 1, i = arguments.length; r < i; r++)for (var n in t = arguments[r]) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e }).apply(this, arguments) }; Object.defineProperty(t, "__esModule", { value: !0 }); var n = r(11), s = r(12), a = r(0); t.default = function (e) { return a.map(s.default(e), function (e) { return function (e) { return y({ isStartOfLine: !0, levelIndicator: "", radicalLevel: 0, wasFraction: !1, wasModifiedExpression: !1, wasRomanCommand: !1 }, e).value }(n.default(e)) }) }; var o = { "!": "&", "*": "@#", ",": ", ", "/": "_/", ":": "_3", "<": ' "K ', "=": " .K ", ">": " .1 ", "?": "_8", "[": "@(", "\\ ": " ", "\\%": "@0", "\\&": "_&", "\\,": " ", "\\infty": ",=", "\\int": "!", "\\{": ".(", "\\|": "\\\\", "\\}": ".)", "]": "@)", "|": "\\" }; function c(e) { return /^[a-z]$/.test(e.value) ? e.value.toUpperCase() : /^[A-Z]$/.test(e.value) ? "," + e.value : /^[0-9.]$/.test(e.value) || /^[+\-()]$/.test(e.value) ? e.value : o.hasOwnProperty(e.value) ? o[e.value] : "[terminal: " + e.value + "]" } var l = { "\\Vert": "\\\\", "\\cdot": "*", "\\div": "./", "\\ge": " .1: ", "\\geq": " .1: ", "\\langle": "..(", "\\ldots": " ''' ", "\\le": ' "K: ', "\\leq": ' "K: ', "\\ne": " /.K ", "\\neq": " /.K ", "\\approx": " @:@: ", "\\nparallel": " /$L ", "\\parallel": " $L ", "\\perp": " $P ", "\\prime": "'", "\\prod": ".,P", "\\rangle": "..)", "\\sim": "@:", "\\sum": ".,S", "\\times": "@*", "\\to": " $O ", "\\vert": "\\" }, u = { "\\Alpha": ".,A", "\\Beta": ".,B", "\\Chi": ".,&", "\\Delta": ".,D", "\\Epsilon": ".,E", "\\Eta": ".,:", "\\Gamma": ".,G", "\\Iota": ".,I", "\\Kappa": ".,K", "\\Lambda": ".,L", "\\Mu": ".,M", "\\Nu": ".,N", "\\Omega": ".,W", "\\Omicron": ".,O", "\\Phi": ".,F", "\\Pi": ".,P", "\\Psi": ".,Y", "\\Rho": ".,R", "\\Sigma": ".,S", "\\Tau": ".,T", "\\Theta": ".,?", "\\Upsilon": ".,U", "\\Xi": ".,X", "\\Zeta": ".,Z", "\\alpha": ".A", "\\beta": ".B", "\\chi": ".&", "\\delta": ".D", "\\epsilon": ".E", "\\eta": ".:", "\\gamma": ".G", "\\iota": ".I", "\\kappa": ".K", "\\lambda": ".L", "\\mu": ".M", "\\nu": ".N", "\\omega": ".W", "\\omicron": ".O", "\\phi": ".F", "\\pi": ".P", "\\psi": ".Y", "\\rho": ".R", "\\sigma": ".S", "\\tau": ".T", "\\theta": ".?", "\\upsilon": ".U", "\\xi": ".X", "\\zeta": ".Z" }; function h(e) { return l.hasOwnProperty(e.value) ? l[e.value] : e.value.slice(1).toUpperCase() + " " } function p(e, t) { return e.isStartOfLine && /^-?$/.test(t) || /\s-?$/.test(t) || e.wasFraction } function f(e) { return "\\sum" === e.value || "\\prod" === e.value } function m(e, t) { if (t >= e.length) return !1; var r = e[t]; if ("terminal" === r.type) { if (/^[0-9]$/.test(r.value)) return !0; if ("." !== r.value) return !1; if (t + 1 >= e.length) return !1; if ("terminal" === (r = e[t + 1]).type) return /^[0-9]$/.test(r.value) } return !1 } function y(e, t) { for (var r, i = "", n = e.levelIndicator, s = 0, a = !1, o = 0; o < t.length; o++) { m(t, o) && ("" === n && /[A-Z]$/.test(i) ? i += _(n) : p(e, i) && (i += "#")); var l = t[o], E = o < t.length - 1 ? t[o + 1] : null; switch ("level" !== l.type && n !== e.levelIndicator && (b(l) ? n = "" : (e.wasModifiedExpression && "" === e.levelIndicator ? e = k(e, { wasModifiedExpression: !1 }) : i += _(e.levelIndicator), n = e.levelIndicator)), l.type) { case "terminal": !e.wasModifiedExpression && "" !== n && b(l) ? i += " " + _(n) + c(l).trim() + " " : i += c(l), "." === l.value && E && ("terminal" === E.type && /^[^_\d,]/.test(c(E)) || "greek" === E.type) && (i += '"'), e = k(e, { wasFraction: !1, wasRomanCommand: !1 }); break; case "command": if ("\\space" !== l.value) { var O = f(l); O && (i += '"'), !O && "" !== n && b(l) ? i += " " + _(n) + h(l).trim() + " " : i += h(l), e = k(e, { wasFraction: !1, wasModifiedExpression: O, wasRomanCommand: !0 }) } break; case "greek": i += (r = l, u.hasOwnProperty(r.value) ? u[r.value] : r.value.slice(1).toUpperCase() + " "), e = k(e, { wasFraction: !1 }); break; case "fraction": var A = d(e, l); i += A.value, s = Math.max(s, A.fractionLevel), e = k(e, { wasFraction: !0, wasRomanCommand: !1 }); break; case "radical": var x = g(e, l); i += x.value, s = Math.max(s, x.fractionLevel), e = k(e, { wasFraction: !1, wasRomanCommand: !1 }); break; case "level": !e.wasModifiedExpression && e.wasRomanCommand ? (a = /\s$/.test(i)) && (i = i.replace(/\s$/, "")) : a = !1; var I = v(e, i.length > 0 && !0 === /[A-Za-z]/.test(i[i.length - 1]), a, l); i += I.value, n = I.levelIndicator, e = k(e, { wasFraction: !1, wasRomanCommand: !1 }); break; case "typeform": i += y(e, l.value).value, "operator_name" === l.name && (i += " "), e = k(e, { wasFraction: !1, wasModifiedExpression: !1, wasRomanCommand: !1 }) } } return { fractionLevel: s, levelIndicator: n, value: i } } function d(e, t) { for (var r = y(e = k(e, { isStartOfLine: !1 }), t.numerator), i = y(e, t.denominator), n = Math.max(r.fractionLevel, i.fractionLevel), s = "", a = 0; a < n; a++)s += ","; var o = s + "?" + r.value; return r.levelIndicator !== e.levelIndicator && (o += _(e.levelIndicator)), /\.$/.test(r.value) && (o += '"'), o += s + "/" + i.value, i.levelIndicator !== e.levelIndicator && (o += _(e.levelIndicator)), /\.$/.test(i.value) && (o += '"'), { fractionLevel: n + 1, value: o += s + "#" } } function g(e, t) { for (var r = e.radicalLevel, i = "", n = "", s = 0; s < r; s++)n += "."; if (t.index) { i += n + "<"; var a = y(k(e, { isStartOfLine: !1 }), t.index); i += a.value, /\.$/.test(a.value) && (i += '"'), a.levelIndicator !== e.levelIndicator && (i += _(e.levelIndicator)), i += ">" } else i += n + ">"; var o = y(k(e, { isStartOfLine: !1, radicalLevel: r + 1 }), t.radicand); return i += o.value, /\.$/.test(o.value) && (i += '"'), o.levelIndicator !== e.levelIndicator && (i += _(e.levelIndicator)), i += n + "]", { fractionLevel: o.fractionLevel, value: i } } function v(e, t, r, i) { var n = e.levelIndicator, s = "", a = function (e) { var t = ""; if (e) for (var r = 0, i = e; r < i.length; r++) { var n = i[r]; if ("command" !== n.type || "\\prime" !== n.value) break; t += "'" } return t }(i.superscript); if (s += a, i.subscript) { e.wasModifiedExpression && (s += "%"); var o = y(k(e, { isStartOfLine: !1, levelIndicator: n = e.levelIndicator + ";" }), i.subscript); t && /^[0-9]*(\.|\,)?[0-9]+$/.test(o.value) && n.length <= 1 ? n = e.levelIndicator : !e.wasModifiedExpression && i.subscript[0] && "level" !== i.subscript[0].type && (s += _(n)), s += o.value, /\.$/.test(o.value) && (s += '"') } if (i.superscript) { e.wasModifiedExpression && (s += "<"); var c = y(k(e, { isStartOfLine: !1, levelIndicator: n = e.levelIndicator + "^" }), i.superscript.slice(a.length)); !e.wasModifiedExpression && i.superscript[0] && "level" !== i.superscript[0].type && "" !== c.value && (s += _(n)), s += c.value, /\.$/.test(c.value) && (s += '"') } return e.wasModifiedExpression ? s += "]" : e.wasRomanCommand && r && (s += " ", n = n.slice(0, n.length - 1)), { levelIndicator: n, value: s } } function _(e) { return e || '"' } function k(e, t) { return i(i({}, e), t) } function b(e) { return ("terminal" === e.type || "command" === e.type) && /^<|>|\=|\\leq?|\\geq?|\\neq?$/.test(e.value) } }, function (e, t, r) { "use strict"; var i = this && this.__assign || function () { return (i = Object.assign || function (e) { for (var t, r = 1, i = arguments.length; r < i; r++)for (var n in t = arguments[r]) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e }).apply(this, arguments) }; Object.defineProperty(t, "__esModule", { value: !0 }); var n = r(7), s = r(11), a = r(12), o = r(0); t.default = function (e) { return o.map(a.default(e), function (e) { return function (e) { return m({ capsLock: !1, wasNumber: !1 }, e).value }(s.default(e)) }) }; var c = { "!": "6", "(": '"<', ")": '">', "*": '"9', "+": '"6', ",": "1", "-": '"-', ".": "4", "/": "_/", ":": "3", "<": "@<", "=": '"7', ">": "@>", "?": "8", "[": ".<", "\\ ": " ", "\\%": ".0", "\\&": "@&", "\\,": " ", "\\infty": "#=", "\\int": "!", "\\{": "_<", "\\|": "_\\_\\", "\\}": "_>", "]": ".>", "|": "_\\" }; function l(e, t, r) { var i = "", n = t.value, s = r && "terminal" === r.type ? r.value : ""; return y(n, e) && (i += ";"), /^[\D]/.test(n) && (e = E(e, { wasNumber: !1 })), /^[a-z]$/.test(n) ? e.capsLock ? (e = E(e, { capsLock: !1 }), i += ",'" + n.toUpperCase()) : i += n.toUpperCase() : /^[A-Z]$/.test(n) ? e.capsLock ? i += n : /[A-Z]/.test(s) ? (e = E(e, { capsLock: !0 }), i += ",," + n) : i += "," + n : (e = E(e, { capsLock: !1 }), /^[0-9.]$/.test(n) ? i += function (e) { for (var t = "", r = "A".charCodeAt(0) - 1, i = 0, n = e; i < n.length; i++) { var s = n[i]; t += "," === s ? "1" : "." === s ? "4" : "0" === s ? "J" : String.fromCharCode(r + Number(s)) } return t }(n) : c.hasOwnProperty(n) ? i += c[n] : i += "[terminal: " + n + "]"), { value: i, ctx: e } } var u = { "\\Vert": "_\\_\\", "\\cdot": '"4', "\\div": '"/', "\\ge": "_@>", "\\geq": "_@>", "\\langle": "@<", "\\ldots": "444", "\\le": "_@<", "\\leq": "_@<", "\\ne": '"7@:', "\\neq": '"7@:', "\\approx": "^9", "\\parallel": "#L", "\\perp": "#-", "\\prime": "7", "\\prod": ",.P", "\\rangle": "@>", "\\sim": "@9", "\\sum": ",.S", "\\times": '"8', "\\to": ":O", "\\vert": "_\\" }, h = { "\\Alpha": ",.A", "\\Beta": ",.B", "\\Chi": ",.&", "\\Delta": ",.D", "\\Epsilon": ",.E", "\\Eta": ",.:", "\\Gamma": ",.G", "\\Iota": ",.I", "\\Kappa": ",.K", "\\Lambda": ",.L", "\\Mu": ",.M", "\\Nu": ",.N", "\\Omega": ",.W", "\\Omicron": ",.O", "\\Phi": ",.F", "\\Pi": ",.P", "\\Psi": ",.Y", "\\Rho": ",.R", "\\Sigma": ",.S", "\\Tau": ",.T", "\\Theta": ",.?", "\\Upsilon": ",.U", "\\Xi": ",.X", "\\Zeta": ",.Z", "\\alpha": ".A", "\\beta": ".B", "\\chi": ".&", "\\delta": ".D", "\\epsilon": ".E", "\\eta": ".:", "\\gamma": ".G", "\\iota": ".I", "\\kappa": ".K", "\\lambda": ".L", "\\mu": ".M", "\\nu": ".N", "\\omega": ".W", "\\omicron": ".O", "\\phi": ".F", "\\pi": ".P", "\\psi": ".Y", "\\rho": ".R", "\\sigma": ".S", "\\tau": ".T", "\\theta": ".?", "\\upsilon": ".U", "\\xi": ".X", "\\zeta": ".Z" }; function p(e, t) { var r; return y(r = u.hasOwnProperty(e.value) ? u[e.value] : e.value.slice(1).toUpperCase() + " ", t) && (r = ";" + r), /^[\D]/.test(r) && (t = E(t, { wasNumber: !1 })), { value: r, ctx: t } } function f(e, t) { if (t < e.length) { var r = e[t]; if ("terminal" === r.type) { if (/^\d$/.test(r.value)) return !0; if ("." !== r.value) return !1; if (t + 1 >= e.length) return !1; if ("terminal" === (r = e[t + 1]).type) return /^\d$/.test(r.value) } } return !1 } function m(e, t) { for (var r, i, n, s = "", a = !0, o = 0; o < t.length; o++) { f(t, o) ? (e = E(e, { wasNumber: !0 }), a && (s += "#", a = !1)) : a = !0; var c = t[o]; switch (c.type) { case "terminal": e = (r = l(e, c, o < t.length - 1 ? t[o + 1] : void 0)).ctx, " " === (s += r.value)[s.length - 1] && (a = !0); break; case "command": "\\space" !== c.value && (e = (i = p(c, e)).ctx, " " === (s += i.value)[s.length - 1] && (a = !0)); break; case "greek": " " === (s += (n = c, h.hasOwnProperty(n.value) ? h[n.value] : n.value.slice(1).toUpperCase() + " "))[s.length - 1] && (a = !0); break; case "fraction": var u = d(e, c); s += u.value, e = u.ctx, a = !1; break; case "radical": s += v(e, c).value, a = !0; break; case "level": var y = _(e, c); s += y.value, e = y.ctx, a = !0; break; case "typeform": var g = m(e, c.value).value; s += g, /(ARC)?(SIN|COS|TAN|CSC|SEC|COT)(H)?/.test(g) && (s += " ") } } return { ctx: e, value: s } } function y(e, t) { return t.wasNumber && /^[A-Ja-j]/.test(e) } function d(e, t) { var r, i = m(e, t.numerator), n = m(e, t.denominator); return g(i.value) && g(n.value) ? (e = E(e, { wasNumber: !0 }), r = i.value + "/" + n.value.slice(1)) : (e = E(e, { wasNumber: !1 }), r = "(" + i.value + "./" + n.value + ")"), { ctx: e, value: r } } function g(e) { return /^\#[A-J41]+$/.test(e) } function v(e, t) { var r = "%", i = m(e, t.radicand); if (t.index) { var s = m(e, n.group(n.level({ "^": t.index }))); r += s.value, /\#[A-J]$/.test(s.value) && /^[A-J]/.test(i.value) && (r += ";") } return { ctx: e, value: r += i.value + "+" } } function _(e, t) { var r, i = "", n = function (e) { var t = ""; if (e) for (var r = 0, i = e; r < i.length; r++) { var n = i[r]; if ("command" !== n.type || "\\prime" !== n.value) break; t += "7" } return t }(t.superscript); if (i += n, t.subscript) { var s = m(e, t.subscript); r = b(t.subscript, s.value, 0) ? "<" + k(s.value) + ">" : s.value, e = E(e, { wasNumber: s.ctx.wasNumber }), "" !== r && (i += "5" + r) } if (t.superscript) { var a = m(e, t.superscript.slice(n.length)); r = b(t.superscript, a.value, n.length) ? "<" + k(a.value) + ">" : a.value, e = E(e, { wasNumber: a.ctx.wasNumber }), "" !== n && "" === r || (i += "9" + r) } return { ctx: e, value: i } } function k(e) { return /^;/.test(e) ? e.slice(1) : e } function b(e, t, r) { var i = e[0], n = (t.match(/\</g) || []).length, s = /^["|\.|_]?\</.test(t), a = (t.match(/\>/g) || []).length, o = /["|\.|_]?\>$/.test(t); return !g(t) && e.length - r > 1 && 0 === n && 0 === a || n > 0 && a > 0 && (!s || !o) || n > 1 || a > 1 || i && "typeform" === i.type } function E(e, t) { return i(i({}, e), t) } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(2), n = r(18), s = r(0); function a(e, t) { for (var r = "", n = t, s = "", m = !1, y = "", d = "", g = function (e) { for (var t = [], r = [], i = 0; i < e.length; i++) { var n = e[i]; if (l(n)) t.push({ direction: o, index: i }), r.push(0); else if (u(n)) { for (; t.length && 2 === t[t.length - 1].direction;)t.pop(); if (t.length) { if (s = t.pop()) r[s.index] = o, r.push(c) } else r.push(0) } else if (h(n)) { var s; if (t.length && 2 === t[t.length - 1].direction) { if (s = t.pop()) r[s.index] = o, r.push(c) } else t.push({ direction: 2, index: i }), r.push(0) } else r.push(0) } return r }(e), v = 0; v < e.length; v++) { var _ = e[v], k = v + 1 < e.length ? e[v + 1] : null; switch (_.type) { case "terminal": var b = i.getAutoOperator(e.slice(v)); "" !== b.value ? (r += b.value, v += b.terminalCount - 1, m = m || b.modified) : " " === _.value ? (m ? (r += f(n, s = y), n = s) : r += "\\ ", m = !1) : (g[v] === o ? r += "\\left" : g[v] === c && (r += "\\right"), r += _.value); break; case "comparison": r += f(n, s = ""), n = s, m = !1, r += _.value; break; case "level_with_comparison": r += f(n, _.level), n = _.level, m = !1, r += _.value; break; case "command": var E = _.value.slice(1).trim(); k && "terminal" === k.type && /[a-z]/.test(k.value) ? (r += E, m = !1) : i.containsValue(E) ? (r += "\\operatorname{" + E + "}", m = !0) : (r += _.value, m = !0), y = n; break; case "expression": r += _.value; break; case "fraction": r += p(_.numerator, _.denominator, n); break; case "modified_expression": r += a(_.expression, n) + " ", _.under && (r += "_{" + a(_.under, n) + "}"), _.over && (r += "^{" + a(_.over, n) + "}"); break; case "radical": r += "\\sqrt", _.index && (r += "[" + a(_.index, n) + "]"), r += "{" + a(_.value, n) + "}"; break; case "simple_subscript": "" === n ? (r += _.base.value + "_{" + _.subscript.value + "}", "command" === _.base.type && (m = !0, y = n)) : r += _.base.value + _.subscript.value; break; case "level": r += f(n, _.value, d), n = _.value, "^" === _.value && "" !== d && (d = ""); break; case "primes": k && "level" === k.type && ";" === k.value ? d = _.value : "" !== n ? (r += Array(_.value.length + 1).join("\\prime "), d = "") : (r += _.value, d = "") } } return (r += f(n, t) + d).replace(/([^\\])( )$/, "$1") } var o = 1, c = -1; function l(e) { return "terminal" === e.type && /^(\\langle |\[|\(|\\{)$/.test(e.value) } function u(e) { return "terminal" === e.type && /^(\\rangle |\]|\)|\\})$/.test(e.value) } function h(e) { return "terminal" === e.type && /^(\\\||\|)$/.test(e.value) } function p(e, t, r) { return "\\frac{" + a(e, r) + "}{" + a(t, r) + "}" } function f(e, t, r) { var i, n, s, a = "", o = Math.max(e.length, t.length); for (i = 0; i < o && e[i] === t[i]; i++); for (n = e.length - 1; n >= i; n--)a += "}"; for (s = i; s < t.length; s++)"^" === t[s] && (r && (a += r), a += "^{"), ";" === t[s] && (a += "_{"); return a } function m(e) { return a(e, "") } t.default = function (e, t) { return t && t.operatorNames ? i.setOperatorNames(t.operatorNames) : i.resetOperatorNames(), s.map(n.default(e, t), m) } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.terminal = function (e) { return { type: "terminal", value: e } }, t.command = function (e) { return { type: "command", value: "\\" + e.trim() + " " } }; var i = { '"K': "<", '"K:': "\\leq ", $L: "\\parallel ", $O: "\\to ", $P: "\\perp ", ".1": ">", ".1:": "\\geq ", ".K": "=", "@:@:": "\\approx", "/$L": "\\nparallel ", "/.K": "\\neq ", "=": "=", "@:": "\\sim " }; function n(e) { return { type: "level", value: e } } t.level_with_comparison = function (e) { var t = /[\^;]+/.exec(e), r = t ? t.toString() : "", s = e.slice(n.length); return { type: "level_with_comparison", level: r, value: i[s] } }, t.comparison = function (e) { return { type: "comparison", value: i[e] } }, t.level = n, t.baseline = function () { return n("") }, t.primes = function (e) { return { type: "primes", value: e } }, t.fraction = function (e, t) { return { type: "fraction", numerator: e, denominator: t } }, t.modified_expression = function (e, t, r) { return { type: "modified_expression", expression: e, under: t, over: r } }, t.radical = function (e, t) { return { type: "radical", value: e, index: t } }, t.expression = function (e) { return { type: "expression", value: e } }, t.simple_subscript = function (e, t) { return { type: "simple_subscript", base: e, subscript: t } }; var s = { ".&": "\\chi", ".,&": "\\Chi", ".,:": "\\Eta", ".,?": "\\Theta", ".,A": "\\Alpha", ".,B": "\\Beta", ".,D": "\\Delta", ".,E": "\\Epsilon", ".,F": "\\Phi", ".,G": "\\Gamma", ".,I": "\\Iota", ".,K": "\\Kappa", ".,L": "\\Lambda", ".,M": "\\Mu", ".,N": "\\Nu", ".,O": "\\Omicron", ".,P": "\\prod", ".,R": "\\Rho", ".,S": "\\sum", ".,T": "\\Tau", ".,U": "\\Upsilon", ".,W": "\\Omega", ".,X": "\\Xi", ".,Y": "\\Psi", ".,Z": "\\Zeta", ".:": "\\eta", ".?": "\\theta", ".A": "\\alpha", ".B": "\\beta", ".D": "\\delta", ".E": "\\epsilon", ".F": "\\phi", ".G": "\\gamma", ".I": "\\iota", ".K": "\\kappa", ".L": "\\lambda", ".M": "\\mu", ".N": "\\nu", ".O": "\\omicron", ".P": "\\pi", ".R": "\\rho", ".S": "\\sigma", ".T": "\\tau", ".U": "\\upsilon", ".W": "\\omega", ".X": "\\xi", ".Y": "\\psi", ".Z": "\\zeta" }; t.greek = function (e) { if (s.hasOwnProperty(e)) return s[e] + " "; throw new Error("Unknown Greek letter") }, t.group = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return Array.prototype.concat.apply([], e) } }, function (e, t, r) { "use strict"; var i = this && this.__assign || function () { return (i = Object.assign || function (e) { for (var t, r = 1, i = arguments.length; r < i; r++)for (var n in t = arguments[r]) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e }).apply(this, arguments) }; Object.defineProperty(t, "__esModule", { value: !0 }); var n = r(6), s = r(9), a = r(17), o = r(20); t.default = function (e, t) { t || (t = {}); var r = s.parser, c = Object.create(r); c.yy = a, c.yy.warnOrError = function (e) { c.parseError(e, { recoverable: !1 }) }; var l = Object.create(r); l.yy = i({ warnings: [] }, a), l.yy.warnOrError = function (e) { l.yy.warnings.push(e) }, l.lexer = o.default, r = t.strict ? c : l; try { return { isError: !1, value: r.parse(e), warnings: r.yy.warnings || [] } } catch (e) { return { error: n.default(e), isError: !0 } } } }, function (e, t, r) { "use strict"; var i = this && this.__assign || function () { return (i = Object.assign || function (e) { for (var t, r = 1, i = arguments.length; r < i; r++)for (var n in t = arguments[r]) Object.prototype.hasOwnProperty.call(t, n) && (e[n] = t[n]); return e }).apply(this, arguments) }; Object.defineProperty(t, "__esModule", { value: !0 }); var n = r(6), s = r(21), a = r(10), o = r(24); t.default = function (e, t) { t || (t = {}); var r = a.parser, c = Object.create(r); c.yy = o; var l = Object.create(r); l.yy = i({ warnings: [] }, o), l.lexer = s.default, r = t.strict ? c : l; try { return { isError: !1, value: r.parse(e), warnings: r.yy.warnings || [] } } catch (e) { return { error: n.default(e), isError: !0 } } } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(9), n = i.parser.lexer, s = Object.create(n); t.default = s; var a = i.parser.terminals_, o = i.parser.symbols_; s.setInput = function (e, t) { this.delimiterStack = [], this.outputQueue = [], this.canAcceptPrimes = !1, n.setInput.call(this, e, t) }, s.lex = function () { var e = -1; if (!this) return e; if (this.outputQueue.length) return this.outputQueue.shift(); for (var t, r, i = n.lex.call(this); "UNKNOWN" === a[i] || !this.canAcceptPrimes && "PRIMES" === a[i];)this.warn(), i = n.lex.call(this); this.canAcceptPrimes = !0; var s = this.delimiterStack ? this.delimiterStack[this.delimiterStack.length - 1] : -1; switch (a[i]) { case "OPEN_FRAC": case "OPEN_MODEXP": this.delimiterStack.push(i), this.canAcceptPrimes = !1; break; case "RADICAL_INDEX": s === o.RADICAL_INDEX && (this.delimiterStack.pop(), this.pushCloseTokens(s)), this.delimiterStack.push(i), this.canAcceptPrimes = !1; break; case "OPEN_RADICAL": s === o.RADICAL_INDEX && this.delimiterStack.pop(), this.delimiterStack.push(i), this.canAcceptPrimes = !1; break; case "SLASH": for (t = !1; this.delimiterStack.length;) { if ((r = this.delimiterStack.pop() || -1) === o.OPEN_FRAC) { t = !0; break } this.pushCloseTokens(r) } t || this.pushOpenTokens(i), this.delimiterStack.push(i), this.canAcceptPrimes = !1; break; case "CLOSE_FRAC": for (t = !1; this.delimiterStack.length;) { if ((r = this.delimiterStack.pop() || -1) === o.SLASH) { t = !0; break } if (r === o.OPEN_FRAC) { this.addMissingToken(o.SLASH), t = !0; break } this.pushCloseTokens(r) } if (!t) return this.warn(), this.canAcceptPrimes = !1, this.lex(); break; case "CLOSE_RADICAL": for (t = !1; this.delimiterStack.length;) { if ((r = this.delimiterStack.pop() || -1) === o.OPEN_RADICAL) { t = !0; break } if (r === o.RADICAL_INDEX) { t = !0, this.addMissingToken(o.OPEN_RADICAL); break } this.pushCloseTokens(r) } t || this.pushOpenTokens(i); break; case "CLOSE_MODEXP": for (t = !1; this.delimiterStack.length;) { if ((r = this.delimiterStack.pop() || -1) === o.OPEN_MODEXP) { t = !0; break } this.pushCloseTokens(r) } t || this.pushOpenTokens(i); break; case "EOF": for (; this.delimiterStack.length;)r = this.delimiterStack.pop() || -1, this.pushCloseTokens(r) }return this.outputQueue.push(i), e = this.outputQueue.shift() || -1 }, s.warn = function () { this.yylloc && this.yy.warnings.push({ location: this.yylloc }) }, s.addMissingToken = function (e) { this.outputQueue.push(e), this.warn() }, s.pushCloseTokens = function (e) { switch (a[e]) { case "OPEN_FRAC": this.addMissingToken(o.SLASH), this.addMissingToken(o.CLOSE_FRAC); break; case "SLASH": this.addMissingToken(o.CLOSE_FRAC); break; case "RADICAL_INDEX": this.addMissingToken(o.OPEN_RADICAL), this.addMissingToken(o.CLOSE_RADICAL); break; case "OPEN_RADICAL": this.addMissingToken(o.CLOSE_RADICAL); break; case "OPEN_MODEXP": this.addMissingToken(o.CLOSE_MODEXP) } }, s.pushOpenTokens = function (e) { switch (a[e]) { case "SLASH": this.addMissingToken(o.OPEN_FRAC); break; case "CLOSE_FRAC": this.addMissingToken(o.OPEN_FRAC), this.addMissingToken(o.SLASH); break; case "CLOSE_RADICAL": this.addMissingToken(o.OPEN_RADICAL); break; case "CLOSE_MODEXP": this.addMissingToken(o.OPEN_MODEXP) } } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(10), n = i.parser.lexer, s = Object.create(n); t.default = s; var a = i.parser.terminals_, o = i.parser.symbols_; s.setInput = function (e, t) { this.delimiterStack = [], this.outputQueue = [], n.setInput.call(this, e, t) }, s.lex = function () { if (this.outputQueue.length) return this.outputQueue.shift(); for (var e, t, r = n.lex.call(this); "UNKNOWN" === a[r];)this.warn(), r = n.lex.call(this); var i = this.delimiterStack ? this.delimiterStack[this.delimiterStack.length - 1] : -1; switch (a[r]) { case "OPEN_FRAC": case "OPEN_GROUP": this.delimiterStack.push(r); break; case "RADICAL_WITH_INDEX": i === o.RADICAL_WITH_INDEX && (this.delimiterStack.pop(), this.pushCloseTokens(i)), this.delimiterStack.push(r); break; case "RADICAL": i === o.RADICAL_WITH_INDEX && this.delimiterStack.pop(), this.delimiterStack.push(r); break; case "OVER": for (e = !1; this.delimiterStack.length;) { if ((t = this.delimiterStack.pop() || -1) === o.OPEN_FRAC) { e = !0; break } this.pushCloseTokens(t) } e || this.pushOpenTokens(r), this.delimiterStack.push(r); break; case "CLOSE_FRAC": for (e = !1; this.delimiterStack.length;) { if ((t = this.delimiterStack.pop() || -1) === o.OVER) { e = !0; break } if (t === o.OPEN_FRAC) { this.outputQueue.push(o.OVER), e = !0; break } this.pushCloseTokens(t) } e || this.pushOpenTokens(r); break; case "CLOSE_GROUP": for (e = !1; this.delimiterStack.length;) { if ((t = this.delimiterStack.pop() || -1) === o.OPEN_GROUP) { e = !0; break } this.pushCloseTokens(t) } e || this.pushOpenTokens(r); break; case "CLOSE_RADICAL": for (e = !1; this.delimiterStack.length;) { if ((t = this.delimiterStack.pop() || -1) === o.RADICAL || t === o.RADICAL_WITH_INDEX) { e = !0; break } this.pushCloseTokens(t) } e || this.pushOpenTokens(r); break; case "EOF": for (; this.delimiterStack.length;)t = this.delimiterStack.pop() || -1, this.pushCloseTokens(t) }return this.outputQueue.push(r), this.outputQueue.shift() || -1 }, s.warn = function () { this.yylloc && this.yy.warnings.push({ location: this.yylloc }) }, s.addMissingToken = function (e) { this.outputQueue.push(e), this.warn() }, s.pushCloseTokens = function (e) { switch (a[e]) { case "OPEN_FRAC": this.addMissingToken(o.OVER), this.addMissingToken(o.CLOSE_FRAC); break; case "OVER": this.addMissingToken(o.CLOSE_FRAC); break; case "OPEN_GROUP": this.addMissingToken(o.CLOSE_GROUP); break; case "RADICAL_WITH_INDEX": case "RADICAL": this.addMissingToken(o.CLOSE_RADICAL) } }, s.pushOpenTokens = function (e) { switch (a[e]) { case "OVER": this.addMissingToken(o.OPEN_FRAC); break; case "CLOSE_FRAC": this.addMissingToken(o.OPEN_FRAC), this.addMissingToken(o.OVER); break; case "CLOSE_GROUP": this.addMissingToken(o.OPEN_GROUP); break; case "CLOSE_RADICAL": this.addMissingToken(o.RADICAL) } } }, function (e, t, r) { "use strict"; function i(e) { return e.isError } Object.defineProperty(t, "__esModule", { value: !0 }), t.isErr = i, t.isOk = function (e) { return !e.isError }, t.map = function (e, t) { return i(e) ? e : { isError: !1, value: t(e.value) } } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = r(2), n = r(19), s = r(0); function a(e, t) { for (var r, n, s = "", m = !1, y = "", d = function (e) { for (var t = [], r = [], i = 0; i < e.length; i++) { var n = e[i]; if (l(n)) t.push({ direction: o, index: i }), r.push(0); else if (u(n)) { for (; t.length && 2 === t[t.length - 1].direction;)t.pop(); if (t.length) { if (s = t.pop()) r[s.index] = o, r.push(c) } else r.push(0) } else if (h(n)) { var s; if (t.length && 2 === t[t.length - 1].direction) { if (s = t.pop()) r[s.index] = o, r.push(c) } else t.push({ direction: 2, index: i }), r.push(0) } else r.push(0) } return r }(e), g = 0; g < e.length; g++) { var v = e[g], _ = g + 1 < e.length ? e[g + 1] : null; switch (v.type) { case "terminal": var k = i.getAutoOperator(e.slice(g)); "" !== k.value ? (s += k.value, g += k.terminalCount - 1) : " " !== v.value || m ? (d[g] === o ? s += "\\left" : d[g] === c && (s += "\\right"), s += v.value) : s += "\\ ", m = !1; break; case "command": var b = v.value.slice(1).trim(); _ && "terminal" === _.type && /[a-z]/.test(_.value) ? (s += b, m = !1) : i.containsValue(b) ? (s += "\\operatorname{" + b + "}", m = !0) : (s += v.value, m = !0); break; case "expression": s += v.value; break; case "fraction": s += (r = v.numerator, n = v.denominator, "\\frac{" + a(r) + "}{" + a(n) + "}"); break; case "radical": s += "\\sqrt", v.index && (s += "[" + a(v.index) + "]"), s += "{" + a(v.value) + "}"; break; case "basic_level": s += p(v.level, v.value, y), "9" === v.level && (y = ""); break; case "bracketed_level": s += f(v.level, v.lbrack, v.value, v.rbrack, y), "9" === v.level && (y = ""); break; case "primes": !_ || "basic_level" !== _.type && "bracketed_level" !== _.type || "5" !== _.level ? t && "" !== t ? (s += Array(v.value.length + 1).join("\\prime "), y = "") : (s += v.value, y = "") : y = v.value } } return (s += y).replace(/([^\\])( )$/, "$1") } var o = 1, c = -1; function l(e) { return "terminal" === e.type && /^(\\langle |\[|\(|\\{)$/.test(e.value) } function u(e) { return "terminal" === e.type && /^(\\rangle |\]|\)|\\})$/.test(e.value) } function h(e) { return "terminal" === e.type && /^(\\\||\|)$/.test(e.value) } function p(e, t, r) { var i = "", n = "{" + a(t, e) + "}"; return "9" === e ? i += r + "^" + n : "5" === e && (i += "_" + n), i } function f(e, t, r, i, n) { var s = "", o = "{" + t + a(r, e) + i + "}"; return "9" === e ? s += n + "^" + o : "5" === e && (s += "_" + o), s } var m = a; t.default = function (e, t) { return t && t.operatorNames ? i.setOperatorNames(t.operatorNames) : i.resetOperatorNames(), s.map(n.default(e, t), function (e) { return m(e, "") }) } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.terminal = function (e) { return { type: "terminal", value: e } }, t.command = function (e) { return { type: "command", value: e } }, t.basic_level = function (e, t) { return { type: "basic_level", level: e, value: t } }, t.bracketed_level = function (e, t, r, i) { return { type: "bracketed_level", level: e, lbrack: t, value: r, rbrack: i } }, t.primes = function (e) { return { type: "primes", value: e.length > 0 ? Array(e.length + 1).join("'") : "" } }, t.fraction = function (e, t) { return { type: "fraction", numerator: e, denominator: t } }, t.radical = function (e, t) { return { type: "radical", value: e, index: t } }, t.expression = function (e) { return { type: "expression", value: e } }, t.group = function () { for (var e = [], t = 0; t < arguments.length; t++)e[t] = arguments[t]; return Array.prototype.concat.apply([], e) }; var i = { ",.&": "\\Chi", ",.:": "\\Eta", ",.?": "\\Theta", ",.A": "\\Alpha", ",.B": "\\Beta", ",.D": "\\Delta", ",.E": "\\Epsilon", ",.F": "\\Phi", ",.G": "\\Gamma", ",.I": "\\Iota", ",.K": "\\Kappa", ",.L": "\\Lambda", ",.M": "\\Mu", ",.N": "\\Nu", ",.O": "\\Omicron", ",.P": "\\prod", ",.R": "\\Rho", ",.S": "\\sum", ",.T": "\\Tau", ",.U": "\\Upsilon", ",.W": "\\Omega", ",.X": "\\Xi", ",.Y": "\\Psi", ",.Z": "\\Zeta", ".&": "\\chi", ".:": "\\eta", ".?": "\\theta", ".A": "\\alpha", ".B": "\\beta", ".D": "\\delta", ".E": "\\epsilon", ".F": "\\phi", ".G": "\\gamma", ".I": "\\iota", ".K": "\\kappa", ".L": "\\lambda", ".M": "\\mu", ".N": "\\nu", ".O": "\\omicron", ".P": "\\pi", ".R": "\\rho", ".S": "\\sigma", ".T": "\\tau", ".U": "\\upsilon", ".W": "\\omega", ".X": "\\xi", ".Y": "\\psi", ".Z": "\\zeta" }; t.greek = function (e) { if (i.hasOwnProperty(e)) return i[e] + " "; throw new Error("Unknown Greek letter") }, t.to_number = function (e) { for (var t = "", r = "A".charCodeAt(0) - 1, i = 0, n = e; i < n.length; i++) { var s = n[i]; t += "4" === s ? "." : "J" === s ? "0" : s.charCodeAt(0) - r } return t } }, function (e, t, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = " A1B'K2L@CIF/MSP\"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)="; function n(e) { for (var t, r = "", n = 0, s = e; n < s.length; n++) { var a = s[n]; r += (t = i.indexOf(a), String.fromCharCode(10240 + t)) } return r } function s(e) { for (var t, r = "", n = 0, s = e; n < s.length; n++) { var a = s[n]; r += (t = a.charCodeAt(0) - 10240, i[t]) } return r } t.toBrailleAscii = s, t.toExpandedBrailleAscii = function (e) { return s(e).replace(/[@-^]/g, function (e) { return String.fromCharCode(e.charCodeAt(0) + 32) }) }, t.coerceToSixDotCells = function (e) { var t = ""; if (e) for (var r = 0, i = e; r < i.length; r++) { var s = i[r], a = s.charCodeAt(0); 96 <= a && a <= 127 && (a -= 32, s = String.fromCharCode(a)), 32 <= a && a <= 95 && (a = (s = n(s)).charCodeAt(0)), 10305 <= a && a <= 10495 && (a = 10240 + (a - 1024) % 64, s = String.fromCharCode(a)), t += 10240 <= a && a <= 10304 ? s : String.fromCharCode(10240) } return t }, t.isSixDotCells = function (e) { for (var t = 0; t < e.length; t++) { var r = e.charCodeAt(t); if (r < 10240 || r > 10304) return !1 } return !0 } }, function (e, t, r) { r(3), e.exports = r(3) }]) });
define('graphing/canvas-braille', ["require", "exports", "tslib", "./projection", "./screen", "core/graphing-calc/json/graph-settings", "abraham"], function (require, e, t, i, r, n, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.createBrailleImage = void 0; function l(e, t, i, r, n) { var a = 1 + e.dotSpacing, l = n.charCodeAt(0) - 10240; 1 & l && t.fillRect(i, r, 1, 1), 2 & l && t.fillRect(i, r + a, 1, 1), 4 & l && t.fillRect(i, r + 2 * a, 1, 1), 8 & l && t.fillRect(i + a, r, 1, 1), 16 & l && t.fillRect(i + a, r + a, 1, 1), 32 & l && t.fillRect(i + a, r + 2 * a, 1, 1) } function o(e, t) { for (var i = t.x, r = t.y, n = t.width, a = t.height, l = e.getImageData(i, r, n, a).data, o = 3; o < l.length; o += 4)if (0 !== l[o]) return !1; return !0 } function h(e, t) { for (var i = t.x, r = t.y, n = t.width, a = t.height, l = e.getImageData(i, r, n, a).data, o = 3; o < l.length; o += 4)if (0 === l[o]) return !1; return !0 } function s(e, t, i, r, n) { return o(t, d(e, i, r, n)) } function c(e, t) { var i = e.dotSpacing; return (2 + i) * t.length + (1 + i) * (t.length - 1) } function f(e, t) { return 3 + 2 * e.dotSpacing } function d(e, t, i, r) { var n = e.cellPadding; return { x: t - n, y: i - n, width: c(e, r) + 2 * n, height: f(e) + 2 * n } } function u(e, t) { if (!e) return t; var i = Math.min(e.x, t.x), r = Math.min(e.y, t.y); return { x: i, y: r, width: Math.max(e.x + e.width, t.x + t.width) - i, height: Math.max(e.y + e.height, t.y + t.height) - r } } function g(e, t, i) { return Math.min(Math.max(e, t), i) } function x(e, t, i, r, n) { return { x: g(i, 0, t.canvas.width - c(e, n)), y: g(r, 0, t.canvas.height - f(e)) } } function v(e, t, i, r, n) { var a = t.fillStyle; t.fillStyle = "white"; var o = d(e, i, r, n); t.fillRect(o.x, o.y, o.width, o.height), t.fillStyle = "black", function (e, t, i, r, n) { for (var a = 3 + 2 * e.dotSpacing, o = 0; o < n.length; o++)l(e, t, i + a * o, r, n[o]) }(e, t, i, r, n), t.fillStyle = a } function w(e, t, i, r) { var n = e.cellPadding; return { x: Math.round(t - (c(e, r) + n)), y: i } } function m(e, t) { var i = "nemeth" === t ? a.latexToNemeth(e) : a.latexToUeb(e); return i.isError ? "" : function (e) { return e.replace(/\u283C(?!$)/g, "") }(i.value) } function y(e, t) { return t >= 0 ? e * Math.pow(10, t) : e / Math.pow(10, -t) } function p(e, t, i, r) { var n = i[0], a = i[1], l = Math.ceil(Math.log(a - n) / Math.LN10) - 1, o = l, h = 5; e: for (var s = l; l - s < 4; s--)for (var f = 0, d = [5, 2, 1]; f < d.length; f++) { var u = d[f], g = y(u, s), x = Math.floor(n / g) + 1, v = Math.ceil(a / g) - 1, w = Math.abs(r(g) - r(0)), p = m(String(y(x * u, s)), t), b = m(String(y(v * u, s)), t); if (w < c(e, p) + c(e, " ") || w < c(e, b) + c(e, " ")) break e; if (v - x >= 15) break e; o = s, h = u } return { int: h, exp: o } } function b(e, t, i) { return p(e, t, [i.viewport.xmin, i.viewport.xmax], function (e) { return i.mapx(e) }) } function M(e, t, i) { return i.viewport.isSquare(i.screen) ? b(e, t, i) : p(e, t, [i.viewport.ymin, i.viewport.ymax], function (e) { return i.mapy(e) }) } function S(e, t) { for (var i = e.int, r = e.exp, n = t[0], a = t[1], l = Math.ceil(n / y(i, r)), o = Math.floor(a / y(i, r)), h = [], s = l; s <= o; s++)h.push(y(s * i, r)); return h } function A(e) { switch (e) { case "vpmax8": case "vpmax11": return "rgb(145, 145, 145)"; case "etc8": case "etc11": return "rgb(0, 0, 0)"; default: throw new Error("Unexpected embosser model: " + e) } } function R(e) { switch (e) { case "vpmax8": case "vpmax11": return "rgb(219, 219, 219)"; case "etc8": case "etc11": return "rgb(0, 0, 0)"; default: throw new Error("Unexpected embosser model: " + e) } } function P(e, t, i, r, n, a) { void 0 === a && (a = 1); var l = e.fillStyle; e.fillStyle = t, e.fillRect(i - 1, r, a, n - r), e.fillStyle = l } function I(e, t, i, r, n, a) { void 0 === a && (a = 1); var l = e.fillStyle; e.fillStyle = t, e.fillRect(r, i - 1, n - r, a), e.fillStyle = l } function E(e, t, i, r) { var n = e.fillStyle; e.fillStyle = t, e.fillRect(i + 1, r, 1, 1), e.fillRect(i, r + 1, 1, 1), e.fillRect(i + 1, r + 1, 1, 1), e.fillRect(i + 2, r + 1, 1, 1), e.fillRect(i + 1, r + 2, 1, 1), e.fillStyle = n } e.createBrailleImage = function (e, a, l, g, y) { var p, N, C, _, q, O, L, k; if (void 0 !== l.margins && void 0 !== a) { var B = function (e) { if ("etc8" === e || "etc11" === e) return { dotSpacing: 0, cellPadding: 1, graphLineWidth: 1.75, embossPatternInequalities: !0 }; if ("vpmax8" === e || "vpmax11" === e) return { dotSpacing: 1, cellPadding: 2, graphLineWidth: 1, embossPatternInequalities: !1 }; throw new Error("Unexpected embosser model " + e) }(g), T = l.margins, j = t.__assign({}, a.settings), U = j.showGrid && function (e) { if ("etc8" === e || "etc11" === e) return !1; if ("vpmax8" === e || "vpmax11" === e) return !0; throw new Error("Unexpected embosser model " + e) }(g), W = !!j.showXAxis, F = !!j.showYAxis, D = !!j.xAxisNumbers, G = j.xAxisArrowMode, H = !!j.yAxisNumbers, X = j.yAxisArrowMode, Y = B.graphLineWidth, $ = { showGrid: !1, xAxisNumbers: !1, xAxisArrowMode: n.AxisArrowModes.NONE, yAxisNumbers: !1, yAxisArrowMode: n.AxisArrowModes.NONE, showXAxis: !1, showYAxis: !1, graphLineWidth: Y, pointLineWidth: 2.5, curveOpacity: 1, globalCurveColor: "#000", disableFill: !0 }; for (var z in $) a.settings[z] = $[z]; var J = e.width - T.right - T.left, K = e.height - T.top - T.bottom, Q = new r.Screen(J, K), V = a.getProjection().viewport; a.settings.squareAxes && (V = V.squareCrop(Q)); var Z = new i.Projection(Q, V, a.settings), ee = e.getContext("2d"), te = document.createElement("canvas"); te.width = J, te.height = K; var ie = te.getContext("2d"), re = document.createElement("canvas"); re.width = J, re.height = K; var ne = re.getContext("2d"), ae = document.createElement("canvas"); ae.width = J, ae.height = K; var le = ae.getContext("2d"), oe = document.createElement("canvas"); oe.width = J, oe.height = K; var he = oe.getContext("2d"), se = document.createElement("canvas"); se.width = J, se.height = K; var ce = se.getContext("2d"); if (null !== ee && null !== he && null !== ie && null !== le && null !== ce && null !== ne) { a.settings.disableFill = !0, a.screenshotToCanvas(oe, { width: J, height: K, targetPixelRatio: 1, transparentBackground: !0 }), a.settings.disableFill = !1, a.screenshotToCanvas(te, { width: J, height: K, targetPixelRatio: 1, transparentBackground: !0 }), ee.fillStyle = "white", ee.fillRect(0, 0, e.width, e.height); var fe, de = Math.round(Z.mapx(0)), ue = Math.round(Z.mapy(0)), ge = "" !== j.xAxisLabel ? j.xAxisLabel.replace(/ /g, "\\ ") : "x", xe = "" !== j.yAxisLabel ? j.yAxisLabel.replace(/ /g, "\\ ") : "y"; if (W && Z.coordsAreOnscreen(J - 6, ue - 8, 0)) v(fe = t.__assign(t.__assign({}, B), { cellPadding: B.cellPadding + 1 }), ce, Ue = (N = x(fe, ie, Ue = (p = w(fe, Ue = J - 2, We = ue - (Pe = 2 + 2 * f(fe)), Re = m(ge, y))).x, We = p.y, Re)).x, We = N.y, Re); if (F && Z.coordsAreOnscreen(de + 4, 1, 0)) v(fe = t.__assign(t.__assign({}, B), { cellPadding: B.cellPadding + 1 }), ce, Ue = (C = x(fe, ie, Ue = de + 4, We = 1, Re = m(xe, y))).x, We = C.y, Re); var ve = function (e, t, i) { return { x: S(b(e, t, i), [i.viewport.xmin, i.viewport.xmax]), y: S(M(e, t, i), [i.viewport.ymin, i.viewport.ymax]) } }(B, y, Z), we = ve.x, me = ve.y; if (W) { for (var ye = void 0, pe = 0, be = we; pe < be.length; pe++) { if (0 !== (Ne = be[pe]) || !F) if (!((ke = Math.round(Z.mapx(Ne))) < 2 || ke > Z.screen.width - 2) && D) { var Me = c(B, m("-1", y)) - c(B, m("1", y)); s(B, he, Ue = (_ = x(B, ce, Ue = ke - (Ne < 0 ? Me + 1 : 1), We = ue + 4, Re = m("" + Ne, y))).x, We = _.y, Re) && (v(B, ce, Ue, We, Re), ye = u(ye, d(B, Ue, We, Re))) } } if (B.embossPatternInequalities && ye) ye = u(ye, { x: 0, y: ue, width: J, height: 0 }), le.fillStyle = "white", le.fillRect(ye.x, ye.y, ye.width, ye.height) } if (F) { ye = void 0; for (var Se = 0, Ae = me; Se < Ae.length; Se++) { if (0 !== (qe = Ae[Se]) || !W) if (!((je = Math.round(Z.mapy(qe))) < 2 || je > Z.screen.height - 2)) { var Re, Pe = -Math.ceil(f(B) / 2); if (H) s(B, he, Ue = (O = x(B, ce, Ue = (q = w(B, Ue = de - 4, We = je + Pe, Re = m("" + qe, y))).x, We = q.y, Re)).x, We = O.y, Re) && (v(B, ce, Ue, We, Re), ye = u(ye, d(B, Ue, We, Re))) } } if (B.embossPatternInequalities && ye) ye = u(ye, { x: de, y: 0, width: 0, height: K }), le.fillStyle = "white", le.fillRect(ye.x, ye.y, ye.width, ye.height) } if (W && F) Ue = (L = w(B, Ue = de - 2, We = ue + 2, Re = m(D || H ? "0" : "o", y))).x, We = L.y, Z.coordsAreOnscreen(Ue, We, 0) && s(B, he, Ue = (k = x(B, ce, Ue, We, Re)).x, We = k.y, Re) && v(B, ce, Ue, We, Re); for (var Ie = 0, Ee = we; Ie < Ee.length; Ie++) { var Ne = Ee[Ie]; (ke = Math.round(Z.mapx(Ne))) < 2 || ke > Z.screen.width - 2 || (F && 0 === Ne || U && P(le, "white", ke - 1, 0, K, 3)) } for (var Ce = 0, _e = me; Ce < _e.length; Ce++) { var qe = _e[Ce]; (je = Math.round(Z.mapy(qe))) < 2 || je > Z.screen.height - 2 || (W && 0 === qe || U && I(le, "white", je - 1, 0, J, 3)) } W && I(le, "white", ue - 3, 0, J, 7), F && P(le, "white", de - 3, 0, K, 7); for (var Oe = 0, Le = we; Oe < Le.length; Oe++) { var ke; Ne = Le[Oe]; (ke = Math.round(Z.mapx(Ne))) < 2 || ke > Z.screen.width - 2 || (F && 0 === Ne || (U ? P(le, R(g), ke, 0, K) : W && P(le, R(g), ke, ue - 3, ue + 2))) } for (var Be = 0, Te = me; Be < Te.length; Be++) { var je; qe = Te[Be]; (je = Math.round(Z.mapy(qe))) < 2 || je > Z.screen.height - 2 || (W && 0 === qe || (U ? I(le, R(g), je, 0, J) : F && I(le, R(g), je, de - 3, de + 2))) } if (W && I(le, A(g), ue, 0, J), F && P(le, A(g), de, 0, K), X !== n.AxisArrowModes.NONE && (function (e, t, i, r) { var n = e.fillStyle; e.fillStyle = t; for (var a = -2; a <= 2; a++)e.fillRect(i - 1 + a, r + Math.abs(a), 1, 1); e.fillStyle = n }(le, A(g), de, 0), X === n.AxisArrowModes.BOTH && function (e, t, i, r) { var n = e.fillStyle; e.fillStyle = t; for (var a = -2; a <= 2; a++)e.fillRect(i - 1 + a, r - Math.abs(a), 1, 1); e.fillStyle = n }(le, A(g), de, K - 1)), G !== n.AxisArrowModes.NONE && (function (e, t, i, r) { var n = e.fillStyle; e.fillStyle = t; for (var a = -2; a <= 2; a++)e.fillRect(i - Math.abs(a), r - 1 + a, 1, 1); e.fillStyle = n }(le, A(g), J - 1, ue), G === n.AxisArrowModes.BOTH && function (e, t, i, r) { var n = e.fillStyle; e.fillStyle = t; for (var a = -2; a <= 2; a++)e.fillRect(i + Math.abs(a), r - 1 + a, 1, 1); e.fillStyle = n }(le, A(g), 0, ue)), B.embossPatternInequalities) for (var Ue = 0; Ue < J; Ue += 6)for (var We = 0; We < K; We += 6) { var Fe = { x: Ue, y: We, width: 3, height: 3 }; h(ie, Fe) && o(le, Fe) && o(he, Fe) && o(ce, Fe) && E(ne, "black", Ue, We) } B.embossPatternInequalities || ee.drawImage(te, T.left, T.top), ee.drawImage(ae, T.left, T.top), ee.drawImage(oe, T.left, T.top), ee.drawImage(se, T.left, T.top), B.embossPatternInequalities && ee.drawImage(re, T.left, T.top) } for (var z in $) a.settings[z] = j[z] } } });
define('graphing/braille-size-options', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.brailleSizes = void 0, e.brailleSizes = {}, e.brailleSizes.vpmax8 = { width: 170, height: 220, margins: { left: 5, top: 15, right: 5, bottom: 50 }, name: function (e) { return e.s("graphing-calculator-label-braille-size-vpmax8") } }, e.brailleSizes.vpmax11 = { width: 230, height: 220, margins: { left: 15, top: 15, right: 5, bottom: 5 }, name: function (e) { return e.s("graphing-calculator-label-braille-size-vpmax11") } }, e.brailleSizes.etc8 = { width: 96, height: 96, margins: { left: 5, top: 15, right: 0, bottom: 0 }, name: function (e) { return e.s("graphing-calculator-label-braille-size-etc8") } }, e.brailleSizes.etc11 = { width: 132, height: 134, margins: { left: 10, top: 15, right: 5, bottom: 5 }, name: function (e) { return e.s("graphing-calculator-label-braille-size-etc11") } } });
define('graphing/movablepointslayer', ["require", "exports", "tslib", "dcgview", "browser", "graphing-calc/models/expression", "core/lib/label", "core/graphing-calc/json/expression", "core/lib/dragmode", "core/types/graphmode", "lib/aria", "./constants", "jquery", "underscore"], function (require, e, t, r, o, i, n, a, s, c, d, p, l, h) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getCoordsString = void 0; var u = r.Components.For; function g(e, t) { var r = e[t]; return Array.isArray(r) && e.tableInfo ? r[e.tableInfo.rowIndex] : r } var v = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.init = function () { this.grapher = this.props.grapher(), this.renderedPointsIdOrder = [], this.renderedPoints = {} }, n.prototype.template = function () { var e = this; return r.createElement(u, { each: function () { return e.renderedPointsIdOrder } }, r.createElement("div", { class: r.const("dcg-graph-outer"), style: this.const({ "z-index": 0 }), onFocusin: function () { return e.requestRedrawNextFrame() }, onFocusout: function () { return e.requestRedrawNextFrame() }, didMount: this.didMountRoot.bind(this) }, function (t) { return r.createElement("div", { class: e.const({ "dcg-tabbable-point": !0, "dcg-movable-point": "movable" === e.renderedPoints[t].type }), style: function () { return { transform: e.getTransform(t) } }, role: r.const("button"), "aria-roledescription": function () { return "movable" === e.renderedPoints[t].type ? e.grapher.controller.s("graphing-calculator-narration-movable-point-description") : "draggable-label" === e.renderedPoints[t].type ? e.grapher.controller.s("graphing-calculator-narration-draggable-label-description") : e.grapher.controller.s("graphing-calculator-narration-point-description") }, "dcg-mp-id": e.const(t), tabindex: function () { return e.getTabIndex(t) }, "aria-label": function () { return e.getAriaLabel(t) }, "aria-hidden": e.bindFn(e.getAriaHidden) }) })) }, n.prototype.redraw = function (e, t, r) { var o = this, i = this.grapher.graphSketches, n = this.renderedPoints; this.renderedPoints = {}, this.renderedPointsIdOrder = []; var a = this.getFocusedPointId(), s = function (i) { var s = o.processPOI(e, t, i, n[i.id], r, a); s && (o.renderedPoints[i.id] = s, o.renderedPointsIdOrder.push(i.id)) }; this.grapher.getSketchOrder().forEach(function (e) { var t = i[e]; t && t.visible && (t.getMovablePoints().forEach(s), t.getStaticLabeledPoints().forEach(s)) }); var c = this.renderedPoints[this.hoveredPointId], d = this.renderedPoints[this.pressedPointId], p = c && c.poi, l = d && d.poi; p || this.setHoveredPointId(void 0), l || this.setPressedPointId(void 0); var h, u, g = l || p; g ? (h = "movable-point" === g.type && g.tableInfo && g.tableInfo.dragX, u = "movable-point" === g.type && g.tableInfo && g.tableInfo.dragY, h && u || !h && !u ? this.grapher.setLayerClass("movablePoints", "dcg-mouse-over-movable-point") : h ? this.grapher.setLayerClass("movablePoints", "dcg-mouse-over-movable-point-ew") : this.grapher.setLayerClass("movablePoints", "dcg-mouse-over-movable-point-ns")) : this.grapher.setLayerClass("movablePoints", void 0), this.update(), this.speakAriaAlert() }, n.prototype._clampedOpacity = function (e) { return e < 0 ? 0 : e > 1 ? 1 : h.isFinite(e) ? e : 1 }, n.prototype.drawForScreenshot = function (e, t, r, o) { var i = this, n = this.grapher.graphSketches; for (var a in n) { var s = n[a]; if (s.visible) { var d, p = s.branches[0]; p.graphMode === c.XYPOINT_MOVABLE && (d = p.pointOpacity), s.getMovablePoints().forEach(function (n) { var a = { screenX: t.mapx(n.x), screenY: t.mapy(n.y), color: n.color, pointOpacity: d, animationPercent: 0 }; i.drawMovablePointOnCtx(e, a, r, o) }) } } }, n.prototype.processPOI = function (e, t, r, o, i, n) { var a = r.id, c = r.x, d = r.y, l = t.mapx(c), h = t.mapy(d), u = n === a, v = t.coordsAreOnscreen(l, h, p.OFFSCREEN_RENDER_MARGIN); if (v || u) { if (!o) { var b = r.sketch ? this.grapher.controller.getItemModel(r.sketch.id) : void 0; o = "movable-point" === r.type ? { type: "movable", id: a, pointOnScreen: v, poi: r, projection: t, screenX: screenX, screenY: screenY, color: g(r, "color"), pointOpacity: g(r, "pointOpacity"), pointIsHovered: !1, pointIsPressed: !1, lastHoverActionTime: 0, animationPercent: 0 } : b && "expression" === b.type && void 0 !== b.label && b.showLabel && b.reconciledDragMode !== s.DragMode.NONE ? { type: "draggable-label", id: a, pointOnScreen: v, poi: r, projection: t, screenX: screenX, screenY: screenY } : { type: "static", id: a, pointOnScreen: v, poi: r, projection: t, screenX: screenX, screenY: screenY } } return o.pointOnScreen = v, o.poi = r, o.projection = t, o.screenX = l, o.screenY = h, "movable" === o.type && (o.color = g(o.poi, "color"), o.pointOpacity = g(o.poi, "pointOpacity"), this.updateMovablePointAnimation(o), this.drawMovablePointOnCtx(e, o, i)), o } }, n.prototype.drawMovablePointOnCtx = function (e, t, r, o) { var i; i = o || (this.grapher.settings.config.projectorMode ? 13.5 : 10.5); var n = Array.isArray(t.color) ? t.color[0] : t.color, a = t.screenX, s = t.screenY, c = t.animationPercent || 0; r.push({ left: a - i, right: a + i, top: s - i, bottom: s + i }), e.save(); var d = e.globalAlpha, p = this._clampedOpacity(t.pointOpacity); e.fillStyle = n, e.globalAlpha = .35 * p, e.beginPath(), e.moveTo(a + i, s), e.arc(a, s, i, 0, 2 * Math.PI, !0), e.closePath(), e.fill(), e.globalAlpha = p, i *= .3 + .7 * c, e.beginPath(), e.moveTo(a + i, s), e.arc(a, s, i, 0, 2 * Math.PI, !0), e.closePath(), e.fill(), e.globalAlpha = d, e.restore() }, n.prototype.updateMovablePointAnimation = function (e) { var t = Date.now(), r = e.id, o = this.hoveredPointId === r, i = this.pressedPointId === r; e.pointIsPressed = i, o !== e.pointIsHovered && (e.pointIsHovered = o, e.lastHoverActionTime = t); var n = e.animationPercent || 0, a = .004 * (t - e.lastHoverActionTime); i ? n = 1 : o ? (n += a) >= 1 ? n = 1 : this.requestRedrawNextFrame() : (n -= a) <= 0 ? n = 0 : this.requestRedrawNextFrame(), e.animationPercent = n }, n.prototype.getTransform = function (e) { var t = this.renderedPoints[e]; if (t) return o.translateRule(t.screenX, t.screenY) }, n.prototype.getTabIndex = function (e) { var t = this.renderedPoints[e]; if (!t) return -1; var r = t.poi, o = this.grapher.controller.getItemEditableLabelMode(r.sketch.id), n = this.grapher.controller.getItemModel(r.sketch.id), s = n && "expression" === n.type && !i.isClickableObject(n) && ("movable" === t.type || void 0 === o || o === a.EditableLabelMode.None), c = this.grapher.settings, d = c.config.graphpaper && c.config.enableTabindex; return s && d ? 0 : -1 }, n.prototype.getAriaHidden = function () { return !this.grapher.settings.config.graphpaper }, n.prototype.getAriaLabel = function (e) { var t = this.getAriaAlert({ id: e, includeUsageInstructions: !1 }); return t && t.completeMessage }, n.prototype.speakAriaAlert = function () { var e = this.getFocusedPointId(); if (e) { var t = this.renderedPoints[e]; if (!t || "static" === t.type) return } var r = this.getAriaAlert({ id: e, lastAriaAlert: this.lastAriaAlert, includeUsageInstructions: !0 }); this.lastAriaAlert = r, r && r.completeMessage && d.alert(r.completeMessage) }, n.prototype.getAriaAlert = function (e) { var t = e.id, r = e.lastAriaAlert, o = e.includeUsageInstructions; if (t) { var i = this.renderedPoints[t]; if (i) { r && r.id !== t && (r = void 0); var n = i.poi, a = i.pointOnScreen, s = i.projection; if (n && s) { var c = s.viewport; if (c) { var d = r && r.label, p = n.ariaLabel, l = d !== p, h = r && r.coordX, u = r && r.coordY, g = n.x, v = n.y, f = g !== h || v !== u, m = b(g, v, c) + ".", y = this.grapher.controller, P = p || y.s("graphing-calculator-narration-movable-point-prefix"), I = "movable" !== i.type && "draggable-label" !== i.type || !o ? "" : y.s("graphing-calculator-narration-movable-point-suffix-usage-instructions"), A = a ? "" : y.s("graphing-calculator-narration-movable-point-off-screen-prompt"); return { id: t, coordX: g, coordY: v, label: p, completeMessage: r ? l ? P + A : f ? m + A : "" : P + ". " + m + I + A } } } } } }, n.prototype.setHoveredPointId = function (e) { e !== this.hoveredPointId && (this.hoveredPointId = e, this.requestRedrawNextFrame()) }, n.prototype.isMovingPoint = function () { return !!this.pressedPointId }, n.prototype.setPressedPointId = function (e) { e !== this.pressedPointId && (this.pressedPointId = e, this.requestRedrawNextFrame()) }, n.prototype.getFocusedPointId = function () { if (document.activeElement && l.contains(this.rootNode, document.activeElement)) return l(document.activeElement).attr("dcg-mp-id") }, n.prototype.getFocusedPoint = function () { var e = this.getFocusedPointId(); if (e) { var t = this.renderedPoints[e]; if (t) return t.poi } }, n.prototype.didMountRoot = function (e) { this.rootNode = e }, n.prototype.requestRedrawNextFrame = function () { this.grapher.redrawAllLayers() }, n }(r.Class); function b(e, t, r) { return "X: " + n.value(e, r.xmax - r.xmin).ariaString + ". Y: " + n.value(t, r.ymax - r.ymin).ariaString } e.default = v, e.getCoordsString = b });
define('graphing/integral-image', ["require", "exports"], function (require, t) { "use strict"; function a(t, a, e) { return Math.max(a, Math.min(e, t)) } Object.defineProperty(t, "__esModule", { value: !0 }); var e = function () { function t(t) { var a = t.data, e = t.width, i = t.height; this.imageData = t; for (var o = 1; o < e; o++)a[o] += a[o - 1]; for (var r = 1; r < i; r++)a[r * e] += a[r * e - e]; for (var h = e * i - e - i + 1, f = e - 1, n = 0; n < h; n++) { o = 1 + n % f; var u = (r = 1 + Math.floor(n / f)) * e, g = o - 1 + u, m = o + u - e, l = o - 1 + u - e; a[u + o] += a[g] + a[m] - a[l] } } return t.prototype.getSumForValidRect = function (t) { var a = t.left - 1, e = t.right - 1, i = t.top - 1, o = t.bottom - 1, r = this.imageData.width, h = this.imageData.data, f = h[a + i * r], n = h[e + i * r], u = h[a + o * r], g = h[e + o * r]; return a >= 0 && i >= 0 ? g - n - u + f : a >= 0 ? g - u : i >= 0 ? g - n : g }, t.prototype.getSum = function (t) { var e = { left: a(Math.floor(t.left), 0, this.imageData.width), right: a(Math.ceil(t.right), 0, this.imageData.width), top: a(Math.floor(t.top), 0, this.imageData.height), bottom: a(Math.ceil(t.bottom), 0, this.imageData.height) }; return e.left >= e.right || e.top >= e.bottom ? 0 : this.getSumForValidRect(e) }, t }(); t.default = e });
define('graphing/automatic-label-placer', ["require", "exports", "graphing/integral-image", "underscore"], function (require, t, e, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.generateCandidatesForPolygon = t.generateCandidatesForAngle = t.generateCandidatesForSegment = t.generateCandidatesForPoint = t.buildStaticEnvGetter = t.computePositions = t.getIntegralImage = void 0; var r = .5, o = document.createElement("canvas"), n = []; function i(t, a) { if (!(a.width * a.height > 0)) return new e.default({ width: 0, height: 0, data: [] }); o.width = 0, o.width = Math.round(a.width * r), o.height = Math.round(a.height * r); var i = o.getContext("2d"); i.save(), i.scale(o.width / t.canvas.width, o.height / t.canvas.height), i.drawImage(t.canvas, 0, 0), i.restore(); var h = i.getImageData(0, 0, o.width, o.height), c = h.data; c.length, n.length; for (var s = n = new Array(c.length / 4), u = 0; u < s.length; u++)s[u] = c[4 * u + 3]; return new e.default({ width: h.width, height: h.height, data: s }) } function h(t, e) { var a = 1 / 0, r = -1, o = e[t]; if (1 === o.length) return o[0]; for (var n = 0; n < o.length; n++) { var i = e[t][n].staticScore + c(t, n, e); (-1 === r || i < a) && (a = i, r = n) } return o[r] } function c(t, e, a) { for (var r = 0, o = a[t][e], n = 0; n < a.length; n++)if (n !== t) { for (var i = 0, h = a[n], c = h.length - 1; c >= 0; c--) { var s = h[c]; i += Math.max(0, Math.min(o.right, s.right) - Math.max(o.left, s.left)) * Math.max(0, Math.min(o.bottom, s.bottom) - Math.max(o.top, s.top)) } r += i / h.length } return r } function s(t, e) { var a = e.getSum({ left: t.left * r, right: t.right * r, top: t.top * r, bottom: t.bottom * r }); return a /= 200, a /= .25 } function u(t, e) { var a = 0; return e.forEach(function (e) { a += p(t, e) }), a } function p(t, e) { return Math.max(0, Math.min(t.right, e.right) - Math.max(t.left, e.left)) * Math.max(0, Math.min(t.bottom, e.bottom) - Math.max(t.top, e.top)) } function l(t, e) { if (!(e.length <= 1)) for (var a, r, o, n = t(), i = 0, h = e; i < h.length; i++) { var c = h[i]; c.staticScore += (a = c, r = n.viewport, o = void 0, o = p(a, r), 10 * (a.width * a.height - o)), c.staticScore += u(c, n.domObstructions), c.staticScore += s(c, n.integralImage) } } t.getIntegralImage = i, t.computePositions = function (t) { for (var e = 0; e < t.length; e++) { var a = h(e, t); t[e] = [a] } return t.map(function (t) { return t[0] }) }, t.buildStaticEnvGetter = function (t, e, a) { var r; return function () { return r || (r = { domObstructions: a, viewport: { left: 0, right: e.width, top: 0, bottom: e.height }, integralImage: i(t, e) }), r } }, t.generateCandidatesForPoint = function (t, e) { var r = e.nakedLabel ? 0 : e.pt_radius, o = Math.round(r / Math.sqrt(2)), n = [], i = e.pt_x, h = e.pt_y, c = e.width, s = e.height, u = 400; n.push({ cx_s: 0, cy_s: 0, cx_a: 0, cy_a: 0, staticScore: u, orientation: "center", matches: { default: 1, center: 1, center_auto: 1, auto_center: 1 } }), n.push({ cx_s: .5, cx_a: r + 3, cy_s: 0, cy_a: 0, staticScore: u, orientation: "right", matches: { default: 1, right: 1, center_auto: 1, auto_right: 1 } }), n.push({ cx_s: -.5, cx_a: -r - 3, cy_s: 0, cy_a: 0, staticScore: u, orientation: "left", matches: { default: 1, left: 1, center_auto: 1, auto_left: 1 } }), n.push({ cx_s: 0, cx_a: 0, cy_s: -.5, cy_a: -r, staticScore: u, orientation: "above", matches: { default: 1, above: 1, auto_center: 1, above_auto: 1 } }), n.push({ cx_s: -.5, cx_a: -o, cy_s: -.5, cy_a: -o, staticScore: u, orientation: "tl", matches: { default: 1, above_left: 1, above_auto: 1, auto_left: 1 } }), n.push({ cx_s: .5, cx_a: o, cy_s: -.5, cy_a: -o, staticScore: u, orientation: "tr", matches: { default: 1, above_right: 1, above_auto: 1, auto_right: 1 } }), n.push({ cx_s: 0, cx_a: 0, cy_s: .5, cy_a: r, staticScore: u, orientation: "below", matches: { default: 1, below: 1, auto_center: 1, below_auto: 1 } }), n.push({ cx_s: -.5, cx_a: -o, cy_s: .5, cy_a: o, staticScore: u, orientation: "bl", matches: { default: 1, below_left: 1, below_auto: 1, auto_left: 1 } }), n.push({ cx_s: .5, cx_a: o, cy_s: .5, cy_a: o, staticScore: u, orientation: "br", matches: { default: 1, below_right: 1, below_auto: 1, auto_right: 1 } }); var p = Math.cos(e.rotation), f = Math.sin(e.rotation), d = n.map(function (t) { var a = t.cx_s * c + t.cx_a, r = t.cy_s * s + t.cy_a, o = a * p - r * f, n = r * p + a * f, u = "calc(" + (100 * t.cx_s - 50) + "% + " + t.cx_a + "px)", l = "calc(" + (100 * t.cy_s - 50) + "% + " + t.cy_a + "px)", d = -c / 2, g = c / 2, _ = -s / 2, m = s / 2; if (e.rotation) { var x = function (t) { for (var e = t[0].x, a = t[0].x, r = t[0].y, o = t[0].y, n = t.length - 1; n >= 1; n--) { var i = t[n], h = i.x, c = i.y; h < e && (e = h), h > a && (a = h), c < r && (r = c), c > o && (o = c) } return { left: e, right: a, top: r, bottom: o } }([{ x: d * p - _ * f, y: _ * p + d * f }, { x: d * p - m * f, y: m * p + d * f }, { x: g * p - _ * f, y: _ * p + g * f }, { x: g * p - m * f, y: m * p + g * f }]); d = x.left, g = x.right, _ = x.top, m = x.bottom } return d = Math.round(i + o + d), g = Math.round(i + o + g), _ = Math.round(h + n + _), m = Math.round(h + n + m), { pt_x: Math.round(i), pt_y: Math.round(h), left: d, right: g, top: _, bottom: m, width: g - d, height: m - _, transform: "translate(" + u + "," + l + ")", staticScore: e.priorOrientation === t.orientation ? t.staticScore - 20 : t.staticScore, orientation: t.orientation, matches: t.matches } }); return l(t, d = e.enforceOrientation && "default" !== e.enforceOrientation ? a.filter(d, function (t) { return !!t.matches[e.enforceOrientation] }) : e.nakedLabel ? a.filter(d, function (t) { return "center" === t.orientation }) : e.keepOrientation && e.priorOrientation ? a.filter(d, function (t) { return t.orientation === e.priorOrientation }) : a.filter(d, function (t) { return "center" !== t.orientation })), d }, t.generateCandidatesForSegment = function (t, e) { for (var r, o, n = [], i = e.width, h = e.height, c = i / 2, s = h / 2, u = e.pt_x1, p = e.pt_y1, f = e.pt_x2, d = e.pt_y2, g = (d - p) / (f - u), _ = Math.atan2(d - p, f - u) + Math.PI / 2, m = 5 * Math.cos(_), x = 5 * Math.sin(_), v = Math.min(p, d) - Math.abs(x) - h, M = Math.max(p, d) + Math.abs(x), y = [0, 20, 20, 40, 40], b = [], S = 0, w = [.5, .4, .6, .2, .8]; S < w.length; S++) { var O = w[S]; b.push({ x: u * (1 - O) + f * O, y: p * (1 - O) + d * O }) } for (var I = 0; I < b.length; I++) { var C, P, F, k, A = b[I]; if (g >= 2 || g <= -2) { F = k = A.y - s; var q = Math.abs((f - u) / (d - p) * s) + Math.abs(m); C = A.x + q, P = A.x - q - i } else if (g <= .05 && g >= -.05) { C = P = A.x - c; var E = Math.abs(g * c) + Math.abs(x); F = A.y - E - h, k = A.y + E } else m > 0 ? (C = A.x + m, P = A.x - m - i) : (C = A.x + m - i, P = A.x - m), x > 0 ? (F = A.y + x, k = A.y - x - h) : (F = A.y + x - h, k = A.y - x); F < v ? F = v : F > M && (F = M), k < v ? k = v : k > M && (k = M); var G = (f - u) * (F - p) - (d - p) * (C - u) > 0, L = I.toString() + (G ? "-a" : "-b"); n.push({ pt_x: A.x, pt_y: A.y, left: C, top: F, staticScore: y[I], orientation: L, matches: (r = {}, r[L] = 1, r) }); var j = I.toString() + (G ? "-b" : "-a"); n.push({ pt_x: A.x, pt_y: A.y, left: P, top: k, staticScore: y[I], orientation: j, matches: (o = {}, o[j] = 1, o) }) } var D = n.map(function (t) { var a = Math.round(t.left), r = Math.round(t.left + i), o = Math.round(t.top), n = Math.round(t.top + h); return { pt_x: Math.round(t.pt_x), pt_y: Math.round(t.pt_y), left: a, right: r, top: o, bottom: n, width: r - a, height: n - o, staticScore: e.priorOrientation === t.orientation ? t.staticScore - 20 : t.staticScore, orientation: t.orientation, matches: t.matches } }); return e.keepOrientation && e.priorOrientation && (D = a.filter(D, function (t) { return t.orientation === e.priorOrientation })), l(t, D), D }, t.generateCandidatesForAngle = function (t, e) { var r, o = [], n = e.pt_x, i = e.pt_y, h = e.width, c = e.height, s = e.startAngle, u = e.endAngle; u < s && (u += 2 * Math.PI); var p = (s + u) / 2, f = e.isRightAngle ? e.radius * Math.sqrt(2) : e.radius + 4, d = f + Math.sqrt(e.width * e.width / 4 + e.height * e.height / 4), g = [], _ = d * Math.sin(p); _ > f + .5 * c && (_ = f + .5 * c), _ < -f - .5 * c && (_ = -f - .5 * c), g.push({ x: n + d * Math.cos(p) - h / 2, y: i + _ - c / 2 }); for (var m = 0; m < g.length; m++) { var x = g[m], v = m.toString() + "-a"; o.push({ pt_x: x.x, pt_y: x.y, left: x.x, top: x.y, staticScore: 0, orientation: v, matches: (r = {}, r[v] = 1, r) }) } var M = o.map(function (t) { var a = Math.round(t.left), r = Math.round(t.left + h), o = Math.round(t.top), n = Math.round(t.top + c); return { pt_x: Math.round(t.pt_x), pt_y: Math.round(t.pt_y), left: a, right: r, top: o, bottom: n, width: r - a, height: n - o, staticScore: e.priorOrientation === t.orientation ? t.staticScore - 20 : t.staticScore, orientation: t.orientation, matches: t.matches } }); return e.keepOrientation && e.priorOrientation && (M = a.filter(M, function (t) { return t.orientation === e.priorOrientation })), l(t, M), M }, t.generateCandidatesForPolygon = function (t, e) { for (var r = [], o = e.width, n = e.height, i = Math.round(10 / Math.sqrt(2)), h = 50, c = 0, s = 0, u = 0, p = 0; p < e.path.length - 2; p += 2)u += 1, c += e.path[p], s += e.path[p + 1]; var f = c / u, d = s / u; r.push({ left: f - o / 2, top: d - n / 2, staticScore: 0, orientation: "center", matches: { center: 1 } }), r.push({ left: f + 10 + 3, top: d - n / 2, staticScore: h, orientation: "right", matches: { right: 1 } }), r.push({ left: f - (10 + o) - 3, top: d - n / 2, staticScore: h, orientation: "left", matches: { left: 1 } }), r.push({ left: f - o / 2, top: d - (n + 10), staticScore: h, orientation: "top", matches: { top: 1 } }), r.push({ left: f - (o + i), top: d - (n + i), staticScore: h, orientation: "tl", matches: { tl: 1 } }), r.push({ left: f + i, top: d - (n + i), staticScore: h, orientation: "tr", matches: { tr: 1 } }), r.push({ left: f - o / 2, top: d + 10, staticScore: h, orientation: "bottom", matches: { bottom: 1 } }), r.push({ left: f - (o + i), top: d + i, staticScore: h, orientation: "bl", matches: { bl: 1 } }), r.push({ left: f + i, top: d + i, staticScore: h, orientation: "br", matches: { br: 1 } }); var g = r.map(function (t) { var a = Math.round(t.left), r = Math.round(t.left + o), i = Math.round(t.top), h = Math.round(t.top + n); return { pt_x: Math.round(f), pt_y: Math.round(d), left: a, right: r, top: i, bottom: h, width: r - a, height: h - i, staticScore: e.priorOrientation === t.orientation ? t.staticScore - 20 : t.staticScore, orientation: t.orientation, matches: t.matches } }); return e.keepOrientation && e.priorOrientation && (g = a.filter(g, function (t) { return t.orientation === e.priorOrientation })), l(t, g), g } });
define('core/math/interpolatedlabel', ["require", "exports", "parsenodes", "core/lib/label", "./policy", "core/math/types"], function (require, e, t, n, r, a) { "use strict"; function u(e) { if (e.length < 2) return "text"; var t = e.split("`").length - 1; return t < 2 ? "text" : 2 === t && "`" === e[0] && "`" === e[e.length - 1] ? "latex" : "mixed" } function i(e) { if (0 === e.length) return [""]; for (var t = [], n = e.split(/(`)/), r = !1, a = "", u = 0; u < n.length; u++) { var i = n[u]; i.length && ("`" === i ? (a += "`", (r = !r) || (t.push(a), a = "")) : (a += i, r || (t.push(a), a = ""))) } return a.length && t.push(a), t } function l(e) { for (var t, n = "\\$({" + ["[a-zA-Z][0-9]*", "[a-zA-Z]_[a-zA-Z0-9]+", "[a-zA-Z]_\\{[a-zA-Z0-9]+\\}", "\\\\[a-zA-Z]+", "\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}", "\\\\[a-zA-Z]+_[a-zA-Z0-9]+"].join("})|\\$({") + "})", r = new RegExp(n, "g"), a = [], u = 0, i = 0; t = r.exec(e);) { (i = t.index) > u && a.push(e.substr(u, i - u)); var l = t[0], s = l.replace(/[{}\$]/g, "").replace(/^([a-zA-Z])([0-9]+)$/, "$1_$2"); a.push({ symbol: s, str: l }), u = t.index + l.length } return u < e.length && a.push(e.substr(u)), { raw: e, parts: a } } function s(e, t) { return t ? "{" + n.truncatedLatexLabel(e, { bigCutoff: 1e7, digits: 8 }) + "}" : n.truncatedPlainmathLabel(e, { bigCutoff: 1e7, digits: 8 }) } Object.defineProperty(e, "__esModule", { value: !0 }), e.interpolate = e.parse = e.chunkLabel = e.classifyLabelText = void 0, e.classifyLabelText = u, e.chunkLabel = i, e.parse = function (e) { return i(e).map(l) }, e.interpolate = function (e, n, i) { return e.map(function (e) { return function (e, n, i) { for (var l = [], o = "latex" === u(e.raw), p = 0, f = e.parts; p < f.length; p++) { var c = f[p]; if ("string" == typeof c) l.push(c); else { var h = t.Identifier(c.symbol).tryGetConcreteTree(r.defaultPolicy, n); if (h.valueType === a.Number && 0 === h.getDependencies().length) { if ("number" == typeof (g = h.asValue())) { l.push(s(g, o)); continue } } else if (h.valueType === a.ListOfNumber && i < h.length && 0 === h.getDependencies().length) { var g; if ("number" == typeof (g = h.elementAt(i).asValue())) { l.push(s(g, o)); continue } } o ? l.push("{?}") : l.push("?") } } return l.join("") }(e, n, i) }).join("") } });

define('loadcss!dcgview-helpers/static-mathquill-view', function () { });
define('dcgview-helpers/static-mathquill-view', ["require", "exports", "tslib", "dcgview", "vendor/mathquill", "jquery", "lib/conditional_blur", "loadcss!./static-mathquill-view"], function (require, t, i, a, e, s, l) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return i.__extends(n, t), n.prototype.template = function () { var t = this; return 1 === this.children.length ? this.children[0] : a.createElement("div", { didMount: function (i) { return t.didMountMathquill(i) } }) }, n.prototype.didMount = function () { 1 === this.children.length && this.didMountMathquill(this.findRootNode()) }, n.prototype.didMountMathquill = function (t) { this.staticMath = e.MQ.StaticMath(t, i.__assign(i.__assign({}, this.props.config()), { mouseEvents: !1 })), s(t).addClass("dcg-static-mathquill-view").on("dcg-tapstart", function () { l.default() }), this.updateMathquill() }, n.prototype.didUpdate = function () { this.updateMathquill() }, n.prototype.updateMathquill = function () { this.updateMathquillAria(), this.updateMathquillLatex() }, n.prototype.updateMathquillLatex = function () { if (this.staticMath) { var t = this.props.latex(); this.lastLatex !== t && (this.staticMath.latex(t), this.lastLatex = t, this.props.onReflow && this.props.onReflow()) } }, n.prototype.updateMathquillAria = function () { if (this.staticMath && this.props.getAriaLabel) { var t = this.props.getAriaLabel(); t !== this.staticMath.getAriaLabel() && this.staticMath.setAriaLabel(t) } }, n }(a.Class); t.default = n });
define('core/lib/count-latex-tokens', ["require", "exports", "core/math/parser/latex-lexer"], function (require, e, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.countLatexTokens = void 0, e.countLatexTokens = function (e) { for (var t = r.lex(e), n = 0; !r.isDone(t);)n += 1, t = r.advance(t); return n } });

define('loadcss!dcgview-helpers/mathquill-view', function () { });
define('dcgview-helpers/mathquill-view', ["require", "exports", "tslib", "keys", "browser", "dcgview", "vendor/mathquill", "jquery", "./static-mathquill-view", "../core/lib/count-latex-tokens", "loadcss!./mathquill-view"], function (require, e, t, i, o, a, s, n, r, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.EXPRESSION_TOKEN_LIMIT = void 0; var l = a.Components.If; e.EXPRESSION_TOKEN_LIMIT = 500; var d = function (d) { function u() { var e = null !== d && d.apply(this, arguments) || this; return e.lastLatexProp = "", e.wasFocusedLastUpdate = !1, e } return t.__extends(u, d), u.prototype.template = function () { var e = this; return 1 === this.children.length ? this.children[0] : a.createElement("div", { class: a.const("dcg-mq-container") }, a.createElement(l, { predicate: function () { return e.getPlaceholder().trim().length > 0 } }, function () { return a.createElement("span", { class: a.const("dcg-mq-placeholder") }, a.createElement(r.default, { config: function () { return e.props.config() }, latex: function () { return e.getPlaceholder() } })) }), a.createElement("div", { class: function () { return { "dcg-math-field": !0, "dcg-no-fadeout": e.props.noFadeout && e.props.noFadeout(), "dcg-invalid": e.props.hasError(), "dcg-focus": e.props.isFocused() } }, didMount: function (t) { return e.didMountMathquill(t) }, "data-dcg-label": function () { return e.props.dataLabelAttributeValue ? e.props.dataLabelAttributeValue() : void 0 } })) }, u.prototype.didMount = function () { 1 === this.children.length && this.didMountMathquill(this.findRootNode()) }, u.prototype.willUnmount = function () { this.$mathField.off(".view"), this.mathField = void 0 }, u.prototype.getPlaceholder = function () { return this.props.placeholder ? this.props.isFocused() || this.props.latex() ? "" : this.props.placeholder() : "" }, u.prototype.didMountMathquill = function (e) { var a = this, r = t.__assign(t.__assign({}, this.props.config()), { handlers: { reflow: function (e) { a.props.onReflow && a.mathField && a.props.onReflow(e) } }, onCut: function () { a.mathField && a.props.onUserChangedLatex(a.mathField.latex()) }, onPaste: function () { a.mathField && a.props.onUserChangedLatex(a.mathField.latex()) }, overrideTypedText: function (e) { a.mathField && a.viewCanAcceptText(e) && (a.props.onUserTypedText ? a.props.onUserTypedText(e) : (a.mathField.typedText(e), a.props.onUserChangedLatex(a.mathField.latex()))) }, overrideKeystroke: function (e, t) { if ("Backspace" === e && t.preventDefault(), a.mathField) { if ("Spacebar" === e && a.props.disableSpace && a.props.disableSpace()) return t.preventDefault(); var o = i.lookup(t); if ("Up" === o || "Down" === o || "Left" === o || "Right" === o || "Esc" === o) { var s = []; t.ctrlKey && s.push("Ctrl"), t.metaKey && s.push("Meta"), t.altKey && s.push("Alt"), t.shiftKey && s.push("Shift"), s.length ? (s.push(o), e = s.join("-")) : e = o } a.props.onUserPressedKey ? a.props.onUserPressedKey(e, t) : (a.mathField.keystroke(e, t), a.props.onUserChangedLatex(a.mathField.latex())) } } }); this.props.needsSystemKeypad && this.props.needsSystemKeypad() && (r.substituteTextarea = function () { return n('<textarea autocorrect="off" autocapitalize="none" spellcheck="false" autocomplete="off">')[0] }), this.$mathField = n(e), this.mathField = s.MQ.MathField(e, r), e._mqMathFieldInstance = this.mathField, e._mqViewInstance = this, this.$mathField.on("focusin.view focusout.view", function (e) { return a.onFocusEvent(e) }).on("paste.view", function (e) { return a.onPasteEvent(e) }), (o.IS_IOS || o.IS_ANDROID) && this.$mathField.on("keypress.view", function (e) { return a.onKeypressEvent(e) }), this.hookupMQTapTouch(), this.updateMathquill() }, u.prototype.didUpdate = function () { this.updateMathquill() }, u.prototype.updateMathquill = function () { this.updateMathquillAria(), this.updateMathquillLatex(), this.updateMathquillFocused(), this.updateMathquillPostLabel() }, u.prototype.onFocusEvent = function (e) { var t = this.isFocused(); t !== this.shouldBeFocused() && this.props.onFocusedChanged(t, e) }, u.prototype.onPasteEvent = function (e) { var t = "", i = window.clipboardData, o = e.originalEvent; i && i.getData ? t = i.getData("Text") : o && o.clipboardData && o.clipboardData.getData && (t = o.clipboardData.getData("text/plain")); var a = this.viewCanAcceptText(t); return !a && this.props.onExpressionSizeExceeded && this.props.onExpressionSizeExceeded(), a }, u.prototype.viewCanAcceptText = function (e) { return u.canAcceptText(this.mathField, this.props.capExpressionSize(), e) }, u.canAcceptText = function (t, i, o) { if (!t) return !1; if (!i) return !0; var a = t.latex(); return p.countLatexTokens(a) + p.countLatexTokens(o) <= e.EXPRESSION_TOKEN_LIMIT }, u.prototype.onKeypressEvent = function (e) { if (e.stopPropagation(), e.preventDefault(), this.mathField) { var t = e.key && 1 === e.key.length ? e.key : void 0; t && this.viewCanAcceptText(t) && (this.props.onUserTypedText ? this.props.onUserTypedText(t) : (this.mathField.typedText(t), this.props.onUserChangedLatex(this.mathField.latex()))) } }, u.prototype.hookupMQTapTouch = function () { var e = this; this.$mathField.on("dcg-tap.view", function (t) { if ("touch" === t.device && e.mathField) { var i = t.changedTouches[0]; e.mathField.clickAt(i.clientX, i.clientY, i.target), e.isFocused() || e.mathField.focus(); var o = void 0; setTimeout(function () { o = Date.now() }, 0), e.mathField.ignoreNextMousedown(function () { return void 0 === o || Date.now() - o < 500 }) } }) }, u.prototype.updateMathquillAria = function () { if (this.mathField) { var e = this.props.getAriaLabel(); e !== this.mathField.getAriaLabel() && this.mathField.setAriaLabel(e) } }, u.prototype.updateMathquillPostLabel = function () { this.mathField && this.mathField.setAriaPostLabel(this.props.getAriaPostLabel(), this.props.hasError() ? 5e3 : 1e3) }, u.prototype.updateMathquillLatex = function () { var t = this.props.latex(); this.mathField && this.lastLatexProp !== t && (this.props.capExpressionSize() && p.countLatexTokens(t) > e.EXPRESSION_TOKEN_LIMIT || (this.lastLatexProp = t, this.mathField.latex() !== t && this.mathField.latex(t))) }, u.prototype.updateMathquillFocused = function () { if (this.mathField) { var e = this.isFocused(), t = this.shouldBeFocused(); t && t !== this.wasFocusedLastUpdate && this.props.selectOnFocus && this.props.selectOnFocus() && this.mathField.select(), this.wasFocusedLastUpdate = t, e !== t && (t ? this.mathField.focus() : this.mathField.blur()) } }, u.prototype.isFocused = function () { return !(!document.activeElement || !n(document.activeElement).closest(this.$mathField).length) }, u.prototype.shouldBeFocused = function () { return this.props.isFocused() }, u.getFocusedMathquill = function () { if (document.activeElement) { var e = n(document.activeElement).closest(".dcg-mq-editable-field")[0]; return e ? e._mqMathFieldInstance : void 0 } }, u.getMQViewInstance = function (e) { var t = e.el(); return t ? t._mqViewInstance : void 0 }, u.applyArrowKeyAndReturnIfWasAtBounds = function (e, t, i) { var o = e.selection(), a = 0 === o.startIndex && o.endIndex === o.latex.length; if (("Up" === t || "Down" === t) && a) return e.keystroke(t, i), !0; e.keystroke(t, i); var s = e.selection(); return !(s.latex !== o.latex || s.startIndex !== o.startIndex || s.endIndex !== o.endIndex) }, u.simulateKeypress = function (e, t) { var i = u.getMQViewInstance(e); i && (i.props.onUserPressedKey ? i.props.onUserPressedKey(t) : (e.keystroke(t), i.props.onUserChangedLatex(e.latex()))) }, u.simulateUserChangedLatex = function (e) { var t = u.getMQViewInstance(e); t && t.mathField && t.props.onUserChangedLatex(t.mathField.latex()) }, u.handleKeystrokeAndDecideIfSpecialEvent = function (e, t, i) { return "Enter" === t || ("Delete" === t && "" === e.latex() || ("Backspace" === t && "" === e.latex() || ("Up" === t || "Down" === t || "Left" === t || "Right" === t ? u.applyArrowKeyAndReturnIfWasAtBounds(e, t, i) : (e.keystroke(t, i), !1)))) }, u }(a.Class); e.default = d });
define('graphing/poilabelslayer', ["require", "exports", "core/vendor/d3-color", "tslib", "dcgview", "jquery", "core/lib/label", "core/types/graphmode", "core/types/point-size", "core/math/poi-type", "./constants", "./poi", "./automatic-label-placer", "core/lib/color-helpers", "core/math/interpolatedlabel", "../dcgview-helpers/static-mathquill-view", "../dcgview-helpers/mathquill-view", "core/graphing-calc/json/expression", "graphing-calc/models/expression", "graphing-calc/models/abstract-item", "graphing/canvas-labels", "graphing/movablepointslayer", "./svg-groups", "main/mathquill-operators", "core/types/point-opacity"], function (require, e, t, r, o, a, n, i, l, c, s, d, h, p, u, b, g, f, v, y, L, m, x, I, O) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var E = o.Components.Input, C = o.Components, k = C.For, S = C.Switch, P = C.IfElse; function M(e, t, r) { var o = e.s("graphing-calculator-label-poi-unknown"), a = t.getProjection(); if (!a) return o; var n = a.viewport; return n ? (r && (o = m.getCoordsString(r.x, r.y, n)), o) : o } var D = function (e) { function m() { var t = null !== e && e.apply(this, arguments) || this; return t.labelsDirty = !1, t } return r.__extends(m, e), m.prototype.init = function () { this.grapher = this.props.grapher(), this.controller = this.grapher.controller, this.cachedLabelDict = {}, this.cachedLabelOrder = [], this.hoveredPOI = void 0, this.openedPOI2Sketch = {}, this.takingScreenshot = !1 }, m.prototype.template = function () { var e = this; return o.createElement(k, { each: function () { return e.cachedLabelOrder } }, o.createElement("div", { class: o.const("dcg-graph-outer"), style: this.const({ "z-index": 0 }), didMount: this.didMountRoot.bind(this) }, function (t) { return o.createElement("div", { class: function () { return e.getLabelClasses(t) }, style: function () { return e.getLabelStyles(t) } }, o.createElement("div", { class: o.const("dcg-pt"), style: function () { return e.getDotStyles(t) } }), o.createElement("div", { class: o.const("dcg-label"), didMount: function (r) { return e.linkLabelNode(t, r) } }, e.renderLabelContent(t))) })) }, m.prototype.renderLabelContent = function (e) { var t = this; return o.createElement(S, { key: function () { return t.getLabelContent(e).type } }, function (r) { return "text" === r ? o.createElement("span", { class: o.const("dcg-label-raw-text") }, function () { return t.getLabelContent(e).text }) : "latex" === r ? o.createElement(b.default, { latex: function () { return t.getLabelContent(e).text }, config: t.bindFn(t.getMQConfig) }) : "mixed" === r ? o.createElement(k, { each: function () { return u.chunkLabel(t.getLabelContent(e).text) }, key: function (e, t) { return "" + e + t } }, o.createElement("span", null, function (e) { return P(function () { return "latex" === u.classifyLabelText(e) }, { true: function () { return o.createElement(b.default, { latex: function () { return e.substr(1, e.length - 2) }, config: t.bindFn(t.getMQConfig) }) }, false: function () { return o.createElement("span", { class: o.const("dcg-label-raw-text") }, function () { return e }) } }) })) : r === f.EditableLabelMode.Math ? o.createElement("div", { class: function () { return { "dcg-editable-label-border": !0, "dcg-do-not-blur": !0, "dcg-focus": t.shouldEditableLabelBeFocused(e), "dcg-empty-label": 0 === t.getEditableLabelText(e).trim().length } }, style: function () { return { "border-color": p.shadeColor(t.getEditableLabelTextColor(e), .3) } } }, o.createElement(g.default, { latex: function () { return t.getEditableLabelText(e) }, placeholder: function () { return "" }, isFocused: function () { return t.shouldEditableLabelBeFocused(e) }, capExpressionSize: function () { return !!t.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: o.const(!1), config: t.bindFn(t.getMQConfig), getAriaLabel: function () { return t.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates", { coordinates: M(t.controller, t.grapher, t.cachedLabelDict[e]) }) }, getAriaPostLabel: t.const(""), onUserChangedLatex: function (r) { return t.onLabelInput(r, e) }, onExpressionSizeExceeded: function () { return t.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (r) { return t.onEditableLabelFocusChange(r, e) }, hasError: t.const(!1), noFadeout: t.const(!0), needsSystemKeypad: function () { return !t.controller.isKeypadEnabled() } })) : o.createElement("div", { class: function () { return { "dcg-resizing-text-input-container": !0, "dcg-editable-label-border": !0, "dcg-focus": t.shouldEditableLabelBeFocused(e), "dcg-empty-label": 0 === t.getEditableLabelText(e).trim().length } }, style: function () { return { "border-color": p.shadeColor(t.getEditableLabelTextColor(e), .3) } }, onScroll: function (e) { e.target && (e.target.scrollLeft = 0) } }, o.createElement(E, { "aria-label": function () { return t.controller.s("graphing-calculator-narration-editable-point-label-at-coordinates", { coordinates: M(t.controller, t.grapher, t.cachedLabelDict[e]) }) }, onInput: function (r) { return t.onLabelInput(r, e) }, value: function () { return t.getEditableLabelText(e) }, onFocus: function () { return t.onEditableLabelFocusChange(!0, e) }, onBlur: function () { return t.onEditableLabelFocusChange(!1, e) } }), o.createElement("span", { class: o.const("dcg-text-input-content") }, function () { return t.getEditableLabelText(e) || " " })) }) }, m.prototype.getSketchIdFromLabelId = function (e) { var t = this.cachedLabelDict[e]; if (t) return t.sketchId }, m.prototype.getEditableLabelTextColor = function (e) { var t = this.getSketchIdFromLabelId(e); if (!t) return "#000"; var r = this.controller.getItemModel(t); return r && "expression" === r.type ? y.getDisplayColor(r) : "#000" }, m.prototype.onEditableLabelFocusChange = function (e, t) { var r = this.getSketchIdFromLabelId(t); r && (e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "editable-label", id: r } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "editable-label", id: r } }), this.update()) }, m.prototype.shouldEditableLabelBeFocused = function (e) { var t = this.getSketchIdFromLabelId(e), r = this.controller.getFocusLocation(); return !(!r || "editable-label" !== r.type || !t || r.id !== t) }, m.prototype.onLabelInput = function (e, t) { var r = this.getSketchIdFromLabelId(t); if (r) { var o = this.controller.getItemModel(r); if (o && "expression" === o.type) { var a = e; this.controller.getItemEditableLabelMode(r) === f.EditableLabelMode.Math && a.length > 0 && (a = "`" + a + "`"), this.controller.dispatch({ type: "set-item-label", id: r, label: a }) } } }, m.prototype.getEditableLabelText = function (e) { var t = this.getSketchIdFromLabelId(e); if (!t) return ""; var r = this.controller.getItemModel(t); return r && "expression" === r.type ? this.controller.getItemEditableLabelMode(t) === f.EditableLabelMode.Math ? r.label.substr(1, r.label.length - 2) : r.label : "" }, m.prototype.linkLabelNode = function (e, t) { var r = this.cachedLabelDict[e]; r && (r.labelDOM = t) }, m.prototype.getLabelClasses = function (e) { var t = this.cachedLabelDict[e]; return t ? t.classes : {} }, m.prototype.getLabelStyles = function (e) { var t = this.cachedLabelDict[e]; return t ? t.styles : {} }, m.prototype.getDotStyles = function (e) { var t = this.cachedLabelDict[e]; return t ? t.dotStyles : {} }, m.prototype.getLabelContent = function (e) { var t = this.cachedLabelDict[e]; if (t) { var r = this.getSketchIdFromLabelId(e); if (!r) return { is_hole: !1, type: "text", text: "" }; var o = this.controller.getItemEditableLabelMode(r); return t.classes["dcg-editable-label"] && void 0 !== o && o !== f.EditableLabelMode.None ? { is_hole: !1, type: o, text: "" } : t.content } return { is_hole: !1, type: "text", text: "" } }, m.prototype.didMountRoot = function (e) { this.node = e }, m.prototype.computeHoveredLabel = function (e, t) { var r; this.hoveredPOI ? this.isOpenPOI(this.hoveredPOI) ? this.grapher.setLayerClass("hoveredPOI", "dcg-mouse-over-opened-poi") : (r = this.computeLabel(this.hoveredPOI, e, t, "hovered"), this.grapher.setLayerClass("hoveredPOI", "dcg-mouse-over-closed-poi")) : this.grapher.setLayerClass("hoveredPOI", void 0); var o = this.getHoveredInteractiveLabel(); o && !o.bareLabel ? this.grapher.setLayerClass("interactiveLabel", "dcg-mouse-over-opened-poi") : this.grapher.setLayerClass("interactiveLabel", void 0), r && this.saveLabelToCache(r) }, m.prototype.computeTraceLabel = function (e, t) { if (this.traceInfo) { var r = this.traceInfo.pt; if (r) { var o = new d.POI(r.x, r.y, c.TRACE, this.traceInfo.branchInfo.sketch, this.traceInfo.branchInfo.branch, 0), a = this.computeLabel(o, e, t, "trace"); a && this.saveLabelToCache(a) } } }, m.prototype.computeLabel = function (e, r, o, a) { var l = e.id + ""; "trace" === a && (l = "*trace*"); var d = r.mapx(e.x), h = r.mapy(e.y), p = d, b = h; if (r.coordsAreOnscreen(d, h, s.OFFSCREEN_RENDER_MARGIN)) { if (this.isHiddenInteractiveLabel(e)) return; var g = !1, f = void 0, y = e.sketch, L = y && y.branches[0]; L && (g = !(!("nakedLabel" in L) || !L.nakedLabel), f = "labelOrientation" in L ? L.labelOrientation : void 0); var m = y.id, x = this.controller.getItemModel(m); if (e.hasEditableLabel() && x && "expression" === x.type && !v.isSinglePoint(x)) return; var I = function (e, t) { var r, o = t.xmax - t.xmin, a = t.ymax - t.ymin, l = e.getGraphMode(); if (e.type === c.TRACE) { var s = l === i.X, d = s ? e.y : e.x, h = e.getCompiledFunction(); if (r = n.point(d, o, a, h), s) { var p = r[0]; r[0] = r[1], r[1] = p } } else r = [n.value(e.x, o), n.value(e.y, a)]; var b = !isFinite(r[1].value), g = e.getLabel(), f = g && u.classifyLabelText(g); if (g) return "latex" === f ? { is_hole: b, type: "latex", text: g.substr(1, g.length - 2) } : "text" === f ? { is_hole: b, type: "text", text: g } : { is_hole: b, type: "mixed", text: g }; if (e.hasEditableLabel()) return { is_hole: b, type: "text", text: "" }; var v = r[0].superscript ? r[0].mantissa + "^{" + r[0].superscript + "}" : r[0].string, y = r[1].superscript ? r[1].mantissa + "^{" + r[1].superscript + "}" : r[1].string; return "undefined" === v && (v = "\\mathrm{undefined}"), "undefined" === y && (y = "\\mathrm{undefined}"), { is_hole: b, type: "latex", text: "\\left(" + v + ",\\space " + y + "\\right)" } }(e, r.viewport), E = e.pointIdxOnBranch, C = e.getLabelSize(); Array.isArray(C) && (C = C[E]); var k = e.getLabelRotation(); Array.isArray(k) && (k = k[E]); var S = e.getPointOpacity(); S = Array.isArray(S) ? S[E] : S, S = isFinite(S) ? Math.max(0, Math.min(1, S)) : O.DEFAULT; var P = !!e.getTextOutline(), M = e.isPersistent(), D = e.isAttachedToPlottedPoint(), F = e.hasInteractiveLabel(), T = e.hasEditableLabel() && !this.takingScreenshot, w = !(!x || "expression" !== x.type || !v.isClickableObject(x)), A = y.color; if (w) { var _ = this.grapher.clickableObjectsLayer.getHoveredObject(), B = this.grapher.clickableObjectsLayer.getPressedObject(); if (B && B.id === m && B.listIndex === e.pointIdxOnBranch) (H = t.hsl(A)).l > .2 ? H.l -= .2 : H.l += .1, A = H.toString(); else if (_ && _.id === m && _.listIndex === e.pointIdxOnBranch) { var H; (H = t.hsl(A)).l > .2 ? H.l -= .1 : H.l += .2, A = H.toString() } } var R = !M, j = !!D; F && (j = !0, R = !0), "trace" === a && (j = !1, R = !0); var z = o[l], N = z && z.labelDOM, X = z && z.width, Y = z && z.height, q = z && z.orientation, G = { "dcg-poi-label": !0, "dcg-tracept": "trace" === a, "dcg-opened": "opened" === a, "dcg-hole": I.is_hole, "dcg-show-border": R, "dcg-hide-dot": j, "dcg-editable-label": T, "dcg-has-outline": P, "dcg-underlined-label": !!(w && x && "expression" === x.type && x.hidden) }; isFinite(C) || (C = 1); var U = { left: d + "px", top: h + "px", "font-size": Math.round(1100 * C) / 10 + "%" }; k && !this.takingScreenshot && (U.transform = "rotate(" + k + "rad)"), M && A && (U.color = A), U.opacity = "" + Math.min(.99, S); var Q = {}; return "trace" === a && (Q["background-color"] = A, Q["border-color"] = A), { id: l, sketchId: m, poi: e, x: e.x, y: e.y, screenX: d, screenY: h, top: b, left: p, width: X, height: Y, labelDOM: N, forcedOrientation: f, isNakedLabel: g, isClickable: w, orientation: q, rotation: k, classes: G, styles: U, dotStyles: Q, content: I, hasBorder: e.hasEditableLabel(), opacity: S, hasOutline: P || e.hasEditableLabel() } } }, m.prototype.computeAllLabels = function (e, t) { var r, o, a = this, n = this.grapher.graphSketches; this.grapher.getSketchOrder().forEach(function (r) { var i = n[r]; if (i && i.visible) { var l = i.labels; if (l.length) for (var c = 0; c < l.length; c++)(o = a.computeLabel(l[c], e, t, "opened")) && (Array.isArray(i.color) && (o.styles.color = i.color[c]), a.saveLabelToCache(o)) } }); var i, l, c = {}; for (r in this.openedPOI2Sketch) { var s = (i = r, (l = n[this.openedPOI2Sketch[r]]) && l.visible ? l.getPOIById(i) : null); s && (c[r] = s.sketch.id, (o = this.computeLabel(s, e, t, "opened")) && this.saveLabelToCache(o)) } return this.openedPOI2Sketch = c, {} }, m.prototype.saveLabelToCache = function (e) { var t = e.id; this.cachedLabelDict[t] || this.cachedLabelOrder.push(t), this.cachedLabelDict[t] = e }, m.prototype.markLabelsDirty = function () { this.labelsDirty = !0 }, m.prototype.getInteractiveLabelUnderPoint = function (e) { for (var t, r = this.cachedLabelOrder.length - 1; r >= 0; r--) { var o = this.cachedLabelOrder[r], a = this.cachedLabelDict[o]; if (a && a.width && a.height) { var n = a.screenX, i = a.screenY, l = a.left, c = a.top, s = a.width, d = a.height; if (s > 0 && d > 0 && e.x > n + l && e.x < n + l + s && e.y > i + c && e.y < i + c + d) { var h = this.getSketchIdFromLabelId(o); if (void 0 === h) continue; var p = this.controller.getItemModel(h); if (!p || "expression" !== p.type) continue; if (v.hasEditableLabel(p)) return { type: "editable", model: p }; !t && v.isDraggableAndHidden(p) ? t = { type: "draggable", label: { model: p, x: a.x, y: a.y } } : !t && a.isClickable && (t = { type: "clickable", model: p, poi: a.poi }) } } } return t }, m.prototype.positionLabels = function (e, t, r, o, n) { var i = this, c = !this.labelsDirty; this.labelsDirty = !1; var s = []; t.forEach(function (e) { var t = r[e]; if (t && t.labelDOM) { var o, a = i.getSketchIdFromLabelId(e); if (void 0 !== a) { var n = i.grapher.getGraphSketch(a); n && n.branches && (o = n.branches[0].pointSize) } (void 0 === o || "number" != typeof o || o < 0) && (o = l.DEFAULT); var d = (i.grapher.settings.config.projectorMode ? 14 : 10) * o / l.DEFAULT, h = t.screenX, p = t.screenY, u = t.labelDOM.clientWidth, b = t.labelDOM.clientHeight; if (u > 0 && b > 0) { var g = 0; i.takingScreenshot && t.hasBorder && (g = 5), s.push({ renderedLabel: t, pt_x: h, pt_y: p, pt_radius: d + g, rotation: t.rotation, nakedLabel: t.isNakedLabel, width: u, height: b, keepOrientation: c, priorOrientation: t.orientation, enforceOrientation: t.forcedOrientation }) } } }); var d = h.buildStaticEnvGetter(e, o, n), p = s.map(function (e) { return h.generateCandidatesForPoint(d, e) }); h.computePositions(p).forEach(function (e, t) { var r = s[t].renderedLabel; r.orientation = e.orientation; var o = e.left - e.pt_x, n = e.top - e.pt_y; r.left = o, r.top = n, r.width = e.width, r.height = e.height; var i = r.labelDOM; i && (i.style.transform = e.transform, a(i).data("orientation", e.orientation), setTimeout(function () { return i.classList.add("dcg-enable-transition") }, 1)) }) }, m.prototype.copyToCtx = function (e) { var t = this; x.save(e, "labels"); var r = this.node.getBoundingClientRect(); this.cachedLabelOrder.forEach(function (o) { var a = t.cachedLabelDict[o]; if (a) { var n = a.labelDOM; if (n) { var i = { pointCenterX: a.screenX - r.left, pointCenterY: a.screenY - r.top, hasOutline: !!a.hasOutline, hasBorder: !!a.hasBorder }, l = t.computeRotatedCenter(i.pointCenterX, i.pointCenterY, a.rotation), c = L.computeDrawingCommandsForDOMLabel(n, i); e.save(), e.globalAlpha = a.opacity, e.rotate(a.rotation), e.translate(l.x, l.y), L.drawCommandsToCtx(c, e), e.restore() } } }), x.restore(e) }, m.prototype.computeRotatedCenter = function (e, t, r) { var o = Math.cos(-r), a = Math.sin(-r); return { x: e * o - t * a, y: t * o + e * a } }, m.prototype.drawForScreenshot = function (e, t, r, o, a) { this.takingScreenshot = !0, this.redraw(e, t, o, a), this.takingScreenshot = !1, this.copyToCtx(r) }, m.prototype.redraw = function (e, t, r, o) { var a = this.cachedLabelDict; this.cachedLabelDict = {}, this.cachedLabelOrder = [], this.computeAllLabels(e, a), this.computeHoveredLabel(e, a), this.computeTraceLabel(e, a), this.update(), this.positionLabels(t, this.cachedLabelOrder, this.cachedLabelDict, r, o) }, m.prototype.clearOpenedPOI = function () { this.openedPOI2Sketch = {} }, m.prototype.closePOI = function (e) { delete this.openedPOI2Sketch[e.id] }, m.prototype.openPOI = function (e) { this.openedPOI2Sketch[e.id] = e.sketch.id }, m.prototype.isOpenPOI = function (e) { return this.openedPOI2Sketch.hasOwnProperty(e.id) }, m.prototype.isOpenInteractiveLabel = function (e) { return !!this.isOpenPOI(e) && e.hasInteractiveLabel() }, m.prototype.isHiddenInteractiveLabel = function (e) { return !!e && (!!e.hasInteractiveLabel() && (!this.isOpenPOI(e) && this.getHoveredPOI() !== e)) }, m.prototype.setHoveredPOI = function (e) { this.hoveredPOI = e }, m.prototype.getHoveredPOI = function () { return this.hoveredPOI }, m.prototype.getHoveredInteractiveLabel = function () { var e = this.getHoveredPOI(); return e && e.hasInteractiveLabel() ? e : void 0 }, m.prototype.setTraceInfo = function (e) { this.traceInfo = e }, m.prototype.isTracing = function () { return !!this.traceInfo }, m.prototype.getTraceInfo = function () { return this.traceInfo }, m.prototype.getMQConfig = function () { return { autoOperatorNames: I.getAutoOperators() } }, m }(o.Class); e.default = D });
define('graphing/imagelayer', ["require", "exports", "tslib", "jquery", "dcgview", "underscore", "./draw-image-to-ctx", "./svg-groups", "graphing-calc/models/image", "core/lib/label", "keys", "lib/aria", "./movablepointslayer", "lib/mathspeak"], function (require, e, t, r, i, a, n, o, s, d, l, c, g, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var h = i.Components.For, u = function (e) { function u() { return null !== e && e.apply(this, arguments) || this } return t.__extends(u, e), u.prototype.init = function () { this.grapher = this.props.grapher(), this.controller = this.grapher.controller, this.renderedTabTargetOrder = [], this.renderedTabTargets = {} }, u.prototype.template = function () { var e = this; return i.createElement(h, { each: function () { return e.renderedTabTargetOrder } }, i.createElement("div", { class: i.const("dcg-graph-outer"), style: this.const({ "z-index": 0 }), onFocusin: this.bindFn(this.handleFocusChange), onFocusout: this.bindFn(this.handleFocusChange), onKeydown: this.bindFn(this.handleKeydown), didMount: function (t) { return e.rootNode = t } }, function (t) { return i.createElement("div", { class: i.const("dcg-tabbable-draggableimage"), style: function () { return e.getStyle(t) }, role: i.const("button"), "aria-roledescription": function () { return e.controller.s("graphing-calculator-narration-draggable-image-description") }, "dcg-draggableimage-id": e.const(t), tabindex: function () { return e.getTabIndex() }, "aria-hidden": e.bindFn(e.getAriaHidden), "aria-label": function () { return e.getAriaLabel(t) } }) })) }, u.prototype.redrawToCtx = function (e, t, r, i) { this.renderedTabTargets = {}, this.renderedTabTargetOrder = [], o.save(e, "background-images"), (void 0 === i || i.length < a.size(r)) && (i = a.keys(r)); for (var d = 0, l = i; d < l.length; d++) { var c = l[d], g = r[c]; g && g.shouldGraph && !g.foreground && n.drawImageToCtx(g, e, t); var p = this.controller.getItemModel(c); if (p && "image" === p.type && !p.hidden && s.isActuallyDraggable(p)) { var h = p.formula.dimensions; if (!(h && h.x && h.y && h.width && h.height && h.radianAngle)) continue; for (var u = 0; u < h.x.length; u++)if (isFinite(h.x[u]) && isFinite(h.y[u]) && isFinite(h.width[u]) && isFinite(h.height[u]) && isFinite(h.radianAngle[u])) { this.renderedTabTargetOrder.push(c), this.renderedTabTargets[c] = { id: c, description: this.getComputedDescription(p, u), x: h.x[u], y: h.y[u], radianAngle: h.radianAngle[u], width: h.width[u], height: h.height[u], widthScale: Math.abs(t.mapx(1) - t.mapx(0)), heightScale: Math.abs(t.mapy(1) - t.mapy(0)), screenX: t.mapx(h.x[u]), screenY: t.mapy(h.y[u]), centerId: p.formula.center_reference_id }; break } } } o.restore(e), this.update(), this.speakAriaAlert() }, u.prototype.getStyle = function (e) { var t = this.renderedTabTargets[e]; if (t) { var r = t.screenX, i = t.screenY, a = t.radianAngle, n = t.width, o = t.height, s = t.widthScale, d = t.heightScale, l = d / s, c = n * s, g = o * d / l; return { position: "absolute", top: 0, left: 0, transform: "translate(" + (r - c / 2) + "px, " + (i - g / 2) + "px)" + (1 === l ? "" : " scale(1," + l + ")") + (a ? " rotate(" + a + "rad)" : ""), width: c + "px", height: g + "px" } } }, u.prototype.getTabIndex = function () { var e = this.grapher.settings; return e.config.graphpaper && e.config.enableTabindex ? 0 : -1 }, u.prototype.getAriaHidden = function () { return !this.grapher.settings.config.graphpaper }, u.prototype.getComputedDescription = function (e, t) { var r = e.formula && e.formula.computed_description && e.formula.computed_description[t]; return r && "" !== r ? p.getMathspeakFromText(r) : this.grapher.getAudioTrace().getExpressionAriaLabel(e.id) }, u.prototype.getAriaLabel = function (e) { var t = this.getAriaAlert({ id: e, includeUsageInstructions: !1 }); return t && t.completeMessage }, u.prototype.speakAriaAlert = function () { var e = this.focusedId; if (e && !this.renderedTabTargets[e]) return; var t = this.getAriaAlert({ id: e, lastAriaAlert: this.lastAriaAlert, includeUsageInstructions: !0 }); this.lastAriaAlert = t, t && t.completeMessage && c.alert(t.completeMessage) }, u.prototype.getAriaAlert = function (e) { var t = e.id, r = e.lastAriaAlert, i = e.includeUsageInstructions; if (t) { var a = this.controller.getItemModel(t); if (a && "image" === a.type) { var n = this.renderedTabTargets[t]; if (n) { r && r.id !== t && (r = void 0); var o = r && r.label, s = n.description, d = o !== s, l = r && r.coordX, c = r && r.coordY, p = n.x, h = n.y, u = p !== l || h !== c, f = this.grapher.getProjection(), m = g.getCoordsString(p, h, f.viewport) + ".", y = s, b = i ? this.controller.s("graphing-calculator-narration-movable-point-suffix-usage-instructions") : "", v = this.isImageFullyVisible(a, f) ? "" : this.controller.s("graphing-calculator-narration-draggable-image-off-screen-prompt"); return { id: t, coordX: p, coordY: h, label: s, completeMessage: r ? d ? y + v : u ? m + v : "" : y + ". " + m + b + v } } } } }, u.prototype.handleFocusChange = function () { var e = void 0; document.activeElement && r.contains(this.rootNode, document.activeElement) && (e = r(document.activeElement).attr("dcg-draggableimage-id")); this.focusedId !== e && (this.focusedId = e, this.lastAriaAlert = void 0, this.requestRedrawNextFrame()) }, u.prototype.requestRedrawNextFrame = function () { this.grapher.redrawAllLayers() }, u.prototype.handleKeydown = function (e) { if (this.focusedId) { var t = this.renderedTabTargets[this.focusedId]; if (t) { var r = l.lookup(e), i = l.lookupChar(e); "Up" === r || "Down" === r || "Left" === r || "Right" === r ? (e.stopPropagation(), e.preventDefault(), this.moveImageFromKeyboard(t, e)) : "X" !== i && "Y" !== i && "L" !== i || this.speakImageAttribute(t, i) } } }, u.prototype.moveImageFromKeyboard = function (e, t) { if (void 0 !== e && void 0 !== e.centerId) { var r, i = this.grapher.getProjection(), a = i.map_pt({ x: e.x, y: e.y }), n = 0, o = 0, s = t.shiftKey ? 10 : 2, d = t.shiftKey ? "big" : "", c = l.lookup(t); if ("Up" === c ? (r = "y", o -= s, d += "up") : "Down" === c ? (r = "y", o += s, d += "down") : "Left" === c ? (r = "x", n -= s, d += "down") : "Right" === c && (r = "x", n += s, d += "up"), (0 !== n || 0 !== o) && "" !== d) { var g = { x: a.x + n, y: a.y + o }, p = {}; "x" === r || this.hasNonlinearMoveStrategy(e.centerId) ? p = { x: d } : "y" === r && (p = { y: d }), this.controller.dispatch({ type: "on-move-point", pointInfo: { sketch: { id: e.centerId } }, screenPt: g, previousScreenPt: a, projection: i, keyboardDirection: p }) } } }, u.prototype.speakImageAttribute = function (e, t) { if (e && this.grapher.getAudioTrace()) { var r = this.grapher.getProjection(); if (r) { var i = r.viewport; switch (t) { case "X": c.alert("X: " + d.value(e.x, i.xmax - i.xmin).ariaString); break; case "Y": c.alert("Y: " + d.value(e.y, i.ymax - i.ymin).ariaString); break; case "L": c.alert(e.description) } } } }, u.prototype.hasNonlinearMoveStrategy = function (e) { if (!e) return !1; var t = this.controller.getItemModel(e); if (!t || "expression" !== t.type || !t.formula) return !1; var r = t.formula.move_strategy; return !(!r || !r[0]) && "updateSliderNonlinear" === r[0].type }, u.prototype.isImageFullyVisible = function (e, t) { var r = e.formula.dimensions; if (!r || !r.x || !r.y) return !1; for (var i = 0; i < r.x.length; i++)if (!t.coordsAreOnscreen(t.mapx(r.x[i]), t.mapy(r.y[i]))) return !1; return !0 }, u }(i.Class); e.default = u });
define('graphing/clickableobject-layer', ["require", "exports", "tslib", "dcgview", "core/types/graphmode", "jquery", "graphing-calc/models/expression", "graphing-calc/models/image", "lib/mathspeak"], function (require, e, t, r, i, s, n, o, d) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var c = r.Components.For; function a(e, t) { return void 0 === t && (t = 0), e + "i" + t } var h = function (e) { function h() { return null !== e && e.apply(this, arguments) || this } return t.__extends(h, e), h.prototype.init = function () { this.grapher = this.props.grapher(), this.controller = this.grapher.controller, this.renderedTabTargetOrder = [], this.renderedTabTargets = {} }, h.prototype.template = function () { var e = this; return r.createElement(c, { each: function () { return e.renderedTabTargetOrder } }, r.createElement("div", { class: r.const("dcg-graph-outer"), style: this.const({ "z-index": 0 }), onFocusin: this.bindFn(this.handleFocusChange), onFocusout: this.bindFn(this.handleFocusChange), didMount: function (t) { return e.rootNode = t } }, function (t) { return r.createElement("div", { class: r.const("dcg-tabbable-clickableobject"), role: r.const("button"), "aria-roledescription": function () { return e.controller.s("graphing-calculator-narration-clickable-object-description") }, "dcg-clickableobject-id": function () { return e.getModelId(t) }, tabindex: function () { return e.getTabIndex(t) }, "aria-hidden": e.bindFn(e.getAriaHidden), "aria-label": function () { return e.getCachedDescription(t) }, onTap: function () { e.controller.dispatch({ type: "clickable-item-clicked", id: e.getModelId(t), listIndex: e.getListIndex(t) }) } }) })) }, h.prototype.redraw = function () { var e = this; this.renderedTabTargets = {}, this.renderedTabTargetOrder = []; for (var t = this.grapher.getSketchOrder(), r = function (t) { var r = s.controller.getItemModel(t); if (!r) return "continue"; var d = s.grapher.getGraphSketch(t), c = s.grapher.getGraphImage(t); if (d && d.visible && "expression" === r.type && n.isClickableObject(r)) for (var a = function (t) { var n = d.branches[t]; if (!n.segments || 0 === n.segments.length) return "continue"; var o = 0; n.graphMode === i.XYPOINT || n.graphMode === i.XYPOINT_MOVABLE ? d.getBranchPOI(t).forEach(function (t) { o = t.pointIdxOnBranch || 0, isFinite(t.x) && isFinite(t.y) && e.addClickableObjectToDom(r, o) }) : (o = "listIndex" in n && void 0 !== n.listIndex ? n.listIndex : 0, n.segments.length > 0 && s.addClickableObjectToDom(r, o)) }, h = 0; h < d.branches.length; h++)a(h); else if (c && c.shouldGraph && "image" === r.type && o.isClickableObject(r)) { var p = r.formula && r.formula.dimensions; if (!(p && p.x && p.y && p.width && p.height && p.radianAngle)) return "continue"; for (h = 0; h < p.x.length; h++)isFinite(p.x[h]) && isFinite(p.y[h]) && isFinite(p.width[h]) && isFinite(p.height[h]) && isFinite(p.radianAngle[h]) && s.addClickableObjectToDom(r, h) } }, s = this, d = 0, c = t; d < c.length; d++) { r(c[d]) } this.hoveredObject && !this.renderedTabTargets[a(this.hoveredObject.id, this.hoveredObject.listIndex)] && this.setHoveredObject(void 0), this.pressedObject && !this.renderedTabTargets[a(this.pressedObject.id, this.pressedObject.listIndex)] && this.setPressedObject(void 0), this.hoveredObject || this.pressedObject ? this.grapher.setLayerClass("clickableObjects", "dcg-mouse-over-clickable-object") : this.grapher.setLayerClass("clickableObjects", void 0), this.update() }, h.prototype.addClickableObjectToDom = function (e, t) { var r = a(e.id, t); -1 === this.renderedTabTargetOrder.indexOf(r) && void 0 === this.renderedTabTargets[r] && (this.renderedTabTargetOrder.push(r), this.renderedTabTargets[r] = { type: e.type, id: e.id, listIndex: t, description: this.getComputedDescription(e, t) }) }, h.prototype.getTabIndex = function (e) { if (!this.renderedTabTargets[e]) return -1; var t = this.grapher.settings; return t.config.graphpaper && t.config.enableTabindex ? 0 : -1 }, h.prototype.getAriaHidden = function () { return !this.grapher.settings.config.graphpaper }, h.prototype.getCachedDescription = function (e) { return this.renderedTabTargets[e].description }, h.prototype.getComputedDescription = function (e, t) { var r = e.formula && e.formula.computed_description && e.formula.computed_description[t]; return r && "" !== r ? d.getMathspeakFromText(r) : this.grapher.getAudioTrace().getExpressionAriaLabel(e.id) }, h.prototype.getModelId = function (e) { var t = this.renderedTabTargets[e]; return t ? t.id : "" }, h.prototype.getListIndex = function (e) { var t = this.renderedTabTargets[e]; return t ? t.listIndex : 0 }, h.prototype.shouldDrawHovered = function (e) { return e === this.focusedId || !(this.isAnObjectPressed() && !this.isObjectPressed(e)) && this.isObjectHovered(e) }, h.prototype.isObjectHovered = function (e) { return void 0 !== e && !(!this.hoveredObject || this.hoveredObject.id !== e) }, h.prototype.setHoveredObject = function (e) { e && this.hoveredObject && e.id === this.hoveredObject.id && e.listIndex === this.hoveredObject.listIndex || (this.hoveredObject = e, this.requestRedrawNextFrame()) }, h.prototype.getHoveredObject = function () { return this.hoveredObject }, h.prototype.shouldDrawPressed = function (e) { return this.isObjectPressed(e) }, h.prototype.isObjectPressed = function (e) { return void 0 !== e && !(!this.pressedObject || this.pressedObject.id !== e) }, h.prototype.setPressedObject = function (e) { e && this.pressedObject && e.id === this.pressedObject.id && e.listIndex === this.pressedObject.listIndex || (this.pressedObject = e, this.requestRedrawNextFrame()) }, h.prototype.getPressedObject = function () { return this.pressedObject }, h.prototype.isAnObjectPressed = function () { return !!this.pressedObject }, h.prototype.handleFocusChange = function () { var e = void 0; document.activeElement && s.contains(this.rootNode, document.activeElement) && (e = s(document.activeElement).attr("dcg-clickableobject-id")); this.focusedId !== e && (this.focusedId = e, this.requestRedrawNextFrame()) }, h.prototype.requestRedrawNextFrame = function () { this.grapher.redrawAllLayers() }, h }(r.Class); e.default = h });
define('graphing/grapher', ["require", "exports", "main/graph_settings", "./canvaslayer", "./poidotslayer", "./gridlayer", "vendor/canvas2svg", "./poicontroller", "./viewportcontroller", "dcgview", "jquery", "underscore", "./viewport", "./screen", "./graphsketch", "./projection", "underscore_model", "./audiograph", "./canvas-braille", "./braille-size-options", "core/lib/deepCopy", "core/lib/default-spec", "core/graphing-calc/json/graph-settings", "graphing/tonegenerator", "./movablepointslayer", "./poilabelslayer", "./imagelayer", "./clickableobject-layer", "./svg-classes", "./svg-groups", "core/types/graphmode", "./graphslayer"], function (require, e, t, r, i, s, o, a, n, h, c, p, l, d, g, u, y, w, v, f, _, b, m, L, S, k, R, P, x, C, j, O) { "use strict"; function I() { return new l.Viewport(-10, 10, -10, 10) } Object.defineProperty(e, "__esModule", { value: !0 }), e.Grapher = void 0; var A = function () { function e(e, t, o, l) { var g = this; this.type = "2d", this._layerClasses = {}, this.$ = e, this.evaluator = l, this.controller = o, this.settings = t; var v = new d.Screen(1024, 768), f = I().squareYAxis(v); this.setUserRequestedViewport(f), this.__projection = new u.Projection(v, f, t), this.markLabelsDirty = p.debounce(function () { g.evaluator.notifyWhenSynced(function () { g.__isRedrawingSlowly ? g.notifyAfterRedraw(function () { g.poiLabelsLayer.markLabelsDirty(), g.redrawAllLayers() }) : (g.poiLabelsLayer.markLabelsDirty(), g.redrawAllLayers()) }) }, 300), this.poiController = new a.POIController(this, t), this.viewportController = new n.ViewportController(this, this.controller), this.showPOIDots = !0, this.$.css("overflow", "hidden"), this.graphSketches = {}, this.graphImages = {}, this.audioGraph = new w.default(o, this), this.canvasLayer = r(this), this.$.append(this.canvasLayer.$); var _ = c("<div></div>"); this.$.append(_); var b = this; this.imageLayer = h.mountToNode(R.default, _[0], { grapher: function () { return b } }), this.gridLayer = s(), this.poiDotsLayer = i(), this.graphsLayer = new O.GraphsLayer(this.settings, function (e) { return g.audioGraph.getExpressionAriaLabel(e) }); var m = c("<div></div>"); this.$.append(m); b = this; this.clickableObjectsLayer = h.mountToNode(P.default, m[0], { grapher: function () { return b } }); var L = c("<div></div>"); this.$.append(L); b = this; this.movablePointsLayer = h.mountToNode(S.default, L[0], { grapher: function () { return b } }); var x = c("<div></div>"); this.$.append(x), this.poiLabelsLayer = h.mountToNode(k.default, x[0], { grapher: function () { return b } }), this.traceLayer = this.poiLabelsLayer, this.scaleAxis = void 0, this.__sketchOrder = [], this.selectedId = void 0, this.__redrawRequested = !1, this.__redrawSlowlyIndex = 0, this.__isRedrawingSlowly = !1, this.events = new y.UnderscoreModel } return e.copyGraphProperties = function (e, t) { for (var r in e = b.populateDefaults(m.DefaultGraphSettings, e), m.DefaultGraphSettings) m.DefaultGraphSettings.hasOwnProperty(r) && t.setProperty(r, e[r]); return e }, e.prototype.remove = function () { this.$.remove(), this.poiController.remove(), this.viewportController.remove(), this.audioGraph.remove() }, e.prototype.tick = function (e) { this.__isRedrawingSlowly ? this._redrawSlowly() : this.__redrawRequested && this._redrawAllLayers(), this.__movablePointListener && this.__movablePointListener() }, e.prototype.registerMovablePointListener = function (e) { this.__movablePointListener = e }, e.prototype.deregisterMovablePointListener = function () { this.__movablePointListener = void 0 }, e.prototype.setSketchOrder = function (e) { p.isEqual(this.__sketchOrder, e) || (this.__sketchOrder = e, this.redrawAllLayers()) }, e.prototype.clear = function () { this.graphSketches = {}, this.graphImages = {} }, e.prototype.getSketchOrder = function () { return this.__sketchOrder }, e.prototype.getGraphSketch = function (e) { return this.graphSketches[e] }, e.prototype.getGraphImage = function (e) { return this.graphImages[e] }, e.prototype.addGraphSketch = function (e) { this.graphSketches[e.id] = e }, e.prototype.removeGraphSketch = function (e) { delete this.graphSketches[e] }, e.prototype.addGraphImage = function (e) { var t = this; e.imageObj.width && e.imageObj.height ? (this.graphImages[e.id] = e, this.redrawAllLayers()) : c(e.imageObj).on("load.calc_load", function () { return t.addGraphImage(e) }) }, e.prototype.removeGraphImage = function (e) { var t = this.graphImages[e]; t && c(t.imageObj).off("load.calc_load"), delete this.graphImages[e], this.redrawAllLayers() }, e.prototype.getProjection = function () { return this.__projection }, e.prototype._setProjection = function (e) { this.__projection = e, this.redrawAllLayers() }, e.prototype.getAudioTrace = function () { return this.audioGraph }, e.prototype.getDefaultViewport = function () { var e = this.getProjection(); return I().squareYAxis(e.screen) }, e.prototype._updateScreenSize = function (e, t) { if (!(e <= 0 || t <= 0)) { var r = this.getProjection().screen; if (r.width !== e || r.height !== t) { this.$.width(e); var i = new d.Screen(e, t); this.viewportController.setScreen(i) } } }, e.prototype._setIsVisible = function (e) { e !== this.isVisible && (this.isVisible = e, e ? this.redrawAllLayers() : this.canvasLayer.resize(0, 0)) }, e.prototype.update = function () { var e = this.controller.computeMajorLayout().grapher; e.width > 0 && e.height > 0 ? (this._setIsVisible(!0), this._updateScreenSize(e.width, e.height), this.$.css({ position: "absolute", left: e.left + "px", top: e.top + "px", width: e.width + "px", height: e.height + "px" })) : this._setIsVisible(!1) }, e.prototype.hide = function (e) { var t = this.getGraphSketch(e); t && (t.visible = !1) }, e.prototype.select = function (e) { if (this.selectedId) { var t = this.getGraphSketch(this.selectedId); t && (t.selected = !1, t.showPOI = !1, t.showHighlight = !1) } var r = this.getGraphSketch(e); r && (r.selected = !0, r.showPOI = this.controller.isTraceEnabled(), r.showHighlight = !0), this.selectedId = e }, e.prototype.updateSketch = function (e, t) { var r = this.getGraphSketch(e); if (!t.length) return this.hide(e); var i = new g.GraphSketch(e, t); t[0].graphMode !== j.ERROR && (i.color = t[0].color, t[0].style && (i.style = t[0].style)), r && i.updateFrom(r); var s = String(e) === String(this.selectedId); i.selected = s, i.showPOI = s && this.controller.isTraceEnabled(), i.showHighlight = s, this.addGraphSketch(i) }, e.prototype.updateIntersections = function (e, t) { var r = this.getGraphSketch(e); r && r.updateIntersections(t) }, e.prototype.redrawAllLayers = function () { this.cancelRedrawSlowly(), this.__redrawRequested = !0 }, e.prototype._clear = function () { var e = this.getProjection(), t = e.screen; this.canvasLayer.resize(e.screen.width, e.screen.height), this.canvasLayer.ctx.clearRect(0, 0, t.width, t.height) }, e.prototype._redrawAllLayers = function () { this.isVisible && (this.__redrawRequested = !1, this._clear(), this.audioGraph.recomputePoints(), this._recomputeClickableObjects(), this._redrawImageLayer(), this._redrawGridLayer(), this._redrawGraphsLayer(), this._redrawPointsAndLabels(), this._updateCanvasLayerAria(), this.events.triggerEvent("redraw", void 0)) }, e.prototype.cancelRedrawSlowly = function () { this.__isRedrawingSlowly && (this.__redrawSlowlyIndex = 0, this.__isRedrawingSlowly = !1, this.redrawAllLayers()) }, e.prototype.redrawSlowly = function () { this.__isRedrawingSlowly || (this.__redrawSlowlyIndex = 0, this.__isRedrawingSlowly = !0, this.audioGraph.recomputePoints()) }, e.prototype._redrawSlowly = function () { var e, t, r = this.__redrawSlowlyIndex; if (0 === r && (this._clear(), this._redrawGridLayer()), r >= this.__sketchOrder.length) this.cancelRedrawSlowly(); else { var i = this.__sketchOrder[r], s = ((e = {})[i] = this.graphSketches[i], e), o = ((t = {})[i] = this.graphImages[i], t); (o[i] || s[i]) && this.graphsLayer.redrawToCtx(this.canvasLayer.ctx, this.getProjection(), s, o, [i], this.poiLabelsLayer, this.clickableObjectsLayer), this.__redrawSlowlyIndex += 1 } }, e.prototype._redrawGridLayer = function () { this.gridLayer.redrawToCtx(this.canvasLayer.ctx, this.getProjection(), this.scaleAxis) }, e.prototype._recomputeClickableObjects = function () { this.clickableObjectsLayer.redraw() }, e.prototype._redrawGraphsLayer = function () { this.graphsLayer.redrawToCtx(this.canvasLayer.ctx, this.getProjection(), this.graphSketches, this.graphImages, this.__sketchOrder, this.poiLabelsLayer, this.clickableObjectsLayer) }, e.prototype._updateCanvasLayerAria = function () { var e = 0; for (var t in this.graphSketches) L.canPlaySketch(this.graphSketches[t]) && (e += 1); this.canvasLayer.updateAria(this.isVisible, e) }, e.prototype._redrawPointsAndLabels = function () { var e = this.getProjection(), t = []; this.movablePointsLayer.redraw(this.canvasLayer.ctx, e, t), this.showPOIDots && this.poiDotsLayer.redrawToCtx(this.canvasLayer.ctx, e, this.graphSketches, this.poiLabelsLayer, this.clickableObjectsLayer); var r = this.$[0].getBoundingClientRect(); p.each([this.controller.find$(".dcg-overgraph-pillbox-elements")[0], this.controller.find$(".dcg-graphpaper-branding")[0]], function (e) { if (e) { var i = e.getBoundingClientRect(); t.push({ left: i.left - r.left, top: i.top - r.top, right: i.right - r.left, bottom: i.bottom - r.top }) } }); var i = this.canvasLayer.ctx.canvas.getBoundingClientRect(); this.poiLabelsLayer.redraw(e, this.canvasLayer.ctx, { width: i.width, height: i.height }, t) }, e.prototype._redrawImageLayer = function () { this.imageLayer.redrawToCtx(this.canvasLayer.ctx, this.getProjection(), this.graphImages, this.__sketchOrder) }, e.prototype._parseScreenshotOpts = function (e) { var r, i, s, o, a, n, h = this.getProjection(); return e ? (r = e.width || e.height || h.screen.width, i = e.height || e.width || h.screen.height, (s = e.targetPixelRatio || 1) < 1 && (s = 1), o = (r < 256 || i < 256) && !e.preserveAxisNumbers, a = t.fromObject(e.settings || this.settings), n = !!e.transparentBackground) : (r = h.screen.width, i = h.screen.height, s = 1, o = !1, a = t.fromObject(this.settings), n = !1), o && (a.setProperty("xAxisNumbers", !1), a.setProperty("yAxisNumbers", !1), a.setProperty("polarNumbers", !1)), { width: r, height: i, targetPixelRatio: s, settings: a, transparentBackground: n } }, e.prototype._syncScreenshotReturnCanvas = function (e) { var t = document.createElement("canvas"); if (e && e.braille) { var r = e.braille, i = r.embosserModel, s = r.brailleMode, o = f.brailleSizes[i]; t.width = o.width, t.height = o.height, v.createBrailleImage(t, this, o, i, s) } else { var a = this._parseScreenshotOpts(e); t.width = a.width * a.targetPixelRatio, t.height = a.height * a.targetPixelRatio, this.screenshotToCanvas(t, e) } return t }, e.prototype.screenshot = function (e) { return this._syncScreenshotReturnCanvas(e).toDataURL("image/png") }, e.prototype.asyncScreenshot = function (e, t) { var r = this, i = !1; !e.transparentBackground && e.showLabels && ((e = _.default(e)).transparentBackground = !0, i = !0); var s = this._syncScreenshotReturnCanvas(e), a = s.getContext("2d"), n = s, p = a; e && "svg" === e.format && (i = !1, e.transparentBackground && ((e = _.default(e)).transparentBackground = !1), p = new o(s.width, s.height), n = { getContext: function () { return p }, width: s.width, height: s.height }, this.screenshotToCanvas(n, e)); var l = this.makeScreenshotProjection(e), d = []; if (e.showMovablePoints && this.movablePointsLayer.drawForScreenshot(p, l, d), e.showLabels) { var g = l.screen.width, u = l.screen.height, y = l.settings.labelSize || 15, w = 1; (g < 200 || u < 200) && (w = .9); var v = c('<div class="dcg-calculator-api-container">\n          <div class="dcg-container">\n            <div class="dcg-grapher" style="font-size:' + (y * w + "px") + '"></div>\n          </div>\n        </div>').css({ width: l.screen.width, height: l.screen.height, position: "fixed", left: "0px", top: "0px" }).appendTo("body"), f = v.find(".dcg-grapher"), b = h.mountToNode(k.default, f[0], { grapher: function () { return r } }), m = { width: l.screen.width, height: l.screen.height }; b.drawForScreenshot(l, a, p, m, d), v.remove() } i && (p.globalCompositeOperation = "destination-over", p.fillStyle = "#FFF", p.fillRect(0, 0, n.width, n.height)), e && "svg" === e.format ? t(p.getSerializedSvg()) : t(n.toDataURL("image/png")) }, e.prototype.makeScreenshotProjection = function (e) { var t = this._parseScreenshotOpts(e), r = t.width, i = t.height, s = t.settings, o = new d.Screen(r, i), a = this.getProjection().viewport; return this.getSetting("squareAxes") && (a = a.squareCrop(o)), new u.Projection(o, a, s) }, e.prototype.screenshotToCanvas = function (e, t) { var r = this._parseScreenshotOpts(t), i = r.targetPixelRatio, s = r.transparentBackground, o = e.getContext("2d"); o.scale(i, i); var a = this.makeScreenshotProjection(t); a.settings.takingScreenshot = !0, C.save(o, "background"), x.save(o, "dcg-svg-background"), s ? o.clearRect(0, 0, a.screen.width, a.screen.height) : (o.fillStyle = "white", o.fillRect(0, 0, a.screen.width, a.screen.height)), x.restore(o), C.restore(o), this.imageLayer.redrawToCtx(o, a, this.graphImages, this.__sketchOrder), this.gridLayer.redrawToCtx(o, a), this.graphsLayer.redrawToCtx(o, a, this.graphSketches, this.graphImages, this.__sketchOrder, this.poiLabelsLayer, this.clickableObjectsLayer, t) }, e.prototype.getImageData = function (e, t, r, i) { return this.canvasLayer.ctx.getImageData(e, t, r, i) }, e.prototype.getSetting = function (e, t) { var r = this.settings.getProperty(e); return void 0 !== r ? r : t }, e.prototype.getState = function (e) { var t = this, r = { viewport: this.getCurrentViewport() }; return this.settings.stateProperties.forEach(function (e) { "randomSeed" !== e && (r[e] = t.getSetting(e)) }), e.stripDefaults && (r = b.stripDefaults(m.DefaultGraphSettings, r)), r }, e.prototype.getUndoRedoState = function () { var e = this, t = {}; return this.settings.stateProperties.forEach(function (r) { t[r] = e.getSetting(r) }), t.viewport = this.getUserRequestedViewport(), t }, e.prototype.notifyAfterRedraw = function (e) { var t = this; if (this.__isRedrawingSlowly) requestAnimationFrame(this.notifyAfterRedraw.bind(this, e)); else if (this.__redrawRequested) { this.notifyAfterRedraw_i ? this.notifyAfterRedraw_i++ : this.notifyAfterRedraw_i = 1; var r = "redraw.notifyAfterRedraw" + this.notifyAfterRedraw_i; this.events.observeEvent(r, function () { t.events.unobserveEvent(r), e() }) } else e() }, e.prototype.getCurrentViewport = function () { return this.viewportController.getViewport().toObject() }, e.prototype.getUserRequestedViewport = function () { return this._lastUserRequestedViewport }, e.prototype.setUserRequestedViewport = function (e) { this._lastUserRequestedViewportUpdateToken || (this._lastUserRequestedViewportUpdateToken = 0), this._lastUserRequestedViewportUpdateToken += 1, this._lastUserRequestedViewport = _.default(e) }, e.prototype.debounceUserRequestedViewportChange = function () { var e = this; if (!this.__debouncedViewportCommit) { this.__debouncedViewportCommit = p.debounce(function (t, r) { if (!e.isDragging && e._lastUserRequestedViewportUpdateToken === r) { if (e._lastUserRequestedViewport) { var i = l.Viewport.fromObject(e._lastUserRequestedViewport); if (e.computeConcreteViewport(i).equals(t)) return } e.controller.dispatch({ type: "commit-user-requested-viewport", viewport: t }) } }, 1e3) } var t = this.getCurrentViewport(); this.__debouncedViewportCommit(t, this._lastUserRequestedViewportUpdateToken) }, e.prototype.setGrapherState = function (t, r) { if (r && r.doNotClear || this.clear(), "viewport" in (t = e.copyGraphProperties(t, this.settings))) { var i = l.Viewport.fromObject(t.viewport); this.setUserRequestedViewport(i); var s = this.computeConcreteViewport(i); this.viewportController.setViewport(s) } this.redrawAllLayers() }, e.prototype.computeConcreteViewport = function (e) { var t = this.getProjection().screen; return this.getSetting("squareAxes") && !e.isSquare(t) ? e.squareYAxis(t) : e }, e.prototype.setLayerClass = function (e, t) { var r = this._layerClasses[e]; this._layerClasses[e] = t, r !== t && (r && this.$.removeClass(r), t && this.$.addClass(t)) }, e }(); e.Grapher = A });
!function (t, i) { "object" == typeof exports && "object" == typeof module ? module.exports = i() : "function" == typeof define && define.amd ? define('flux', [], i) : "object" == typeof exports ? exports.Flux = i() : t.Flux = i() }(this, function () { return function (t) { var i = {}; function e(n) { if (i[n]) return i[n].exports; var s = i[n] = { exports: {}, id: n, loaded: !1 }; return t[n].call(s.exports, s, s.exports, e), s.loaded = !0, s.exports } return e.m = t, e.c = i, e.p = "", e(0) }([function (t, i, e) { "use strict"; t.exports.Dispatcher = e(1) }, function (t, i, e) { "use strict"; i.__esModule = !0; var n = e(2), s = function () { function t() { !function (t, i) { if (!(t instanceof i)) throw new TypeError("Cannot call a class as a function") }(this, t), this._callbacks = {}, this._isDispatching = !1, this._isHandled = {}, this._isPending = {}, this._lastID = 1 } return t.prototype.register = function (t) { var i = "ID_" + this._lastID++; return this._callbacks[i] = t, i }, t.prototype.unregister = function (t) { this._callbacks[t] || n(!1, "Dispatcher.unregister(...): `%s` does not map to a registered callback.", t), delete this._callbacks[t] }, t.prototype.waitFor = function (t) { this._isDispatching || n(!1, "Dispatcher.waitFor(...): Must be invoked while dispatching."); for (var i = 0; i < t.length; i++) { var e = t[i]; this._isPending[e] ? this._isHandled[e] || n(!1, "Dispatcher.waitFor(...): Circular dependency detected while waiting for `%s`.", e) : (this._callbacks[e] || n(!1, "Dispatcher.waitFor(...): `%s` does not map to a registered callback.", e), this._invokeCallback(e)) } }, t.prototype.dispatch = function (t) { this._isDispatching && n(!1, "Dispatch.dispatch(...): Cannot dispatch in the middle of a dispatch."), this._startDispatching(t); try { for (var i in this._callbacks) this._isPending[i] || this._invokeCallback(i) } finally { this._stopDispatching() } }, t.prototype.isDispatching = function () { return this._isDispatching }, t.prototype._invokeCallback = function (t) { this._isPending[t] = !0, this._callbacks[t](this._pendingPayload), this._isHandled[t] = !0 }, t.prototype._startDispatching = function (t) { for (var i in this._callbacks) this._isPending[i] = !1, this._isHandled[i] = !1; this._pendingPayload = t, this._isDispatching = !0 }, t.prototype._stopDispatching = function () { delete this._pendingPayload, this._isDispatching = !1 }, t }(); t.exports = s }, function (t, i, e) { "use strict"; t.exports = function (t, i, e, n, s, a, o, r) { if (void 0 === i) throw new Error("invariant requires an error message argument"); if (!t) { var c; if (void 0 === i) c = new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings."); else { var p = [e, n, s, a, o, r], h = 0; (c = new Error(i.replace(/%s/g, function () { return p[h++] }))).name = "Invariant Violation" } throw c.framesToPop = 1, c } } }]) });
define('lib/state-stack', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = function () { function t(t) { void 0 === t && (t = 100), this.clear(), this._sizeLimit = t } return t.prototype.clear = function () { this._stack = [], this._stackPointer = -1 }, t.prototype.getState = function () { return this._stack[this._stackPointer] }, t.prototype.serializeForBugsnag = function () { function t(t) { try { return JSON.stringify(t, null, 2) } catch (t) { return "[[could not jsonify]]" } } return { currentState: t(this._stack[this._stackPointer]), undoState: t(this._stack[this._stackPointer - 1]), redoState: t(this._stack[this._stackPointer + 1]) } }, t.prototype.addState = function (t) { this.canRedo() && this._stack.splice(this._stackPointer + 1), this._stack.push(t), this._stack.length > this._sizeLimit && this._stack.shift(), this._stackPointer = this._stack.length - 1 }, t.prototype.replaceState = function (t) { this.canRedo() && this._stack.splice(this._stackPointer + 1), this.replaceInteriorState(t) }, t.prototype.replaceInteriorState = function (t) { 0 === this._stack.length ? (this._stack.push(t), this._stackPointer = 0) : this._stack[this._stackPointer] = t }, t.prototype.canUndo = function () { return this._stackPointer > 0 }, t.prototype.canRedo = function () { return this._stackPointer < this._stack.length - 1 }, t.prototype.undo = function () { this.canUndo() && (this._stackPointer -= 1) }, t.prototype.redo = function () { this.canRedo() && (this._stackPointer += 1) }, t }(); t.default = i });
define('core/graphing-calc/migrations/0', ['require'], function (require) { "use strict"; var r = { expression: !0, table: !0, image: !0, folder: !0, text: !0 }; function e(r) { return r.replace(/\\(total|length|mean|median|quantile|stdev|stddev|stdDev|stdevp|stddevp|stdDevP|var|variance|cov|corr|ceil|floor|round|abs|mod|lcm|mcm|mcd|nCr|nPr|signum|sign|arcsinh|arccosh|arctanh|arccsch|arcsech|arccoth|arccsc|arcsec|arccot)/g, "\\operatorname{$1}") } function n(r) { var n = {}; for (var t in r) r.hasOwnProperty(t) && (n[t] = "latex" === t ? e(r[t]) : "values" === t ? r[t].map(e) : r[t]); return n } function t(t) { var o, s = function (e) { if (e.type) { if (r.hasOwnProperty(e.type)) return e.type; throw new Error("Invalid item type: '" + e.type + "'.") } return void 0 !== e.text ? "text" : void 0 !== e.columns || void 0 !== e.headings ? "table" : "expression" }(t), a = {}; switch (s) { case "expression": for (o in t) t.hasOwnProperty(o) && (a[o] = "latex" === o ? e(t[o]) : t[o]); return a.type = s, a; case "table": for (o in t) t.hasOwnProperty(o) && (a[o] = "columns" === o ? t[o].map(n) : t[o]); return a.type = s, a; case "image": for (o in t) t.hasOwnProperty(o) && (a[o] = "width" === o || "height" === o || "x" === o || "y" === o ? e(t[o]) : t[o]); return a.type = s, a; case "text": case "folder": for (o in t) t.hasOwnProperty(o) && (a[o] = t[o]); return a.type = s, a } } var o = { none: "NONE", both: "BOTH", positive: "POSITIVE" }; return function (r) { if (r.version) throw new Error("Unexpected version: " + r.version); var e = {}; return e.graph = function (r) { var e = {}; for (var n in r) r.hasOwnProperty(n) && "xAxisArrows" !== n && "yAxisArrows" !== n && (e[n] = r[n]); return e.xAxisArrowMode = o[r.xAxisArrows || "none"], e.yAxisArrowMode = o[r.yAxisArrows || "none"], e }(r.graph), e.expressions = { list: r.expressions.list.map(t) }, e.version = 0, e } });
define('core/graphing-calc/migrations/1', ['require'], function (require) { "use strict"; function r(r) { return r.replace(/\\(sech|csch)/g, "\\operatorname{$1}") } function e(e) { var n = {}; for (var t in e) e.hasOwnProperty(t) && (n[t] = "latex" === t ? r(e[t]) : "values" === t ? e[t].map(r) : e[t]); return n } function n(n) { var t, s = n.type, o = {}; switch (s) { case "expression": for (t in n) n.hasOwnProperty(t) && (o[t] = "latex" === t ? r(n[t]) : n[t]); return o; case "table": for (t in n) n.hasOwnProperty(t) && (o[t] = "columns" === t ? n[t].map(e) : n[t]); return o; case "image": for (t in n) n.hasOwnProperty(t) && (o[t] = "width" === t || "height" === t || "x" === t || "y" === t ? r(n[t]) : n[t]); return o; case "text": case "folder": for (t in n) n.hasOwnProperty(t) && (o[t] = n[t]); return o; default: throw new Error("Unexpected expression type: " + s) } } return function (r) { if (r.version) throw new Error("Unexpected version: " + r.version); var e = {}; return e.graph = r.graph, e.expressions = { list: r.expressions.list.map(n) }, e.version = 1, e } });
define('core/graphing-calc/migrations/2', ['require', 'core/lib/color-helpers'], function (require) { "use strict"; var r = require("core/lib/color-helpers").colors; function e(e) { switch (e) { case "#C0504D": return r.RED; case "#4F81BD": return r.BLUE; case "#9BBB59": return r.GREEN; case "#8064A2": return r.PURPLE; case "#F79646": return r.ORANGE; case "#000000": return r.BLACK; default: return e } } function n(r) { var n = {}; for (var t in r) r.hasOwnProperty(t) && (n[t] = "color" === t ? e(r[t]) : r[t]); return n } function t(r) { var t, s = r.type, o = {}; switch (s) { case "expression": for (t in r) r.hasOwnProperty(t) && (o[t] = "color" === t ? e(r[t]) : r[t]); return o; case "table": for (t in r) r.hasOwnProperty(t) && (o[t] = "columns" === t ? r[t].map(n) : r[t]); return o; case "image": case "text": case "folder": for (t in r) r.hasOwnProperty(t) && (o[t] = r[t]); return o; default: throw new Error("Unexpected expression type: " + s) } } return function (r) { if (r.version > 1) throw new Error("Unexpected version: " + r.version); var e = {}; return e.graph = r.graph, e.expressions = { list: r.expressions.list.map(t) }, e.version = 2, e } });
define('core/graphing-calc/migrations/3', ['require'], function (require) { "use strict"; function e(e) { if ("string" == typeof e) return e; if (void 0 === e) return ""; var r = e + ""; return r = (r = r.replace(/1e\+?([-\d]+)/, "10^{$1}")).replace(/([-\d\.]+)e\+?([-\d]+)/, "$1\\cdot 10^{$2}") } function r(r) { var n, i = r.type, t = {}; switch (i) { case "expression": for (n in r) r.hasOwnProperty(n) && (t[n] = "sliderMax" === n || "sliderMin" === n || "sliderInterval" === n ? e(r[n]) : "domain" === n ? { max: e(r[n].max), min: e(r[n].min) } : r[n]); return t.hasOwnProperty("sliderMin") && void 0 === t.sliderInterval && (t.sliderInterval = ""), t; case "image": case "table": case "text": case "folder": for (n in r) r.hasOwnProperty(n) && (t[n] = r[n]); return t; default: throw new Error("Unexpected expression type: " + i) } } return function (e) { if (e.version > 2) throw new Error("Unexpected version: " + e.version); var n = {}; return n.graph = e.graph, n.expressions = { list: e.expressions.list.map(r) }, n.version = 3, n } });
define('core/graphing-calc/migrations/4', ['require'], function (require) { "use strict"; function e(e) { switch (e) { case "point": return "POINT"; case "cross": return "CROSS"; case "open": return "OPEN"; case "normal": return "SOLID"; case "dashed": return "DASHED"; case "dotted": return "DOTTED"; default: return e } } function r(r) { var n = {}; for (var t in r) r.hasOwnProperty(t) && (n[t] = "style" === t ? e(r[t]) : r[t]); return n } function n(n) { var t, s = n.type, o = {}; switch (s) { case "expression": for (t in n) n.hasOwnProperty(t) && (o[t] = "style" === t ? e(n[t]) : n[t]); return o; case "table": for (t in n) n.hasOwnProperty(t) && (o[t] = "columns" === t ? n[t].map(r) : n[t]); return o; case "image": case "text": case "folder": for (t in n) n.hasOwnProperty(t) && (o[t] = n[t]); return o; default: throw new Error("Unexpected expression type: " + s) } } return function (e) { if (3 !== e.version) throw new Error("Unexpected version: " + e.version); var r = {}; return r.graph = e.graph, r.expressions = { list: e.expressions.list.map(n) }, r.version = 4, r } });
define('core/graphing-calc/validate-state', ["require", "exports", "core/lib/deepCopy"], function (require, e, i) { "use strict"; function t(e) { e.slider && function (e) { "number" == typeof e.min && (e.min = "" + e.min), "number" == typeof e.max && (e.max = "" + e.max), "number" == typeof e.step && (e.step = "" + e.step) }(e.slider), "string" != typeof e.id && (e.id = "" + e.id) } function r(e) { for (var i, r, o = function (e) { for (var i = 0, t = 0, r = e; t < r.length; t++) { var o = r[t]; if (i = d(i, o.id), "table" === o.type) for (var n = 0, f = o.columns; n < f.length; n++) { d(i, f[n].id) } } return i }(e) + 1, n = {}, f = 0, a = e; f < a.length; f++) { var l = a[f]; if (t(l), "folder" === l.type) i = l.id, n[l.id] && (l.id = "" + o, o += 1), r = l.id, n[l.id] = !0, l.hasOwnProperty("folderId") && delete l.folderId; else { if (void 0 !== i && l.folderId === i ? l.folderId = r : (l.folderId && (l.folderId = ""), i = void 0, r = void 0), "table" === l.type) for (var u = 0, s = l.columns; u < s.length; u++) { var p = s[u]; n[p.id] && (p.id = "" + o, o += 1), n[p.id] = !0 } n[l.id] && (l.id = "" + o, o += 1), n[l.id] = !0 } } } function d(e, i) { var t = parseFloat(i); return t !== Math.floor(t) ? e : Math.max(e, t) } Object.defineProperty(e, "__esModule", { value: !0 }), e.validateState = void 0, e.validateState = function (e) { var t = i.default(e); return r(t.expressions.list), t } });
define('core/graphing-calc/migrations/5', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.migrateState = void 0; function r(e) { var r, s = {}; for (var o in e) if (e.hasOwnProperty(o)) switch (r = e[o], o) { case "showAxes": s.showXAxis = r, s.showYAxis = r; break; case "showLabels": s.xAxisNumbers = r, s.yAxisNumbers = r, s.polarNumbers = r; break; case "labelXMode": s.xAxisStep = "pi" === r ? Math.PI : 0; break; case "labelYMode": s.yAxisStep = "pi" === r ? Math.PI : 0; break; default: s[o] = r }return s } function s(e) { var r = {}; for (var s in e) e.hasOwnProperty(s) && "showPoints" !== s && "showLine" !== s && (r[s] = e[s]); return void 0 === e.showPoints && void 0 === e.showLine || (e.showPoints && e.showLine ? r.columnMode = "POINTS_AND_LINES" : e.showPoints ? r.columnMode = "POINTS" : e.showLine ? r.columnMode = "LINES" : (r.hidden = !0, r.columnMode = "POINTS")), r } function o(e) { var r, o = e.type, n = {}; switch (o) { case "expression": for (r in void 0 === e.hidden ? e.hasOwnProperty("graphed") ? n.hidden = !e.graphed : e.hasOwnProperty("userRequestedGraphing") ? n.hidden = "never" === e.userRequestedGraphing : n.hidden = !1 : n.hidden = e.hidden, e) e.hasOwnProperty(r) && "graphed" !== r && "userRequestedGraphing" !== r && "hidden" !== r && "slider" !== r && ("color" !== r ? "style" !== r ? "sliderInterval" !== r ? n[r] = e[r] : n.sliderInterval = "undefined" === e.sliderInterval ? "" : e.sliderInterval : n.style = "normal" === e.style ? "SOLID" : e.style : "object" == typeof e.color ? n.color = e.color.value : n.color = e.color); return n; case "table": if (e.headings || e.columns) { var i = e.headings ? e.headings : e.columns; if (n.columns = i.map(s), e.rows) for (var t = 0; t < n.columns.length; t++) { var a = n.columns[t]; a.values = []; for (var d = 0; d < e.rows.length; d++)a.values.push(e.rows[d][t]) } } for (r in e) e.hasOwnProperty(r) && "rows" !== r && "headings" !== r && "columns" !== r && (n[r] = e[r]); return n; case "image": case "text": case "folder": for (r in e) e.hasOwnProperty(r) && (n[r] = e[r]); return n; default: throw new Error("Unexpected expression type: " + o) } } e.migrateState = function (e) { if (4 !== e.version) throw new Error("Unexpected version: " + e.version); return { version: 5, graph: r(e.graph), expressions: { list: e.expressions.list.map(o) } } } });
define('core/graphing-calc/migrations/6', ["require", "exports", "core/lib/deepCopy", "underscore", "core/math/sliders", "core/math/evaluate-single-expression"], function (require, e, r, i, t, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.migrateState = void 0; function n(e) { var r = {}; for (var i in e) if (e.hasOwnProperty(i) && "style" !== i) if ("values" === i && (r[i] = e[i].map(function (e) { return e ? "" + e : "" })), "columnMode" !== i || e.hasOwnProperty("points") || e.hasOwnProperty("lines")) r[i] = e[i]; else switch (e[i]) { case "LINES": r.points = !1, r.lines = !0; break; case "POINTS_AND_LINES": r.points = !0, r.lines = !0; break; default: r.points = !0, r.lines = !1 }return r.hasOwnProperty("pointStyle") || (r.pointStyle = "POINT"), r.hasOwnProperty("lineStyle") || (r.lineStyle = "SOLID"), r.id = "" + r.id, r } var l = { sliderMin: "min", sliderMax: "max", sliderInterval: "step", sliderHardMin: "hardMin", sliderHardMax: "hardMax", sliderAnimationPeriod: "animationPeriod", sliderLoopMode: "loopMode", sliderPlayDirection: "playDirection", sliderIsPlaying: "isPlaying" }; function s(e) { var r = function (e) { if (function (e) { return !(e.length < 2) && "`" === e[0] && "`" === e[e.length - 1] }(e)) return { raw: e, parts: [e] }; for (var r, i = "({" + ["[a-zA-Z][0-9]*", "[a-zA-Z]_[a-zA-Z0-9]+", "[a-zA-Z]_\\{[a-zA-Z0-9]+\\}"].join("})|({") + "})", t = new RegExp(i, "g"), a = [], n = 0, l = 0; r = t.exec(e);) { (l = r.index) > n && a.push(e.substr(n, l - n)); var s = r[0], o = s.replace(/[{}\$]/g, "").replace(/^([a-zA-Z])([0-9]+)$/, "$1_$2"); a.push({ symbol: o, str: s }), n = r.index + s.length } return n < e.length && a.push(e.substr(n)), { raw: e, parts: a } }(e), t = ""; return i.each(r.parts, function (e) { t += "object" == typeof e && e.str ? "$" + e.str : e }), t } function o(e, r, o, d) { var p, f = e.type, c = {}; switch (f) { case "folder": for (p in e) e.hasOwnProperty(p) && ("memberIds" === p || (c[p] = e[p])); break; case "expression": for (p in e) if (e.hasOwnProperty(p)) if ("style" !== p || e.hasOwnProperty("pointStyle") || e.hasOwnProperty("lineStyle")) l.hasOwnProperty(p) ? (c.slider = c.slider || {}, c.slider[l[p]] = e[p]) : c[p] = e[p], e.label && (c.label = s(e.label)); else { var u = e[p]; i.contains(["POINT", "OPEN", "CROSS"], u) ? (c.pointStyle = u, c.lineStyle = "SOLID") : i.contains(["SOLID", "DASHED", "DOTTED"], u) ? (c.pointStyle = "POINT", c.lineStyle = u) : (c.pointStyle = "POINT", c.lineStyle = "SOLID") } c.latex && c.slider && !c.slider.isPlaying && function (e, r) { var i = e.latex.split("="); if (2 === i.length) { var n = a.default(i[1], r); if (isFinite(n)) { var l = e.slider.hardMin ? a.default(e.slider.min || "-10", r) : void 0, s = e.slider.hardMax ? a.default(e.slider.max || "10", r) : void 0, o = e.slider.step ? a.default(e.slider.step, r) : void 0, d = t.determineWhichLimitsAreCompatibleWithValue({ target: n, step: o, hardMin: l, hardMax: s }); d.min || (delete e.slider.hardMin, delete e.slider.min), d.max || (delete e.slider.hardMax, delete e.slider.max), d.step || delete e.slider.step } } }(c, d), c.hasOwnProperty("fillOpacity") || (c.fillOpacity = .4), !1 === c.label && (c.label = ""), c.labelSize || (c.labelSize = "medium"), c.labelOrientation || (c.labelOrientation = "default"), c.verticalLabel || (c.verticalLabel = !1), c.interactiveLabel || (c.interactiveLabel = !1); break; case "image": for (p in e) e.hasOwnProperty(p) && "x" !== p && "y" !== p && (c[p] = e[p]); c.center = "\\left(" + (e.x || "0") + "," + (e.y || "0") + "\\right)", c.angle = e.angle || "0", c.foreground = !!c.foreground; break; case "text": for (p in e) e.hasOwnProperty(p) && (c[p] = e[p]); break; case "table": for (p in e) e.hasOwnProperty(p) && (c[p] = "columns" === p ? e[p].map(n) : e[p]); break; default: throw new Error("Unexpected expression type: " + f) }if (c.id = "" + c.id, "folder" === e.type) r.folderId = c.id, r.memberIds = e.memberIds, c.folderId = ""; else { var h = o[c.id]; r.memberIds && r.memberIds[h] ? c.folderId = r.folderId : (c.folderId = "", r.folderId = void 0, r.memberIds = void 0) } return c } e.migrateState = function (e) { if (5 !== e.version) throw new Error("Unexpected version: " + e.version); var i = !(!e.graph || !e.graph.degreeMode), t = e.expressions.list, a = -1, n = {}, l = {}, s = {}; return { version: 6, graph: e.graph, expressions: { list: t.map(function (e) { return n[e.id] ? (-1 === a && (a = function (e) { for (var r = 0, i = /^[0-9]+$/, t = e.length - 1; t >= 0; t--) { var a, n = e[t], l = n.id; if (i.test(l) && (a = parseInt(l, 10)) > r && (r = a), "table" === n.type && n.columns) for (var s = n.columns.length - 1; s >= 0; s--)l = n.columns[s].id, i.test(l) && (a = parseInt(l, 10)) > r && (r = a) } return r + 1 }(t)), l[a] = e.id, (e = r.default(e)).id = a + "", a += 1) : l[e.id] = e.id, n[e.id] = !0, o(e, s, l, i) }) } } } });
define('core/graphing-calc/migrations/7', ["require", "exports", "tslib"], function (require, e, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e) { if (6 !== e.version) throw new Error("Unexpected version: " + e.version); var r = e.expressions.list.map(function (e) { if ("expression" === e.type && e.domain) { var r = n.__assign(n.__assign({}, e), { parametricDomain: { min: e.domain.min, max: e.domain.max } }); return delete r.domain, r } return e }); return { version: 7, randomSeed: e.randomSeed, graph: e.graph, expressions: { list: r } } } });
define('core/lib/random-seed', ["require", "exports", "core/lib/md5"], function (require, e, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function () { var e = new Uint8Array(16); if ("undefined" != typeof crypto) crypto.getRandomValues(e); else { if ("undefined" == typeof msCrypto) return t.default(Date.now().toString() + Math.random().toString()); msCrypto.getRandomValues(e) } return Array.prototype.slice.call(e).map(function (e) { return function (e) { return 1 === e.length ? "0" + e : e }(e.toString(16)) }).join("") } });
define('core/graphing-calc/migrations/8', ["require", "exports", "tslib", "core/lib/random-seed", "core/lib/deepCopy"], function (require, e, r, t, i) { "use strict"; function a(e) { var r = e.split("_"); return 2 === r.length && r[1] && 1 === r[1].length ? r[0] + "_{" + r[1] + "}" : e } function n(e) { return (e = i.default(e)).rules || !e.assignment && !e.expression || (e.rules = [{ id: "1", assignment: e.assignment || "", expression: e.expression || "" }]), delete e.assignment, delete e.expression, e } function s(e) { return e.replace(/\\operatorname(?:\{stdev\}p|\{stddev\}p|\{stdDev\}P|\{var\}iance)/g, function (e) { switch (e) { case "\\operatorname{stdev}p": return "\\operatorname{stdevp}"; case "\\operatorname{stddev}p": return "\\operatorname{stddevp}"; case "\\operatorname{stdDev}P": return "\\operatorname{stdDevP}"; case "\\operatorname{var}iance": return "\\operatorname{variance}"; default: return "" } }) } function l(e) { var t = e.latex, i = e.values, n = r.__assign({}, e); return t && (n.latex = s(t), n.latex = a(n.latex)), i && (n.values = i.map(function (e) { return e ? s(e) : "" })), n } Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e) { if (7 !== e.version) throw new Error("Unexpected version: " + e.version); var o = e.expressions.list.map(function (e) { if ("image" === e.type) { var t = r.__assign(r.__assign({}, e), { opacity: "" }); for (var o in e.hasOwnProperty("stringOpacity") ? t.opacity = e.stringOpacity : e.hasOwnProperty("opacity") ? t.opacity = e.opacity + "" : delete t.opacity, e.clickableInfo && (t.clickableInfo = n(e.clickableInfo)), delete t.stringOpacity, e) if ("x" === o || "y" === o || "width" === o || "height" === o) { var p = e[o]; p && (t[o] = s(p)) } return t } if ("expression" === e.type) { t = r.__assign(r.__assign({}, e), { fillOpacity: "", lineStyle: "SOLID" }); if ("SINGLE_PIXEL" === e.lineStyle ? t.lineWidth = "1" : e.hasOwnProperty("lineStyle") ? t.lineStyle = e.lineStyle : delete t.lineStyle, t.hasOwnProperty("lineWidth") || (t.lineWidth = ""), t.hasOwnProperty("lineOpacity") || (t.lineOpacity = ""), t.hasOwnProperty("pointOpacity") || (t.pointOpacity = ""), t.hasOwnProperty("pointSize") || (t.pointSize = ""), t.hasOwnProperty("colorLatex") || (t.colorLatex = ""), "string" == typeof e.latex && (t.latex = s(e.latex)), e.latex && (t.latex = s(e.latex)), e.hasOwnProperty("stringFillOpacity") ? t.fillOpacity = e.stringFillOpacity : e.hasOwnProperty("fillOpacity") ? t.fillOpacity = e.fillOpacity + "" : delete t.fillOpacity, t.slider && e.slider && e.slider.newLoopMode && (t.slider = i.default(t.slider), t.slider.loopMode = e.slider.newLoopMode, delete t.slider.newLoopMode), t.residualVariable && (t.residualVariable = a(t.residualVariable)), t.regressionParameters) for (var c in t.regressionParameters = {}, e.regressionParameters) { var d = a(c), y = e.regressionParameters[c]; t.regressionParameters[d] = y } return e.clickableInfo && (t.clickableInfo = n(e.clickableInfo)), t } return "table" === e.type ? (u = e).columns ? r.__assign(r.__assign({}, u), { columns: u.columns.map(l) }) : u : e; var u }); return { version: 8, randomSeed: e.randomSeed || t.default(), graph: e.graph, expressions: { list: o } } } });
define('core/graphing-calc/migrations/9', ["require", "exports", "tslib", "core/lib/random-seed", "../json/ticker"], function (require, e, i, r, n) { "use strict"; function l(e, i, r) { if (e.verticalLabel) switch (delete i.verticalLabel, i.labelAngle = r ? "90" : "\\frac{\\pi}{2}", e.labelOrientation) { case "above": i.labelOrientation = "right"; break; case "below": i.labelOrientation = "left"; break; case "left": i.labelOrientation = "above"; break; case "right": i.labelOrientation = "below" }e.extendedLabelOrientation && (i.labelOrientation = e.extendedLabelOrientation, delete i.extendedLabelOrientation) } function t(e, r) { if (e.vizProps) switch (e.vizProps.dotplotSize) { case "small": r.pointSize = "9"; break; case "large": r.pointSize = "20" }if (e.vizProps) { var n = i.__assign({}, e.vizProps); delete n.dotplotSize, Object.keys(n).length ? r.vizProps = n : delete r.vizProps } } function a(e) { return e.filter(function (e) { var i = e.assignment, r = e.expression; return !!i && !!r }) } function o(e) { return e.map(function (e) { return e.assignment + "\\to " + e.expression }).join(",") || "" } function s(e) { for (var i, r = JSON.stringify(e), n = /_(\d)|_\{(\d+)\}/g, l = {}; null !== (i = n.exec(r));) { l[void 0 !== i[1] ? i[1] : i[2]] = !0 } return l } function f(e, i) { for (var r = i + 1; ; r++)if (!e[r]) return r } function d(e) { for (var i, r = JSON.stringify(e), n = /"(\d+)"/g, l = {}; null !== (i = n.exec(r));) { l[void 0 !== i[1] ? i[1] : i[2]] = !0 } return l } function c(e, i) { for (var r = i + 1; ; r++)if (!e[r]) return r } function u(e, i) { var r = { handlerLatex: e, playing: !0, open: !0 }; return void 0 !== i && (r.minStepLatex = function (e) { if (/^\d+$/.test(e)) { var i = parseInt(e, 10); return 0 === i ? "\\infty" : "" + Math.round(1e3 / i) } return "\\frac{1000}{" + e + "}" }(i)), r } Object.defineProperty(e, "__esModule", { value: !0 }), e.rulesToLatex = e.filterEmptyRules = void 0, e.filterEmptyRules = a, e.rulesToLatex = o, e.default = function (e) { if (8 !== e.version) throw new Error("Unexpected version: " + e.version); var p = !1; e.graph && e.graph.degreeMode && (p = !0); for (var b, v, x = e.expressions.ticker || n.DEFAULTS, g = 0, k = 0, h = [], I = 0, _ = e.expressions.list; I < _.length; I++) { var y = _[I]; switch (y.type) { case "expression": l(y, w = i.__assign({}, y), p), t(y, w); var O = void 0; if (y.clickableInfo && y.clickableInfo.rules) { var m = y.clickableInfo, z = m.rules, L = i.__rest(m, ["rules"]), S = o(j = a(z)); if (j.length > 1) { b || (b = s(e)), g = f(b, g), v || (v = d(e)), k = c(v, k); var P = "A_{" + g + "}"; L.latex = P, O = { type: "expression", id: "" + k, latex: P + "=" + S }, void 0 !== y.folderId && (O.folderId = y.folderId) } else L.latex = S; w.clickableInfo = L } w.clickableInfo && w.clickableInfo.enabled && w.hidden && (w.clickableInfo.enabled = !1), h.push(w), O && h.push(O); break; case "image": if (y.clickableInfo && y.clickableInfo.rules) { var w = i.__assign({}, y), A = y.clickableInfo; z = A.rules, L = i.__rest(A, ["rules"]), S = o(j = a(z)), O = void 0; if (j.length > 1) { b || (b = s(e)), g = f(b, g), v || (v = d(e)), k = c(v, k); P = "A_{" + g + "}"; L.latex = P, O = { type: "expression", id: "" + k, latex: P + "=" + S }, void 0 !== y.folderId && (O.folderId = y.folderId) } else L.latex = S; w.clickableInfo = L, h.push(w), O && h.push(O) } else h.push(y); break; case "simulation": var j, E = void 0; if (y.clickableInfo && y.clickableInfo.rules) E = o(j = a(y.clickableInfo.rules)); else E = ""; if (y.isPlaying && "" !== E) b || (b = s(e)), E = (P = "A_{" + (g = f(b, g)) + "}") + "=" + E, x = u(P, y.fps); w = { type: "expression", id: y.id, latex: E }; void 0 !== y.folderId && (w.folderId = y.folderId), h.push(w); break; default: h.push(y) } } return { version: 9, randomSeed: e.randomSeed || r.default(), graph: e.graph, expressions: { list: h, ticker: x } } } });
define('core/graphing-calc/migrations/10', ["require", "exports", "tslib"], function (require, e, i) { "use strict"; function s(e) { e.clickableInfo && (void 0 === e.description && void 0 !== e.clickableInfo.description && (e.description = e.clickableInfo.description), delete e.clickableInfo.description, 0 === Object.keys(e.clickableInfo).length && delete e.clickableInfo) } Object.defineProperty(e, "__esModule", { value: !0 }), e.backport10To9 = void 0, e.default = function (e) { if (9 !== e.version) throw new Error("Unexpected version: " + e.version); for (var n = [], r = {}, o = 0, a = e.expressions.list; o < a.length; o++) { var t = a[o]; switch (t.type) { case "expression": s(c = i.__assign({}, t)), n.push(c); break; case "image": var c; s(c = i.__assign({}, t)); var l = c.description; void 0 !== l && "" !== l || !c.draggable || void 0 === c.center || "" === c.center || (void 0 === r[c.center] ? r[c.center] = [c] : r[c.center].push(c)), n.push(c); break; default: n.push(t) } } for (var d = 0, p = n; d < p.length; d++) { var v = p[d]; if ("expression" === v.type && void 0 !== v.latex && "" !== v.latex && -1 !== v.latex.indexOf("=") && void 0 !== v.dragMode && "NONE" !== v.dragMode && void 0 !== v.label && "" !== v.label) { var _ = r[v.latex.slice(0, v.latex.indexOf("="))]; if (void 0 !== _) for (var f = 0, g = _; f < g.length; f++) { g[f].description = v.label } } } return i.__assign(i.__assign({}, e), { version: 10, expressions: i.__assign(i.__assign({}, e.expressions), { list: n }) }) }, e.backport10To9 = function (e) { if (10 !== e.version) throw new Error("Unexpected version: " + e.version); for (var s, n = [], r = 0, o = e.expressions.list; r < o.length; r++) { var a = o[r]; switch (a.type) { case "expression": case "image": var t = i.__assign({}, a); void 0 !== (s = t).description && (s.clickableInfo = i.__assign(i.__assign({}, s.clickableInfo), { description: s.description })), n.push(t); break; default: n.push(a) } } return i.__assign(i.__assign({}, e), { version: 9, expressions: i.__assign(i.__assign({}, e.expressions), { list: n }) }) } });
define('core/graphing-calc/migrate-state', ["require", "exports", "./migrations/0", "./migrations/1", "./migrations/2", "./migrations/3", "./migrations/4", "core/graphing-calc/validate-state", "./migrations/5", "./migrations/6", "./migrations/7", "./migrations/8", "./migrations/9", "./migrations/10"], function (require, e, r, t, n, i, o, a, s, u, l, c, d, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.migrateToPersisted = e.migrateToLatest = e.currentVersion = e.persistedVersion = void 0; var g = [r, t, n, i, o, s.migrateState, u.migrateState, l.default, c.default, d.default, v.default]; function f(r) { if (r.version > e.currentVersion) return "undefined" != typeof console && console.warn && console.warn("Loading saved state with version " + r.version + " but last known version is " + e.currentVersion + ". States saved in a newer version of the calculator may not load correctly in an older version of the calculator."), a.validateState(r); if (r.hasOwnProperty("version") && !g[r.version]) return "undefined" != typeof console && console.warn && console.warn("State has invalid version " + r.version + ". If a version is present, it should be a non-negative integer less than or equal to " + e.currentVersion + "."), a.validateState(r); for (r.hasOwnProperty("version") || (r = g[0](r)); r.version < e.currentVersion;)r = g[r.version + 1](r); return a.validateState(r) } e.persistedVersion = 9, e.currentVersion = 10, e.migrateToLatest = f, e.migrateToPersisted = function (e) { return function (e) { return v.backport10To9(e) }(f(e)) } });
define('core/types/line-width', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.THICK = e.DEFAULT = e.THIN = void 0, e.THIN = 1, e.DEFAULT = 2.5, e.THICK = 5 });
define('lib/smart-slider-defaults', ["require", "exports", "core/math/baseparser", "core/types/line-width", "core/types/point-size", "core/types/point-opacity", "core/types/line-opacity", "core/types/opacity"], function (require, e, i, n, a, r, t, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.checkVariableForBoundRestrictions = e.computeDefaults = void 0; var u = function (e) { return { value: "0", min: "0", max: e.degreeMode ? "360" : "2\\pi" } }, l = { latex: void 0, polarDomainMin: void 0, polarDomainMax: void 0, parametricDomainMin: void 0, clickableInfoLatex: void 0, parametricDomainMax: void 0, pointSize: function () { return { value: a.DEFAULT + "", min: "0", max: "10" } }, labelAngle: u, labelSize: function () { return { value: "1", min: "0", max: "5" } }, lineWidth: function () { return { value: n.DEFAULT + "", min: "0", max: "10" } }, fillOpacity: function () { return { value: o.DEFAULT + "", min: "0", max: "1" } }, lineOpacity: function () { return { value: t.DEFAULT + "", min: "0", max: "1" } }, pointOpacity: function () { return { value: r.DEFAULT + "", min: "0", max: "1" } }, sliderMin: void 0, sliderMax: void 0, sliderStep: void 0, residualVariable: void 0, tableHeader: void 0, tableCellValue: void 0, imageOpacity: function () { return { value: "1", min: "0", max: "1" } }, imageCenter: void 0, imageHeight: function () { return { value: "10", min: "-10", max: "10" } }, imageWidth: function () { return { value: "10", min: "-10", max: "10" } }, imageAngle: u, tickerMinStep: function () { return { value: "0", min: "0" } }, tickerHandler: void 0 }, c = { rgb: { paramBounds: function (e) { return { value: "0", min: "0", max: "255", step: "1" } } }, hsv: { paramBounds: function (e) { return 0 === e ? { value: "0", min: "0", max: "360", step: "1" } : { value: "0.5", min: "0", max: "1" } } } }; function m(e, i, n) { var a = i.parsed, r = i.location; if ("Identifier" === a.type && a._symbol === e) { var t = l[r]; if (!t) return; return [t(n)] } "Assignment" === a.type && (a = a._expression); var o = []; switch (a.type) { case "FunctionCall": var u = a._symbol; if (c.hasOwnProperty(u)) { var m = c[u]; a.args.forEach(function (i, n) { if ("Identifier" === i.type && i._symbol === e) { var a = m.paramBounds(n); a && o.push(a) } }) } break; default: return }return o } e.computeDefaults = function (e, n, a) { for (var r = e.map(function (e) { return { location: e.location, parsed: i.parse(e.latex) } }), t = {}, o = 0, u = n; o < u.length; o++)for (var l = u[o], c = 0, p = r; c < p.length; c++) { var s = m(l, p[c], a); s && s.length && (t[l] = s[0]) } return t }, e.checkVariableForBoundRestrictions = m });
define('graphing-calc/models/focus', ["require", "exports", "./expression", "./list"], function (require, e, t, o) { "use strict"; function i(e, t, o) { s(e, n(e, t, o)) } function s(e, i) { if (e.focusLocation = i, i && ("ticker" === i.type && (e.getListModel().ticker.playing = !1, o.setSelected(e.getListModel(), void 0)), "settings" !== i.type && "editable-label" !== i.type && "add-item-btn" !== i.type && "add-expression-btn" !== i.type && "add-note-btn" !== i.type && "add-table-btn" !== i.type && "add-folder-btn" !== i.type && "add-ticker-btn" !== i.type && "add-image-btn" !== i.type && "edit-list-toggle" !== i.type && "hide-expression-list-btn" !== i.type && "show-expression-list-btn" !== i.type && "search-expressions" !== i.type && "replace-expressions" !== i.type && "ticker" !== i.type && "regression-output" !== i.type)) { var s = e.getItemModel(i.id); "expression-menu" !== i.type ? (o.setSelected(e.getListModel(), s), s && "expression" === s.type && t.setSliderIsPlaying(s, !1)) : o.setSelected(e.getListModel(), void 0) } } function n(e, t, o) { var i = e.getItemModel(t); if (i) switch (i.type) { case "expression": return { type: e.isInEditListMode() ? "readonly-expression" : i.type, id: t }; case "folder": case "text": return { type: i.type, id: t }; case "table": var s = { row: 1, column: 0 }, n = !1; return o && ("cell" === o.location ? s = { row: o.row, column: o.column } : "end" === o ? s = { row: i.columnModels[0].cells.length, column: 0 } : "start" === o ? s = { row: 0, column: 0 } : "container" === o && (n = !0)), n ? { type: "table-container", id: t } : { type: i.type, id: t, location: s }; case "image": return { type: i.type, id: t, location: "name" }; default: return i } } Object.defineProperty(e, "__esModule", { value: !0 }), e.focusTableCell = e.getFocusedItem = e.addFocusForKeypad = e.computeFocusLocationForItem = e.setFocusLocation = e.moveFocusToItem = void 0, e.moveFocusToItem = i, e.setFocusLocation = s, e.computeFocusLocationForItem = n, e.addFocusForKeypad = function (e) { var t = e.getSelectedItem(); if (t && "expression" === t.type) i(e, t.id); else if (!t || "table" !== t.type || !e.focusLocation) { for (var s = e.getFirstFullyVisibleItem(), n = e.getListModel(); s && "expression" !== s.type;)s = o.findNextSelectableItem(n, s.index); if (s) i(e, s.id); else { var d = e.createItemModel({ type: "expression", id: e.generateId(), color: e.getNextColor() }); o.insertItemAtEnd(e.getListModel(), d), i(e, d.id) } } }, e.getFocusedItem = function (e) { var t = e.focusLocation; if (t && "settings" !== t.type && "editable-label" !== t.type && "add-item-btn" !== t.type && "add-expression-btn" !== t.type && "add-note-btn" !== t.type && "add-table-btn" !== t.type && "add-ticker-btn" !== t.type && "add-folder-btn" !== t.type && "add-image-btn" !== t.type && "edit-list-toggle" !== t.type && "hide-expression-list-btn" !== t.type && "show-expression-list-btn" !== t.type && "search-expressions" !== t.type && "replace-expressions" !== t.type && "ticker" !== t.type && "regression-output" !== t.type) return e.getItemModel(t.id) }, e.focusTableCell = function (e, t, o) { s(e, { type: "table", id: t, location: o }) } });
define('graphing-calc/actions/keyboard', ["require", "exports", "browser", "lib/conditional_blur", "../models/table", "../models/focus", "../models/list", "../models/abstract-item"], function (require, e, t, o, l, i, d, r) { "use strict"; function s(e) { var t = e.getSelectedItem(); t && (e.inAudioTraceMode() || (!d.selectPrevItem(e.getListModel()) && e.getTickerOpen() && i.setFocusLocation(e, { type: "ticker", location: "handler" }), (t = e.getSelectedItem()) && i.moveFocusToItem(e, t.id, "end"))) } function n(e) { var t; if (!e.inAudioTraceMode()) { if ("ticker" === (null === (t = e.getFocusLocation()) || void 0 === t ? void 0 : t.type)) { var o = d.getFirstSelectableItem(e.getListModel()); if (o) return i.moveFocusToItem(e, o.id, "start") } if (!d.selectNextItem(e.getListModel()) && !e.isInEditListMode()) { var l = e.createItemModel({ type: "expression", id: e.generateId(), color: e.getNextColor() }); d.insertItemAtEnd(e.getListModel(), l), d.setSelected(e.getListModel(), l) } var r = e.getSelectedItem(); r && i.moveFocusToItem(e, r.id, "start") } } function c(e) { if (!e.isInEditListMode()) { var o = e.getSelectedItem(); if (o && (1 !== e.getItemCount() || "expression" !== o.type)) { var l = "text" === o.type, s = d.getParentFolderModel(o); if (s) { var n = e.getNumberOfItemsInFolder(s.id); if (o.index === s.index + n) return void r.setFolderId(o, "") } u(e, { moveSelection: !0 }), l && t.IS_IPAD && t.IS_IN_IFRAME ? d.setSelected(e.getListModel(), void 0) : (o = e.getSelectedItem()) && i.moveFocusToItem(e, o.id, "end") } } } function a(e) { if (!e.isInEditListMode()) { var t = e.getSelectedItem(); t && (1 === e.getItemCount() && "expression" === t.type || (I(e, { moveSelection: !0 }), (t = e.getSelectedItem()) && i.moveFocusToItem(e, t.id, "start"))) } } function m(e) { if (!e.isInEditListMode()) { var l = e.getSelectedItem(); if (l) { if ("text" === l.type && t.IS_IPAD && t.IS_IN_IFRAME) return o.default(), void d.setSelected(e.getListModel(), void 0); if (d.getMissingVariablesForItem(l).length && e.areSlidersEnabled()) return e.createSlidersForItem(l.id, d.getMissingVariablesForItem(l).concat("")); var s = e.createItemModel({ type: "expression", id: e.generateId(), color: e.getNextColor() }), n = l.index + 1; "folder" === l.type && l.collapsed && (n += e.getNumberOfItemsInFolder(l.id)), d.insertItemAtIndex(e.getListModel(), s, n), d.setSelected(e.getListModel(), s), "folder" !== l.type || l.collapsed ? "folder" !== l.type && l.folderId && r.setFolderId(s, l.folderId) : r.setFolderId(s, l.id), (l = e.getSelectedItem()) && i.moveFocusToItem(e, l.id) } } } function u(e, t) { var o = t.moveSelection, l = f(e), i = e.getListModel(); if (l) { var r = d.findPrevSelectableItem(i, l.index); if (e._removeExpressionSynchronously(l), o) { if (!r) { var s = d.getFirstSelectableItem(i); s && (r = s) } d.setSelected(i, r) } else d.setSelected(i, void 0) } } function I(e, t) { var o = t.moveSelection, l = f(e), i = e.getListModel(); if (l) { var r = d.findNextSelectableItem(i, l.index); if (e._removeExpressionSynchronously(l), o) { if (!r) { var s = d.getLastSelectableItem(i); s && (r = s) } d.setSelected(i, r) } else d.setSelected(i, void 0) } } function f(e) { var t = e.getSelectedItem(); return "folder" == (null == t ? void 0 : t.type) && t.collapsed && t.selectedHiddenChild ? t.selectedHiddenChild : t } Object.defineProperty(e, "__esModule", { value: !0 }), e.downwardDeleteSelectedExpression = e.upwardDeleteSelectedExpression = e.onEnterPressed = e.onDeletePressed = e.onBackspacePressed = e.onDownPressed = e.onUpPressed = e.navigateTableByKey = void 0, e.navigateTableByKey = function (e, t, o) { var d = e.getItemModel(t); if (d && "table" === d.type) { var r = d, u = l.getSelectedCell(r), I = u ? u.row : -1, f = u ? u.column : -1, v = r.columnModels, g = v[0].cells.length, S = v.length, p = function (o, l) { -1 === o ? s(e) : o > g ? n(e) : (-1 === l ? (l = S - 1, o--) : l === S && (o++, l = 0), i.focusTableCell(e, t, { row: o, column: l })) }, b = function (o) { g > 2 && l.removeRow(r, I - 1), i.focusTableCell(e, t, { row: o, column: f }) }, M = function (o) { 0 === f || S <= 2 || (l.removeColumn(r, f), i.focusTableCell(e, t, { row: I, column: o })) }; switch (o) { case "Left": p(I, f - 1); break; case "Right": p(I, f + 1); break; case "Up": p(I - 1, f); break; case "Down": p(I + 1, f); break; case "Enter": if (I >= g) return m(e); if (f > 0) return p(I + 1, f); if (I === g - 1) { var x = l.getRowAutoFillValues(r, I); l.insertBlankRow(r, I); for (var w = 0; w < x.length; w++)l.setCellLatex(r, { row: I + 1, column: w }, x[w]); return void i.focusTableCell(e, t, { row: I + 1, column: f }) } l.insertBlankRow(r, I), i.focusTableCell(e, t, { row: I + 1, column: f }); break; case "Backspace": 0 === I ? 0 === f ? c(e) : f === S - 1 || 1 === f && 3 === S ? p(0, f - 1) : M(f - 1) : 0 !== f ? p(I, f - 1) : I === g ? p(I - 1, f) : b(I - 1); break; case "Delete": 0 === I ? 0 === f ? a(e) : f < S - 1 && M(f) : I >= g || b(I) } } }, e.onUpPressed = s, e.onDownPressed = n, e.onBackspacePressed = c, e.onDeletePressed = a, e.onEnterPressed = m, e.upwardDeleteSelectedExpression = u, e.downwardDeleteSelectedExpression = I });
define('main/expression-zoom-helpers', ["require", "exports", "core/lib/deepCopy"], function (require, i, n) { "use strict"; function m(i) { var m = 1.2; return (i = n.default(i)).xmax < 0 && i.xmin < 0 && i.xmax / (i.xmin - i.xmax) < m && (i.xmax = 0), i.xmax > 0 && i.xmin > 0 && i.xmin / (i.xmax - i.xmin) < m && (i.xmin = 0), i.ymax < 0 && i.ymin < 0 && i.ymax / (i.ymin - i.ymax) < m && (i.ymax = 0), i.ymax > 0 && i.ymin > 0 && i.ymin / (i.ymax - i.ymin) < m && (i.ymin = 0), i } function x(i, n) { var m, x, a, t, e = i.type, r = function (i, n) { if ("dotplot" === i.type || "histogram" === i.type) { var m = 80 * Math.max(1, i.xmax - i.xmin) / (i.binWidth ? i.binWidth : 1), x = .5 * (n.screen.width - m) / m; return Math.max(.2, x) } return .5 }(i, n), o = function (i) { return "boxplot" === i ? 3 : .5 }(e); i.xmin === i.xmax && (i.xmin -= .5, i.xmax += .5), i.ymin === i.ymax && (i.ymin -= .5, i.ymax += .5); var y = i.xmax - i.xmin; m = i.xmin - r * y, x = i.xmax + r * y; var s = i.ymax - i.ymin; if (a = i.ymin - o * s, t = i.ymax + o * s, function (i) { return "boxplot" === i || "dotplot" === i || "histogram" == i }(e)) { var p = (x - m) * (n.screen.height / n.screen.width); if (p > i.ymax - i.ymin && p < function (i) { switch (i) { case "histogram": case "dotplot": return 12; case "boxplot": return 40 }return 1 / 0 }(e) * (i.ymax - i.ymin)) { var u = .5 * (i.ymax + i.ymin); t = u + .5 * p, a = u - .5 * p } } return { xmin: m, xmax: x, ymin: a, ymax: t } } function a(i, n) { for (var a = 1 / 0, t = -1 / 0, e = 1 / 0, r = -1 / 0, o = 0, y = i.length, s = 0; s < y; s++) { var p = m(i[s]); if (isFinite(p.xmax - p.xmin) && isFinite(p.ymax - p.ymin)) { var u = x(p, n); u.xmin < a && (a = u.xmin), u.xmax > t && (t = u.xmax), u.ymin < e && (e = u.ymin), u.ymax > r && (r = u.ymax) } else o += 1 } if (o !== y) return { xmin: a, xmax: t, ymin: e, ymax: r } } Object.defineProperty(i, "__esModule", { value: !0 }), i.getRecommendedViewportForExpression = i.shouldExpressionZoomFit = i.padViewport = i.conditionalExpandViewport = void 0, i.conditionalExpandViewport = m, i.padViewport = x, i.shouldExpressionZoomFit = function (i, n) { var m = a(i, n); if (!m) return !1; var x = n.mapx(m.xmin), t = n.mapx(m.xmax), e = n.mapy(m.ymin), r = n.mapy(m.ymax); return !(Math.abs(x) <= 10 && Math.abs(r) <= 10 && Math.abs(t - n.screen.width) <= 10 && Math.abs(e - n.screen.height) <= 10) }, i.getRecommendedViewportForExpression = a });
define('main/layout-model', ["require", "exports", "browser"], function (require, e, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.defaultLayoutModel = e.getShiftedLayoutForCurrentLayout = void 0, e.getShiftedLayoutForCurrentLayout = function (e) { switch (e) { case "letters": return "capitalLetters"; case "noQwertyLetters": return "noQwertyCapitalLetters"; case "noQwertyCapitalLetters": return "noQwertyLetters"; default: return "letters" } }, e.defaultLayoutModel = function (e) { return { keypadMinimized: !t.IS_TOUCH_DEVICE, keypadLayout: "mainNumbers", keypadFunctionsOpen: !1, graphSettingsOpen: !1, addExpressionOpen: !1, expressionsVisible: !!e.expressions, inEditListMode: !1, isFileDraggedOver: !1, expressionsHiddenTime: void 0 } } });
define('main/settings-view-model', ["require", "exports", "tslib", "core/lib/label"], function (require, t, i, e) { "use strict"; function n(t, i) { var n = e.value(t, i), a = ""; if (n.mantissa) a = n.mantissa.split("Ã").join("\\cdot") + "^{" + n.superscript + "}"; else { var m = n.string.split("/"); a = 2 === m.length ? "-" === m[0][0] ? "-\\frac{" + m[0].slice(1) + "}{" + m[1] + "}" : "\\frac{" + m[0] + "}{" + m[1] + "}" : n.string } return a = a.replace(/Ï/, "\\pi") } function a(t) { return { xmin: n(t.xmin, t.xmax - t.xmin), xmax: n(t.xmax, t.xmax - t.xmin), ymin: n(t.ymin, t.ymax - t.ymin), ymax: n(t.ymax, t.ymax - t.ymin) } } function m(t, i) { return 0 === t ? "" : n(t, i) } Object.defineProperty(t, "__esModule", { value: !0 }), t.defaultSettingsViewModel = t.limitLatex = t.formatStep = t.formatViewport = t.formatLatex = void 0, t.formatLatex = n, t.formatViewport = a, t.formatStep = m, t.limitLatex = function (t, e, n) { var r = a(t); return i.__assign(i.__assign({}, r), { xstep: m(e, t.xmax - t.xmin), ystep: m(n, t.ymax - t.ymin) }) }, t.defaultSettingsViewModel = function () { return { limitLatex: { xmin: "", xmax: "", xstep: "", ymin: "", ymax: "", ystep: "" } } } });
define('expressions/move-point', ["require", "exports", "core/lib/dragmode", "core/lib/number-to-latex", "core/lib/label", "lib/rounding", "graphing-calc/models/expression", "core/math/poi", "core/math/functions", "../core/math/distance"], function (require, e, t, o, r, i, a, n, d, l) { "use strict"; function m(e, t, o, r) { var a, d, l, m = function (t) { var o = r(t), i = o[0], a = o[1]; return e.mathToPixels.mapPoint({ x: i, y: a }) }, p = function (t) { var o = t.x, r = t.y, i = e.pixelCoordinates, a = i.left, n = i.right, d = i.top, l = i.bottom; return o >= a && o <= n && r >= d && r <= l }, s = t, u = m(t), c = o, v = m(o); if (p(v)) return o; if (!p(u)) return o; for (; ;) { var f = u.x - v.x, x = u.y - v.y; if (f * f + x * x < .5) break; var g = n.floatMiddle(s, c); if (g === s || g === c) { s = (a = p(u) ? [s, s] : [c, c])[0], c = a[1]; break } var y = m(g); p(y) !== p(u) ? (c = (d = [g, y])[0], v = d[1]) : (s = (l = [g, y])[0], u = l[1]) } return i.shortestDecimalBetween(s, c) } function p(e, t, a) { if (!e.move_strategy) throw new Error("Programming error: expected move_strategy to be defined."); var n; n = e.assignment ? r.identifierToLatex(e.assignment) + "=" : ""; var d = i.shortestDecimalBetween(t[0].min, t[0].max), l = i.shortestDecimalBetween(t[1].min, t[1].max), m = "updateCoordinate" === e.move_strategy[0].type && s(0, a), p = "updateCoordinate" === e.move_strategy[1].type && s(1, a); return { latex: n + "\\left(" + (m ? o.default(d) : e.move_strategy[0].inputString) + "," + (p ? o.default(l) : e.move_strategy[1].inputString) + "\\right)", x: m ? d : void 0, y: p ? l : void 0 } } function s(e, o) { switch (o) { case t.DragMode.X: return 0 === e; case t.DragMode.Y: return 1 === e; case t.DragMode.XY: return !0; default: return !1 } } Object.defineProperty(e, "__esModule", { value: !0 }), e.canMoveCoordinate = e.newPointLatex = e.computeMovablePointUpdateForScreenPoint = e.computeParametricPointUpdateForMouse = e.computeParametricPointUpdateForKeyboard = e.applyMovablePointUpdate = void 0, e.applyMovablePointUpdate = function (e, t, o, r) { if (!o) return !1; var i = e.pixelCoordinates, n = i.left, d = i.right, l = i.top, m = i.bottom, p = o.mathPoint, s = p.x, u = p.y; if (void 0 !== s) { var c = e.mathToPixels.mapX(s); if (c < n - .5 || c > d + .5) return !1 } if (void 0 !== u) { var v = e.mathToPixels.mapY(u); if (v < l - .5 || v > m + .5) return !1 } var f = !1; if (o.newPointLatex) { var x = t.latex; a.setLatex(t, o.newPointLatex), f = f || x !== t.latex } for (var g in o.sliderUpdates) { var y = o.sliderUpdates[g], h = y.value, P = y.model; r && a.commitSliderSoftLimits(P); x = P.latex; a.adjustSliderByMovablePoint(P, h), f = f || x !== P.latex } return f }, e.computeParametricPointUpdateForKeyboard = function (e) { var t, o, r = e.projection, p = e.controller, s = e.strategy, u = e.mode, c = p.getItemModel(s.id); if (!c || "expression" !== c.type) throw new Error("Programming error: updateSliderNonlinear move strategy should point to an expression item, but found " + (null == c ? void 0 : c.type)); var v = "up" === u || "bigup" === u, f = "" !== (null === (o = c.slider) || void 0 === o ? void 0 : o.step) && (v && !c.slider.hardMax || !v && !c.slider.hardMin); s.compiled.fn || d.rehydrateCompiledFunction(s.compiled); var x = s.compiled.fn, g = function (e) { var t, o = x(e), i = o[0], a = o[1]; return [i = (t = r.mathToPixels.mapPoint({ x: i, y: a })).x, a = t.y] }, y = a.getSliderValue(c), h = g(y), P = h[0], S = h[1], b = a.computeSliderKeyboardAdjustment(c, u, { ignoreSoftLimits: f }), M = b, w = g(M), C = w[0], U = w[1], L = l.hypot(C - P, U - S); if (L < 1) { var D = n.findLocalClosestPointOnParametric(g, [P + (C - P) / L, S + (U - S) / L], M, M > y ? M : s.min, M < y ? M : s.max, 1); if (D) { var F = i.shortestDecimalBetween(D[0], D[1]); "bigup" !== u && "bigdown" !== u || (F = y + 5 * (F - y)); var _ = a.computeSliderSnappedValue(c, n.clamp(F, s.min, s.max), { ignoreSoftLimits: f }), B = g(_), T = B[0], V = B[1]; l.hypot(T - P, V - S) > L && (b = _) } } var j = m(r, a.getSliderValue(c), b, x), E = x(j); return { mathPoint: { x: E[0], y: E[1] }, sliderUpdates: (t = {}, t[s.id] = { model: c, value: j }, t) } }, e.computeParametricPointUpdateForMouse = function (e) { var t = e.controller, o = e.projection, r = e.strategy, l = e.targetScreenPoint, p = { mathPoint: {}, sliderUpdates: {} }, s = t.getItemModel(r.id); if (!s || "expression" !== s.type) throw new Error("Programming error: updateSliderNonlinear move strategy should point to an expression item, but found " + (null == s ? void 0 : s.type)); r.compiled.fn || d.rehydrateCompiledFunction(r.compiled); var u = r.compiled.fn, c = r.initialValue, v = r.min, f = r.max, x = [l.x, l.y], g = n.findLocalClosestPointOnParametric(function (e) { var t, r = u(e), i = r[0], a = r[1]; return [i = (t = o.mathToPixels.mapPoint({ x: i, y: a })).x, a = t.y] }, x, c, v, f, 1); if (!g) return p; var y = i.shortestDecimalBetween(g[0], g[1]); void 0 !== v && y < v && (y = v), void 0 !== f && y > f && (y = f); var h = a.computeSliderSnappedValue(s, y, { ignoreSoftLimits: !0 }), P = m(o, a.getSliderValue(s), h, u), S = u(P), b = S[0], M = S[1]; return p.mathPoint.x = b, p.mathPoint.y = M, p.sliderUpdates[s.id] = { value: P, model: s }, p }, e.computeMovablePointUpdateForScreenPoint = function (e) { var t = e.controller, o = e.projection, r = e.formula, n = e.moveStrategy, d = e.dragMode, l = e.targetScreenPoint, m = o.pixelsToMath.mapRect({ left: l.x - .5, right: l.x + .5, top: l.y + .5, bottom: l.y - .5 }), u = [{ min: m.left, max: m.right }, { min: m.top, max: m.bottom }], c = { mathPoint: {}, sliderUpdates: {} }, v = n[0], f = n[1]; if ("updateCoordinate" === v.type || "updateCoordinate" === f.type) { var x = p(r, u, d), g = x.latex, y = x.x, h = x.y; void 0 === y && void 0 === h || (c.newPointLatex = g, c.mathPoint.x = null != y ? y : c.mathPoint.x, c.mathPoint.y = null != h ? h : c.mathPoint.y) } for (var P = 0, S = [0, 1]; P < S.length; P++) { var b = S[P], M = n[b]; if (s(b, d) && "updateSlider" === M.type) { var w = t.getItemModel(M.id); if (!w || "expression" !== w.type) continue; var C = M.coefficients, U = C[0], L = C[1], D = i.shortestDecimalBetween(L * u[b].min + U, L * u[b].max + U), F = a.computeSliderSnappedValue(w, D, { ignoreSoftLimits: !0 }), _ = (F - U) / L, B = 0 === b ? [o.mathCoordinates.left, o.mathCoordinates.right] : [o.mathCoordinates.bottom, o.mathCoordinates.top], T = B[0], V = B[1], j = _ < T ? T : _ > V ? V : void 0; void 0 !== j && void 0 === a.getSliderStep(w) ? (c.mathPoint[0 === b ? "x" : "y"] = j, c.sliderUpdates[w.id] = { value: L * j + U, model: w }) : (c.mathPoint[0 === b ? "x" : "y"] = _, c.sliderUpdates[w.id] = { value: F, model: w }) } } return c }, e.newPointLatex = p, e.canMoveCoordinate = s });
define('expressions/list_move_controller', ["require", "exports", "core/lib/dragmode", "core/lib/number-to-latex", "lib/rounding", "graphing-calc/models/expression", "graphing-calc/models/table", "graphing-calc/models/list", "graphing-calc/models/image", "core/math/poi", "core/math/functions", "../graphing/projection", "./move-point"], function (require, e, t, r, i, o, n, a, l, d, g, s, p) { "use strict"; function c(e, t) { return { left: e.x - t, right: e.x + t, top: e.y + t, bottom: e.y - t } } function h(e, t, r) { if (0 === r[0] && 0 === r[1]) return { x: t.x, y: t.y, width: e.width, height: e.height }; var i = Math.cos(e.radianAngle), o = Math.sin(e.radianAngle), n = t.x - e.x, a = t.y - e.y; if (0 === r[0]) return { x: e.x, y: e.y, width: e.width, height: 2 * r[1] * (i * a + o * n) }; if (0 === r[1]) return { x: e.x, y: e.y, width: 2 * r[0] * (i * n - o * a), height: e.height }; var l = 2 * (e.width * r[0] * (i * n - o * a) + e.height * r[1] * (o * n + i * a)) / (e.width * e.width + e.height * e.height); return { x: e.x, y: e.y, width: l * e.width, height: l * e.height } } function m(e) { return void 0 === e ? NaN : e[0] } function u(e, t, n, a, d) { var g, s = t.formula; if (!s || 4 !== (null === (g = s.move_strategy) || void 0 === g ? void 0 : g.length)) return !1; var p = s.dimensions, u = { x: m(p.x), y: m(p.y), width: m(p.width), height: m(p.height), radianAngle: m(p.radianAngle) }, y = n.scaleFactor || [0, 0], f = 0 !== y[0] && 0 !== y[1], v = d.closestPointOnScreen(a), x = function (e, t, r) { for (var i = ["x", "y", "width", "height"], o = { x: 1 / 0, y: 1 / 0, width: 1 / 0, height: 1 / 0 }, n = { x: -1 / 0, y: -1 / 0, width: -1 / 0, height: -1 / 0 }, a = 0, l = [{ x: t.left, y: t.bottom }, { x: t.left, y: t.top }, { x: t.right, y: t.top }, { x: t.right, y: t.bottom }]; a < l.length; a++)for (var d = h(e, l[a], r), g = 0, s = i; g < s.length; g++) { var p = s[g]; o[p] = Math.min(o[p], d[p]), n[p] = Math.max(n[p], d[p]) } return { min: o, max: n } }(u, d.pixelsToMath.mapRect(c(v, f ? .05 : .5)), y), b = d.mathToPixels.mapRect({ left: u.x - .5 * u.width, right: u.x + .5 * u.width, top: u.y - .5 * u.height, bottom: u.y + .5 * u.height }), M = Math.abs(b.right - b.left), P = Math.abs(b.bottom - b.top), S = d.mathToPixels.mapRect({ left: x.min.x - .5 * x.min.width, right: x.min.x + .5 * x.min.width, top: x.min.y - .5 * x.min.height, bottom: x.min.y + .5 * x.min.height }), w = Math.abs(S.right - S.left), I = Math.abs(S.bottom - S.top); if (w < M && w < 1 || I < P && I < 1) return !1; for (var D = ["width", "height", "x", "y"], _ = !1, O = 0; O < D.length; O++) { var j = D[O], N = s.move_strategy[O]; switch (N.type) { case "updateCoordinate": var C = i.shortestDecimalBetween(x.min[j], x.max[j]), B = r.default(C); switch (j) { case "width": case "height": l.setMQAttribute(t, j, B); break; case "x": if ("updateCoordinate" === s.move_strategy[3].type) { var A = i.shortestDecimalBetween(x.min.y, x.max.y), G = "\\left(" + B + "," + r.default(A) + "\\right)"; l.setMQAttribute(t, "center", G) } else { G = "\\left(" + B + "," + s.move_strategy[3].inputString + "\\right)"; l.setMQAttribute(t, "center", G) } break; case "y": if ("updateCoordinate" !== s.move_strategy[2].type) { G = "\\left(" + s.move_strategy[2].inputString + "," + B + "\\right)"; l.setMQAttribute(t, "center", G) } break; default: return j }_ = !0; break; case "updateSlider": var T = e.getItemModel(N.id); if (!T || "expression" !== T.type) continue; var k = N.coefficients[0], U = N.coefficients[1], E = U * x.min[j] + k, F = U * x.max[j] + k, L = i.shortestDecimalBetween(E, F), R = T.latex; o.adjustSliderByMovablePoint(T, L), T.latex !== R && (_ = !0) } } return _ } Object.defineProperty(e, "__esModule", { value: !0 }), e.onMovePoint = e._legacyMovePoint = e.onStopMovingPoint = e.onStartMovingPoint = e.Projection = void 0, Object.defineProperty(e, "Projection", { enumerable: !0, get: function () { return s.Projection } }), e.onStartMovingPoint = function (e, r, i) { if (i.tableInfo) { a.setSelected(r, void 0); var d = e.getItemModel(i.tableInfo.tableId); if (!d || "table" !== d.type) return; n.setIsDraggingOnGrapher(d, !0) } else { var g = e.getItemModel(i.sketch.id); if (!g || "expression" !== g.type && "image" !== g.type) return; if ("image" !== g.type && a.setSelected(r, void 0), !g.formula || !g.formula.move_strategy) return; for (var s = g.formula.move_strategy, p = 0; p < s.length; p++) { var c = s[p]; if ("updateCoordinate" === c.type) "image" === g.type ? l.setIsDraggingOnGrapher(g, !0) : "expression" === g.type && o.setIsDraggingOnGrapher(g, !0); else if ("updateSlider" === c.type || "updateSliderNonlinear" === c.type) { var h, m = e.getItemModel(c.id); if (!m || "expression" !== m.type) continue; if ((h = "expression" === g.type ? g.reconciledDragMode : void 0) === t.DragMode.NONE || 0 === p && h === t.DragMode.Y || 1 === p && h === t.DragMode.X) continue; o.setSliderDragging(m, !0) } } } }, e.onStopMovingPoint = function (e, t) { for (var r = 0, i = e.getAllItemModels(); r < i.length; r++) { var a = i[r]; "table" === a.type ? a.draggingOnGraphpaper && n.setIsDraggingOnGrapher(a, !1) : "expression" === a.type ? (a.sliderDragging && o.setSliderDragging(a, !1), a.draggingOnGraphpaper && o.setIsDraggingOnGrapher(a, !1)) : "image" === a.type && a.draggingOnGraphpaper && l.setIsDraggingOnGrapher(a, !1) } }, e._legacyMovePoint = function (e, r, n, a, l) { var s = r.formula; if (!s || !s.move_strategy) return !1; var h = r.reconciledDragMode || t.DragMode.NONE, m = !1, u = a.closestPointOnScreen(n), y = a.pixelsToMath.mapRect(c(u, .5)), f = [{ min: y.left, max: y.right }, { min: y.top, max: y.bottom }]; "updateCoordinate" !== s.move_strategy[0].type && "updateCoordinate" !== s.move_strategy[1].type || (o.setLatex(r, p.newPointLatex(s, f, h).latex), m = !0); for (var v, x, b, M, P, S, w, I = function () { if ("updateSlider" !== (v = s.move_strategy[D]).type && "updateSliderNonlinear" !== v.type) return "continue"; if (!p.canMoveCoordinate(D, h)) return "continue"; if (!(x = e.getItemModel(v.id)) || "expression" !== x.type) return "continue"; if (b = x.latex, l && (M = 0 === D ? l.x : l.y), M) { var t = x.slider && "" !== x.slider.step && (("up" === M || "bigup" === M) && !x.slider.hardMax || ("down" === M || "bigdown" === M) && !x.slider.hardMin); o.adjustSliderByKeyboard(x, M, { ignoreSoftLimits: t }) } else if ("updateSlider" === v.type) P = v.coefficients[0], S = v.coefficients[1], w = i.shortestDecimalBetween(S * f[D].min + P, S * f[D].max + P), o.adjustSliderByMovablePoint(x, w); else if ("updateSliderNonlinear" === v.type) { v.compiled.fn || g.rehydrateCompiledFunction(v.compiled); var r = v.compiled.fn, n = v.initialValue, c = v.min, y = v.max, I = [u.x, u.y], _ = d.findLocalClosestPointOnParametric(function (e) { var t, i = r(e), o = i[0], n = i[1]; return [o = (t = a.mathToPixels.mapPoint({ x: o, y: n })).x, n = t.y] }, I, n, c, y, 1); if (_) { var O = i.shortestDecimalBetween(_[0], _[1]); void 0 !== c && O < c && (O = c), void 0 !== y && O > y && (O = y), o.adjustSliderByMovablePoint(x, O) } } x.latex !== b && (m = !0) }, D = 0; D < 2; D++)I(); return m }, e.onMovePoint = function (e, a, l, d, g, s) { if (a.tableInfo) return function (e, t, o, a) { var l = t.tableInfo.tableId, d = t.tableInfo.rowIndex, g = t.tableInfo.columnId, s = t.tableInfo.dragX, p = t.tableInfo.dragY, h = e.getItemModel(l); if (h && "table" === h.type) { var m = n.getColumnModel(h, g); if (m) { var u = a.closestPointOnScreen(o), y = a.pixelsToMath.mapRect(c(u, .5)), f = { x: r.default(i.shortestDecimalBetween(y.left, y.right)), y: r.default(i.shortestDecimalBetween(y.top, y.bottom)) }; if (s && n.setCellLatex(h, { row: d + 1, column: 0 }, f.x), p) { var v = m.index; n.setCellLatex(h, { row: d + 1, column: v }, f.y) } } } }(e, a, d, g), !0; var h = e.getItemModel(a.sketch.id); return !!h && ("image" === h.type ? u(e, h, a, d, g) : "expression" === h.type && function (e) { var r, i, n = e.controller, a = e.movedExpr, l = e.currentScreenPoint, d = e.targetScreenPoint, g = e.projection, s = e.keyboardDirection, c = a.formula; if (!c || 2 !== (null === (r = c.move_strategy) || void 0 === r ? void 0 : r.length)) return !1; var h = a.reconciledDragMode || t.DragMode.NONE, m = g.closestPointOnScreen(d), u = c.move_strategy[0]; if (!s) { var y = "updateSliderNonlinear" === u.type ? p.computeParametricPointUpdateForMouse({ controller: n, projection: g, strategy: u, targetScreenPoint: m }) : p.computeMovablePointUpdateForScreenPoint({ controller: n, projection: g, formula: c, moveStrategy: c.move_strategy, dragMode: h, targetScreenPoint: m }); return p.applyMovablePointUpdate(g, a, y, !1) } if ("updateSliderNonlinear" === u.type) return !!(null == s ? void 0 : s.x) && (y = p.computeParametricPointUpdateForKeyboard({ projection: g, controller: n, strategy: u, mode: s.x }), p.applyMovablePointUpdate(g, a, y, !0)); var f = s.x ? 0 : 1, v = s.x ? m.x - l.x : m.y - l.y, x = c.move_strategy[f]; if ("updateSlider" === x.type) { var b = n.getItemModel(x.id); if ("expression" !== (null == b ? void 0 : b.type)) throw new Error("Programming error: updateSlider move strategy should point to an expression item, but found " + (null == b ? void 0 : b.type)); var M = o.getSliderStep(b); if (M) { var P = g.mathToPixels.mapPoint({ x: 0, y: 0 }), S = x.coefficients[1], w = Math.abs(0 === f ? g.mathToPixels.mapX(S * M) - P.x : g.mathToPixels.mapY(S * M) - P.y); v = w * Math.ceil(1 / w) * (v > 0 ? 1 : -1); var I = null !== (i = s.x) && void 0 !== i ? i : s.y; "bigup" !== I && "bigdown" !== I || (v *= 5) } } return y = p.computeMovablePointUpdateForScreenPoint({ controller: n, projection: g, formula: c, moveStrategy: c.move_strategy, dragMode: h, targetScreenPoint: { x: l.x + (0 === f ? v : 0), y: l.y + (1 === f ? v : 0) } }), p.applyMovablePointUpdate(g, a, y, !0) }({ controller: e, movedExpr: h, currentScreenPoint: l, targetScreenPoint: d, projection: g, keyboardDirection: s })) } });
define('main/blank_state', ["require", "exports", "core/graphing-calc/migrate-state"], function (require, e, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.BLANK_STATE = void 0, e.BLANK_STATE = { version: r.currentVersion, randomSeed: "", graph: { viewport: { xmin: -10, ymin: -13.25, xmax: 10, ymax: 13.25 } }, expressions: { list: [{ id: "1", type: "expression" }] } }, e.default = e.BLANK_STATE });
define('expressions/measure-expressions', ["require", "exports", "jquery"], function (require, t, e) { "use strict"; function n(t) { for (var e = [], n = 0, r = t.getAllItemModels(); n < r.length; n++) { var i = r[n], o = t.getItemRootNodeById(i.id); o && e.push(o) } return e } function r(t, e) { for (var r = n(t), i = 0, o = r.length - 1; i <= o;) { var g = i + Math.floor((o - i) / 2), l = r[g], a = l.getBoundingClientRect(); if (a.top > e) o = g - 1; else { if (!(a.bottom < e)) return l; i = g + 1 } } } function i(t) { var r = l(t); if (r) { var i = function (t, e) { for (var r, i = n(t), o = 0, g = i.length - 1; o <= g;) { var l = o + Math.floor((g - o) / 2), a = i[l]; a.getBoundingClientRect().top > e ? (g = l - 1, r = a) : o = l + 1 } return r }(t, r.top - 2); if (i) return e(i).attr("expr-id") } } function o(t) { return t.find$(".dcg-exppanel")[0] } function g(t) { var n = o(t); if (n) return e(n) } function l(t) { var e = o(t); if (e) return e.getBoundingClientRect() } Object.defineProperty(t, "__esModule", { value: !0 }), t.getDragContainerHeight = t.getExpListHeight = t.getExppanelScrolledTop = t.getExppanelRect = t.getOuterExppanelRect = t.getExppanelSelector = t.getExppanelElt = t.getFirstFullyVisibleItemId = t.getLastVisibleItemId = t.getFirstVisibleItemId = void 0, t.getFirstVisibleItemId = function (t, n) { var o = l(t); if (o) { if (n) { var g = t.getItemRootNodeById(n); if (g) { var a = g.getBoundingClientRect(); if (a.height > 0 && a.top <= o.top && a.bottom >= o.top) return n } } var u = r(t, o.top); return u ? e(u).attr("expr-id") : i(t) } }, t.getLastVisibleItemId = function (t, n) { var i = l(t); if (i) { var o = function (t) { for (var e = t.getAllItemModels(), n = e.length - 1; n >= 0; n--) { var r = e[n]; if (r.dcgView) return r.id } }(t); if (o) { if (n) { var g = t.getItemRootNodeById(n); if (g) { var a = g.getBoundingClientRect(); if (a.height > 0 && a.top <= i.bottom && a.bottom >= i.bottom) return n; if (n === o && a.bottom <= i.bottom) return n } } var u = r(t, i.bottom); return u && e(u).attr("expr-id") || o } } }, t.getFirstFullyVisibleItemId = i, t.getExppanelElt = o, t.getExppanelSelector = g, t.getOuterExppanelRect = function (t) { var e = t.find$(".dcg-exppanel-outer")[0]; if (e) return e.getBoundingClientRect() }, t.getExppanelRect = l, t.getExppanelScrolledTop = function (t) { var e = o(t); if (e) { var n = e.getBoundingClientRect(), r = e.scrollTop; return n.top - r } }, t.getExpListHeight = function (t) { var e = t.find$(".dcg-expressionlist"); if (1 === e.length) return e.height() }, t.getDragContainerHeight = function (t) { var e = g(t); return e && e.find(".dcg-drag-container").height() || 0 } });
define('expressions/dragdrop_expressions', ["require", "exports", "tslib", "jquery", "expressions/measure-expressions", "jquery.handleevent"], function (require, e, t, o, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var i = function () { function e(e) { this.active = !1, this.controller = e; var t = r.getExppanelSelector(e); t && (this.$exppanel = t) } return e.prototype.startDragging = function (e) { this.active = !0, this.mouseY = e, this.setupEventListeners() }, e.prototype.applyDrag = function () { var e = this.controller.getListModel().dragState; if (e) { this.scheduleUpdateScroll(); var o = this.measureDOM(e); if (o) { var r = o.floatingPreviewRect, i = this.controller.getItemModel(e.firstItemId); if (i) { for (var n, d, l = i.index, s = 0, a = o.visibleRects; s < a.length; s++) { var p = a[s], c = p.id, h = p.rect; if (c !== i.id) { var u = this.controller.getItemModel(c); if (!u) return; if (u.index < i.index) { if (r.top < h.top + h.height / 2) { l = u.index; break } } else r.bottom > h.top + h.height / 2 && (l = u.index, "folder" === u.type && u.collapsed && (l += this.controller.getNumberOfItemsInFolder(u.id))) } } l > i.index ? (n = l, d = l + 1) : l < i.index ? (n = l - 1, d = l) : (n = l - 1, d = l + 1); var f = this.controller.getItemModelByIndex(n), g = this.controller.getItemModelByIndex(d), v = "", m = ""; f && (v = "folder" === f.type ? f.id : f.folderId), g && (m = "folder" === g.type ? g.id : g.folderId); var x = ""; return v && (m === v ? "folder" === i.type ? l = i.index : x = v : "folder" !== i.type && this.isPreviewTopContainedInFolder(o, v) && (x = v)), { dragState: t.__assign({}, o.dragState), newIndex: l, folderId: x } } } } }, e.prototype.measureDOM = function (e) { var o = r.getExppanelScrolledTop(this.controller), i = r.getExpListHeight(this.controller); if (void 0 !== o && void 0 !== i) { var n = r.getDragContainerHeight(this.controller), d = e.mouseY - e.grabOffset + 2, l = d - o; l = Math.max(l, -n / 2), l = Math.min(l, i - n); var s = { top: d, bottom: d + n, height: n }, a = this.controller.findFirstVisibleItem(), p = this.controller.findLastVisibleItem(); if (a && p) { for (var c = [], h = a.index; h <= p.index; h++) { var u = this.controller.getItemModelByIndex(h); if (u) { var f = this.controller.getItemRootNodeById(u.id); if (f && u.id !== e.firstItemId) { var g = f.getBoundingClientRect(); c.push({ id: u.id, rect: g }) } } } if (0 !== c.length) return { dragState: t.__assign(t.__assign({}, e), { itemTop: l }), floatingPreviewRect: s, visibleRects: c } } } }, e.prototype.isPreviewTopContainedInFolder = function (e, t) { for (var o = e.visibleRects, r = e.floatingPreviewRect, i = 0, n = o; i < n.length; i++) { var d = n[i], l = d.id, s = d.rect; if (s.top <= r.top && s.bottom >= r.top) { var a = this.controller.getItemModel(l); if (!a) return !1; if ("folder" === a.type && a.id === t) return !0; if ("folder" !== a.type && a.folderId === t) return !0 } } return !1 }, e.prototype.scheduleUpdateScroll = function () { var e = this; this.updateScrollScheduled || (this.updateScrollScheduled = !0, requestAnimationFrame(function () { e.updateScroll(), e.updateScrollScheduled = !1 })) }, e.prototype.stop = function () { this.active = !1, this.tearDownEventListeners(), this.controller.dispatch({ type: "stop-dragdrop" }) }, e.prototype.setupEventListeners = function () { var e = this; o(document).on("dcg-tapmove.dragdrop", function (t) { e.mouseY = t.changedTouches[0].clientY, e.controller.dispatch({ type: "update-dragdrop", mouseY: e.mouseY }) }), o(document).on("dcg-tapend.dragdrop", function (t) { e.stop(), t.handle("dragdrop") }) }, e.prototype.tearDownEventListeners = function () { o(document).off(".dragdrop") }, e.prototype.updateScroll = function () { if (this.active) { var e = this.$exppanel[0].getBoundingClientRect(), t = 0; t = Math.min(t, this.mouseY - e.top), (t = (t = Math.max(t, this.mouseY - e.bottom + 30)) * e.height / 900) && this.$exppanel.scrollTop(this.$exppanel.scrollTop() + t) } }, e }(); e.default = i });
define('keypad/mq-commands', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.execute = void 0; var e = { loga: function (t) { t.write("\\log_{}"), t.typedText("("), t.keystroke("Left"), t.keystroke("Down") }, nthroot: function (t) { t.write("\\sqrt[]{}"), t.keystroke("Left"), t.keystroke("Left") }, ddx: function (t) { t.write("\\frac{d}{dx}") }, arcsin: function (t) { t.write("sin^{-1}"), t.typedText("(") }, arccos: function (t) { t.write("cos^{-1}"), t.typedText("(") }, arctan: function (t) { t.write("tan^{-1}"), t.typedText("(") }, arcsec: function (t) { t.write("sec^{-1}"), t.typedText("(") }, arccsc: function (t) { t.write("csc^{-1}"), t.typedText("(") }, arccot: function (t) { t.write("cot^{-1}"), t.typedText("(") }, "A^T": function (t) { t.typedText("^T"), t.keystroke("Right") }, "A^-1": function (t) { t.typedText("^-1"), t.keystroke("Right") }, "A^2": function (t) { t.typedText("^2"), t.keystroke("Right") }, "a^2": function (t) { t.typedText("^2"), t.keystroke("Right") }, "a^3": function (t) { t.typedText("^3"), t.keystroke("Right") }, "a/b": function (t) { t.write("\\frac{}{}"), t.keystroke("Left") } }; t.execute = function (t, n) { e[n](t) } });
define('shared-components/braille-input', ["require", "exports", "tslib", "lib/i18n", "dcgview", "jquery"], function (require, t, o, e, s, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = s.Components.Input, r = function (t) { function r() { return null !== t && t.apply(this, arguments) || this } return o.__extends(r, t), r.prototype.init = function () { var t; for (this.ASCIICharacters = " A1B'K2L@CIF/MSP\"E3H9O6R^DJG>NTQ,*5<-U8V.%[$+X!&;:4\\0Z7(_?W]#Y)=", this.ASCIITable = [], this.HomeRowCharacters = "FDSJKL", this.charCodes = [], this.sixKeyModel = { keysDown: 0, stickyKeysDown: 0 }, t = 0; t < this.ASCIICharacters.length; t++)this.ASCIITable.push(this.ASCIICharacters.charCodeAt(t)); for (t = 0; t < this.HomeRowCharacters.length; t++)this.charCodes.push(this.HomeRowCharacters.charCodeAt(t)) }, r.prototype.template = function () { var t = this; return s.createElement(n, { class: this.const("dcg-braille-input dcg-do-blur"), tabindex: function () { return t.props.tabindex ? t.props.tabindex() : 0 }, readonly: function () { return t.props.isStatic() ? "true" : void 0 }, autocomplete: this.const("off"), autocorrect: this.const("off"), autocapitalize: this.const("off"), spellcheck: this.const("false"), onKeydown: this.bindFn(this.onKeydown), onKeyup: this.bindFn(this.onKeyup), onInput: this.bindFn(this.props.onInput), value: function () { return t.props.value() }, "aria-label": function () { return t.props.ariaLabel() || e.raw("") }, didMount: this.bindFn(this.didMount), didUnmount: this.bindFn(this.props.didUnmount), placeholder: function () { return t.props.placeholder ? t.props.placeholder() : "" }, size: function () { return t.props.size && t.props.size() } }) }, r.prototype.didMount = function (t) { var o = this; this.rootNode = t, i(this.rootNode).on("focus", function (t) { o.props.shouldFocus() || o.props.onFocusedChanged(!0, t.originalEvent || t) }).on("blur", function (t) { o.props.shouldFocus() && o.props.onFocusedChanged(!1, t.originalEvent || t) }), this.props.didMount(t), this.updateFocus() }, r.prototype.didUpdate = function () { this.updateFocus() }, r.prototype.updateFocus = function () { this.rootNode && (this.props.shouldFocus() && document.activeElement !== this.rootNode && this.rootNode.focus(), this.props.shouldFocus() || document.activeElement !== this.rootNode || this.rootNode.blur()) }, r.prototype.onKeydown = function (t) { var e = this.charCodes.indexOf(t.which); this.props.isStatic() || !this.isSixKeyInput() || t.altKey || t.ctrlKey || t.metaKey || t.shiftKey || -1 === e ? this.props.onKeydown && this.props.onKeydown(t) : (this.sixKeyModel = o.__assign(o.__assign({}, this.sixKeyModel), { keysDown: this.addKey(this.sixKeyModel.keysDown, e), stickyKeysDown: this.addKey(this.sixKeyModel.stickyKeysDown, e) }), t.preventDefault()) }, r.prototype.onKeyup = function (t) { var e = this.charCodes.indexOf(t.which), s = !1; return this.props.isStatic() || !this.isSixKeyInput() || t.altKey || t.ctrlKey || t.metaKey || t.shiftKey || -1 === e ? s = !0 : (this.sixKeyModel = o.__assign(o.__assign({}, this.sixKeyModel), { keysDown: this.removeKey(this.sixKeyModel.keysDown, e) }), 0 === this.sixKeyModel.keysDown && (this.addCharacter(this.bitsToASCII(this.sixKeyModel.stickyKeysDown)), this.sixKeyModel = o.__assign(o.__assign({}, this.sixKeyModel), { stickyKeysDown: 0 }))), s || t.preventDefault(), s }, r.prototype.addKey = function (t, o) { return t | 1 << o }, r.prototype.removeKey = function (t, o) { return t & ~(1 << o) }, r.prototype.bitsToASCII = function (t) { return String.fromCharCode(this.ASCIITable[t]) }, r.prototype.addCharacter = function (t) { this.rootNode && !this.props.isStatic() && (this.rootNode.setRangeText(t, this.rootNode.selectionStart, this.rootNode.selectionEnd, "end"), this.props.onInput(this.rootNode.value)) }, r.prototype.isSixKeyInput = function () { return "function" == typeof this.props.sixKeyInput && this.props.sixKeyInput() }, r }(s.Class); t.default = r });

define('loadcss!shared-components/tooltip', function () { });
define('shared-components/tooltip', ["require", "exports", "tslib", "keys", "dcgview", "jquery", "underscore", "loadcss!./tooltip"], function (require, t, e, o, r, i, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Tooltip = void 0; var s = r.Components, p = s.IfElse, a = s.Switch, l = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.init = function () { this.latexKey = 0 }, o.prototype.template = function () { var t = this; return r.createElement("div", { class: function () { var e; return (e = {})[t.getCustomClassName()] = !0, e["dcg-tooltip-positioning-container"] = !0, e["dcg-latex-tooltip-positioning-container"] = !!t.props.renderAsLatex, e["dcg-tooltip-gravity-ne-se"] = "ne" === t.props.gravity() || "se" === t.props.gravity(), e["dcg-tooltip-gravity-nw-sw"] = "nw" === t.props.gravity() || "sw" === t.props.gravity(), e["dcg-tooltip-gravity-n-s"] = "n" === t.props.gravity() || "s" === t.props.gravity(), e["dcg-tooltip-gravity-e-w"] = "e" === t.props.gravity() || "w" === t.props.gravity(), e }, style: function () { return { top: t.props.hitAreaRect().top + (t.props.offset().top || 0) + "px", left: t.props.hitAreaRect().left + (t.props.offset().left || 0) + "px", width: t.props.hitAreaRect().width + "px", height: t.props.hitAreaRect().height + "px" } } }, r.createElement("div", { role: r.const("tooltip"), class: r.const("dcg-tooltip-message-container"), style: this.bindFn(this.getMessageStyle) }, p(function () { return !!t.props.renderAsLatex }, { true: function () { return r.createElement("div", { class: function () { return { "dcg-tooltip-message": !0, "dcg-latex": !0, "dcg-sticky-not-stuck": t.props.isStickyAndNotStuck(), "dcg-tooltip-overflow": t.messageOverflows() } }, style: function () { return { "max-width": t.getMaxWidth() + "px" } }, didMount: function (e) { t.tooltipMessage = e } }, r.createElement(a, { key: function () { return t.latexKey } }, function () { return t.props.renderAsLatex().view(t.props.tooltip()) })) }, false: function () { return r.createElement("div", { class: r.const("dcg-tooltip-message"), style: function () { return { background: t.getBackgroundColor(), cursor: t.props.isStickyAndNotStuck() ? "pointer" : "default" } } }, t.props.tooltip) } })), r.createElement("div", { class: function () { var e; return (e = { "dcg-tooltip-arrow": !0 })["dcg-tooltip-gravity-" + t.props.gravity()[0]] = !0, e }, style: function () { return t.props.renderAsLatex ? t.getArrowWithBorderStyle() : t.getSolidArrowStyle() } })) }, o.prototype.willUpdate = function () { this.latexKey++ }, o.prototype.getCustomClassName = function () { return this.props.class ? this.props.class() : "" }, o.prototype.messageOverflows = function () { return this.tooltipMessage && this.tooltipMessage.getBoundingClientRect().width >= this.getMaxWidth() }, o.prototype.getArrowWithBorderStyle = function () { var t = this.props.gravity(), o = "10px", r = { width: "8px", height: "8px", border: "1px solid #bbb", background: this.getBackgroundColor(), opacity: this.props.isStickyAndNotStuck() ? ".95" : "1" }; switch (t) { case "s": return e.__assign(e.__assign({}, r), { top: "100%", left: "50%", "margin-top": "1px", "border-right": "0", "border-bottom": "0" }); case "sw": return e.__assign(e.__assign({}, r), { top: "100%", right: o, "margin-top": "1px", "border-right": "0", "border-bottom": "0" }); case "se": return e.__assign(e.__assign({}, r), { top: "100%", left: o, "margin-top": "1px", "border-right": "0", "border-bottom": "0" }); case "n": return e.__assign(e.__assign({}, r), { bottom: "100%", left: "50%", "margin-bottom": "1px", "border-left": "0", "border-top": "0" }); case "nw": return e.__assign(e.__assign({}, r), { bottom: "100%", right: o, "margin-bottom": "1px", "border-left": "0", "border-top": "0" }); case "ne": return e.__assign(e.__assign({}, r), { bottom: "100%", left: o, "margin-bottom": "1px", "border-left": "0", "border-top": "0" }); case "e": return e.__assign(e.__assign({}, r), { top: "50%", left: "100%", "margin-left": "1px", "border-right": "0", "border-top": "0" }); case "w": return e.__assign(e.__assign({}, r), { top: "50%", right: "100%", "margin-right": "1px", "border-left": "0", "border-bottom": "0" }); default: return t } }, o.prototype.getSolidArrowStyle = function () { var t = this.props.gravity(), e = this.props.hitAreaRect().width / 2 + "px", o = this.getBackgroundColor(), r = "transparent transparent " + o + " transparent", i = o + " transparent transparent transparent", n = "transparent " + o + " transparent transparent", s = "transparent transparent transparent " + o, p = "-5px"; switch (t) { case "s": return { top: "100%", left: "50%", border: "5px solid transparent", "border-color": r, "margin-top": p, "margin-left": p }; case "sw": return { top: "100%", right: e, border: "5px solid transparent", "border-color": r, "margin-top": p, "margin-right": p }; case "se": return { top: "100%", left: e, border: "5px solid transparent", "border-color": r, "margin-top": p, "margin-left": p }; case "n": return { bottom: "100%", left: "50%", border: "5px solid transparent", "border-color": i, "margin-bottom": p, "margin-left": p }; case "nw": return { bottom: "100%", right: e, border: "5px solid transparent", "border-color": i, "margin-bottom": p, "margin-right": p }; case "ne": return { bottom: "100%", left: e, border: "5px solid transparent", "border-color": i, "margin-bottom": p, "margin-left": p }; case "e": return { top: "50%", left: "100%", border: "5px solid transparent", "border-color": n, "margin-left": "-5px", "margin-top": p }; case "w": return { top: "50%", right: "100%", border: "5px solid transparent", "border-color": s, "margin-right": p, "margin-top": p }; default: return t } }, o.prototype.getBackgroundColor = function () { return this.props.renderAsLatex ? "#fff" : this.props.isStickyAndNotStuck() ? "#666" : "#000" }, o.prototype.getMaxWidth = function () { var t = this.props.gravity(), e = this.props.hitAreaRect().left + (this.props.offset().left || 0), o = e + this.props.hitAreaRect().width, r = .5 * this.props.hitAreaRect().width + e, i = window.innerWidth - 5; switch (t) { case "se": case "ne": case "e": return i - e; case "sw": case "nw": case "w": return o - 5; case "s": case "n": return 2 * Math.min(i - r, r - 5); default: return t } }, o.prototype.getMessageStyle = function () { var t = this.props.hitAreaRect(), e = this.props.gravity(), o = this.props.maxWidth(); switch (e) { case "s": return { top: "100%", width: o + "px", transform: "translate(-50%, 0)", left: .5 * t.width + "px", "margin-top": "5px", "text-align": "center" }; case "sw": return { top: "100%", width: o + "px", right: "0", "margin-top": "5px", "text-align": "right" }; case "se": return { top: "100%", width: o + "px", "margin-top": "5px", "text-align": "left" }; case "n": return { bottom: "100%", width: o + "px", transform: "translate(-50%, 0)", left: .5 * t.width + "px", "margin-bottom": "5px", "text-align": "center" }; case "nw": return { bottom: "100%", right: "0", width: o + "px", "margin-bottom": "5px", "text-align": "right" }; case "ne": return { bottom: "100%", width: o + "px", "margin-bottom": "5px", "text-align": "left" }; case "e": return { transform: "translate(0, -50%)", left: "100%", width: o + "px", top: .5 * t.height + "px", "margin-left": "5px", "text-align": "left" }; case "w": return { transform: "translate(0, -50%)", right: "100%", width: o + "px", top: .5 * t.height + "px", "margin-right": "5px", "text-align": "right" }; default: return e } }, o }(r.Class); var c = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return e.__extends(s, t), s.prototype.init = function () { this.uuid = n.uniqueId() }, s.prototype.template = function () { var t = this; return r.createElement("div", { class: r.const("dcg-tooltip-hit-area-container"), handleevent: r.const("true"), didMount: function (e) { t.isMounted = !0, t.hitAreaNode = e, t.setupEventListeners(t.hitAreaNode) }, onTap: function () { if (t.shouldStickOnTargetClick()) if (t.isStuck) t.clearTimeouts(), t.hideTooltip(); else { if (t.props.disabled && t.props.disabled()) return; t.showTooltip(), t.stickTooltip() } else if (t.shouldShowOnTapstart()) { if (t.props.disabled && t.props.disabled()) return; t.showTooltip(), t.setUpHideOnExternalMousedown() } } }, this.children) }, s.prototype.shouldShowOnTapstart = function () { return this.props.showOnTapstart && this.props.showOnTapstart() }, s.prototype.didUpdate = function () { this.updateTooltip() }, s.prototype.updateTooltip = function () { if (this.wrapperRef) if (this.props.tooltip()) { var t = this.hitAreaNode.getBoundingClientRect(), e = this.wrapperRef.elt.getBoundingClientRect(), o = this.wrapperRef, r = o.originalTop, i = o.originalLeft, n = t.top - e.top, s = t.left - e.left; Math.abs(n - r) > 3 || Math.abs(s - i) > 3 ? this.hideTooltip() : this.wrapperRef.view.update() } else this.hideTooltip() }, s.prototype.handleShowEvent = function (t) { if (!this.props.disabled || !this.props.disabled()) { var e = this.props.delay ? this.props.delay() : 500; this.clearTimeouts(), this.showTooltipTimeout = setTimeout(t, e) } }, s.prototype.handleHideEvent = function () { this.clearTimeouts(), this.hideTooltipTimeout = setTimeout(this.bindFn(this.hideTooltip), 150) }, s.prototype.setupEventListeners = function (t) { var e = this; i(t).on("tipsyshow", function (o) { o.target === t && e.handleShowEvent(function () { e.showTooltip() }) }).on("tipsyhide", function (o) { o.target !== t || e.isStuck || e.handleHideEvent() }) }, s.prototype.willUnmount = function () { this.clearTimeouts(), this.isMounted = !1, this.hideTooltip() }, s.prototype.setUpHideOnExternalMousedown = function () { var t = this; i(document).on("mousedown.dcg-tooltip-" + this.uuid + " touchstart.dcg-tooltip-" + this.uuid + " pointerdown.dcg-tooltip-" + this.uuid, function (e) { t.wrapperRef && (i(e.target).closest(t.hitAreaNode).length || i(e.target).closest(t.wrapperRef.elt).length || t.hideTooltip()) }) }, s.prototype.stickTooltip = function () { this.isMounted && this.wrapperRef && (this.isStuck || (this.setUpHideOnExternalMousedown(), this.isStuck = !0, this.updateTooltip())) }, s.prototype.clearTimeouts = function () { clearTimeout(this.showTooltipTimeout), clearTimeout(this.hideTooltipTimeout) }, s.prototype.showTooltip = function () { var t = this; if (this.isMounted && !this.wrapperRef && this.props.tooltip()) { var e = this.hitAreaNode.getBoundingClientRect(), n = document.createElement("div"); n.className = "dcg-tooltip-mount-pt"; var s = i(this.hitAreaNode).closest(".dcg-tap-container")[0], p = document.fullscreenElement || document.mozFullScreenElement || document.msFullscreenElement || document.webkitFullscreenElement; (!!p && i(this.hitAreaNode).closest(p).length > 0 && i(p).closest(".dcg-tap-container").length > 0 ? p : s).appendChild(n); var a = n.getBoundingClientRect(), c = e.left - a.left, d = e.top - a.top, h = Math.min(200, this.props.maxParentWidthOverflow ? e.width + 2 * this.props.maxParentWidthOverflow() : 1 / 0), u = { tooltip: this.props.tooltip, class: this.props.class, isStickyAndNotStuck: function () { return t.shouldStickOnTargetClick() && !t.isStuck }, offset: function () { return t.props.offset ? t.props.offset() : {} }, gravity: function () { return t.props.gravity ? t.props.gravity() : "s" }, renderAsLatex: this.props.renderAsLatex, maxWidth: function () { return h }, hitAreaRect: function () { return { top: d || 0, left: c || 0, width: e.width || 0, height: e.height || 0 } } }; this.setupEventListeners(n), i(n).on("dcg-tap", function () { t.shouldStickOnTargetClick() && t.stickTooltip() }); var g = r.mountToNode(l, n, u); i(document).on("keydown.dcg-tooltip-" + this.uuid, function (e) { o.lookup(e) === o.ESCAPE && t.hideTooltip() }); var f = function () { return t.updateTooltip() }; window.addEventListener("scroll", f, !0), this.wrapperRef = { elt: n, view: g, originalLeft: c, originalTop: d, onScroll: f } } }, s.prototype.hideTooltip = function () { this.clearTimeouts(), this.wrapperRef && (this.isStuck = !1, i(document).off(".dcg-tooltip-" + this.uuid), window.removeEventListener("scroll", this.wrapperRef.onScroll, !0), r.unmountFromNode(this.wrapperRef.elt), this.wrapperRef.elt.parentNode && this.wrapperRef.elt.parentNode.removeChild(this.wrapperRef.elt), this.wrapperRef = void 0) }, s.prototype.shouldStickOnTargetClick = function () { return !!this.props.sticky && this.props.sticky() }, s }(r.Class); t.Tooltip = c });

define('loadcss!shared-components/Abraham', function () { });

define('loadcss!shared-components/mathquill-braille-wrapper', function () { });
define('shared-components/mathquill-braille-wrapper', ["require", "exports", "tslib", "lib/i18n", "jquery", "abraham", "dcgview", "./braille-input", "./tooltip", "loadcss!./Abraham", "loadcss!./mathquill-braille-wrapper"], function (require, t, e, r, i, o, n, l, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.brailleInputIsEmpty = t.getFocusedBrailleElement = void 0; var s = n.Components.If, p = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return e.__extends(i, t), i.prototype.init = function () { this.currentBrailleValue = this.getBrailleFromLatex(this.props.latex()), this.currentBrailleMode = this.props.mode(), this.hasTranslationError = !1, this.currentLatex = this.props.latex() }, i.prototype.isFocused = function () { return void 0 !== this.brailleInput && document.activeElement == this.brailleInput }, i.prototype.getBrailleShouldFocus = function () { return "none" !== this.props.mode() && this.props.brailleShouldFocus && this.props.brailleShouldFocus() }, i.prototype.isStatic = function () { return !!this.props.isStatic && this.props.isStatic() }, i.prototype.isInline = function () { return !!this.props.isInline && this.props.isInline() }, i.prototype.hasError = function () { return !!this.props.hasError && this.props.hasError() }, i.prototype.willUpdate = function () { var t = this.currentLatex !== this.props.latex(), e = this.props.mode(), r = e !== this.currentBrailleMode && "none" !== e; (!this.isFocused() || t || r) && (this.currentLatex = this.props.latex(), (r || !this.hasTranslationError || t || this.isStatic()) && (this.currentBrailleValue = this.getBrailleFromLatex(this.props.latex()), this.hasTranslationError = !1), this.currentBrailleMode = e) }, i.prototype.onBrailleInput = function (t) { if (this.props.onBrailleInput) { var e = this.getLatexFromBraille(t); this.hasTranslationError = e.isError; var r = this.props.capExpressionSize && this.props.capExpressionSize(); !e.isError && r && r.exceedsLimit(e.value) ? r.onExpressionSizeExceeded() : (this.currentBrailleValue = t, e.isError || (this.currentLatex = e.value, this.props.onBrailleInput(e.value))) } }, i.prototype.getBrailleFromLatex = function (t, e) { void 0 === e && (e = !1); var r = function (t, e) { return "nemeth" === e ? o.latexToNemeth(t) : "ueb" === e ? o.latexToUeb(t) : { isError: !0, error: "Braille mode should be 'nemeth' or 'ueb'" } }(t, this.props.mode()); return r.isError ? "" : e ? r.value : o.UnicodeBraille.toExpandedBrailleAscii(r.value) }, i.prototype.getLatexFromBraille = function (t) { return function (t, e) { return "nemeth" === e ? o.nemethToLatex(t) : "ueb" === e ? o.uebToLatex(t) : { isError: !0, error: "Braille mode should be 'nemeth' or 'ueb'" } }(o.UnicodeBraille.coerceToSixDotCells(t), this.props.mode()) }, i.prototype.getBrailleLabel = function (t) { return this.getBrailleFromLatex(t.replace(/\s/, "\\ ")) }, i.prototype.shouldShowBraille = function () { var t = this.props.mode(); return "nemeth" === t || "ueb" === t }, i.prototype.isOverflowingLeft = function () { return !!this.brailleInput && this.brailleInput.scrollLeft > 0 }, i.prototype.isOverflowingRight = function () { if (!this.brailleInput) return !1; var t = this.brailleInput.getBoundingClientRect().width; return this.brailleInput.scrollWidth > t + this.brailleInput.scrollLeft + 2 }, i.prototype.didMountBrailleInput = function (t) { this.brailleInput = t }, i.prototype.didUnmountBrailleInput = function () { this.brailleInput = void 0 }, i.prototype.getTooltipGravity = function () { var t = this.props.tooltipOptions && this.props.tooltipOptions(); return t && t.gravity ? t.gravity : "se" }, i.prototype.getTooltipDelay = function () { var t = this.props.tooltipOptions && this.props.tooltipOptions(); return t && t.delay ? t.delay : 0 }, i.prototype.handleBrailleFocusChanged = function (t, e) { this.props.onBrailleFocusedChanged && this.props.onBrailleFocusedChanged(t, e), this.brailleInput && (t && this.props.selectOnFocus && this.props.selectOnFocus() && this.brailleInput.select(), this.isStatic() && this.brailleInput.scrollTo(0, 0)) }, i.prototype.getTooltipText = function () { var t = this.props.placeholder && !this.isFocused() ? this.props.placeholder() : ""; return r.raw(this.props.latex() || t) }, i.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-mathquill-wrapper") }, n.createElement(s, { predicate: function () { return t.shouldShowBraille() } }, function () { return n.createElement("div", { class: function () { return { "dcg-mathquill-braille": !0, "dcg-focus": t.getBrailleShouldFocus(), "dcg-invalid": t.hasError(), "dcg-mathquill-static-braille": t.isStatic(), "dcg-mathquill-braille-overflow-left": t.isOverflowingLeft(), "dcg-mathquill-braille-overflow-right": t.isOverflowingRight() } }, "data-dcg-limit": function () { return t.props.dataDCGLimit ? t.props.dataDCGLimit() : void 0 }, "data-dcg-label": function () { return t.props.dataLabelAttributeValue ? t.props.dataLabelAttributeValue() : void 0 } }, n.createElement(a.Tooltip, { class: t.const("dcg-mathquill-braille-tooltip"), renderAsLatex: function () { return { view: t.props.tooltipOptions().latexView } }, tooltip: function () { return t.getTooltipText() }, gravity: t.bindFn(t.getTooltipGravity), delay: t.bindFn(t.getTooltipDelay), showOnTapstart: t.const(!0) }, n.createElement(s, { predicate: function () { return t.isInline() } }, function () { return n.createElement("span", { class: n.const("dcg-inline-braille") }, function () { return r.raw(t.getBrailleFromLatex(t.props.latex(), !0)) }) }), n.createElement(s, { predicate: function () { return !t.isInline() } }, function () { return n.createElement(l.default, { ariaLabel: function () { return r.raw(t.props.ariaLabel ? t.getBrailleLabel(t.props.ariaLabel()) : "") }, didMount: t.bindFn(t.didMountBrailleInput), didUnmount: t.bindFn(t.didUnmountBrailleInput), onFocusedChanged: t.bindFn(t.handleBrailleFocusChanged), shouldFocus: t.bindFn(t.getBrailleShouldFocus), onKeydown: t.props.onBrailleKeydown, onInput: t.bindFn(t.onBrailleInput), sixKeyInput: t.props.sixKeyInput, value: function () { return t.currentBrailleValue }, placeholder: function () { return r.raw(t.props.placeholder ? t.getBrailleFromLatex(t.props.placeholder()) : "") }, tabindex: function () { return t.props.tabindex ? t.props.tabindex() : 0 }, isStatic: t.bindFn(t.isStatic), size: function () { return t.currentBrailleValue && t.currentBrailleValue.length || 1 } }) }))) }), n.createElement("div", { class: n.const("dcg-typeset-math"), style: function () { return { display: t.shouldShowBraille() && !t.isInline() ? "none" : void 0 } }, "aria-hidden": function () { return t.shouldShowBraille() } }, this.children)) }, i }(n.Class); t.default = p, t.getFocusedBrailleElement = function () { if (document.activeElement && i(document.activeElement).hasClass("dcg-braille-input")) return document.activeElement }, t.brailleInputIsEmpty = function (t) { return !t || "" === i(t).val() } });
define('main/controller', ["require", "exports", "main/propagate_selection", "tslib", "scroll_helpers", "graphing/grapher", "browser", "core/lib/label", "underscore", "lib/i18n", "flux", "core/types/opacity", "core/lib/dragmode", "core/types/styles", "lib/conditional_blur", "core/lib/deepCopy", "core/lib/number-to-latex", "lib/state-stack", "graphing/viewport", "core/graphing-calc/migrate-state", "core/math/expression-types", "lib/smart-slider-defaults", "core/lib/color-helpers", "graphing-calc/models/expression", "core/graphing-calc/json/expression", "graphing-calc/models/expression", "graphing-calc/models/table", "graphing-calc/models/image", "graphing-calc/models/folder", "graphing-calc/models/text", "graphing-calc/models/ticker", "graphing-calc/models/list", "graphing-calc/models/abstract-item", "graphing-calc/models/focus", "graphing-calc/actions/keyboard", "main/expression-zoom-helpers", "core/math/evaluate-single-expression", "./layout-model", "./settings-view-model", "jquery", "bugsnag", "expressions/list_move_controller", "./blank_state", "dcgview-helpers/mathquill-view", "expressions/measure-expressions", "expressions/dragdrop_expressions", "keypad/mq-commands", "core/lib/random-seed", "../shared-components/mathquill-braille-wrapper", "../core/lib/latex-search-helpers"], function (require, e, t, i, s, o, r, a, n, l, d, p, c, h, u, g, m, f, y, b, I, x, S, M, v, k, _, w, E, L, A, F, D, C, O, T, P, V, R, U, N, B, H, q, G, z, j, W, K, Y) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var J = function () { function e(e) { var t = this; this.__nextItemId = 0, this.__pendingImageUploads = {}, this.nextSubscription = 0, this.subscriptions = {}, this._queuedCallbacks = [], this._hasUnsavedChanges = !1, this.shouldScrollSelectedItemIntoViewAfterDispatch = !1, this.lastParsableObjects = {}, this.isExpressionSearchStrValidForReplace = !1, this.isExpressionReplaceStrValidForReplace = !1, this.expressionSearchCount = 0, this.expressionSearchOpen = !1, this.canShowKeyboardShortcuts = !1, this.toastData = {}, this.s = l.createDictionaryLookupFunction(function () { return t.graphSettings.config.language }), this.raw = function (e, t) { return l.raw(e, t) }, this.hasTranslation = function (e) { var i = t.graphSettings.config.language; return l.hasTranslation(e, i) }, this.unpack = function (e) { var i = t.graphSettings.config.language; return l.unpack(e, i) }, this.dispatch = function (e) { var i; if ("blur-focus-location" === e.type && t.dispatcher.isDispatching()) t.runAfterDispatch(function () { t.dispatch(e) }); else if ("set-focus-location" === e.type && t.dispatcher.isDispatching()) t.runAfterDispatch(function () { t.dispatch(e) }); else if ("tick" === e.type && t.dispatcher.isDispatching()) t.runAfterDispatch(function () { t.dispatch(e) }); else for ("tick" === e.type || N.leaveBreadcrumb("dispatch::" + t.bugsnagContext, { type: e.type }), t.dispatcher.isDispatching() && N.leaveBreadcrumb("dispatch-in-dispatch::" + t.bugsnagContext, { type: e.type }), t.dispatcher.dispatch(e), t.onEventsEmitted && t.onEventsEmitted(t.enqueuedEvents); i = t._queuedCallbacks.shift();)i() }, this._requiresTickNextFrame = !1, this.updateViews = function () { for (var e in t.subscriptions) t.subscriptions[e]() }, this.bugsnagContext = "", this.inPrintMode = !1, this.lastInfiniteScrollFirstDOM = void 0, this.lastInfiniteScrollLastDOM = void 0, this.hasDispatchSinceLastInfiniteScrollUpdate = !1, this.stateStack = new f.default, this.isCurrentlyDoingSetState = !1, this.isCurrentlyDoingRestoreState = !1, this.graphSettings = e, this.listModel = F.init(this), this.layoutModel = V.defaultLayoutModel(this.graphSettings.config), this.layoutMeasurements = { width: 0, height: 0 }, this.settingsViewModel = R.defaultSettingsViewModel(), this.imageRetryState = { lastAttemptTime: 0, attempts: 0 }, this.setupDispatcher() } return e.prototype.hasUnsavedChanges = function () { return this._hasUnsavedChanges }, e.prototype.getExpressionSearchOpen = function () { return this.expressionSearchOpen }, e.prototype.getTickerOpen = function () { return !!this.areActionsEnabled() && this.listModel.ticker.open }, e.prototype.getTickerPlaying = function () { return !!this.areActionsEnabled() && this.listModel.ticker.playing }, e.prototype.hasVisibleAndUndoableToast = function () { return "function" == typeof this.toastData.undoCallback }, e.prototype.getToastData = function () { return this.toastData }, e.prototype.toastUndo = function () { "function" == typeof this.toastData.undoCallback && (this.toastData.undoCallback(), this.dispatch({ type: "toast/close" })) }, e.prototype.runAfterDispatch = function (e) { this.dispatcher.isDispatching() ? this._queuedCallbacks.push(e) : e() }, e.prototype.enqueueEvent = function (e) { this.enqueuedEvents[e] = !0 }, e.prototype.getGrapherDimensions = function () { if (!this.grapher) return { width: 0, height: 0 }; var e = this.grapher.getProjection().screen; return { width: e.width, height: e.height } }, e.prototype.setRandomSeed = function (e) { this.graphSettings.setProperty("randomSeed", e) }, e.prototype.getRandomSeed = function () { return this.graphSettings.randomSeed }, e.prototype.shouldDispatchTickNextFrame = function () { return !!this._requiresTickNextFrame }, e.prototype.markTickRequiredNextFrame = function () { this._requiresTickNextFrame = !0 }, e.prototype.handleTick = function (e) { this.areActionsEnabled() && A.shouldTick(this.listModel.ticker, { currentFrameTime: e, previousFrameTime: this.lastFrameTime }) ? this.dispatch({ type: "tick-ticker", time: e }) : this.shouldDispatchTickNextFrame() && this.dispatch({ type: "tick", time: e }), this.lastFrameTime = e }, e.prototype.setupDispatcher = function () { var e = this; this.dispatcher = new d.Dispatcher, this.dispatcher.register(function (t) { var i, s = e.getSelectedItem(), o = e.getFocusLocation(); e.shouldScrollSelectedItemIntoViewAfterDispatch = !1, e.enqueuedEvents = { change: !1, graphReset: !1, clearUnsavedChanges: !1, openDrawer: !1, showHotkeysModal: !1, userMovedPoint: !1, userClickedObject: !1, userEditedLabel: !1 }, "tick" === t.type && (e._requiresTickNextFrame = !1), e.isCurrentlyDoingSetState = !1, e.isCurrentlyDoingRestoreState = !1, e.handleDispatchedAction(t), e.updateTheComputedWorld(); var r = e.getImageToRetry(); (e.getPlayingSliders().length > 0 || e.hasAnyTableThatRequiresTicks() || e.isDragDropActive() || r) && e.markTickRequiredNextFrame(), r && e.retryLoadingFailedImage(r), "undo" === t.type || "redo" === t.type || e.isDragDropActive() || e.commitUndoRedoSynchronously(t), e.requestParseForAllItems(), e.isCurrentlyDoingSetState = !1, e.isCurrentlyDoingRestoreState = !1, e.enqueuedEvents.change && e.grapher && e.grapher.markLabelsDirty(), e.enqueuedEvents.clearUnsavedChanges ? e._hasUnsavedChanges = !1 : e.enqueuedEvents.change && (e._hasUnsavedChanges = !0); var a = e.getSelectedItem(); a ? s && s.guid === a.guid || (e.shouldScrollSelectedItemIntoViewAfterDispatch = !0) : e.shouldScrollSelectedItemIntoViewAfterDispatch = !1; var l = e.getFocusLocation(); l && !n.isEqual(l, o) && (e.getFocusedItem() == a && (e.shouldScrollSelectedItemIntoViewAfterDispatch = !0)); o && s && "table" === s.type && "table" === o.type && (!l || "table" !== l.type || o.id !== l.id) && s.isExpanded && (_.setExpanded(s, !1), l || (i = s)), l && a && "table" === a.type && _.updateIsCollapsedByFocusLocation(a), e.updateRenderShellsBeforePaint(), e.updateViews(), i ? e.scrollItemIntoView(i) : e.shouldScrollSelectedItemIntoViewAfterDispatch && e.scrollSelectedItemIntoView(), e.updateDragDrop(), e.updateRenderShellsAfterDispatch() }) }, e.prototype.handleDispatchedAction = function (e) { var t = this; switch (e.type) { case "render": break; case "undo": this.undo(); break; case "redo": this.redo(); break; case "clear-undoredo-history": this.clearUndoRedoHistory(); break; case "on-special-key-pressed": "Enter" === e.key ? O.onEnterPressed(this) : "Up" === e.key ? O.onUpPressed(this) : "Down" === e.key ? O.onDownPressed(this) : "Backspace" === e.key ? O.onBackspacePressed(this) : "Delete" === e.key && O.onDeletePressed(this); break; case "select-previous-expression": F.selectPrevItem(this.listModel); break; case "select-next-expression": F.selectNextItem(this.listModel); break; case "upward-delete-selected-expression": O.upwardDeleteSelectedExpression(this, { moveSelection: !1 }); break; case "downward-delete-selected-expression": O.downwardDeleteSelectedExpression(this, { moveSelection: !1 }); break; case "table-show-more-rows": if (!(Z = this.getItemModel(e.id)) || "table" !== Z.type) return; var s = _.getCollapsedRange(Z); if (!s) return; F.setSelected(this.listModel, Z), _.setExpanded(Z, !0), C.setFocusLocation(this, { type: "table", id: Z.id, location: { row: s.min, column: 0 } }); break; case "navigate-table-by-key": O.navigateTableByKey(this, e.id, e.key); break; case "delete-item-and-animate-out": this._deleteItemAndAnimateOut(e.id, e.setFocusAfterDelete); break; case "finish-deleting-item-after-animation": this._finishDeletingItemAfterAnimation(e.id, e.setFocusAfterDelete); break; case "expression-zoom-fit": this._expressionZoomFit(e.id); break; case "set-expression-properties-from-api": this._setExpressionPropertiesFromAPI(e.id, e.properties); break; case "add-item-to-end-from-api": this._addItemToEndFromAPI(this.createItemModel(e.state)); break; case "duplicate-expression": if (!(m = this.getItemModel(e.id)) || "folder" === m.type) return; this.copyExpressionToIndex(m, m.index + 1); break; case "duplicate-folder": var o = e.id, r = this.getItemModel(o); if (!r || "folder" !== r.type) return; var n = this.createItemModel(i.__assign(i.__assign({}, E.getState(r, { stripDefaults: !1 })), { id: this.generateId() })), l = this.getNumberOfItemsInFolder(o), d = l + 1; this._toplevelInsertItemAt(r.index + d, n, !1, void 0); for (var p = r.index + 1, h = p + l, u = p; u <= h; u++) { var g = F.getItemByIndex(this.listModel, u); if (!g || "folder" === g.type) return; this.copyExpressionToIndex(g, u + d, n.id) } break; case "insert-item-at-index": var m = this.createItemModel(e.state); this._toplevelInsertItemAt(e.index, m, e.focus, e.folderId); break; case "new-expression-at-end": m = this.createItemModel({ type: "expression", id: this.generateId(), color: this.getNextColor() }); this.setEditListMode(!1), F.insertItemAtEnd(this.listModel, m), C.moveFocusToItem(this, m.id); break; case "new-expression": m = this.createItemModel({ type: "expression", id: this.generateId(), color: this.getNextColor() }); this.setEditListMode(!1), this._toplevelNewItemAtSelection(m, { shouldFocus: !0 }), this._closeAddExpression(); break; case "new-text": m = this.createItemModel({ id: this.generateId(), type: "text" }); this._toplevelNewItemAtSelection(m, { shouldFocus: !0 }), this._closeAddExpression(); break; case "new-folder": m = this.createItemModel({ type: "folder", id: this.generateId() }); this._toplevelNewItemAtSelection(m, { shouldFocus: !0 }), this._closeAddExpression(); break; case "new-images": this._uploadImagesAndWaitForThemToLoad({ files: e.files }), this._closeAddExpression(); break; case "change-image": this._uploadImagesAndWaitForThemToLoad({ files: e.files, id: e.id }); break; case "new-table": m = this._createTableItem(); this._toplevelNewItemAtSelection(m, { shouldFocus: !0 }), this._closeAddExpression(); break; case "paste-table": this._pasteTable(e.data); break; case "insert-several-expressions": this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, this._insertSeveralExpressions(e.expressions); break; case "append-number-list": this._appendNumberList(e.latex); break; case "remove-item-by-id": F.removeItemById(this.listModel, e.id); break; case "replace-item-at-index": m = this.createItemModel(e.state); this._toplevelReplaceItemAt(e.index, m, e.focus); break; case "create-sliders-for-item": this.createSlidersForItem(e.id, e.variables); break; case "create-sliders-for-ticker": this.createSlidersForTicker(e.variables); break; case "convert-image-to-draggable": this.convertImageToDraggable(e.id); break; case "start-dragdrop": if (!(Z = this.getItemModel(e.id))) return; var f = this.getItemRootNodeById(Z.id); if (!f) return; var y = f.getBoundingClientRect(); F.setSelected(this.listModel, void 0); var b = e.grabY - y.top, I = !1, x = 1; "folder" === Z.type && (x += this.getNumberOfItemsInFolder(Z.id), Z.collapsed || (I = !0, E.setCollapsed(Z, !0))), F.setDragState(this.listModel, { firstItemId: Z.id, numberOfItems: x, expandFolder: I, grabOffset: b, mouseY: e.mouseY, itemTop: 0 }), this.dragdrop_expressions.startDragging(e.mouseY); break; case "update-dragdrop": if (!(S = this.listModel.dragState)) return; F.setDragState(this.listModel, i.__assign(i.__assign({}, S), { mouseY: e.mouseY })); break; case "stop-dragdrop": var S; if (!(S = this.listModel.dragState)) return; var M = this.getItemModel(S.firstItemId); if (!M) return; F.setSelected(this.listModel, M), "folder" === M.type && S.expandFolder && E.setCollapsed(M, !1), F.setDragState(this.listModel, void 0); break; case "set-selected-id": m = this.getItemModel(e.id); F.setSelected(this.listModel, m); break; case "set-selected-index": m = this.getItemModelByIndex(e.index); F.setSelected(this.listModel, m); break; case "set-none-selected": F.setSelected(this.listModel, void 0); break; case "set-focus-location": "table" === (e.location ? e.location.type : "") && (this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { inEditListMode: !1 })), C.setFocusLocation(this, e.location); break; case "move-focus-to-item": C.moveFocusToItem(this, e.id, e.where); break; case "blur-focus-location": this.isFocusLocationFocused(e.location) && C.setFocusLocation(this, void 0); break; case "set-folder-collapsed": if (!(Z = this.getItemModel(e.id)) || "folder" !== Z.type) return; E.setCollapsed(Z, e.isCollapsed); break; case "set-all-folders-collapsed": F.collapseAllFolders(this.listModel, e.isCollapsed); break; case "set-item-secret": if (!(m = this.getItemModel(e.id))) return; D.setSecret(m, e.isSecret); break; case "set-tablecolumn-color": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnColor(Z, e.columnId, e.color); break; case "set-tablecolumn-colorlatex": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnColorLatex(Z, e.columnId, e.colorLatex); break; case "set-show-cdf": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setShowCDF(Z, e.showCDF); break; case "set-cdf-min": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setCDFMin(Z, e.latex); break; case "set-cdf-max": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setCDFMax(Z, e.latex); break; case "toggle-item-hidden": this._toggleItemHidden(e.id); break; case "toggle-tablecolumn-hidden": this._toggleTableColumnHidden(e.tableId, e.columnId); break; case "toggle-item-settings-menu": this.listModel.openItemMenu && e.menu.model === this.listModel.openItemMenu.model ? this.closeItemSettingsMenu() : (this.listModel.openItemMenu = e.menu, e.menu.focusFirstOption && C.setFocusLocation(this, { type: "expression-menu", id: e.menu.model.id, location: "start" })); break; case "close-item-settings-menu": this.closeItemSettingsMenu(); break; case "toggle-fraction-evaluation": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; var A = k.shouldEvaluationDisplayAsFraction(Z); k.setEvaluationAsFraction(Z, !A); break; case "set-item-label": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLabel(Z, e.label), this.enqueueEvent("userEditedLabel"); break; case "set-item-showlabel": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setShowLabel(Z, e.showLabel), e.showLabel || (k.setInteractiveLabel(Z, !1), k.setEditableLabelMode(Z, v.EditableLabelMode.None)); break; case "set-item-color": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setColor(Z, e.color); break; case "set-item-description": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type && "image" !== Z.type) return; "expression" === Z.type ? k.setDescription(Z, e.description) : "image" === Z.type && w.setDescription(Z, e.description); break; case "set-item-fill": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setFill(Z, e.fill), this._setItemHidden(Z.id, k.areAllVisibilityPropsOff(Z)); break; case "set-image-opacity": if (!(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; w.setOpacity(Z, e.opacity), this._setItemHidden(Z.id, !1); break; case "set-image-in-foreground": if (!(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; w.setForeground(Z, e.foreground); break; case "image-upload-error": this.__pendingImageUploads[e.token] && (delete this.__pendingImageUploads[e.token], this._showToast({ message: this.s("graphing-calculator-text-toast-image-upload-failed") })); break; case "image-upload-success": if (this.__pendingImageUploads[e.token]) if (delete this.__pendingImageUploads[e.token], e.id) { (Z = this.getItemModel(e.id)) && "image" === Z.type && w.setImageURL(Z, e.url) } else { var T = this.createItemModel({ type: "image", id: this.generateId(), width: e.width, height: e.height, image_url: e.url, name: e.name }); this._toplevelNewItemAtSelection(T, { shouldFocus: !1 }) } this.isUploadingImages() || (this.toastData = {}); break; case "image-load-success": if (!(T = this.getItemModel(e.id)) || "image" !== T.type) return; w.setLoadStatus(T, "loaded"), this.imageRetryState = { lastAttemptTime: 0, attempts: 0 }; break; case "image-load-error": if (!(T = this.getItemModel(e.id)) || "image" !== T.type) return; w.setLoadStatus(T, "failed"); break; case "image-retry-loading": if (!(T = this.getItemModel(e.id)) || "image" !== T.type) return; w.retryLoading(T); break; case "set-item-dragmode": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setDragMode(Z, e.dragMode); break; case "set-tablecolumn-dragmode": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnDragMode(Z, e.columnId, e.dragMode), e.dragMode !== c.DragMode.NONE && this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-tablecolumn-points": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnPoints(Z, e.columnId, e.bool), this._setTableColumnHidden(e.tableId, e.columnId, _.shouldHideColumn(Z, e.columnId)); break; case "set-tablecolumn-lines": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnLines(Z, e.columnId, e.bool), this._setTableColumnHidden(e.tableId, e.columnId, _.shouldHideColumn(Z, e.columnId)); break; case "set-tablecolumn-linestyle": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnLineStyle(Z, e.columnId, e.lineStyle), this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-tablecolumn-linewidth": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnLineWidth(Z, e.columnId, e.lineWidth), this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-tablecolumn-lineopacity": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnLineOpacity(Z, e.columnId, e.lineOpacity), this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-tablecolumn-pointsize": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnPointSize(Z, e.columnId, e.pointSize), this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-tablecolumn-pointopacity": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnPointOpacity(Z, e.columnId, e.pointOpacity), this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-tablecolumn-pointstyle": if (!(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setColumnPointStyle(Z, e.columnId, e.pointStyle), this._setTableColumnHidden(e.tableId, e.columnId, !1); break; case "set-item-points": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setPoints(Z, e.points), this._setItemHidden(e.id, k.areAllVisibilityPropsOff(Z)), e.points || Z.dragMode === c.DragMode.NONE || k.setDragMode(Z, c.DragMode.NONE); break; case "set-item-pointstyle": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setPointStyle(Z, e.pointStyle), this._setItemHidden(e.id, !1); break; case "set-item-lines": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLines(Z, e.lines), this._setItemHidden(e.id, k.areAllVisibilityPropsOff(Z)); break; case "set-item-linestyle": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLineStyle(Z, e.lineStyle), this._setItemHidden(e.id, !1); break; case "set-item-label-dropdown-open": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLabelDropdownOpen(Z, e.open); break; case "set-item-fillopacity": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setFillOpacity(Z, e.fillOpacity), this._setItemHidden(e.id, !1); break; case "set-item-lineopacity": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLineOpacity(Z, e.lineOpacity), this._setItemHidden(e.id, !1); break; case "set-item-pointopacity": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setPointOpacity(Z, e.pointOpacity), this._setItemHidden(e.id, !1); break; case "set-item-pointsize": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setPointSize(Z, e.pointSize), this._setItemHidden(e.id, !1); break; case "set-item-linewidth": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLineWidth(Z, e.lineWidth), this._setItemHidden(e.id, !1); break; case "set-item-colorlatex": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setColorLatex(Z, e.colorLatex); break; case "set-item-labelSize": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLabelSize(Z, e.labelSize); break; case "set-item-labelangle": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLabelAngle(Z, e.labelAngle); break; case "set-item-label-orientation": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setLabelOrientation(Z, e.labelOrientation); break; case "set-suppress-text-outline": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSuppressTextOutline(Z, e.suppressTextOutline); break; case "set-item-interactive-label": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setInteractiveLabel(Z, e.interactiveLabel), e.interactiveLabel && k.setEditableLabelMode(Z, v.EditableLabelMode.None); break; case "set-item-editable-label-mode": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; Z.editableLabelMode !== v.EditableLabelMode.None && e.editableLabelMode !== v.EditableLabelMode.None && Z.editableLabelMode !== e.editableLabelMode && k.setLabel(Z, ""), k.setEditableLabelMode(Z, e.editableLabelMode), e.editableLabelMode !== v.EditableLabelMode.None && k.setInteractiveLabel(Z, !1); break; case "plot-residuals": if (!(m = this.getItemModel(e.id)) || "expression" !== m.type) return; var P = m.formula.regression; if (!P) return; var R = P.residualSuggestionId; if (!R) return; var U = this.getItemModel(R); if (!U) return; _.insertBlankColumn(U, U.columnModels.length - 1, { id: this.generateId(), latex: a.identifierToLatex(P.residualVariable), color: this.getNextColor() }); break; case "toggle-logmode": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; var N = Z.isLogModeRegression; k.setLogMode(Z, !N); break; case "set-item-latex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(m = this.getItemModel(e.id)) || "expression" !== m.type) return; var H = e.latex; if ('"' === H && this.areNotesEnabled()) { var G = this.createItemModel({ id: this.generateId(), type: "text" }); this._toplevelReplaceItemAt(m.index, G, !0) } else if ("" === H) k.blankOutExpressionAfterClearingLatex(m); else if ("ticker" === H && this.canAddTicker()) this.listModel.ticker.open = !0, this.focusLocation = { type: "ticker", location: "handler" }, this._removeExpressionSynchronously(m); else if ("folder" === H && this.areFoldersEnabled()) { var z = this.createItemModel({ id: this.generateId(), type: "folder" }); F.getParentFolderModel(m) ? (this._toplevelNewItemAtSelection(z, { shouldFocus: !0 }), k.setLatex(m, "")) : this._toplevelReplaceItemAt(m.index, z, !0) } else if ("table" === H) { var K = this._createTableItem(); this._toplevelReplaceItemAt(m.index, K, !0) } else "betchacant" === H || "pride" === H ? this.runAfterDispatch(function () { t.triggerEasterEgg && t.triggerEasterEgg(H) }) : k.setLatex(m, H); break; case "set-visualization-prop": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setVizProp(Z, e.prop, e.value); break; case "set-clickableinfo-prop": if (!(Z = this.getItemModel(e.id))) return; "expression" === Z.type ? k.setClickableInfoProp(Z, e.prop, e.value) : "image" === Z.type && w.setClickableInfoProp(Z, e.prop, e.value); break; case "set-clickableinfo-rule-latex": if (!(Z = this.getItemModel(e.id))) return; "expression" === Z.type ? k.setClickableInfoRuleLatex(Z, e.latex) : "image" === Z.type && w.setClickableInfoRuleLatex(Z, e.latex); break; case "set-folder-title": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "folder" !== Z.type) return; E.setTitle(Z, e.title); break; case "set-image-mq-attribute": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; w.setMQAttribute(Z, e.attribute, e.latex); break; case "set-image-name": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; w.setName(Z, e.name); break; case "set-image-draggable": if (!(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; var J = w.getCenterExternalReferencedModel(Z); if (!J) return; w.setDraggable(Z, e.draggable), !e.draggable || J.reconciledDragMode !== c.DragMode.NONE && J.dragMode !== c.DragMode.AUTO || k.setDragMode(J, c.DragMode.XY); break; case "set-graph-settings": for (var X in e) "type" !== X && this.graphSettings.setProperty(X, e[X]); break; case "set-polar-domain-minlatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setPolarDomainMin(Z, e.latex); break; case "set-polar-domain-maxlatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setPolarDomainMax(Z, e.latex); break; case "set-parametric-domain-minlatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setParametricDomainMin(Z, e.latex); break; case "set-parametric-domain-maxlatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setParametricDomainMax(Z, e.latex); break; case "set-note-text": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "text" !== Z.type) return; L.setText(Z, e.text); break; case "set-edit-list-mode": var Z = F.getSelected(this.listModel); if (this.setEditListMode(e.isEditListMode), e.focusExpressionList) { if (void 0 === Z && (Z = this.getItemModelByIndex(0)), !Z) return; C.moveFocusToItem(this, Z.id, "table" === Z.type && e.isEditListMode ? "container" : "start") } else F.setSelected(this.listModel, void 0), C.setFocusLocation(this, void 0); break; case "set-projector-mode": this.getGraphSettings().config.setProperty("projectorMode", e.value); break; case "set-inverted-colors": this.getGraphSettings().config.setProperty("invertedColors", e.value); break; case "set-tablecell-latex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.tableId)) || "table" !== Z.type) return; _.setCellLatex(Z, e.cell, e.latex); break; case "set-state": this.externalSetState(e.state, e.opts); break; case "set-blank": this.externalSetState(this.getBlankState(), e.opts); break; case "clear-unsaved-changes": this.enqueueEvent("clearUnsavedChanges"); break; case "reset-graph": var Q = this.getState(); this.externalSetState(this.graphSettings.defaultState, { allowUndo: !0 }); var $ = this.getItemModelByIndex(0); $ && C.moveFocusToItem(this, $.id, "end"), this._showToast({ message: this.s("graphing-calculator-text-toast-graph-reset"), undoCallback: function () { return t.dispatch({ type: "set-state", state: Q, opts: { allowUndo: !0 } }) } }), this.enqueueEvent("graphReset"); break; case "clear-graph": if (this.triggerClearGraph) return void this.runAfterDispatch(function () { return t.triggerClearGraph() }); var ee = this.getState(); this.externalSetState(this.getBlankState(), { allowUndo: !0 }); var te = this.getItemModelByIndex(0); te && C.moveFocusToItem(this, te.id, "end"), this._showToast({ message: this.s("graphing-calculator-text-toast-graph-cleared"), undoCallback: function () { return t.dispatch({ type: "set-state", state: ee, opts: { allowUndo: !0 } }) } }), this.enqueueEvent("graphReset"); break; case "on-evaluator-changes": if (this.onEvaluatorChangesSpy && this.onEvaluatorChangesSpy(e.changes, e.timingData, e.graphData, e.eventUpdates), F.onEvaluatorFormulaUpdates(this.listModel, e.changes), !e.graphData) break; var ie; for (ie in e.graphData.addedGraphs) { var se = e.graphData.addedGraphs[ie]; this.grapher && this.grapher.updateSketch(ie, se), F.onGraphComputed(this.listModel, ie, se) } for (ie in e.graphData.removedGraphs) this.grapher && this.grapher.hide(ie); for (ie in e.graphData.intersections) this.grapher && "2d" === this.grapher.type && this.grapher.updateIntersections(ie, e.graphData.intersections[ie]); if (this.grapher && this.grapher.poiController && this.grapher.poiController.handleTraceUpdate(), e.eventUpdates) { var oe = !1; for (var re in e.eventUpdates.updates) if (this.doesIdentifierBlockActionUpdate(re)) { oe = !0; break } if (!oe) { for (var re in e.eventUpdates.updates) this.updateLatexForIdentifier(re, e.eventUpdates.updates[re]); e.eventUpdates.objectClicked && this.enqueueEvent("userClickedObject"), this.onActionUpdatesAppliedSpy && this.onActionUpdatesAppliedSpy(e.eventUpdates) } } break; case "add-helper-expression": F.addHelperExpression(this.listModel, e.state); break; case "tick": this._tickSliders(e.time); break; case "tick-ticker": this.tickTicker(e.time); break; case "adjust-slider-by-keyboard": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.adjustSliderByKeyboard(Z, e.adjustment); break; case "adjust-slider-by-dragging-thumb": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.adjustSliderByDraggingThumb(Z, e.target); break; case "set-slider-minlatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderMin(Z, e.latex); break; case "set-slider-maxlatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderMax(Z, e.latex); break; case "set-slider-steplatex": if (this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, !(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderStep(Z, e.latex); break; case "set-slider-dragging": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderDragging(Z, e.dragging); break; case "play-slider-from-min": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; var ae = k.getSliderMin(Z); if (isNaN(ae)) return; var ne = k.computeNewSliderLatex(Z.latex, ae); k.setSliderIsPlaying(Z, !1), k.setLatex(Z, ne), k.setSliderIsPlaying(Z, !0); break; case "set-slider-isplaying": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderIsPlaying(Z, e.isPlaying); break; case "set-slider-loopmode": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderLoopMode(Z, e.loopMode); break; case "set-slider-animationperiod": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; k.setSliderAnimationPeriod(Z, e.animationPeriod); break; case "show-expressions-list": this._showExpressions(e.focusHideIcon); break; case "hide-expressions-list": this._hideExpressions(e.focusShowIcon); break; case "open-drawer": this.enqueueEvent("openDrawer"); break; case "re-randomize": this.setRandomSeed(W.default()); break; case "resize-exp-list": this._setExpListWidth(e.expListWidth); break; case "toast/show": this._showToast(e.toast); break; case "toast/close": this.closeToast(); break; case "toast/undo": var le = this.toastData.undoCallback; le && this.runAfterDispatch(le), this.toastData = {}; break; case "toast/learn-more": var de = this.toastData.learnMoreCallback; de && this.runAfterDispatch(de), this.toastData = {}; break; case "start-moving-point": B.onStartMovingPoint(this, this.listModel, e.pointInfo); break; case "stop-moving-point": B.onStopMovingPoint(this, e.pointInfo); break; case "on-move-point": B.onMovePoint(this, e.pointInfo, e.previousScreenPt, e.screenPt, e.projection, e.keyboardDirection) && this.enqueueEvent("userMovedPoint"); break; case "commit-user-requested-viewport": this._commitUserRequestedViewport(e.viewport); break; case "set-viewport": this._setAxisLimitLatex("xmin", e.viewport.xmin + ""), this._setAxisLimitLatex("xmax", e.viewport.xmax + ""), this._setAxisLimitLatex("ymin", e.viewport.ymin + ""), this._setAxisLimitLatex("ymax", e.viewport.ymax + ""); break; case "toggle-lock-viewport": this.graphSettings.setProperty("userLockedViewport", !this.graphSettings.userLockedViewport); break; case "set-axis-limit-latex": this._setAxisLimitLatex(e.limit, e.latex); break; case "toggle-graph-settings": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { graphSettingsOpen: !this.layoutModel.graphSettingsOpen }), F.setSelected(this.listModel, void 0), e.focusOnOpen && this.layoutModel.graphSettingsOpen && C.setFocusLocation(this, { type: "settings", location: "projector-mode" }); break; case "close-graph-settings": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { graphSettingsOpen: !1 }), e.focusIconAfterClose && C.setFocusLocation(this, { type: "settings", location: "icon" }); break; case "toggle-add-expression": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { addExpressionOpen: !this.layoutModel.addExpressionOpen }), e.focusOnOpen && this.layoutModel.addExpressionOpen && C.setFocusLocation(this, { type: "add-expression-btn" }); break; case "close-add-expression": this._closeAddExpression(), e.focusIconAfterClose && C.setFocusLocation(this, { type: "add-item-btn" }); break; case "ui/container-resized": this.layoutMeasurements = { width: e.size.width, height: e.size.height }, this.shouldScrollSelectedItemIntoViewAfterDispatch = !0; break; case "enter-printmode": this.inPrintMode = !0; break; case "exit-printmode": this.inPrintMode = !1; break; case "expression-size-exceeded": this._showToast({ message: this.s("graphing-calculator-text-toast-expression-size-limit") }); break; case "keypad/set-layout": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadLayout: e.layout, keypadFunctionsOpen: !1 }); break; case "keypad/set-minimized": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadMinimized: e.minimized, keypadLayout: "mainNumbers" }), this.shouldScrollSelectedItemIntoViewAfterDispatch = !0, this.needsFakeKeypad() || C.addFocusForKeypad(this); break; case "keypad/type-text": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadFunctionsOpen: !1 }), this.runAfterDispatch(function () { var i = q.default.getFocusedMathquill(); i && q.default.canAcceptText(i, t.getCapExpressionSize(), e.text) && (i.typedText(e.text), q.default.simulateUserChangedLatex(i)) }); break; case "keypad/press-key": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadFunctionsOpen: !1 }), this.runAfterDispatch(function () { var t = q.default.getFocusedMathquill(); t && q.default.simulateKeypress(t, e.key) }); break; case "keypad/audio-trace": this.handleAudioTraceCommand(e.command); break; case "set-audio-trace-speed": this.setAudioTraceSpeed(e.speed); break; case "keypad/custom-command": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadFunctionsOpen: !1 }), this.runAfterDispatch(function () { var t = q.default.getFocusedMathquill(); t && (j.execute(t, e.command), q.default.simulateUserChangedLatex(t)) }); break; case "keypad/shift": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadLayout: V.getShiftedLayoutForCurrentLayout(this.getKeypadLayout()), keypadFunctionsOpen: !1 }); break; case "keypad/123": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadLayout: "mainNumbers", keypadFunctionsOpen: !1 }); break; case "keypad/abc": this.isQwertyKeyboardEnabled() ? this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadLayout: "letters", keypadFunctionsOpen: !1 }) : this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadLayout: "noQwertyLetters", keypadFunctionsOpen: !1 }); break; case "keypad/audio": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadMinimized: !1, keypadLayout: "audio", keypadFunctionsOpen: !1 }); break; case "keypad/functions": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadFunctionsOpen: !this.isKeypadFunctionsPopoverOpen() }); break; case "grapher/drag-start": case "grapher/drag-move": case "grapher/drag-end": break; case "open-on-web": this._openOnWeb(); break; case "file-is-dragged-over": this.listModel.openItemMenu = void 0, this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { isFileDraggedOver: !0 }); break; case "file-is-not-dragged-over": this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { isFileDraggedOver: !1 }); break; case "zoom": this.grapher && this.grapher.viewportController.zoom(e.direction); break; case "set-hovered-image": if (!(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; w.setClickableInfoProp(Z, "hoveredImage", e.url); break; case "set-depressed-image": if (!(Z = this.getItemModel(e.id)) || "image" !== Z.type) return; w.setClickableInfoProp(Z, "depressedImage", e.url); break; case "clickable-item-clicked": this.handleClickableItemClicked(e.id, e.listIndex); break; case "action-single-step": if (!(Z = this.getItemModel(e.id)) || "expression" !== Z.type) return; if (!Z.formula.action_value) return; this.evaluator.addActionStepEvent(Z.id); break; case "update-expression-search-str": this.updateExpressionSearchStr(e.str); break; case "update-expression-replace-str": this.updateExpressionReplaceStr(e.str); break; case "rename-identifier-global": F.renameIdentifierGlobal(this.listModel, e.search, e.replace); break; case "rename-identifier-in-item": F.renameIdentifierGlobal(this.listModel, e.search, e.replace, { limitToItem: e.id }); break; case "rename-identifier-in-folder": F.renameIdentifierGlobal(this.listModel, e.search, e.replace, { limitToFolder: e.id }); break; case "update-ticker-handlerlatex": this.updateTickerHandlerLatex(e.latex); break; case "update-ticker-minsteplatex": this.updateTickerMinStepLatex(e.latex); break; case "set-braille-mode": this.setBrailleMode(e.mode); break; case "set-six-key-input": this.setSixKeyInput(e.useSixKeyInput); break; case "close-expression-search": this.expressionSearchOpen = !1, this.updateExpressionSearchStr(""); var pe = this.getItemModelByIndex(0); pe && C.moveFocusToItem(this, pe.id, "end"); break; case "open-expression-search": this.expressionSearchOpen = !0, this.focusLocation = { type: "search-expressions" }; var ce = e.latex; e.rename && !Y.isSingleIdentifier(ce) && (ce = ""); var he = e.rename ? ce ? "\\operatorname{rename}\\ " + ce + "\\to" : "\\operatorname{rename}\\ " : ce; this.updateExpressionSearchStr(he); break; case "open-ticker": this.listModel.ticker.open = !0, this.focusLocation = { type: "ticker", location: "handler" }, this._closeAddExpression(); break; case "close-ticker": this.listModel.ticker.open = !1, this.listModel.ticker.playing = !1, this.listModel.ticker.minStepLatex = "", this.listModel.ticker.handlerLatex = ""; break; case "toggle-ticker": this.listModel.ticker.playing = !this.listModel.ticker.playing, this.listModel.ticker.lastTickTime = void 0, this.pauseAllSliders(); break; default: return e } }, e.prototype.pauseAllSliders = function () { this.getPlayingSliders().forEach(function (e) { k.setSliderIsPlaying(e, !1) }) }, e.prototype.handleClickableItemClicked = function (e, t) { var i, s = this.getItemModel(e); s && ("expression" !== s.type && "image" !== s.type || "maybe-valid" === (null === (i = s.formula.click_handler) || void 0 === i ? void 0 : i.status) && this.evaluator.addClickEvent(s.id, t)) }, e.prototype.canAddTicker = function () { return !this.getTickerOpen() }, e.prototype.doesIdentifierBlockActionUpdate = function (e) { for (var t = this.getFocusLocation(), i = 0, s = F.getItemsByIdentifier(this.listModel, e); i < s.length; i++) { var o = s[i]; if ("expression" === (null == t ? void 0 : t.type) && t.id === o.id) return !0; if (k.shouldBlockActionUpdate(o)) return !0 } return !1 }, e.prototype.updateLatexForIdentifier = function (e, t) { var i = F.getItemsByIdentifier(this.listModel, e); if (1 === i.length) { var s = i[0]; s.slider.isPlaying ? (k.setSliderIsPlaying(s, !1), k.setLatex(s, t), k.setSliderIsPlaying(s, !0)) : k.setLatex(s, t) } }, e.prototype.updateExpressionSearchStr = function (e) { this.rawExpressionSearchStr = e; var t = "\\operatorname{rename}"; if (0 === e.indexOf(t)) { var i = e.slice(t.length).replace(/\\ /g, "").split(/\\to(?![a-zA-Z])/); 2 === i.length ? (this.expressionSearchStr = i[0], this.isExpressionSearchStrValidForReplace = Y.isSingleIdentifier(this.expressionSearchStr), this.updateExpressionReplaceStr(i[1])) : (this.expressionSearchStr = i[0], this.isExpressionSearchStrValidForReplace = !1, this.updateExpressionReplaceStr("")); var s = F.filterItemsByIdentifierSearch(this.listModel, this.getExpressionSearchStr()); this.expressionSearchCount = this.expressionSearchOpen ? s : 0 } else this.expressionSearchStr = e.length > 1 && 0 === "rename".indexOf(e) ? "" : e, this.isExpressionSearchStrValidForReplace = !1, this.updateExpressionReplaceStr(""), this.filterItemsBySearch() }, e.prototype.filterItemsBySearch = function () { if (this.getExpressionReplaceStr()); else { var e = F.filterItemsBySearch(this.listModel, this.getExpressionSearchStr()); this.expressionSearchCount = this.expressionSearchOpen ? e : 0 } }, e.prototype.updateExpressionReplaceStr = function (e) { this.expressionReplaceStr = e, this.isExpressionReplaceStrValidForReplace = Y.isSingleIdentifier(e) }, e.prototype.getIsExpressionSearchStrValidForReplace = function () { return this.isExpressionSearchStrValidForReplace }, e.prototype.getIsExpressionReplaceStrValidForReplace = function () { return this.isExpressionReplaceStrValidForReplace }, e.prototype.isSearchReplaceValid = function () { return this.getIsExpressionSearchStrValidForReplace() && this.getIsExpressionReplaceStrValidForReplace() }, e.prototype.shouldShowReplaceIcon = function () { return this.isSearchReplaceValid() }, e.prototype.updateTickerHandlerLatex = function (e) { this.listModel.ticker.handlerLatex = e }, e.prototype.updateTickerMinStepLatex = function (e) { this.listModel.ticker.minStepLatex = e }, e.prototype.getRawExpressionSearchStr = function () { return this.rawExpressionSearchStr || "" }, e.prototype.getExpressionSearchStr = function () { return this.expressionSearchStr || "" }, e.prototype.getExpressionReplaceStr = function () { return this.expressionReplaceStr || "" }, e.prototype.getExpressionSearchCount = function () { return this.expressionSearchCount || 0 }, e.prototype.getTicker = function () { return this.listModel.ticker }, e.prototype.getTickerHandlerLatex = function () { return this.listModel.ticker.handlerLatex || "" }, e.prototype.getTickerMinStepLatex = function () { return this.listModel.ticker.minStepLatex || "" }, e.prototype.getTickerAvgDelta = function () { return this.listModel.ticker.avgDelta }, e.prototype.getBrailleMode = function () { return this.graphSettings.config.brailleMode }, e.prototype.setBrailleMode = function (e) { this.graphSettings.config.setProperty("brailleMode", e) }, e.prototype.getSixKeyInput = function () { return this.graphSettings.config.sixKeyInput }, e.prototype.setSixKeyInput = function (e) { this.graphSettings.config.setProperty("sixKeyInput", e) }, e.prototype.getBrailleControls = function () { return this.graphSettings.config.brailleControls }, e.prototype.setBrailleControls = function (e) { this.graphSettings.config.setProperty("brailleControls", e) }, e.prototype.getAudio = function () { return this.graphSettings.config.audio }, e.prototype.setAudio = function (e) { this.graphSettings.config.setProperty("audio", e) }, e.prototype.setEditListMode = function (e) { this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { inEditListMode: e }) }, e.prototype.generateTableXSubscript = function () { return F.findAvailableColumnSubscript(this.listModel) }, e.prototype._createTableItem = function () { var e = this.generateTableXSubscript(), t = _.makeTableState(e, [[""], [""]], this); return this.createItemModel(t) }, e.prototype._populateSettingsViewLimitLatex = function () { this.grapher && (this.settingsViewModel = i.__assign(i.__assign({}, this.settingsViewModel), { limitLatex: R.limitLatex(this.grapher.getCurrentViewport(), this.getGraphSettings().xAxisStep, this.getGraphSettings().yAxisStep) })) }, e.prototype.getSettingsViewModel = function () { return this.settingsViewModel }, e.prototype.getListModel = function () { return this.listModel }, e.prototype.hasBackgroundColor = function () { return "#ffffff" !== this.getBackgroundColor() }, e.prototype.getBackgroundColor = function () { return this.getGraphSettings().getBackgroundColor() }, e.prototype.getTextColor = function () { return this.getGraphSettings().getTextColor() }, e.prototype.getPillboxBackgroundColor = function () { return S.shadeColor(this.getBackgroundColor(), -.07) }, e.prototype.subToChanges = function (e) { var t = this, i = this.nextSubscription; return this.nextSubscription += 1, this.subscriptions[i] = e, function () { delete t.subscriptions[i] } }, e.prototype.updateTheComputedWorld = function () { var e = this; F.reindex(this.listModel), F.updateDrawOrder(this.listModel), this.grapher && this.grapher.setSketchOrder(this.listModel.drawOrder); for (var t = 0, s = this.getAllItemModels(); t < s.length; t++) { var o = s[t]; switch (o.type) { case "expression": k.onControllerUpdate(o); break; case "image": w.onControllerUpdate(o); break; case "table": _.onControllerUpdate(o); break; case "folder": E.onControllerUpdate(o); break; case "text": L.onControllerUpdate(o); break; default: return o } } if (A.onControllerUpdate(this.listModel.ticker), this.isCurrentFocusLocationValid() || C.setFocusLocation(this, void 0), this.listModel.openItemMenu) { var r = this.getOpenMenuIcon(); document.body && r && document.body.contains(r[0]) || (this.listModel.openItemMenu = void 0) } var a = this.getSelectedItem(); a && !this.getItemModel(a.id) && F.setSelected(this.listModel, void 0), this.layoutModel.graphSettingsOpen || this._populateSettingsViewLimitLatex(), this.propagateSelection(), this.isKeypadOpen() || (this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { keypadFunctionsOpen: !1 })), this.runAfterDispatch(function () { e.grapher && "2d" === e.grapher.type && e.grapher.audioGraph.checkIfSelectedItemChanged(a ? a.id : void 0), e.grapher && "2d" === e.grapher.type && e.focusLocation && e.grapher.audioGraph.exitAudioTrace() }) }, e.prototype.getOpenMenuIcon = function () { var e = this.getOpenItemMenu(); if (e) { var t = e.guid, i = this.find$('[dcg-open-menu-guid="' + t + '"]'); if (0 !== i.length) return i } }, e.prototype.propagateSelection = function () { this.grapher && this.evaluator ? this.__lastSelectedId = t.propagateSelection(this, this.grapher, this.evaluator, this.__lastSelectedId) : this.__lastSelectedId = void 0 }, e.prototype.getIntersectId = function () { return this.__lastSelectedId }, e.prototype.areParsableObjectsEqual = function (e, t) { return e === t || n.isEqual(i.__assign(i.__assign({}, e), { regressionParameters: void 0 }), i.__assign(i.__assign({}, t), { regressionParameters: void 0 })) }, e.prototype.requestParseForAllItems = function () { (this.isCurrentlyDoingSetState || this.isCurrentlyDoingRestoreState) && (this.lastParsableObjects = {}, this.evaluator.clearStatementsAndStartCompleteState(), this.isCurrentlyDoingRestoreState && this.evaluator.markUndoRedoState()); for (var e = {}, t = this.lastParsableObjects, i = 0, s = this.getAllItemModels(); i < s.length; i++) { switch ((h = s[i]).type) { case "expression": case "image": case "table": e[h.guid] = h.cachedParsableState; break; case "folder": case "text": break; default: return h } } for (var o = 0, r = F.getAllHelperItemModels(this.listModel); o < r.length; o++) { e[(h = r[o]).guid] = h.cachedParsableState } for (var a in this.listModel.ticker.cachedParsableState && (e[this.listModel.ticker.guid] = this.listModel.ticker.cachedParsableState), t) { var n = t[a], l = e[a]; if ("image" !== n.type || l && l.type === n.type && l.guid === n.guid || this.grapher && this.grapher.removeGraphImage(n.id), !l && (this.evaluator.removeStatement(n.id), "table" === n.type)) for (var d = 0, p = n.columns; d < p.length; d++) { var c = p[d]; this.evaluator.removeStatement(c.id) } } for (var a in e) { var h; l = e[a], n = t[a]; if ("image" === l.type && (!n || l.type !== n.type || l.guid !== n.guid)) if (this.grapher) (h = this.getItemModel(l.id)) && "image" === h.type && this.grapher.addGraphImage(h); this.areParsableObjectsEqual(l, n) || (this.grapher && "statement" === l.type && "" === l.latex && this.grapher.removeGraphSketch(l.id), this.evaluator.addStatement(l)) } this.lastParsableObjects = e }, e.prototype.getViewState = function () { if (this.grapher) { var e = this.grapher.getProjection(); return { viewport: e.viewport.toObject(), screen: e.screen } } }, e.prototype.setEvaluator = function (e) { this.evaluator = e }, e.prototype.setGrapher = function (e) { this.grapher = e }, e.prototype.getGrapher = function () { return this.grapher }, e.prototype.shouldExpressionZoomFit = function (e) { if (!this.grapher) return !1; if (!this.isZoomFitEnabled()) return !1; if ("expression" === e.type || "table" === e.type) { if ("expression" === e.type && (e.error || !e.shouldGraph || !e.formula.is_graphable)) return !1; if (!e.boundingBoxes || !e.boundingBoxes.length) return !1; var t = this.grapher.viewportController; return "getProjection" in t && T.shouldExpressionZoomFit(e.boundingBoxes, t.getProjection()) } return !1 }, e.prototype.setBugsnagContext = function (e) { this.bugsnagContext = e }, e.prototype.getItemRootNodeById = function (e) { var t = this.getItemModel(e); return t && t.dcgView ? t.dcgView.findRootNode() : void 0 }, e.prototype.getItemSelectorById = function (e) { var t = this.getItemRootNodeById(e); return t ? U(t) : void 0 }, e.prototype.generateId = function () { var e = this.__nextItemId; return this.__nextItemId += 1, e + "" }, e.prototype.getNextColor = function () { return F.getNextColor(this.listModel) }, e.prototype.getNextDisplayIndex = function () { return this.listModel.nextDisplayIndex }, e.prototype._clearPendingImageUploads = function () { this.__pendingImageUploads = {} }, e.prototype.isUploadingImages = function () { return Object.keys(this.__pendingImageUploads).length > 0 }, e.prototype.getExpressionAnalysis = function () { return this.listModel.expressionAnalysis }, e.prototype.createItemModel = function (e) { return F.modelFromSpec(this.listModel, e) }, e.prototype.getItemModel = function (e) { return F.getItemById(this.listModel, e) }, e.prototype.getColorById = function (e) { var t = this.getItemModel(e); return t && "expression" === t.type ? k.getEvaluationValue(t) : "" }, e.prototype.getAllColorAssignments = function () { for (var e = [], t = 0, i = this.getAllItemModels(); t < i.length; t++) { var s = i[t]; if ("expression" === s.type) { var o = k.getAssignment(s); if (o) { var r = this.getEvaluationValueForItem(s.id); ("string" == typeof r || Array.isArray(r) && "string" == typeof r[0]) && e.push({ id: s.id, assignmentLatex: a.identifierToLatex(o) }) } } } return e }, e.prototype.getItemModelByIndex = function (e) { return F.getItemByIndex(this.listModel, e) }, e.prototype.getItemCount = function () { return F.getItemCount(this.listModel) }, e.prototype.getItemEditableLabelMode = function (e) { var t = this.getItemModel(e); if (t && "expression" === t.type) return k.getEditableLabelMode(t) }, e.prototype.isItemSecret = function (e) { var t = this.getItemModel(e); return !!t && F.isItemSecret(t) }, e.prototype.isItemSelected = function (e) { var t = this.getItemModel(e); return !!t && F.isItemSelected(t) }, e.prototype.isItemSelectable = function (e) { var t = this.getItemModel(e); return !!t && F.isItemSelectable(t) }, e.prototype.anyItemDependsOnRandomSeed = function () { return F.anyItemDependsOnRandomSeed(this.listModel) }, e.prototype.areActionsEnabled = function () { return "auto" === this.graphSettings.config.actions ? F.anyItemIsAction(this.listModel) : !!this.graphSettings.config.actions }, e.prototype.getAllItemModels = function () { return F.getAllItemModels(this.listModel) }, e.prototype.getAllModelsWithSliders = function () { return F.getAllModelsWithSliders(this.listModel) }, e.prototype.getGraphSettings = function () { return this.graphSettings }, e.prototype.getAudioGraph = function () { return void 0 !== this.grapher && "2d" === this.grapher.type ? this.grapher.audioGraph : void 0 }, e.prototype.inAudioTraceMode = function () { var e = this.getAudioGraph(); return !(!e || !e.audioTraceActive) }, e.prototype.canAudioTrace = function () { var e = this.getAudioGraph(); return !!e && e.canAudioTraceCurrentExp() }, e.prototype.isAudioTracing = function () { var e = this.getAudioGraph(); return !!e && e.getIsTracing() }, e.prototype.expressionsAreFullWidth = function () { return this.isNarrow() || !1 === this.graphSettings.config.graphpaper }, e.prototype.getExpListWidthString = function () { return this.expressionsAreFullWidth() ? "100%" : this.rootElt ? this._getExpListWidth() + "px" : "0" }, e.prototype.getExpListWidth = function () { return this.rootElt ? this._getExpListWidth() : 0 }, e.prototype.findFirstVisibleItem = function () { var e = G.getFirstVisibleItemId(this, this._previousFirstVisibleId); return this._previousFirstVisibleId = e, e ? this.getItemModel(e) : void 0 }, e.prototype.findLastVisibleItem = function () { var e = G.getLastVisibleItemId(this, this._previousLastVisibleId); return this._previousLastVisibleId = e, e ? this.getItemModel(e) : void 0 }, e.prototype.updateRenderShellsAfterDispatch = function () { if (this.rootElt && this.isListVisible()) { var e = this.findFirstVisibleItem(), t = this.findLastVisibleItem(), i = e && this.getItemRootNodeById(e.id), s = t && this.getItemRootNodeById(t.id); if (i !== this.lastInfiniteScrollFirstDOM || s !== this.lastInfiniteScrollLastDOM || this.hasDispatchSinceLastInfiniteScrollUpdate) { this.lastInfiniteScrollFirstDOM = i, this.lastInfiniteScrollLastDOM = s, this.hasDispatchSinceLastInfiniteScrollUpdate = !1; var o, r = !1, a = e ? e.index : 1 / 0, n = t ? t.index : 1 / 0, l = this.listModel.dragState && this.listModel.dragState.firstItemId, d = this.getOpenItemMenu(); d && (o = d.model.id); for (var p = 0, c = this.getAllItemModels(); p < c.length; p++) { var h = c[p], u = !(h.index >= a && h.index <= n && !h.isHiddenFromUI); if (l == h.id && (u = !1), o === h.id && (u = !1), h.renderShell !== u && (h.renderShell = u, r = !0, u)) { var g = this.getItemRootNodeById(h.id); if (g) { var m = g.getBoundingClientRect().height; m > 0 && (h.cachedRenderHeight = m) } } } r && this.markTickRequiredNextFrame() } } }, e.prototype.updateRenderShellsBeforePaint = function () { if (this.hasDispatchSinceLastInfiniteScrollUpdate = !0, this.inPrintMode) for (var e = 0, t = this.getAllItemModels(); e < t.length; e++) { (o = t[e]).renderShell = !1 } else { for (var i = 0, s = this.getAllItemModels(); i < s.length; i++) { var o; (o = s[i]).isHiddenFromUI && (o.renderShell = !0) } var r = this.getSelectedItem(); r && (r.renderShell = !1) } }, e.prototype.updateDragDrop = function () { var e = this.listModel.dragState; if (e) { var t = this.getItemModel(e.firstItemId); if (t) { var i = this.dragdrop_expressions.applyDrag(); i && (F.setDragState(this.listModel, i.dragState), D.setFolderId(t, i.folderId), t.index !== i.newIndex && F.moveItemsTo(this.listModel, t.index, i.newIndex, e.numberOfItems)) } } }, e.prototype._tickSliders = function (e) { this.getPlayingSliders().forEach(function (t) { k.tickSliderStep(t, e) }) }, e.prototype.tickTicker = function (e) { var t = void 0 === this.listModel.ticker.lastTickTime; this.evaluator.addClockTickEvent(this.listModel.ticker.id, t), A.updateLastTickTime(this.listModel.ticker, e) }, e.prototype.stopAllSliders = function () { for (var e = 0, t = this.getAllItemModels(); e < t.length; e++) { var i = t[e]; "expression" === i.type && i.slider.isPlaying && k.setSliderIsPlaying(i, !1) } }, e.prototype.getPlayingSliders = function () { for (var e = [], t = 0, i = this.getAllItemModels(); t < i.length; t++) { var s = i[t]; "expression" === s.type && s.sliderExists && s.slider.isPlaying && e.push(s) } return e }, e.prototype.hasAnyTableThatRequiresTicks = function () { for (var e = 0, t = this.getAllItemModels(); e < t.length; e++) { var i = t[e]; if (!i.renderShell && "table" === i.type && i.rowModels.length >= 25) return !0 } return !1 }, e.prototype.areAnyImagesLoading = function () { return F.areAnyImagesLoading(this.listModel) }, e.prototype._commitUserRequestedViewport = function (e) { this.grapher && this.grapher.setUserRequestedViewport(e) }, e.prototype._setAxisLimitLatex = function (e, t) { var s, o; this.settingsViewModel = i.__assign(i.__assign({}, this.settingsViewModel), { limitLatex: i.__assign(i.__assign({}, this.settingsViewModel.limitLatex), (s = {}, s[e] = t, s)) }); var r = "" === t && ("xstep" === e || "ystep" === e) ? 0 : P.default(t, this.graphSettings.degreeMode); switch (e) { case "xstep": if (r < 0 || !isFinite(r)) return; this.graphSettings.setProperty("xAxisStep", r); break; case "ystep": if (r < 0 || !isFinite(r)) return; this.graphSettings.setProperty("yAxisStep", r); break; case "xmin": case "xmax": case "ymin": case "ymax": if (!this.grapher) return; var a = this.grapher.viewportController.getViewport(), n = "xmin"; "xmin" === e && (n = "xmax"), "ymax" === e && (n = "ymin"), "ymin" === e && (n = "ymax"); var l = P.default(this.settingsViewModel.limitLatex[n], this.graphSettings.degreeMode), d = y.Viewport.fromObject(i.__assign(i.__assign({}, a.toObject()), ((o = {})[e] = r, o[n] = l, o))); if (!d.isValid()) return; this.grapher.viewportController.setViewport(d); var p = "xmin" === e || "xmax" === e ? "x" : "y"; this.graphSettings.setProperty("lastChangedAxis", p); var c = d.isSquare(this.grapher.getProjection().screen); this.graphSettings.setProperty("squareAxes", c) }if (this.grapher) { var h = this.grapher.viewportController.getViewport().toObject(); this._commitUserRequestedViewport(h) } }, e.prototype.getLockViewportConfigSetting = function () { return this.graphSettings.config.lockViewport }, e.prototype.getLockViewportUserSetting = function () { return this.graphSettings.userLockedViewport }, e.prototype.canUserAddExpressions = function () { return !!this.graphSettings.config.expressions }, e.prototype.areNotesEnabled = function () { return !!this.graphSettings.config.notes }, e.prototype.areSlidersEnabled = function () { return !!this.graphSettings.config.sliders }, e.prototype.areLinksEnabled = function () { return !!this.graphSettings.config.links }, e.prototype.areImagesEnabled = function () { var e = window.FileReader, t = r.IS_IPAD && r.IOS_VERSION && 8 === r.IOS_VERSION[0] && 0 === r.IOS_VERSION[1] && 0 === r.IOS_VERSION[2]; return !(!this.graphSettings.config.images || !e || t) }, e.prototype.areFoldersEnabled = function () { return !!this.graphSettings.config.folders }, e.prototype.isDecimalToFractionEnabled = function () { return !!this.graphSettings.config.decimalToFraction }, e.prototype.isTraceEnabled = function () { return !!this.graphSettings.config.trace }, e.prototype.areFunctionsRestricted = function () { return !!this.graphSettings.config.restrictedFunctions }, e.prototype.areGeometryFunctionsForceEnabled = function () { return !!this.graphSettings.config.forceEnableGeometryFunctions }, e.prototype.isQwertyKeyboardEnabled = function () { return !!this.graphSettings.config.qwertyKeyboard }, e.prototype.isZoomFitEnabled = function () { return !!this.graphSettings.config.zoomFit }, e.prototype.canEditOnWeb = function () { return !!this.graphSettings.config.editOnWeb }, e.prototype.hasTransparentBackground = function () { return !!this.graphSettings.config.transparentBackground }, e.prototype.shouldAudioTraceReverseExpressions = function () { return !!this.graphSettings.config.audioTraceReverseExpressions }, e.prototype.hasDefaultState = function () { return !!this.graphSettings.defaultState }, e.prototype.getDefaultStateViewport = function () { var e = this.graphSettings.defaultState; if (e && e.graph) return e.graph.viewport }, e.prototype.getColors = function () { return this.graphSettings.config.colors }, e.prototype.getImageOpacities = function () { return ["0.2", "0.4", "0.6", "0.8", "1"] }, e.prototype.getUIDragModes = function () { return [c.DragMode.X, c.DragMode.Y, c.DragMode.XY] }, e.prototype.getNumberOfItemsInFolder = function (e) { return F.getNumberOfItemsInFolder(this.listModel, e) }, e.prototype.getEnabledDragModesForItem = function (e) { var t = this.getItemModel(e); if (!t || "expression" !== t.type) return []; var i = t.formula, s = []; if (!i.move_strategy) return s; var o = "none" !== i.move_strategy[0].type, r = "none" !== i.move_strategy[1].type, a = o && r; return o && s.push(c.DragMode.X), r && s.push(c.DragMode.Y), a && s.push(c.DragMode.XY), s }, e.prototype.shouldShowEvaluationForItem = function (e) { var t = this.getItemModel(e); return !!t && ("expression" === t.type && k.shouldShowEvaluation(t)) }, e.prototype.getEvaluationValueForItem = function (e) { var t = this.getItemModel(e); return t ? "expression" !== t.type ? NaN : k.getEvaluationValue(t) : NaN }, e.prototype.canDisplayEvaluationForItemAsFraction = function (e) { if (!this.isDecimalToFractionEnabled()) return !1; var t = this.getItemModel(e); if (!t) return !1; if ("expression" !== t.type) return !1; if (k.isGraphable(t)) return !1; var i = this.getEvaluationValueForItem(e); return "number" == typeof i && a.canDisplayAsFraction(i) }, e.prototype.shouldEvaluationForItemDisplayAsFraction = function (e) { if (!this.isDecimalToFractionEnabled()) return !1; var t = this.getItemModel(e); return !!t && ("expression" === t.type && k.shouldEvaluationDisplayAsFraction(t)) }, e.prototype.getEvaluationLabelOptionsForItem = function (e) { return i.__assign(i.__assign({}, M.EvaluationLabelOptions), { displayAsFraction: this.shouldEvaluationForItemDisplayAsFraction(e) }) }, e.prototype.getPointStyles = function () { return [h.PointStyle.POINT, h.PointStyle.OPEN, h.PointStyle.CROSS] }, e.prototype.getLineStyles = function () { return [h.LineStyle.SOLID, h.LineStyle.DASHED, h.LineStyle.DOTTED] }, e.prototype.getOpacities = function () { return [p.LOW, p.DEFAULT, p.HIGH] }, e.prototype.isInEditListMode = function () { return this.layoutModel.inEditListMode }, e.prototype.canAdministerSecretFolders = function () { return this.graphSettings.config.administerSecretFolders }, e.prototype.getInvertedColors = function () { return !!this.graphSettings.config.invertedColors }, e.prototype.canUseAdvancedStyling = function () { return this.graphSettings.config.advancedStyling }, e.prototype.isDegreeMode = function () { return this.graphSettings.degreeMode }, e.prototype.areLogModeRegressionsForced = function () { return this.graphSettings.config.forceLogModeRegressions }, e.prototype.setAllRegressionsToLogMode = function () { for (var e = 0, t = this.getAllItemModels(); e < t.length; e++) { var i = t[e]; "expression" === i.type && i.formula && i.formula.is_regression && k.setLogMode(i, !0) } }, e.prototype.isGraphSettingsOpen = function () { return this.layoutModel.graphSettingsOpen }, e.prototype.isAddExpressionOpen = function () { return this.layoutModel.addExpressionOpen }, e.prototype.shouldRenderList = function () { if (this.layoutModel.expressionsVisible) return !0; var e = this.layoutModel.expressionsHiddenTime; return void 0 !== e && Date.now() - e <= 500 }, e.prototype.isListVisible = function () { return this.layoutModel.expressionsVisible }, e.prototype.isGrapherEnabled = function () { return !1 !== this.graphSettings.config.graphpaper }, e.prototype.isListEnabled = function () { return !1 !== this.graphSettings.config.expressions }, e.prototype.areDistributionsEnabled = function () { return !0 === this.graphSettings.config.distributions }, e.prototype.isExpressionListFocused = function () { var e = this.getFocusLocation(); if (!e) return !1; switch (e.type) { case "settings": case "expression-menu": case "editable-label": case "regression-output": return !1; case "distribution-param": case "cdf-limit": case "slider-limit": case "domain-limit": case "expression": case "visualization-prop": case "search-expressions": case "replace-expressions": case "ticker": case "table": case "image": case "readonly-expression": case "braille-output": case "table-container": case "text": case "folder": case "add-item-btn": case "add-expression-btn": case "add-note-btn": case "add-table-btn": case "add-folder-btn": case "add-ticker-btn": case "add-image-btn": case "change-image-btn": case "edit-list-toggle": case "expression-icon": case "image-icon": case "slider-icon": case "slider-animation-properties-icon": case "slider-thumb": case "table-icon": case "action-icon": case "hide-expression-list-btn": case "show-expression-list-btn": return !0; default: return e } }, e.prototype.needsFakeKeypad = function () { if (this.inAudioTraceMode() && this.isKeypadEnabled()) return !0; var e = this.getFocusLocation(); if (!e) return !1; if ("none" !== this.getBrailleMode() && K.getFocusedBrailleElement()) return !1; switch (e.type) { case "settings": return "icon" !== e.location && "degree-mode" !== e.location; case "distribution-param": case "cdf-limit": case "slider-limit": case "domain-limit": case "expression": case "visualization-prop": case "search-expressions": case "replace-expressions": case "ticker": return !0; case "expression-menu": return "opacity" === e.location || "linewidth" === e.location || "lineopacity" === e.location || "pointopacity" === e.location || "pointsize" === e.location || "labelsize" === e.location || "labelangle" === e.location || "updaterule" === e.location; case "table": if (this.isInEditListMode()) return !1; var t = e.location; if (0 === t.row) return !0; var i = this.getItemModel(e.id); if (!i || "table" !== i.type) return !1; var s = i.columnModels[t.column]; return !!s && !s.disabled; case "image": return "name" !== e.location; case "readonly-expression": case "braille-output": case "regression-output": case "table-container": case "text": case "folder": case "add-item-btn": case "add-expression-btn": case "add-note-btn": case "add-table-btn": case "add-folder-btn": case "add-ticker-btn": case "add-image-btn": case "change-image-btn": case "edit-list-toggle": case "hide-expression-list-btn": case "show-expression-list-btn": return !1; case "expression-icon": case "image-icon": case "slider-icon": case "action-icon": case "slider-animation-properties-icon": case "slider-thumb": case "table-icon": return !1; case "editable-label": return this.getItemEditableLabelMode(e.id) === v.EditableLabelMode.Math; default: return e } }, e.prototype.getBrandingMode = function () { return this.getEditLink() ? "static-edit-link" : this.getGraphSettings().config.editOnWeb ? "edit-link" : "powered-by" }, e.prototype.getEditLink = function () { return window.iframeEmbedBrandingLink }, e.prototype._expressionZoomFit = function (e) { var t = this.getItemModel(e); if (this.grapher && this.isZoomFitEnabled() && t && ("expression" === t.type || "table" === t.type) && t.boundingBoxes && t.boundingBoxes.length) { var i = this.grapher.viewportController; if ("zoomCustom" in i) { var s = T.getRecommendedViewportForExpression(t.boundingBoxes, i.getProjection()); s && i.zoomCustom(s) } } }, e.prototype._deleteItemAndAnimateOut = function (e, t) { var i = this, s = this.getItemSelectorById(e); s && (s.css({ transition: "0.2s", opacity: "0", transform: "scale(.1, .1)" }), setTimeout(function () { i.dispatch({ type: "finish-deleting-item-after-animation", id: e, setFocusAfterDelete: t }) }, 200)) }, e.prototype._finishDeletingItemAfterAnimation = function (e, t) { var i = this.getItemModel(e); if (i) { var s = this.getItemSelectorById(e), o = s && document.activeElement && U(document.activeElement).closest(s).length > 0, r = F.findPrevSelectableItem(this.listModel, i.index); if (this._removeExpressionSynchronously(i), t && o) { if (!r) { var a = F.getFirstSelectableItem(this.listModel); a && (r = a) } r && C.moveFocusToItem(this, r.id, "end") } } }, e.prototype._removeExpressionSynchronously = function (e) { if (F.removeItemAtIndex(this.listModel, e.index), F.hasNoVisibleExpressions(this.listModel)) { var t = this.createItemModel({ type: "expression", id: this.generateId(), color: this.getNextColor() }); F.insertItemAtEnd(this.listModel, t) } }, e.prototype.setRootElt = function (e) { this.rootElt = e, this.dragdrop_expressions = new z.default(this) }, e.prototype.getRootElt = function () { return this.rootElt }, e.prototype._hideExpressions = function (e) { this.graphSettings.config.expressions && (F.setSelected(this.listModel, void 0), this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { expressionsVisible: !1, expressionsHiddenTime: Date.now() }), e ? C.setFocusLocation(this, { type: "show-expression-list-btn" }) : u.default()) }, e.prototype._showExpressions = function (e) { this.graphSettings.config.expressions && (this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { expressionsVisible: !0 }), e ? C.setFocusLocation(this, { type: "hide-expression-list-btn" }) : u.default()) }, e.prototype._showToast = function (e) { var t = this; if (this.toastData = e, this.toastData.hasOwnProperty("undoCallback") && !r.IS_MOBILE) { var i = r.IS_APPLE ? this.s("graphing-calculator-text-toast-undo-cmd-z") : this.s("graphing-calculator-text-toast-undo-ctrl-z"); this.toastData.message += " " + i } clearTimeout(this._hideToastTimeout); var s = "number" == typeof e.hideAfter ? e.hideAfter : 6e3; s > 0 && (this._hideToastTimeout = setTimeout(function () { t.dispatch({ type: "toast/close", onHide: t.toastData.onHide }) }, s)) }, e.prototype._setExpressionPropertiesFromAPI = function (e, t) { var i = this.getItemModel(e); if (i) if ("table" === i.type && t.columns) { t = g.default(t); var s = _.cloneTableAndExtendWithProperties(i, t), o = F.modelFromSpec(this.listModel, s); this._toplevelReplaceItemAt(i.index, o, !1) } else { var r = this.getItemModel(e); if (!r) return; for (var a in t) if (t.hasOwnProperty(a)) switch (a) { case "slider": if ("expression" !== r.type) continue; var n = t[a]; n.hasOwnProperty("min") && k.setSliderMin(r, n.min), n.hasOwnProperty("max") && k.setSliderMax(r, n.max), n.hasOwnProperty("step") && k.setSliderStep(r, n.step), n.hasOwnProperty("isPlaying") && k.setSliderIsPlaying(r, n.isPlaying); break; case "polarDomain": if ("expression" !== r.type) continue; k.setPolarDomainMin(r, m.default(t.polarDomain.min)), k.setPolarDomainMax(r, m.default(t.polarDomain.max)); break; case "parametricDomain": if ("expression" !== r.type) continue; k.setParametricDomainMin(r, m.default(t.parametricDomain.min)), k.setParametricDomainMax(r, m.default(t.parametricDomain.max)); break; case "hidden": this._setItemHidden(e, t.hidden); break; case "secret": D.setSecret(r, t.secret); break; case "color": if ("expression" !== r.type) continue; k.setColor(r, t.color); break; case "dragMode": if ("expression" !== r.type) continue; k.setDragMode(r, t.dragMode); break; case "label": if ("expression" !== r.type) continue; k.setLabel(r, t.label); break; case "showLabel": if ("expression" !== r.type) continue; k.setShowLabel(r, t.showLabel); break; case "labelSize": if ("expression" !== r.type) continue; k.setLabelSize(r, t.labelSize); break; case "labelOrientation": if ("expression" !== r.type) continue; k.setLabelOrientation(r, t.labelOrientation); break; case "latex": if ("expression" !== r.type) continue; k.setLatex(r, t.latex); break; case "points": if ("expression" !== r.type) continue; k.setPoints(r, !!t.points); break; case "lines": if ("expression" !== r.type) continue; k.setLines(r, !!t.lines); break; case "pointStyle": if ("expression" !== r.type) continue; k.setPointStyle(r, t.pointStyle); break; case "pointSize": if ("expression" !== r.type) continue; k.setPointSize(r, t.pointSize); break; case "pointOpacity": if ("expression" !== r.type) continue; k.setPointOpacity(r, t.pointOpacity); break; case "lineStyle": if ("expression" !== r.type) continue; k.setLineStyle(r, t.lineStyle); break; case "lineWidth": if ("expression" !== r.type) continue; k.setLineWidth(r, t.lineWidth); break; case "lineOpacity": if ("expression" !== r.type) continue; k.setLineOpacity(r, t.lineOpacity); break; case "fill": if ("expression" !== r.type) continue; k.setFill(r, t.fill); break; case "fillOpacity": if ("expression" !== r.type) continue; k.setFillOpacity(r, t.fillOpacity); break; case "id": case "type": case "domain": break; default: throw new Error("trying to call setProperty for: " + a) } } }, e.prototype._isParentFolderHidden = function (e) { var t = this.getItemModel(e); if (!t) return !1; var i = F.getParentFolderModel(t); return !!i && i.hidden }, e.prototype._toggleItemHidden = function (e) { if (this._isParentFolderHidden(e)) this._setItemHidden(e, !1); else { var t = this.getItemModel(e); if (!t) return; switch (t.type) { case "expression": case "image": case "folder": this._setItemHidden(e, !t.hidden); break; case "table": case "text": break; default: return t } } }, e.prototype._toggleTableColumnHidden = function (e, t) { if (this._isParentFolderHidden(e)) this._setTableColumnHidden(e, t, !1); else { var i = this.getItemModel(e); if (!i || "table" !== i.type) return; var s = _.getColumnModel(i, t); if (!s) return; this._setTableColumnHidden(e, t, !s.hidden) } }, e.prototype._setTableColumnHidden = function (e, t, i) { var s = this.getItemModel(e); if (s && "table" === s.type) { var o = _.shouldHideColumn(s, t); !i && this._isParentFolderHidden(e) && this._setItemHidden(s.folderId, !1), _.setColumnHidden(s, t, i), !i && o && _.setColumnPoints(s, t, !0) } }, e.prototype._setItemHidden = function (e, t) { var i = this.getItemModel(e); if (i) switch (!t && "folder" !== i.type && this._isParentFolderHidden(i.id) && this._setItemHidden(i.folderId, !1), i.type) { case "expression": k.setHidden(i, t); break; case "folder": E.setHidden(i, t); break; case "image": w.setHidden(i, t); break; case "table": case "text": break; default: return i } }, e.prototype._addItemToEndFromAPI = function (e) { var t = F.getLastSelectableItem(this.listModel); !e.secret && t && "expression" === t.type && "" === t.latex && F.removeItemAtIndex(this.listModel, t.index), F.insertItemAtEnd(this.listModel, e) }, e.prototype.copyExpressionToIndex = function (e, t, s) { var o, r = this, a = { stripDefaults: !1 }; switch (e.type) { case "expression": o = k.getState(e, a); break; case "table": (o = _.getState(e, a)).columns && o.columns.forEach(function (e) { e.id = r.generateId() }); break; case "image": o = w.getState(e, a); break; case "text": o = L.getState(e, a); break; default: return }var n = this.createItemModel(i.__assign(i.__assign({}, o), { id: this.generateId() })); this._toplevelInsertItemAt(t, n, !1, s || e.folderId) }, e.prototype._toplevelInsertItemAt = function (e, t, i, s) { var o = t; F.insertItemAtIndex(this.listModel, o, e), s && D.setFolderId(o, s), i && C.moveFocusToItem(this, o.id) }, e.prototype._toplevelNewItemAtSelection = function (e, t) { var i = this.getSelectedItem(); if (i) { var s = "expression" === i.type && !i.latex; if (s && !i.folderId && ("expression" !== e.type || e.latex)) return this._toplevelReplaceItemAt(i.index, e, t.shouldFocus); if (s && i.folderId && "expression" !== e.type && "folder" !== e.type) return this._toplevelReplaceItemAt(i.index, e, t.shouldFocus); if ("folder" !== i.type && !i.folderId) { return this._toplevelInsertItemAt(i.index + 1, e, t.shouldFocus, undefined) } if ("folder" !== i.type && i.folderId && "folder" !== e.type) return this._toplevelInsertItemAt(i.index + 1, e, t.shouldFocus, i.folderId); if ("folder" === i.type && !i.collapsed && "folder" !== e.type) return this._toplevelInsertItemAt(i.index + 1, e, t.shouldFocus, i.id) } var o = this.getFirstFullyVisibleItem(); for (o && "folder" === o.type && (o = this.getItemModelByIndex(o.index + 1)); o && "folder" !== o.type && o.folderId;)o = this.getItemModelByIndex(o.index + 1); var r = o ? o.index : this.getItemCount(); return this._toplevelInsertItemAt(r, e, t.shouldFocus, undefined) }, e.prototype.getFirstFullyVisibleItem = function () { var e = G.getFirstFullyVisibleItemId(this); if (e) return F.getItemById(this.listModel, e) }, e.prototype.find$ = function (e) { return U(this.rootElt).find(e) }, e.prototype.getExppanelSelectorOrThrow = function () { var e = G.getExppanelElt(this); if (e) return U(e); throw new Error("expected to find $exppanel but could not") }, e.prototype.scrollItemIntoView = function (e) { if (this.rootElt && this.isListVisible()) { var t = this.getItemSelectorById(e.id), i = G.getExppanelSelector(this); if (t && i) { if ("table" === e.type) { var o = t.find(".dcg-row .dcg-selected"); if (1 === o.length) return void s.scrollVisible(o, i, 60) } s.scrollVisible(t, i, 90) } } }, e.prototype.scrollSelectedItemIntoView = function () { var e = this.getSelectedItem(); e && this.scrollItemIntoView(e) }, e.prototype._pasteTable = function (e) { var t = this; if (this.grapher) { var i = F.findAvailableColumnSubscript(this.listModel), s = _.makeTableState(i, e, this), o = this.createItemModel(s); this._toplevelNewItemAtSelection(o, { shouldFocus: !0 }), this._closeAddExpression(); var r = this.grapher.getProjection(), a = r.viewport, l = n.map(e[0], function (e) { return parseFloat(e) }), d = n.map(e[1], function (e) { return parseFloat(e) }), p = { xmin: n.min(l), xmax: n.max(l), ymin: n.min(d), ymax: n.max(d), type: "table" }; if (isFinite(p.xmin) && isFinite(p.xmax) && isFinite(p.ymin) && isFinite(p.ymax) && (p.xmax > a.xmax || p.xmin < a.xmin || p.ymax > a.ymax || p.ymin < a.ymin)) { var c = T.getRecommendedViewportForExpression([p], r); if (c) { var h = new y.Viewport(c.xmin, c.xmax, c.ymin, c.ymax); this.grapher.viewportController.setViewport(h), this._showToast({ message: this.s("graphing-calculator-text-toast-zoom-to-fit"), undoCallback: function () { t.dispatch({ type: "undo" }) } }) } } } }, e.prototype._insertSeveralExpressions = function (e) { for (var t = 0; t < e.length; t++) { var i; i = this.createItemModel(e[t]), this._toplevelNewItemAtSelection(i, { shouldFocus: !0 }) } }, e.prototype._appendNumberList = function (e) { var t = this.getSelectedItem(); if (t && "expression" === t.type) { var i = t.latex, s = this.createItemModel({ type: "expression", id: this.generateId(), latex: i + e }); return this._toplevelReplaceItemAt(t.index, s, !0) } }, e.prototype._openOnWeb = function () { var e = this; this.runAfterDispatch(function () { if (e.grapher) { var t = JSON.stringify(e.getState()), i = e.grapher.screenshot({ width: 100, height: 100 }), s = (e.getGraphSettings().config.crossOriginSaveTest ? "/" : "https://www.desmos.com/") + "api/v1/calculator/cross_origin_save", o = U('<input type="text" name="calc_state" />').val(t), r = U('<input type="text" name="thumb_data" />').val(i), a = U('<form target="_blank" method="POST" style="display:none;"></form>').attr("action", s).append(U('<input type="text" name="is_open_on_web" value="true" />')).append(U('<input type="text" name="my_graphs" value="false" />')).append(U('<input type="text" name="is_update" value="false" />')).append(o).append(r); U(e.rootElt).append(a), a.trigger("submit").remove() } }) }, e.prototype.notifyBugsnagAboutMissingSelectedItem = function (e, t) { var i = F.getSelected(this.listModel), s = ""; try { s = i ? JSON.stringify(i.cachedUndoRedoFullState, null, 2) : "undefined" } catch (e) { s = "[[could not stringify]]" } var o = ""; try { if (i) { var r = { id: i.id, index: i.index, displayIndex: i.index, secretIndex: i.secretIndex, guid: i.guid, renderShell: i.renderShell, isHiddenFromUI: i.isHiddenFromUI, hasDCGView: !!i.dcgView, cachedRenderHeight: i.cachedRenderHeight }; o = JSON.stringify(r, null, 2) } else o = "undefined" } catch (e) { o = "[[could not stringify]]" } var a = ""; try { a = JSON.stringify(F.getUndoRedoFullState(this.listModel), null, 2) } catch (e) { a = "[[could not stringify]]" } N.notify("ReplaceItemAtError: no item at index", { metaData: { index: e, shouldFocus: t, selectedModelJSON: o, selectedItemJSON: s, listStateJSON: a } }) }, e.prototype._toplevelReplaceItemAt = function (e, t, i) { var s = t, o = this.getItemModelByIndex(e); o || this.notifyBugsnagAboutMissingSelectedItem(e, i); var r = "folder" !== o.type && o.folderId; F.removeItemAtIndex(this.listModel, e), F.insertItemAtIndex(this.listModel, s, e), r && D.setFolderId(s, r), i && C.moveFocusToItem(this, s.id) }, e.prototype.convertImageToDraggable = function (e) { var t = this.getItemModel(e); if (t && "image" === t.type) { var i = t.folderId, s = t.index + 1, o = t.center, r = F.findAvailableColumnSubscript(this.listModel), n = a.identifierToLatex("C_" + r), l = this.createItemModel({ id: this.generateId(), type: "expression", latex: n + "=" + o, dragMode: c.DragMode.XY, hidden: !0 }); F.insertItemAtIndex(this.listModel, l, s), i && D.setFolderId(l, i), w.setMQAttribute(t, "center", n), w.setDraggable(t, !0), w.setForeground(t, !0), this.listModel.openItemMenu = void 0 } }, e.prototype.createSlidersForItem = function (e, t) { var i = this.getItemModel(e); if (i) { var s = "folder" !== i.type && i.folderId; return this.createSliders({ model: i, folderId: s, index: i.index + 1 }, t) } }, e.prototype.createSlidersForTicker = function (e) { return this.createSliders({ model: this.listModel.ticker, folderId: !1, index: 0, doNotChangeFocus: !0 }, e) }, e.prototype.createSliders = function (e, t) { var i = this, s = e.model, o = e.folderId, r = e.index, n = e.doNotChangeFocus, l = []; "ticker" === s.type ? A.eachLatex(s, function (e, t) { l.push({ latex: e, location: t }) }) : F.eachLatexForItem(s, function (e, t) { l.push({ latex: e, location: t }) }); for (var d = x.computeDefaults(l, t, { degreeMode: this.graphSettings.degreeMode }), p = s.formula ? s.formula.action_value : void 0, c = t.map(function (e) { var t, s = d[e], o = "1"; s && void 0 !== s.value && (o = s.value), t = "" === e ? "" : p && p.hasOwnProperty(e) ? p[e] : a.identifierToLatex(e) + "=" + o; var r = { type: "expression", id: i.generateId(), latex: t, color: i.getNextColor(), hidden: !!t }; return s && (void 0 !== s.min && (r.slider || (r.slider = {}), r.slider.hardMin = !0, r.slider.min = s.min), void 0 !== s.max && (r.slider || (r.slider = {}), r.slider.hardMax = !0, r.slider.max = s.max), void 0 !== s.step && (r.slider || (r.slider = {}), r.slider.step = s.step)), r }), h = c.length - 1; h >= 0; h--) { var u = this.createItemModel(c[h]); F.insertItemAtIndex(this.listModel, u, r), o && D.setFolderId(u, o) } if (!n) { var g = c[c.length - 1]; "" === g.latex ? C.moveFocusToItem(this, g.id) : C.setFocusLocation(this, void 0) } }, e.prototype._uploadImagesAndWaitForThemToLoad = function (e) { var t = this, i = e.files, s = e.id; if (i && 0 !== i.length) if (s && i.length > 1) this._showToast({ message: this.s("graphing-calculator-text-toast-choose-one-file") }); else { var o = w.uploadImages({ controller: this, files: i, id: s }), r = o.errors[0]; r && this._showToast({ message: r }); for (var a = 0, n = o.tokens; a < n.length; a++) { var l = n[a]; this.__pendingImageUploads[l] = !0 } this.isUploadingImages() && this._showToast({ message: this.s("graphing-calculator-text-toast-uploading-images"), onHide: function () { t._clearPendingImageUploads() } }) } else this._showToast({ message: this.s("graphing-calculator-text-toast-no-file-selected") }) }, e.prototype.getImageToRetry = function () { for (var e, t = 0, i = this.getAllItemModels(); t < i.length; t++) { var s = i[t]; "image" === s.type && "failed" === s.loadStatus && (!e || e.failures > s.failures) && (e = s) } return e }, e.prototype.retryLoadingFailedImage = function (e) { var t = Date.now(), i = t - this.imageRetryState.lastAttemptTime, s = 1e3 * Math.pow(2, this.imageRetryState.attempts); this.imageRetryState.attempts > 0 && i < s || (w.retryLoading(e), this.imageRetryState = { lastAttemptTime: t, attempts: this.imageRetryState.attempts + 1 }) }, e.prototype.getSelectedItem = function () { return F.getSelected(this.listModel) }, e.prototype.getOpenItemMenu = function () { return this.listModel.openItemMenu }, e.prototype.isItemSettingsMenuOpen = function (e) { var t = this.listModel.openItemMenu; return !!t && t.guid === e }, e.prototype.closeItemSettingsMenu = function () { var e = this.getOpenItemMenu(); void 0 !== e && (e.focusFirstOption && (void 0 !== e.previousFocusLocation ? C.setFocusLocation(this, e.previousFocusLocation) : this.focusOpenMenuIcon()), this.listModel.openItemMenu = void 0) }, e.prototype.focusOpenMenuIcon = function () { var e = this.getOpenItemMenu(); e && ("slider" === e.type ? this.dispatch({ type: "set-focus-location", location: { type: "slider-animation-properties-icon", id: e.model.id } }) : "image" === e.type ? this.dispatch({ type: "set-focus-location", location: { type: "image-icon", id: e.model.id } }) : "table-column" === e.type ? this.dispatch({ type: "set-focus-location", location: { type: "table-icon", id: e.model.table.id, columnId: e.model.id } }) : this.dispatch({ type: "set-focus-location", location: { type: "expression-icon", id: e.model.id } })) }, e.prototype.getFocusedItem = function () { return C.getFocusedItem(this) }, e.prototype.getFocusLocation = function () { return this.focusLocation }, e.prototype.isFocusLocationFocused = function (e) { var t = this.focusLocation, i = e; return !(!t || !i) && n.isEqual(t, i) }, e.prototype.isCurrentFocusLocationValid = function () { var e = this.focusLocation; if (!e) return !0; if ("settings" === e.type) return "icon" === e.location || this.isGraphSettingsOpen(); if ("add-item-btn" === e.type || "edit-list-toggle" === e.type || "hide-expression-list-btn" === e.type || "show-expression-list-btn" === e.type) return this.isListEnabled(); if ("add-expression-btn" === e.type || "add-table-btn" === e.type) return this.layoutModel.addExpressionOpen; if ("add-note-btn" === e.type) return this.layoutModel.addExpressionOpen && this.areNotesEnabled(); if ("add-folder-btn" === e.type) return this.layoutModel.addExpressionOpen && this.areFoldersEnabled(); if ("add-ticker-btn" === e.type) return this.layoutModel.addExpressionOpen && this.areActionsEnabled(); if ("add-image-btn" === e.type) return this.layoutModel.addExpressionOpen && this.areImagesEnabled(); if ("search-expressions" === e.type || "replace-expressions" === e.type) return this.expressionSearchOpen; if ("ticker" === e.type) return this.listModel.ticker.open; if ("regression-output" === e.type) return "" !== e.parameter; var t = void 0, i = this.getOpenItemMenu(); if (!(t = i && "table-column" === i.type ? i.model.table : this.getItemModel(e.id))) return !1; if ("change-image-btn" === e.type) return this.listModel && "image" === t.type && this.areImagesEnabled(); if ("expression-menu" === e.type) { if ("start" === e.location || "end" === e.location || "updaterule" === e.location || "anywhere" === e.location) return !0; if ("table" === t.type) return !0; if ("expression" !== t.type) return !1; var s = t.points, o = t.lines, r = t.fill; k.isInequality(t) && (r = !0); var a = I.getReconciledExpressionProps(t.formula.expression_type, { points: s, lines: o, fill: r }); return !!(a.fill || a.points || a.lines || t.showLabel) } if (!this.isItemSelected(e.id) && "editable-label" !== e.type) return !1; switch (e.type) { case "domain-limit": return "expression" === t.type && !!k.hasDomain(t); case "expression-icon": return !0; case "image-icon": return "image" === t.type && "loading" !== t.loadStatus && "failed" !== t.loadStatus && !t.error; case "action-icon": return "expression" === t.type && !!k.isNonemptyAction(t); case "slider-icon": case "slider-animation-properties-icon": case "slider-thumb": case "slider-limit": return "expression" === t.type && !!k.hasSlider(t); case "table-icon": return "table" === t.type && this.getGraphSettings().config.graphpaper; case "visualization-prop": return "expression" === t.type && !!k.isVisualization(t); case "distribution-param": if ("expression" !== t.type) return !1; var n = k.parseToplevelFunction(t); return !!n && e.location in n.values; case "cdf-limit": return "expression" === t.type && k.shouldShowCDFFooter(t); case "image": return "image" === t.type; case "folder": return "folder" === t.type; case "text": return "text" === t.type; case "expression": return "expression" === t.type && !this.isInEditListMode(); case "readonly-expression": return "expression" === t.type && this.isInEditListMode(); case "braille-output": return "expression" === t.type && "none" !== this.getBrailleMode(); case "table": return "table" === t.type && !!_.doesCellExist(t, e.location); case "table-container": return "table" === t.type && this.isInEditListMode(); case "editable-label": return "expression" === t.type && k.hasEditableLabel(t); default: return e } }, e.prototype.isDragDropActive = function () { return !!this.listModel.dragState }, e.prototype.isItemBeingDragged = function (e) { var t = this.listModel.dragState; return !(!t || t.firstItemId !== e) }, e.prototype.getDraggedItemId = function () { var e = this.listModel.dragState; return e && e.firstItemId }, e.prototype.getRawDragState = function () { return this.listModel.dragState }, e.prototype.initStateStack = function () { this.stateStack = new f.default, this.stateStack.addState({ diffState: this.getUndoRedoDiffState(), fullState: this.getUndoRedoFullState() }) }, e.prototype.getUndoRedoDiffState = function () { return { randomSeed: this.getRandomSeed(), layoutModel: this.layoutModel, settingsViewModel: this.settingsViewModel, graph: this.grapher ? this.grapher.getUndoRedoState() : void 0, expressions: F.getUndoRedoDiffState(this.listModel), wasCompleteSetState: this.isCurrentlyDoingSetState } }, e.prototype.getUndoRedoFullState = function () { return { randomSeed: this.getRandomSeed(), layoutModel: this.layoutModel, settingsViewModel: this.settingsViewModel, graph: this.grapher ? this.grapher.getUndoRedoState() : void 0, expressions: F.getUndoRedoFullState(this.listModel), wasCompleteSetState: this.isCurrentlyDoingSetState } }, e.prototype.getState = function (e) { var t = { stripDefaults: !0 }; e && e.hasOwnProperty("stripDefaults") && (t.stripDefaults = !!e.stripDefaults); var s = this.grapher ? this.grapher.getState(t) : i.__assign(i.__assign({}, this.getBlankState().graph), { degreeMode: this.graphSettings.degreeMode }), o = { version: b.currentVersion, randomSeed: this.getRandomSeed(), graph: s, expressions: F.getState(this.listModel, t) }; return e && e.avoidBackMigration ? g.default(o) : b.migrateToPersisted(g.default(o)) }, e.prototype.getBlankState = function () { return this.graphSettings.config.clearIntoDegreeMode ? i.__assign(i.__assign({}, H.default), { graph: i.__assign(i.__assign({}, H.default.graph), { degreeMode: !0 }) }) : H.default }, e.prototype.externalSetState = function (e, t) { this._clearPendingImageUploads(), this.rootElt && U(document.activeElement).closest(this.rootElt).length && U(document.activeElement).trigger("blur"), t || (t = {}), e || (e = this.getBlankState()), "string" == typeof e && (e = JSON.parse(e)), e && (e = b.migrateToLatest(e)); var s = this.layoutModel; this.setState(e, t), F.clearAnyItemIsAction(this.listModel), F.recomputeAnyItemIsAction(this.listModel), this.layoutModel = i.__assign(i.__assign({}, V.defaultLayoutModel(this.graphSettings.config)), { keypadMinimized: s.keypadMinimized, keypadLayout: s.keypadLayout, keypadFunctionsOpen: s.keypadFunctionsOpen, expressionsVisible: !!this.graphSettings.config.expressions && (this.isListVisible() || !!t.forceExpressionsOpen) }), this.settingsViewModel = R.defaultSettingsViewModel(), C.setFocusLocation(this, void 0), t.forceUnsavedChanges ? this.enqueueEvent("change") : this.enqueueEvent("clearUnsavedChanges") }, e.prototype.setState = function (e, t) { if (this.isCurrentlyDoingSetState = !0, "graph" in e && (this.grapher ? this.grapher.setGrapherState(e.graph) : o.Grapher.copyGraphProperties(e.graph, this.graphSettings)), "expressions" in e) { F.setSelected(this.listModel, void 0); var i = F.getLargestIntegerId(e.expressions); i >= this.__nextItemId && (this.__nextItemId = i + 1), F.setListState(this.listModel, e.expressions, t || {}) } e.layoutModel && (this.layoutModel = e.layoutModel), e.settingsViewModel && (this.settingsViewModel = e.settingsViewModel), t && t.allowUndo || this.clearUndoRedoHistory(), this.setRandomSeed(e.randomSeed || W.default()) }, e.prototype.updateToState = function (e) { this.isCurrentlyDoingRestoreState = !0, "graph" in e && this.grapher && this.grapher.setGrapherState(e.graph, { doNotClear: !0 }), "expressions" in e && F.restoreListState(this.listModel, e.expressions), e.layoutModel && (this.layoutModel = e.layoutModel), e.settingsViewModel && (this.settingsViewModel = e.settingsViewModel) }, e.prototype.commitUndoRedoSynchronously = function (e) { var t = this.stateStack.getState(), i = t && t.diffState, s = this.getUndoRedoDiffState(); if (o = i, r = s, !n.isEqual(X(o), X(r))) { var o, r, a = { diffState: s, fullState: this.getUndoRedoFullState() }; !function (e) { var t; switch (e.type) { case "tick": case "tick-ticker": return !1; case "on-evaluator-changes": return !!(null === (t = e.eventUpdates) || void 0 === t ? void 0 : t.userAction); default: return !0 } }(e) ? this.stateStack.replaceInteriorState(a) : (this.stateStack.addState(a), this.enqueueEvent("change")) } }, e.prototype.undo = function () { if (this.canUndo()) { this.closeToast(), this.stateStack.undo(); var e = this.stateStack.getState().fullState; e.wasCompleteSetState ? this.setState(e, { allowUndo: !0 }) : this.updateToState(e), this.enqueueEvent("change") } }, e.prototype.redo = function () { if (this.canRedo()) { this.stateStack.redo(); var e = this.stateStack.getState().fullState; e.wasCompleteSetState ? this.setState(e, { allowUndo: !0 }) : this.updateToState(e), this.enqueueEvent("change") } }, e.prototype.clearUndoRedoHistory = function () { this.stateStack.clear() }, e.prototype.canUndo = function () { return this.stateStack.canUndo() }, e.prototype.canRedo = function () { return this.stateStack.canRedo() }, e.prototype.closeToast = function () { var e = this.toastData.onHide; e && this.runAfterDispatch(e), this.toastData = {} }, e.prototype._closeAddExpression = function () { this.layoutModel = i.__assign(i.__assign({}, this.layoutModel), { addExpressionOpen: !1 }) }, e.prototype.doesDOMHaveSize = function () { return this.layoutMeasurements.width > 0 && this.layoutMeasurements.height > 0 }, e.prototype._getExpListWidth = function () { var e; if (void 0 !== this.userSpecifiedExpListWidth) e = Math.max(280, Math.min(this.layoutMeasurements.width - 200, this.userSpecifiedExpListWidth)); else { if (!(e = this.layoutMeasurements.width)) return 356; var t = .2 * e + 160; e = Math.min(500, Math.max(280, t)) } var i = this.layoutMeasurements.width - this.layoutMeasurements.height; return Math.abs(i - e) <= 10 ? i : e }, e.prototype._setExpListWidth = function (e) { this.userSpecifiedExpListWidth !== e && (this.userSpecifiedExpListWidth = e) }, e.prototype.getKeypadHeight = function () { return this.computeMajorLayout().keypad.height }, e.prototype.isKeypadEnabled = function () { return !!this.graphSettings.config.keypad }, e.prototype.isKeypadOpen = function () { if (!this.isKeypadEnabled()) return !1; var e = this.layoutModel.keypadMinimized && !this.isNarrow(); return this.needsFakeKeypad() && !e }, e.prototype.isKeypadFunctionsPopoverOpen = function () { return !!this.layoutModel.keypadFunctionsOpen }, e.prototype.getKeypadLayout = function () { return this.layoutModel.keypadLayout }, e.prototype.isLetterKeypadOpen = function () { var e = this.getKeypadLayout(); return this.isKeypadOpen() && ("letters" === e || "noQwertyLetters" === e || "capitalLetters" === e || "noQwertyCapitalLetters" === e) }, e.prototype.isFileDraggedOver = function () { return this.layoutModel.isFileDraggedOver }, e.prototype.computeMajorLayout = function () { var e = this.layoutMeasurements.width, t = this.layoutMeasurements.height, i = this.isNarrow(), s = this.isListVisible(), o = this.isKeypadOpen(), r = !this.isGrapherEnabled(), a = !this.isListEnabled(), n = { left: 0, top: 0, width: 0, height: 0 }, l = { left: 0, top: 0, width: 0, height: 0 }, d = { left: 0, top: t, width: e, height: !!this.getGraphSettings().config.projectorMode ? i ? 185 : 193 : 169 }; return a ? (l.width = e, l.height = t) : r ? (n.width = e, n.height = t) : s ? i ? (n.width = e, n.height = Math.round(.58 * t), n.top = t - n.height, l.width = e, l.height = t - n.height) : (n.width = this.getExpListWidth(), n.height = t, l.left = n.width, l.width = e - l.left, l.height = t) : s || (i ? (n.width = e, n.height = Math.round(.58 * t), n.top = t, l.width = e, l.height = t) : (n.width = this.getExpListWidth(), n.height = t, n.left = -n.width, l.width = e, l.height = t)), o && (d.top -= d.height, a || (n.height -= d.height)), { list: n, grapher: l, keypad: d } }, e.prototype.isNarrow = function () { return this.layoutMeasurements.width < 450 }, e.prototype.getLayoutMeasurements = function () { return this.layoutMeasurements }, e.prototype.getCapExpressionSize = function () { return !!this.getGraphSettings().config.capExpressionSize }, e.prototype.handleAudioTraceCommand = function (e) { var t = this.getAudioGraph(); if (void 0 !== t) { var i = t.agNavigator; switch (e) { case "on": this.runAfterDispatch(function () { t.enterAudioTrace({ fromKeypad: !0 }) }); break; case "off": this.runAfterDispatch(function () { t.exitAudioTrace() }); break; case "hear-graph": t.hearGraph(); break; case "stop-graph": this.runAfterDispatch(function () { t.stopGraph() }); break; case "volume-down": t.adjustVolume("down"); break; case "volume-up": t.adjustVolume("up"); break; case "speed-down": t.speedDown(); break; case "speed-up": t.speedUp(); break; case "previous-point": this.runAfterDispatch(function () { t.reportAndMoveToPrevPoint() }); break; case "next-point": this.runAfterDispatch(function () { t.reportAndMoveToNextPoint() }); break; case "previous-poi": this.runAfterDispatch(function () { t.reportAndMoveToPrevPOI() }); break; case "next-poi": this.runAfterDispatch(function () { t.reportAndMoveToNextPOI() }); break; case "previous-curve": this.runAfterDispatch(function () { i.prevCurve() }); break; case "next-curve": this.runAfterDispatch(function () { i.nextCurve() }); break; case "describe-point": t.describePoint(); break; case "describe-curve": t.describeCurve(); break; case "keyboard-shortcuts": this.enqueueEvent("showHotkeysModal"); break; default: return e } } }, e.prototype.setAudioTraceSpeed = function (e) { var t = this.getAudioGraph(); t && t.adjustPlaybackSpeed(e) }, e.prototype.focusGraphPaper = function () { this.find$(".dcg-graph-outer").trigger("focus") }, e.prototype.setCanShowKeyboardShortcuts = function (e) { this.canShowKeyboardShortcuts = e }, e.prototype.getCanShowKeyboardShortcuts = function () { return this.canShowKeyboardShortcuts }, e }(); function X(e) { return e ? i.__assign(i.__assign({}, e), { wasCompleteSetState: void 0, layoutModel: void 0, settingsViewModel: void 0 }) : e } e.default = J });
define('main/instancehotkeys', ["require", "exports", "keys", "lib/aria", "jquery", "graphing-calc/models/expression", "browser", "touchtracking", "dcgview-helpers/mathquill-view"], function (require, e, t, r, o, l, i, s, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var n = function () { function e(e) { this.controller = e } return e.prototype.handleKeydown = function (e) { var n = this, c = t.lookupChar(e); if (t.isUndo(e)) e.stopPropagation(), e.preventDefault(), this.controller.hasVisibleAndUndoableToast() ? this.controller.toastUndo() : this.controller.dispatch({ type: "undo" }); else if (t.isRedo(e)) e.stopPropagation(), e.preventDefault(), this.controller.dispatch({ type: "redo" }); else if (!e.ctrlKey && !e.metaKey || e.ctrlKey && e.metaKey || e.altKey || "F" !== c) if (!e.altKey && !e.metaKey || e.ctrlKey || e.shiftKey || void 0 !== c) if (e.shiftKey && (e.altKey || e.metaKey) && !e.ctrlKey) { if (t.lookup(e) === t.UP) e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-all-folders-collapsed", isCollapsed: !0 }), r.alert(this.controller.s("graphing-calculator-narration-all-folders-collapsed")); else if (t.lookup(e) === t.DOWN) e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-all-folders-collapsed", isCollapsed: !1 }), r.alert(this.controller.s("graphing-calculator-narration-all-folders-expanded")); else if ("E" === c) { if (!this.controller.isListEnabled()) return; this.controller.isListVisible() ? (this.controller.dispatch({ type: "hide-expressions-list", focusShowIcon: !1 }), r.alert(this.controller.s("graphing-calculator-narration-hide-expression-list"))) : (this.controller.dispatch({ type: "show-expressions-list", focusHideIcon: !1 }), this.focusExpressionList(this.controller.s("graphing-calculator-narration-show-expression-list"))), e.preventDefault(), e.stopPropagation() } } else if (e.ctrlKey && (e.altKey || e.metaKey) && !e.shiftKey) { if ("E" === c) { if (!this.controller.isListEnabled()) return; e.preventDefault(), e.stopPropagation(), this.focusExpressionList(this.controller.s("graphing-calculator-narration-expression-list")) } else if ("X" === c) { if (!this.controller.isListEnabled()) return; e.preventDefault(), e.stopPropagation(), this.controller.canUserAddExpressions() ? (r.alert(this.controller.s("graphing-calculator-narration-add-expression")), this.controller.dispatch({ type: "new-expression" })) : r.alert(this.controller.s("graphing-calculator-narration-unable-to-add-expression")) } else if ("O" === c) { if (!this.controller.isListEnabled()) return; e.preventDefault(), e.stopPropagation(), this.controller.canUserAddExpressions() && this.controller.areNotesEnabled() ? (r.alert(this.controller.s("graphing-calculator-narration-add-note")), this.controller.dispatch({ type: "new-text" })) : r.alert(this.controller.s("graphing-calculator-narration-unable-to-add-note")) } else if ("F" === c && this.controller.canUserAddExpressions() && this.controller.areFoldersEnabled()) e.preventDefault(), e.stopPropagation(), r.alert(this.controller.s("graphing-calculator-narration-add-folder")), this.controller.dispatch({ type: "new-folder" }); else if ("I" === c && this.controller.canUserAddExpressions() && this.controller.areImagesEnabled()) e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "toggle-add-expression", focusOnOpen: !1 }), this.controller.runAfterDispatch(function () { n.controller.find$(".dcg-add-expression-container input[type=file]").trigger("click"), r.alert(n.controller.s("graphing-calculator-narration-add-image")) }); else if ("T" === c) e.preventDefault(), e.stopPropagation(), this.controller.canUserAddExpressions() ? (r.alert(this.controller.s("graphing-calculator-narration-add-table")), this.controller.dispatch({ type: "new-table" })) : r.alert(this.controller.s("graphing-calculator-narration-unable-to-add-table")); else if ("G" === c) e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "toggle-graph-settings", focusOnOpen: !0 }); else if ("P" === c) { e.preventDefault(), e.stopPropagation(); var p = this.controller.find$(".dcg-tabbable-point, .dcg-tabbable-draggableimage").filter("[tabindex=0]"); 0 === p.length && (p = this.controller.find$(".dcg-editable-label-border").find('input, textarea, [role="textbox"]')), this.focusElement(p.first(), this.controller.s("graphing-calculator-narration-no-interactive-points")) } else if ("Z" === c) { (u = this.controller.getSelectedItem()) && u.id && this.controller.dispatch({ type: "expression-zoom-fit", id: u.id }) } else if ("D" === c && this.controller.canUserAddExpressions()) { e.preventDefault(), e.stopPropagation(); var d = !this.controller.isInEditListMode(); this.controller.dispatch({ type: "set-edit-list-mode", isEditListMode: d, focusExpressionList: !0 }) } } else if ((e.altKey || e.metaKey) && !e.ctrlKey && e.shiftKey && "F" === c && this.controller.isDecimalToFractionEnabled()) { var h = this.controller.getSelectedItem(); h && "expression" === h.type && (e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "toggle-fraction-evaluation", id: h.id }), this.controller.runAfterDispatch(function () { l.shouldEvaluationDisplayAsFraction(h) ? r.alert(n.controller.s("graphing-calculator-narration-show-as-fraction")) : r.alert(n.controller.s("graphing-calculator-narration-show-as-decimal")) })) } else if (e.altKey || e.ctrlKey || e.metaKey || e.shiftKey) { if (!e.metaKey && !e.shiftKey && e.ctrlKey === i.IS_APPLE && e.altKey === !i.IS_APPLE) if ("N" === c) { if (!this.controller.getBrailleControls()) return; e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-braille-mode", mode: "nemeth" }), r.alert(this.controller.s("shared-calculator-narration-braille-mode-nemeth")) } else if ("U" === c) { if (!this.controller.getBrailleControls()) return; e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-braille-mode", mode: "ueb" }), r.alert(this.controller.s("shared-calculator-narration-braille-mode-ueb")) } else if ("Q" === c || "X" === c) { if (!this.controller.getBrailleControls()) return; e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-braille-mode", mode: "none" }), r.alert(this.controller.s("shared-calculator-narration-braille-mode-off")) } else if ("6" === c) { if (!this.controller.getBrailleControls()) return; e.preventDefault(), e.stopPropagation(); var f = !this.controller.getSixKeyInput(); this.controller.dispatch({ type: "set-six-key-input", useSixKeyInput: f }), r.alert(f ? this.controller.s("shared-calculator-narration-six-key-mode-on") : this.controller.s("shared-calculator-narration-six-key-mode-off")) } } else t.lookup(e) === t.BACKSPACE ? document.activeElement && s.elIsFocusable(o(document.activeElement)) || e.preventDefault() : t.lookup(e) === t.ESCAPE && this.controller.isInEditListMode() && 0 === this.controller.find$(".dcg-options-menu").length && (e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-edit-list-mode", isEditListMode: !1, focusExpressionList: !0 })); else { if (t.lookup(e) === t.UP) (u = this.controller.getSelectedItem()) && "folder" === u.type && (e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-folder-collapsed", id: u.id, isCollapsed: !0 }), r.alert(this.controller.s("graphing-calculator-narration-folder-collapsed"))); else if (t.lookup(e) === t.DOWN) { var u; (u = this.controller.getSelectedItem()) && "folder" === u.type && (e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-folder-collapsed", id: u.id, isCollapsed: !1 }), r.alert(this.controller.s("graphing-calculator-narration-folder-expanded"))) } } else if (this.controller.isExpressionListFocused()) { var g = a.default.getFocusedMathquill(), y = ""; try { y = g.__controller.cursor.selection.join("latex") || "" } catch (e) { } this.controller.dispatch({ type: "open-expression-search", rename: !!e.shiftKey, latex: y }), e.preventDefault(), e.stopPropagation() } }, e.prototype.focusExpressionList = function (e) { var t = this.controller.getSelectedItem(); t || (t = this.controller.getItemModelByIndex(0)), t ? (r.alert(e), this.controller.dispatch({ type: "move-focus-to-item", id: t.id })) : r.alert(this.controller.s("graphing-calculator-narration-unable-to-focus-expression-list")) }, e.prototype.focusElement = function (e, t) { e.length ? e.trigger("focus") : t && r.alert(t) }, e }(); e.default = n });
define('lib/defocus-mobile', ["require", "exports", "jquery", "touchtracking"], function (require, e, t, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function () { if (document.activeElement) { var e = t(document.activeElement); r.elIsFocusable(e) && t("<input />").prependTo("body").trigger("focus").attr({ readonly: "readonly", disabled: "true" }).trigger("blur").remove() } } });
define('ipad.scrollfix', ['require', 'jquery'], function (require) { var o = require("jquery"), n = !1, e = function (e) { n || o(e).bind("touchstart", function (n) { var e = o(n.target), l = 0, r = null; if (!e.closest("[disablescroll]").length) for (; 0 === l && e.length && void 0 !== e[0].tagName;) { var t = e.css("overflow"), c = e.css("overflow-y"); if ("hidden" !== t && "visible" !== t && "hidden" !== c && "hidden" !== c) { var i = e.scrollTop(); 0 !== i && (l = 2), e.scrollTop(i + 1), e.scrollTop() !== i && (l |= 1, e.scrollTop(i)) } e = e.parent() } if (0 !== l) { r = []; for (var s = n.originalEvent.touches, f = 0; f < s.length; f++) { var u = {}; for (var a in s[f]) s[f].hasOwnProperty(a) && (u[a] = s[f][a]); r.push(u) } } o(document).on("touchmove.scrollfix", function (o) { if (r) { var n = r[0], e = o.originalEvent.touches[0].screenY - n.screenY; (e > 0 && !(2 & l) || e < 0 && !(1 & l)) && (l = 0), e && (r = null) } 0 === l && o.preventDefault() }), o(document).on("touchend.scrollfix", function () { o(document).off(".scrollfix") }) }) }; return { limitScrollOnElement: e, limitScrollOnDocument: function () { e(document), n = !0 } } });
define('expressions/abstract-item-view', ["require", "exports", "tslib", "jquery", "dcgview", "jquery.handleevent"], function (require, t, e, i, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, this._isFirstRender = !0, this._isDragCopy = this.props.isDragCopy() }, o.prototype.onItemViewMounted = function () { this._isDragCopy || (this.model.dcgView = this), this._isFirstRender = !1 }, o.prototype.onItemViewUnmounted = function () { this._isDragCopy || (this.model.dcgView = void 0) }, o.prototype.isFirstRender = function () { return this._isFirstRender }, o.prototype.onMouseSelect = function (t) { !this.controller.isInEditListMode() || function (t) { var e = i(t.target); return e.hasClass("dcg-exp-action-button") || e.hasClass("dcg-icon-duplicate") || e.hasClass("dcg-icon-remove") }(t) ? "dcg-tap" === t.type && "mouse" === t.device || "dcg-tapstart" === t.type && "touch" === t.device || t.wasHandled() || (t.handle(), this.controller.dispatch({ type: "set-selected-id", id: this.id })) : this.exitEditListMode() }, o.prototype.onDelete = function () { this.controller.dispatch({ type: "delete-item-and-animate-out", id: this.id, setFocusAfterDelete: !this.controller.isInEditListMode() }) }, o.prototype.onRenameInItem = function () { this.controller.dispatch({ type: "rename-identifier-in-item", search: this.controller.getExpressionSearchStr(), replace: this.controller.getExpressionReplaceStr(), id: this.id }) }, o.prototype.onRenameInFolder = function () { this.controller.dispatch({ type: "rename-identifier-in-folder", search: this.controller.getExpressionSearchStr(), replace: this.controller.getExpressionReplaceStr(), id: this.id }) }, o.prototype.onDragPending = function (t) { this.props.onDragPending(t) }, o.prototype.exitEditListMode = function () { this.controller.dispatch({ type: "set-edit-list-mode", isEditListMode: !1, focusExpressionList: !0 }) }, o }(o.Class); t.default = s });

define('loadcss!dcgview-helpers/tooltipped-error', function () { });
define('dcgview-helpers/tooltipped-error', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip", "loadcss!./tooltipped-error"], function (require, t, e, r, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.TooltippedError = void 0; var i = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return e.__extends(i, t), i.prototype.template = function () { var t = this; return r.createElement(o.Tooltip, { tooltip: this.props.error, sticky: this.const(!0), gravity: this.props.gravity }, r.createElement("div", { class: function () { return { "dcg-tooltipped-error": !0, "dcg-white": t.props.isWhite && t.props.isWhite(), "dcg-small": t.props.size && "small" === t.props.size() } } }, r.createElement("i", { class: r.const("dcg-icon-error"), "aria-hidden": r.const("true") }))) }, i }(r.Class); t.TooltippedError = i });

define('loadcss!expressions/circular-icon-view', function () { });
define('expressions/circular-icon-view', ["require", "exports", "tslib", "dcgview", "expressions/colors", "loadcss!./circular-icon-view"], function (require, e, o, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.CircularIconView = void 0; var i = n.Components.If, c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return o.__extends(c, e), c.prototype.template = function () { var e = this; return n.createElement("span", { class: function () { var o; return (o = { "dcg-do-not-blur": !0, "dcg-circular-icon": !0, "dcg-thick-outline": e.isThickOutline(), "dcg-white-icon": !!e.props.whiteIcon && e.props.whiteIcon(), "dcg-hidden": e.isHidden(), "dcg-semi-transparent": e.props.semiTransparent && e.props.semiTransparent(), "dcg-colored-icon": e.isColoredIcon(), "dcg-has-background-image": e.hasBackgroundImage() })[e.iconModifier()] = e.iconModifier().length > 0, o }, style: this.bindFn(this.getIconStyle) }, n.createElement(i, { predicate: this.bindFn(this.hasBackgroundImage) }, function () { return n.createElement("span", { class: n.const("dcg-background-image"), style: function () { return { "background-image": e.props.backgroundImage && e.props.backgroundImage(), opacity: e.props.backgroundOpacity && e.props.backgroundOpacity() } } }) }), n.createElement(i, { predicate: function () { return !!e.backgroundIcon() } }, function () { return n.createElement("i", { class: function () { var o; return (o = {})[e.backgroundIcon()] = !0, o["dcg-layered-icon"] = !0, o }, style: function () { return { opacity: e.backgroundOpacity() } } }) }), n.createElement(i, { predicate: function () { return !!e.primaryIcon() } }, function () { return n.createElement("i", { class: function () { var o; return (o = {})[e.primaryIcon()] = !0, o["dcg-layered-icon"] = !0, o }, style: function () { return { color: e.props.foregroundColor && e.props.foregroundColor() } } }) }), n.createElement(i, { predicate: function () { return "loading" === e.props.iconType() } }, function () { return n.createElement("span", { class: n.const("dcg-spinner") }) })) }, c.prototype.isColoredIcon = function () { return !this.isThickOutline() && !this.isHidden() && !this.hasBackgroundImage() && "loading" !== this.props.iconType() }, c.prototype.iconModifier = function () { if (!this.props.iconModifier) return ""; switch (this.props.iconModifier()) { case "medium": return "dcg-modifier-size-medium"; case "large": return "dcg-modifier-size-large"; case "small": return "dcg-modifier-size-small"; case "rotated": return "dcg-modifier-rotated"; case "none": return "" } }, c.prototype.getIconStyle = function () { var e = !this.isHidden() && this.props.backgroundColor ? r.colorValueToBackgroundValue(this.props.backgroundColor()) : void 0; return e ? { background: e } : {} }, c.prototype.isHidden = function () { return "hidden" === this.props.iconType() }, c.prototype.isThickOutline = function () { var e = this.props.iconType(); return "folder" === e || "pause" === e || "play" === e || "fraction" === e || "action" === e || "metronome" === e }, c.prototype.hasBackgroundImage = function () { return !!this.props.backgroundImage && !this.isHidden() && !!this.props.backgroundImage() }, c.prototype.primaryIcon = function () { var e = this.props.iconType(); switch (e) { case "folder": return "dcg-icon-folder"; case "pause": return "dcg-icon-pause"; case "play": return "dcg-icon-play"; case "polygon-dashed": case "polygon-dashed-filled": return "dcg-icon-polygon-dashed"; case "polygon-dotted": case "polygon-dotted-filled": return "dcg-icon-polygon-dotted"; case "polygon-default": case "polygon-default-filled": return "dcg-icon-polygon-solid"; case "graph-dashed": case "parametric-dashed-filled": return "dcg-icon-parametric-dashed"; case "graph-dotted": case "parametric-dotted-filled": return "dcg-icon-parametric-dotted"; case "graph-default": case "parametric-default-filled": return "dcg-icon-parametric-solid"; case "movable-vertical": return "dcg-icon-move-vertical"; case "movable-both": return "dcg-icon-move"; case "movable-horizontal": return "dcg-icon-move-horizontal"; case "point-open": return "dcg-icon-open"; case "point-cross": return "dcg-icon-cross"; case "point-default": return "dcg-icon-point"; case "table-points": case "table-points-and-lines": return "dcg-icon-points"; case "table-lines": return "dcg-icon-lines-solid"; case "shaded-inequality": case "inequality": return "dcg-icon-shaded-inequality-dash"; case "check": return "dcg-icon-check"; case "none": case "background": case "hidden": case "polygon-none-filled": case "parametric-none-filled": case "loading": return ""; case "fraction": return "dcg-icon-fraction"; case "boxplot": return "dcg-icon-boxplot"; case "dotplot-cross": return "dcg-icon-dotplot-cross"; case "dotplot-default": return "dcg-icon-dotplot-default"; case "dotplot-open": return "dcg-icon-dotplot-open"; case "histogram": return "dcg-icon-histogram"; case "unfilled-distribution": case "filled-distribution": return "dcg-icon-distribution"; case "action": return "dcg-icon-chevron-right"; case "metronome": return "dcg-icon-metronome-2"; default: return e } }, c.prototype.backgroundOpacity = function () { var e = this.backgroundIcon(); return "dcg-icon-polygon-filled" === e || "dcg-icon-parametric-filled" === e || "dcg-icon-shaded-inequality-shade2" === e || "dcg-icon-distribution-fill" === e || "dcg-icon-histogram-fill" === e ? .5 : 1 }, c.prototype.backgroundIcon = function () { var e = this.props.iconType(); return "filled-distribution" === e ? "dcg-icon-distribution-fill" : "histogram" === e ? "dcg-icon-histogram-fill" : "polygon-dashed-filled" === e || "polygon-dotted-filled" === e || "polygon-default-filled" === e || "polygon-none-filled" === e ? "dcg-icon-polygon-filled" : "parametric-dashed-filled" === e || "parametric-dotted-filled" === e || "parametric-default-filled" === e || "parametric-none-filled" === e ? "dcg-icon-parametric-filled" : "table-points-and-lines" === e ? "dcg-icon-lines-solid" : "shaded-inequality" === e ? "dcg-icon-shaded-inequality-shade2" : "action" === e ? "dcg-icon-minus" : "" }, c }(n.Class); e.CircularIconView = c });
define('main/manage-focus-helper', ["require", "exports", "underscore"], function (require, e, o) { "use strict"; function n(e) { var n = e.predicate; if (n && !n()) return !1; var t = e.controller.getFocusLocation(); return t && o.isEqual(t, e.location) } function t(e, o) { var n = e.predicate; n && !n() || (o ? e.controller.dispatch({ type: "set-focus-location", location: e.location }) : e.controller.dispatch({ type: "blur-focus-location", location: e.location })) } Object.defineProperty(e, "__esModule", { value: !0 }), e.defaultOnFocusChanged = e.defaultShouldBeFocused = e.manageFocusHelper = void 0, e.manageFocusHelper = function (e) { return { shouldBeFocused: function () { return n(e) }, onFocusedChanged: function (o) { t(e, o) } } }, e.defaultShouldBeFocused = n, e.defaultOnFocusChanged = t });

define('loadcss!expressions/play-pause-icon-view', function () { });
define('expressions/play-pause-icon-view', ["require", "exports", "tslib", "dcgview", "lib/aria", "./circular-icon-view", "main/manage-focus-helper", "graphing-calc/models/expression", "core/types/slider-loop-modes", "../shared-components/tooltip", "jquery.handleevent", "loadcss!./play-pause-icon-view"], function (require, e, t, i, n, o, r, l, a, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.PlayPauseIconView = void 0; var c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model() }, c.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-play-pause-icon-view") }, i.createElement(s.Tooltip, { gravity: this.const("se"), tooltip: function () { return e.controller.s("graphing-calculator-label-slider-disabled-while-ticker-playing") }, disabled: function () { return !e.controller.getTickerPlaying() }, sticky: this.const(!0) }, i.createElement("div", { class: function () { return { "dcg-circular-icon-container": !0, "dcg-disabled": e.controller.getTickerPlaying() } }, "aria-label": this.bindFn(this.getAriaLabel), role: i.const("button"), tabindex: i.const("0"), onTap: function (t) { t.wasHandled("dragdrop") || e.toggleSliderIsPlaying() }, manageFocus: this.const(r.manageFocusHelper({ controller: this.controller, location: { type: "slider-icon", id: this.model.id } })) }, i.createElement(o.CircularIconView, { iconType: function () { return e.getIconType() }, whiteIcon: function () { return !e.controller.isInEditListMode() && e.controller.isItemSelected(e.model.id) || e.controller.isItemBeingDragged(e.model.id) } }))), i.createElement("div", { class: i.const("dcg-slider-menu-container") }, i.createElement(s.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-animation-properties-tooltip") }, gravity: this.const("e") }, i.createElement("div", { class: function () { return { "dcg-slider-menu-opener": !0, "dcg-menu-open": e.myOptionsOpen() } }, tabindex: i.const(0), "dcg-open-menu-guid": function () { return e.getMenuGUID() }, role: i.const("button"), "aria-label": function () { return e.myOptionsOpen() ? e.controller.s("graphing-calculator-narration-hide-animation-properties") : e.controller.s("graphing-calculator-narration-show-animation-properties") }, onTap: function (t) { t.wasHandled("dragdrop") || t.wasLongheld() || e.toggleOptions(t) }, manageFocus: this.const(r.manageFocusHelper({ controller: this.controller, location: { type: "slider-animation-properties-icon", id: this.model.id } })) }, i.createElement("i", { class: this.bindFn(this.getIcon), "aria-hidden": i.const("true") }))))) }, c.prototype.getIcon = function () { return a.getSliderIcon(this.model.slider.loopMode) }, c.prototype.getIconType = function () { return this.model.slider.isPlaying ? l.isSliderAtEndOfPlayOnce(this.model) ? "play" : "pause" : "play" }, c.prototype.getMenuGUID = function () { return "slider-" + this.model.guid }, c.prototype.myOptionsOpen = function () { return this.controller.isItemSettingsMenuOpen(this.getMenuGUID()) }, c.prototype.toggleOptions = function (e) { this.controller.dispatch({ type: "toggle-item-settings-menu", menu: { type: "slider", model: this.model, guid: this.getMenuGUID(), focusFirstOption: "keyboard" === e.device } }) }, c.prototype.getAriaLabel = function () { if (!this.model.sliderExists) return ""; var e = l.getAssignment(this.model); return e ? this.model.slider.isPlaying ? this.controller.s("graphing-calculator-narration-pause-variable-animation", { variable: e }) : this.controller.s("graphing-calculator-narration-play-variable-animation", { variable: e }) : "" }, c.prototype.toggleSliderIsPlaying = function () { if (this.model.sliderExists) { var e = "", t = l.getAssignment(this.model); l.isSliderAtEndOfPlayOnce(this.model) ? ("string" == typeof t && (e = this.controller.s("graphing-calculator-narration-slider-variable-restarted", { variable: t })), this.controller.dispatch({ type: "play-slider-from-min", id: this.model.id })) : this.model.slider.isPlaying ? ("string" == typeof t && (e = this.controller.s("graphing-calculator-narration-slider-variable-playing", { variable: t })), this.controller.dispatch({ type: "set-slider-isplaying", id: this.model.id, isPlaying: !1 })) : ("string" == typeof t && (e = this.controller.s("graphing-calculator-narration-slider-variable-paused", { variable: t })), this.controller.dispatch({ type: "set-slider-isplaying", id: this.model.id, isPlaying: !0 })), "" !== e && n.alert(e) } }, c }(i.Class); e.PlayPauseIconView = c });

define('loadcss!expressions/action-icon-view', function () { });
define('expressions/action-icon-view', ["require", "exports", "tslib", "dcgview", "./circular-icon-view", "main/manage-focus-helper", "jquery.handleevent", "loadcss!./action-icon-view"], function (require, n, t, i, e, o) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.ActionIconView = void 0; var c = function (n) { function c() { var t = null !== n && n.apply(this, arguments) || this; return t.isAnimating = !1, t.unmounted = !1, t } return t.__extends(c, n), c.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model() }, c.prototype.template = function () { var n = this; return i.createElement("div", { class: function () { return { "dcg-action-icon-view": !0, "dcg-action-icon-view-animating": n.isAnimating } } }, i.createElement("div", { class: i.const("dcg-circular-icon-container"), "aria-label": function () { return n.controller.s("graphing-calculator-narration-run-action-icon") }, role: i.const("button"), tabindex: i.const("0"), onTap: function (t) { t.wasHandled("dragdrop") || n.runActionOnce() }, manageFocus: this.const(o.manageFocusHelper({ controller: this.props.controller(), location: { type: "action-icon", id: this.model.id } })) }, i.createElement(e.CircularIconView, { iconType: this.const("action"), whiteIcon: function () { return !n.controller.isInEditListMode() && n.controller.isItemSelected(n.model.id) || n.controller.isItemBeingDragged(n.model.id) } }))) }, c.prototype.willUnmount = function () { this.unmounted = !0 }, c.prototype.runActionOnce = function () { var n = this; this.isAnimating = !0, this.controller.dispatch({ type: "action-single-step", id: this.model.id }), setTimeout(function () { n.isAnimating = !1, n.unmounted || n.update() }, 150) }, c }(i.Class); n.ActionIconView = c });
define('expressions/expression-icon-view', ["require", "exports", "tslib", "dcgview", "core/lib/dragmode", "core/types/styles", "core/math/comparators", "graphing-calc/models/abstract-item", "core/math/expression-types", "graphing-calc/models/expression", "../dcgview-helpers/tooltipped-error", "./play-pause-icon-view", "./circular-icon-view", "main/manage-focus-helper", "./action-icon-view", "jquery.handleevent"], function (require, e, t, o, i, n, r, l, s, a, d, c, p, h, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var g = o.Components.SwitchUnion, m = "#000", f = "#fff", y = function (e) { function y() { return null !== e && e.apply(this, arguments) || this } return t.__extends(y, e), y.prototype.init = function () { this.model = this.props.model(), this.controller = this.props.controller() }, y.prototype.template = function () { var e = this; return o.createElement("div", { class: o.const("dcg-expression-icon-container") }, g(this.bindFn(this.getIconMode), { error: function () { return o.createElement(d.TooltippedError, { error: e.bindFn(e.getErrorMsg), isWhite: function () { return e.controller.isItemSelected(e.model.id) || e.controller.isItemBeingDragged(e.model.id) }, gravity: e.const("se") }) }, none: function () { return o.createElement("span", null) }, slider: function () { return o.createElement(c.PlayPauseIconView, { controller: e.props.controller, model: e.props.model }) }, action: function () { return o.createElement(u.ActionIconView, { controller: e.props.controller, model: e.props.model }) }, icon: function () { return o.createElement("div", { class: o.const("dcg-circular-icon-container"), role: o.const("button"), tabindex: o.const("0"), "dcg-open-menu-guid": function () { return e.getMenuGUID() }, "aria-label": e.bindFn(e.getIconAriaLabel), onTap: function (t) { if (!t.wasHandled("dragdrop") && !t.wasLongheld()) return e.myOptionsOpen() ? e.toggleOptions(t) : !e.controller.isInEditListMode() && !t.shiftKey || e.isFraction() ? e.isFraction() ? e.onToggleFractionDisplay() : void e.toggleGraphShown() : e.toggleOptions(t) }, onLongHold: function (t) { t.handle("dcg-longhold"), t.handle("dcg-tap"), e.isFraction() || e.toggleOptions(t) }, manageFocus: e.const(h.manageFocusHelper({ controller: e.controller, location: { type: "expression-icon", id: e.model.id } })) }, o.createElement(p.CircularIconView, { iconType: e.bindFn(e.getIconType), backgroundColor: e.bindFn(e.getBackgroundColor), whiteIcon: e.bindFn(e.isSelected), foregroundColor: e.bindFn(e.getForegroundColor), iconModifier: e.bindFn(e.getIconModifier) })) } })) }, y.prototype.getErrorMsg = function () { return this.colorError() ? this.controller.s("shared-calculator-error-color-not-assigned") : this.controller.unpack(this.model.error) }, y.prototype.getMenuGUID = function () { return this.model.guid }, y.prototype.myOptionsOpen = function () { return this.controller.isItemSettingsMenuOpen(this.getMenuGUID()) }, y.prototype.toggleOptions = function (e) { this.controller.dispatch({ type: "toggle-item-settings-menu", menu: { type: "expression", model: this.model, guid: this.getMenuGUID(), focusFirstOption: "keyboard" === e.device } }) }, y.prototype.isSelected = function () { return this.controller.isItemSelected(this.model.id) || this.controller.isItemBeingDragged(this.model.id) }, y.prototype.isFraction = function () { return this.controller.canDisplayEvaluationForItemAsFraction(this.model.id) }, y.prototype.getIconMode = function () { return this.hasError() ? "error" : this.controller.getGraphSettings().config.graphpaper ? a.isGraphable(this.model) ? "icon" : this.hasSlider() ? "slider" : this.isFraction() ? "icon" : this.isNonemptyAction() ? "action" : "none" : "none" }, y.prototype.toggleGraphShown = function () { this.controller.dispatch({ type: "toggle-item-hidden", id: this.model.id }) }, y.prototype.colorError = function () { return !!this.model.formula.rgb_value && !this.model.formula.assignment }, y.prototype.hasError = function () { return !!this.colorError() || !!this.model.error && !a.isEmpty(this.model) && "none" === this.controller.getBrailleMode() }, y.prototype.hasSlider = function () { return !!this.model.sliderExists }, y.prototype.isNonemptyAction = function () { return a.isNonemptyAction(this.model) }, y.prototype.getDisplayProps = function () { var e = this.model, t = e.points, o = e.lines, i = e.fill; return s.getReconciledExpressionProps(this.model.formula.expression_type, { points: t, lines: o, fill: i }) }, y.prototype.getBackgroundColor = function () { if (!this.isFraction()) return l.getMaybeGradientDisplayColor(this.model); var e = this.isSelected(); return this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id) ? e ? f : m : "" }, y.prototype.getForegroundColor = function () { if (!this.isFraction()) return ""; var e = this.isSelected(); return e !== this.controller.shouldEvaluationForItemDisplayAsFraction(this.model.id) ? f : e ? "#6399cb" : m }, y.prototype.onToggleFractionDisplay = function () { this.controller.dispatch({ type: "toggle-fraction-evaluation", id: this.model.id }) }, y.prototype.getIconModifier = function () { return a.isBoxPlot(this.model) && "y" === a.getVizProp(this.model, "alignedAxis") ? "rotated" : "none" }, y.prototype.getIconType = function () { if (this.isFraction()) return "fraction"; if (!this.model.shouldGraph) return "hidden"; if (this.controller.isInEditListMode()) return "none"; var e = this.model.pointStyle, t = this.model.lineStyle, o = this.getDisplayProps(), l = this.model.formula; if (a.isBoxPlot(this.model)) return "boxplot"; if (a.isDotPlot(this.model)) { if ("POINT" === this.model.pointStyle) return "dotplot-default"; if ("CROSS" === this.model.pointStyle) return "dotplot-cross"; if ("OPEN" === this.model.pointStyle) return "dotplot-open" } if (a.isHistogram(this.model)) return "histogram"; if (a.isToplevelDistribution(this.model)) return a.shouldShowCDFFooter(this.model) ? "filled-distribution" : "unfilled-distribution"; if (this.model.reconciledDragMode === i.DragMode.X) return "movable-horizontal"; if (this.model.reconciledDragMode === i.DragMode.Y) return "movable-vertical"; if (this.model.reconciledDragMode === i.DragMode.XY) return "movable-both"; if (a.isPointOrPointList(this.model)) return a.isSinglePoint(this.model) ? e === n.PointStyle.OPEN ? "point-open" : e === n.PointStyle.CROSS ? "point-cross" : "point-default" : o.lines && o.points ? "table-points-and-lines" : o.lines ? "table-lines" : "table-points"; var s = this.getDisplayProps().fill; if (a.isPolygon(this.model)) return s ? o.lines ? t === n.LineStyle.DASHED ? "polygon-dashed-filled" : t === n.LineStyle.DOTTED ? "polygon-dotted-filled" : "polygon-default-filled" : "polygon-none-filled" : o.lines ? t === n.LineStyle.DASHED ? "polygon-dashed" : t === n.LineStyle.DOTTED ? "polygon-dotted" : "polygon-default" : "none"; if (a.isParametric(this.model)) return s ? o.lines ? t === n.LineStyle.DASHED ? "parametric-dashed-filled" : t === n.LineStyle.DOTTED ? "parametric-dotted-filled" : "parametric-default-filled" : "parametric-none-filled" : o.lines ? t === n.LineStyle.DASHED ? "graph-dashed" : t === n.LineStyle.DOTTED ? "graph-dotted" : "graph-default" : "none"; var d = l.operator, c = 0 !== r.table[d].direction, p = !1 === r.table[d].inclusive; return l.is_shade_between || !p && c ? "shaded-inequality" : p && !c ? "inequality" : p && c ? "shaded-inequality" : t === n.LineStyle.DASHED ? "graph-dashed" : t === n.LineStyle.DOTTED ? "graph-dotted" : "graph-default" }, y.prototype.getIconAriaLabel = function () { return this.isFraction() ? a.shouldEvaluationDisplayAsFraction(this.model) ? this.controller.s("shared-calculator-narration-display-as-decimal") : this.controller.s("shared-calculator-narration-display-as-fraction") : this.myOptionsOpen() ? this.controller.s("graphing-calculator-narration-hide-options") : this.controller.isInEditListMode() ? this.controller.s("graphing-calculator-narration-show-options") : this.model.hidden ? this.controller.s("graphing-calculator-narration-show-expression") : this.controller.s("graphing-calculator-narration-hide-expression") }, y }(o.Class); e.default = y });

define('loadcss!expressions/expression-menus/color-swatch', function () { });
define('expressions/expression-menus/color-swatch', ["require", "exports", "tslib", "dcgview", "expressions/colors", "loadcss!./color-swatch"], function (require, o, r, e, t) { "use strict"; Object.defineProperty(o, "__esModule", { value: !0 }), o.ColorSwatch = void 0; var l = function (o) { function l() { return null !== o && o.apply(this, arguments) || this } return r.__extends(l, o), l.prototype.template = function () { var o = this; return e.createElement("span", { class: function () { var r, e; return { "dcg-color-swatch": !0, "dcg-color-evaluation": null === (e = (r = o.props).isEvaluation) || void 0 === e ? void 0 : e.call(r), "dcg-light-color": t.colorValueHasSomeLightColor(o.props.color()) } }, style: function () { return { background: t.colorValueToBackgroundValue(o.props.color()) } } }) }, l }(e.Class); o.ColorSwatch = l });

define('loadcss!expressions/evaluation-view', function () { });
define('expressions/evaluation-view', ["require", "exports", "tslib", "dcgview", "core/lib/label", "dcgview-helpers/static-mathquill-view", "./expression-menus/color-swatch", "../shared-components/mathquill-braille-wrapper", "./expression_view", "loadcss!./evaluation-view"], function (require, e, t, n, o, r, a, i, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var c = n.Components, s = c.If, u = c.SwitchUnion; var p = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller() }, c.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-evaluation-container") }, n.createElement("div", { class: function () { return { "dcg-evaluation": !0, "dcg-do-blur": !0, "dcg-hidden": e.props.controller().isInEditListMode() } }, handleEvent: n.const("true"), tabindex: function () { return e.props.focusable() && "none" === e.controller.getBrailleMode() ? "0" : "-1" } }, n.createElement(i.default, t.__assign({ latex: this.bindFn(this.getBrailleEvaluation), ariaLabel: this.const(""), brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("braille-output" === t.type && t.id === e.props.id()) }, onBrailleInput: function () { }, isStatic: this.const(!0), onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "braille-output", id: e.props.id() } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "braille-output", id: e.props.id() } }) } }, l.getBrailleWrapperProps(this.controller, { gravity: "sw" })), n.createElement("div", { class: n.const("dcg-evaluation-label-container"), onTap: this.bindFn(this.onSelectEvaluation) }, n.createElement(s, { predicate: function () { return !!e.props.dependent() } }, function () { return n.createElement(r.default, { latex: function () { return o.identifierToLatex(e.props.dependent()) }, config: e.const({}) }, n.createElement("span", null)) }), n.createElement("span", { class: n.const("dcg-equals") }, n.createElement(r.default, { latex: this.const("="), config: this.const({}) }))), n.createElement("span", { class: function () { return { "dcg-text-selectable": "rgbcolor" !== e.getEvaluationType(), "dcg-evaluation-html": !0, "dcg-color-evaluation": "rgbcolor" === e.getEvaluationType() } }, didMount: this.bindFn(this.didMountEvaluation) }, u(function () { return e.getEvaluationType() }, { list: function () { return n.createElement("span", { class: n.const("dcg-evaluation-list") }, function () { return e.controller.s("graphing-calculator-label-evaluation-list", { count: e.props.val().length }) }) }, fraction: function () { return n.createElement(r.default, { latex: function () { return o.truncatedLatexLabel(e.props.val(), e.getLabelOptions()) }, config: e.const({}) }) }, undefined: function () { return n.createElement("span", null, n.const("undefined")) }, scientific: function () { return n.createElement(r.default, { latex: function () { return e.getNumberLabel().mantissa + "\\times10^{" + e.getNumberLabel().exponent + "}" }, config: e.const({}) }) }, decimal: function () { return n.createElement(r.default, { latex: function () { return e.getNumberLabel().value }, config: e.const({}) }) }, rgbcolor: function () { return n.createElement(a.ColorSwatch, { color: function () { return e.controller.getColorById(e.props.id()) }, isEvaluation: e.const(!0) }) } })))), n.createElement("div", { class: n.const("dcg-clear") })) }, c.prototype.getNumberLabel = function () { return e = this.props.val(), t = this.getLabelOptions(), o.numericLabel(e, t); var e, t }, c.prototype.getEvaluationType = function () { var e = this.props.val(); return "string" == typeof e ? "rgbcolor" : Array.isArray(e) ? "string" == typeof e[0] ? "rgbcolor" : "list" : this.getNumberLabel().type }, c.prototype.getLabelOptions = function () { return this.props.controller().getEvaluationLabelOptionsForItem(this.props.id()) }, c.prototype.didMountEvaluation = function (e) { this.evaluationNode = e }, c.prototype.onSelectEvaluation = function () { var e = document.createRange(); e.selectNodeContents(this.evaluationNode); var t = window.getSelection(); t && (t.removeAllRanges(), (t = window.getSelection()) && t.addRange(e)) }, c.prototype.getBrailleEvaluation = function () { var e = ""; this.props.dependent() && (e = o.identifierToLatex(this.props.dependent())), e += "="; var t = this.getEvaluationType(); switch (t) { case "list": e += this.controller.s("graphing-calculator-label-evaluation-list", { count: this.props.val().length }); break; case "fraction": e += o.truncatedLatexLabel(this.props.val(), this.getLabelOptions()); break; case "undefined": e = "undefined"; break; case "scientific": e += this.getNumberLabel().mantissa + "\\times10^{" + this.getNumberLabel().exponent + "}"; break; case "decimal": e += this.getNumberLabel().value; break; case "rgbcolor": e += this.props.val(); break; default: return t }return e }, c }(n.Class); e.default = p });
define('expressions/unresolved_view', ["require", "exports", "tslib", "dcgview"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return this.controller = this.props.controller(), n.createElement("div", { class: n.const("dcg-unresolved") }, n.createElement("i", { class: n.const("dcg-icon-error"), "aria-hidden": n.const("true") }), n.const("Â "), function () { return e.controller.s("graphing-calculator-error-equation-contains-unresolved-details") }, n.createElement("a", { href: n.const("https://help.desmos.com/hc/en-us/articles/202529079-Unresolved-Detail-In-Plotted-Functions"), target: n.const("_blank") }, function () { return e.controller.s("graphing-calculator-link-learn-more") })) }, r }(n.Class); e.default = r });

define('loadcss!domain', function () { });
define('expressions/domain_view', ["require", "exports", "tslib", "dcgview", "jquery", "keys", "dcgview-helpers/static-mathquill-view", "dcgview-helpers/mathquill-view", "graphing-calc/models/expression", "core/lib/label", "bugsnag", "main/mathquill-operators", "../shared-components/mathquill-braille-wrapper", "./expression_view", "loadcss!domain"], function (require, e, t, n, i, o, a, r, s, l, c, d, u, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var h = function (e) { function h() { return null !== e && e.apply(this, arguments) || this } return t.__extends(h, e), h.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, h.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-domain dcg-do-blur"), handleEvent: n.const("true") }, n.createElement("div", { class: n.const("dcg-display-domain dcg-mq-underline-container dcg-do-blur"), handleEvent: n.const("true") }, n.createElement("div", { class: n.const("dcg-editable-mathquill-container") }, n.createElement(u.default, t.__assign({ latex: function () { return e.getMinLatex() }, ariaLabel: function () { return e.controller.raw("dmin") }, placeholder: function () { return l.value(s.getDomainMin(e.model)).string }, brailleShouldFocus: function () { return "min" === e.getFocusedInput() }, selectOnFocus: this.const(!0), onBrailleInput: function (t) { return e.dispatchMinLatexIfChanged(t) }, hasError: function () { return !s.isDomainMinValid(e.model) }, onBrailleFocusedChanged: function (t) { return e.handleFocusedChanged("min", t) }, onBrailleKeydown: function (t) { return e.handleBrailleKeydown("min", t) }, dataLabelAttributeValue: this.const("domain-min") }, p.getBrailleWrapperProps(this.props.controller())), n.createElement(r.default, { latex: function () { return e.getMinLatex() }, placeholder: function () { return l.value(s.getDomainMin(e.model)).string }, isFocused: function () { return "min" === e.getFocusedInput() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, selectOnFocus: this.const(!0), config: this.bindFn(this.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-domain-minimum") }, getAriaPostLabel: this.const(""), hasError: function () { return !s.isDomainMinValid(e.model) }, onUserPressedKey: function (t, n) { e.handlePressedKey("min", t, n) }, onUserChangedLatex: function (t) { return e.dispatchMinLatexIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged("min", t) }, dataLabelAttributeValue: this.const("domain-min"), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } })), n.createElement("span", { class: n.const("dcg-interval-interior") }, n.createElement(a.default, { latex: function () { return e.getDomainVariableLatex() }, config: this.const({}) }, n.createElement("span", null))), n.createElement(u.default, t.__assign({ latex: function () { return e.getMaxLatex() }, ariaLabel: function () { return e.controller.raw("dmax") }, placeholder: function () { return l.value(s.getDomainMax(e.model)).string }, brailleShouldFocus: function () { return "max" === e.getFocusedInput() }, selectOnFocus: this.const(!0), onBrailleInput: function (t) { return e.dispatchMaxLatexIfChanged(t) }, hasError: function () { return !s.isDomainMaxValid(e.model) }, onBrailleFocusedChanged: function (t) { return e.handleFocusedChanged("max", t) }, onBrailleKeydown: function (t) { return e.handleBrailleKeydown("max", t) }, dataLabelAttributeValue: this.const("domain-max") }, p.getBrailleWrapperProps(this.props.controller())), n.createElement(r.default, { latex: function () { return e.getMaxLatex() }, placeholder: function () { return l.value(s.getDomainMax(e.model)).string }, isFocused: function () { return "max" === e.getFocusedInput() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, selectOnFocus: this.const(!0), config: this.bindFn(this.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-domain-maximum") }, getAriaPostLabel: this.const(""), hasError: function () { return !s.isDomainMaxValid(e.model) }, onUserPressedKey: function (t, n) { e.handlePressedKey("max", t, n) }, onUserChangedLatex: function (t) { return e.dispatchMaxLatexIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged("max", t) }, dataLabelAttributeValue: this.const("domain-max"), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }))))) }, h.prototype.handleBrailleKeydown = function (e, t) { var n = o.lookup(t); n && this.handlePressedKey(e, n, t) }, h.prototype.handlePressedKey = function (e, t, n) { if (!this.controller.isInEditListMode()) { if ("Esc" === t) return void this.controller.dispatch({ type: "set-focus-location", location: void 0 }); if ("Enter" === t) return this.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" }) } var o = r.default.getFocusedMathquill(), a = u.getFocusedBrailleElement(); "Left" !== t && "Right" !== t && "Down" !== t && "Up" !== t ? o && (o.keystroke(t, n), "min" === e ? this.dispatchMinLatexIfChanged(o.latex()) : "max" === e && this.dispatchMaxLatexIfChanged(o.latex())) : (o ? r.default.applyArrowKeyAndReturnIfWasAtBounds(o, t, n) : !(!a || !(0 === a.selectionStart && "Left" === t || a.selectionStart === i(a).val().length && "Right" === t || "Up" === t || "Down" === t))) && (n && n.preventDefault(), "Left" === t ? "max" === e && this.controller.dispatch({ type: "set-focus-location", location: { type: "domain-limit", id: this.model.id, location: "min" } }) : "Right" === t ? "min" === e && this.controller.dispatch({ type: "set-focus-location", location: { type: "domain-limit", id: this.model.id, location: "max" } }) : "Down" === t ? this.controller.dispatch({ type: "on-special-key-pressed", key: "Down" }) : "Up" === t && this.controller.dispatch({ type: "set-focus-location", location: { type: "expression", id: this.model.id } })) }, h.prototype.handleFocusedChanged = function (e, t) { t ? this.controller.dispatch({ type: "set-focus-location", location: { type: "domain-limit", id: this.id, location: e } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "domain-limit", id: this.id, location: e } }) }, h.prototype.dispatchMinLatexIfChanged = function (e) { if (this.getMinLatex() !== e) { var t = this.getDomainType(); if ("unknown" === t) return void c.notify("DomainView is in use for a non-parametric, non-polar expression", { severity: "error", metaData: { expression: s.getState(this.model, { stripDefaults: !0 }) } }); this.controller.dispatch("polar" === t ? { type: "set-polar-domain-minlatex", id: this.id, latex: e } : { type: "set-parametric-domain-minlatex", id: this.id, latex: e }) } }, h.prototype.dispatchMaxLatexIfChanged = function (e) { if (this.getMaxLatex() !== e) { var t = this.getDomainType(); if ("unknown" === t) return void c.notify("DomainView is in use for a non-parametric, non-polar expression", { severity: "error", metaData: { expression: s.getState(this.model, { stripDefaults: !0 }) } }); this.controller.dispatch("polar" === t ? { type: "set-polar-domain-maxlatex", id: this.id, latex: e } : { type: "set-parametric-domain-maxlatex", id: this.id, latex: e }) } }, h.prototype.getFocusedInput = function () { var e = this.controller.getFocusLocation(); if (e && "domain-limit" === e.type && e.id === this.id) return e.location }, h.prototype.getMinLatex = function () { switch (this.getDomainType()) { case "parametric": return s.getParametricDomainMin(this.model); case "polar": return s.getPolarDomainMin(this.model); default: return "" } }, h.prototype.getMaxLatex = function () { switch (this.getDomainType()) { case "parametric": return s.getParametricDomainMax(this.model); case "polar": return s.getPolarDomainMax(this.model); default: return "" } }, h.prototype.getDomainVariableLatex = function () { switch (this.getDomainType()) { case "parametric": return "\\le t \\le"; case "polar": return "\\le \\theta \\le"; default: return "" } }, h.prototype.getDomainType = function () { return s.isPolar(this.model) ? "polar" : s.isParametric(this.model) ? "parametric" : "unknown" }, h.prototype.getMQConfig = function () { return { autoOperatorNames: d.getAutoOperators({}) } }, h }(n.Class); e.default = h });

define('loadcss!regression', function () { });
define('expressions/regression_view', ["require", "exports", "tslib", "dcgview", "core/lib/label", "dcgview-helpers/static-mathquill-view", "../shared-components/mathquill-braille-wrapper", "./expression_view", "main/manage-focus-helper", "../shared-components/tooltip", "loadcss!regression"], function (require, e, t, r, n, o, a, s, c, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getRoundedStat = e.getRoundedParam = void 0; var l = r.Components, u = l.If, g = l.For, p = l.IfElse, d = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, r.createElement(u, { predicate: this.bindFn(this.hasRegression) }, function () { return r.createElement("div", { class: r.const("dcg-regression-container") }, r.createElement("div", { class: r.const("dcg-handle-event"), handleEvent: r.const("true") }, r.createElement(u, { predicate: e.bindFn(e.getShouldSuggestLogMode) }, function () { return r.createElement("div", { class: r.const("dcg-log-mode-toggle") }, p(function () { return e.areLogModeRegressionsForced() }, { true: function () { return r.createElement("div", { class: r.const("dcg-action-log-mode-toggle dcg-no-hover-styling") }, function () { return e.controller.s("graphing-calculator-button-regression-log-mode") }) }, false: function () { return r.createElement("div", null, r.createElement("div", { class: function () { return { "dcg-action-log-mode-toggle": !0, "dcg-toggled-on": e.getIsLogModeRegression() } }, onTap: e.bindFn(e.onTapLogMode) }, r.createElement("span", { class: r.const("dcg-log-mode-checkbox"), role: r.const("checkbox"), "aria-checked": function () { return e.getIsLogModeRegression() }, tabindex: r.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-button-regression-log-mode") } }, r.createElement("i", { class: r.const("dcg-icon-check"), "aria-hidden": r.const("true") })), function () { return e.controller.s("graphing-calculator-button-regression-log-mode") }), r.createElement(i.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip") }, gravity: e.const("e") }, r.createElement("a", { "aria-label": function () { return e.controller.s("graphing-calculator-label-regression-log-mode-help-tooltip") }, class: r.const("dcg-log-mode-toggle-help"), target: r.const("_blank"), href: r.const("https://help.desmos.com/hc/en-us/articles/204349605") }, r.createElement("i", { class: r.const("dcg-icon-question-sign"), "aria-hidden": r.const("true") })))) } })) }), r.createElement("div", { class: r.const("dcg-statistics"), role: r.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-regression-statistics") } }, r.createElement("div", { class: r.const("dcg-expression-footer-title") }, function () { return e.controller.s("graphing-calculator-heading-regression-statistics") }, r.createElement(u, { predicate: function () { return e.getRegression().statistics.hasOwnProperty("RMSE") } }, function () { return r.createElement(i.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip") }, gravity: e.const("s") }, r.createElement("a", { class: r.const("dcg-expression-footer-title-help"), target: r.const("_blank"), href: r.const("https://help.desmos.com/hc/en-us/articles/202529129-What-is-RMSE-"), "aria-label": function () { return e.controller.s("graphing-calculator-label-regression-what-is-rmse-tooltip") } }, r.createElement("i", { class: r.const("dcg-icon-question-sign"), "aria-hidden": r.const("true") }))) }), r.createElement(u, { predicate: function () { return e.getRegression().statistics.Rsquared < 0 } }, function () { return r.createElement(i.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip") }, gravity: e.const("s") }, r.createElement("a", { "aria-label": function () { return e.controller.s("graphing-calculator-label-regression-why-is-negative-tooltip") }, class: r.const("dcg-expression-footer-title-help"), target: r.const("_blank"), href: r.const("https://help.desmos.com/hc/en-us/articles/202529139-Why-am-I-seeing-a-negative-R-2-value-") }, r.createElement("i", { class: r.const("dcg-icon-question-sign"), "aria-hidden": r.const("true") }))) })), r.createElement("div", { class: r.const("dcg-statistics-values") }, r.createElement(u, { predicate: function () { return e.getRegression().statistics.hasOwnProperty("Rsquared") } }, function () { return r.createElement("div", null, r.createElement(a.default, t.__assign({ latex: function () { return "R^2=" + f(e.getRegression(), "Rsquared") }, brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("regression-output" === t.type && "Rsquared" === t.parameter) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "regression-output", parameter: "Rsquared" } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "regression-output", parameter: "Rsquared" } }) }, ariaLabel: e.const(""), isStatic: e.const(!0) }, s.getBrailleWrapperProps(e.controller)), r.createElement(o.default, { latex: function () { return "R^2=" + f(e.getRegression(), "Rsquared") }, config: e.const({}) }, r.createElement("span", { tabindex: r.const("0"), manageFocus: e.const(c.manageFocusHelper({ predicate: function () { return "none" === e.controller.getBrailleMode() }, controller: e.controller, location: { type: "regression-output", parameter: "Rsquared" } })) })))) }), r.createElement(u, { predicate: function () { return e.getRegression().statistics.hasOwnProperty("rsquared") } }, function () { return r.createElement("div", null, r.createElement(a.default, t.__assign({ latex: function () { return "r^2=" + f(e.getRegression(), "rsquared") }, brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("regression-output" === t.type && "rsquared" === t.parameter) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "regression-output", parameter: "rsquared" } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "regression-output", parameter: "rsquared" } }) }, ariaLabel: e.const(""), isStatic: e.const(!0) }, s.getBrailleWrapperProps(e.controller)), r.createElement(o.default, { latex: function () { return "r^2=" + f(e.getRegression(), "rsquared") }, config: e.const({}) }, r.createElement("span", { tabindex: r.const("0"), manageFocus: e.const(c.manageFocusHelper({ predicate: function () { return "none" === e.controller.getBrailleMode() }, controller: e.controller, location: { type: "regression-output", parameter: "rsquared" } })) })))) }), r.createElement(u, { predicate: function () { return e.getRegression().statistics.hasOwnProperty("r") } }, function () { return r.createElement("div", null, r.createElement(a.default, t.__assign({ latex: function () { return "r=" + f(e.getRegression(), "r") }, brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("regression-output" === t.type && "r" === t.parameter) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "regression-output", parameter: "r" } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "regression-output", parameter: "r" } }) }, ariaLabel: e.const(""), isStatic: e.const(!0) }, s.getBrailleWrapperProps(e.controller)), r.createElement(o.default, { latex: function () { return "r=" + f(e.getRegression(), "r") }, config: e.const({}) }, r.createElement("span", { class: r.const("dcg-r-value"), tabindex: r.const("0"), manageFocus: e.const(c.manageFocusHelper({ predicate: function () { return "none" === e.controller.getBrailleMode() }, controller: e.controller, location: { type: "regression-output", parameter: "r" } })) })))) }), r.createElement(u, { predicate: function () { return e.getRegression().statistics.hasOwnProperty("RMSE") } }, function () { return r.createElement("div", null, r.createElement(a.default, t.__assign({ latex: function () { return "\\operatorname{RMSE}=" + f(e.getRegression(), "RMSE") }, brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("regression-output" === t.type && "RMSE" === t.parameter) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "regression-output", parameter: "RMSE" } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "regression-output", parameter: "RMSE" } }) }, ariaLabel: e.const(""), isStatic: e.const(!0) }, s.getBrailleWrapperProps(e.controller)), r.createElement(o.default, { latex: function () { return "\\operatorname{RMSE}=" + f(e.getRegression(), "RMSE") }, config: e.const({}) }, r.createElement("span", { tabindex: r.const("0"), manageFocus: e.const(c.manageFocusHelper({ predicate: function () { return "none" === e.controller.getBrailleMode() }, controller: e.controller, location: { type: "regression-output", parameter: "RMSE" } })) })))) }))), r.createElement("div", { role: r.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-regression-residuals") }, class: r.const("dcg-residuals") }, r.createElement("div", { class: r.const("dcg-expression-footer-title") }, function () { return e.controller.s("graphing-calculator-heading-regression-residuals") }), r.createElement(a.default, t.__assign({ latex: e.bindFn(e.getResidualVariable), brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("regression-output" === t.type && t.parameter === e.getResidualVariable()) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "regression-output", parameter: e.getResidualVariable() } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "regression-output", parameter: e.getResidualVariable() } }) }, ariaLabel: e.const(""), isStatic: e.const(!0) }, s.getBrailleWrapperProps(e.controller)), r.createElement(o.default, { latex: e.bindFn(e.getResidualVariable), config: e.const({}) }, r.createElement("span", { class: r.const("dcg-residuals-variable"), tabindex: r.const("0"), manageFocus: e.const(c.manageFocusHelper({ predicate: function () { return "none" === e.controller.getBrailleMode() }, controller: e.controller, location: { type: "regression-output", parameter: e.getResidualVariable() } })) }))), r.createElement("div", { class: function () { return { "dcg-residual-suggestion": !0, "dcg-action-plot-residual": !0, "dcg-btn": !0, "dcg-btn-light-gray": !0, "dcg-visible": e.getResidualSuggestionVisible() } }, "aria-hidden": function () { return !e.getResidualSuggestionVisible() }, role: r.const("button"), tabindex: function () { return e.getResidualSuggestionVisible() ? "0" : void 0 }, onTap: e.bindFn(e.onTapResidualsSuggestion) }, function () { return e.controller.s("graphing-calculator-button-regression-plot-residuals") })), r.createElement(u, { predicate: function () { return Object.keys(e.getRegression().parameters).length > 0 } }, function () { return r.createElement("div", { class: r.const("dcg-parameters-container") }, r.createElement("div", { class: r.const("dcg-expression-footer-title") }, function () { return e.controller.s("graphing-calculator-heading-regression-parameters") }, r.createElement(u, { predicate: function () { return e.isNonLinearRegression() } }, function () { return r.createElement(i.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-regression-parameters-not-exact") }, gravity: e.const("s") }, r.createElement("a", { class: r.const("dcg-expression-footer-title-help"), target: r.const("_blank"), href: r.const("https://help.desmos.com/hc/en-us/articles/360042428612"), "aria-label": function () { return e.controller.s("graphing-calculator-label-regression-parameters-not-exact") } }, r.createElement("i", { class: r.const("dcg-icon-question-sign"), "aria-hidden": r.const("true") }))) })), r.createElement(g, { each: function () { return Object.keys(e.getRegression().parameters) } }, r.createElement("div", { role: r.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-regression-parameters") }, class: r.const("dcg-parameters") }, function (n) { return r.createElement(a.default, t.__assign({ latex: function () { return n + "=" + m(e.getRegression(), n) }, brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("regression-output" === t.type && t.parameter === n) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "regression-output", parameter: n } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "regression-output", parameter: n } }) }, ariaLabel: e.const(""), isStatic: e.const(!0) }, s.getBrailleWrapperProps(e.controller)), r.createElement(o.default, { latex: function () { return n + "=" + m(e.getRegression(), n) }, config: e.const({}) }, r.createElement("span", { class: r.const("dcg-parameter"), tabindex: r.const("0"), manageFocus: e.const(c.manageFocusHelper({ controller: e.controller, location: { type: "regression-output", parameter: n } })) }))) }))) }), r.createElement("div", { class: r.const("dcg-clear") }), r.createElement(u, { predicate: function () { return e.hasParameterWarning() } }, function () { return r.createElement("div", { class: r.const("dcg-parameter-warning") }, r.createElement("i", { class: r.const("dcg-icon-error"), "aria-hidden": r.const("true") }), r.const("Â "), function () { return e.controller.s("graphing-calculator-text-regression-potentially-inaccurate-parameters") }, r.const("Â "), r.createElement("a", { href: r.const("https://help.desmos.com/hc/en-us/articles/360042942771"), target: r.const("_blank") }, function () { return e.controller.s("graphing-calculator-link-learn-more") })) }))) }) }, n.prototype.onTapResidualsSuggestion = function () { this.controller.dispatch({ type: "plot-residuals", id: this.id }) }, n.prototype.onTapLogMode = function () { this.controller.dispatch({ type: "toggle-logmode", id: this.id }) }, n.prototype.getRegression = function () { return this.model.formula.regression }, n.prototype.hasRegression = function () { return !!this.model.formula.regression }, n.prototype.isNonLinearRegression = function () { return !this.getRegression().isLinear }, n.prototype.getResidualVariable = function () { return this.getRegression().residualVariable || "" }, n.prototype.getResidualSuggestionVisible = function () { return void 0 !== this.getRegression().residualSuggestionId }, n.prototype.areLogModeRegressionsForced = function () { return this.controller.areLogModeRegressionsForced() }, n.prototype.getShouldSuggestLogMode = function () { return !!this.getRegression().shouldSuggestLogMode }, n.prototype.hasParameterWarning = function () { return !!this.getRegression().parameterWarning }, n.prototype.getIsLogModeRegression = function () { return !!this.model.isLogModeRegression }, n }(r.Class); function m(e, t) { return n.truncatedLatexLabel(e.parameters[t], { digits: 6, smallCutoff: 1e-6, bigCutoff: 1e9 }) } function f(e, t) { return n.truncatedLatexLabel(e.statistics[t], { zeroCutoff: 1e-15, digits: 4, smallCutoff: 1e-6, bigCutoff: 1e9 }) } e.default = d, e.getRoundedParam = m, e.getRoundedStat = f });
define('lib/underscore-shim', ["require", "exports", "underscore_model"], function (require, e, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.UnderscoreModelShim = void 0; var t = function () { function e() { this.model = new o.UnderscoreModel } return e.prototype.triggerEvent = function (e, o) { this.model.triggerEvent(e, o) }, e.prototype.observeEvent = function (e, o) { this.model.observeEvent(e, o) }, e.prototype.unobserveEvent = function (e) { this.model.unobserveEvent(e) }, e.prototype.setProperty = function (e, o) { this[e] = o, this.model.setProperty(e, o) }, e.prototype.observe = function (e, o) { this.model.observe(e, o) }, e.prototype.observeAndSync = function (e, o) { this.model.observeAndSync(e, o) }, e.prototype.unobserve = function (e) { this.model.unobserve(e) }, e }(); e.UnderscoreModelShim = t });
define('dcgview-helpers/dragdrop', ["require", "exports", "tslib", "underscore", "jquery", "lib/underscore-shim"], function (require, t, e, i, r, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DragDrop = void 0; var n = function (t) { function o() { var e = t.call(this) || this; return e.dragging = !1, e.guid = i.uniqueId("dragdrop-class"), e } return e.__extends(o, t), o.prototype._evt2pt = function (t) { return { x: t.changedTouches[0].pageX - this._offsetPt.x, y: t.changedTouches[0].pageY - this._offsetPt.y } }, o.prototype._dispatch = function (t, e) { if (!this._destroyed) { var i = this._evt2pt(e); this.triggerEvent(t, { x: i.x, y: i.y, dx: i.x - this._startPt.x, dy: i.y - this._startPt.y, evt: e }) } }, o.prototype.destroy = function () { r(document).off("." + this.guid), this._destroyed = !0 }, o.prototype.startDrag = function (t, e) { var i = this; if (void 0 === e && (e = {}), !this.dragging) return r(document).on("dcg-tapmove." + this.guid, function (t) { (t.originalEvent || t).preventDefault(), cancelAnimationFrame(i.frameThrottle), i.frameThrottle = requestAnimationFrame(function () { return i.doDrag(t) }) }), r(document).on("dcg-tapend." + this.guid + " dcg-tapcancel." + this.guid, function (t) { return i.endDrag(t) }), this._offsetPt = { x: 0, y: 0 }, e.origin && (this._offsetPt = { x: this._evt2pt(t).x - e.origin.x, y: this._evt2pt(t).y - e.origin.y }), this._startPt = this._evt2pt(t), this.setProperty("dragging", !0), this._dispatch("onGrab", t) }, o.prototype.doDrag = function (t) { this.dragging && this._dispatch("onDrag", t) }, o.prototype.endDrag = function (t) { this.dragging && (r(document).off("." + this.guid), this.doDrag(t), this.setProperty("dragging", !1), this._dispatch("onDrop", t)) }, o }(o.UnderscoreModelShim); t.DragDrop = n });

define('loadcss!dcgview-helpers/slider', function () { });
define('dcgview-helpers/slider', ["require", "exports", "lib/rounding", "tslib", "keys", "dcgview", "jquery", "lib/conditional_blur", "./dragdrop", "loadcss!./slider"], function (require, t, e, r, o, s, n, i, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var p = s.Components.If; function c(t, e, r) { return Math.min(Math.max(t, e), r) } var d = function (t) { function d() { return null !== t && t.apply(this, arguments) || this } return r.__extends(d, t), d.prototype.template = function () { var t = this; return s.createElement("div", { class: function () { return { "dcg-slider-interior": !0, "dcg-disable-slider": t.shouldDisableSlider() } }, didMount: this.bindFn(this.didMountRoot), onTapStart: this.bindFn(this.onStartDrag), style: s.const({ "touch-action": "none" }) }, s.createElement("div", { class: s.const("dcg-track") }, s.createElement("div", { class: s.const("dcg-ticks"), onMount: this.bindFn(this.didMountTickMarks) }), s.createElement("div", { class: s.const("dcg-graphic") })), s.createElement(p, { predicate: this.bindFn(this.shouldShowZeroMarker) }, function () { return s.createElement("div", { class: s.const("dcg-zeroMarker"), style: function () { return { left: t.getZeroMarkerPercent() + "%" } } }) }), s.createElement("div", { class: function () { return { "dcg-thumb": !0, "dcg-down": t.isDragging } }, role: s.const("slider"), tabindex: s.const("0"), disablescroll: s.const("true"), style: function () { return { left: t.getThumbPercent() + "%" } }, onKeyDown: this.bindFn(this.onKeyDown), "aria-label": this.props.ariaLabel, "aria-valuemin": this.props.min, "aria-valuemax": this.props.max, "aria-valuenow": this.props.value, manageFocus: this.buildFocusManager() }, s.createElement("div", { class: s.const("dcg-graphic") }), s.createElement("div", { class: s.const("dcg-center") }))) }, d.prototype.willUnmount = function () { this.dragDrop.destroy() }, d.prototype.didMountRoot = function (t) { var e = this; this.rootNode = t, this.dragDrop = new a.DragDrop, this.isMounted = !0, this.dragDrop.observeEvent("onDrop", function () { e.isDragging = !1, e.update(), e.props.onDrop && e.props.onDrop() }), this.dragDrop.observeEvent("onGrab", function () { e.isDragging = !0, e.update(), e.props.onGrab && e.props.onGrab() }), this.dragDrop.observeEvent("onDrag", function (t, r) { e.props.onDragUpdate(e.valueFromPixels(r.x)) }) }, d.prototype.didMountTickMarks = function (t) { this.tickMarksNode = t, this.renderTickMarks() }, d.prototype.didUpdate = function () { this.renderTickMarks() }, d.prototype.shouldDisableSlider = function () { return this.props.min() === this.props.max() }, d.prototype.renderTickMarks = function () { if (this.tickMarksNode) { var t, e = this.props.step(), r = this.props.min(), o = this.props.max(); if ((t = void 0 === e ? 0 : 100 * e / (o - r)) < 3 && (t = 0), t > 100 && (t = 0), isNaN(t) && (t = 0), this.lastTickMarksPercent !== t) { this.lastTickMarksPercent = t; var s = ""; if (t > 0 && t < 100) for (var n = t; n < 100; n += t)s += '<div class="dcg-tick" style="left:' + n + '%"></div>'; this.tickMarksNode.innerHTML = s } } }, d.prototype.shouldShowZeroMarker = function () { return this.props.min() <= 0 && this.props.max() >= 0 }, d.prototype.getZeroMarkerPercent = function () { var t = this.props.min(); return 100 * (0 - t) / (this.props.max() - t) }, d.prototype.getThumbPercent = function () { return 100 * this.percentFromValue(this.props.value()) }, d.prototype.valueFromPixels = function (t) { if (!this.isMounted) return 0; var r = this.props.min(), o = this.props.max(), s = this.rootNode.getBoundingClientRect().width, n = r + (o - r) * c(t / s, 0, 1), i = (o - r) / s; return e.shortestDecimalBetween(n - i, n + i) }, d.prototype.percentFromValue = function (t) { var e = this.props.min(); return c((t - e) / (this.props.max() - e), 0, 1) }, d.prototype.pixelsFromValue = function (t) { if (!this.isMounted) return 0; var e = this.percentFromValue(t); return this.rootNode.getBoundingClientRect().width * e }, d.prototype.onKeyDown = function (t) { switch (o.lookup(t)) { case o.UP: this.props.onUpPress && (this.props.onUpPress(), t.preventDefault()); break; case o.DOWN: this.props.onDownPress && (this.props.onDownPress(), t.preventDefault()); break; case o.ENTER: this.props.onEnterPress && (this.props.onEnterPress(), t.preventDefault()); break; case o.ESCAPE: document.activeElement && n(document.activeElement).trigger("blur"); break; case o.LEFT: this.props.onKeyboardUpdate("down"), t.preventDefault(); break; case o.RIGHT: this.props.onKeyboardUpdate("up"), t.preventDefault(); break; case o.PAGEDOWN: this.props.onKeyboardUpdate("bigdown"), t.preventDefault(); break; case o.PAGEUP: this.props.onKeyboardUpdate("bigup"), t.preventDefault(); break; case o.HOME: this.props.onKeyboardUpdate("min"), t.preventDefault(); break; case o.END: this.props.onKeyboardUpdate("max"), t.preventDefault() } }, d.prototype.onStartDrag = function (t) { if ("keyboard" !== t.device && t.target) { t.preventDefault(), i.default(); var e = { x: 0, y: 0 }; 1 === n(t.target).closest(".dcg-thumb").length ? e.x = this.pixelsFromValue(this.props.value()) : e.x = t.changedTouches[0].clientX - this.rootNode.getBoundingClientRect().left, this.dragDrop.startDrag(t, { origin: e }) } }, d.prototype.buildFocusManager = function () { return this.props.onFocusedChanged && this.props.isFocused ? this.const({ shouldBeFocused: this.props.isFocused, onFocusedChanged: this.props.onFocusedChanged }) : this.const(void 0) }, d }(s.Class); t.default = d });
define('expressions/slider_limits_view', ["require", "exports", "tslib", "jquery", "dcgview", "dcgview-helpers/static-mathquill-view", "dcgview-helpers/mathquill-view", "keys", "graphing-calc/models/expression", "core/lib/label", "core/types/slider-loop-modes", "main/mathquill-operators", "../shared-components/mathquill-braille-wrapper", "./expression_view"], function (require, e, t, n, i, o, r, l, s, a, d, c, u, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var h = i.Components.If, m = function (e) { function m() { return null !== e && e.apply(this, arguments) || this } return t.__extends(m, e), m.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, m.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-slider_menu dcg-mq-underline-container dcg-do-blur"), handleEvent: i.const("true"), didMount: function (t) { return e.node = t } }, i.createElement("div", { class: i.const("dcg-editable-mathquill-container") }, i.createElement(h, { predicate: function () { return !e.shouldOnlyShowStep() } }, function () { return i.createElement("span", null, i.createElement(u.default, t.__assign({ latex: function () { return e.model.slider.hardMin ? e.model.slider.min : "" }, ariaLabel: function () { return e.controller.raw("sldrmin") }, brailleShouldFocus: function () { return "min" === e.getFocusedInput() }, onBrailleInput: function (t) { return e.handleLatexChanged("min", t) }, hasError: function () { return !s.isSliderMinValid(e.model) }, onBrailleFocusedChanged: function (t, n) { return e.handleFocusedChanged("min", t, n) }, onBrailleKeydown: function (t) { return e.handleBrailleKeydown("min", t) }, selectOnFocus: e.const(!0), dataDCGLimit: e.const("slidermin") }, p.getBrailleWrapperProps(e.props.controller())), i.createElement(r.default, { latex: function () { return e.model.slider.hardMin ? e.model.slider.min : "" }, isFocused: function () { return "min" === e.getFocusedInput() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-slider-minimum") }, getAriaPostLabel: e.const(""), hasError: e.const(!1), onUserPressedKey: function (t, n) { return e.handlePressedKey("min", t, n) }, onUserChangedLatex: function (t) { return e.handleLatexChanged("min", t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t, n) { return e.handleFocusedChanged("min", t, n) }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, i.createElement("span", { class: function () { return { "dcg-math-field": !0, "dcg-focus": "min" === e.getFocusedInput(), "dcg-invalid": !s.isSliderMinValid(e.model) } }, "data-dcg-limit": i.const("slidermin") }))), i.createElement("span", { class: i.const("dcg-interval-interior") }, i.createElement(o.default, { latex: e.bindFn(e.getDependentLatex), config: e.const({}) }, i.createElement("span", null))), i.createElement(u.default, t.__assign({ latex: function () { return e.model.slider.hardMax ? e.model.slider.max : "" }, ariaLabel: function () { return e.controller.raw("sldrmax") }, brailleShouldFocus: function () { return "max" === e.getFocusedInput() }, onBrailleInput: function (t) { return e.handleLatexChanged("max", t) }, hasError: function () { return !s.isSliderMaxValid(e.model) }, onBrailleFocusedChanged: function (t, n) { return e.handleFocusedChanged("max", t, n) }, onBrailleKeydown: function (t) { return e.handleBrailleKeydown("max", t) }, selectOnFocus: e.const(!0), dataDCGLimit: e.const("slidermax") }, p.getBrailleWrapperProps(e.props.controller())), i.createElement(r.default, { latex: function () { return e.model.slider.hardMax ? e.model.slider.max : "" }, isFocused: function () { return "max" === e.getFocusedInput() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-slider-maximum") }, getAriaPostLabel: e.const(""), hasError: e.const(!1), onUserPressedKey: function (t, n) { return e.handlePressedKey("max", t, n) }, onUserChangedLatex: function (t) { return e.handleLatexChanged("max", t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t, n) { return e.handleFocusedChanged("max", t, n) }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, i.createElement("span", { class: function () { return { "dcg-math-field": !0, "dcg-focus": "max" === e.getFocusedInput(), "dcg-invalid": !s.isSliderMaxValid(e.model) } }, "data-dcg-limit": i.const("slidermax") })))) }), i.createElement("span", { class: function () { return { "dcg-slider-step-container": !e.shouldOnlyShowStep() } } }, i.createElement("span", { class: i.const("dcg-slider-step-label"), "aria-hidden": i.const("true") }, function () { return e.controller.s("graphing-calculator-label-slider-step") }), i.createElement(u.default, t.__assign({ latex: function () { return e.model.slider.step }, ariaLabel: function () { return e.controller.raw("sldrstp") }, brailleShouldFocus: function () { return "step" === e.getFocusedInput() }, onBrailleInput: function (t) { return e.handleLatexChanged("step", t) }, hasError: function () { return !s.isSliderStepValid(e.model) }, onBrailleFocusedChanged: function (t, n) { return e.handleFocusedChanged("step", t, n) }, onBrailleKeydown: function (t) { return e.handleBrailleKeydown("step", t) }, selectOnFocus: this.const(!0), dataDCGLimit: this.const("sliderstep") }, p.getBrailleWrapperProps(this.props.controller())), i.createElement(r.default, { latex: function () { return e.model.slider.step }, isFocused: function () { return "step" === e.getFocusedInput() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, selectOnFocus: this.const(!0), config: this.bindFn(this.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-slider-step") }, getAriaPostLabel: this.const(""), hasError: this.const(!1), onUserPressedKey: function (t, n) { return e.handlePressedKey("step", t, n) }, onUserChangedLatex: function (t) { return e.handleLatexChanged("step", t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t, n) { return e.handleFocusedChanged("step", t, n) }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, i.createElement("span", { class: function () { return { "dcg-math-field": !0, "dcg-focus": "step" === e.getFocusedInput(), "dcg-invalid": !s.isSliderStepValid(e.model) } }, "data-dcg-limit": i.const("sliderstep") })))))) }, m.prototype.handleBrailleKeydown = function (e, t) { var n = l.lookup(t); n && this.handlePressedKey(e, n, t) }, m.prototype.handlePressedKey = function (e, t, i) { if (this.controller.isInEditListMode() || this.shouldOnlyShowStep() || "Esc" !== t && "Enter" !== t) { var o = r.default.getFocusedMathquill(), l = u.getFocusedBrailleElement(); if ("Left" !== t && "Right" !== t && "Down" !== t && "Up" !== t) o && (o.keystroke(t, i), this.handleLatexChanged(e, o.latex())); else (o ? r.default.applyArrowKeyAndReturnIfWasAtBounds(o, t, i) : !(!l || !(0 === l.selectionStart && "Left" === t || l.selectionStart === n(l).val().length && "Right" === t || "Up" === t || "Down" === t))) && (i && i.preventDefault(), "Left" !== t || this.shouldOnlyShowStep() ? "Right" !== t || this.shouldOnlyShowStep() ? "Down" === t ? this.controller.dispatch({ type: "on-special-key-pressed", key: "Down" }) : "Up" === t && this.controller.dispatch({ type: "set-focus-location", location: { type: "expression", id: this.model.id } }) : "min" === e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: this.model.id, location: "max" } }) : "max" === e && this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: this.model.id, location: "step" } }) : "max" === e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: this.model.id, location: "min" } }) : "step" === e && this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: this.model.id, location: "max" } })) } else this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: this.id } }) }, m.prototype.shouldOnlyShowStep = function () { return this.model.slider.loopMode === d.SliderLoopMode.PLAY_INDEFINITELY }, m.prototype.handleLatexChanged = function (e, t) { "min" === e ? this.dispatchMinLatexIfChanged(t) : "max" === e ? this.dispatchMaxLatexIfChanged(t) : "step" === e && this.dispatchStepLatexIfChanged(t) }, m.prototype.handleFocusedChanged = function (e, t, n) { t && this.getFocusedInput() !== e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: this.id, location: e } }) : this.getFocusedInput() !== e || "none" !== this.controller.getBrailleMode() || n.relatedTarget && this.node.contains(n.relatedTarget) || this.controller.dispatch({ type: "blur-focus-location", location: { type: "slider-limit", id: this.id, location: e } }) }, m.prototype.dispatchMinLatexIfChanged = function (e) { this.model.slider.min !== e && this.controller.dispatch({ type: "set-slider-minlatex", id: this.id, latex: e }) }, m.prototype.dispatchMaxLatexIfChanged = function (e) { this.model.slider.max !== e && this.controller.dispatch({ type: "set-slider-maxlatex", id: this.id, latex: e }) }, m.prototype.dispatchStepLatexIfChanged = function (e) { this.model.slider.step !== e && this.controller.dispatch({ type: "set-slider-steplatex", id: this.id, latex: e }) }, m.prototype.getDependentLatex = function () { var e = s.getAssignment(this.model) || ""; return " \\le " + a.identifierToLatex(e) + " \\le " }, m.prototype.getFocusedInput = function () { var e = this.controller.getFocusLocation(); if (e && "slider-limit" === e.type && e.id === this.id) return e.location }, m.prototype.getMQConfig = function () { return { autoOperatorNames: c.getAutoOperators() } }, m }(i.Class); e.default = m });

define('loadcss!expressions/slider-view', function () { });
define('expressions/slider_view', ["require", "exports", "tslib", "jquery", "keys", "dcgview", "dcgview-helpers/slider", "./slider_limits_view", "dcgview-helpers/static-mathquill-view", "graphing-calc/models/expression", "core/types/slider-loop-modes", "loadcss!./slider-view"], function (require, t, e, i, o, n, r, l, s, d, c) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = n.Components.If, p = function (t) { function p() { return null !== t && t.apply(this, arguments) || this } return e.__extends(p, t), p.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, p.prototype.template = function () { var t = this; return n.createElement("span", { class: n.const("dcg-slider-container"), tapboundary: n.const("true"), onKeydown: function (e) { "Tab" !== o.lookup(e) || e.altKey || e.metaKey || e.ctrlKey || (e.shiftKey ? t.isSliderMinFocused() && t.controller.isInEditListMode() ? (null !== e.target && i(e.target).closest(".dcg-expressionitem").find('[tabindex="0"]:visible:first').trigger("focus"), e.preventDefault(), e.stopPropagation()) : t.isSliderThumbFocused() && (t.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: t.id, location: "step" } }), e.preventDefault(), e.stopPropagation()) : !e.shiftKey && t.isSliderStepFocused() && (t.controller.isInEditListMode() ? t.controller.dispatch({ type: "set-focus-location", location: { type: "slider-icon", id: t.id } }) : t.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: t.id } }), e.preventDefault(), e.stopPropagation())) } }, n.createElement(a, { predicate: function () { return t.shouldShowSlider() } }, function () { return n.createElement("div", { class: n.const("dcg-do-blur dcg-slider"), handleEvent: n.const("true") }, n.createElement("div", { class: n.const("dcg-minLabel dcg-template-minlabelhtml"), role: n.const("button"), tabindex: n.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-edit-slider-variable-limits", { variable: "none" === t.controller.getBrailleMode() ? '"' + d.getAssignment(t.model) + '"' : "" + d.getAssignment(t.model) }) }, onTap: function () { return t.onEditLimit("min") } }, n.createElement(s.default, { latex: function () { return d.getDisplaySliderMin(t.model) }, config: t.const({}) })), n.createElement(r.default, { min: function () { return d.getSliderMin(t.model) }, max: function () { return d.getSliderMax(t.model) }, step: function () { return d.getSliderStep(t.model) }, value: function () { return d.getSliderValue(t.model) }, ariaLabel: function () { return "none" === t.controller.getBrailleMode() ? '"' + d.getAssignment(t.model) + '"' : "" + d.getAssignment(t.model) }, onGrab: t.bindFn(t.onGrab), onDrop: t.bindFn(t.onDrop), onDragUpdate: t.bindFn(t.onDragUpdate), onKeyboardUpdate: t.bindFn(t.onKeyboardUpdate), onUpPress: function () { return t.controller.dispatch({ type: "on-special-key-pressed", key: "Up" }) }, onDownPress: function () { return t.controller.dispatch({ type: "on-special-key-pressed", key: "Down" }) }, onEnterPress: function () { return t.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" }) }, isFocused: t.bindFn(t.isSliderThumbFocused), onFocusedChanged: function (e) { e ? t.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: t.id } }) : t.controller.dispatch({ type: "blur-focus-location", location: { type: "slider-thumb", id: t.id } }) } }), n.createElement("div", { class: n.const("dcg-maxLabel dcg-template-maxlabelhtml"), onTap: function () { return t.onEditLimit("max") } }, n.createElement(s.default, { latex: function () { return d.getDisplaySliderMax(t.model) }, config: t.const({}) }))) }), n.createElement(a, { predicate: function () { return t.shouldShowLimitInputs() } }, function () { return n.createElement(l.default, { model: t.props.model, controller: t.props.controller }) })) }, p.prototype.onGrab = function () { this.dispatchIsDraggingIfChanged(!0) }, p.prototype.onDrop = function () { this.controller.dispatch({ type: "set-none-selected" }), this.dispatchIsPlayingIfChanged(!1), this.dispatchIsDraggingIfChanged(!1) }, p.prototype.onKeyboardUpdate = function (t) { this.controller.dispatch({ type: "adjust-slider-by-keyboard", id: this.id, adjustment: t }) }, p.prototype.onDragUpdate = function (t) { this.controller.dispatch({ type: "adjust-slider-by-dragging-thumb", id: this.model.id, target: t }) }, p.prototype.onEditLimit = function (t) { this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-limit", id: this.id, location: t } }) }, p.prototype.dispatchIsPlayingIfChanged = function (t) { this.model.slider.isPlaying !== t && this.controller.dispatch({ type: "set-slider-isplaying", id: this.id, isPlaying: t }) }, p.prototype.dispatchIsDraggingIfChanged = function (t) { this.model.sliderDragging !== t && this.controller.dispatch({ type: "set-slider-dragging", id: this.id, dragging: t }) }, p.prototype.shouldShowLimitInputs = function () { if (this.controller.isInEditListMode()) return !0; if (!d.isSliderMinValid(this.model)) return !0; if (!d.isSliderMaxValid(this.model)) return !0; if (!d.isSliderStepValid(this.model)) return !0; if (this.model.slider.loopMode === c.SliderLoopMode.PLAY_INDEFINITELY) return !0; var t = this.controller.getFocusLocation(); return !(!t || "slider-limit" !== t.type && "expression" !== t.type || t.id !== this.id) }, p.prototype.shouldShowSlider = function () { return !this.shouldShowLimitInputs() }, p.prototype.isSliderThumbFocused = function () { var t = this.controller.getFocusLocation(); return !(!t || "slider-thumb" !== t.type || t.id !== this.id) }, p.prototype.isSliderMinFocused = function () { var t = this.controller.getFocusLocation(); return !(!t || "slider-limit" !== t.type || t.id !== this.id || "min" !== t.location) }, p.prototype.isSliderStepFocused = function () { var t = this.controller.getFocusLocation(); return !(!t || "slider-limit" !== t.type || t.id !== this.id || "step" !== t.location) }, p }(n.Class); t.default = p });

define('loadcss!prompt-sliders', function () { });
define('expressions/promptslider_view', ["require", "exports", "tslib", "core/lib/label", "jquery", "lib/aria", "dcgview", "graphing-calc/models/list", "graphing-calc/models/ticker", "loadcss!prompt-sliders"], function (require, t, e, r, i, n, s, l, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = s.Components, c = a.For, d = a.If, u = function (t) { function a() { return null !== t && t.apply(this, arguments) || this } return e.__extends(a, t), a.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model() }, a.prototype.template = function () { var t = this; return s.createElement("div", { class: s.const("dcg-create-sliders dcg-action-createslider"), handleEvent: s.const("true"), onTap: this.bindFn(this.onCreateSlider) }, s.createElement("span", { class: s.const("dcg-msg") }, function () { return t.controller.s("graphing-calculator-label-add-slider") }), s.createElement("span", { class: s.const("btns") }, s.createElement(c, { each: function () { return t.getMissingVariables().slice(0, 4) } }, s.createElement("span", null, function (e) { return s.createElement("div", { class: s.const("dcg-slider-btn-container"), var_name: t.const(e) }, s.createElement("div", { role: s.const("button"), tabindex: s.const("0"), class: function () { return { "dcg-btn-slider": !0, "dcg-btn-blue": 1 === t.getMissingVariables().length, "dcg-btn-light-gray": 1 !== t.getMissingVariables().length } }, didMount: function (t) { t.innerHTML = r.identifierToHTML(e) } })) })), s.createElement(d, { predicate: function () { return t.getMissingVariables().length > 1 } }, function () { return s.createElement("div", { class: s.const("dcg-slider-btn-container dcg-all") }, s.createElement("div", { role: s.const("button"), tabindex: s.const("0"), class: s.const("dcg-btn-slider dcg-btn-blue") }, function () { return t.controller.s("graphing-calculator-button-slider-add-all-variables") })) }))) }, a.prototype.onCreateSlider = function (t) { if (this.controller.dispatch({ type: "set-none-selected" }), t.target) { var e = i(t.target).closest(".dcg-slider-btn-container"); if (e.length) { var r = e.hasClass("dcg-all"), n = r ? this.getMissingVariables() : [e.attr("var_name")]; if ("ticker" === this.model.type ? this.controller.dispatch({ type: "create-sliders-for-ticker", variables: this.getMissingVariables() }) : this.controller.dispatch({ type: "create-sliders-for-item", id: this.model.id, variables: n }), "keyboard" === t.device) { var s = this.model.id, l = this.props.controller().getItemSelectorById(s); if (!l) return; r ? this.controller.dispatch({ type: "move-focus-to-item", id: s }) : l.find(".dcg-btn-blue").trigger("focus") } } } }, a.prototype.getMissingVariables = function () { return "ticker" === this.model.type ? o.getMissingVariables(this.model) : l.getMissingVariablesForItem(this.model) }, a.prototype.didMount = function () { var t = this; this.promptAlertTimeout && clearTimeout(this.promptAlertTimeout), this.promptAlertTimeout = setTimeout(function () { for (var e = [], r = t.getMissingVariables(), i = 0; i < r.length; i++)e.push('"' + r[i] + '"'); n.alert(t.controller.s("graphing-calculator-narration-add-slider-prompt", { vars: e.join(",") })), t.promptAlertTimeout = 0 }, 2e3) }, a.prototype.didUnmount = function () { this.promptAlertTimeout && clearTimeout(this.promptAlertTimeout) }, a }(s.Class); t.default = u });

define('loadcss!expressions/label_view', function () { });

define('loadcss!toggle', function () { });
define('expressions/label_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/expression", "core/graphing-calc/json/expression", "loadcss!./label_view", "loadcss!toggle"], function (require, e, t, l, o, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var a = l.Components, i = a.Input, c = a.IfElse, r = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, l.createElement("div", { class: function () { return { "dcg-label-visible": e.getShowLabel(), "dcg-label-container": !0, "dcg-do-blur": !0 } }, tapboundary: l.const("true"), handleEvent: l.const("true") }, l.createElement("span", { role: l.const("checkbox"), "aria-checked": this.bindFn(this.getShowLabel), tabindex: l.const("0"), class: function () { return { "dcg-checkbox": !0, "dcg-checkbox-label-colon": e.getShowLabel() && !e.hasEditableLabel() } }, "aria-label": function () { return e.controller.s("graphing-calculator-button-label") }, onTap: this.bindFn(this.onCheckboxInput) }, l.createElement("span", { class: function () { return { "dcg-checkbox-box": !0, "dcg-checked": e.getShowLabel() } } }, l.createElement("i", { class: l.const("dcg-icon-check"), "aria-hidden": l.const("true") })), l.const("Â "), l.createElement("span", { class: l.const("dcg-checkbox-label"), "aria-hidden": l.const("true") }, function () { return e.controller.s("graphing-calculator-button-label") })), c(this.bindFn(this.hasEditableLabel), { true: function () { return l.createElement("div", { class: l.const("dcg-editable-mode-toggle") }, l.createElement("div", { class: l.const("dcg-option-toggle-view") }, l.createElement("div", { class: l.const("dcg-toggle-container") }, l.createElement("div", { class: l.const("dcg-toggle") }, l.createElement("div", { class: function () { return { "dcg-toggle-option": !0, "dcg-selected-toggle": e.model.editableLabelMode === n.EditableLabelMode.Math } }, role: l.const("button"), tabindex: l.const(0), "aria-pressed": function () { return e.model.editableLabelMode === n.EditableLabelMode.Math }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-editable-label-mode-editable-math") }, didMount: function (t) { void 0 !== e.lastToggleOption && "math" === e.lastToggleOption && (e.lastToggleOption = void 0, t.focus()) }, onTap: function () { e.lastToggleOption = "Editable Math", e.controller.dispatch({ type: "set-item-editable-label-mode", id: e.id, editableLabelMode: n.EditableLabelMode.Math }) } }, function () { return e.controller.s("graphing-calculator-button-editable-math") }), l.createElement("div", { class: function () { return { "dcg-toggle-option": !0, "dcg-selected-toggle": e.model.editableLabelMode === n.EditableLabelMode.Text } }, role: l.const("button"), tabindex: l.const(0), "aria-pressed": function () { return e.model.editableLabelMode === n.EditableLabelMode.Text }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-editable-label-mode-editable-text") }, didMount: function (t) { void 0 !== e.lastToggleOption && "text" === e.lastToggleOption && (e.lastToggleOption = void 0, t.focus()) }, onTap: function () { e.lastToggleOption = "Editable Text", e.controller.dispatch({ type: "set-item-editable-label-mode", id: e.id, editableLabelMode: n.EditableLabelMode.Text }) } }, function () { return e.controller.s("graphing-calculator-button-editable-text") }))))) }, false: function () { return l.createElement(i, { class: function () { return { "dcg-label-input": !0, "dcg-disabled-input": e.getIsDisabled(), "dcg-disabled-editable-input": e.hasEditableLabel() } }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-label-text") }, "aria-disabled": function () { return e.getIsDisabled() || e.hasEditableLabel() }, value: e.bindFn(e.getLabel), onInput: e.bindFn(e.onLabelInput) }) } })) }, a.prototype.getLabel = function () { return this.model.label || "" }, a.prototype.hasEditableLabel = function () { return o.hasEditableLabel(this.model) }, a.prototype.getShowLabel = function () { return !!this.model.showLabel }, a.prototype.getIsDisabled = function () { return 0 === this.getLabel().length && !this.getShowLabel() }, a.prototype.onLabelInput = function (e) { var t = e; this.controller.dispatch({ type: "set-item-label", id: this.id, label: t }), this.controller.dispatch({ type: "set-item-showlabel", id: this.id, showLabel: !!t }) }, a.prototype.onCheckboxInput = function () { this.controller.dispatch({ type: "set-item-showlabel", id: this.id, showLabel: !this.getShowLabel() }) }, a }(l.Class); e.default = r });

define('loadcss!dcgview-helpers/checkbox', function () { });
define('dcgview-helpers/checkbox', ["require", "exports", "tslib", "dcgview", "jquery", "loadcss!./checkbox"], function (require, e, s, c, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Checkbox = void 0; var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return s.__extends(r, e), r.prototype.template = function () { var e = this; return c.createElement("div", { class: function () { return { "dcg-component-checkbox": !0, "dcg-checked": e.props.checked(), "dcg-disabled": e.props.disabled && e.props.disabled(), "dcg-small": e.props.small && e.props.small(), "dcg-green": e.props.green && e.props.green() } }, onTap: this.bindFn(this.onChange) }, c.createElement("span", { tabindex: c.const(0), class: c.const("dcg-checkbox"), role: c.const("checkbox"), "aria-label": this.props.ariaLabel, "aria-disabled": function () { return e.props.disabled && e.props.disabled() }, "aria-checked": this.props.checked }, c.createElement("i", { class: c.const("dcg-icon-check"), "aria-hidden": c.const("true") })), c.createElement("span", { class: c.const("dcg-checkbox-children") }, this.children)) }, r.prototype.onChange = function (e) { e.target && t(e.target).attr("href") || this.props.disabled && this.props.disabled() || this.props.onChange(!this.props.checked()) }, r }(c.Class); e.Checkbox = r });

define('loadcss!expressions/cdf-footer-view', function () { });
define('expressions/cdf-footer-view', ["require", "exports", "tslib", "dcgview", "keys", "graphing-calc/models/expression", "dcgview-helpers/mathquill-view", "./evaluation-view", "main/mathquill-operators", "dcgview-helpers/checkbox", "../shared-components/mathquill-braille-wrapper", "./expression_view", "loadcss!./cdf-footer-view"], function (require, e, n, t, o, r, i, l, a, c, d, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var u = t.Components.If, p = function (e) { function p() { var n = null !== e && e.apply(this, arguments) || this; return n.focusedValues = {}, n } return n.__extends(p, e), p.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, t.createElement("div", { class: t.const("dcg-cdf-footer-container dcg-mq-underline-container dcg-do-blur"), tapboundary: t.const("true"), handleEvent: t.const("true") }, t.createElement(c.Checkbox, { checked: function () { return r.shouldShowCDFFooter(e.model) }, disabled: function () { return r.isListValuedDistribution(e.model) }, onChange: function (n) { e.controller.dispatch({ type: "set-show-cdf", id: e.model.id, showCDF: n }) }, ariaLabel: function () { return e.controller.s("graphing-calculator-button-find-cdf") } }, function () { return e.controller.s("graphing-calculator-button-find-cdf") }), t.createElement(u, { predicate: function () { return r.shouldShowCDFFooter(e.model) } }, function () { return t.createElement("div", null, t.createElement("span", { class: t.const("dcg-cdf-limit-name") }, function () { return e.controller.s("graphing-calculator-label-cdf-minimum") }), t.createElement(d.default, n.__assign({ latex: function () { return r.getCDFMin(e.model) }, hasError: function () { return !r.isCDFMinValid(e.model) }, brailleShouldFocus: function () { return e.isInputFocused("min") }, onBrailleFocusedChanged: function (n) { return e.handleFocusedChanged("min", n) }, ariaLabel: function () { return e.controller.s("graphing-calculator-narration-cdf-minimum") }, placeholder: function () { return r.getCDFMinPlaceholder(e.model) }, onBrailleInput: e.bindFn(e.updateCDFMin), onBrailleKeydown: function (n) { return e.handleBraillePressedKey(n, "min") } }, s.getBrailleWrapperProps(e.props.controller())), t.createElement(i.default, { latex: function () { return r.getCDFMin(e.model) }, hasError: function () { return !r.isCDFMinValid(e.model) }, isFocused: function () { return e.isInputFocused("min") }, onFocusedChanged: function (n) { return e.handleFocusedChanged("min", n) }, config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-cdf-minimum") }, getAriaPostLabel: function () { return "" }, placeholder: function () { return r.getCDFMinPlaceholder(e.model) }, onUserPressedKey: function (n, t) { return e.handlePressedKey(n, t, "min") }, onUserChangedLatex: e.bindFn(e.updateCDFMin), onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, capExpressionSize: function () { return e.model.controller.getCapExpressionSize() }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } })), t.createElement("span", { class: t.const("dcg-cdf-limit-name") }, function () { return e.controller.s("graphing-calculator-label-cdf-maximum") }), t.createElement(d.default, n.__assign({ latex: function () { return r.getCDFMax(e.model) }, hasError: function () { return !r.isCDFMaxValid(e.model) }, brailleShouldFocus: function () { return e.isInputFocused("max") }, onBrailleFocusedChanged: function (n) { return e.handleFocusedChanged("max", n) }, ariaLabel: function () { return e.controller.s("graphing-calculator-narration-cdf-maximum") }, placeholder: function () { return r.getCDFMaxPlaceholder(e.model) }, onBrailleInput: e.bindFn(e.updateCDFMax), onBrailleKeydown: function (n) { return e.handleBraillePressedKey(n, "max") } }, s.getBrailleWrapperProps(e.props.controller())), t.createElement(i.default, { latex: function () { return r.getCDFMax(e.model) }, hasError: function () { return !r.isCDFMaxValid(e.model) }, isFocused: function () { return e.isInputFocused("max") }, onFocusedChanged: function (n) { return e.handleFocusedChanged("max", n) }, config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-cdf-maximum") }, getAriaPostLabel: function () { return "" }, placeholder: function () { return r.getCDFMaxPlaceholder(e.model) }, onUserPressedKey: function (n, t) { return e.handlePressedKey(n, t, "max") }, onUserChangedLatex: e.bindFn(e.updateCDFMax), onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, capExpressionSize: function () { return e.model.controller.getCapExpressionSize() }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } })), t.createElement(u, { predicate: e.bindFn(e.showEvaluation) }, function () { return t.createElement("div", { class: t.const("dcg-cdf-evaluation-container") }, t.createElement(l.default, { val: function () { return r.getCDFEvaluation(e.model) }, controller: e.props.controller, dependent: e.const(""), id: function () { return e.model.id }, focusable: e.const(!0) })) })) })) }, p.prototype.handleBraillePressedKey = function (e, n) { var t = o.lookup(e); t && this.handlePressedKey(t, e, n) }, p.prototype.handlePressedKey = function (e, n, t) { if ("Esc" !== e) { if ("Enter" === e) return this.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" }); var o = i.default.getFocusedMathquill(); o && (o.keystroke(e, n), "min" === t && r.getCDFMin(this.model) !== o.latex() && this.updateCDFMin(o.latex()), "max" === t && r.getCDFMax(this.model) !== o.latex() && this.updateCDFMax(o.latex())) } else this.controller.dispatch({ type: "set-focus-location", location: void 0 }) }, p.prototype.updateCDFMax = function (e) { this.controller.dispatch({ type: "set-cdf-max", id: this.model.id, latex: e }) }, p.prototype.updateCDFMin = function (e) { this.controller.dispatch({ type: "set-cdf-min", id: this.model.id, latex: e }) }, p.prototype.showEvaluation = function () { return !!r.isCDFMaxValid(this.model) && !!r.isCDFMinValid(this.model) }, p.prototype.isInputFocused = function (e) { var n = this.controller.getFocusLocation(); return !(!n || "cdf-limit" !== n.type || n.id !== this.id) && n.location === e }, p.prototype.handleFocusedChanged = function (e, n) { n ? this.controller.dispatch({ type: "set-focus-location", location: { type: "cdf-limit", id: this.id, location: e } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "cdf-limit", id: this.id, location: e } }) }, p.prototype.getMQConfig = function () { return { autoOperatorNames: a.getAutoOperators({}) } }, p }(t.Class); e.default = p });

define('loadcss!expressions/parameter_suggestions_view', function () { });
define('expressions/parameters_suggestions_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/expression", "loadcss!./parameter_suggestions_view"], function (require, e, t, r, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ParametersSuggestionsView = void 0; var n = r.Components, i = n.If, s = n.For, o = n.SwitchUnion, l = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, n.prototype.template = function () { var e = this; return o(this.bindFn(this.getSuggestionType), { list: function () { return r.createElement(s, { each: e.bindFn(e.getListOfParameters) }, r.createElement("div", { class: function () { return { "dcg-parameter-suggestion-container": !0, "dcg-parameter-suggestion-braille": "none" !== e.controller.getBrailleMode() } } }, function (t) { return r.createElement("span", { class: r.const("dcg-parameter-name") }, function () { return e.getParamName(t) }) })) }, listWithDefault: function () { return r.createElement(s, { each: e.bindFn(e.getListOfParameters) }, r.createElement("div", { class: function () { return { "dcg-parameter-suggestion-container": !0, "dcg-parameter-suggestion-braille": "none" !== e.controller.getBrailleMode() } }, onTap: e.bindFn(e.fillInDefaults) }, function (t) { return r.createElement("span", { class: r.const("dcg-parameter-name") }, function () { return e.getParamName(t) }, r.createElement(i, { predicate: function () { return e.shouldShowDefaultValue(t) } }, function () { return r.createElement("span", { class: r.const("dcg-default-marker") }, r.const("= "), function () { return e.getDefaultValue(t) }) })) })) }, individual: function () { return r.createElement("div", { class: function () { return { "dcg-parameter-suggestion-container": !0, "dcg-parameter-suggestion-braille": "none" !== e.controller.getBrailleMode() } } }, e.bindFn(e.getMissingRequiredParamText)) }, none: function () { } }) }, n.prototype.getExtractedAndDefaultArgString = function (e) { var t = e.params, r = e.values, a = e.defaults; return t.map(function (e, t) { var n = r[e], i = a[t]; return n || i || "" }).join(",") }, n.prototype.fillInDefaults = function () { var e = a.parseToplevelFunction(this.model); if (e) { var t = e.symbol, r = e.span, n = r.input, i = r.start, s = r.end, o = "\\operatorname{" + t + "}\\left(" + this.getExtractedAndDefaultArgString(e) + "\\right)", l = "" + n.slice(0, i) + o + n.slice(s); this.controller.dispatch({ type: "set-item-latex", id: this.id, latex: l }), this.controller.dispatch({ type: "set-focus-location", location: { type: "expression", id: this.id } }), this.controller.dispatch({ type: "keypad/press-key", key: "Left" }) } }, n.prototype.isMissingDefault = function () { if (!a.isPrimaryLatexValid(this.model)) return !1; var e = a.parseToplevelFunction(this.model); if (!e) return !1; for (var t = 0; t < e.params.length; t++)if (this.shouldShowDefaultValue(e.params[t])) return !0; return !1 }, n.prototype.getSuggestionType = function () { return this.getListOfParameters().length > 1 ? this.isMissingDefault() ? "listWithDefault" : "list" : this.missingRequiredParam() ? "individual" : "none" }, n.prototype.missingRequiredParam = function () { var e = a.parseToplevelFunction(this.model); if (e && 1 === e.params.length) { var t = e.params[0]; if (!this.getDefaultValue(t) && !this.getParameterExtractedValue(t)) return t } }, n.prototype.getMissingRequiredParamText = function () { var e = this.missingRequiredParam(); return e ? this.controller.s("graphing-calculator-text-enter-pareneter", { param: this.getParamName(e) }) : "" }, n.prototype.getDefaultValue = function (e) { var t = a.parseToplevelFunction(this.model); if (!t || !t.params) return ""; for (var r = 0; r < t.params.length; r++)if (t.params[r] === e) return t.defaults[r] || ""; return "" }, n.prototype.getParameterExtractedValue = function (e) { var t = a.parseToplevelFunction(this.model); return t && t.values[e] || "" }, n.prototype.shouldShowDefaultValue = function (e) { return !this.getParameterExtractedValue(e) && !!this.getDefaultValue(e) }, n.prototype.getListOfParameters = function () { var e = a.parseToplevelFunction(this.model); return e ? e.params : [] }, n.prototype.getParamName = function (e) { switch (e) { case "mean": return this.controller.s("graphing-calculator-text-parameter-name-mean"); case "stdev": return this.controller.s("graphing-calculator-text-parameter-name-stddev"); case "dof": return this.controller.s("graphing-calculator-text-parameter-name-dof"); case "probsuccess": return this.controller.s("graphing-calculator-text-parameter-name-probsuccess"); case "trials": return this.controller.s("graphing-calculator-text-parameter-name-trials"); case "data": return this.controller.s("graphing-calculator-text-parameter-name-data"); case "binwidth": return this.controller.s("graphing-calculator-text-parameter-name-binwidth"); case "min": return this.controller.s("graphing-calculator-text-parameter-name-min"); case "max": return this.controller.s("graphing-calculator-text-parameter-name-max"); case "height": return this.controller.s("graphing-calculator-text-parameter-name-height"); case "offset": return this.controller.s("graphing-calculator-text-parameter-name-offset"); default: return e } }, n }(r.Class); e.ParametersSuggestionsView = l });

define('loadcss!expressions/distribution_parameters_view', function () { });
define('expressions/distribution_parameters_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/expression", "expressions/cdf-footer-view", "./parameters_suggestions_view", "loadcss!./distribution_parameters_view"], function (require, e, t, r, o, n, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var i = r.Components.If, l = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return t.__extends(l, e), l.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, r.createElement("div", { class: r.const("dcg-distribution-parameters-container dcg-mq-underline-container dcg-do-blur"), tapboundary: r.const("true"), handleEvent: r.const("true") }, r.createElement(s.ParametersSuggestionsView, { model: this.props.model, controller: this.props.controller }), r.createElement(i, { predicate: function () { return o.shouldShowCDFCheckbox(e.model) } }, function () { return r.createElement(n.default, { model: e.props.model, controller: e.props.controller }) })) }, l }(r.Class); e.default = l });

define('loadcss!expressions/visualization_parameters_view', function () { });
define('expressions/visualization_parameters_view', ["require", "exports", "tslib", "dcgview", "keys", "graphing-calc/models/expression", "dcgview-helpers/checkbox", "dcgview-helpers/mathquill-view", "./parameters_suggestions_view", "main/mathquill-operators", "../shared-components/mathquill-braille-wrapper", "./expression_view", "loadcss!./visualization_parameters_view", "loadcss!toggle"], function (require, e, t, n, r, o, a, i, l, s, c, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var u = n.Components.For, d = n.Components, g = d.SwitchUnion, h = d.If, m = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-toggle-container") }, n.createElement("div", { class: n.const("dcg-expression-footer-title") }, this.props.title, n.createElement(h, { predicate: function () { return !!e.props.helpLink } }, function () { return n.createElement("a", { "aria-label": function () { return e.props.controller().s("account-shell-link-help") }, class: n.const("dcg-expression-footer-title-help"), target: n.const("_blank"), href: e.props.helpLink }, n.createElement("i", { class: n.const("dcg-icon-question-sign"), "aria-hidden": n.const("true") })) })), n.createElement(u, { each: this.props.options, key: function (e) { return e.name } }, n.createElement("div", { class: n.const("dcg-toggle") }, function (t) { return n.createElement("div", { class: function () { return { "dcg-toggle-option": !0, "dcg-selected-toggle": e.isSelected(t.name) } }, role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return e.props.title() + ": " + t.displayName }, "aria-pressed": function () { return e.isSelected(t.name) }, onTap: function () { return e.props.controller().dispatch({ type: "set-visualization-prop", id: e.props.model().id, prop: e.props.vizProp(), value: t.name }) } }, function () { return t.displayName }) }))) }, r.prototype.isSelected = function (e) { return o.getVizProp(this.props.model(), this.props.vizProp()) === e }, r }(n.Class), f = function (e) { function u() { return null !== e && e.apply(this, arguments) || this } return t.__extends(u, e), u.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, n.createElement("div", { class: n.const("dcg-visualization-parameters-container dcg-mq-underline-container dcg-do-blur"), tapboundary: n.const("true"), handleEvent: n.const("true") }, n.createElement(l.ParametersSuggestionsView, t.__assign({}, this.props)), n.createElement("div", { class: n.const("dcg-smaller-font") }, g(function () { return e.getVisualizationType() }, { boxplot: function () { return n.createElement("div", null, n.createElement("div", { class: n.const("dcg-expression-footer-title") }, function () { return e.controller.s("graphing-calculator-heading-visual-parameters-display-properties") }), e.makeMQInput({ prop: "axisOffset", siblingProps: ["breadth"], default: "1", name: function () { return e.controller.s("graphing-calculator-narration-visual-parameters-offset") } }), e.makeMQInput({ prop: "breadth", siblingProps: ["axisOffset"], default: "1", name: function () { return "y" === o.getVizProp(e.model, "alignedAxis") ? e.controller.s("graphing-calculator-narration-visual-parameters-width") : e.controller.s("graphing-calculator-narration-visual-parameters-height") } }), n.createElement(a.Checkbox, { checked: function () { return !!o.getVizProp(e.model, "showBoxplotOutliers") }, onChange: e.bindFn(e.onToggleOutliers), ariaLabel: function () { return e.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers") } }, n.createElement("span", { class: n.const("dcg-parameter-name") }, function () { return e.controller.s("graphing-calculator-button-visual-parameters-exclude-outliers") }))) }, dotplot: function () { return n.createElement(h, { predicate: function () { return o.needsDotplotXMode(e.model) } }, function () { return n.createElement("div", { class: n.const("dcg-toggles-container") }, n.createElement(m, t.__assign({}, e.props, { vizProp: function () { return "dotplotXMode" }, options: function () { return [{ name: "exact", displayName: e.controller.s("graphing-calculator-button-visual-parameters-exact") }, { name: "bin", displayName: e.controller.s("graphing-calculator-button-visual-parameters-binned") }] }, title: function () { return e.controller.s("graphing-calculator-heading-visual-parameters-x-values") } })), n.createElement(m, t.__assign({}, e.props, { vizProp: function () { return "binAlignment" }, options: function () { return [{ name: "center", displayName: e.controller.s("graphing-calculator-button-visual-parameters-center") }, { name: "left", displayName: e.controller.s("graphing-calculator-button-visual-parameters-left") }] }, title: function () { return e.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment") } }))) }) }, histogram: function () { return n.createElement("div", { class: n.const("dcg-toggles-container") }, n.createElement(m, t.__assign({}, e.props, { vizProp: function () { return "histogramMode" }, options: function () { return [{ name: "", displayName: e.controller.s("graphing-calculator-button-visual-parameters-count") }, { name: "relative", displayName: e.controller.s("graphing-calculator-button-visual-parameters-relative") }, { name: "density", displayName: e.controller.s("graphing-calculator-button-visual-parameters-density") }] }, title: function () { return e.controller.s("graphing-calculator-heading-visual-parameters-bar-heights") }, helpLink: e.const("https://help.desmos.com/hc/en-us/articles/360022405991") })), n.createElement(m, t.__assign({}, e.props, { vizProp: function () { return "binAlignment" }, options: function () { return [{ name: "center", displayName: e.controller.s("graphing-calculator-button-visual-parameters-center") }, { name: "left", displayName: e.controller.s("graphing-calculator-button-visual-parameters-left") }] }, title: function () { return e.controller.s("graphing-calculator-heading-visual-parameters-bin-alignment") } }))) }, none: function () { return n.createElement("span", null) } }))) }, u.prototype.makeMQInput = function (e) { var r = this; return n.createElement("span", null, n.createElement("span", { class: n.const("dcg-parameter-name") }, e.name, n.const(":")), n.createElement(c.default, t.__assign({ latex: function () { return r.getPropLatex(e) }, ariaLabel: e.name, placeholder: function () { return e.default }, brailleShouldFocus: function () { return r.isInputFocused(e.prop) }, onBrailleInput: function (t) { return r.handleLatexChanged(e.prop, t) }, hasError: function () { return !o.isVizPropValid(r.model, e.prop) }, onBrailleFocusedChanged: function (t) { return r.handleFocusedChanged(e.prop, t) }, onBrailleKeydown: function (t) { return r.handleBraillePressedKey(t, e.prop) } }, p.getBrailleWrapperProps(this.props.controller())), n.createElement(i.default, { latex: function () { return r.getPropLatex(e) }, hasError: function () { return !o.isVizPropValid(r.model, e.prop) }, isFocused: function () { return r.isInputFocused(e.prop) }, onFocusedChanged: function (t) { return r.handleFocusedChanged(e.prop, t) }, placeholder: function () { return e.default }, config: this.bindFn(this.getMQConfig), getAriaLabel: e.name, onUserPressedKey: function (t, n) { return r.handlePressedKey(t, n, e.prop) }, getAriaPostLabel: function () { return "" }, onUserChangedLatex: function (t) { return r.handleLatexChanged(e.prop, t) }, onExpressionSizeExceeded: function () { return r.controller.dispatch({ type: "expression-size-exceeded" }) }, capExpressionSize: function () { return r.model.controller.getCapExpressionSize() }, needsSystemKeypad: function () { return !r.controller.isKeypadEnabled() } }))) }, u.prototype.handleBraillePressedKey = function (e, t) { var n = r.lookup(e); n && this.handlePressedKey(n, e, t) }, u.prototype.handlePressedKey = function (e, t, n) { if ("Esc" !== e) { if ("Enter" === e) return this.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" }); var r = i.default.getFocusedMathquill(); r && (r.keystroke(e, t), this.handleLatexChanged(n, r.latex())) } else this.controller.dispatch({ type: "set-focus-location", location: void 0 }) }, u.prototype.isInputFocused = function (e) { var t = this.controller.getFocusLocation(); return !(!t || "visualization-prop" !== t.type || t.id !== this.id) && t.location === e }, u.prototype.handleFocusedChanged = function (e, t) { t ? this.controller.dispatch({ type: "set-focus-location", location: { type: "visualization-prop", id: this.id, location: e } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "visualization-prop", id: this.id, location: e } }) }, u.prototype.getPropLatex = function (e) { var t = e.prop, n = o.getVizProp(this.model, t); return "string" == typeof n ? n : "" }, u.prototype.handleLatexChanged = function (e, t) { o.getVizProp(this.model, e) !== t && this.controller.dispatch({ type: "set-visualization-prop", id: this.id, prop: e, value: t }) }, u.prototype.onToggleOutliers = function () { var e = o.getVizProp(this.model, "showBoxplotOutliers"); this.controller.dispatch({ type: "set-visualization-prop", id: this.id, prop: "showBoxplotOutliers", value: !e }) }, u.prototype.getVisualizationType = function () { return o.isPrimaryLatexValid(this.model) ? o.isBoxPlot(this.model) ? "boxplot" : o.isDotPlot(this.model) ? "dotplot" : o.isHistogram(this.model) ? "histogram" : "none" : "none" }, u.prototype.getMQConfig = function () { return { autoOperatorNames: s.getAutoOperators() } }, u }(n.Class); e.default = f });

define('loadcss!expressions/ttest_footer_view', function () { });
define('expressions/ttest_footer_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/expression", "core/lib/number-to-latex", "dcgview-helpers/static-mathquill-view", "loadcss!./ttest_footer_view"], function (require, e, t, n, a, s, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, r.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-ttest-footer-container dcg-do-blur"), handleEvent: n.const("true") }, n.createElement("table", null, n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Less than: " + e.getLessThan() } }, n.createElement("span", { class: n.const("dcg-operator") }, n.createElement(l.default, { config: this.const({}), latex: this.const("<") })), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: function () { return e.getLessThan() } }))))), n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Greater than: " + e.getGreaterThan() } }, n.createElement("span", { class: n.const("dcg-operator") }, n.createElement(l.default, { config: this.const({}), latex: this.const(">") })), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: function () { return e.getGreaterThan() } }))))), n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Not equal: " + e.getNotEqual() } }, n.createElement("span", { class: n.const("dcg-operator") }, n.createElement(l.default, { config: this.const({}), latex: this.const("â ") })), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: function () { return e.getNotEqual() } }))))))) }, r.prototype.getLessThan = function () { var e = a.getTTestResults(this.model); return e ? s.numberToStatsConfidenceLatex(e.lessThan, 5) : "" }, r.prototype.getGreaterThan = function () { var e = a.getTTestResults(this.model); return e ? s.numberToStatsConfidenceLatex(e.greaterThan, 5) : "" }, r.prototype.getNotEqual = function () { var e = a.getTTestResults(this.model); return e ? s.numberToStatsConfidenceLatex(e.notEqual, 5) : "" }, r }(n.Class); e.default = r });

define('loadcss!expressions/stats_footer_view', function () { });
define('expressions/stats_footer_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/expression", "dcgview-helpers/static-mathquill-view", "core/lib/number-to-latex", "loadcss!./stats_footer_view"], function (require, e, t, n, a, l, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, n.createElement("div", { class: n.const("dcg-stats-footer-container dcg-do-blur"), handleEvent: n.const("true") }, n.createElement("table", null, n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Min: " + e.getMin() } }, n.createElement("span", { class: n.const("dcg-row-header") }, n.const("Min")), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: this.bindFn(this.getMin) }))))), n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Q1: " + e.getQ1() } }, n.createElement("span", { class: n.const("dcg-row-header") }, n.const("Q1")), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: this.bindFn(this.getQ1) }))))), n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Median: " + e.getMedian() } }, n.createElement("span", { class: n.const("dcg-row-header") }, n.const("Median")), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: this.bindFn(this.getMedian) }))))), n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Q3: " + e.getQ3() } }, n.createElement("span", { class: n.const("dcg-row-header") }, n.const("Q3")), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: this.bindFn(this.getQ3) }))))), n.createElement("tr", null, n.createElement("td", null, n.createElement("div", { class: n.const("dcg-value"), role: n.const("textbox"), "aria-readonly": n.const("true"), tabindex: n.const("0"), "aria-label": function () { return "Max: " + e.getMax() } }, n.createElement("span", { class: n.const("dcg-row-header") }, n.const("Max")), n.createElement("span", { class: n.const("dcg-evaluation") }, n.createElement(l.default, { config: this.const({}), latex: this.bindFn(this.getMax) }))))))) }, c.prototype.getMin = function () { var e = a.getStatsResults(this.model); return e ? s.numberToDecimalString(e.min) : "" }, c.prototype.getQ1 = function () { var e = a.getStatsResults(this.model); return e ? s.numberToDecimalString(e.q1) : "" }, c.prototype.getMedian = function () { var e = a.getStatsResults(this.model); return e ? s.numberToDecimalString(e.median) : "" }, c.prototype.getQ3 = function () { var e = a.getStatsResults(this.model); return e ? s.numberToDecimalString(e.q3) : "" }, c.prototype.getMax = function () { var e = a.getStatsResults(this.model); return e ? s.numberToDecimalString(e.max) : "" }, c }(n.Class); e.default = c });

define('loadcss!expressions/action-info-view', function () { });
define('expressions/action-info-view', ["require", "exports", "tslib", "dcgview", "main/mathquill-operators", "dcgview-helpers/static-mathquill-view", "loadcss!./action-info-view"], function (require, t, e, n, o, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return e.__extends(s, t), s.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model() }, s.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-action-info"), handleEvent: n.const("true") }, n.createElement("span", { class: n.const("dcg-action-label") }, n.const("Run ")), n.createElement(i.default, { latex: function () { return t.model.clickableInfo.latex }, config: this.bindFn(this.getMQConfig) }), n.createElement("span", { class: n.const("dcg-action-label") }, n.const(" on click")), n.createElement("span", { class: n.const("dcg-click-edit"), role: n.const("button"), tabindex: n.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-edit-action") }, onTap: this.bindFn(this.editAction) }, n.createElement("i", { class: n.const("dcg-icon-pencil"), "aria-hidden": n.const("true") }))) }, s.prototype.editAction = function () { "expression" === this.model.type ? this.controller.dispatch({ type: "toggle-item-settings-menu", menu: { type: "expression", model: this.model, guid: this.getMenuGUID(), focusFirstOption: !1 } }) : this.controller.dispatch({ type: "toggle-item-settings-menu", menu: { type: "image", model: this.model, guid: this.getMenuGUID(), focusFirstOption: !1 } }), this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-menu", id: this.model.id, location: "updaterule" } }) }, s.prototype.getMenuGUID = function () { return this.model.guid }, s.prototype.getMQConfig = function () { return { autoOperatorNames: o.getAutoOperators({ additionalOperators: ["index"] }), autoCommands: o.getAutoCommands() } }, s }(n.Class); t.default = s });

define('loadcss!expressions/expression-edit-actions', function () { });
define('expressions/expression-edit-actions', ["require", "exports", "tslib", "core/math/parser", "dcgview", "core/lib/dragmode", "core/types/styles", "graphing-calc/models/expression", "graphing-calc/models/abstract-item", "lib/aria", "../shared-components/tooltip", "loadcss!./expression-edit-actions"], function (require, e, t, n, o, i, r, l, a, s, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ExpressionEditActions = void 0; var d = o.Components.If, p = function (e) { function p() { return null !== e && e.apply(this, arguments) || this } return t.__extends(p, e), p.prototype.init = function () { this.controller = this.props.controller() }, p.prototype.template = function () { var e = this; return o.createElement(d, { predicate: function () { return e.controller.isInEditListMode() } }, function () { return o.createElement("span", { class: function () { return { "dcg-expression-edit-actions": !0, "dcg-limited-height": e.limitedHeight() } }, style: function () { return { background: e.controller.getBackgroundColor() } }, didMount: function () { e.controller.isInEditListMode() && s.alert(e.controller.s("graphing-calculator-narration-edit-list-mode-on")) }, didUnmount: function () { e.controller.isInEditListMode() || s.alert(e.controller.s("graphing-calculator-narration-edit-list-mode-off")) } }, o.createElement(d, { predicate: function () { return !e.controller.hasBackgroundColor() } }, function () { return o.createElement("span", { class: o.const("dcg-graphic"), handleEvent: o.const("true ") }) }), o.createElement(d, { predicate: e.bindFn(e.canConvertToTable) }, function () { return o.createElement(c.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-convert-to-table-tooltip") }, gravity: e.const("s") }, o.createElement("span", { class: o.const("dcg-action-createtable dcg-exp-action-button"), handleEvent: o.const("true"), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-label-convert-to-table-tooltip") }, onTap: e.bindFn(e.onCreateTable) }, o.createElement("i", { class: o.const("dcg-icon-table"), "aria-hidden": o.const("true") }))) }), o.createElement(c.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-duplicate-expression-tooltip") }, gravity: e.const("s") }, o.createElement("span", { class: o.const("dcg-duplicate-btn dcg-exp-action-button"), handleEvent: o.const("true"), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-label-duplicate-expression-tooltip") }, onTap: e.bindFn(e.onDuplicateWithoutFocus) }, o.createElement("i", { class: o.const("dcg-icon-duplicate"), "aria-hidden": o.const("true") }))), o.createElement(c.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-expression-delete-tooltip") }, gravity: e.const("sw") }, o.createElement("span", { class: o.const("dcg-delete-btn dcg-exp-action-button"), handleEvent: o.const("true"), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-label-expression-delete-tooltip") }, onTap: e.bindFn(e.onDelete) }, o.createElement("i", { class: o.const("dcg-icon-remove"), "aria-hidden": o.const("true") })))) }) }, p.prototype.model = function () { return this.controller.getItemModel(this.props.id()) }, p.prototype.canConvertToTable = function () { var e = this.model(); return !(!e || "expression" !== e.type || !e.formula.is_tableable) }, p.prototype.limitedHeight = function () { var e = this.model(); return e && ("image" === e.type || this.isSlider()) }, p.prototype.isSlider = function () { var e = this.model(); return e && "expression" === e.type && e.sliderExists }, p.prototype.generateSubscriptedTableColumns = function (e, t, o) { var i = { independent: t, dependent: o }; if ("x" === t) return i; if ("Identifier" !== n.parse(t).type) return i; var r = n.parse(o); if ("FunctionCall" !== r.type) return i; if (1 !== r.args.length) return i; var l = r.args[0]; if ("Identifier" !== l.type) return i; if (l._symbol !== t) return i; var a = r.getInputString(), s = l.getInputSpan(), c = a.substr(0, s.start), d = a.substr(s.end); return i.independent = "x_{" + e + "}", i.dependent = c + i.independent + d, i }, p.prototype.onCreateTable = function () { var e = this.model(); if (e && "expression" === e.type) { var t = e.formula; if (t.is_tableable && t.table_info) { var n, o = t.table_info, s = e.index, c = o.independent_variable, d = o.dependent_column; if (o.by_reference) { var p = this.generateSubscriptedTableColumns(this.controller.generateTableXSubscript(), c, d); c = p.independent, d = p.dependent } var u = [], h = []; if (o.values) for (n = 0; n < o.values.length; n++) { var g = o.values[n][0]; u.push(isNaN(g) ? "" : g + ""); var f = o.values[n][1]; h.push(isNaN(f) ? "" : f + "") } else for (n = -2; n <= 2; n++)u.push(n + ""), h.push(""); var b = { id: this.controller.generateId(), type: "table", columns: [{ id: this.controller.generateId(), latex: c, color: this.controller.getNextColor(), hidden: !1, values: u, points: !0, lines: !1, dragMode: i.DragMode.NONE, pointStyle: r.PointStyle.POINT, lineStyle: r.LineStyle.SOLID, colorLatex: "", lineOpacity: "", lineWidth: "", pointOpacity: "", pointSize: "" }, { id: this.controller.generateId(), latex: d, color: a.getDisplayColor(e), hidden: !1, values: h, points: !0, lines: !(l.isPointOrPointList(e) || e.hidden), dragMode: i.DragMode.NONE, pointStyle: r.PointStyle.POINT, lineStyle: r.LineStyle.SOLID, colorLatex: "", lineOpacity: "", lineWidth: "", pointOpacity: "", pointSize: "" }] }, y = this.controller; this.controller.dispatch({ type: "set-edit-list-mode", isEditListMode: !1, focusExpressionList: !1 }), o.by_reference ? this.controller.dispatch({ type: "insert-item-at-index", index: s + 1, state: b, folderId: e.folderId, focus: !0 }) : this.controller.dispatch({ type: "replace-item-at-index", index: s, state: b, focus: !0 }); this.controller.dispatch({ type: "toast/show", toast: { message: this.controller.s("graphing-calculator-text-table-created"), undoCallback: function () { y.dispatch({ type: "undo" }), y.dispatch({ type: "set-edit-list-mode", isEditListMode: !0, focusExpressionList: !1 }) } } }) } } }, p.prototype.onDelete = function (e) { this.controller.dispatch({ type: "delete-item-and-animate-out", id: this.props.id(), setFocusAfterDelete: "keyboard" === e.device }) }, p.prototype.onDuplicateWithoutFocus = function () { var e = this.model(); e && ("folder" === e.type ? this.controller.dispatch({ type: "duplicate-folder", id: this.props.id() }) : this.controller.dispatch({ type: "duplicate-expression", id: this.props.id() })) }, p }(o.Class); e.ExpressionEditActions = p });

define('loadcss!expressions/suggested-zoom-view', function () { });
define('expressions/suggested-zoom-view', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip", "loadcss!./suggested-zoom-view"], function (require, t, o, e, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SuggestedZoomView = void 0; var i = e.Components.If, r = function (t) { function r() { return null !== t && t.apply(this, arguments) || this } return o.__extends(r, t), r.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model() }, r.prototype.template = function () { var t = this; return e.createElement(i, { predicate: function () { return t.controller.shouldExpressionZoomFit(t.model) } }, function () { return e.createElement("div", { class: e.const("dcg-suggested-zoom-view dcg-do-blur"), handleEvent: e.const(!0) }, e.createElement(n.Tooltip, { tooltip: t.bindFn(t.getZoomText), gravity: function () { return "e" } }, e.createElement("i", { onTap: t.bindFn(t.onZoom), role: e.const("button"), "aria-label": t.bindFn(t.getZoomText), class: e.const("dcg-icon-zoom-fit") }))) }) }, r.prototype.getZoomText = function () { return this.controller.s("graphing-calculator-text-zoom-fit") }, r.prototype.onZoom = function () { this.controller.dispatch({ type: "expression-zoom-fit", id: this.model.id }) }, r }(e.Class); t.SuggestedZoomView = r });

define('loadcss!expressions/expression-footer', function () { });
define('expressions/expression_view', ["require", "exports", "config", "tslib", "browser", "keys", "jquery", "./abstract-item-view", "dcgview-helpers/mathquill-view", "dcgview-helpers/static-mathquill-view", "lib/conditional_blur", "./expression-icon-view", "./evaluation-view", "expressions/unresolved_view", "expressions/domain_view", "expressions/regression_view", "expressions/slider_view", "expressions/promptslider_view", "expressions/label_view", "expressions/distribution_parameters_view", "expressions/visualization_parameters_view", "expressions/ttest_footer_view", "expressions/stats_footer_view", "expressions/action-info-view", "graphing-calc/models/expression", "core/lib/label", "./expression-edit-actions", "./suggested-zoom-view", "dcgview", "main/manage-focus-helper", "main/mathquill-operators", "../shared-components/mathquill-braille-wrapper", "jquery.handleevent", "loadcss!./expression-footer"], function (require, e, t, o, r, n, i, l, s, a, c, d, u, p, h, m, f, g, y, b, v, x, E, w, S, F, _, L, I, M, B, T) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getBrailleWrapperProps = void 0; var A = I.Components, D = A.If, k = A.SwitchUnion, C = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return o.__extends(l, e), l.prototype.didMount = function () { this.onItemViewMounted(), this.lastBrailleMode = this.controller.getBrailleMode() }, l.prototype.didMountRootNode = function (e) { this.rootNode = e }, l.prototype.willUnmount = function () { this.onItemViewUnmounted() }, l.prototype.template = function () { var e = this; return I.createElement("div", { class: function () { return { "dcg-do-not-blur": !0, "dcg-expressionitem": !0, "dcg-mathitem": !0, "dcg-inFolder": !!e.model.folderId, "dcg-selected": e.controller.isItemSelected(e.id) && !e.controller.isInEditListMode(), "dcg-dragging": !!e.controller.isItemBeingDragged(e.id), "dcg-hasSlider": e.hasSlider(), "dcg-hasEvaluation": e.controller.shouldShowEvaluationForItem(e.id), "dcg-hasRegression": e.hasRegression(), "dcg-hasDomain": e.hasDomain() } }, "expr-id": function () { return e.model.id }, didMount: this.bindFn(this.didMountRootNode) }, I.createElement("div", { class: I.const("dcg-fade-container"), onTapStart: this.bindFn(this.onMouseSelect), onTap: this.bindFn(this.onMouseSelect) }, I.createElement("div", { class: I.const("dcg-main") }, I.createElement(D, { predicate: function () { return !e.controller.isInEditListMode() } }, function () { return I.createElement(T.default, o.__assign({ latex: function () { return S.getDisplayLatex(e.model) }, ariaLabel: function () { return e.getAriaLabel("braille") }, brailleShouldFocus: function () { return e.isFocused() }, onBrailleInput: function (t) { return e.handleLatexChanged(t) }, onBrailleFocusedChanged: function (t, o) { return e.handleMQFocusedChanged(t, o) }, onBrailleKeydown: e.bindFn(e.handleBraillePressedKey) }, P(e.controller)), I.createElement(s.default, { latex: function () { return S.getDisplayLatex(e.model) }, getAriaLabel: function () { return e.getAriaLabel("speech") }, getAriaPostLabel: e.bindFn(e.getFormulaAria), isFocused: function () { return e.isFocused() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, config: e.bindFn(e.getMQConfig), hasError: e.const(!1), onUserPressedKey: function (t, o) { return e.handlePressedKey(t, o) }, onUserChangedLatex: function (t) { return e.handleLatexChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t, o) { return e.handleMQFocusedChanged(t, o) }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, I.createElement("div", { class: I.const("dcg-expression-mathquill") }))) }), I.createElement(D, { predicate: function () { return e.controller.isInEditListMode() } }, function () { return I.createElement("div", { class: I.const("dcg-edit-list-mathquill"), tabindex: function () { return "none" === e.controller.getBrailleMode() ? "0" : "-1" }, onTap: e.bindFn(e.exitEditListMode), manageFocus: e.const({ shouldBeFocused: function () { return "none" === e.controller.getBrailleMode() && M.defaultShouldBeFocused({ controller: e.controller, location: { type: "readonly-expression", id: e.model.id } }) }, onFocusedChanged: function (t) { "none" === e.controller.getBrailleMode() && (t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "readonly-expression", id: e.model.id } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "readonly-expression", id: e.model.id } })) } }) }, I.createElement(T.default, o.__assign({ latex: function () { return S.getDisplayLatex(e.model) }, ariaLabel: function () { return e.getAriaLabel("braille") }, isStatic: e.const(!0), brailleShouldFocus: function () { var t = e.controller.getFocusLocation(); return !!t && ("readonly-expression" === t.type && t.id === e.id) }, onBrailleFocusedChanged: function (t) { t ? e.controller.dispatch({ type: "set-focus-location", location: { type: "readonly-expression", id: e.model.id } }) : e.controller.dispatch({ type: "blur-focus-location", location: { type: "readonly-expression", id: e.model.id } }) } }, P(e.controller)), I.createElement(a.default, { latex: function () { return S.getDisplayLatex(e.model) }, config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.getAriaLabel("speech") } }))) })), k(function () { return String(e.controller.shouldShowReplaceIcon()) }, { true: function () { return I.createElement("i", { class: I.const("dcg-icon-replace"), handleEvent: I.const("true"), onTap: e.bindFn(e.onRenameInItem), "aria-hidden": I.const("true") }) }, false: function () { return I.createElement("i", { class: I.const("dcg-icon-remove dcg-top-level-delete"), handleEvent: I.const("true"), onTap: e.bindFn(e.onDelete), "aria-hidden": I.const("true") }) } }), I.createElement(D, { predicate: this.bindFn(this.shouldShowFooter) }, function () { return I.createElement("div", { class: e.getFooterClass() }, k(function () { return e.getFooterType() }, { none: function () { }, regression: function () { return I.createElement(m.default, { model: e.props.model, controller: e.props.controller }) }, label: function () { return I.createElement(y.default, { model: e.props.model, controller: e.props.controller }) }, slider: function () { return I.createElement(f.default, { model: e.props.model, controller: e.props.controller }) }, domain: function () { return I.createElement(h.default, { model: e.props.model, controller: e.props.controller }) }, evaluation: function () { return I.createElement(u.default, { id: function () { return e.props.model().id }, dependent: function () { return S.getAssignment(e.model) || "" }, val: function () { return e.controller.getEvaluationValueForItem(e.id) }, controller: e.props.controller, focusable: e.const(!1) }) }, distribution: function () { return I.createElement(b.default, { model: e.props.model, controller: e.props.controller }) }, visualization: function () { return I.createElement(v.default, { model: e.props.model, controller: e.props.controller }) }, ttest: function () { return I.createElement(x.default, { model: e.props.model, controller: e.props.controller }) }, stats: function () { return I.createElement(E.default, { model: e.props.model, controller: e.props.controller }) }, unresolved: function () { return I.createElement(p.default, { controller: e.props.controller }) } }), I.createElement(D, { predicate: e.bindFn(e.shouldShowBrailleError) }, function () { return I.createElement("div", { tabindex: I.const(0), class: I.const("dcg-expression-braille-error"), role: I.const("button"), "aria-roledescription": I.const("error"), "aria-label": function () { return e.controller.unpack(e.model.error) } }, I.createElement("i", { class: I.const("dcg-icon-error"), "aria-hidden": I.const("true") }), function () { return e.controller.unpack(e.model.error) }) }), I.createElement(D, { predicate: e.bindFn(e.shouldShowSliderPrompt) }, function () { return I.createElement(g.default, { model: e.props.model, controller: e.props.controller }) })) }), I.createElement(D, { predicate: this.bindFn(this.shouldShowActionInfo) }, function () { return I.createElement("div", { class: e.getFooterClass() }, I.createElement(w.default, { model: e.props.model, controller: e.props.controller })) })), I.createElement("span", { class: I.const("dcg-tab dcg-action-drag dcg-action-icon-touch"), handleevent: I.const("true"), tapboundary: I.const("true"), disablescroll: I.const("true"), style: I.const("touch-action:none"), onTapStart: this.bindFn(this.onDragPending) }, I.createElement("span", { class: I.const("dcg-num") }, function () { return e.model.displayIndex }), I.createElement("div", { class: I.const("dcg-tab-interior dcg-action-icon-mouse") }, I.createElement(d.default, { model: this.props.model, controller: this.props.controller })), I.createElement(L.SuggestedZoomView, { model: this.props.model, controller: this.props.controller })), I.createElement(_.ExpressionEditActions, { controller: this.props.controller, id: function () { return e.model.id } })) }, l.prototype.didUpdate = function () { this.lastBrailleMode = this.controller.getBrailleMode() }, l.prototype.shouldShowFooter = function () { return !!this.shouldShowBrailleError() || (!!this.shouldShowSliderPrompt() || "none" !== this.getFooterType()) }, l.prototype.getFooterType = function () { return this.hasRegression() ? "regression" : this.shouldShowLabelView() ? "label" : this.hasSlider() ? "slider" : this.hasDomain() ? "domain" : this.isTTest() ? "ttest" : this.isStats() ? "stats" : this.controller.shouldShowEvaluationForItem(this.id) ? "evaluation" : this.isToplevelDistribution() ? "distribution" : this.isVisualization() ? "visualization" : this.model.unresolved ? "unresolved" : "none" }, l.prototype.getFooterClass = function () { return this.isFirstRender() ? this.const("dcg-expression-bottom dcg-indent-in-folder") : this.const("dcg-expression-bottom dcg-indent-in-folder dcg-fadein-bottom") }, l.prototype.onCreateSliders = function (e) { this.controller.dispatch({ type: "create-sliders-for-item", id: this.id, variables: e }) }, l.prototype.shouldShowLabelView = function () { return t.get("labels") && S.isPointOrPointList(this.model) }, l.prototype.shouldShowSliderPrompt = function () { return !!this.controller.areSlidersEnabled() && S.getMissingVariables(this.model).length > 0 }, l.prototype.shouldShowActionInfo = function () { return !!(this.controller.areActionsEnabled() && this.model.clickableInfo && this.model.clickableInfo.enabled && this.model.clickableInfo.latex) }, l.prototype.shouldShowBrailleError = function () { return "none" !== this.controller.getBrailleMode() && this.hasError() }, l.prototype.hasRegression = function () { return !(!this.model.formula || !this.model.formula.is_regression) }, l.prototype.hasDomain = function () { return S.hasDomain(this.model) }, l.prototype.isToplevelDistribution = function () { return S.isToplevelDistribution(this.model) }, l.prototype.isVisualization = function () { return S.isVisualization(this.model) }, l.prototype.isTTest = function () { return S.isTTest(this.model) }, l.prototype.isStats = function () { return S.isStats(this.model) }, l.prototype.hasSlider = function () { return !!this.model.sliderExists }, l.prototype.getLabelOptions = function () { return this.controller.getEvaluationLabelOptionsForItem(this.model.id) }, l.prototype.getAriaLabel = function (e) { var t; return this.shouldShowLabelView() ? (t = this.model.label && "" !== this.model.label ? this.model.label : "speech" === e ? this.controller.s("graphing-calculator-narration-expression-label") : this.controller.raw("lbl"), this.model.showLabel ? t : "speech" === e ? this.controller.s("graphing-calculator-narration-expression-hidden-label", { label: t }) : this.controller.raw("h __label__", { label: t })) : "speech" === e ? this.controller.s("shared-calculator-narration-expression-index", { index: this.model.displayIndex }) : this.controller.raw("eq__index__", { index: this.model.displayIndex }) }, l.prototype.getFormulaAria = function () { var e = this.model.formula, t = ""; if (!e) return t; if (S.isEmpty(this.model)) return t; if (this.controller.shouldShowEvaluationForItem(this.id)) { t = "equals "; var o = e.zero_values && e.zero_values.length ? e.zero_values[0].val : e.constant_value; Array.isArray(o) ? t += o.length + " element list." : void 0 !== o && (t += F.truncatedAriaLabel(+o, this.getLabelOptions())) } else e.error && !this.shouldShowSliderPrompt() ? t = this.controller.unpack(e.error) : S.isToplevelDistribution(this.model) ? t = this.controller.s("graphing-calculator-narration-expression-evaluation-is-distribution") : this.isTTest() && (t = this.controller.s("graphing-calculator-narration-expression-evaluation-is-t-test")); if (this.model.shouldGraph && (e.is_graphable || e.is_regression)) { e.is_graphable && e.is_regression ? t += " " + this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph-and-regression") : e.is_regression ? t += " " + this.controller.s("graphing-calculator-narration-expression-evaluation-has-regression") : t += " " + this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"); var n = this.controller.getAudioGraph(); n && n.agNavigator.canTrace(this.model) && (r.IS_APPLE ? t += " " + this.controller.s("graphing-calculator-narration-expression-audio-trace-mac") : t += " " + this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")) } return t }, l.prototype.handleBraillePressedKey = function (e) { var t = n.lookup(e); if (t) if ("Esc" === t) c.default(), this.hasSlider() && this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: this.model.id } }); else if ("Up" === t || "Down" === t || "Enter" === t) this.controller.dispatch({ type: "on-special-key-pressed", key: t }); else if ("Del" === t || "Backspace" === t) { var o = T.getFocusedBrailleElement(); S.isEmpty(this.model) && T.brailleInputIsEmpty(o) && (this.controller.dispatch({ type: "on-special-key-pressed", key: "Del" === t ? "Delete" : t }), e.preventDefault(), e.stopPropagation()) } }, l.prototype.handlePressedKey = function (e, t) { var o = s.default.getFocusedMathquill(); if (o) { if ("Esc" === e) return c.default(), void (this.hasSlider() && this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: this.model.id } })); if ("Up" === e || "Down" === e) return s.default.applyArrowKeyAndReturnIfWasAtBounds(o, e, t) ? this.controller.dispatch({ type: "on-special-key-pressed", key: e }) : void 0; if ("Delete" === e || "Backspace" === e) { if (S.isEmpty(this.model)) return this.controller.dispatch({ type: "on-special-key-pressed", key: e }) } else if ("Enter" === e) return t && (t.preventDefault(), t.stopPropagation()), this.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" }); o.keystroke(e, t), this.handleLatexChanged(o.latex()) } }, l.prototype.handleLatexChanged = function (e) { e !== this.model.latex && this.controller.dispatch({ type: "set-item-latex", id: this.id, latex: e }) }, l.prototype.doesNodeBelongToSliderLimit = function (e) { return !!e && (!!this.rootNode.contains(e) && !!i(e).closest("[data-dcg-limit]").length) }, l.prototype.handleMQFocusedChanged = function (e, t) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "expression", id: this.id } }) : this.doesNodeBelongToSliderLimit(t.relatedTarget) || this.lastBrailleMode !== this.controller.getBrailleMode() || this.controller.dispatch({ type: "blur-focus-location", location: { type: "expression", id: this.id } }) }, l.prototype.onMouseSelect = function (e) { "keyboard" !== e.device && ("dcg-tap" === e.type && "mouse" === e.device || "dcg-tapstart" === e.type && "touch" === e.device || e.wasHandled() || (e.handle(), this.controller.dispatch({ type: "set-focus-location", location: { type: "expression", id: this.id } }))) }, l.prototype.isFocused = function () { var e = this.controller.getFocusLocation(); return !!e && ("expression" === e.type && e.id === this.id) }, l.prototype.isSliderThumbFocused = function () { var e = this.controller.getFocusLocation(); return !!e && ("slider-thumb" === e.type && e.id === this.id) }, l.prototype.hasError = function () { return !!this.model.error && !S.isEmpty(this.model) }, l.prototype.getMQConfig = function () { return { autoOperatorNames: B.getAutoOperators({}) } }, l }(l.default); function P(e, t) { var r = function (e) { return I.createElement(a.default, { config: function () { return {} }, latex: function () { return e } }) }; return { tooltipOptions: function () { return o.__assign({ latexView: r }, t || {}) }, sixKeyInput: function () { return e.getSixKeyInput() }, mode: function () { return e.getBrailleMode() }, capExpressionSize: function () { return e.getCapExpressionSize() ? { exceedsLimit: function (e) { return e.length > s.EXPRESSION_TOKEN_LIMIT }, onExpressionSizeExceeded: function () { return e.dispatch({ type: "expression-size-exceeded" }) } } : void 0 } } } e.default = C, e.getBrailleWrapperProps = P });

define('loadcss!expressions/smart_textarea', function () { });
define('expressions/smart_textarea', ["require", "exports", "tslib", "keys", "browser", "dcgview", "jquery", "lib/conditional_blur", "jquery.handleevent", "loadcss!./smart_textarea"], function (require, e, t, o, n, i, a, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = i.Components.Textarea, p = function (e) { function p() { return null !== e && e.apply(this, arguments) || this } return t.__extends(p, e), p.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-smart-textarea-container") }, i.createElement("div", { class: i.const("dcg-displayTextarea dcg-fixed-width-element"), didMount: this.bindFn(this.didMountDisplay) }), i.createElement(r, { class: function () { return { "dcg-do-blur": !0, "dcg-fixed-width-element": !0, "dcg-smart-textarea": !0, "dcg-empty": !e.props.text() } }, "aria-label": function () { return e.props.ariaLabel ? e.props.ariaLabel() : void 0 }, placeholder: this.props.placeholder, readonly: function () { return !!e.props.readonly() || void 0 }, value: this.props.text, onInput: this.props.onInput, didMount: this.bindFn(this.didMountTextarea), onKeydown: this.bindFn(this.onKeydownEvent) })) }, p.prototype.getDisplayTextHTML = function () { var e = this.props.text() || "", t = function (t, o) { return e.slice(t, o).replace(/</g, "&lt;").replace(/>/g, "&gt;") }, o = 0, n = ""; if (this.props.showLinks()) for (var i = /(\b(https?|ftp):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, a = null; null !== (a = i.exec(e));) { var s = a[0]; n += t(o, a.index), n += "<a rel='nofollow ugc' href='" + s + "' target ='_blank'>" + s + "</a>", o = i.lastIndex } return n += t(o) }, p.prototype.willUnmount = function () { this.textareaNode = void 0 }, p.prototype.didMountDisplay = function (e) { this.displayNode = e, a(e).on("touchend", function (e) { e.preventDefault() }), a(e).on("dcg-tap dcg-tapstart", "a", function (e) { e.handle() }), this.renderDisplayText() }, p.prototype.didMountTextarea = function (e) { var t = this; this.textareaNode = e, a(e).on("dcg-tapstart", function (e) { e.handle() }), a(e).on("focusin focusout", function () { return t.onFocusEvent() }), this.updateFocused() }, p.prototype.didUpdate = function () { this.updateFocused(), this.renderDisplayText() }, p.prototype.onFocusEvent = function () { if (this.textareaNode) { var e = document.activeElement === this.textareaNode; this.shouldBeFocused() !== e && this.props.onFocusChange(e) } }, p.prototype.renderDisplayText = function () { if (this.displayNode) { var e = this.getDisplayTextHTML(); this.lastDisplayTextHTML !== e && (this.lastDisplayTextHTML = e, this.displayNode.innerHTML = e) } }, p.prototype.isFocused = function () { return document.activeElement === this.textareaNode }, p.prototype.shouldBeFocused = function () { return this.props.shouldFocus() }, p.prototype.updateFocused = function () { if (this.textareaNode) { var e = this.isFocused(), t = this.shouldBeFocused(); if (e !== t) if (t) { if (n.IS_IPAD && n.IS_IN_IFRAME) return; this.textareaNode.focus(), this.textareaNode.selectionStart = this.textareaNode.selectionEnd = this.textareaNode.value.length } else this.textareaNode.blur() } }, p.prototype.onKeydownEvent = function (e) { var t = this.textareaNode; if (t) { var n = o.lookup(e); this.props.readonly() && void 0 !== this.props.readonlyAction ? e.altKey || e.ctrlKey || e.metaKey || e.shiftKey || n !== o.ENTER && n !== o.SPACEBAR || (e.preventDefault(), this.props.readonlyAction()) : (n !== o.ENTER || e.metaKey ? n === o.ESCAPE ? s.default() : n === o.UP ? 0 !== t.selectionStart || 0 !== t.selectionEnd || e.altKey || e.metaKey || (e.preventDefault(), this.props.onSpecialKey("Up")) : n === o.DOWN ? t.selectionStart !== t.value.length || t.selectionEnd !== t.value.length || e.altKey || e.metaKey || (e.preventDefault(), this.props.onSpecialKey("Down")) : n === o.BACKSPACE ? 0 === t.value.length && (e.preventDefault(), this.props.onSpecialKey("Backspace")) : n === o.DELETE && 0 === t.value.length && (e.preventDefault(), this.props.onSpecialKey("Delete")) : (e.preventDefault(), this.props.onSpecialKey("Enter")), this.props.onKeydown && this.props.onKeydown(e)) } }, p }(i.Class); e.default = p });
define('expressions/text_view', ["require", "exports", "tslib", "./abstract-item-view", "./smart_textarea", "dcgview", "./expression-edit-actions", "jquery.handleevent"], function (require, t, e, n, o, i, c) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.didMount = function () { this.onItemViewMounted() }, n.prototype.willUnmount = function () { this.onItemViewUnmounted() }, n.prototype.template = function () { var t = this; return i.createElement("div", { class: function () { return { "dcg-do-not-blur": !0, "dcg-expressionitem": !0, "dcg-expressiontext": !0, "dcg-inFolder": !!t.model.folderId, "dcg-selected": !!t.controller.isItemSelected(t.id), "dcg-dragging": !!t.controller.isItemBeingDragged(t.id) } }, "expr-id": function () { return t.model.id }, onTapStart: this.bindFn(this.onMouseSelect), onTap: this.bindFn(this.onMouseSelect) }, i.createElement("div", { class: i.const("dcg-fade-container") }, i.createElement("div", { class: i.const("dcg-main") }, i.createElement(o.default, { shouldFocus: this.bindFn(this.isFocused), text: function () { return t.model.text }, placeholder: function () { return t.controller.s("graphing-calculator-text-enter-note-placeholder") }, showLinks: function () { return t.controller.areLinksEnabled() }, onInput: this.bindFn(this.onInput), onFocusChange: this.bindFn(this.onFocusChange), onSpecialKey: this.bindFn(this.onSpecialKey), readonly: function () { return t.controller.isInEditListMode() }, readonlyAction: this.bindFn(this.exitEditListMode) })), i.createElement("i", { class: i.const("dcg-icon-remove dcg-top-level-delete"), handleEvent: i.const("true"), onTap: this.bindFn(this.onDelete), "aria-hidden": i.const("true") })), i.createElement("span", { class: i.const("dcg-tab dcg-action-drag"), handleevent: i.const("true"), tapboundary: i.const("true"), disablescroll: i.const("true"), style: i.const("touch-action:none"), onTapStart: this.bindFn(this.onDragPending) }, i.createElement("span", { class: i.const("dcg-num") }, function () { return t.model.displayIndex }), i.createElement("div", { class: i.const("dcg-tab-interior") }), i.createElement("i", { class: i.const("dcg-icon-text"), "aria-hidden": i.const("true") })), i.createElement(c.ExpressionEditActions, { controller: this.props.controller, id: function () { return t.model.id } })) }, n.prototype.onInput = function (t) { this.controller.dispatch({ type: "set-note-text", id: this.id, text: t }) }, n.prototype.onFocusChange = function (t) { t ? this.controller.dispatch({ type: "set-focus-location", location: { type: "text", id: this.id } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "text", id: this.id } }) }, n.prototype.onSpecialKey = function (t) { return this.controller.dispatch({ type: "on-special-key-pressed", key: t }) }, n.prototype.isFocused = function () { var t = this.controller.getFocusLocation(); return !(!t || "text" !== t.type || t.id !== this.id) }, n }(n.default); t.default = s });
define('expressions/tables/table_icon_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/abstract-item", "dcgview-helpers/tooltipped-error", "../circular-icon-view", "main/manage-focus-helper", "jquery.handleevent"], function (require, t, e, o, n, r, i, l) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = o.Components.SwitchUnion, c = function (t) { function c() { return null !== t && t.apply(this, arguments) || this } return e.__extends(c, t), c.prototype.init = function () { this.model = this.props.model(), this.controller = this.props.controller() }, c.prototype.template = function () { var t = this; return o.createElement("div", { class: o.const("dcg-table-icon-container") }, s(this.bindFn(this.typeOfIcon), { error: function () { return o.createElement(r.TooltippedError, { error: function () { return t.controller.unpack(t.model.error) }, gravity: t.const("se") }) }, none: function () { return o.createElement("span", null) }, icon: function () { return o.createElement("div", { class: o.const("dcg-circular-icon-container"), role: o.const("button"), tabindex: o.const("0"), "aria-label": t.bindFn(t.getIconAriaLabel), handleevent: o.const("true"), "dcg-open-menu-guid": function () { return t.getMenuGUID() }, onTap: function (e) { if (!e.wasHandled("dragdrop") && !e.wasLongheld()) return t.myOptionsOpen() || t.controller.isInEditListMode() || e.shiftKey ? t.toggleOptions() : void t.toggleGraphShown() }, onLongHold: function (e) { e.handle("dcg-longhold"), e.handle("dcg-tap"), t.toggleOptions() }, manageFocus: t.const(l.manageFocusHelper({ controller: t.controller, location: { type: "table-icon", id: t.model.table.id, columnId: t.model.id } })) }, o.createElement(i.CircularIconView, { iconType: t.bindFn(t.getIcon), backgroundColor: t.bindFn(t.getModelColor) })) } })) }, c.prototype.getModelColor = function () { return n.getMaybeGradientDisplayColor(this.model) }, c.prototype.getMenuGUID = function () { return this.model.guid }, c.prototype.myOptionsOpen = function () { return this.controller.isItemSettingsMenuOpen(this.getMenuGUID()) }, c.prototype.toggleOptions = function () { this.controller.dispatch({ type: "toggle-item-settings-menu", menu: { type: "table-column", model: this.model, guid: this.getMenuGUID(), focusFirstOption: !1 } }) }, c.prototype.toggleGraphShown = function () { this.controller.dispatch({ type: "toggle-tablecolumn-hidden", tableId: this.model.table.id, columnId: this.model.id }) }, c.prototype.hasError = function () { return !!this.model.error }, c.prototype.getIcon = function () { return this.model.shouldGraph ? this.controller.isInEditListMode() ? "none" : this.model.points && this.model.lines ? "table-points-and-lines" : this.model.points && !this.model.lines ? "table-points" : !this.model.points && this.model.lines ? "table-lines" : "none" : "hidden" }, c.prototype.typeOfIcon = function () { return "" === this.model.latex ? "none" : this.controller.getGraphSettings().config.graphpaper ? this.model.error ? "error" : 0 === this.model.index ? "none" : "icon" : "none" }, c.prototype.getIconAriaLabel = function () { return this.myOptionsOpen() ? this.controller.s("graphing-calculator-narration-hide-options") : this.controller.isInEditListMode() ? this.controller.s("graphing-calculator-narration-show-options") : this.model.shouldGraph ? this.controller.s("graphing-calculator-narration-hide-table-column") : this.controller.s("graphing-calculator-narration-show-table-column") }, c }(o.Class); t.default = c });
define('expressions/tables/header-view', ["require", "exports", "tslib", "keys", "jquery", "browser", "dcgview", "./table_icon_view", "dcgview-helpers/mathquill-view", "dcgview-helpers/static-mathquill-view", "underscore", "graphing-calc/models/table", "core/lib/dragmode", "main/mathquill-operators", "../../shared-components/mathquill-braille-wrapper", "../expression_view"], function (require, e, t, n, o, l, r, i, a, c, s, d, u, h, p, g) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var f = r.Components.If, m = function (e) { function m() { return null !== e && e.apply(this, arguments) || this } return t.__extends(m, e), m.prototype.init = function () { this.model = this.props.model(), this.controller = this.props.controller(), this.table = this.model.table }, m.prototype.isRightSide = function () { return this.lookupCellPosition().column >= this.table.columnModels.length - 1 }, m.prototype.template = function () { var e = this; return r.createElement("div", { class: function () { return { "dcg-cell": !0, "dcg-table-header": !0, "dcg-do-not-blur": !0, "dcg-left": 0 === e.model.index, "dcg-right": e.isRightSide(), "dcg-selected": e.shouldFocus(), "dcg-error": !!e.model.error } }, index: function () { return e.model.index }, onTapStart: this.bindFn(this.focusThisCell) }, r.createElement("div", { class: r.const("dcg-inner-border") }), r.createElement(f, { predicate: function () { return !e.isRightSide() } }, function () { return r.createElement(i.default, { model: e.props.model, controller: e.props.controller }) }), r.createElement("div", { role: r.const("columnheader") }, r.createElement(f, { predicate: function () { return !e.controller.isInEditListMode() } }, function () { return r.createElement(p.default, t.__assign({ latex: function () { return e.model.latex || "" }, brailleShouldFocus: e.bindFn(e.shouldFocus), ariaLabel: function () { return e.getAriaLabel("braille") }, onBrailleInput: function (t) { return e.handleLatexChanged(t) }, onBrailleFocusedChanged: e.bindFn(e.handleMQFocusedChanged), selectOnFocus: e.const(!0), onBrailleKeydown: e.bindFn(e.handleKeydownOnBrailleInput) }, g.getBrailleWrapperProps(e.props.controller(), { gravity: "s" })), r.createElement(a.default, { latex: function () { return e.model.latex || "" }, isFocused: e.bindFn(e.shouldFocus), capExpressionSize: function () { return e.controller.getCapExpressionSize() }, config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.getAriaLabel("speech") }, getAriaPostLabel: e.bindFn(e.getAriaPostLabel), hasError: e.const(!1), onUserPressedKey: function (t, n) { return e.handlePressedKey(t, n) }, onUserChangedLatex: function (t) { return e.handleLatexChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: e.bindFn(e.handleMQFocusedChanged), selectOnFocus: e.const(!0), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, r.createElement("span", { class: r.const("dcg-math-field dcg-cell-math-content") }))) }), r.createElement(f, { predicate: function () { return e.controller.isInEditListMode() } }, function () { return r.createElement(p.default, t.__assign({ latex: function () { return e.model.latex || "" }, ariaLabel: function () { return e.getAriaLabel("braille") }, onBrailleInput: function (t) { return e.handleLatexChanged(t) }, tabindex: e.const(-1), isStatic: e.const(!0), brailleShouldFocus: e.bindFn(e.shouldFocusNonEditCell), onBrailleFocusedChanged: e.bindFn(e.handleMQFocusedChanged) }, g.getBrailleWrapperProps(e.props.controller(), { gravity: "s" })), r.createElement(c.default, { latex: function () { return e.model.latex || "" }, config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.getAriaLabel("speech") } }, r.createElement("span", { class: r.const("dcg-math-field dcg-cell-math-content"), role: r.const("textbox"), "aria-roledescription": r.const("cell"), "aria-readonly": r.const("true"), tabindex: r.const("-1") }))) }), r.createElement(f, { predicate: function () { return e.model.dragMode !== u.DragMode.NONE && !e.model.error } }, function () { return r.createElement("span", { class: r.const("dcg-drag-icon"), "dcg-drag-mode": function () { return e.model.dragMode }, style: function () { return { color: e.model.color } } }, r.createElement("i", { class: function () { return { "dcg-icon-move": e.model.dragMode === u.DragMode.XY, "dcg-icon-move-horizontal": e.model.dragMode === u.DragMode.X, "dcg-icon-move-vertical": e.model.dragMode === u.DragMode.Y } } })) })), r.createElement("div", { class: r.const("dcg-empty-line") }), r.createElement(f, { predicate: function () { return e.isRightSide() } }, function () { return r.createElement("span", { class: r.const("dcg-fade-right") }) })) }, m.prototype.focusThisCell = function (e) { e.wasHandled() || (e.handle(), this.shouldFocus() || this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.table.id, location: this.lookupCellPosition() } })) }, m.prototype.lookupCellPosition = function () { return { row: 0, column: this.model.index } }, m.prototype.getAriaLabel = function (e) { var t = this.lookupCellPosition(); return "speech" === e ? this.controller.s("graphing-calculator-narration-table-column-header", { column: t.column + 1 }) : this.controller.raw("h__column__", { column: t.column + 1 }) }, m.prototype.getAriaPostLabel = function () { var e = "", t = this.model; return t.shouldGraph && (t.points || t.lines) && !d.isColumnEmpty(t) && (e = this.controller.s("graphing-calculator-narration-expression-evaluation-has-graph"), l.IS_APPLE ? e += " " + this.controller.s("graphing-calculator-narration-expression-audio-trace-mac") : e += " " + this.controller.s("graphing-calculator-narration-expression-audio-trace-windows")), e }, m.prototype.handlePressedKey = function (e, t) { var n = a.default.getFocusedMathquill(); n && (a.default.handleKeystrokeAndDecideIfSpecialEvent(n, e, t) ? this.controller.dispatch({ type: "navigate-table-by-key", id: this.table.id, key: e }) : this.handleLatexChanged(n.latex())) }, m.prototype.handleKeydownOnBrailleInput = function (e) { var t = n.lookup(e); if (t) { var l = "Enter" === t || "Up" === t || "Down" === t, r = p.getFocusedBrailleElement(), i = r && "Left" === t && 0 === r.selectionStart || "Right" === t && r.selectionStart === o(r).val().length, a = 0 === this.model.latex.length && p.brailleInputIsEmpty(r); (l || i || ("Del" === t || "Backspace" === t) && a) && (this.controller.dispatch({ type: "navigate-table-by-key", id: this.table.id, key: "Del" === t ? "Delete" : t }), e.preventDefault()) } }, m.prototype.handleLatexChanged = function (e) { this.model.latex !== e && this.controller.dispatch({ type: "set-tablecell-latex", tableId: this.table.id, cell: this.lookupCellPosition(), latex: e }) }, m.prototype.shouldFocus = function () { return !this.controller.isInEditListMode() && s.isEqual(this.lookupCellPosition(), d.getSelectedCell(this.table)) }, m.prototype.shouldFocusNonEditCell = function () { return s.isEqual(this.lookupCellPosition(), d.getSelectedCell(this.table)) }, m.prototype.isNodeWithinTableCell = function (e) { if (!e) return !1; if (0 === o(e).closest(".dcg-cell").length) return !1; var t = this.controller.getItemRootNodeById(this.table.id); return !!t && o.contains(t, e) }, m.prototype.handleMQFocusedChanged = function (e, t) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.table.id, location: this.lookupCellPosition() } }) : this.isNodeWithinTableCell(t.relatedTarget) || this.controller.dispatch({ type: "blur-focus-location", location: { type: "table", id: this.table.id, location: this.lookupCellPosition() } }) }, m.prototype.getMQConfig = function () { return { autoOperatorNames: h.getAutoOperators() } }, m }(r.Class); e.default = m });
define('expressions/tables/cell-view', ["require", "exports", "tslib", "keys", "dcgview", "jquery", "dcgview-helpers/mathquill-view", "dcgview-helpers/static-mathquill-view", "underscore", "graphing-calc/models/table", "../../dcgview-helpers/tooltipped-error", "lib/conditional_blur", "main/mathquill-operators", "../../shared-components/mathquill-braille-wrapper", "../expression_view"], function (require, e, t, n, o, l, r, i, a, s, c, d, u, h, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var g = o.Components.If, b = function (e) { function b() { return null !== e && e.apply(this, arguments) || this } return t.__extends(b, e), b.prototype.init = function () { this.model = this.props.model(), this.controller = this.props.controller(), this.table = this.model.column.table }, b.prototype.template = function () { var e = this; return o.createElement("div", { class: function () { return { "dcg-cell": !0, "dcg-do-not-blur": !0, "dcg-empty": e.isEmpty(), "dcg-non-editable": !!e.model.column.disabled, "dcg-error": !!e.hasError(), "dcg-selected": e.shouldFocus() } }, onTapStart: this.bindFn(this.focusThisCell) }, o.createElement("div", { class: o.const("dcg-inner-border") }), o.createElement("div", { role: o.const("gridcell") }, o.createElement(g, { predicate: this.bindFn(this.hasError) }, function () { return o.createElement("span", { class: o.const("dcg-table-icon-error-container") }, o.createElement(c.TooltippedError, { error: e.bindFn(e.getErrorMessage), gravity: e.const("se"), size: e.const("small") })) }), o.createElement(g, { predicate: function () { return !!e.model.column.disabled || e.controller.isInEditListMode() } }, function () { return o.createElement(h.default, t.__assign({ latex: function () { return e.getValue() }, brailleShouldFocus: e.bindFn(e.shouldFocusReadonlyCell), ariaLabel: function () { return e.getAriaLabel("braille") }, tabindex: function () { return e.controller.isInEditListMode() ? -1 : 0 }, isStatic: e.const(!0), onBrailleFocusedChanged: e.bindFn(e.handleFocusedChanged), onBrailleKeydown: function (t) { return e.handleKeydownOnReadonlyCell(t), !0 } }, p.getBrailleWrapperProps(e.props.controller(), { gravity: "s" })), o.createElement(i.default, { getAriaLabel: function () { return e.getAriaLabel("speech") }, latex: function () { return e.getValue() }, config: e.bindFn(e.getMQConfig) }, o.createElement("span", { class: o.const("dcg-math-field dcg-cell-math-content dcg-mathquill-input-span"), role: o.const("textbox"), "aria-roledescription": o.const("computed cell"), "aria-readonly": o.const("true"), tabindex: function () { return e.controller.isInEditListMode() || e.isEmpty() ? -1 : 0 }, onKeyDown: e.bindFn(e.handleKeydownOnReadonlyCell), manageFocus: e.const({ shouldBeFocused: e.bindFn(e.shouldFocusReadonlyCell), onFocusedChanged: e.bindFn(e.handleFocusedChanged) }) }))) }), o.createElement(g, { predicate: function () { return !e.model.column.disabled && !e.controller.isInEditListMode() } }, function () { return o.createElement(h.default, t.__assign({ latex: function () { return e.getValue() }, brailleShouldFocus: e.bindFn(e.shouldFocusEditableCell), ariaLabel: function () { return e.getAriaLabel("braille") }, onBrailleInput: function (t) { return e.handleLatexChanged(t) }, onBrailleFocusedChanged: e.bindFn(e.handleFocusedChanged), onBrailleKeydown: e.bindFn(e.handleKeydownOnBrailleInput), selectOnFocus: e.const(!0) }, p.getBrailleWrapperProps(e.props.controller(), { gravity: "s" })), o.createElement(r.default, { latex: function () { return e.getValue() }, isFocused: e.bindFn(e.shouldFocusEditableCell), capExpressionSize: function () { return e.controller.getCapExpressionSize() }, config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.getAriaLabel("speech") }, getAriaPostLabel: e.bindFn(e.getErrorMessage), hasError: e.const(!1), onUserPressedKey: function (t, n) { return e.handlePressedKey(t, n) }, onUserChangedLatex: function (t) { return e.handleLatexChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: e.bindFn(e.handleFocusedChanged), selectOnFocus: e.const(!0), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, o.createElement("span", { class: o.const("dcg-math-field dcg-cell-math-content") }))) })), o.createElement("div", { class: o.const("dcg-empty-line") })) }, b.prototype.focusThisCell = function (e) { e.wasHandled() || (e.handle(), this.shouldFocus() || this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.table.id, location: this.lookupCellPosition() } })) }, b.prototype.handlePressedKey = function (e, t) { var o = r.default.getFocusedMathquill(); if (o) { var l = r.default.handleKeystrokeAndDecideIfSpecialEvent(o, e, t); e === n.ESCAPE && d.default(), l ? this.controller.dispatch({ type: "navigate-table-by-key", id: this.table.id, key: e }) : this.handleLatexChanged(o.latex()) } }, b.prototype.handleKeydownOnBrailleInput = function (e) { var t = n.lookup(e); if (t) { t === n.ESCAPE && d.default(); var o = "Enter" === t || "Up" === t || "Down" === t, r = h.getFocusedBrailleElement(), i = r && "Left" === t && 0 === r.selectionStart || "Right" === t && r.selectionStart === l(r).val().length; (o || i || ("Del" === t || "Backspace" === t) && 0 === this.getValue().length) && (this.controller.dispatch({ type: "navigate-table-by-key", id: this.table.id, key: "Del" === t ? "Delete" : t }), e.preventDefault()) } }, b.prototype.handleKeydownOnReadonlyCell = function (e) { var t = n.lookup(e); "Tab" !== t && (e.preventDefault(), "Esc" === t && d.default(), t && this.controller.dispatch({ type: "navigate-table-by-key", id: this.table.id, key: t })) }, b.prototype.handleLatexChanged = function (e) { this.getValue() !== e && this.controller.dispatch({ type: "set-tablecell-latex", tableId: this.table.id, cell: this.lookupCellPosition(), latex: e }) }, b.prototype.shouldFocus = function () { return a.isEqual(this.lookupCellPosition(), s.getSelectedCell(this.table)) }, b.prototype.shouldFocusReadonlyCell = function () { return !this.controller.isInEditListMode() && !!this.model.column.disabled && this.shouldFocus() }, b.prototype.shouldFocusEditableCell = function () { return !this.model.column.disabled && this.shouldFocus() }, b.prototype.isNodeWithinTableCell = function (e) { if (!e) return !1; if (0 === l(e).closest(".dcg-cell").length) return !1; var t = this.controller.getItemRootNodeById(this.table.id); return !!t && l.contains(t, e) }, b.prototype.handleFocusedChanged = function (e, t) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.table.id, location: this.lookupCellPosition() } }) : this.isNodeWithinTableCell(t.relatedTarget) || this.controller.dispatch({ type: "blur-focus-location", location: { type: "table", id: this.table.id, location: this.lookupCellPosition() } }) }, b.prototype.lookupCellPosition = function () { return { row: this.model.row.index, column: this.model.column.index } }, b.prototype.getPackedError = function () { return this.model.column.packedErrors[this.model.row.index - 1] }, b.prototype.hasError = function () { return !!this.getPackedError() }, b.prototype.getErrorMessage = function () { var e = this.getPackedError(); return e ? this.controller.unpack(e) : "" }, b.prototype.getValue = function () { var e = this.model.column.index, t = this.model.row.index - 1; return this.model.column.disabled ? this.model.column.computedValues[t] || "" : this.table.columns[e].values[t] || "" }, b.prototype.isEmpty = function () { var e = h.getFocusedBrailleElement(); return "" === this.getValue() && h.brailleInputIsEmpty(e) }, b.prototype.getAriaLabel = function (e) { var t = this.lookupCellPosition(), n = t.row, o = t.column + 1; return "speech" === e ? this.controller.s("graphing-calculator-narration-table-row-column", { row: n.toString(), column: o.toString() }) : this.controller.raw("r__row__c__column__", { row: n.toString(), column: o.toString() }) }, b.prototype.getMQConfig = function () { return { autoOperatorNames: u.getAutoOperators() } }, b }(o.Class); e.default = b });

define('loadcss!expressions/table-view', function () { });
define('expressions/table-view', ["require", "exports", "tslib", "keys", "lib/aria", "./abstract-item-view", "dcgview", "./tables/header-view", "./tables/cell-view", "graphing-calc/models/table", "vendor/mathquill", "jquery", "./expression-edit-actions", "expressions/measure-expressions", "./suggested-zoom-view", "main/manage-focus-helper", "loadcss!./table-view", "jquery.handleevent"], function (require, e, t, o, n, l, r, i, s, c, a, d, u, p, h, g) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var m = r.Components, f = m.For, w = m.SwitchUnion, y = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return t.__extends(l, e), l.prototype.didMount = function () { this.onItemViewMounted() }, l.prototype.willUnmount = function () { this.onItemViewUnmounted() }, l.prototype.template = function () { var e = this; return r.createElement("div", { class: function () { return { "dcg-expressionitem": !0, "dcg-expressiontable": !0, "dcg-inFolder": !!e.model.folderId, "dcg-selected": !!e.controller.isItemSelected(e.id), "dcg-dragging": !!e.controller.isItemBeingDragged(e.id), "dcg-no-faded-h": e.isRightFocused(), "dcg-no-faded-v": e.isBottomFocused() } }, "expr-id": function () { return e.model.id }, didMount: this.bindFn(this.didMountContainer), onKeydown: this.bindFn(this.onKeydown) }, r.createElement("div", { class: r.const("dcg-fade-container dcg-disable-horizontal-scroll-to-cursor") }, r.createElement("div", { class: r.const("dcg-main") }, r.createElement("div", { class: r.const("dcg-table-container"), tabindex: function () { return e.controller.isInEditListMode() ? 0 : -1 }, "aria-label": function () { return e.controller.getBrailleMode(), e.controller.s("graphing-calculator-narration-expression-index-table", { index: e.model.displayIndex }) }, didMount: this.bindFn(this.didMountContainer), manageFocus: this.const({ shouldBeFocused: this.shouldBeFocused.bind(this), onFocusedChanged: this.onFocusedChanged.bind(this) }) }, r.createElement("div", { class: r.const("dcg-table-sliding-container"), style: function () { return { transform: "translateX(" + e.computeScrolledX() + "px)" } } }, r.createElement(f, { each: function () { return e.getVisibleRowModels() }, key: function (t) { return "blank-row" === t.type ? "blank-row-" + t.guid + "-" + t.rows + "-" + e.getCols() : t.guid } }, r.createElement("div", { role: r.const("grid"), class: function () { return { "dcg-tabledata": !0, "dcg-focus-in-bottom-row": e.isBottomFocused(), "dcg-focus-in-right-column": e.isRightFocused() } } }, function (t) { return "show-more" === t.type ? r.createElement("tr", { role: r.const("row"), class: r.const("dcg-show-more-row") }, r.createElement("td", { colspan: e.bindFn(e.getCols) }, e.bindFn(e.missingRowMessage), r.createElement("div", { tabindex: r.const(0), role: r.const("button"), class: r.const("dcg-show-more"), onTap: function () { return e.controller.dispatch({ type: "table-show-more-rows", id: e.id }) } }, function () { return e.controller.s("graphing-calculator-button-show-all-table-rows") }))) : "blank-row" === t.type ? r.createElement("tr", { role: r.const("row"), class: r.const("dcg-blank-row") }, r.createElement("td", { colspan: e.bindFn(e.getCols), style: function () { return { height: t.rows * e.getRowHeight() + "px" } } })) : r.createElement(f, { each: function () { return t.cells }, key: function (e) { return e.guid } }, r.createElement("tr", { role: r.const("row"), "aria-rowindex": function () { return t.index }, class: function () { return { "dcg-row": t, "dcg-braille-row": "none" !== e.controller.getBrailleMode() } } }, function (t) { return "header" === t.type ? r.createElement(i.default, { controller: e.props.controller, model: e.const(t) }) : r.createElement(s.default, { controller: e.props.controller, model: e.const(t) }) })) }))))), w(function () { return String(e.controller.shouldShowReplaceIcon()) }, { true: function () { return r.createElement("i", { class: r.const("dcg-icon-replace"), handleEvent: r.const("true"), onTap: e.bindFn(e.onRenameInItem) }) }, false: function () { return r.createElement("i", { class: r.const("dcg-icon-remove dcg-top-level-delete"), handleEvent: r.const("true"), onTap: e.bindFn(e.onDelete) }) } })), r.createElement("span", { class: r.const("dcg-tab dcg-action-drag"), handleevent: r.const("true"), tapboundary: r.const("true"), disablescroll: r.const("true"), style: r.const("touch-action:none"), onTapStart: this.bindFn(this.onDragPending) }, r.createElement("span", { class: r.const("dcg-num") }, function () { return e.model.displayIndex }), r.createElement("div", { class: r.const("dcg-tab-interior") }), r.createElement(h.SuggestedZoomView, { model: this.props.model, controller: this.props.controller })), r.createElement(u.ExpressionEditActions, { controller: this.props.controller, id: function () { return e.model.id } })) }, l.prototype.getCols = function () { return this.model.rowModels[0].cells.length - 1 }, l.prototype.getRowHeight = function () { return this.controller.getGraphSettings().config.projectorMode ? 38 : 33 }, l.prototype.getVisibleRowModels = function () { var e = this.model.rowModels; if (e.length <= 25) return e; var t = c.getCollapsedRange(this.model); if (void 0 !== t) { var o = e.slice(0, t.min); return (o = o.concat({ type: "show-more", guid: "show-more" })).concat(e.slice(t.max)) } var n = p.getExppanelRect(this.controller), l = n ? n.height : 0, r = d(this.node).offset(), i = (r ? r.top : 0) - (n ? n.top : 0), s = d(this.node).find(".dcg-row:eq(0)").height(), a = this.getRowHeight(); if (l / a > e.length) return e; for (var u = [], h = (-i - s) / a, g = (l - i) / a, m = 0; m < e.length; m++) { var f = c.getSelectedCell(this.model); if (0 === m || m === e.length - 2 || f && f.row === m) u.push(e[m]); else if (m > g || m < h) { var w = u[u.length - 1]; w && "blank-row" === w.type ? w.rows++ : u.push({ type: "blank-row", guid: e[m].guid, rows: 1 }) } else u.push(e[m]) } return u }, l.prototype.missingRowMessage = function () { var e = c.getCollapsedRange(this.model); return void 0 === e ? "" : this.controller.s("graphing-calculator-text-table-more-rows", { rowCount: e.max - e.min }) }, l.prototype.didMountContainer = function (e) { this.node = e, d(e).on("scroll", function () { return e.scrollLeft = 0 }) }, l.prototype.getSelectedCell = function () { return c.getSelectedCell(this.model) }, l.prototype.computeScrolledX = function () { if (!this.getSelectedCell() || !this.node) return 0; var e = this.node.children[0], t = this.node.querySelector(".dcg-selected"); if (null === e || null === t) return 0; var o = this.node.getBoundingClientRect(), n = t.getBoundingClientRect(), l = n.left - e.getBoundingClientRect().left, r = o.width - l - n.width - 80, i = Math.min(0, o.width - e.scrollWidth - 30); return r = Math.max(r, i), Math.min(0, r) }, l.prototype.isBottomFocused = function () { var e = this.getSelectedCell(); return !!e && e.row === this.model.columnModels[0].cells.length }, l.prototype.isRightFocused = function () { var e = this.getSelectedCell(); return !!e && e.column === this.model.columnModels.length - 1 }, l.prototype.isFocused = function () { return !!this.getSelectedCell() }, l.prototype.onKeydown = function (e) { this.controller.isInEditListMode() || !e.ctrlKey || e.shiftKey || e.altKey || e.metaKey || ("Up" === o.lookup(e) ? (e.preventDefault(), e.stopPropagation(), this.moveToFirstCellInColumn()) : "Down" === o.lookup(e) ? (e.preventDefault(), e.stopPropagation(), this.moveToLastCellInColumn()) : "Left" === o.lookup(e) ? (e.preventDefault(), e.stopPropagation(), this.moveToFirstCellInRow()) : "Right" === o.lookup(e) ? (e.preventDefault(), e.stopPropagation(), this.moveToLastCellInRow()) : "H" === o.lookupChar(e) && (e.preventDefault(), e.stopPropagation(), this.speakColumnHeader())) }, l.prototype.moveToFirstCellInColumn = function () { var e = this.getSelectedCell(); e && this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.id, location: { row: 0, column: e.column } } }) }, l.prototype.moveToLastCellInColumn = function () { var e = this.getSelectedCell(); e && this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.id, location: { row: this.model.rowModels.length - 1, column: e.column } } }) }, l.prototype.moveToFirstCellInRow = function () { var e = this.getSelectedCell(); e && this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.id, location: { row: e.row, column: 0 } } }) }, l.prototype.moveToLastCellInRow = function () { var e = this.getSelectedCell(); e && this.controller.dispatch({ type: "set-focus-location", location: { type: "table", id: this.id, location: { row: e.row, column: this.model.columnModels[0].cells.length - 1 } } }) }, l.prototype.speakColumnHeader = function () { var e = this.controller.s("graphing-calculator-narration-table-no-column-header"), t = this.getSelectedCell(); if (t) { var o = this.model.rowModels[0].cells[t.column]; if (o && "header" === o.type && o.latex && "" !== o.latex) e = a.MQ.StaticMath(d("<span>" + o.latex + "</span>")[0]).mathspeak() } n.alert(e) }, l.prototype.focusHelperOptions = function () { return { controller: this.controller, location: { type: "table-container", id: this.model.id } } }, l.prototype.shouldBeFocused = function () { return g.defaultShouldBeFocused(this.focusHelperOptions()) }, l.prototype.onFocusedChanged = function (e) { if (this.controller.isInEditListMode()) return g.defaultOnFocusChanged(this.focusHelperOptions(), e) }, l }(l.default); e.default = y });

define('loadcss!expressions/folder-view', function () { });
define('expressions/folder-view', ["require", "exports", "tslib", "./expression-edit-actions", "./abstract-item-view", "./smart_textarea", "dcgview", "./circular-icon-view", "jquery.handleevent", "loadcss!./folder-view"], function (require, e, t, n, o, r, i, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var c = i.Components.SwitchUnion, s = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.didMount = function () { this.onItemViewMounted() }, o.prototype.willUnmount = function () { this.onItemViewUnmounted() }, o.prototype.template = function () { var e = this; return i.createElement("div", { class: function () { return { "dcg-do-not-blur": !0, "dcg-expressionitem": !0, "dcg-expressionfolder": !0, "dcg-inFolder": !1, "dcg-selected": e.controller.isItemSelected(e.id), "dcg-dragging": !!e.controller.isItemBeingDragged(e.id), "dcg-collapsed": !!e.model.collapsed, "dcg-hidden": !!e.model.hidden, "dcg-has-items": e.controller.getNumberOfItemsInFolder(e.id) > 0, "dcg-secretFolder": e.model.secret && !e.controller.canAdministerSecretFolders() } }, "expr-id": function () { return e.model.id }, onTapStart: this.bindFn(this.onMouseSelect), onTap: this.bindFn(this.onMouseSelect) }, i.createElement("div", { class: i.const("dcg-fade-container") }, i.createElement("div", { class: i.const("dcg-main") }, i.createElement("div", { role: i.const("button"), tabindex: i.const("0"), "aria-pressed": function () { return e.model.collapsed }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-collapse-folder") }, class: i.const("dcg-caret-container dcg-action-toggle-folder-collapsed dcg-do-not-blur"), handleEvent: i.const("true"), onTap: this.bindFn(this.toggleCollapsed) }, i.createElement("i", { class: i.const("dcg-icon-caret-down"), "aria-hidden": i.const("true") })), i.createElement(r.default, { shouldFocus: this.bindFn(this.isFocused), text: function () { return e.model.title }, placeholder: function () { return e.controller.s("graphing-calculator-text-note-placeholder") }, showLinks: function () { return e.controller.areLinksEnabled() }, onInput: this.bindFn(this.onInput), onFocusChange: this.bindFn(this.onFocusChange), onSpecialKey: this.bindFn(this.onSpecialKey), ariaLabel: this.bindFn(this.getAriaLabel), readonly: function () { return e.controller.isInEditListMode() }, readonlyAction: this.bindFn(this.exitEditListMode) }), i.createElement("div", { role: i.const("checkbox"), "aria-checked": function () { return e.model.secret }, "aria-label": function () { return e.controller.s("graphing-calculator-button-hide-folder-from-students") }, class: function () { return { "dcg-action-toggle-secret-folder": !0, "dcg-do-not-blur": !0, "dcg-checked": e.model.secret } }, style: function () { return { display: e.controller.canAdministerSecretFolders() ? void 0 : "none" } }, handleEvent: i.const("true"), onTap: this.bindFn(this.toggleSecret) }, i.createElement("span", { class: i.const("dcg-checkbox-box") }, i.createElement("i", { class: i.const("dcg-icon-check"), "aria-hidden": i.const("true") })), i.createElement("span", { class: i.const("dcg-checkbox-label") }, function () { return e.controller.s("graphing-calculator-button-hide-folder-from-students-2") }))), c(function () { return String(e.controller.shouldShowReplaceIcon()) }, { true: function () { return i.createElement("i", { class: i.const("dcg-icon-replace"), handleEvent: i.const("true"), onTap: e.bindFn(e.onRenameInFolder), "aria-hidden": i.const("true") }) }, false: function () { return i.createElement("i", { class: i.const("dcg-icon-remove dcg-top-level-delete"), handleEvent: i.const("true"), onTap: e.bindFn(e.onDelete), "aria-hidden": i.const("true") }) } })), i.createElement("span", { class: i.const("dcg-tab dcg-action-drag"), handleevent: i.const("true"), tapboundary: i.const("true"), disablescroll: i.const("true"), style: i.const("touch-action:none"), onTapStart: this.bindFn(this.onDragPending) }, i.createElement("span", { class: i.const("dcg-num") }, function () { return e.model.displayIndex }), i.createElement("div", { class: i.const("dcg-tab-interior") }, i.createElement("span", { role: i.const("button"), tabindex: i.const("0"), "aria-pressed": function () { return !!e.model.hidden }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-hide-folder") }, class: i.const("dcg-circular-icon-container dcg-expression-icon-container"), onTap: this.bindFn(this.toggleHidden) }, i.createElement(l.CircularIconView, { iconType: function () { return e.model.hidden ? "hidden" : "folder" }, whiteIcon: function () { return e.controller.isItemSelected(e.model.id) || e.controller.isItemBeingDragged(e.model.id) } })))), i.createElement(n.ExpressionEditActions, { controller: this.props.controller, id: function () { return e.model.id } })) }, o.prototype.toggleHidden = function () { this.controller.dispatch({ type: "toggle-item-hidden", id: this.id }) }, o.prototype.toggleSecret = function () { this.controller.dispatch({ type: "set-item-secret", id: this.id, isSecret: !this.model.secret }) }, o.prototype.toggleCollapsed = function () { this.controller.dispatch({ type: "set-folder-collapsed", id: this.id, isCollapsed: !this.model.collapsed }) }, o.prototype.onInput = function (e) { this.controller.dispatch({ type: "set-folder-title", id: this.id, title: e }) }, o.prototype.onFocusChange = function (e) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "folder", id: this.id } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "folder", id: this.id } }) }, o.prototype.onSpecialKey = function (e) { return this.controller.dispatch({ type: "on-special-key-pressed", key: e }) }, o.prototype.isFocused = function () { var e = this.controller.getFocusLocation(); return !(!e || "folder" !== e.type || e.id !== this.id) }, o.prototype.getAriaLabel = function () { var e = ""; this.model.hidden || this.model.collapsed || this.model.secret ? !this.model.hidden || this.model.collapsed || this.model.secret ? this.model.hidden || !this.model.collapsed || this.model.secret ? this.model.hidden || this.model.collapsed || !this.model.secret ? this.model.hidden && this.model.collapsed && !this.model.secret ? e = this.controller.s("graphing-calculator-narration-description-hidden-collapsed-folder") : this.model.hidden && !this.model.collapsed && this.model.secret ? e = this.controller.s("graphing-calculator-narration-description-hidden-secret-folder") : !this.model.hidden && this.model.collapsed && this.model.secret ? e = this.controller.s("graphing-calculator-narration-description-collapsed-secret-folder") : this.model.hidden && this.model.collapsed && this.model.secret && (e = this.controller.s("graphing-calculator-narration-description-hidden-collapsed-secret-folder")) : e = this.controller.s("graphing-calculator-narration-description-secret-folder") : e = this.controller.s("graphing-calculator-narration-description-collapsed-folder") : e = this.controller.s("graphing-calculator-narration-description-hidden-folder") : e = this.controller.s("graphing-calculator-narration-description-folder"); var t = this.controller.getNumberOfItemsInFolder(this.id); return t > 0 ? this.controller.s("graphing-calculator-narration-folder-has-items", { folder: e, count: t }) : e }, o }(o.default); e.default = s });
define('lib/coerce-url', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.coerceURL = void 0, e.coerceURL = function (e) { var r = document.createElement("a"); return r.href = e, r.href } });

define('loadcss!expressions/image-icon-view', function () { });
define('expressions/image-icon-view', ["require", "exports", "tslib", "lib/coerce-url", "dcgview", "main/manage-focus-helper", "../dcgview-helpers/tooltipped-error", "./circular-icon-view", "jquery.handleevent", "loadcss!./image-icon-view"], function (require, t, e, o, n, i, r, l) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var c = n.Components.SwitchUnion, s = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return e.__extends(s, t), s.prototype.init = function () { this.model = this.props.model(), this.controller = this.props.controller() }, s.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-expression-icon-container dcg-image-icon-container") }, c(this.bindFn(this.typeOfIcon), { error: function () { return n.createElement(r.TooltippedError, { error: function () { return t.controller.unpack(t.model.error) }, isWhite: t.bindFn(t.isSelected), gravity: t.const("se") }) }, failed: function () { return n.createElement("span", null) }, loading: function () { return n.createElement(l.CircularIconView, { iconType: t.const("loading") }) }, hidden: function () { return t.buildIconView() }, image: function () { return t.buildIconView() } })) }, s.prototype.buildIconView = function () { var t = this; return n.createElement("div", { class: n.const("dcg-circular-icon-container"), role: n.const("button"), tabindex: n.const("0"), "dcg-open-menu-guid": function () { return t.getMenuGUID() }, "aria-label": this.bindFn(this.getIconAriaLabel), onTap: function (e) { if (!e.wasHandled("dragdrop") && !e.wasLongheld()) return t.myOptionsOpen() || t.controller.isInEditListMode() || e.shiftKey ? t.toggleOptions(e) : void t.toggleImageShown() }, onLongHold: function (e) { e.handle("dcg-longhold"), e.handle("dcg-tap"), t.toggleOptions(e) }, manageFocus: this.const(i.manageFocusHelper({ controller: this.controller, location: { type: "image-icon", id: this.model.id } })) }, n.createElement(l.CircularIconView, { iconType: function () { return "hidden" === t.typeOfIcon() ? "hidden" : "background" }, backgroundImage: this.bindFn(this.getBackgroundImage), backgroundOpacity: this.const(1), whiteIcon: this.bindFn(this.isSelected) })) }, s.prototype.isSelected = function () { return this.controller.isItemSelected(this.model.id) || this.controller.isItemBeingDragged(this.model.id) }, s.prototype.typeOfIcon = function () { return "loading" === this.model.loadStatus ? "loading" : "failed" === this.model.loadStatus ? "failed" : this.hasError() ? "error" : this.model.shouldGraph ? "image" : "hidden" }, s.prototype.getMenuGUID = function () { return this.model.guid }, s.prototype.myOptionsOpen = function () { return this.controller.isItemSettingsMenuOpen(this.getMenuGUID()) }, s.prototype.toggleOptions = function (t) { this.controller.dispatch({ type: "toggle-item-settings-menu", menu: { type: "image", model: this.model, guid: this.getMenuGUID(), focusFirstOption: "keyboard" === t.device } }) }, s.prototype.hasError = function () { return !!this.model.error && "none" === this.controller.getBrailleMode() }, s.prototype.getBackgroundImage = function () { return this.model.image_url === this.lastURL || (this.lastURL = this.model.image_url, this.lastEncodedURL = 'url("' + o.coerceURL(this.model.image_url) + '")'), this.lastEncodedURL }, s.prototype.toggleImageShown = function () { this.controller.dispatch({ type: "toggle-item-hidden", id: this.model.id }), this.controller.dispatch({ type: "set-focus-location", location: { type: "image-icon", id: this.model.id } }) }, s.prototype.getIconAriaLabel = function () { return this.myOptionsOpen() ? this.controller.s("graphing-calculator-narration-hide-options") : this.controller.isInEditListMode() ? this.controller.s("graphing-calculator-narration-show-options") : this.model.hidden ? this.controller.s("graphing-calculator-narration-show-image") : this.controller.s("graphing-calculator-narration-hide-image") }, s }(n.Class); t.default = s });
define('expressions/image-upload-view', ["require", "exports", "tslib", "dcgview", "jquery", "main/manage-focus-helper"], function (require, t, e, n, o, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ImageUploadView = void 0; var s = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return e.__extends(s, t), s.prototype.init = function () { this.controller = this.props.controller() }, s.prototype.template = function () { return n.createElement("div", { class: n.const("dcg-do-not-blur"), onTap: this.bindFn(this.newImage), handleEvent: n.const("true"), role: n.const("button"), tabindex: n.const(0), "aria-label": this.props.ariaLabel, manageFocus: this.const(this.props.location ? i.manageFocusHelper({ controller: this.controller, location: this.props.location() }) : void 0) }, this.children, n.createElement("input", { type: n.const("file"), accept: n.const("image/*"), style: n.const("display: none"), didMount: this.bindFn(this.didMountFileInput) })) }, s.prototype.didMountFileInput = function (t) { var e = this; this.fileInputNode = t, o(t).on("change", function () { e.props.onFileChange(t.files), o(t).val("") }) }, s.prototype.newImage = function () { this.fileInputNode.click() }, s }(n.Class); t.ImageUploadView = s });

define('loadcss!expressions/image-view', function () { });
define('expressions/image-view', ["require", "exports", "tslib", "keys", "jquery", "underscore", "./abstract-item-view", "./smart_textarea", "dcgview", "dcgview-helpers/mathquill-view", "lib/conditional_blur", "expressions/promptslider_view", "./image-icon-view", "./image-upload-view", "main/mathquill-operators", "graphing-calc/models/image", "./expression-edit-actions", "../shared-components/mathquill-braille-wrapper", "./expression_view", "./action-info-view", "jquery.handleevent", "loadcss!./image-view"], function (require, e, t, n, o, r, i, c, l, a, s, d, u, p, g, m, h, f, y, b) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var E = l.Components, v = E.If, F = E.SwitchUnion, I = function (e) { function i() { return null !== e && e.apply(this, arguments) || this } return t.__extends(i, e), i.prototype.init = function () { this.model = this.props.model(), this.controller = this.props.controller() }, i.prototype.template = function () { var e = this; return l.createElement("div", { class: function () { return { "dcg-image-input-mathquill": !0, "dcg-suffix-degree": "angle" === e.props.name() && e.props.controller().getGraphSettings().degreeMode, "dcg-suffix-radian": "angle" === e.props.name() && !e.props.controller().getGraphSettings().degreeMode } } }, l.createElement(f.default, t.__assign({ latex: function () { return e.model[e.props.name()] }, brailleShouldFocus: function () { return e.props.focusedInput() === e.props.name() }, selectOnFocus: this.const(!0), onBrailleInput: this.bindFn(this.handleLatexChanged), onBrailleFocusedChanged: this.bindFn(this.handleMQFocusedChanged), onBrailleKeydown: this.bindFn(this.handleBrailleKeydown), hasError: function () { return m.hasInputError(e.model, e.props.name()) }, ariaLabel: function () { return e.controller.raw(e.props.name()) } }, y.getBrailleWrapperProps(this.props.controller())), l.createElement(a.default, { latex: function () { return e.model[e.props.name()] }, isFocused: function () { return e.props.focusedInput() === e.props.name() }, capExpressionSize: function () { return e.controller.getCapExpressionSize() }, selectOnFocus: this.const(!0), config: this.bindFn(this.getMQConfig), getAriaLabel: function () { return e.controller.raw(e.props.name()) }, getAriaPostLabel: this.const(""), hasError: this.const(!1), onUserPressedKey: function (t, n) { return e.handlePressedKey(t, n) }, onUserChangedLatex: this.bindFn(this.handleLatexChanged), onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: this.bindFn(this.handleMQFocusedChanged), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }, l.createElement("span", { class: function () { return { "dcg-focus": e.props.focusedInput() === e.props.name(), "dcg-invalid": m.hasInputError(e.model, e.props.name()) } } })))) }, i.prototype.getInputs = function () { return ["center", "width", "angle", "height", "opacity"] }, i.prototype.handlePressedKey = function (e, t) { var n = this.props.name(), r = a.default.getFocusedMathquill(), i = this.getInputs(), c = i.indexOf(n); if (!this.controller.isInEditListMode()) { if ("Enter" === e) return this.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" }); if ("Esc" === e) return void s.default() } var l = -1; "Up" === e && (l = 1 === c ? 4 : c - 2), "Down" === e && (l = 4 === c ? 1 : c + 2), "Left" === e && (l = c - 1), "Right" === e && (l = c + 1); var d = e; if (l >= 0 && l < i.length) { var u = !1; if (r) u = a.default.applyArrowKeyAndReturnIfWasAtBounds(r, d, t); else if ("Up" === e || "Down" === e) u = !0; else { var p = f.getFocusedBrailleElement(); u = p && ("Left" === e && 0 === p.selectionStart || "Right" === e && p.selectionStart === o(p).val().length) } u && (this.focusInput(i[l]), t && t.preventDefault()) } else r && (r.keystroke(e, t), this.handleLatexChanged(r.latex())) }, i.prototype.handleBrailleKeydown = function (e) { var t = n.lookup(e); t && this.handlePressedKey(t, e) }, i.prototype.focusInput = function (e) { this.controller.dispatch({ type: "set-focus-location", location: { type: "image", id: this.model.id, location: e } }) }, i.prototype.anyInputHasError = function () { var e = this; return r.any(this.getInputs(), function (t) { return m.hasInputError(e.model, t) }) }, i.prototype.handleLatexChanged = function (e) { var t = this.props.name(); this.model.draggingOnGraphpaper || m.getMQAttribute(this.model, t) !== e && this.controller.dispatch({ type: "set-image-mq-attribute", id: this.model.id, attribute: t, latex: e }) }, i.prototype.handleMQFocusedChanged = function (e) { var t = this.props.name(); e ? this.props.focusedInput() !== t && this.controller.dispatch({ type: "set-focus-location", location: { type: "image", id: this.model.id, location: t } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "image", id: this.model.id, location: t } }) }, i.prototype.getMQConfig = function () { return { autoOperatorNames: g.getAutoOperators() } }, i }(l.Class), x = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.didMount = function () { this.onItemViewMounted() }, n.prototype.willUnmount = function () { this.onItemViewUnmounted() }, n.prototype.template = function () { var e = this; return l.createElement("div", { class: function () { return { "dcg-do-not-blur": !0, "dcg-expressionitem": !0, "dcg-expressionimage": !0, "dcg-inFolder": !!e.model.folderId, "dcg-selected": e.controller.isItemSelected(e.id), "dcg-dragging": !!e.controller.isItemBeingDragged(e.id), "dcg-input-focused": e.getFocusedInput() && "name" !== e.getFocusedInput() } }, "expr-id": function () { return e.model.id }, onTapStart: this.bindFn(this.onMouseSelect), onTap: this.bindFn(this.onMouseSelect) }, l.createElement("div", { class: l.const("dcg-fade-container") }, l.createElement("div", { class: l.const("dcg-main") }, F(function () { return e.model.loadStatus }, { failed: function () { return l.createElement("div", null, l.createElement("div", { class: l.const("dcg-image-failed") }, function () { return e.controller.s("graphing-calculator-error-failed-to-load-image") }), l.createElement("div", { role: l.const("button"), tabindex: l.const(0), class: l.const("dcg-retry-loading-image"), onTap: e.bindFn(e.onRetryLoad) }, function () { return e.controller.s("graphing-calculator-button-load-image-retry") })) }, loading: function () { return l.createElement("div", null, l.createElement("div", { class: l.const("dcg-image-loading") }, function () { return e.controller.s("graphing-calculator-text-loading-image") }), l.createElement("div", { role: l.const("button"), tabindex: l.const(0), class: l.const("dcg-retry-loading-image"), onTap: e.bindFn(e.onRetryLoad) }, function () { return e.controller.s("graphing-calculator-button-load-image-retry") })) }, loaded: function () { return l.createElement("div", { class: l.const("dcg-image-loaded") }, l.createElement("div", { class: l.const("dcg-image-title-row") }, l.createElement(c.default, { shouldFocus: function () { return "name" === e.getFocusedInput() }, text: function () { return e.model.name }, placeholder: function () { return e.controller.s("graphing-calculator-text-image-enter-note-placeholder") }, showLinks: function () { return e.controller.areLinksEnabled() }, onInput: e.bindFn(e.onNameInput), onFocusChange: e.bindFn(e.onNameFocusChange), onSpecialKey: e.bindFn(e.onNameSpecialKey), readonly: e.const(!1) }), l.createElement(v, { predicate: function () { return e.controller.areImagesEnabled() } }, function () { return l.createElement(p.ImageUploadView, { controller: function () { return e.controller }, ariaLabel: function () { return e.controller.s("graphing-calculator-button-change-image") }, onFileChange: function (t) { return e.insertFiles(t) }, location: e.const({ type: "change-image-btn", id: e.id }) }, l.createElement("div", { class: l.const("dcg-action-changeimage") }, function () { return e.controller.s("graphing-calculator-button-change-image") })) })), l.createElement("div", { class: function () { return { "dcg-do-blur": !0, "dcg-image-input-grid": !0 } }, handleEvent: l.const("true") }, l.createElement("div", { class: l.const("dcg-image-input-name") }, function () { return e.controller.s("graphing-calculator-label-image-center") }), l.createElement(I, { name: e.const("center"), controller: function () { return e.controller }, model: function () { return e.model }, focusedInput: e.bindFn(e.getFocusedInput) }), l.createElement("div", { class: l.const("dcg-image-input-name") }, function () { return e.controller.s("graphing-calculator-label-image-width") }), l.createElement(I, { name: e.const("width"), controller: function () { return e.controller }, model: function () { return e.model }, focusedInput: e.bindFn(e.getFocusedInput) }), l.createElement("div", { class: l.const("dcg-image-input-name") }, function () { return e.controller.s("graphing-calculator-label-image-angle") }), l.createElement(I, { name: e.const("angle"), controller: function () { return e.controller }, model: function () { return e.model }, focusedInput: e.bindFn(e.getFocusedInput) }), l.createElement("div", { class: l.const("dcg-image-input-name") }, function () { return e.controller.s("graphing-calculator-label-image-height") }), l.createElement(I, { name: e.const("height"), controller: function () { return e.controller }, model: function () { return e.model }, focusedInput: e.bindFn(e.getFocusedInput) }), l.createElement("div", { class: l.const("dcg-image-input-name") }, function () { return e.controller.s("graphing-calculator-label-image-opacity") }), l.createElement(I, { name: e.const("opacity"), controller: function () { return e.controller }, model: function () { return e.model }, focusedInput: e.bindFn(e.getFocusedInput) }))) } })), l.createElement("span", { class: l.const("dcg-fadeout") }), F(function () { return String(e.controller.shouldShowReplaceIcon()) }, { true: function () { return l.createElement("i", { class: l.const("dcg-icon-replace"), handleEvent: l.const("true"), onTap: e.bindFn(e.onRenameInItem), "aria-hidden": l.const("true") }) }, false: function () { return l.createElement("i", { class: l.const("dcg-icon-remove dcg-top-level-delete"), handleEvent: l.const("true"), onTap: e.bindFn(e.onDelete), "aria-hidden": l.const("true") }) } }), l.createElement(v, { predicate: this.bindFn(this.shouldShowBrailleError) }, function () { return l.createElement("div", { class: e.getFooterClass() }, l.createElement("div", { tabindex: l.const(0), class: l.const("dcg-expression-braille-error"), "aria-roledescription": l.const("error"), "aria-label": function () { return e.controller.unpack(e.model.error) } }, l.createElement("i", { class: l.const("dcg-icon-error"), "aria-hidden": l.const("true") }), function () { return e.controller.unpack(e.model.error) })) }), l.createElement(v, { predicate: function () { return m.getMissingVariables(e.model).length > 0 && e.controller.areSlidersEnabled() } }, function () { return l.createElement("div", { class: e.getFooterClass() }, l.createElement(d.default, { model: e.props.model, controller: e.props.controller })) }), l.createElement(v, { predicate: this.bindFn(this.shouldShowActionInfo) }, function () { return l.createElement("div", { class: e.getFooterClass() }, l.createElement(b.default, { model: e.props.model, controller: e.props.controller })) })), l.createElement("span", { class: l.const("dcg-tab dcg-action-drag dcg-action-icon-touch"), handleevent: l.const("true"), tapboundary: l.const("true"), disablescroll: l.const("true"), style: l.const("touch-action:none"), onTapStart: this.bindFn(this.onDragPending) }, l.createElement("span", { class: l.const("dcg-num") }, function () { return e.model.displayIndex }), l.createElement("div", { class: l.const("dcg-tab-interior dcg-action-icon-mouse") }, l.createElement(u.default, { model: this.props.model, controller: this.props.controller }))), l.createElement(h.ExpressionEditActions, { controller: this.props.controller, id: function () { return e.model.id } })) }, n.prototype.shouldShowActionInfo = function () { return !!(this.model.clickableInfo && this.model.clickableInfo.enabled && this.model.clickableInfo.latex) }, n.prototype.getFooterClass = function () { return this.isFirstRender() ? this.const("dcg-expression-bottom dcg-indent-in-folder") : this.const("dcg-expression-bottom dcg-fadein-bottom dcg-indent-in-folder") }, n.prototype.onNameInput = function (e) { this.controller.dispatch({ type: "set-image-name", id: this.id, name: e }) }, n.prototype.onNameFocusChange = function (e) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "image", id: this.id, location: "name" } }) : "name" === this.getFocusedInput() && this.controller.dispatch({ type: "blur-focus-location", location: { type: "image", id: this.id, location: "name" } }) }, n.prototype.onNameSpecialKey = function (e) { return this.controller.dispatch({ type: "on-special-key-pressed", key: e }) }, n.prototype.getFocusedInput = function () { var e = this.controller.getFocusLocation(); if (e && "image" === e.type && e.id === this.model.id) return e.location }, n.prototype.onRetryLoad = function () { this.controller.dispatch({ type: "image-retry-loading", id: this.id }) }, n.prototype.shouldShowBrailleError = function () { return "none" !== this.controller.getBrailleMode() && !!this.model.error }, n.prototype.insertFiles = function (e) { this.controller.dispatch({ type: "change-image", files: e, id: this.id }) }, n.prototype.onMouseSelect = function (e) { "dcg-tap" === e.type && "mouse" === e.device || "dcg-tapstart" === e.type && "touch" === e.device || e.wasHandled() || (e.handle(), this.controller.dispatch({ type: "set-selected-id", id: this.id })) }, n }(i.default); e.default = x });
define('expressions/shell_view', ["require", "exports", "tslib", "dcgview", "./abstract-item-view"], function (require, e, t, n, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var o = function (e) { function i() { return null !== e && e.apply(this, arguments) || this } return t.__extends(i, e), i.prototype.didMount = function () { this.onItemViewMounted() }, i.prototype.willUnmount = function () { this.onItemViewUnmounted() }, i.prototype.template = function () { var e = ""; return this.model.cachedRenderHeight && (e = "height:" + this.model.cachedRenderHeight + "px"), n.createElement("div", { class: n.const("dcg-do-not-blur dcg-expressionitem dcg-shell"), "expr-id": this.const(this.model.id), onTap: this.bindFn(this.onMouseSelect), style: n.const(e) }) }, i }(i.default); e.default = o });
define('expressions/drag_container_view', ["require", "exports", "tslib", "dcgview"], function (require, t, e, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.init = function () { this.controller = this.props.controller() }, n.prototype.template = function () { var t = this; return r.createElement("div", { class: r.const("dcg-drag-container"), style: function () { return { top: t.getTopPx() } } }, this.children) }, n.prototype.getTopPx = function () { var t = this.controller.getRawDragState(); if (t) return t.itemTop + "px" }, n }(r.Class); t.default = n });
define('vendor/papaparse', ['require', 'jquery'], function (require) { "use strict"; var e = require("jquery"), t = { delimiter: "", header: !1, dynamicTyping: !1, preview: 0, step: void 0, encoding: "", comments: !1, complete: void 0, error: void 0, download: !1, chunk: void 0, keepEmptyRows: !1 }, n = {}; function r(e) { (e = e || {}).chunkSize || (e.chunkSize = n.RemoteChunkSize); var t, r, i = 0, a = "", u = "", c = new o(s(e)); this.stream = function (n) { function o() { if (4 == t.readyState) if (t.status < 200 || t.status >= 400) s(); else { a += u + t.responseText, u = ""; var n = !e.step || i > function (e) { var t = e.getResponseHeader("Content-Range"); return parseInt(t.substr(t.lastIndexOf("/") + 1)) }(t); if (!n) { var o = a.lastIndexOf("\n"); if (o < 0 && (o = a.lastIndexOf("\r")), !(o > -1)) return void r(); u = a.substring(o + 1), a = a.substring(0, o) } var d = c.parse(a); a = "", f(e.chunk) && (e.chunk(d), d = void 0), n || d.meta.paused || r() } } function s() { f(e.error) && e.error(t.statusText) } (r = function () { !function () { if ((t = new XMLHttpRequest).onload = o, t.onerror = s, t.open("GET", n, !0), e.step) { var r = i + e.chunkSize - 1; 0, t.setRequestHeader("Range", "bytes=" + i + "-" + r) } t.send(), i += e.chunkSize }() })() } } function i(e) { (e = e || {}).chunkSize || (e.chunkSize = n.LocalChunkSize); var t, r = 0, i = "", a = "", u = new o(s(e)), c = "function" == typeof FileReader; this.stream = function (n) { var o = n.slice || n.webkitSlice || n.mozSlice; function s() { var i, a; r < n.size && (i = Math.min(r + e.chunkSize, n.size), a = t.readAsText(o.call(n, r, i), e.encoding), c || d({ target: { result: a } })) } function d(t) { r += e.chunkSize, i += a + t.target.result, a = ""; var o = r >= n.size; if (!o) { var c = i.lastIndexOf("\n"); if (c < 0 && (c = i.lastIndexOf("\r")), !(c > -1)) return void s(); a = i.substring(c + 1), i = i.substring(0, c) } var d = u.parse(i); i = "", f(e.chunk) && (e.chunk(d, n), d = void 0), o || d.meta.paused || s() } c ? ((t = new FileReader).onload = d, t.onerror = function () { f(e.error) && e.error(t.error, n) }) : t = new FileReaderSync, s() } } function o(e) { var t, r, i, o = /^\s*-?(\d*\.?\d+|\d+\.?\d*)(e[-+]?\d+)?\s*$/i, u = this, c = !1, d = [], l = { data: [], errors: [], meta: {} }; function p() { return l && i && (m("Delimiter", "UndetectableDelimiter", "Unable to auto-detect delimiting character; defaulted to '" + n.DefaultDelimiter + "'"), i = !1), h() && function () { if (!l) return; for (var e = 0; h() && e < l.data.length; e++)for (var t = 0; t < l.data[e].length; t++)d.push(l.data[e][t]); l.data.splice(0, 1) }(), function () { if (!l || !e.header && !e.dynamicTyping) return l; for (var t = 0; t < l.data.length; t++) { for (var n = {}, r = 0; r < l.data[t].length; r++) { if (e.dynamicTyping) { var i = l.data[t][r]; l.data[t][r] = "true" == i || "false" != i && g(i) } e.header && (r >= d.length ? (n.__parsed_extra || (n.__parsed_extra = []), n.__parsed_extra.push(l.data[t][r])) : n[d[r]] = l.data[t][r]) } e.header && (l.data[t] = n, r > d.length ? m("FieldMismatch", "TooManyFields", "Too many fields: expected " + d.length + " fields but parsed " + r, t) : r < d.length && m("FieldMismatch", "TooFewFields", "Too few fields: expected " + d.length + " fields but parsed " + r, t)) } e.header && l.meta && (l.meta.fields = d); return l }() } function h() { return e.header && 0 == d.length } function g(e) { return o.test(e) ? parseFloat(e) : e } function m(e, t, n, r) { l.errors.push({ type: e, code: t, message: n, row: r }) } e = s(e), this.parse = function (o) { if (i = !1, !e.delimiter) { var s = function (t) { for (var r, i, o, s = [",", "\t", "|", ";", n.RECORD_SEP, n.UNIT_SEP], f = 0; f < s.length; f++) { var u = s[f], c = 0, d = 0; o = void 0; for (var l = new a({ delimiter: u, preview: 10 }).parse(t), p = 0; p < l.data.length; p++) { var h = l.data[p].length; d += h, void 0 !== o ? h > 1 && (c += Math.abs(h - o), o = h) : o = h } d /= l.data.length, (void 0 === i || c < i) && d > 1.99 && (i = c, r = u) } return e.delimiter = r, { successful: !!r, bestDelimiter: r } }(o); s.successful ? e.delimiter = s.bestDelimiter : (i = !0, e.delimiter = n.DefaultDelimiter), l.meta.delimiter = e.delimiter } if (f(e.step)) { var d = e.step; e.step = function (e) { l = e, h() ? p() : d(p(), u) } } return e.preview && e.header && e.preview++, t = o, r = new a(e), l = r.parse(t), p(), f(e.complete) && !c && e.complete(l), c ? { meta: { paused: !0 } } : l }, this.pause = function () { c = !0, r.abort(), t = t.substr(r.getCharIndex()) }, this.resume = function () { c = !1, (r = new a(e)).parse(t), f(e.complete) && !c && e.complete(l) }, this.abort = function () { r.abort(), f(e.complete) && e.complete(l), t = "" } } function a(e) { var t, r, i, o, a, s, u, c, d, l, p, h, g, m, y = /^\s*$/, v = !1; function b() { u++, s = t[u] } function w() { _() && !I() ? c = !c : (R(), c && I() ? u++ : O("Quotes", "UnexpectedQuotes", "Unexpected quotes")) } function S() { (T(u) || A(u)) && d++, R() } function E() { s == r ? x() : T(u) ? (k(), b()) : A(u) ? k() : i && (0 == u || A(u - 1) || T(u - 2)) && t[u] === i ? function () { for (; !T(u) && !A(u) && u < t.length;)b() }() : R() } function R() { l[h][g] += s } function x() { l[h].push(""), g = l[h].length - 1 } function k() { D(), d++, m++, l.push([]), h = l.length - 1, x() } function D() { 1 == l[h].length && y.test(l[h][0]) && (e.keepEmptyRows ? l[h].splice(0, 1) : l.splice(h, 1), h = l.length - 1), f(o) && (l[h] && o(M()), z()) } function T(e) { return e < t.length - 1 && ("\r" == t[e] && "\n" == t[e + 1] || "\n" == t[e] && "\r" == t[e + 1]) } function A(e) { return "\r" == t[e] || "\n" == t[e] } function I() { return !_() && u < t.length - 1 && '"' == t[u + 1] } function _() { return !c && C(u - 1) || C(u + 1) } function C(e) { "number" != typeof e && (e = u); var n = t[e]; return e <= -1 || e >= t.length || n == r || "\r" == n || "\n" == n } function O(e, t, n) { p.push({ type: e, code: t, message: n, line: d, row: h, index: u }) } function z() { l = [], p = [], h = 0, g = 0 } function M() { return { data: l, errors: p, meta: { lines: d, delimiter: r, aborted: v, truncated: a > 0 && u < t.length } } } r = (e = e || {}).delimiter, i = e.comments, o = e.step, a = e.preview, ("string" != typeof r || 1 != r.length || n.BAD_DELIMITERS.indexOf(r) > -1) && (r = ","), !0 === i ? i = "#" : ("string" != typeof i || 1 != i.length || n.BAD_DELIMITERS.indexOf(i) > -1 || i == r) && (i = !1), this.parse = function (e) { if ("string" != typeof e) throw "Input must be a string"; return function (e) { t = e, c = !1, u = 0, m = 0, d = 1, z(), l = [[""]], s = t[u] }(e), function () { for (; u < t.length && !v && !(a > 0 && m >= a);)'"' == s ? w() : c ? S() : E(), b(); return function () { v && O("Abort", "ParseAbort", "Parsing was aborted by the user's step function"); c && O("Quotes", "MissingQuotes", "Unescaped or mismatched quotes"); if (D(), !f(o)) return M() }() }() }, this.abort = function () { v = !0 }, this.getCharIndex = function () { return u } } function s(e) { if ("object" != typeof e) return e; var t = e instanceof Array ? [] : {}; for (var n in e) t[n] = s(e[n]); return t } function f(e) { return "function" == typeof e } return n.parse = function (e, a) { var u = function (e) { "object" != typeof e && (e = {}); var r = s(e); ("string" != typeof r.delimiter || 1 != r.delimiter.length || n.BAD_DELIMITERS.indexOf(r.delimiter) > -1) && (r.delimiter = t.delimiter); "boolean" != typeof r.header && (r.header = t.header); "boolean" != typeof r.dynamicTyping && (r.dynamicTyping = t.dynamicTyping); "number" != typeof r.preview && (r.preview = t.preview); "function" != typeof r.step && (r.step = t.step); "function" != typeof r.complete && (r.complete = t.complete); "function" != typeof r.error && (r.error = t.error); "string" != typeof r.encoding && (r.encoding = t.encoding); "boolean" != typeof r.download && (r.download = t.download); "boolean" != typeof r.keepEmptyRows && (r.keepEmptyRows = t.keepEmptyRows); return r }(a); if ("string" == typeof e) { if (!u.download) return new o(u).parse(e); new r(u).stream(e) } else if (e instanceof File) if (u.step || u.chunk) { new i(u).stream(e) } else { new o(u); reader = new FileReader, reader.onload = function (e) { new o(u).parse(e.target.result) }, reader.onerror = function () { f(u.error) && u.error(reader.error, e) }, reader.readAsText(e, u.encoding) } }, n.unparse = function (e, t) { var r = !1, i = ",", o = "\r\n"; (function () { if ("object" != typeof t) return; "string" == typeof t.delimiter && 1 == t.delimiter.length && -1 == n.BAD_DELIMITERS.indexOf(t.delimiter) && (i = t.delimiter); ("boolean" == typeof t.quotes || t.quotes instanceof Array) && (r = t.quotes); "string" == typeof t.newline && (o = t.newline) })(), "string" == typeof e && (e = JSON.parse(e)); if (e instanceof Array) { if (!e.length || e[0] instanceof Array) return s(null, e); if ("object" == typeof e[0]) return s(a(e[0]), e) } else if ("object" == typeof e) return "string" == typeof e.data && (e.data = JSON.parse(e.data)), e.data instanceof Array && (e.fields || (e.fields = e.data[0] instanceof Array ? e.fields : a(e.data[0])), e.data[0] instanceof Array || "object" == typeof e.data[0] || (e.data = [e.data])), s(e.fields || [], e.data || []); throw "exception: Unable to serialize unrecognized input"; function a(e) { if ("object" != typeof e) return []; var t = []; for (var n in e) t.push(n); return t } function s(e, t) { var n = ""; "string" == typeof e && (e = JSON.parse(e)), "string" == typeof t && (t = JSON.parse(t)); var r = e instanceof Array && e.length > 0, a = !(t[0] instanceof Array); if (r) { for (var s = 0; s < e.length; s++)s > 0 && (n += i), n += f(e[s], s); t.length > 0 && (n += o) } for (var u = 0; u < t.length; u++) { for (var c = r ? e.length : t[u].length, d = 0; d < c; d++) { d > 0 && (n += i); var l = r && a ? e[d] : d; n += f(t[u][l], d) } u < t.length - 1 && (n += o) } return n } function f(e, t) { return null == e ? "" : (e = e.toString().replace(/"/g, '""'), "boolean" == typeof r && r || r instanceof Array && r[t] || function (e, t) { for (var n = 0; n < t.length; n++)if (e.indexOf(t[n]) > -1) return !0; return !1 }(e, n.BAD_DELIMITERS) || e.indexOf(i) > -1 || " " == e.charAt(0) || " " == e.charAt(e.length - 1) ? '"' + e + '"' : e) } }, n.RECORD_SEP = String.fromCharCode(30), n.UNIT_SEP = String.fromCharCode(31), n.BYTE_ORDER_MARK = "\ufeff", n.BAD_DELIMITERS = ["\r", "\n", '"', n.BYTE_ORDER_MARK], n.LocalChunkSize = 10485760, n.RemoteChunkSize = 5242880, n.DefaultDelimiter = ",", n.Parser = a, n.ParserHandle = o, n.NetworkStreamer = r, n.FileStreamer = i, e.fn.parse = function (t) { var r = t.config || {}, i = []; return this.each(function (t) { if (!("INPUT" == e(this).prop("tagName").toUpperCase() && "file" == e(this).attr("type").toLowerCase() && window.FileReader) || !this.files || 0 == this.files.length) return !0; for (var n = 0; n < this.files.length; n++)i.push({ file: this.files[n], inputElem: this, instanceConfig: e.extend({}, r) }) }), o(), this; function o() { if (0 != i.length) { var r, o, s, u, c = i[0]; if (f(t.before)) { var d = t.before(c.file, c.inputElem); if ("object" == typeof d) { if ("abort" == d.action) return r = "AbortError", o = c.file, s = c.inputElem, u = d.reason, void (f(t.error) && t.error({ name: r }, o, s, u)); if ("skip" == d.action) return void a(); "object" == typeof d.config && (c.instanceConfig = e.extend(c.instanceConfig, d.config)) } else if ("skip" == d) return void a() } var l = c.instanceConfig.complete; c.instanceConfig.complete = function (e) { f(l) && l(e, c.file, c.inputElem), a() }, n.parse(c.file, c.instanceConfig) } } function a() { i.splice(0, 1), o() } }, n });
define('geometry/math/isNumber', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.isNumber = void 0, e.isNumber = function (e) { var r; if ("number" == typeof e) r = e + ""; else { if ("string" != typeof e) return !1; r = e } return r.trim().match(/^-?[0-9]*\.?[0-9]*$/) } });
define('main/data_helpers', ["require", "exports", "vendor/papaparse", "underscore", "bugsnag", "geometry/math/isNumber"], function (require, e, r, t, a, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.parse = e.getExpressions = void 0, e.getExpressions = function (e) { var r = e.split(/\r?\n/), a = [], s = !1; if (!(r.length < 2)) { for (var i = 0; i < r.length; i++) { var o = r[i]; if (o.trim()) { i > 0 && !n.isNumber(o.replace(/,(\d{3})/g, "$1")) && (s = !0); var u = { content: o }; a.push(u) } } if (!s) { var p = t.pluck(a, "content").map(function (e) { return e.replace(/,(\d{3})/g, "$1") }); return n.isNumber(p[0]) || (p = p.slice(1)), [{ content: "\\left[" + p.join(",") + "\\right]", numberList: !0 }] } return a } }, e.parse = function (e) { if (!/^\s*$/.test(e)) { var t = r.parse(e, { preview: 1e3 }), n = []; if (!t.errors.length || t.data.length) { if (t.data.length && !(t.data.length < 2)) { for (var s = t.data[0].length, i = 0; i < s; i++)n.push([]); for (var o = 0; o < t.data.length; o++)if (0 !== o || !isNaN(parseFloat(t.data[o][0]))) { if (t.data[o].length < 2) return; if (t.data[o][0] || t.data[o][1]) for (i = 0; i < s; i++) { var u = (t.data[o][i] || "").replace(/,(\d{3})/g, "$1"); if (u && isNaN(parseFloat(u))) return; n[i].push(u) } } if (!(n[0].length < 2)) return n } } else a.notify("PapaParse.parse returned errors.", { metaData: { input: e, output: t.errors } }) } } });

define('loadcss!new_expression', function () { });
define('expressions/new_expression_view', ["require", "exports", "tslib", "dcgview", "loadcss!new_expression"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.template = function () { return this.controller = this.props.controller(), n.createElement("div", { class: n.const("dcg-expressionitem dcg-new-expression dcg-opened") }, n.createElement("div", { class: n.const("dcg-new-math-div dcg-do-not-blur dcg-action-newmath"), onTap: this.bindFn(this.newMath) }, n.createElement("div", { class: n.const("dcg-new-expression-fade") })), n.createElement("span", { class: n.const("dcg-tab") }, n.createElement("span", { class: n.const("dcg-num dcg-variable-index") }, this.bindFn(this.getIndex)), n.createElement("div", { class: n.const("dcg-tab-interior") }))) }, s.prototype.getIndex = function () { return this.controller.getNextDisplayIndex() }, s.prototype.newMath = function () { this.controller.dispatch({ type: "new-expression-at-end" }) }, s }(n.Class); e.default = s });

define('loadcss!add_expression', function () { });
define('expressions/add_expression_view', ["require", "exports", "tslib", "keys", "browser", "dcgview", "jquery", "./image-upload-view", "main/manage-focus-helper", "../shared-components/tooltip", "loadcss!add_expression"], function (require, e, t, n, o, r, c, a, l, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var s = r.Components.If, d = function (e) { function d() { return null !== e && e.apply(this, arguments) || this } return t.__extends(d, e), d.prototype.init = function () { this.controller = this.props.controller() }, d.prototype.template = function () { var e = this; return r.createElement("div", { class: r.const("dcg-add-expression-container") }, r.createElement(i.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-add-item-tooltip") }, gravity: function () { return e.controller.isNarrow() ? "ne" : "se" } }, r.createElement("span", { class: function () { return { "dcg-icon-btn": !0, "dcg-add-expression-btn": !0, "dcg-action-add-expression": !0, "dcg-do-blur": !0, "dcg-active": e.controller.isAddExpressionOpen() } }, handleEvent: r.const("true"), role: r.const("button"), tabindex: r.const("0"), "aria-haspopup": r.const("true"), "aria-expanded": function () { return e.controller.isAddExpressionOpen() }, "aria-label": function () { return e.controller.s("graphing-calculator-label-add-item-tooltip") }, didMount: function (t) { e.toggleButtonNode = t }, onTap: this.bindFn(this.toggleAddExpression), manageFocus: this.const(l.manageFocusHelper({ controller: this.controller, location: { type: "add-item-btn" } })) }, r.createElement("i", { class: r.const("dcg-icon-plus"), "aria-hidden": r.const("true") }))), r.createElement(s, { predicate: function () { return e.controller.isAddExpressionOpen() } }, function () { return r.createElement("div", { class: function () { return { "dcg-add-expression-dropdown": !0, "dcg-popover": !0, "dcg-bottom": !e.controller.isNarrow(), "dcg-right": e.controller.isNarrow() } }, role: r.const("complementary"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-add-item-menu") }, didMount: e.bindFn(e.didMountPopover), didUnmount: e.bindFn(e.didUnmountPopover) }, r.createElement("div", { class: r.const("dcg-popover-interior") }, r.createElement("div", { class: r.const("dcg-new-item dcg-do-not-blur dcg-action-newexpression"), role: r.const("button"), tabindex: r.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-narration-add-expression") }, onTap: e.bindFn(e.newExpression), handleEvent: r.const("true"), manageFocus: e.const(l.manageFocusHelper({ controller: e.controller, location: { type: "add-expression-btn" } })) }, r.createElement("i", { class: r.const("dcg-icon-new-expression dcg-expression-icon"), "aria-hidden": r.const("true") }), function () { return e.controller.s("graphing-calculator-label-expression-lowercase") }), r.createElement(s, { predicate: function () { return e.controller.areNotesEnabled() } }, function () { return r.createElement("div", { class: r.const("dcg-new-item dcg-do-not-blur dcg-action-newtext"), role: r.const("button"), tabindex: r.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-narration-add-note") }, onTap: e.bindFn(e.newText), handleEvent: r.const("true"), manageFocus: e.const(l.manageFocusHelper({ controller: e.controller, location: { type: "add-note-btn" } })) }, r.createElement("i", { class: r.const("dcg-icon-new-text dcg-expression-icon"), "aria-hidden": r.const("true") }), function () { return e.controller.s("graphing-calculator-label-note-lowercase") }) }), r.createElement("div", { class: r.const("dcg-new-item dcg-do-not-blur dcg-action-newtable"), role: r.const("button"), tabindex: r.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-narration-add-table") }, onTap: e.bindFn(e.newTable), handleEvent: r.const("true"), manageFocus: e.const(l.manageFocusHelper({ controller: e.controller, location: { type: "add-table-btn" } })) }, r.createElement("i", { class: r.const("dcg-icon-new-table dcg-expression-icon"), "aria-hidden": r.const("true") }), function () { return e.controller.s("graphing-calculator-label-table-lowercase") }), r.createElement(s, { predicate: function () { return e.controller.areFoldersEnabled() } }, function () { return r.createElement("div", { class: r.const("dcg-new-item dcg-do-not-blur dcg-action-newfolder"), role: r.const("button"), tabindex: r.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-narration-add-folder") }, onTap: e.bindFn(e.newFolder), handleEvent: r.const("true"), manageFocus: e.const(l.manageFocusHelper({ controller: e.controller, location: { type: "add-folder-btn" } })) }, r.createElement("i", { class: r.const("dcg-icon-new-folder dcg-expression-icon"), "aria-hidden": r.const("true") }), function () { return e.controller.s("graphing-calculator-label-folder-lowercase") }) }), r.createElement(s, { predicate: function () { return e.controller.areImagesEnabled() } }, function () { return r.createElement(a.ImageUploadView, { controller: function () { return e.controller }, ariaLabel: function () { return e.controller.s("graphing-calculator-narration-add-image") }, onFileChange: function (t) { return e.insertFiles(t) }, location: e.const({ type: "add-image-btn" }) }, r.createElement("div", { class: r.const("dcg-new-item dcg-action-newimage") }, r.createElement("i", { class: r.const("dcg-icon-new-image dcg-expression-icon"), "aria-hidden": r.const("true") }), function () { return e.controller.s("graphing-calculator-label-image-lowercase") })) }), r.createElement(s, { predicate: e.bindFn(e.showAddTicker) }, function () { return r.createElement("div", { class: r.const("dcg-new-item dcg-do-not-blur dcg-action-ticker"), role: r.const("button"), tabindex: r.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-narration-add-ticker") }, onTap: e.bindFn(e.addTicker), handleEvent: r.const("true"), manageFocus: e.const(l.manageFocusHelper({ controller: e.controller, location: { type: "add-ticker-btn" } })) }, r.createElement("i", { class: r.const("dcg-icon-metronome dcg-expression-icon"), "aria-hidden": r.const("true") }), function () { return e.controller.s("graphing-calculator-label-ticker-lowercase") }) })), r.createElement("span", { class: r.const("dcg-arrow") })) })) }, d.prototype.showAddTicker = function () { return this.controller.areActionsEnabled() && !this.controller.getTickerOpen() }, d.prototype.didMountPopover = function (e) { var t = this; this.popoverNode = e, c(document).on("dcg-tapstart.add-expression-view wheel.add-expression-view", function (e) { t.eventShouldClosePopover(e) && t.controller.dispatch({ type: "close-add-expression", focusIconAfterClose: "keyboard" === e.device }) }), c(document).on("keydown.add-expression-view", function (e) { if ("Esc" === n.lookup(e) && t.controller.dispatch({ type: "close-add-expression", focusIconAfterClose: !0 }), "Tab" === n.lookup(e) && !e.altKey && !e.metaKey && !e.ctrlKey) { var o = t.controller.getFocusLocation(); if (!o) return; var r = void 0; r = t.showAddTicker() ? { type: "add-ticker-btn" } : t.controller.areImagesEnabled() ? { type: "add-image-btn" } : t.controller.areFoldersEnabled() ? { type: "add-folder-btn" } : { type: "add-table-btn" }, e.shiftKey || o.type !== r.type ? e.shiftKey && "add-item-btn" === o.type && (t.controller.dispatch({ type: "set-focus-location", location: r }), e.preventDefault(), e.stopPropagation()) : (t.controller.dispatch({ type: "set-focus-location", location: { type: "add-item-btn" } }), e.preventDefault(), e.stopPropagation()) } }), o.IS_IPAD && o.IS_IN_IFRAME && c(e).on("dcg-tapstart", function (e) { return e.preventDefault() }), c(e).find(".dcg-new-item").on("touchstart", function (e) { return e.preventDefault() }) }, d.prototype.didUnmountPopover = function () { c(document).off(".add-expression-view") }, d.prototype.toggleAddExpression = function (e) { this.controller.dispatch({ type: "toggle-add-expression", focusOnOpen: "keyboard" === e.device }) }, d.prototype.newExpression = function () { this.controller.dispatch({ type: "new-expression" }) }, d.prototype.newText = function () { this.controller.dispatch({ type: "new-text" }) }, d.prototype.newFolder = function () { this.controller.dispatch({ type: "new-folder" }) }, d.prototype.addTicker = function () { this.controller.dispatch({ type: "open-ticker" }) }, d.prototype.newTable = function () { this.controller.dispatch({ type: "new-table" }) }, d.prototype.insertFiles = function (e) { this.controller.dispatch({ type: "new-images", files: e }) }, d.prototype.eventShouldClosePopover = function (e) { var t = !!c(e.target).closest(this.popoverNode).length, n = !!c(e.target).closest(this.toggleButtonNode).length; return !(t || n) }, d }(r.Class); e.default = d });

define('loadcss!expressions/expressions-header', function () { });
define('expressions/expressions-header', ["require", "exports", "tslib", "./add_expression_view", "dcgview", "main/manage-focus-helper", "../shared-components/tooltip", "loadcss!./expressions-header"], function (require, t, n, e, o, r, c) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var l = o.Components.If, i = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return n.__extends(i, t), i.prototype.init = function () { this.controller = this.props.controller() }, i.prototype.template = function () { var t = this; return o.createElement("div", { class: function () { return { "dcg-expression-top-bar": !0, "dcg-expressions-scrolled": t.showShadow() } }, role: o.const("toolbar"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-expression-bar") }, didMount: function (n) { t.node = n }, onTapStart: this.bindFn(this.clearSelectionOnMobile), style: function () { return { background: t.controller.hasBackgroundColor() ? t.controller.getPillboxBackgroundColor() : void 0 } } }, o.createElement("div", { class: o.const("dcg-left-buttons") }, o.createElement(l, { predicate: this.bindFn(this.showHamburger) }, function () { return o.createElement("span", { class: o.const("dcg-action-opendrawer dcg-tooltip dcg-icon-btn dcg-in-api-action-opendrawer"), handleEvent: o.const("true"), tooltip: function () { return t.controller.s("graphing-calculator-label-open-graph-tooltip") }, role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-open-graph") }, onTap: function () { return t.controller.dispatch({ type: "open-drawer" }) } }, o.createElement("i", { class: o.const("dcg-icon-hamburger"), "aria-hidden": o.const("true") })) }), o.createElement(l, { predicate: function () { return !t.controller.isInEditListMode() } }, function () { return o.createElement(e.default, { controller: function () { return t.props.controller() } }) }), o.createElement(l, { predicate: this.bindFn(this.showRerandomize) }, function () { return o.createElement(c.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-randomize-tooltip") }, gravity: function () { return t.controller.isNarrow() ? "n" : "s" } }, o.createElement("span", { class: o.const("dcg-icon-btn"), handleEvent: o.const("true"), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-label-randomize-tooltip") }, onTap: function () { return t.controller.dispatch({ type: "re-randomize" }) } }, o.createElement("i", { class: o.const("dcg-icon-randomize"), "aria-hidden": o.const("true") }))) }), o.createElement(l, { predicate: function () { return t.controller.isInEditListMode() && !t.controller.hasDefaultState() } }, function () { return o.createElement("span", { class: o.const("dcg-btn-red dcg-action-clearall"), role: o.const("button"), tabindex: o.const("0"), onTap: function () { return t.controller.dispatch({ type: "clear-graph" }) } }, function () { return t.controller.s("graphing-calculator-button-clear-graph") }) }), o.createElement(l, { predicate: function () { return t.controller.isInEditListMode() && t.controller.hasDefaultState() } }, function () { return o.createElement("span", { class: o.const("dcg-btn-red dcg-action-reset"), role: o.const("button"), tabindex: o.const("0"), onTap: function () { return t.controller.dispatch({ type: "reset-graph" }) } }, function () { return t.controller.s("graphing-calculator-button-reset-graph") }) })), o.createElement("div", { class: o.const("dcg-center-buttons") }, o.createElement(c.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-undo-tooltip") }, gravity: function () { return t.controller.isNarrow() ? "n" : "s" }, disabled: function () { return !t.controller.canUndo() } }, o.createElement("span", { class: function () { return { "dcg-action-undo": !0, "dcg-icon-btn": !0, "dcg-disabled": !t.controller.canUndo() } }, role: o.const("button"), tabindex: function () { return t.controller.canUndo() ? 0 : -1 }, "aria-label": function () { return t.controller.s("graphing-calculator-narration-undo") }, onTap: function () { return t.controller.dispatch({ type: "undo" }) }, "aria-disabled": function () { return !t.controller.canUndo() } }, o.createElement("i", { class: o.const("dcg-icon-undo"), "aria-hidden": o.const("true") }))), o.createElement(c.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-redo-tooltip") }, gravity: function () { return t.controller.isNarrow() ? "n" : "s" }, disabled: function () { return !t.controller.canRedo() } }, o.createElement("span", { class: function () { return { "dcg-action-redo": !0, "dcg-icon-btn": !0, "dcg-disabled": !t.controller.canRedo() } }, role: o.const("button"), tabindex: function () { return t.controller.canRedo() ? 0 : -1 }, "aria-label": function () { return t.controller.s("graphing-calculator-narration-redo") }, onTap: function () { return t.controller.dispatch({ type: "redo" }) }, "aria-disabled": function () { return !t.controller.canRedo() } }, o.createElement("i", { class: o.const("dcg-icon-redo"), "aria-hidden": o.const("true") })))), o.createElement("div", { class: o.const("dcg-right-buttons") }, o.createElement(l, { predicate: function () { return !t.controller.isInEditListMode() } }, function () { return o.createElement(c.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-edit-list-tooltip") }, gravity: function () { return t.controller.isNarrow() ? "n" : "s" } }, o.createElement("span", { class: o.const("dcg-icon-btn dcg-action-toggle-edit"), handleEvent: o.const("true"), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-edit-expression-list") }, onTap: t.bindFn(t.toggleEditListMode), manageFocus: t.const(r.manageFocusHelper({ controller: t.controller, location: { type: "edit-list-toggle" } })) }, o.createElement("i", { class: o.const("dcg-icon-settings"), "aria-hidden": o.const("true") }))) }), o.createElement(l, { predicate: function () { return t.controller.isInEditListMode() } }, function () { return o.createElement("span", { class: o.const("dcg-btn-primary dcg-action-toggle-edit dcg-do-not-blur"), handleEvent: o.const("true"), role: o.const("button"), tabindex: o.const("0"), onTap: t.bindFn(t.toggleEditListMode), manageFocus: t.const(r.manageFocusHelper({ controller: t.controller, location: { type: "edit-list-toggle" } })) }, function () { return t.controller.s("graphing-calculator-button-done") }) }), o.createElement(l, { predicate: function () { return !t.controller.isInEditListMode() && t.controller.getGraphSettings().config.graphpaper } }, function () { return o.createElement(c.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-hide-expression-list-tooltip") }, gravity: function () { return t.controller.isNarrow() ? "nw" : "sw" } }, o.const(" "), o.createElement("span", { class: function () { return { "dcg-resize-list-btn": !0, "dcg-action-hideexpressions": !0, "dcg-icon-btn": !0, "dcg-rotated": t.controller.isNarrow() } }, role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-label-hide-expression-list-tooltip") }, onTap: function (n) { t.controller.dispatch({ type: "hide-expressions-list", focusShowIcon: "keyboard" === n.device }) }, manageFocus: t.const(r.manageFocusHelper({ controller: t.controller, location: { type: "hide-expression-list-btn" } })) }, o.createElement("i", { class: o.const("dcg-icon-hide"), "aria-hidden": o.const("true") }))) }))) }, i.prototype.showShadow = function () { return !this.controller.getTickerOpen() && (!this.controller.getExpressionSearchOpen() && this.props.expsScrolled()) }, i.prototype.showRerandomize = function () { return this.controller.anyItemDependsOnRandomSeed() }, i.prototype.showHamburger = function () { return !!this.controller.getGraphSettings().config.showHamburger && (!this.controller.isInEditListMode() && !this.controller.isNarrow()) }, i.prototype.clearSelectionOnMobile = function (t) { t.wasHandled() || this.controller.dispatch({ type: "set-none-selected" }) }, i.prototype.toggleEditListMode = function (t) { this.controller.dispatch({ type: "set-edit-list-mode", isEditListMode: !this.controller.isInEditListMode(), focusExpressionList: !1 }), "keyboard" === t.device && this.controller.dispatch({ type: "set-focus-location", location: { type: "edit-list-toggle" } }) }, i }(o.Class); t.default = i });
define('main/load-graph-from-link', ["require", "exports", "core/graphing-calc/migrate-state", "tslib", "jquery", "core/lib/deepCopy"], function (require, t, e, r, a, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.default = function (t, s, i) { var d = !1; t.dispatch({ type: "toast/show", toast: { message: t.s("graphing-calculator-text-toast-importing-graph"), hideAfter: 0, toastStyle: "cover", onHide: function () { d = !0 } } }); var l = function () { d || t.dispatch({ type: "toast/show", toast: { message: t.s("graphing-calculator-text-toast-error-importing-graph"), toastStyle: "error", hideAfter: 12e3 } }) }, n = function (e, r) { t.dispatch({ type: "set-state", state: e }), t.dispatch({ type: "toast/show", toast: { message: t.s("graphing-calculator-text-toast-imported-graph"), undoCallback: function () { t.dispatch({ type: "set-state", state: r }) } } }) }; a.getJSON(s).done(function (a) { var s = e.migrateToLatest(a.state); i(s, function (e, s) { e || !s ? l() : function (e, a) { if (!d) { var s = t.getSelectedItem(); if (s) { var i = "folder" === s.type, l = "folder" !== s.type && !!s.folderId, f = i || l, p = {}, c = t.getState(), g = c.expressions.list; if (1 !== g.length || i) { for (var h = e.expressions.list, u = 0; u < h.length; u++) { var y = t.generateId(), v = h[u]; if ("folder" !== v.type) v.folderId ? v.folderId = p[v.folderId] : i ? v.folderId = s.id : l && (v.folderId = s.folderId), v.id = y; else { if (f) return void t.dispatch({ type: "toast/show", toast: { message: t.s("graphing-calculator-text-toast-error-no-folders"), toastStyle: "error", hideAfter: 12e3 } }); p[v.id] = y, v.id = y } } for (var m = o.default(c), I = 0; I < g.length;) { if (g[I].id === s.id) { i && (g[I].title = a); break } I += 1 } var x = i ? I + 1 : I, S = i ? 0 : 1; g.splice.apply(g, r.__spreadArray([x, S], h)), n(c, m) } else n(e, c) } } }(s, a.title || "") }) }).fail(l) } });
define('lib/get-clipboard-data', ["require", "exports"], function (require, a) { "use strict"; Object.defineProperty(a, "__esModule", { value: !0 }), a.default = function (a) { return window.clipboardData && window.clipboardData.getData ? window.clipboardData.getData("Text") : a && a.clipboardData && a.clipboardData.getData ? a.clipboardData.getData("text/plain") : void 0 } });

define('loadcss!expressions/exp-list-resizer', function () { });
define('expressions/exp-list-resizer', ["require", "exports", "tslib", "dcgview", "jquery", "underscore", "loadcss!./exp-list-resizer"], function (require, i, t, e, n, s) { "use strict"; Object.defineProperty(i, "__esModule", { value: !0 }), i.ExpListResizer = void 0; var o = e.Components.If, r = function (i) { function r() { return null !== i && i.apply(this, arguments) || this } return t.__extends(r, i), r.prototype.init = function () { this.guid = s.uniqueId("dcg-exp-list-resize") }, r.prototype.template = function () { var i = this; return e.createElement(o, { predicate: this.bindFn(this.isVisible) }, function () { return e.createElement("div", { class: e.const("dcg-exp-list-resizer"), onTapStart: i.bindFn(i.onTapStart) }) }) }, r.prototype.isVisible = function () { return !this.props.controller().expressionsAreFullWidth() && this.props.controller().isListVisible() }, r.prototype.onTapStart = function (i) { var t = this; this.initialWidth = this.props.controller().getExpListWidth(), this.initialLeft = i.changedTouches[0].clientX, n(document).on("dcg-tapmove." + this.guid, function (i) { if (void 0 !== t.initialLeft && void 0 !== t.initialWidth) { var e = i.changedTouches[0].clientX - t.initialLeft + t.initialWidth; t.props.controller().dispatch({ type: "resize-exp-list", expListWidth: e }) } }), n(document).on("dcg-tapend." + this.guid, this.bindFn(this.onTapEnd)), n(document).on("dcg-tapcancel." + this.guid, this.bindFn(this.onTapEnd)) }, r.prototype.onTapEnd = function () { n(document).off("." + this.guid), this.initialLeft = void 0, this.initialWidth = void 0 }, r }(e.Class); i.ExpListResizer = r });
define('expressions/expression-menus/base-menu-section', ["require", "exports", "tslib", "dcgview", "main/mathquill-operators", "graphing-calc/models/abstract-item"], function (require, t, e, o, i, l) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.BaseMenuSection = void 0; var s = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, o.prototype.getMQConfig = function () { return { autoOperatorNames: i.getAutoOperators() } }, o.prototype.getFocusedInput = function () { var t = this.controller.getFocusLocation(), e = "header" === this.model.type ? this.model.table.id : this.id; if (t && "expression-menu" === t.type && t.id === e) return t.location }, o.prototype.handleFocusedChanged = function (t, e) { var o = "header" === this.model.type ? this.model.table.id : this.id; t ? this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-menu", id: o, location: e } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "expression-menu", id: o, location: e } }) }, o.prototype.onColorSelected = function (t) { "image" !== this.model.type && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-color", id: this.id, color: t }) : this.controller.dispatch({ type: "set-tablecolumn-color", color: t, tableId: this.model.table.id, columnId: this.id })) }, o.prototype.onCustomColorSelected = function (t) { "image" !== this.model.type && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-colorlatex", id: this.id, colorLatex: t }) : this.controller.dispatch({ type: "set-tablecolumn-colorlatex", tableId: this.model.table.id, columnId: this.model.id, colorLatex: t })) }, o.prototype.getModelColor = function () { return "image" === this.model.type ? "" : l.getDisplayColor(this.model) }, o }(o.Class); t.BaseMenuSection = s });

define('loadcss!expressions/toggle-view', function () { });
define('expressions/toggle-view', ["require", "exports", "tslib", "dcgview", "loadcss!./toggle-view"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ToggleView = void 0; var o = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement("div", { class: function () { return { "dcg-toggle-view": !0, "dcg-toggled": e.props.toggled() } }, "aria-label": function () { return e.props.ariaLabel() }, role: n.const("checkbox"), tabindex: n.const("0"), "aria-checked": function () { return e.props.toggled() }, toggled: function () { return e.props.toggled() }, onTap: this.bindFn(this.props.onChange) }, n.createElement("div", { class: n.const("dcg-toggle-switch") })) }, o }(n.Class); e.ToggleView = o });

define('loadcss!expressions/expression-menus/color-picker', function () { });
define('expressions/expression-menus/color-picker', ["require", "exports", "tslib", "dcgview", "underscore", "expressions/colors", "../../lib/mathspeak", "./color-swatch", "../../shared-components/tooltip", "dcgview-helpers/static-mathquill-view", "loadcss!./color-picker"], function (require, e, t, n, o, r, c, s, l, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ColorPicker = void 0; var a = n.Components, u = a.For, p = a.If, d = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.init = function () { this.controller = this.props.controller() }, a.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-color-picker-container") }, n.createElement(u, { each: function () { return o.values(e.controller.getColors()) } }, n.createElement("span", { class: n.const("dcg-color-picker-menu dcg-do-not-blur") }, function (t) { return n.createElement("span", { class: n.const("dcg-color-tile"), handleevent: n.const("true"), role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return r.getColorName(e.controller, t) }, "aria-pressed": function () { return e.isSelected(t) }, onTap: function () { return e.props.onColorSelected(t) } }, n.createElement("span", { class: n.const("dcg-color-swatch"), style: function () { return { background: t } } }), n.createElement(p, { predicate: function () { return e.isSelected(t) } }, function () { return n.createElement("i", { class: n.const("dcg-icon-check"), "aria-hidden": n.const("true") }) })) })), n.createElement(p, { predicate: function () { return e.getUniqueCustomColors().length > 0 } }, function () { return n.createElement(u, { each: e.bindFn(e.getUniqueCustomColors), key: function (e) { return "string" == typeof e ? e : e.assignmentLatex } }, n.createElement("span", { class: n.const("dcg-color-picker-menu dcg-do-not-blur") }, function (t) { return "string" == typeof t ? n.createElement("span", { class: n.const("dcg-color-picker-placeholder") }) : n.createElement(l.Tooltip, { tooltip: function () { return t.assignmentLatex }, renderAsLatex: function () { return { view: function (t) { return n.createElement(i.default, { config: e.const({}), latex: function () { return t } }) } } } }, n.createElement("span", { class: n.const("dcg-color-tile"), handleevent: n.const("true"), role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return c.getMathspeakFromText(t.assignmentLatex) }, "aria-pressed": function () { return e.props.colorLatex() === t.assignmentLatex }, onTap: function () { return e.props.onCustomColorSelected(t.assignmentLatex) } }, n.createElement(s.ColorSwatch, { color: function () { return e.getColorValue(t) } }), n.createElement(p, { predicate: function () { return e.props.colorLatex() === t.assignmentLatex } }, function () { return n.createElement("i", { class: function () { return e.getCheckmarkClass(t) }, "aria-hidden": n.const("true") }) }))) })) })) }, a.prototype.isSelected = function (e) { var t = this.props.colorLatex(); if (t && o.pluck(this.getUniqueCustomColors(), "assignmentLatex").indexOf(t) >= 0) return !1; return this.props.selectedColor() === e }, a.prototype.getUniqueCustomColors = function () { if (this.props.hideCustomColors && this.props.hideCustomColors()) return []; for (var e = this.controller.getAllColorAssignments(), t = o.countBy(e, function (e) { return e.assignmentLatex }), n = o.filter(e, function (e) { return 1 === t[e.assignmentLatex] }), r = 0; r < n.length % 6; r++)n.push("placholder-" + r); return n }, a.prototype.getColorValue = function (e) { return this.controller.getColorById(e.id) }, a.prototype.getCheckmarkClass = function (e) { return r.colorValueHasSomeLightColor(this.getColorValue(e)) ? "dcg-icon-check " + (r.colorValueHasOnlyLightColor(this.getColorValue(e)) ? "dcg-light-color" : "dcg-mixed-color") : "dcg-icon-check" }, a }(n.Class); e.ColorPicker = d });
define('expressions/expression-menus/lines', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "expressions/toggle-view", "core/types/line-opacity", "dcgview-helpers/mathquill-view", "graphing-calc/models/expression", "graphing-calc/models/table", "core/types/line-width", "core/types/styles", "./color-picker", "../../shared-components/tooltip", "loadcss!toggle"], function (require, e, t, n, i, o, l, r, c, s, a, d, p, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LineMenu = void 0; var h = i.Components, g = h.If, y = h.For, m = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-options-menu-section") }, i.createElement("div", { class: i.const("dcg-options-menu-section-title") }, function () { return e.controller.s("graphing-calculator-heading-lines") }, i.createElement(o.ToggleView, { ariaLabel: function () { return e.controller.s("graphing-calculator-narration-lines-visible") }, toggled: this.props.isOpen, onChange: this.bindFn(this.toggleLinesVisible) })), i.createElement(g, { predicate: function () { return e.props.isOpen() } }, function () { return i.createElement("div", { class: i.const("dcg-options-menu-content") }, i.createElement("div", { class: i.const("dcg-options-flex-container") }, i.createElement("div", { class: i.const("dcg-options-left-side") }, i.createElement("div", { class: i.const("dcg-iconed-mathquill-row dcg-line-opacity-row") }, i.createElement(u.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-opacity-tooltip") }, sticky: e.const(!0), gravity: e.const("se") }, i.createElement("i", { class: i.const("dcg-icon-opacity"), "aria-hidden": i.const("true") })), i.createElement(r.default, { latex: function () { return e.model.lineOpacity }, placeholder: function () { return "" + l.DEFAULT }, isFocused: function () { return "lineopacity" === e.getFocusedInput() }, capExpressionSize: function () { return !!e.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-line-opacity") }, getAriaPostLabel: function () { return e.isLineOpacityValid() ? e.controller.raw("") : e.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !e.isLineOpacityValid() }, onUserChangedLatex: function (t) { return e.dispatchLineOpacityLatexIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged(t, "lineopacity") }, dataLabelAttributeValue: e.const("line-opacity") })), i.createElement("div", { class: i.const("dcg-iconed-mathquill-row dcg-line-thickness-row") }, i.createElement(u.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-line-thickness-tooltip") }, sticky: e.const(!0), gravity: e.const("se") }, i.createElement("i", { class: i.const("dcg-icon-line-thickness"), "aria-hidden": i.const("true") })), i.createElement(r.default, { latex: function () { return e.model.lineWidth }, placeholder: function () { return "" + a.DEFAULT }, isFocused: function () { return "linewidth" === e.getFocusedInput() }, capExpressionSize: function () { return !!e.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-label-line-thickness-tooltip") }, getAriaPostLabel: function () { return e.isLineWidthValid() ? e.controller.raw("") : e.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !e.isLineWidthValid() }, onUserChangedLatex: function (t) { return e.dispatchLineWidthLatexIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged(t, "linewidth") }, dataLabelAttributeValue: e.const("line-width") }))), i.createElement("div", { class: i.const("dcg-options-right-side") }, i.createElement(y, { each: function () { return e.getValidLineStyles() } }, i.createElement("div", { class: i.const("dcg-toggle dcg-line-style-toggle"), role: i.const("radiogroup") }, function (t) { return i.createElement("div", { class: function () { return { "dcg-toggle-option": !0, "dcg-selected-toggle": e.model.lineStyle === t } }, onTap: function () { return e.onLineStyleSelected(t) }, role: i.const("radio"), tabindex: i.const("0"), "aria-label": function () { return t === d.LineStyle.SOLID ? e.controller.s("graphing-calculator-narration-line-style-solid") : t === d.LineStyle.DASHED ? e.controller.s("graphing-calculator-narration-line-style-dashed") : t === d.LineStyle.DOTTED ? e.controller.s("graphing-calculator-narration-line-style-dotted") : e.controller.raw("") }, "aria-checked": function () { return e.model.lineStyle === t } }, i.createElement("i", { class: function () { return { "dcg-icon-line-solid": t === d.LineStyle.SOLID, "dcg-icon-line-dashed": t === d.LineStyle.DASHED, "dcg-icon-line-dotted": t === d.LineStyle.DOTTED } }, "aria-hidden": i.const("true") })) })))), i.createElement(g, { predicate: e.props.isFirstOpenSection }, function () { return i.createElement(p.ColorPicker, { controller: e.props.controller, colorLatex: function () { return e.model.colorLatex }, selectedColor: e.bindFn(e.getModelColor), onColorSelected: e.bindFn(e.onColorSelected), onCustomColorSelected: e.bindFn(e.onCustomColorSelected) }) })) })) }, n.prototype.isLineOpacityValid = function () { return "expression" === this.model.type ? c.isLineOpacityValid(this.model) : "header" === this.model.type && s.isLineOpacityValid(this.model) }, n.prototype.isLineWidthValid = function () { return "expression" === this.model.type ? c.isLineWidthValid(this.model) : "header" === this.model.type && s.isLineWidthValid(this.model) }, n.prototype.dispatchLineOpacityLatexIfChanged = function (e) { this.model.lineOpacity !== e && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-lineopacity", id: this.id, lineOpacity: e }) : this.controller.dispatch({ type: "set-tablecolumn-lineopacity", tableId: this.model.table.id, columnId: this.model.id, lineOpacity: e })) }, n.prototype.getValidLineStyles = function () { return "expression" === this.model.type && c.isInequality(this.model) ? [] : [d.LineStyle.SOLID, d.LineStyle.DASHED, d.LineStyle.DOTTED] }, n.prototype.onLineStyleSelected = function (e) { this.model.lineStyle !== e && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-linestyle", id: this.id, lineStyle: e }) : this.controller.dispatch({ type: "set-tablecolumn-linestyle", tableId: this.model.table.id, columnId: this.model.id, lineStyle: e })) }, n.prototype.dispatchLineWidthLatexIfChanged = function (e) { this.model.lineWidth !== e && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-linewidth", id: this.id, lineWidth: e }) : this.controller.dispatch({ type: "set-tablecolumn-linewidth", tableId: this.model.table.id, columnId: this.model.id, lineWidth: e })) }, n.prototype.toggleLinesVisible = function () { "expression" === this.model.type ? this.controller.dispatch({ type: "set-item-lines", id: this.id, lines: !this.props.isOpen() }) : this.controller.dispatch({ type: "set-tablecolumn-lines", tableId: this.model.table.id, columnId: this.model.id, bool: !this.props.isOpen() }) }, n }(n.BaseMenuSection); e.LineMenu = m });
define('expressions/expression-menus/colors-only', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "./color-picker", "graphing-calc/models/expression"], function (require, e, o, t, n, r, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ColorsOnlyMenu = void 0; var s = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return o.__extends(t, e), t.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-options-menu-section") }, n.createElement(r.ColorPicker, { controller: this.props.controller, colorLatex: function () { return e.model.colorLatex }, selectedColor: this.bindFn(this.getModelColor), onColorSelected: this.bindFn(this.onColorSelected), onCustomColorSelected: this.bindFn(this.onCustomColorSelected), hideCustomColors: function () { return "expression" === e.model.type && l.isRegression(e.model) } })) }, t }(t.BaseMenuSection); e.ColorsOnlyMenu = s });
define('expressions/expression-menus/fill', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "expressions/toggle-view", "dcgview-helpers/mathquill-view", "graphing-calc/models/expression", "core/types/opacity", "./color-picker", "../../shared-components/tooltip"], function (require, e, t, n, o, i, r, l, c, s, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.FillMenu = void 0; var p = o.Components.If, u = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, n.prototype.template = function () { var e = this; return o.createElement("div", { class: o.const("dcg-options-menu-section") }, o.createElement("div", { class: o.const("dcg-options-menu-section-title") }, function () { return e.controller.s("graphing-calculator-heading-fill") }, o.createElement(p, { predicate: function () { return !e.isInequality() } }, function () { return o.createElement(i.ToggleView, { ariaLabel: function () { return e.controller.s("graphing-calculator-narration-fill-visible") }, toggled: e.props.isOpen, onChange: e.bindFn(e.toggleFillVisible) }) })), o.createElement(p, { predicate: this.props.isOpen }, function () { return o.createElement("div", { class: o.const("dcg-options-menu-content") }, o.createElement("div", { class: o.const("dcg-iconed-mathquill-row dcg-fill-opacity-row") }, o.createElement(a.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-opacity-tooltip") }, sticky: e.const(!0), gravity: e.const("se") }, o.createElement("i", { class: o.const("dcg-icon-opacity"), "aria-hidden": o.const("true") })), o.createElement(r.default, { latex: function () { return e.model.fillOpacity }, placeholder: function () { return "" + c.DEFAULT }, isFocused: function () { return "opacity" === e.getFocusedInput() }, capExpressionSize: function () { return !!e.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-fill-opacity") }, getAriaPostLabel: function () { return l.isFillOpacityValid(e.model) ? e.controller.raw("") : e.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !l.isFillOpacityValid(e.model) }, onUserChangedLatex: function (t) { return e.dispatchOpacityLatexIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged(t, "opacity") }, dataLabelAttributeValue: e.const("fill-opacity"), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } })), o.createElement(p, { predicate: e.props.isFirstOpenSection }, function () { return o.createElement(s.ColorPicker, { controller: e.props.controller, colorLatex: function () { return e.model.colorLatex }, selectedColor: e.bindFn(e.getModelColor), onColorSelected: e.bindFn(e.onColorSelected), onCustomColorSelected: e.bindFn(e.onCustomColorSelected) }) })) })) }, n.prototype.isInequality = function () { return l.isInequality(this.model) }, n.prototype.toggleFillVisible = function () { this.controller.dispatch({ type: "set-item-fill", id: this.id, fill: !this.props.isOpen() }) }, n.prototype.dispatchOpacityLatexIfChanged = function (e) { this.model.fillOpacity !== e && this.controller.dispatch({ type: "set-item-fillopacity", id: this.id, fillOpacity: e }) }, n }(n.BaseMenuSection); e.FillMenu = u });

define('loadcss!expressions/clickable_image_states_view', function () { });
define('expressions/clickable_image_states_view', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip", "./image-upload-view", "loadcss!./clickable_image_states_view"], function (require, e, t, r, o, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ClickableImageStatesView = void 0; var n = r.Components, l = n.If, i = n.Switch, c = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, n.prototype.template = function () { var e = this; return r.createElement("div", { class: r.const("dcg-clickable-image-info-view"), role: r.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-clickable-image-options") } }, r.createElement("div", { class: r.const("dcg-clickable-image-state-container") }, r.createElement(o.Tooltip, { tooltip: function () { return e.tooltip("hovered") }, gravity: this.const("s") }, r.createElement(a.ImageUploadView, { controller: function () { return e.controller }, ariaLabel: function () { return e.tooltip("hovered") }, onFileChange: function (t) { return e.updateImage("hovered", t) } }, r.createElement(i, { key: this.bindFn(this.hoveredStatus) }, function () { return r.createElement("div", { class: r.const("dcg-clickable-image-state"), style: function () { return e.getStyleForState("hovered") } }) }))), r.createElement(l, { predicate: function () { return !!e.model.clickableInfo.hoveredImage } }, function () { return r.createElement("div", { class: r.const("dcg-clickable-image-state-close"), onTap: function () { return e.removeImageState("hovered") }, ariaLabel: function () { return e.controller.s("graphing-calculator-label-remove-hovered-image") }, role: r.const("button"), tabIndex: r.const(0) }, r.createElement("i", { class: r.const("dcg-icon-remove"), "aria-hidden": r.const("true") })) }), r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-clickable-image-label") }, function () { return e.controller.s("graphing-calculator-label-hovered") })), r.createElement("div", { class: r.const("dcg-clickable-image-state-container") }, r.createElement(o.Tooltip, { tooltip: function () { return e.tooltip("depressed") }, gravity: this.const("s") }, r.createElement(a.ImageUploadView, { controller: function () { return e.controller }, ariaLabel: function () { return e.tooltip("depressed") }, onFileChange: function (t) { return e.updateImage("depressed", t) } }, r.createElement(i, { key: this.bindFn(this.depressedStatus) }, function () { return r.createElement("div", { class: r.const("dcg-clickable-image-state"), style: function () { return e.getStyleForState("depressed") } }) }))), r.createElement(l, { predicate: function () { return !!e.model.clickableInfo.depressedImage } }, function () { return r.createElement("div", { class: r.const("dcg-clickable-image-state-close"), onTap: function () { return e.removeImageState("depressed") }, ariaLabel: function () { return e.controller.s("graphing-calculator-label-remove-depressed-image") }, role: r.const("button"), tabIndex: r.const(0) }, r.createElement("i", { class: r.const("dcg-icon-remove"), "aria-hidden": r.const("true") })) }), r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-clickable-image-label") }, function () { return e.controller.s("graphing-calculator-label-depressed") }))) }, n.prototype.hoveredStatus = function () { return this.hoveredUploading ? "loading" : "background" }, n.prototype.depressedStatus = function () { return this.depressedUploading ? "loading" : "background" }, n.prototype.tooltip = function (e) { return ("hovered" === e ? this.model.clickableInfo.hoveredImage : this.model.clickableInfo.depressedImage) ? "depressed" === e ? this.controller.s("graphing-calculator-label-change-depressed-image-tooltip") : this.controller.s("graphing-calculator-label-change-hovered-image-tooltip") : "depressed" === e ? this.controller.s("graphing-calculator-label-add-depressed-image-tooltip") : this.controller.s("graphing-calculator-label-add-hovered-image-tooltip") }, n.prototype.getImageURLForState = function (e) { var t; if ("hovered" === e) { if ("background" !== this.hoveredStatus()) return ""; t = "hoveredImage" } else { if ("background" !== this.depressedStatus()) return ""; t = "depressedImage" } var r = this.model.clickableInfo[t]; return r ? "url(" + r + ")" : "url(" + this.model.image_url + ")" }, n.prototype.getStyleForState = function (e) { var t = { "background-image": this.getImageURLForState(e), opacity: 1 }; return "hovered" !== e || this.model.clickableInfo.hoveredImage || (t.opacity = .5), t }, n.prototype.removeImageState = function (e) { "hovered" === e ? this.controller.dispatch({ type: "set-hovered-image", id: this.model.id, url: "" }) : this.controller.dispatch({ type: "set-depressed-image", id: this.model.id, url: "" }) }, n.prototype.updateImage = function (e, t) { var r = this; if (t && t[0]) { var o = t[0]; "hovered" === e && (this.hoveredUploading = !0), "depressed" === e && (this.depressedUploading = !0), this.controller.getGraphSettings().config.imageUploadCallback(o, function (t, o) { "hovered" === e && (r.hoveredUploading = !1), "depressed" === e && (r.depressedUploading = !1), !t && o && ("hovered" === e ? r.controller.dispatch({ type: "set-hovered-image", id: r.model.id, url: o }) : r.controller.dispatch({ type: "set-depressed-image", id: r.model.id, url: o })) }) } }, n }(r.Class); e.ClickableImageStatesView = c });
define('vendor/html-parse-stringify2', [], function () { return function (e) { var t = {}; function n(r) { if (t[r]) return t[r].exports; var o = t[r] = { i: r, l: !1, exports: {} }; return e[r].call(o.exports, o, o.exports, n), o.l = !0, o.exports } return n.m = e, n.c = t, n.d = function (e, t, r) { n.o(e, t) || Object.defineProperty(e, t, { enumerable: !0, get: r }) }, n.r = function (e) { "undefined" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, { value: "Module" }), Object.defineProperty(e, "__esModule", { value: !0 }) }, n.t = function (e, t) { if (1 & t && (e = n(e)), 8 & t) return e; if (4 & t && "object" == typeof e && e && e.__esModule) return e; var r = Object.create(null); if (n.r(r), Object.defineProperty(r, "default", { enumerable: !0, value: e }), 2 & t && "string" != typeof e) for (var o in e) n.d(r, o, function (t) { return e[t] }.bind(null, o)); return r }, n.n = function (e) { var t = e && e.__esModule ? function () { return e.default } : function () { return e }; return n.d(t, "a", t), t }, n.o = function (e, t) { return Object.prototype.hasOwnProperty.call(e, t) }, n.p = "", n(n.s = 0) }([function (e, t, n) { e.exports = { parse: n(1), stringify: n(4) } }, function (e, t, n) { var r = /(?:<!--[\S\s]*?-->|<(?:"[^"]*"['"]*|'[^']*'['"]*|[^'">])+>)/g, o = n(2), i = Object.create ? Object.create(null) : {}; function c(e, t, n, r, o) { var i = t.indexOf("<", r), c = t.slice(r, -1 === i ? void 0 : i); /^\s*$/.test(c) && (c = " "), (!o && i > -1 && n + e.length >= 0 || " " !== c) && e.push({ type: "text", content: c }) } e.exports = function (e, t) { t || (t = {}), t.components || (t.components = i); var n, u = [], a = -1, l = [], f = {}, p = !1; return e.replace(r, function (r, i) { if (p) { if (r !== "</" + n.name + ">") return; p = !1 } var s, d = "/" !== r.charAt(1), m = 0 === r.indexOf("\x3c!--"), g = i + r.length, v = e.charAt(g); d && !m && (a++, "tag" === (n = o(r)).type && t.components[n.name] && (n.type = "component", p = !0), n.voidElement || p || !v || "<" === v || c(n.children, e, a, g, t.ignoreWhitespace), f[n.tagName] = n, 0 === a && u.push(n), (s = l[a - 1]) && s.children.push(n), l[a] = n), (m || !d || n.voidElement) && (m || a--, !p && "<" !== v && v && c(s = -1 === a ? u : l[a].children, e, a, g, t.ignoreWhitespace)) }), !u.length && e.length && c(u, e, 0, 0, t.ignoreWhitespace), u } }, function (e, t, n) { var r = /([\w-]+)|=|(['"])([.\s\S]*?)\2/g, o = n(3); e.exports = function (e) { var t, n = 0, i = !0, c = { type: "tag", name: "", voidElement: !1, attrs: {}, children: [] }; return e.replace(r, function (r) { if ("=" === r) return i = !0, void n++; i ? 0 === n ? ((o[r] || "/" === e.charAt(e.length - 2)) && (c.voidElement = !0), c.name = r) : (c.attrs[t] = r.replace(/^['"]|['"]$/g, ""), t = void 0) : (t && (c.attrs[t] = t), t = r), n++, i = !1 }), c } }, function (e, t) { e.exports = { area: !0, base: !0, br: !0, col: !0, embed: !0, hr: !0, img: !0, input: !0, keygen: !0, link: !0, menuitem: !0, meta: !0, param: !0, source: !0, track: !0, wbr: !0 } }, function (e, t) { function n(e, t) { switch (t.type) { case "text": return e + t.content; case "tag": return e += "<" + t.name + (t.attrs ? function (e) { var t = []; for (var n in e) t.push(n + '="' + e[n] + '"'); return t.length ? " " + t.join(" ") : "" }(t.attrs) : "") + (t.voidElement ? "/>" : ">"), t.voidElement ? e : e + t.children.reduce(n, "") + "</" + t.name + ">" } } e.exports = function (e) { return e.reduce(function (e, t) { return e + n("", t) }, "") } }]) });
define('l10n-tools/localize-serializer', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.serializeToTemplateString = e.variableRegexp = void 0, e.variableRegexp = /\{\$([a-zA-Z0-9\-]+([a-zA-Z0-9\-]+_)*[a-zA-Z0-9\-]+)\}/, e.serializeToTemplateString = function (i, n) { var r = 0, t = 0, a = {}, d = {}, o = function o(l) { if (n.isConst(l)) return n.getConstValue(l); if (n.isNamedBinding(l)) { var u = "{$" + (f = s(a, n.getBindingName(l))) + "}"; if (!e.variableRegexp.test(u)) throw new Error("Invalid <Localize> variable: " + u + "."); return n.addBinding && n.addBinding(f, l), a[f] = !0, u } if (l !== i && n.isView(l)) { var f = s(d, n.getViewName(l)); if (!/[a-zA-Z0-9\-_]/.test(f)) throw new Error("Invalid <Localize> subview identifier: " + f + "."); return n.addView && n.addView(f, l), d[f] = !0, "<" + f + "/>" } if (n.isBinding(l)) { u = "{$" + (f = s(a, "v" + r++)) + "}"; return n.addBinding && n.addBinding(f, l), a[f] = !0, u } f = "" + t++; n.addElement && n.addElement(f, l); var g = []; return n.forEachChild(l, function (e) { g.push(o(e)) }), d[f] = !0, g.length > 0 ? "<" + f + ">" + g.join("") + "</" + f + ">" : "<" + f + "/>" }(i); if (!/^<0>/.test(o) || !/<\/0>$/.test(o)) throw new Error("Expected template string to start and end with <0> and </0>, but found " + JSON.stringify(o)); return o.slice(3, -4).trim(); function s(e, i) { for (var n = 0, r = i; e[r];)r = i + "-" + ++n; return r } } });
define('shared/dcgviews/localize', ["require", "exports", "tslib", "dcgview", "vendor/html-parse-stringify2", "l10n-tools/localize-serializer", "lib/i18n"], function (require, e, t, n, i, r, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: true }); e.Localize = void 0; function o(e) { return e.__DCGViewLocalizeBindingName } function s(e) { return typeof e === "function" && e.__DCGViewLocalizeViewName } var u = function (e) { t.__extends(u, e); function u() { return e !== null && e.apply(this, arguments) || this } u.prototype.init = function () { this.viewMap = {}; this.elementMap = {}; this.bindingMap = {}; this.i18n = this.props.i18n(); this.templateString = this.serializeToTemplateString(n.createElement("div", null, this.children)) }; u.prototype.template = function () { var e = this; return n.createElement(n.Components.If, { predicate: function () { return e.shouldShow() } }, function () { return n.createElement(n.Components.Switch, { key: function () { return c(e.translatedString()) } }, function (t) { return e.renderDeserializedTemplateNode(e.parseAndValidate(t)) }) }) }; u.prototype.shouldShow = function () { var e = this.props.options && this.props.options(); if (e && e.hideUntranslatedView && this.i18n.hasTranslation) { return this.i18n.hasTranslation(this.props.key()) } return true }; u.prototype.translatedString = function () { var e = {}; for (var t in this.bindingMap) { e[t] = a.raw("{$" + t + "}") } return this.i18n.s(this.props.key(), e) }; u.variable = function (e, t) { var n = function () { return t() }; n.__DCGViewLocalizeBindingName = e; return n }; u.subview = function (e, t) { var n = function () { return t() }; n.__DCGViewLocalizeViewName = e; return n }; u.prototype.parseAndValidate = function (e) { var t = i.parse(e); var n = {}; var r = {}; o(t); for (var a in this.elementMap) { if (!r[a]) { return i.parse(c(this.templateString)) } } for (var a in this.bindingMap) { if (!n[a]) { return i.parse(c(this.templateString)) } } return t; function o(e) { if (Array.isArray(e)) { for (var t = 0, i = e; t < i.length; t++) { var a = i[t]; o(a) } return } if (e.name === "token") { n[e.attrs.id] = true } else if (e.type !== "text") { r[e.name] = true; o(e.children) } } }; u.prototype.renderDeserializedTemplateNode = function (e) { var t = this; if (Array.isArray(e)) { return e.map(function (e) { return t.renderDeserializedTemplateNode(e) }) } if (e.type === "text") { return n.const(e.content || "") } else if (e.name === "token") { var i = this.bindingMap[e.attrs.id]; if (!i) { return function () { return "" } } return i } else { if (this.elementMap[e.name]) { var r = this.elementMap[e.name]; var a = e.children.map(function (e) { return t.renderDeserializedTemplateNode(e) }); return p(r.type, r.attrs, a) } else if (this.viewMap[e.name]) { return this.viewMap[e.name]() } else { return p("span", {}, []) } } }; u.prototype.serializeToTemplateString = function (e) { var t = this; return r.serializeToTemplateString(e, { isView: s, isConst: l, isBinding: function (e) { return typeof e === "function" }, isNamedBinding: o, getConstValue: function (e) { return e() }, getBindingName: function (e) { return e.__DCGViewLocalizeBindingName }, getViewName: function (e) { return e.__DCGViewLocalizeViewName }, addBinding: function (e, n) { t.bindingMap[e] = n }, addElement: function (e, n) { t.elementMap[e] = { type: n.tagName, attrs: n.attrs } }, addView: function (e, n) { if (t.viewMap[e]) { throw new Error("Unexpected duplicate view " + e + ".") } t.viewMap[e] = n }, forEachChild: function (e, t) { for (var n = 0, i = e.children; n < i.length; n++) { var r = i[n]; if (!l(r) && typeof r !== "function" && r._isDCGView) { throw new Error("Bare DCGViews are not allowed inside <Localize>. Use Localize.subview().") } t(r) } } }) }; return u }(n.Class); e.Localize = u; function l(e) { return typeof e === "function" && e.isDCGViewConst } function p(e, t, i) { var r = n; return r.createElement(e, t, i) } function c(e) { var t = "<0>" + e + "</0>"; return t.replace(new RegExp(r.variableRegexp.source, "g"), function (e, t) { return '<token id="' + t + '"/>' }) } });

define('loadcss!expressions/expression-menus/clickable', function () { });
define('expressions/expression-menus/clickable', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "expressions/toggle-view", "dcgview-helpers/mathquill-view", "main/mathquill-operators", "expressions/clickable_image_states_view", "../../dcgview-helpers/tooltipped-error", "../../shared/dcgviews/localize", "loadcss!./clickable"], function (require, e, t, n, r, o, c, i, l, a, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ClickableMenu = void 0; var d = r.Components, u = d.If, p = d.IfDefined, h = d.Textarea, g = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, n.prototype.template = function () { var e = this; return r.createElement("div", { class: r.const("dcg-options-menu-section dcg-clickable-section") }, r.createElement("div", { class: r.const("dcg-options-menu-section-title") }, function () { return e.controller.s("graphing-calculator-heading-clickable") }, r.createElement(o.ToggleView, { ariaLabel: function () { return e.controller.s("graphing-calculator-narration-make-clickable") }, toggled: this.props.isOpen, onChange: this.bindFn(this.toggleClickable) })), r.createElement(u, { predicate: this.props.isOpen }, function () { return r.createElement("div", { class: r.const("dcg-options-menu-content") }, r.createElement("div", { class: r.const("dcg-clickable-menu-row") }, r.createElement("span", { class: r.const("dcg-input-label") }, function () { return e.controller.s("graphing-calculator-label-update-on-click") }), r.createElement(c.default, { latex: function () { return e.model.clickableInfo.latex }, placeholder: e.const(""), isFocused: function () { return "updaterule" === e.getFocusedInput() }, capExpressionSize: function () { return !!e.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-click-action") }, getAriaPostLabel: e.const(""), hasError: function () { return e.hasError() }, onUserChangedLatex: function (t) { return e.dispatchUpdateRuleLatexIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged(t, "updaterule") }, dataLabelAttributeValue: e.const("click-handler"), needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() } }), p(function () { return e.packedError() }, function (t) { return r.createElement("span", { class: r.const("dcg-clickable-info-error-container") }, r.createElement(a.TooltippedError, { error: function () { return e.controller.unpack(t()) }, gravity: e.const("s"), size: e.const("small") })) })), r.createElement(u, { predicate: e.bindFn(e.isList) }, function () { return r.createElement("div", { class: r.const("dcg-clickable-list-index-notice") }, r.createElement(s.Localize, { i18n: e.const(e.controller), key: e.const("graphing-calculator-label-list-index") }, r.const("Use"), r.const(" "), r.createElement("span", { class: function () { return { "dcg-index-variable-marker": !0, "dcg-btn": !0, "dcg-btn-light-gray": !0, "dcg-mathquill-has-focus": "updaterule" === e.getFocusedInput(), "dcg-do-not-blur": !0 } }, onTap: e.bindFn(e.insertIndex) }, r.const("index")), r.const(" "), r.const("to reference the clicked index in the list."))) }), r.createElement(u, { predicate: function () { return "image" !== e.model.type } }, function () { return r.createElement(h, { placeholder: function () { return e.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder") }, value: function () { return e.model.description }, onInput: function (t) { return e.controller.dispatch({ type: "set-item-description", id: e.model.id, description: t }) } }) }), r.createElement(u, { predicate: function () { return "image" === e.model.type } }, function () { return r.createElement("div", { class: r.const("dcg-clickable-menu-row") }, r.createElement(l.ClickableImageStatesView, { controller: function () { return e.controller }, model: function () { return e.model } })) })) })) }, n.prototype.insertIndex = function () { this.controller.dispatch({ type: "keypad/type-text", text: "index" }) }, n.prototype.isList = function () { return !!this.model.formula && !!this.model.formula.is_concrete_list }, n.prototype.hasError = function () { return void 0 !== this.packedError() }, n.prototype.packedError = function () { if (this.model.formula.click_handler && "error" === this.model.formula.click_handler.status) return this.model.formula.click_handler.error }, n.prototype.toggleClickable = function () { this.controller.dispatch({ type: "set-clickableinfo-prop", id: this.model.id, prop: "enabled", value: !this.model.clickableInfo.enabled }), this.model.clickableInfo.enabled && this.handleFocusedChanged(!0, "updaterule") }, n.prototype.dispatchUpdateRuleLatexIfChanged = function (e) { this.model.clickableInfo.latex !== e && this.controller.dispatch({ type: "set-clickableinfo-rule-latex", id: this.id, latex: e }) }, n.prototype.getMQConfig = function () { return { autoOperatorNames: i.getAutoOperators({ additionalOperators: ["index"] }), autoCommands: i.getAutoCommands() } }, n }(n.BaseMenuSection); e.ClickableMenu = g });
define('expressions/expression-menus/points', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "expressions/toggle-view", "dcgview-helpers/mathquill-view", "graphing-calc/models/expression", "graphing-calc/models/table", "core/types/point-opacity", "core/lib/dragmode", "core/types/point-size", "core/types/styles", "./color-picker", "../../shared-components/tooltip"], function (require, t, e, o, n, i, r, l, c, s, a, p, d, u, h) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.PointsMenu = void 0; var g = n.Components, m = g.If, y = g.For, f = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-options-menu-section") }, n.createElement("div", { class: n.const("dcg-options-menu-section-title") }, function () { return t.controller.s("graphing-calculator-heading-points") }, n.createElement(i.ToggleView, { ariaLabel: function () { return t.controller.s("graphing-calculator-narration-points-visible") }, toggled: this.props.isOpen, onChange: this.bindFn(this.togglePointsVisible) })), n.createElement(m, { predicate: this.props.isOpen }, function () { return n.createElement("div", { class: n.const("dcg-options-menu-content") }, n.createElement("div", { class: n.const("dcg-options-flex-container") }, n.createElement("div", { class: n.const("dcg-options-left-side") }, n.createElement("div", { class: n.const("dcg-iconed-mathquill-row dcg-point-opacity-row") }, n.createElement(h.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-opacity-tooltip") }, sticky: t.const(!0), gravity: t.const("se") }, n.createElement("i", { class: n.const("dcg-icon-opacity"), "aria-hidden": n.const("true") })), n.createElement(r.default, { latex: function () { return t.model.pointOpacity }, placeholder: t.bindFn(t.getPointOpacityPlaceholder), isFocused: function () { return "pointopacity" === t.getFocusedInput() }, capExpressionSize: function () { return !!t.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: t.const(!0), config: t.bindFn(t.getMQConfig), getAriaLabel: function () { return t.controller.s("graphing-calculator-narration-point-opacity") }, getAriaPostLabel: function () { return t.isPointOpacityValid() ? t.controller.raw("") : t.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !t.isPointOpacityValid() }, onUserChangedLatex: function (e) { return t.dispatchPointOpacityLatexIfChanged(e) }, onExpressionSizeExceeded: function () { return t.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (e) { return t.handleFocusedChanged(e, "pointopacity") }, dataLabelAttributeValue: t.const("point-opacity") })), n.createElement(m, { predicate: function () { return !t.isDraggable() } }, function () { return n.createElement("div", { class: n.const("dcg-iconed-mathquill-row") }, n.createElement(h.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-point-size-tooltip") }, gravity: t.const("se"), sticky: t.const(!0) }, n.createElement("i", { class: n.const("dcg-icon-line-thickness"), "aria-hidden": n.const("true") })), n.createElement(r.default, { latex: function () { return t.model.pointSize }, placeholder: t.bindFn(t.getDefaultPointSize), isFocused: function () { return "pointsize" === t.getFocusedInput() }, capExpressionSize: function () { return !!t.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: t.const(!0), config: t.bindFn(t.getMQConfig), getAriaLabel: function () { return t.controller.s("graphing-calculator-narration-point-size") }, getAriaPostLabel: function () { return t.isPointSizeValid() ? t.controller.raw("") : t.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !t.isPointSizeValid() }, onUserChangedLatex: function (e) { return t.dispatchPointSizeLatexIfChanged(e) }, onExpressionSizeExceeded: function () { return t.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (e) { return t.handleFocusedChanged(e, "pointsize") }, dataLabelAttributeValue: t.const("point-size") })) })), n.createElement("div", { class: n.const("dcg-options-right-side") }, n.createElement(m, { predicate: function () { return !t.isDraggable() } }, function () { return n.createElement(y, { each: function () { return [d.PointStyle.POINT, d.PointStyle.OPEN, d.PointStyle.CROSS] } }, n.createElement("div", { class: n.const("dcg-toggle dcg-point-style-toggle"), role: n.const("radiogroup") }, function (e) { return n.createElement("div", { class: function () { return { "dcg-toggle-option": !0, "dcg-selected-toggle": t.model.pointStyle === e } }, onTap: function () { return t.onPointStyleSelected(e) }, role: n.const("radio"), tabindex: n.const("0"), "aria-label": function () { return e === d.PointStyle.POINT ? t.controller.s("graphing-calculator-narration-point-style-point") : e === d.PointStyle.OPEN ? t.controller.s("graphing-calculator-narration-point-style-open") : e === d.PointStyle.CROSS ? t.controller.s("graphing-calculator-narration-point-style-cross") : t.controller.raw("") }, "aria-checked": function () { return t.model.pointStyle === e } }, n.createElement("i", { class: function () { return { "dcg-icon-point": e === d.PointStyle.POINT, "dcg-icon-open": e === d.PointStyle.OPEN, "dcg-icon-cross": e === d.PointStyle.CROSS } }, "aria-hidden": n.const("true") })) })) }))), n.createElement(m, { predicate: t.props.isFirstOpenSection }, function () { return n.createElement(u.ColorPicker, { controller: t.props.controller, colorLatex: function () { return t.model.colorLatex }, selectedColor: t.bindFn(t.getModelColor), onColorSelected: t.bindFn(t.onColorSelected), onCustomColorSelected: t.bindFn(t.onCustomColorSelected) }) })) })) }, o.prototype.isPointOpacityValid = function () { return "expression" === this.model.type ? l.isPointOpacityValid(this.model) : "header" === this.model.type && c.isPointOpacityValid(this.model) }, o.prototype.isPointSizeValid = function () { return "expression" === this.model.type ? l.isPointSizeValid(this.model) : "header" === this.model.type && c.isPointSizeValid(this.model) }, o.prototype.onPointStyleSelected = function (t) { this.model.pointStyle !== t && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-pointstyle", id: this.id, pointStyle: t }) : this.controller.dispatch({ type: "set-tablecolumn-pointstyle", columnId: this.model.id, tableId: this.model.table.id, pointStyle: t })) }, o.prototype.dispatchPointSizeLatexIfChanged = function (t) { this.model.pointSize !== t && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-pointsize", id: this.id, pointSize: t }) : this.controller.dispatch({ type: "set-tablecolumn-pointsize", columnId: this.model.id, tableId: this.model.table.id, pointSize: t })) }, o.prototype.isDraggable = function () { return this.getDragMode() !== a.DragMode.NONE }, o.prototype.togglePointsVisible = function () { "expression" === this.model.type && l.isSinglePoint(this.model) ? this.controller.dispatch({ type: "toggle-item-hidden", id: this.model.id }) : "expression" === this.model.type ? this.controller.dispatch({ type: "set-item-points", id: this.id, points: !this.props.isOpen() }) : this.controller.dispatch({ type: "set-tablecolumn-points", columnId: this.model.id, tableId: this.model.table.id, bool: !this.props.isOpen() }) }, o.prototype.dispatchPointOpacityLatexIfChanged = function (t) { this.model.pointOpacity !== t && ("expression" === this.model.type ? this.controller.dispatch({ type: "set-item-pointopacity", id: this.id, pointOpacity: t }) : this.controller.dispatch({ type: "set-tablecolumn-pointopacity", columnId: this.model.id, tableId: this.model.table.id, pointOpacity: t })) }, o.prototype.getPointOpacityPlaceholder = function () { return this.getDragMode() === a.DragMode.NONE ? "" + s.DEFAULT : "1" }, o.prototype.getDragMode = function () { return "expression" === this.model.type && this.model.reconciledDragMode || this.model.dragMode }, o.prototype.getDefaultPointSize = function () { return "expression" === this.model.type && l.isDotPlot(this.model) ? "" + p.DOTPLOT_DEFAULT : "" + p.DEFAULT }, o }(o.BaseMenuSection); t.PointsMenu = f });

define('loadcss!expressions/expression-menus/label-orientation-view', function () { });
define('expressions/expression-menus/label-orientation-view', ["require", "exports", "tslib", "dcgview", "core/types/label-orientations", "graphing-calc/models/expression", "loadcss!./label-orientation-view", "loadcss!toggle"], function (require, t, e, i, n, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.LabelOrientationView = void 0; var a = i.Components.For, r = [{ orientation: n.LabelOrientation.DEFAULT, cssClass: "dcg-label-orientation-center", description: "graphing-calculator-text-label-orientation-default" }, { orientation: n.LabelOrientation.ABOVE, cssClass: "dcg-label-orientation-above", description: "graphing-calculator-text-label-orientation-above" }, { orientation: n.LabelOrientation.ABOVE_RIGHT, cssClass: "dcg-label-orientation-above-right", description: "graphing-calculator-text-label-orientation-above-right" }, { orientation: n.LabelOrientation.RIGHT, cssClass: "dcg-label-orientation-right", description: "graphing-calculator-text-label-orientation-right" }, { orientation: n.LabelOrientation.BELOW_RIGHT, cssClass: "dcg-label-orientation-below-right", description: "graphing-calculator-text-label-orientation-below-right" }, { orientation: n.LabelOrientation.BELOW, cssClass: "dcg-label-orientation-below", description: "graphing-calculator-text-label-orientation-below" }, { orientation: n.LabelOrientation.BELOW_LEFT, cssClass: "dcg-label-orientation-below-left", description: "graphing-calculator-text-label-orientation-below-left" }, { orientation: n.LabelOrientation.LEFT, cssClass: "dcg-label-orientation-left", description: "graphing-calculator-text-label-orientation-left" }, { orientation: n.LabelOrientation.ABOVE_LEFT, cssClass: "dcg-label-orientation-above-left", description: "graphing-calculator-text-label-orientation-above-left" }], l = function (t) { function l() { return null !== t && t.apply(this, arguments) || this } return e.__extends(l, t), l.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, l.prototype.template = function () { var t = this; return i.createElement("div", { class: i.const("dcg-label-orientation-view"), style: function () { return "transform: rotate(" + t.getCSSRotationValue() + ");" } }, i.createElement("span", { class: i.const("dcg-vertical-orientation-indicator") }), i.createElement(a, { each: function () { return r }, key: function (t) { return t.orientation } }, i.createElement("div", { class: i.const("dcg-label-orientations"), role: i.const("radiogroup"), "aria-label": function () { return t.controller.s("graphing-calculator-heading-label-orientation") } }, function (e) { return i.createElement("div", { class: function () { var i; return (i = {})[e.cssClass] = !0, i["dcg-orientation-option"] = !0, i["dcg-selected"] = t.isSelected(e.orientation), i["dcg-orientation-disabled"] = t.isDisabled(e.orientation), i }, role: i.const("radio"), tabindex: i.const("0"), "aria-label": function () { return t.controller.s(e.description) }, "aria-checked": function () { return t.getOrientation() === e.orientation }, onTap: function () { return t.onTapOrientation(e.orientation) } }, i.createElement("i", { class: function () { return { "dcg-icon-chevron-left": e.orientation !== n.LabelOrientation.DEFAULT } } })) }))) }, l.prototype.isDisabled = function (t) { return t === n.LabelOrientation.DEFAULT && (!!this.isPointVisible() || this.model.labelOrientation === n.LabelOrientation.DEFAULT) }, l.prototype.isSelected = function (t) { return t === n.LabelOrientation.DEFAULT && t === this.model.labelOrientation ? !this.isPointVisible() : t === this.model.labelOrientation }, l.prototype.isPointVisible = function () { return !this.model.hidden && (o.isSinglePoint(this.model) ? !this.model.hidden : this.model.points) }, l.prototype.getCSSRotationValue = function () { var t = o.getLabelAngleValue(this.model); return (Array.isArray(t) ? 0 : t) + "rad" }, l.prototype.getOrientation = function () { return this.props.model().labelOrientation }, l.prototype.onTapOrientation = function (t) { t === this.getOrientation() && (t = n.LabelOrientation.DEFAULT), this.controller.dispatch({ type: "set-item-label-orientation", id: this.id, labelOrientation: t }) }, l }(i.Class); t.LabelOrientationView = l });
define('expressions/expression-menus/label', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "expressions/toggle-view", "dcgview-helpers/mathquill-view", "graphing-calc/models/expression", "core/types/label-sizes", "./label-orientation-view", "./color-picker", "dcgview-helpers/checkbox", "core/lib/dragmode", "core/graphing-calc/json/expression", "core/math/interpolatedlabel", "../../shared-components/tooltip"], function (require, e, t, n, o, l, i, r, a, c, s, d, u, p, b, g) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LabelMenu = void 0; var h = o.Components.If, f = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, n.prototype.template = function () { var e = this; return o.createElement("div", { class: o.const("dcg-options-menu-section") }, o.createElement("div", { class: o.const("dcg-options-menu-section-title") }, function () { return e.controller.s("graphing-calculator-heading-label") }, o.createElement(l.ToggleView, { ariaLabel: function () { return e.controller.s("graphing-calculator-narration-label-visible") }, toggled: this.props.isOpen, onChange: this.bindFn(this.toggleLabelVisible) })), o.createElement(h, { predicate: this.props.isOpen }, function () { return o.createElement("div", { class: o.const("dcg-options-menu-content") }, o.createElement("div", { class: o.const("dcg-options-flex-container") }, o.createElement("div", { class: o.const("dcg-options-left-side") }, o.createElement("div", { class: o.const("dcg-iconed-mathquill-row dcg-label-size-row") }, o.createElement(g.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-label-size-tooltip") }, sticky: e.const(!0), gravity: e.const("se") }, o.createElement("span", { class: o.const("dcg-font-size") }, o.const("A"))), o.createElement(i.default, { latex: e.bindFn(e.getLabelSizeLatex), placeholder: e.bindFn(e.getLabelSizePlaceholder), isFocused: function () { return "labelsize" === e.getFocusedInput() }, capExpressionSize: function () { return !!e.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-label-size") }, getAriaPostLabel: function () { return r.isLabelSizeValid(e.model) ? e.controller.raw("") : e.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !r.isLabelSizeValid(e.model) }, onUserChangedLatex: function (t) { return e.dispatchLabelSizeIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged(t, "labelsize") }, dataLabelAttributeValue: e.const("label-size") })), o.createElement("div", { class: function () { return { "dcg-iconed-mathquill-row": !0, "dcg-label-angle-row": !0, "dcg-suffix-degree": e.props.controller().getGraphSettings().degreeMode, "dcg-suffix-radian": !e.props.controller().getGraphSettings().degreeMode } } }, o.createElement(g.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-angle-tooltip") }, sticky: e.const(!0) }, o.createElement("i", { class: o.const("dcg-icon-angle"), "aria-hidden": o.const("true") })), o.createElement(i.default, { latex: function () { return e.model.labelAngle }, placeholder: function () { return "0" }, isFocused: function () { return "labelangle" === e.getFocusedInput() }, capExpressionSize: function () { return !!e.controller.getGraphSettings().config.capExpressionSize }, selectOnFocus: e.const(!0), config: e.bindFn(e.getMQConfig), getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-label-angle") }, getAriaPostLabel: function () { return r.isLabelAngleValid(e.model) ? e.controller.raw("") : e.controller.s("shared-calculator-narration-input-error") }, hasError: function () { return !r.isLabelAngleValid(e.model) }, onUserChangedLatex: function (t) { return e.dispatchLabelAngleIfChanged(t) }, onExpressionSizeExceeded: function () { return e.controller.dispatch({ type: "expression-size-exceeded" }) }, onFocusedChanged: function (t) { return e.handleFocusedChanged(t, "labelangle") }, dataLabelAttributeValue: e.const("label-angle") }))), o.createElement("div", { class: o.const("dcg-options-right-side") }, o.createElement(c.LabelOrientationView, { controller: function () { return e.controller }, model: function () { return e.model } }))), o.createElement(h, { predicate: e.props.isFirstOpenSection }, function () { return o.createElement(s.ColorPicker, { controller: e.props.controller, colorLatex: function () { return e.model.colorLatex }, selectedColor: e.bindFn(e.getModelColor), onColorSelected: e.bindFn(e.onColorSelected), onCustomColorSelected: e.bindFn(e.onCustomColorSelected) }) }), o.createElement(h, { predicate: function () { return e.controller.canUseAdvancedStyling() } }, function () { return o.createElement("div", { class: o.const("dcg-label-advanced") }, o.createElement(d.Checkbox, { checked: e.bindFn(e.getWhiteTextOutline), onChange: e.bindFn(e.setWhiteTextOutline), ariaLabel: function () { return e.controller.s("graphing-calculator-button-label-text-outline") }, disabled: function () { return e.getEditable() } }, function () { return e.controller.s("graphing-calculator-button-label-text-outline") }), o.createElement("div", { role: o.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-advanced") } }, o.createElement(h, { predicate: function () { return e.shouldShowHoverLabelCheckbox() } }, function () { return o.createElement(d.Checkbox, { checked: e.bindFn(e.getInteractiveLabel), onChange: e.bindFn(e.setInteractiveLabel), ariaLabel: function () { return e.controller.s("graphing-calculator-button-label-show-on-hover") } }, function () { return e.controller.s("graphing-calculator-button-label-show-on-hover") }) }), o.createElement(h, { predicate: e.bindFn(e.shouldShowEditableLabelToggle) }, function () { return o.createElement(d.Checkbox, { checked: e.bindFn(e.getEditable), onChange: e.bindFn(e.setEditable), ariaLabel: function () { return e.controller.s("graphing-calculator-button-label-editable") } }, function () { return e.controller.s("graphing-calculator-button-label-editable") }) }))) })) })) }, n.prototype.getWhiteTextOutline = function () { return !this.getEditable() && !this.model.suppressTextOutline }, n.prototype.setWhiteTextOutline = function (e) { this.controller.dispatch({ type: "set-suppress-text-outline", id: this.id, suppressTextOutline: !e }) }, n.prototype.setInteractiveLabel = function (e) { this.controller.dispatch({ type: "set-item-interactive-label", id: this.id, interactiveLabel: e }) }, n.prototype.getInteractiveLabel = function () { return !!this.model.interactiveLabel }, n.prototype.setEditable = function (e) { if (e) { var t = "latex" === b.classifyLabelText(this.model.label) ? p.EditableLabelMode.Math : p.EditableLabelMode.Text; this.controller.dispatch({ type: "set-item-editable-label-mode", id: this.id, editableLabelMode: t }) } else this.controller.dispatch({ type: "set-item-editable-label-mode", id: this.id, editableLabelMode: p.EditableLabelMode.None }) }, n.prototype.getEditable = function () { return this.model.editableLabelMode !== p.EditableLabelMode.None }, n.prototype.shouldShowEditableLabelToggle = function () { return r.isSinglePoint(this.model) }, n.prototype.shouldShowHoverLabelCheckbox = function () { return this.model.reconciledDragMode === u.DragMode.NONE }, n.prototype.dispatchLabelAngleIfChanged = function (e) { this.model.labelAngle !== e && this.controller.dispatch({ type: "set-item-labelangle", id: this.id, labelAngle: e }) }, n.prototype.dispatchLabelSizeIfChanged = function (e) { if (this.model.labelSize !== e) { var t = a.maybeMigrateLabelSizeEnumToLatex(e); t && (e = t), this.controller.dispatch({ type: "set-item-labelSize", id: this.id, labelSize: e }) } }, n.prototype.getLabelSizePlaceholder = function () { var e = a.maybeMigrateLabelSizeEnumToLatex(this.model.labelSize); return e || "1" }, n.prototype.getLabelSizeLatex = function () { return a.maybeMigrateLabelSizeEnumToLatex(this.model.labelSize) ? "" : this.model.labelSize }, n.prototype.toggleLabelVisible = function () { this.controller.dispatch({ type: "set-item-showlabel", id: this.id, showLabel: !this.props.isOpen() }) }, n }(n.BaseMenuSection); e.LabelMenu = f });
define('expressions/expression-menus/drag', ["require", "exports", "tslib", "./base-menu-section", "dcgview", "underscore", "expressions/toggle-view", "core/lib/dragmode", "../circular-icon-view"], function (require, e, t, r, o, n, i, a, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.DragMenu = void 0; var d = o.Components, l = d.If, s = d.For, g = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return o.createElement("div", { class: o.const("dcg-options-menu-section") }, o.createElement("div", { class: o.const("dcg-options-menu-section-title") }, function () { return e.controller.s("graphing-calculator-heading-drag") }, o.createElement(i.ToggleView, { ariaLabel: function () { return e.controller.s("graphing-calculator-narration-menu-drag-enabled") }, toggled: this.props.isOpen, onChange: this.bindFn(this.toggleDragEnabled) })), o.createElement(l, { predicate: this.props.isOpen }, function () { return o.createElement("div", { class: o.const("dcg-options-menu-content") }, o.createElement(s, { each: function () { return [a.DragMode.X, a.DragMode.Y, a.DragMode.XY] } }, o.createElement("div", { class: o.const("dcg-style-icons"), role: o.const("radiogroup") }, function (t) { return o.createElement("div", { class: function () { return { "dcg-style-icon-container": !0, "dcg-disabled": e.isDisabled(t) } }, onTap: function () { return e.onDragModeSelected(t) }, role: o.const("radio"), tabindex: function () { return e.isDisabled(t) ? -1 : 0 }, "aria-label": function () { return "X" === t ? e.controller.s("graphing-calculator-narration-drag-mode-x") : "Y" === t ? e.controller.s("graphing-calculator-narration-drag-mode-y") : "XY" === t ? e.controller.s("graphing-calculator-narration-drag-mode-xy") : e.controller.raw("") }, "aria-checked": function () { return e.getDragMode() === t } }, o.createElement(c.CircularIconView, { backgroundColor: function () { return "#000" }, semiTransparent: function () { return e.getDragMode() !== t }, iconType: function () { return "X" === t ? "movable-horizontal" : "Y" === t ? "movable-vertical" : "movable-both" } })) }))) })) }, r.prototype.isDisabled = function (e) { var t = this.controller.getEnabledDragModesForItem(this.id); return !n.contains(t, e) }, r.prototype.onDragModeSelected = function (e) { if ("expression" === this.model.type) { if (this.isDisabled(e)) return; this.controller.dispatch({ type: "set-item-dragmode", id: this.id, dragMode: e }) } else { var t = this.model.id, r = this.model.table.id; this.controller.dispatch({ type: "set-tablecolumn-dragmode", tableId: r, columnId: t, dragMode: e }) } }, r.prototype.getDragMode = function () { return "expression" === this.model.type && this.model.reconciledDragMode || this.model.dragMode }, r.prototype.toggleDragEnabled = function () { var e = this.getDragMode() !== a.DragMode.NONE ? a.DragMode.NONE : a.DragMode.XY; "expression" === this.model.type ? this.controller.dispatch({ type: "set-item-dragmode", id: this.id, dragMode: e }) : this.onDragModeSelected(e) }, r }(r.BaseMenuSection); e.DragMenu = g });

define('loadcss!expressions/expression-menus/expression-options-menu-view', function () { });
define('expressions/expression-menus/expression-options-menu-view', ["require", "exports", "tslib", "dcgview", "lib/aria", "jquery", "./lines", "./colors-only", "./fill", "./clickable", "./points", "./label", "./drag", "graphing-calc/models/expression", "core/math/expression-types", "core/lib/dragmode", "loadcss!./expression-options-menu-view"], function (require, e, i, n, t, s, o, r, l, c, a, p, u, d, h, m) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ExpressionOptionsMenuView = void 0; var f = n.Components, g = f.For, O = f.If, b = function (e) { function f() { return null !== e && e.apply(this, arguments) || this } return i.__extends(f, e), f.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, this.props.registerRepositionCb(this.bindFn(this.renderOffset)) }, f.prototype.template = function () { var e = this; return n.createElement("div", { class: function () { return { "dcg-expressions-options-menu": !0, "dcg-options-menu": !0 } }, role: n.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-options-menu") }, didMount: this.bindFn(this.didMountContainer) }, n.createElement(g, { each: this.bindFn(this.getSections) }, n.createElement("div", null, function (t) { switch (t) { case "points": return n.createElement(a.PointsMenu, i.__assign({}, e.props, { isOpen: function () { return e.isSectionOpen("points") }, isFirstOpenSection: function () { return e.isFirstOpenSection("points") } })); case "label": return n.createElement(p.LabelMenu, i.__assign({}, e.props, { isOpen: function () { return e.isSectionOpen("label") }, isFirstOpenSection: function () { return e.isFirstOpenSection("label") } })); case "drag": return n.createElement(u.DragMenu, i.__assign({}, e.props, { isOpen: function () { return e.isSectionOpen("drag") }, isFirstOpenSection: function () { return e.isFirstOpenSection("drag") } })); case "lines": return n.createElement(o.LineMenu, i.__assign({}, e.props, { isOpen: function () { return e.isSectionOpen("lines") }, isFirstOpenSection: function () { return e.isFirstOpenSection("lines") } })); case "fill": return n.createElement(l.FillMenu, i.__assign({}, e.props, { isOpen: function () { return e.isSectionOpen("fill") }, isFirstOpenSection: function () { return e.isFirstOpenSection("fill") } })); case "colors-only": return n.createElement(r.ColorsOnlyMenu, i.__assign({}, e.props, { isOpen: e.const(!0), isFirstOpenSection: e.const(!0) })) } })), n.createElement(O, { predicate: this.bindFn(this.isClickable) }, function () { return n.createElement(c.ClickableMenu, i.__assign({}, e.props, { isOpen: function () { return !!e.model.clickableInfo.enabled }, isFirstOpenSection: e.const(!1) })) }), n.createElement("div", { class: n.const("dcg-triangle"), didMount: this.bindFn(this.didMountArrow) })) }, f.prototype.willUnmount = function () { t.alert(this.controller.s("graphing-calculator-narration-options-menu-closed")) }, f.prototype.didMountContainer = function (e) { this.$containerElt = s(e), t.alert(this.controller.s("graphing-calculator-narration-options-menu-open")) }, f.prototype.didMountArrow = function (e) { this.$arrowElt = s(e) }, f.prototype.renderOffset = function (e) { if (this.$containerElt && this.$arrowElt) { var i = this.$containerElt.outerHeight(), n = 0; i > e && (n = +e - i); var t = -n < i - 38; this.$containerElt.css("margin-top", n + "px"), this.$arrowElt.css("margin-top", -n + "px"), this.$arrowElt.css("display", t ? "" : "none") } }, f.prototype.isClickable = function () { return this.controller.areActionsEnabled() && d.isClickableAllowed(this.model) }, f.prototype.getSections = function () { return d.isHistogram(this.model) || d.isBoxPlot(this.model) || d.isRegression(this.model) || d.isDiscreteDistribution(this.model) ? ["colors-only"] : d.isToplevelDistribution(this.model) ? ["lines"] : d.isDotPlot(this.model) ? ["points"] : d.isPointList(this.model) ? ["points", "label", "lines"] : d.isSinglePoint(this.model) ? this.model.formula.move_strategy ? ["points", "label", "drag"] : ["points", "label"] : d.isParametric(this.model) || d.isPolygon(this.model) ? ["lines", "fill"] : d.isInequality(this.model) ? d.isPolar(this.model) ? ["lines"] : ["lines", "fill"] : ["lines"] }, f.prototype.isFirstOpenSection = function (e) { for (var i = 0, n = this.getSections(); i < n.length; i++) { var t = n[i]; if (t === e) return this.isSectionOpen(e); if (this.isSectionOpen(t)) return !1 } return !1 }, f.prototype.isSectionOpen = function (e) { var i = this.model, n = i.points, t = i.lines, s = i.fill, o = h.getReconciledExpressionProps(this.model.formula.expression_type, { points: n, lines: t, fill: s }); switch (e) { case "lines": return !this.model.hidden && o.lines; case "label": return this.model.showLabel; case "fill": return !this.model.hidden && (!!d.isInequality(this.model) || o.fill); case "points": return !this.model.hidden && (d.isSinglePoint(this.model) ? !this.model.hidden : o.points); case "drag": return this.model.reconciledDragMode !== m.DragMode.NONE; case "colors-only": return !0 } }, f }(n.Class); e.ExpressionOptionsMenuView = b });
define('expressions/expression-menus/table-options-menu-view', ["require", "exports", "tslib", "dcgview", "lib/aria", "./lines", "./points", "./drag", "core/lib/dragmode", "loadcss!./expression-options-menu-view", "loadcss!./expression-options-menu-view"], function (require, n, e, t, i, o, r, s, c) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.TableOptionsMenuView = void 0; var a = t.Components.For, l = function (n) { function l() { return null !== n && n.apply(this, arguments) || this } return e.__extends(l, n), l.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, l.prototype.template = function () { var n = this; return t.createElement("div", { class: function () { return { "dcg-table-column-menu": !0, "dcg-options-menu": !0 } }, role: t.const("group"), "aria-label": function () { return n.controller.s("graphing-calculator-narration-options-menu") }, didMount: function () { i.alert(n.controller.s("graphing-calculator-narration-options-menu-open")) }, didUnmount: function () { i.alert(n.controller.s("graphing-calculator-narration-options-menu-closed")) } }, t.createElement(a, { each: this.bindFn(this.getSections) }, t.createElement("div", null, function (i) { switch (i) { case "points": return t.createElement(r.PointsMenu, e.__assign({}, n.props, { isOpen: function () { return n.isSectionOpen("points") }, isFirstOpenSection: function () { return n.isFirstOpenSection("points") } })); case "drag": return t.createElement(s.DragMenu, e.__assign({}, n.props, { isOpen: function () { return n.isSectionOpen("drag") }, isFirstOpenSection: function () { return n.isFirstOpenSection("drag") } })); case "lines": return t.createElement(o.LineMenu, e.__assign({}, n.props, { isOpen: function () { return n.isSectionOpen("lines") }, isFirstOpenSection: function () { return n.isFirstOpenSection("lines") } })) } })), t.createElement("div", { class: t.const("dcg-triangle") })) }, l.prototype.getSections = function () { return this.model.draggable ? ["points", "lines", "drag"] : ["points", "lines"] }, l.prototype.isFirstOpenSection = function (n) { for (var e = 0, t = this.getSections(); e < t.length; e++) { var i = t[e]; if (i === n) return this.isSectionOpen(n); if (this.isSectionOpen(i)) return !1 } return !1 }, l.prototype.isSectionOpen = function (n) { switch (n) { case "drag": return this.model.dragMode !== c.DragMode.NONE; case "lines": return !!this.model.lines; case "points": return !!this.model.points } }, l }(t.Class); n.TableOptionsMenuView = l });
define('expressions/image_options_view', ["require", "exports", "tslib", "dcgview", "graphing-calc/models/image", "graphing-calc/models/expression", "dcgview-helpers/checkbox", "./circular-icon-view", "expressions/expression-menus/clickable", "lib/coerce-url"], function (require, e, t, n, o, r, c, i, a, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ImageOptionsView = void 0; var s = n.Components, d = s.For, g = s.If, u = s.Textarea, p = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.template = function () { var e = this; return this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id, n.createElement("div", { class: n.const("dcg-image-options-menu dcg-options-menu") }, n.createElement("div", { class: n.const("dcg-triangle") }), n.createElement("div", { class: n.const("dcg-opacities-menu dcg-dividing-line-after") }, n.createElement("div", { role: n.const("heading"), "aria-level": n.const("2"), class: n.const("dcg-title") }, function () { return e.controller.s("graphing-calculator-heading-image-opacity") }), n.createElement(d, { each: function () { return e.controller.getImageOpacities() } }, n.createElement("div", { class: n.const("dcg-opacities-menu-flex"), role: n.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-image-opacity") } }, function (t) { return n.createElement("span", { class: n.const("dcg-opacity-option"), role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return "opacity: " + t }, "aria-pressed": function () { return e.isOpacitySelected(t) }, handleevent: n.const("true"), onTap: function () { return e.onSelectOpacity(t) } }, n.createElement(i.CircularIconView, { backgroundImage: e.bindFn(e.getBackgroundImage), iconType: function () { return e.isOpacitySelected(t) ? "check" : "none" }, backgroundOpacity: function () { return parseFloat(t) } })) }))), n.createElement("div", { class: n.const("dcg-styles-div dcg-options-menu-section") }, n.createElement("div", { class: n.const("dcg-styles-menu"), role: n.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-image-styles") } }, n.createElement(c.Checkbox, { checked: function () { return !e.model.foreground }, onChange: this.bindFn(this.onToggleForeground), ariaLabel: function () { return e.controller.s("graphing-calculator-button-place-image-behind-graphs") } }, function () { return e.controller.s("graphing-calculator-button-place-image-behind-graphs") })), n.createElement(g, { predicate: function () { return e.shouldShowDraggableCheckbox() } }, function () { return n.createElement("div", { class: n.const("dcg-draggable-checkbox-container") }, n.createElement(c.Checkbox, { checked: function () { return o.isActuallyDraggable(e.model) }, onChange: e.bindFn(e.onToggleDraggable), ariaLabel: function () { return e.controller.s("graphing-calculator-button-draggable") } }, function () { return e.controller.s("graphing-calculator-button-draggable") })) }), n.createElement(g, { predicate: this.bindFn(this.shouldShowClickable) }, function () { return n.createElement("div", { class: n.const("dcg-clickable-image-controls") }, n.createElement(a.ClickableMenu, t.__assign({}, e.props, { isOpen: function () { return !!e.model.clickableInfo.enabled }, isFirstOpenSection: e.const(!1) }))) }), n.createElement(g, { predicate: function () { return o.isActuallyDraggable(e.model) || !!e.model.clickableInfo.enabled } }, function () { return n.createElement(u, { placeholder: function () { return e.controller.s("graphing-calculator-text-add-screen-reader-label-placeholder") }, value: function () { return e.model.description }, onInput: function (t) { return e.controller.dispatch({ type: "set-item-description", id: e.model.id, description: t }) } }) }))) }, s.prototype.onToggleDraggable = function () { o.getCenterExternalReferencedModel(this.model) ? this.controller.dispatch({ type: "set-image-draggable", id: this.id, draggable: !this.model.draggable }) : this.makeDraggable() }, s.prototype.onToggleForeground = function (e) { this.controller.dispatch({ type: "set-image-in-foreground", id: this.id, foreground: !e }) }, s.prototype.onSelectOpacity = function (e) { this.controller.dispatch({ type: "set-image-opacity", id: this.id, opacity: e }) }, s.prototype.isOpacitySelected = function (e) { return this.model.opacity === e }, s.prototype.getBackgroundImage = function () { return this.model.image_url === this.lastURL || (this.lastURL = this.model.image_url, this.lastEncodedURL = 'url("' + l.coerceURL(this.model.image_url) + '")'), this.lastEncodedURL }, s.prototype.shouldShowClickable = function () { return this.controller.areActionsEnabled() }, s.prototype.makeDraggable = function () { this.controller.dispatch({ type: "convert-image-to-draggable", id: this.model.id }) }, s.prototype.shouldShowDraggableCheckbox = function () { var e = o.getCenterExternalReferencedModel(this.model); return e ? r.isPotentiallyMovable(e) : o.canConvertToDraggableImage(this.model) }, s }(n.Class); e.ImageOptionsView = p });

define('loadcss!expressions/slider-speed-view', function () { });
define('expressions/slider_speed_view', ["require", "exports", "tslib", "underscore", "lib/aria", "dcgview", "core/graphing-calc/json/expression", "loadcss!./slider-speed-view"], function (require, e, t, r, n, i, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var a = [.05, .1, .15, .2, .35, .5, .75, 1, 1.5, 2, 3.5, 5, 7.5, 10, 15, 20], s = r.min(a), l = r.max(a), c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model() }, c.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-slider-speed-container dcg-do-not-blur"), handleEvent: i.const("true") }, i.createElement("span", { class: function () { return { "dcg-action-slower": !0, "dcg-disabled": e.isSlowerDisabled() } }, onTap: function () { return e.animateSlower() }, role: i.const("button"), "aria-label": function () { return e.getSlowerAriaLabel() }, tabindex: function () { return e.isSlowerDisabled() ? -1 : 0 }, "aria-disabled": function () { return e.isSlowerDisabled() } }, i.createElement("i", { class: i.const("dcg-icon-show"), "aria-hidden": i.const("true") })), i.createElement("span", { class: i.const("dcg-variable-speed") }, this.bindFn(this.computeSpeed), i.const("x")), i.createElement("span", { class: function () { return { "dcg-action-faster": !0, "dcg-disabled": e.isFasterDisabled() } }, onTap: function () { return e.animateFaster() }, role: i.const("button"), "aria-label": function () { return e.getFasterAriaLabel() }, tabindex: function () { return e.isFasterDisabled() ? -1 : 0 }, "aria-disabled": function () { return e.isFasterDisabled() } }, i.createElement("i", { class: i.const("dcg-icon-show"), "aria-hidden": i.const("true") }))) }, c.prototype.computeSpeed = function () { var e = o.DEFAULT_SLIDER_PERIOD / this.model.slider.animationPeriod; return e = Number(e.toFixed(3)) }, c.prototype.isSlowerDisabled = function () { return s >= this.computeSpeed() }, c.prototype.isFasterDisabled = function () { return l <= this.computeSpeed() }, c.prototype.animateSlower = function () { var e = this.computeSpeed(), t = r.filter(a, function (t) { return t < e }); 0 !== t.length && this.setPeriodFromSpeed(r.max(t)) }, c.prototype.animateFaster = function () { var e = this.computeSpeed(), t = r.filter(a, function (t) { return t > e }); 0 !== t.length && this.setPeriodFromSpeed(r.min(t)) }, c.prototype.setPeriodFromSpeed = function (e) { var t = o.DEFAULT_SLIDER_PERIOD / e; this.controller.dispatch({ type: "set-slider-animationperiod", id: this.model.id, animationPeriod: t }), n.alert(this.controller.s("graphing-calculator-narration-slider-animating-at-speed", { speed: e + "" })) }, c.prototype.getSlowerAriaLabel = function () { return this.controller.s("graphing-calculator-narration-slider-animate-slower") }, c.prototype.getFasterAriaLabel = function () { return this.controller.s("graphing-calculator-narration-slider-animate-faster") }, c }(i.Class); e.default = c });

define('loadcss!expressions/slider-options-view', function () { });
define('expressions/slider-options-view', ["require", "exports", "tslib", "dcgview", "core/types/slider-loop-modes", "../shared-components/tooltip", "./slider_speed_view", "loadcss!toggle", "loadcss!./slider-options-view"], function (require, e, t, o, n, i, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SliderOptionsView = void 0; var l = o.Components.For, s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.init = function () { this.controller = this.props.controller(), this.model = this.props.model(), this.id = this.model.id }, s.prototype.template = function () { var e = this; return o.createElement("div", { class: o.const("dcg-slider-options-view dcg-options-menu") }, o.createElement("div", { class: o.const("dcg-triangle") }), o.createElement("div", { class: o.const("dcg-slider-menu") }, o.createElement("div", { role: o.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-slider-animation-mode") } }, o.createElement("div", { role: o.const("heading"), "aria-level": o.const("2"), class: o.const("dcg-title") }, function () { return e.controller.s("graphing-calculator-heading-slider-animation-mode") }), o.createElement(l, { each: this.bindFn(this.getAnimationOptions), key: function (e) { return e.key } }, o.createElement("div", { class: o.const("dcg-toggle") }, function (t) { return o.createElement("div", { class: function () { return { "dcg-toggle-option": !0, "dcg-selected-toggle": e.isSelected(t.key) } }, role: o.const("button"), tabindex: o.const(0), "aria-label": function () { return t.aria }, "aria-pressed": function () { return e.isSelected(t.key) }, onTap: function () { return e.props.controller().dispatch({ type: "set-slider-loopmode", id: e.props.model().id, loopMode: t.key }) } }, o.createElement(i.Tooltip, { tooltip: function () { return t.aria }, offset: function () { return { top: 5 } }, gravity: e.getAnimationOptionTooltipGravity(t) }, o.createElement("i", { class: function () { return n.getSliderIcon(t.key) }, "aria-hidden": o.const("true") }))) })))), o.createElement("div", { class: o.const("dcg-slider-menu dcg-slider-speed-menu"), role: o.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-heading-slider-speed") } }, o.createElement("div", { role: o.const("heading"), "aria-level": o.const("2"), class: o.const("dcg-title") }, function () { return e.controller.s("graphing-calculator-heading-slider-speed") }), o.createElement("div", { class: o.const("dcg-slider-speed-container") }, o.createElement(r.default, t.__assign({}, this.props))))) }, s.prototype.getAnimationOptionTooltipGravity = function (e) { return this.getAnimationOptions()[0].key === e.key ? this.const("se") : this.const("s") }, s.prototype.getAnimationOptions = function () { return [{ key: n.SliderLoopMode.LOOP_FORWARD_REVERSE, aria: this.controller.s("graphing-calculator-narration-slider-loop-forwards-and-backwards") }, { key: n.SliderLoopMode.LOOP_FORWARD, aria: this.controller.s("graphing-calculator-narration-slider-repeat-one-direction") }, { key: n.SliderLoopMode.PLAY_ONCE, aria: this.controller.s("graphing-calculator-narration-slider-play-once") }, { key: n.SliderLoopMode.PLAY_INDEFINITELY, aria: this.controller.s("graphing-calculator-narration-slider-play-indefinitely") }] }, s.prototype.isSelected = function (e) { return this.model.slider.loopMode === e }, s }(o.Class); e.SliderOptionsView = s });

define('loadcss!expressions/item-settings-view', function () { });
define('expressions/item-settings-view', ["require", "exports", "tslib", "dcgview", "keys", "underscore", "jquery", "./expression-menus/expression-options-menu-view", "./expression-menus/table-options-menu-view", "./image_options_view", "./slider-options-view", "loadcss!./item-settings-view"], function (require, t, e, o, i, n, s, r, c, p, u) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ItemSettingsView = void 0; var l = o.Components.Switch, d = ':input, [role="textbox"], [tabindex="0"]:visible', a = function (t) { function a() { return null !== t && t.apply(this, arguments) || this } return e.__extends(a, t), a.prototype.init = function () { this.controller = this.props.controller() }, a.prototype.template = function () { var t = this; return o.createElement(l, { key: this.bindFn(this.getActiveGuid) }, function () { var e = t.controller.getOpenItemMenu(); return t.registeredChildRepositionCb = void 0, e ? "expression" === e.type ? o.createElement("div", { class: o.const("dcg-options-menu-container"), didMount: t.bindFn(t.didMountView), didUnmount: t.bindFn(t.didUnmountView) }, o.createElement(r.ExpressionOptionsMenuView, { controller: t.props.controller, model: function () { return e.model }, registerRepositionCb: function (e) { t.registeredChildRepositionCb = e } })) : "image" === e.type ? o.createElement("div", { class: o.const("dcg-options-menu-container"), didMount: t.bindFn(t.didMountView), didUnmount: t.bindFn(t.didUnmountView) }, o.createElement(p.ImageOptionsView, { controller: t.props.controller, model: function () { return e.model } })) : "table-column" === e.type ? o.createElement("div", { class: o.const("dcg-options-menu-container"), didMount: t.bindFn(t.didMountView), didUnmount: t.bindFn(t.didUnmountView) }, o.createElement(c.TableOptionsMenuView, { controller: t.props.controller, model: function () { return e.model } })) : "slider" === e.type ? o.createElement("div", { class: o.const("dcg-options-menu-container"), didMount: t.bindFn(t.didMountView), didUnmount: t.bindFn(t.didUnmountView) }, o.createElement(u.SliderOptionsView, { controller: t.props.controller, model: function () { return e.model } })) : e : o.createElement("span", null) }) }, a.prototype.getActiveGuid = function () { var t = this.controller.getOpenItemMenu(); if (t) return t.guid }, a.prototype.didMountView = function (t) { var e = this; this.guid = n.uniqueId("dcg-item-settings-view"), this.openView = t, this.positionMenu(), this.moveFocusIfAppropriate(), s(document.body).on("keydown." + this.guid, function (t) { var o = i.lookup(t); o === i.ESCAPE ? (e.focusMenuIcon(), e.hideOptions()) : "Tab" !== o || t.altKey || t.ctrlKey || t.metaKey || (t.shiftKey ? t.shiftKey && (e.isIconModelFocused() ? (t.preventDefault(), t.stopPropagation(), e.focusLastOption()) : e.isFirstOptionViewFocused() ? (t.preventDefault(), t.stopPropagation(), e.focusIcon()) : e.focusAnywhere()) : e.isIconModelFocused() ? (t.preventDefault(), t.stopPropagation(), e.focusFirstOption()) : e.isLastOptionViewFocused() ? (t.preventDefault(), t.stopPropagation(), e.focusIcon()) : e.focusAnywhere()) }), requestAnimationFrame(function () { e.openView && e.controller.getExppanelSelectorOrThrow().on("scroll." + e.guid, function () { e.hideOptions() }) }), s(document.body).on("dcg-tapstart." + this.guid, function (t) { if (e.openView) { var o = s(t.target), i = e.controller.getOpenMenuIcon(); if (!i || !o.closest(i).length) if (o.closest(e.openView).length) { if (!o.is(d)) return; var n = e.getDOMTabStops(), r = n.$first, c = n.$last; void 0 !== r && r.is(o) ? e.focusFirstOption() : void 0 !== c && c.is(o) ? e.focusLastOption() : t.target.hasAttribute("dataLabelAttributeValue") || "fill-opacity" === t.target.getAttribute("dataLabelAttributeValue") || e.focusAnywhere() } else o.closest(".dcg-keypad,.dcg-show-keypad-container").length || e.hideOptions() } }) }, a.prototype.didUnmountView = function () { s(document.body).off("." + this.guid), this.openView = void 0 }, a.prototype.didUpdate = function () { this.positionMenu(), this.moveFocusIfAppropriate() }, a.prototype.moveFocusIfAppropriate = function () { var t = this.getDOMTabStops(), e = t.$first, o = t.$last; void 0 !== e && void 0 !== o && (this.shouldMoveFocusToFirstOption() ? e.trigger("focus") : this.shouldMoveFocusToLastOption() && o.trigger("focus")) }, a.prototype.open = function () { return !!this.controller.getOpenItemMenu() }, a.prototype.hideOptions = function () { if (this.open()) { var t = this.controller.getFocusLocation(), e = this.controller.getOpenItemMenu(); t && e && "expression-menu" === t.type && t.id === e.model.id && this.controller.dispatch({ type: "blur-focus-location", location: t }), this.controller.dispatch({ type: "close-item-settings-menu" }) } }, a.prototype.positionMenu = function () { var t = this.controller.getOpenMenuIcon(); if (t && this.openView) { var e = this.controller.getExppanelSelectorOrThrow().closest(".dcg-container")[0].getBoundingClientRect(), o = t[0].getBoundingClientRect(), i = o.top - e.top, n = o.left - e.left, r = this.controller.computeMajorLayout(), c = r.list.top + r.list.height, p = r.keypad.top, u = Math.min(c, p) + e.top - o.top; s(this.openView).css({ top: i + "px", left: n + "px", display: "block" }), this.registeredChildRepositionCb && this.registeredChildRepositionCb(u) } }, a.prototype.focusMenuIcon = function () { var t = this.controller.getOpenItemMenu(); t && this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-icon", id: t.model.id } }) }, a.prototype.isIconModelFocused = function () { var t = this.controller.getOpenItemMenu(); if (void 0 === t) return !1; if ("slider" === t.type) return this.controller.isFocusLocationFocused({ type: "slider-animation-properties-icon", id: t.model.id }); if ("image" === t.type) return this.controller.isFocusLocationFocused({ type: "image-icon", id: t.model.id }); if ("table-column" === t.type) return this.controller.isFocusLocationFocused({ type: "table-icon", id: t.model.table.id, columnId: t.model.id }); var e = this.getModelForOpenMenu(); return e ? this.controller.isFocusLocationFocused({ type: "expression-icon", id: e.id }) : void 0 }, a.prototype.focusIcon = function () { this.controller.focusOpenMenuIcon() }, a.prototype.isFirstOptionViewFocused = function () { var t = this.getDOMTabStops().$first; return void 0 !== t && t.is(":focus") }, a.prototype.shouldMoveFocusToFirstOption = function () { var t = this.getModelForOpenMenu(); if (t) return !this.isFirstOptionViewFocused() && this.controller.isFocusLocationFocused({ type: "expression-menu", id: t.id, location: "start" }) }, a.prototype.focusFirstOption = function () { var t = this.getModelForOpenMenu(); t && this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-menu", id: t.id, location: "start" } }) }, a.prototype.isLastOptionViewFocused = function () { var t = this.getDOMTabStops().$last; return void 0 !== t && t.is(":focus") }, a.prototype.getModelForOpenMenu = function () { var t = this.controller.getOpenItemMenu(); if (t) return t.model }, a.prototype.shouldMoveFocusToLastOption = function () { var t = this.getModelForOpenMenu(); if (t) return !this.isLastOptionViewFocused() && this.controller.isFocusLocationFocused({ type: "expression-menu", id: t.id, location: "end" }) }, a.prototype.focusLastOption = function () { var t = this.getModelForOpenMenu(); t && this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-menu", id: t.id, location: "end" } }) }, a.prototype.focusAnywhere = function () { var t = this.getModelForOpenMenu(); t && this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-menu", id: t.id, location: "anywhere" } }) }, a.prototype.getDOMTabStops = function () { if (void 0 === this.openView) return {}; var t = s(this.openView).find(d); return { $first: t.first(), $last: t.last() } }, a }(o.Class); t.ItemSettingsView = a });

define('loadcss!expressions/expression-search-bar', function () { });
define('expressions/expression-search-bar', ["require", "exports", "tslib", "dcgview", "../dcgview-helpers/mathquill-view", "main/mathquill-operators", "../dcgview-helpers/tooltipped-error", "loadcss!./expression-search-bar"], function (require, e, r, t, o, n, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ExpressionSearchBar = void 0; var s = t.Components.If, a = function (e) { function a() { var r = null !== e && e.apply(this, arguments) || this; return r.justGlobalReplaced = !1, r } return r.__extends(a, e), a.prototype.init = function () { this.controller = this.props.controller() }, a.prototype.template = function () { var e = this; return t.createElement("div", { class: function () { return { "dcg-expression-search-bar": !0, "dcg-expressions-scrolled": e.props.expsScrolled() && !e.controller.getTickerOpen() } }, role: t.const("search") }, t.createElement("div", { class: t.const("dcg-search-row") }, t.createElement("div", { class: t.const("dcg-search-mathquill-container") }, t.createElement(o.default, { hasError: this.const(!1), getAriaLabel: function () { return e.controller.s("graphing-calculator-label-search-expressions") }, getAriaPostLabel: function () { return 0 === e.controller.getExpressionSearchStr().length ? e.controller.raw("") : e.shouldShowReplaceError() ? e.controller.s("graphing-calculator-error-expression-replacement") : e.shouldShowSearchError() ? e.controller.s("graphing-calculator-error-expression-search") : e.controller.s("graphing-calculator-narration-expression-search-results", { count: e.controller.getExpressionSearchCount() }) }, capExpressionSize: this.const(!1), onUserChangedLatex: this.bindFn(this.onSearchChange), latex: function () { return e.controller.getRawExpressionSearchStr() }, isFocused: this.bindFn(this.isSearchFocused), config: this.bindFn(this.getMQConfig), onFocusedChanged: this.bindFn(this.onSearchFocusChanged), noFadeout: this.const(!0), onUserPressedKey: function (r, t) { if ("Esc" === r) t && t.preventDefault(), e.closeSearch(); else if ("Enter" === r) t && t.preventDefault(), e.onEnter(); else { var n = o.default.getFocusedMathquill(); if (!n) return; n.keystroke(r, t), e.controller.getRawExpressionSearchStr() !== n.latex() && (e.justGlobalReplaced = !1, e.onSearchChange(n.latex())) } } }), t.createElement("i", { class: t.const("dcg-icon-search"), "aria-hidden": t.const("true") }), t.createElement(s, { predicate: function () { return 0 === e.controller.getRawExpressionSearchStr().length } }, function () { return t.createElement("span", { class: t.const("dcg-search-placeholder") }, function () { return e.controller.s("graphing-calculator-label-search-expressions") }) }), t.createElement(s, { predicate: function () { return e.shouldShowSearchError() } }, function () { return t.createElement("span", { class: t.const("dcg-search-replace-icon-container") }, t.createElement(c.TooltippedError, { error: function () { return e.controller.s("graphing-calculator-error-expression-search") }, gravity: e.const("s"), size: e.const("small") })) }), t.createElement(s, { predicate: function () { return e.controller.isSearchReplaceValid() && !e.justGlobalReplaced } }, function () { return t.createElement("span", { class: t.const("dcg-search-replace-icon-container") }, t.createElement("i", { class: t.const("dcg-icon-replace"), role: t.const("button"), tabindex: t.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-button-replace") }, onTap: e.bindFn(e.onGlobalReplace) })) }), t.createElement(s, { predicate: function () { return e.justGlobalReplaced } }, function () { return t.createElement("span", { class: t.const("dcg-search-replace-icon-container") }, t.createElement("i", { class: t.const("dcg-icon-check"), "aria-hidden": t.const("true") })) }), t.createElement(s, { predicate: function () { return e.shouldShowReplaceError() } }, function () { return t.createElement("span", { class: t.const("dcg-search-replace-icon-container") }, t.createElement(c.TooltippedError, { error: function () { return e.controller.s("graphing-calculator-error-expression-replacement") }, gravity: e.const("s"), size: e.const("small") })) })), t.createElement("i", { onTap: function () { return e.closeSearch() }, tabindex: t.const("0"), "aria-label": function () { return e.controller.s("account-shell-button-cancel") }, role: t.const("button"), class: t.const("dcg-icon-remove dcg-do-not-blur") }))) }, a.prototype.onGlobalReplace = function () { var e = this; this.justGlobalReplaced = !0, setTimeout(function () { e.justGlobalReplaced = !1, e.update() }, 1500), this.controller.dispatch({ type: "rename-identifier-global", search: this.controller.getExpressionSearchStr(), replace: this.controller.getExpressionReplaceStr() }) }, a.prototype.onEnter = function () { this.controller.isSearchReplaceValid() ? this.onGlobalReplace() : this.controller.dispatch({ type: "update-expression-search-str", str: this.controller.getRawExpressionSearchStr() }) }, a.prototype.shouldShowSearchError = function () { return !this.controller.getIsExpressionSearchStrValidForReplace() && this.controller.getExpressionReplaceStr().length > 0 }, a.prototype.shouldShowReplaceError = function () { return !this.shouldShowSearchError() && !this.controller.getIsExpressionReplaceStrValidForReplace() && this.controller.getExpressionReplaceStr().length > 0 }, a.prototype.closeSearch = function () { this.controller.dispatch({ type: "close-expression-search" }) }, a.prototype.onSearchChange = function (e) { this.controller.dispatch({ type: "update-expression-search-str", str: e }) }, a.prototype.onSearchFocusChanged = function (e) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "search-expressions" } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "search-expressions" } }) }, a.prototype.isSearchFocused = function () { var e = this.controller.getFocusLocation(); return !!e && "search-expressions" === e.type }, a.prototype.onReplaceChange = function (e) { this.controller.dispatch({ type: "update-expression-replace-str", str: e }) }, a.prototype.onReplaceFocusChanged = function (e) { e ? this.controller.dispatch({ type: "set-focus-location", location: { type: "replace-expressions" } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "replace-expressions" } }) }, a.prototype.isReplaceFocused = function () { var e = this.controller.getFocusLocation(); return !!e && "replace-expressions" === e.type }, a.prototype.getMQConfig = function () { return { autoOperatorNames: n.getAutoOperators({ additionalOperators: ["label", "rename"] }), autoCommands: n.getAutoCommands() } }, a }(t.Class); e.ExpressionSearchBar = a });

define('loadcss!expressions/ticker', function () { });
define('expressions/ticker', ["require", "exports", "tslib", "dcgview", "../dcgview-helpers/mathquill-view", "main/mathquill-operators", "../dcgview-helpers/tooltipped-error", "../graphing-calc/models/ticker", "./promptslider_view", "./circular-icon-view", "../shared-components/tooltip", "lib/conditional_blur", "loadcss!./ticker"], function (require, e, t, n, r, o, i, c, l, a, s, d) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Ticker = void 0; var u = n.Components, p = u.If, g = u.IfDefined, h = function (e) { function u() { return null !== e && e.apply(this, arguments) || this } return t.__extends(u, e), u.prototype.init = function () { this.controller = this.props.controller() }, u.prototype.template = function () { var e = this; return n.createElement("div", { class: function () { return { "dcg-ticker": !0, "dcg-expressions-scrolled": e.props.expsScrolled() } } }, n.createElement("div", { class: n.const("dcg-ticker-settings-container") }, n.createElement("div", { class: n.const("dcg-ticker-settings-internal") }, n.createElement("div", { class: n.const("dcg-editable-mathquill-container dcg-action-definition") }, n.createElement("span", { class: n.const("dcg-ticker-label") }, function () { return e.controller.raw("Run") }), n.createElement(r.default, { hasError: function () { return !!e.getHandlerErrorString() }, getAriaPostLabel: function () { var t = e.getHandlerErrorString(); return t ? e.controller.unpack(t) : "" }, capExpressionSize: this.const(!1), onUserChangedLatex: function (t) { return e.dispatchHandlerLatexIfChanged(t) }, latex: function () { return e.getHandlerLatex() }, getAriaLabel: function () { return e.controller.s("graphing-calculator-narration-tick-action") }, isFocused: function () { return "handler" === e.getFocusedInput() }, config: function () { return e.getMQConfig() }, onFocusedChanged: function (t) { return e.handleFocusedChanged("handler", t) }, selectOnFocus: this.const(!0), noFadeout: this.const(!0), onUserPressedKey: function (t, n) { e.handlePressedKey("handler", t, n) } }), g(function () { return e.getHandlerErrorString() }, function (t) { return n.createElement("span", { class: n.const("dcg-clickable-info-error-container") }, n.createElement(i.TooltippedError, { error: function () { return e.controller.unpack(t()) }, gravity: e.const("s"), size: e.const("small") })) })), n.createElement("div", { class: n.const("dcg-editable-mathquill-container dcg-action-frequency") }, n.createElement("span", { class: n.const("dcg-ticker-label") }, function () { return e.controller.raw("every") }), n.createElement(r.default, { hasError: function () { return !!e.getMinStepErrorString() }, getAriaPostLabel: function () { var t = e.getMinStepErrorString(); return t ? e.controller.unpack(t) : "" }, capExpressionSize: this.const(!1), onUserChangedLatex: function (t) { return e.dispatchMinStepLatexIfChanged(t) }, latex: function () { return e.getMinStepLatex() }, getAriaLabel: function () { return e.controller.s("graphing-calculator-label-ticker-min-step") }, isFocused: function () { return "minstep" === e.getFocusedInput() }, config: this.bindFn(this.getMQConfig), onFocusedChanged: function (t) { return e.handleFocusedChanged("minstep", t) }, selectOnFocus: this.const(!0), placeholder: this.const("0"), noFadeout: this.const(!0), onUserPressedKey: function (t, n) { e.handlePressedKey("minstep", t, n) } }), function () { return e.controller.raw("ms") }, n.createElement(s.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-ticker-help-tooltip") }, gravity: this.const("s") }, n.createElement("a", { "aria-label": function () { return e.controller.s("graphing-calculator-label-ticker-help-tooltip") }, class: n.const("dcg-ticker-toggle-help"), target: n.const("_blank"), href: n.const("https://help.desmos.com/hc/en-us/articles/4407725009165") }, n.createElement("i", { class: n.const("dcg-icon-question-sign"), "aria-hidden": n.const("true") })))), n.createElement(p, { predicate: this.bindFn(this.shouldShowSliderPrompt) }, function () { return n.createElement(l.default, { model: function () { return e.props.controller().getTicker() }, controller: e.props.controller }) })), n.createElement("div", { class: function () { return { "dcg-circular-icon-container": !0, "dcg-disabled": e.iconDisabled() } }, "aria-label": this.bindFn(this.getIconAriaLabel), role: n.const("button"), tabindex: function () { return e.iconDisabled() ? -1 : 0 }, "aria-disabled": this.bindFn(this.iconDisabled), "aria-pressed": function () { return e.controller.getTickerPlaying() && !e.iconDisabled() }, onTap: this.bindFn(this.toggleTicker), onTapStart: function () { d.default() } }, n.createElement(a.CircularIconView, { iconType: this.const("metronome") }), n.createElement("div", { class: function () { return { "dcg-metronome-bar": !0, "dcg-metronome-playing": e.controller.getTickerPlaying() && !e.iconDisabled() } } }), n.createElement(p, { predicate: function () { return !e.iconDisabled() } }, function () { return n.createElement("div", { class: n.const("dcg-mini-play-pause") }, n.createElement(a.CircularIconView, { iconType: e.bindFn(e.getPlayIcon) })) }))), n.createElement("i", { onTap: this.bindFn(this.closeTicker), tabindex: function () { return e.controller.isInEditListMode() ? 0 : -1 }, "aria-label": function () { return e.controller.s("graphing-calculator-label-ticker-close") }, role: n.const("link"), class: n.const("dcg-icon-remove dcg-do-not-blur") })) }, u.prototype.iconDisabled = function () { return !!this.getMinStepErrorString() || (!!this.getHandlerErrorString() || !this.isHandlerMaybeValid()) }, u.prototype.isHandlerMaybeValid = function () { var e; return "maybe-valid" === (null === (e = this.controller.getTicker().formula) || void 0 === e ? void 0 : e.handler.status) }, u.prototype.closeTicker = function () { this.controller.dispatch({ type: "close-ticker" }) }, u.prototype.toggleTicker = function () { this.iconDisabled() || this.controller.dispatch({ type: "toggle-ticker" }) }, u.prototype.getPlayIcon = function () { return this.controller.getTickerPlaying() ? "pause" : "play" }, u.prototype.getIconAriaLabel = function () { return this.controller.getTickerPlaying() ? this.controller.s("graphing-calculator-label-ticker-pause") : this.controller.s("graphing-calculator-label-ticker-play") }, u.prototype.getFocusedInput = function () { var e = this.controller.getFocusLocation(); if (e && "ticker" === e.type) return e.location }, u.prototype.handlePressedKey = function (e, t, n) { var o = r.default.getFocusedMathquill(); if (o) { if ("Enter" === t && this.shouldShowSliderPrompt() && this.controller.dispatch({ type: "create-sliders-for-ticker", variables: c.getMissingVariables(this.props.controller().getTicker()) }), "Right" === t && "handler" === e || "Left" === t && "minstep" === e || "Down" === t) { if (!r.default.applyArrowKeyAndReturnIfWasAtBounds(o, t, n)) return; if ("Down" === t) return this.controller.dispatch({ type: "on-special-key-pressed", key: t }); if ("Right" === t) return void this.handleFocusedChanged("minstep", !0); if ("Left" === t) return void this.handleFocusedChanged("handler", !0) } o.keystroke(t, n), "handler" === e ? this.dispatchHandlerLatexIfChanged(o.latex()) : "minstep" === e && this.dispatchMinStepLatexIfChanged(o.latex()) } }, u.prototype.handleFocusedChanged = function (e, t) { t ? this.controller.dispatch({ type: "set-focus-location", location: { type: "ticker", location: e } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "ticker", location: e } }) }, u.prototype.dispatchHandlerLatexIfChanged = function (e) { this.getHandlerLatex() !== e && this.controller.dispatch({ type: "update-ticker-handlerlatex", latex: e }) }, u.prototype.dispatchMinStepLatexIfChanged = function (e) { this.getMinStepLatex() !== e && this.controller.dispatch({ type: "update-ticker-minsteplatex", latex: e }) }, u.prototype.getHandlerLatex = function () { return this.controller.getTickerHandlerLatex() }, u.prototype.getMinStepLatex = function () { return this.controller.getTickerMinStepLatex() }, u.prototype.getMQConfig = function () { return { autoOperatorNames: o.getAutoOperators({ additionalOperators: ["dt"] }), autoCommands: o.getAutoCommands() } }, u.prototype.getHandlerErrorString = function () { return this.getHandlerLatex() ? c.getHandlerPackedError(this.controller.getTicker()) : void 0 }, u.prototype.getMinStepErrorString = function () { return c.getMinStepPackedError(this.controller.getTicker()) }, u.prototype.shouldShowSliderPrompt = function () { return !!this.controller.areSlidersEnabled() && c.getMissingVariables(this.controller.getTicker()).length > 0 }, u }(n.Class); e.Ticker = h });

define('loadcss!expressions/list-view', function () { });

define('loadcss!expressions', function () { });
define('expressions/list-view', ["require", "exports", "tslib", "touchtracking", "keys", "dcgview", "jquery", "underscore", "lib/conditional_blur", "./expression_view", "./text_view", "./table-view", "./folder-view", "./image-view", "./shell_view", "./drag_container_view", "main/data_helpers", "./new_expression_view", "./expressions-header", "main/load-graph-from-link", "lib/get-clipboard-data", "graphing-calc/models/abstract-item", "graphing-calc/models/list", "graphing-calc/models/expression", "./exp-list-resizer", "./item-settings-view", "./expression-search-bar", "./ticker", "loadcss!./list-view", "loadcss!expressions", "jquery.handleevent"], function (require, e, t, n, o, r, i, l, s, a, c, p, d, u, f, g, h, m, y, v, x, E, b, D, w, k, P, L) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var F = r.Components, S = F.If, T = F.For, M = F.Switch, C = F.SwitchUnion, I = function (e) { function F() { var t = null !== e && e.apply(this, arguments) || this; return t.guid = l.uniqueId("listView"), t } return t.__extends(F, e), F.prototype.init = function () { this.controller = this.props.controller() }, F.prototype.template = function () { var e = this; return r.createElement("div", { didMount: this.bindFn(this.didMountContainer) }, r.createElement("div", { class: r.const("dcg-exppanel-outer"), onDrop: this.bindFn(this.onDrop), style: function () { return e.computeExppanelOuterStyle() } }, r.createElement(S, { predicate: function () { return e.controller.isFileDraggedOver() } }, function () { return r.createElement("div", { class: r.const("dcg-drop-image") }, r.createElement("span", null, function () { return e.controller.s("graphing-calculator-label-drop-image-here") })) }), r.createElement("div", { class: function () { return { "dcg-exppanel-container": !0, "dcg-add-shadow": e.controller.shouldRenderList() } }, style: function () { return { transform: e.controller.isListVisible() ? void 0 : e.controller.isNarrow() ? "translate(0, 100%)" : "translate(-100%, 0)" } } }, r.createElement(S, { predicate: function () { return e.controller.shouldRenderList() } }, function () { return r.createElement(y.default, { controller: e.props.controller, expsScrolled: function () { return !!e.exppanel && e.exppanel.scrollTop > 0 } }) }), r.createElement(S, { predicate: function () { return e.controller.getExpressionSearchOpen() } }, function () { return r.createElement(P.ExpressionSearchBar, { controller: e.props.controller, expsScrolled: function () { return !!e.exppanel && e.exppanel.scrollTop > 0 } }) }), r.createElement(S, { predicate: function () { return e.controller.getTickerOpen() && !e.controller.getTicker().filteredBySearch } }, function () { return r.createElement(L.Ticker, { controller: e.props.controller, expsScrolled: function () { return !!e.exppanel && e.exppanel.scrollTop > 0 } }) }), r.createElement(S, { predicate: function () { return e.controller.shouldRenderList() } }, function () { return r.createElement("div", { class: function () { return { "dcg-exppanel": !0, "dcg-disable-horizontal-scroll-to-cursor": !0, "dcg-isDragging": e.controller.isDragDropActive(), "dcg-has-background-color": e.controller.hasBackgroundColor() } }, style: function () { return { background: e.controller.getBackgroundColor() } }, onPaste: e.bindFn(e.onPaste), onTapStart: e.bindFn(e.onExppanelTapstart), didMount: e.bindFn(e.didMountExppanel) }, r.createElement("div", { class: r.const("dcg-expressionlist"), role: r.const("complementary"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-expression-list") } }, r.createElement(T, { each: function () { return e.controller.getAllItemModels() }, key: function (e) { return e.guid } }, r.createElement("span", { class: r.const("dcg-template-expressioneach") }, function (t) { return C(function () { return E.getDisplayState(t) }, { shell: function () { return e.makeShellViewForModel(t) }, render: function () { return e.makeViewForModel(t) }, none: function () { } }) })), r.createElement(m.default, { controller: function () { return e.props.controller() } }), r.createElement(M, { key: function () { return e.controller.getDraggedItemId() } }, function (t) { if (t) { var n = e.controller.getItemModel(t); return r.createElement(g.default, { controller: e.props.controller }, e.makeDragCopyViewForModel(n)) } }), r.createElement("div", { class: r.const("dcg-expressions-branding"), style: function () { return { opacity: e.controller.isKeypadOpen() ? 0 : 1 } } }, r.createElement(S, { predicate: function () { return e.controller.canEditOnWeb() } }, function () { return r.createElement("span", { role: r.const("link"), tabindex: r.const(0), class: r.const("dcg-edit-branding"), onTap: function () { return e.controller.dispatch({ type: "open-on-web" }) } }, r.createElement("div", { class: r.const("dcg-powered-by"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-edit-graph-on-desmos") } }, function () { return e.controller.s("graphing-calculator-button-edit-graph-on-desmos-logo") }), r.createElement("i", { class: r.const("dcg-icon-desmos"), "aria-hidden": r.const("true") })) }), r.createElement(S, { predicate: function () { return !e.controller.canEditOnWeb() } }, function () { return r.createElement("span", { class: r.const("dcg-noedit-branding") }, r.createElement("div", { class: r.const("dcg-powered-by"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-powered-by-desmos") } }, function () { return e.controller.s("graphing-calculator-label-powered-by") }), r.createElement("i", { class: r.const("dcg-icon-desmos"), "aria-hidden": r.const("true") })) })))) })), r.createElement(w.ExpListResizer, { controller: this.props.controller })), r.createElement(k.ItemSettingsView, { controller: this.props.controller })) }, F.prototype.makeShellViewForModel = function (e) { return r.createElement(f.default, { controller: this.props.controller, model: function () { return e }, onDragPending: function () { }, isDragCopy: function () { return !1 } }) }, F.prototype.computeExppanelOuterStyle = function () { this.getListBottomAndUpdateLastExpressionPadding(); var e = this.controller.computeMajorLayout().list, t = e.top; return e.top > 0 && !this.controller.isListVisible() && (t -= e.height), { position: "absolute", left: "0px", top: t + "px", width: e.width + "px", height: e.height + "px" } }, F.prototype.makeDragCopyViewForModel = function (e) { return this.makeViewForModel(e, !0) }, F.prototype.makeViewForModel = function (e, t) { var n, o = this; if (void 0 === t && (t = !1), "table" === e.type) n = r.createElement(p.default, { controller: this.props.controller, model: function () { return e }, onDragPending: function (t) { return o.onDragPending(t, e.id) }, isDragCopy: function () { return t } }); else if ("folder" === e.type) n = r.createElement(d.default, { controller: this.props.controller, model: function () { return e }, onDragPending: function (t) { return o.onDragPending(t, e.id) }, isDragCopy: function () { return t } }); else if ("text" === e.type) n = r.createElement(c.default, { controller: this.props.controller, model: function () { return e }, onDragPending: function (t) { return o.onDragPending(t, e.id) }, isDragCopy: function () { return t } }); else if ("image" === e.type) n = r.createElement(u.default, { controller: this.props.controller, model: function () { return e }, onDragPending: function (t) { return o.onDragPending(t, e.id) }, isDragCopy: function () { return t } }); else { if ("expression" !== e.type) return; n = r.createElement(a.default, { controller: this.props.controller, model: function () { return e }, onDragPending: function (t) { return o.onDragPending(t, e.id) }, isDragCopy: function () { return t } }) } return n }, F.prototype.didUnmount = function () { i(document.documentElement).off("." + this.guid) }, F.prototype.didMountContainer = function (e) { this.node = e, i(document.documentElement).on("keydown." + this.guid, this.bindFn(this.handleKeyDown)) }, F.prototype.didMountExppanel = function (e) { this.exppanel = e }, F.prototype.getListBottomAndUpdateLastExpressionPadding = function () { var e = this.controller.getKeypadHeight(), t = this.__listBottom || 0; return this.__listBottom = e, 0 === e && 0 !== t && n.isTapActive() && this.padLastExpressionUntilTapEnd(t), e }, F.prototype.padLastExpression = function (e) { i(this.node).find(".dcg-expressionitem.dcg-new-expression").css("margin-bottom", e + "px") }, F.prototype.unpadLastExpression = function () { i(this.node).find(".dcg-expressionitem.dcg-new-expression").css("margin-bottom", "0") }, F.prototype.padLastExpressionUntilTapEnd = function (e) { var t = this; this.padLastExpression(e), i(document).on("dcg-tap.animating-bottom", function () { t.unpadLastExpression(), i(document).off("dcg-tap.animating-bottom") }) }, F.prototype.handleKeyDown = function (e) { if (!this.controller.inAudioTraceMode()) { var t = o.lookup(e), n = o.lookupChar(e), r = this.controller.getSelectedItem(); if (r) { var l = this.controller.getFocusLocation(); if (e.ctrlKey && e.shiftKey && !e.metaKey && !e.altKey && void 0 !== l) { if ("O" === n) { e.preventDefault(), e.stopPropagation(); var s = void 0; if ("expression" === r.type) r.sliderExists || D.isNonemptyAction(r) ? r.sliderExists && (s = { type: "slider", model: r, guid: "slider-" + r.guid, focusFirstOption: !0, previousFocusLocation: l }, this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-animation-properties-icon", id: r.id } })) : (s = { type: "expression", model: r, guid: r.guid, focusFirstOption: !0, previousFocusLocation: l }, this.controller.dispatch({ type: "set-focus-location", location: { type: "expression-icon", id: r.id } })); else if ("image" === r.type) s = { type: "image", model: r, guid: r.guid, focusFirstOption: !0, previousFocusLocation: l }, this.controller.dispatch({ type: "set-focus-location", location: { type: "image-icon", id: r.id } }); else if ("table" === r.type && "table" === l.type) { var a = l.location; if (!a) return; var c = r.columnModels[a.column]; if (!c) return; if ("" === c.latex) return; if (!this.controller.getGraphSettings().config.graphpaper) return; if (c.error) return; if (0 === c.index) return; s = { type: "table-column", model: c, guid: c.guid, focusFirstOption: !0, previousFocusLocation: l }, this.controller.dispatch({ type: "set-focus-location", location: { type: "table-icon", id: r.id, columnId: c.id } }) } if (!s) return; return void this.controller.dispatch({ type: "toggle-item-settings-menu", menu: s }) } if ("D" === n) return e.preventDefault(), e.stopPropagation(), void this.controller.dispatch({ type: "delete-item-and-animate-out", id: r.id, setFocusAfterDelete: !0 }) } if (!this.controller.isInEditListMode() || e.altKey || e.ctrlKey || e.metaKey) { if ((!document.activeElement || !i.contains(document.body, document.activeElement)) && !i(e.target).closest(this.exppanel).length && i.contains(document.documentElement, e.target)) switch (t) { case o.UP: e.preventDefault(), this.controller.dispatch({ type: "select-previous-expression" }); break; case o.DOWN: e.preventDefault(), this.controller.dispatch({ type: "select-next-expression" }); break; case o.ESCAPE: e.preventDefault(), this.controller.dispatch({ type: "set-none-selected" }); break; case o.RIGHT: e.preventDefault(), r && ("expression" === r.type && r.sliderExists ? (this.controller.dispatch({ type: "adjust-slider-by-keyboard", id: r.id, adjustment: "up" }), this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: r.id } })) : this.controller.dispatch({ type: "move-focus-to-item", id: r.id, where: "start" })); break; case o.TAB: e.preventDefault(), r && this.controller.dispatch({ type: "move-focus-to-item", id: r.id, where: "start" }); break; case o.LEFT: e.preventDefault(), r && ("expression" === r.type && r.sliderExists ? (this.controller.dispatch({ type: "adjust-slider-by-keyboard", id: r.id, adjustment: "down" }), this.controller.dispatch({ type: "set-focus-location", location: { type: "slider-thumb", id: r.id } })) : this.controller.dispatch({ type: "move-focus-to-item", id: r.id, where: "end" })); break; case o.BACKSPACE: e.preventDefault(), r && this.controller.dispatch({ type: "upward-delete-selected-expression" }); break; case o.DELETE: e.preventDefault(), r && this.controller.dispatch({ type: "downward-delete-selected-expression" }); break; case o.ENTER: e.wasHandled("create-expression-with-keyboard") || (e.preventDefault(), e.handle("create-expression-with-keyboard"), r && this.controller.dispatch({ type: "on-special-key-pressed", key: "Enter" })); break; default: if (e.metaKey || e.ctrlKey || t === o.SHIFT || t === o.SPACEBAR) return; r && ("table" === r.type || this.controller.dispatch({ type: "move-focus-to-item", id: r.id, where: "end" })) } } else if (t === o.TAB && void 0 !== l) { var p = this.controller.getItemModelByIndex(0); if (!p) return; var d = ("readonly-expression" === l.type && "expression" === p.type || "table-container" === l.type && "table" === p.type || l.type === p.type) && l.id === p.id, u = { type: "edit-list-toggle" }, f = this.controller.isFocusLocationFocused(u); e.shiftKey && d ? (e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "set-focus-location", location: u })) : !e.shiftKey && f && (e.preventDefault(), e.stopPropagation(), this.controller.dispatch({ type: "move-focus-to-item", id: p.id, where: "table" === p.type ? "container" : void 0 })) } else if (t === o.UP || t === o.DOWN) { var g = this.controller.getListModel(), h = t === o.UP ? b.findPrevSelectableItem(g, r.index) : b.findNextSelectableItem(g, r.index); if (!h) return; this.controller.dispatch({ type: "move-focus-to-item", id: h.id, where: "table" === h.type ? "container" : "start" }) } } } }, F.prototype.onDragPending = function (e, t) { var n = this; e.preventDefault(), s.default(); var o = e.touches[0].clientY, r = o, l = setTimeout(function () { i(document).off(".dragpending"), n.onDragStart(e, t, o, r) }, 500); i(document).on("dcg-tapmove.dragpending", function (s) { r = s.touches[0].clientY, Math.abs(r - o) > 3 && (clearTimeout(l), i(document).off(".dragpending"), n.onDragStart(e, t, o, r)) }), i(document).on("dcg-tapend.dragpending", function () { clearTimeout(l), i(document).off(".dragpending") }) }, F.prototype.onDragStart = function (e, t, n, o) { 1 === e.touches.length && (e.wasHandled("dcg-longhold") || this.controller.dispatch({ type: "start-dragdrop", id: t, grabY: n, mouseY: o })) }, F.prototype.onExppanelTapstart = function (e) { "mouse" !== e.device && 0 === i(e.target).closest(".dcg-expressionitem").length && s.default() }, F.prototype.onPaste = function (e) { var t = this, n = this.controller.getGraphSettings().config, o = x.default(e); if (o) { var r = /^\s*https?:\/\/([a-zA-Z0-9]*\.)?desmos\.com(:[0-9]+)?\/calculator\/./.test(o), i = this.controller.getSelectedItem(); if (n.pasteGraphLink && i && "folder" === i.type && r && "" === i.title) return e.stopPropagation(), e.preventDefault(), void v.default(this.controller, o, function (e, t) { return t(null, e) }); if (!i || "text" !== i.type && "folder" !== i.type) if (n.pasteGraphLink && r) { e.stopPropagation(), e.preventDefault(); var l = n.pasteGraphLinkCallback ? n.pasteGraphLinkCallback : function (e, t) { return t(null, e) }; v.default(this.controller, o, l) } else { if (n.pasteTableData) { var s = h.parse(o); if (void 0 !== s) return e.stopPropagation(), e.preventDefault(), this.controller.dispatch({ type: "paste-table", data: s }) } var a = h.getExpressions(o); if (void 0 === a); else { e.stopPropagation(), e.preventDefault(); var c = []; 1 === a.length && a[0].numberList ? this.controller.dispatch({ type: "append-number-list", latex: a[0].content }) : (a.forEach(function (e) { c.push({ type: "expression", id: t.controller.generateId(), latex: e.content }) }), this.controller.dispatch({ type: "insert-several-expressions", expressions: c })) } } } }, F.prototype.onDrop = function (e) { if (this.controller.areImagesEnabled()) { var t = e.dataTransfer && e.dataTransfer.files; t && this.controller.dispatch({ type: "new-images", files: t }) } }, F }(r.Class); e.default = I });
define('graphing-calc/keypads/dcgview-graphing', ["require", "exports", "tslib", "dcgview"], function (require, t, e, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return e.__extends(i, t), i.prototype.init = function () { this.controller = this.props.controller(), this.dispatch = this.controller.dispatch, this.s = this.controller.s }, i }(i.Class); t.default = r });

define('loadcss!keypad/btn', function () { });
define('keypad/btn', ["require", "exports", "tslib", "dcgview", "loadcss!./btn"], function (require, t, e, s) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.template = function () { var t = this; return s.createElement("div", { class: function () { return { "dcg-keypad-btn-container": !0, "dcg-disabled": t.isDisabled() } }, style: function () { return { "flex-grow": t.getColSpan() } } }, s.createElement("span", { role: s.const("button"), class: this.bindFn(this.getClasses), "dcg-command": this.props.command, "aria-label": this.bindFn(this.getAriaLabel), "aria-disabled": this.bindFn(this.isDisabled), onTap: function () { t.isDisabled() || t.props.onTap() } }, s.createElement("span", { class: s.const("dcg-keypad-btn-content") }, this.children))) }, n.prototype.getClasses = function () { var t = { "dcg-keypad-btn": !0, "dcg-keypad-btn-active": this.isActive() }, e = this.props.style(); switch (e) { case "default": t["dcg-btn-light-on-gray"] = !0; break; case "highlight": t["dcg-btn-dark-on-gray"] = !0; break; case "popover": t["dcg-btn-light-gray"] = !0; break; case "blue": t["dcg-btn-short-blue"] = !0; break; case "tall-blue": t["dcg-btn-tall-blue"] = !0; break; default: return e }return t }, n.prototype.isActive = function () { return !!this.props.active && this.props.active() }, n.prototype.getAriaLabel = function () { return this.props.ariaLabel ? this.props.ariaLabel() : this.props.command() }, n.prototype.getColSpan = function () { return this.props.colspan ? this.props.colspan() : void 0 }, n.prototype.isDisabled = function () { return this.props.disabled && this.props.disabled() }, n }(s.Class); t.default = n });
define('keypad/keys', ["require", "exports", "./btn", "dcgview-helpers/static-mathquill-view", "dcgview"], function (require, a, e, t, n) { "use strict"; Object.defineProperty(a, "__esModule", { value: !0 }), a.spacer = a.view = void 0; var r = n.Components, c = r.IfElse, o = r.If, l = r.Switch; function i(a, e) { return void 0 === a ? n.const(e) : "function" == typeof a ? a : n.const(a) } function d(a) { return function (r, o, l, d) { return void 0 === l && (l = {}), n.createElement(e.default, { command: n.const(a.command || a.typedText || a.keys[0]), ariaLabel: function () { return a.ariaLabelKey ? d(a.ariaLabelKey) : a.typedText || a.keys[0] }, colspan: i(l.colspan, 1), style: function () { return l.style || "default" }, onTap: function () { return o({ type: "keypad/type-text", text: a.typedText || a.keys[0] }) } }, c(function () { return "{" === a.keys[0] || "[" === a.keys[0] }, { true: function () { return n.createElement("span", { class: n.const("dcg-mq-math-mode"), style: n.const("font-size: 120%") }, n.const(a.keys[0]), n.const("Â "), n.createElement("span", { style: n.const("color: #999") }, n.const(a.keys[1]))) }, false: function () { return n.createElement("span", { class: n.const("dcg-either-or-btn") }, n.createElement(t.default, { config: n.const({}), latex: n.const(a.keys[0]) }), n.createElement("span", { style: n.const("color: #999") }, n.createElement(t.default, { config: n.const({}), latex: n.const(a.keys[1]) }))) } })) } } function s(a) { return function (r, o, l, d) { return void 0 === l && (l = {}), n.createElement(e.default, { command: n.const(a.command || a.typedText || a.keys[1]), ariaLabel: function () { return a.ariaLabelKey ? d(a.ariaLabelKey) : a.typedText || a.keys[0] }, colspan: i(l.colspan, 1), style: i(l.style, "default"), onTap: function () { return o({ type: "keypad/type-text", text: a.typedText || a.keys[1] }) } }, c(function () { return "}" === a.keys[1] || "]" === a.keys[1] }, { true: function () { return n.createElement("span", { class: n.const("dcg-mq-math-mode"), style: n.const("font-size: 120%") }, n.createElement("span", { style: n.const("color: #999") }, n.const(a.keys[0])), n.const("Â "), n.const(a.keys[1])) }, false: function () { return n.createElement("span", null, n.createElement("span", { style: n.const("color: #999") }, n.createElement(t.default, { config: n.const({}), latex: n.const(a.keys[0]) })), n.createElement(t.default, { config: n.const({}), latex: n.const(a.keys[1]) })) } })) } } function y(a) { return function (t, r, c, l) { return void 0 === c && (c = {}), n.createElement(e.default, { command: n.const(a.command), ariaLabel: function () { return a.ariaLabelKey ? l(a.ariaLabelKey) : t }, colspan: i(c.colspan, 1), style: function () { return c.style || "default" }, onTap: function () { r({ type: "keypad/audio-trace", command: a.command }) } }, n.createElement(o, { predicate: n.const(void 0 !== a.iconClass) }, function () { return n.createElement("span", { class: function () { return { "dcg-button-icon": !0, "dcg-icon-only": void 0 === a.contentKey } } }, n.createElement("i", { class: n.const(a.iconClass), "aria-hidden": n.const("true") })) }), n.createElement(o, { predicate: n.const(void 0 !== a.contentKey) }, function () { return n.createElement("span", null, function () { return l(a.contentKey) || t }) })) } } function u(a) { return function (r, c, o, l) { return void 0 === o && (o = {}), n.createElement(e.default, { command: n.const(a.command || r), ariaLabel: function () { return a.ariaLabelKey ? l(a.ariaLabelKey) : r }, colspan: i(o.colspan, 1), style: function () { return o.style || "default" }, onTap: function () { return c({ type: "keypad/type-text", text: a.typedText || r }) } }, n.createElement(t.default, { config: n.const({}), latex: n.const(a.content || r) })) } } function p(a) { return function (t, r, c, o) { return void 0 === c && (c = {}), n.createElement(e.default, { command: n.const(a.command || t), ariaLabel: function () { return a.ariaLabelKey ? o(a.ariaLabelKey) : t }, colspan: i(c.colspan, 1), style: function () { return c.style || "default" }, onTap: function () { return r({ type: "keypad/type-text", text: a.typedText || t }) } }, n.createElement("span", { class: n.const("dcg-mq-math-mode") }, n.const(a.content || t))) } } function k(a) { return function (r, c, o, d) { return void 0 === o && (o = {}), n.createElement(e.default, { command: n.const(r), ariaLabel: function () { return a.ariaLabelKey ? d(a.ariaLabelKey) : r }, colspan: i(o.colspan, 1), style: function () { return o.style || "default" }, onTap: function () { return c({ type: "keypad/type-text", text: r + "(" }) } }, n.createElement(l, { key: function () { return r.match(/^[a-z]{2,}$/) } }, function (a) { return a ? n.createElement("span", { class: n.const("dcg-mq-math-mode dcg-static-mathquill-view") }, n.createElement("span", { class: n.const("dcg-mq-root-block") }, n.createElement("span", { class: n.const("dcg-mq-operator-name") }, function () { return r }))) : n.createElement(t.default, { config: n.const({}), latex: n.const(r) }) })) } } function m(a) { return function (r, c, o, l) { return void 0 === o && (o = {}), n.createElement(e.default, { command: n.const(a.command), ariaLabel: function () { return a.ariaLabelKey ? l(a.ariaLabelKey) : a.command }, colspan: i(o.colspan, 1), style: function () { return o.style || "default" }, onTap: function () { c({ type: "keypad/custom-command", command: a.command }) } }, n.createElement(t.default, { config: n.const({}), latex: n.const(a.content) })) } } var f = { "{": p({ ariaLabelKey: "shared-calculator-narration-keypad-key-left-bracket" }), "}": p({ ariaLabelKey: "shared-calculator-narration-keypad-key-right-bracket" }), "(": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-left-paren" }), ")": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-right-paren" }), sqrt: u({ content: "\\sqrt{}", ariaLabelKey: "shared-calculator-narration-keypad-key-sqrt" }), "/": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-divide" }), division: u({ content: "Ã·", typedText: "/", command: "/", ariaLabelKey: "shared-calculator-narration-keypad-key-divide" }), obelus: u({ content: "Ã·", typedText: "Ã·", ariaLabelKey: "shared-calculator-narration-keypad-key-divide" }), "*": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-times" }), multiplication: u({ content: "Ã", typedText: "*", command: "*", ariaLabelKey: "shared-calculator-narration-keypad-key-times" }), "-": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-minus" }), "+": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-plus" }), ".": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-decimal" }), ans: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-ans") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/type-text", text: a }) } }, n.const("ans")) }, enter: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-enter") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/press-key", key: "Enter" }) } }, n.createElement("i", { class: n.const("dcg-icon-arrow-enter"), "aria-hidden": n.const("true") })) }, shift: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-shift") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, active: i(r.active, !1), onTap: function () { return t({ type: "keypad/shift" }) } }, n.createElement("i", { class: n.const("dcg-icon-shift"), "aria-hidden": n.const("true") })) }, left: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-left-arrow") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/press-key", key: "Left" }) } }, n.createElement("i", { class: n.const("dcg-icon-arrow-left"), "aria-hidden": n.const("true") })) }, right: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-right-arrow") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/press-key", key: "Right" }) } }, n.createElement("i", { class: n.const("dcg-icon-arrow-right"), "aria-hidden": n.const("true") })) }, 123: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-toggle-numbers") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/123" }) } }, n.const("1 2 3")) }, ABC: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-toggle-letters") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/abc" }) } }, n.const("A B C")) }, Audio: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-toggle-audio-trace") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "on" }) } }, n.createElement("i", { class: n.const("dcg-icon-volume"), "aria-hidden": n.const("true") })) }, backspace: function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("shared-calculator-narration-keypad-key-backspace") }, colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/press-key", key: "Backspace" }) } }, n.createElement("i", { class: n.const("dcg-icon-delete"), "aria-hidden": n.const("true") })) }, pi: u({ content: "\\pi", ariaLabelKey: "shared-calculator-narration-keypad-key-pi" }), alpha: u({ content: "\\alpha", ariaLabelKey: "shared-calculator-narration-keypad-key-alpha" }), beta: u({ content: "\\beta", ariaLabelKey: "shared-calculator-narration-keypad-key-beta" }), theta: u({ content: "\\theta", ariaLabelKey: "shared-calculator-narration-keypad-key-theta" }), tau: u({ content: "\\tau", ariaLabelKey: "shared-calculator-narration-keypad-key-tau" }), "a^2": m({ command: "a^2", content: "a^2", ariaLabelKey: "shared-calculator-narration-keypad-key-squared" }), "a^3": m({ command: "a^3", content: "a^3", ariaLabelKey: "shared-calculator-narration-keypad-key-cubed" }), "x^3": m({ command: "a^3", content: "x^3", ariaLabelKey: "shared-calculator-narration-keypad-key-cubed" }), "a^b": u({ content: "a^b", typedText: "^", ariaLabelKey: "shared-calculator-narration-keypad-key-superscript" }), a_b: u({ content: "a_b", typedText: "_", ariaLabelKey: "shared-calculator-narration-keypad-key-subscript" }), "a/b": m({ content: "\\frac{a}{b}", command: "a/b", ariaLabelKey: "shared-calculator-narration-keypad-key-fraction" }), "x^2": m({ command: "a^2", content: "x^2", ariaLabelKey: "shared-calculator-narration-keypad-key-squared" }), "x^y": u({ content: "x^y", typedText: "^", ariaLabelKey: "shared-calculator-narration-keypad-key-superscript" }), "x/y": u({ content: "\\frac{x}{y}", typedText: "/", ariaLabelKey: "shared-calculator-narration-keypad-key-fraction" }), nthroot: m({ command: "nthroot", content: "\\sqrt[n]{}", ariaLabelKey: "shared-calculator-narration-keypad-key-nthroot" }), ythroot: m({ command: "nthroot", content: "\\sqrt[y]{}", ariaLabelKey: "shared-calculator-narration-keypad-key-ythroot" }), sin: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-sin" }), cos: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-cos" }), tan: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-tan" }), sec: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-sec" }), csc: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-csc" }), cot: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-cot" }), sinh: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-sinh" }), cosh: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-cosh" }), tanh: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-tanh" }), sech: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-csch" }), csch: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-csch" }), coth: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-coth" }), arcsin: m({ command: "arcsin", content: "sin^{-1}", ariaLabelKey: "shared-calculator-narration-keypad-key-arcsin" }), arccos: m({ command: "arccos", content: "cos^{-1}", ariaLabelKey: "shared-calculator-narration-keypad-key-arccos" }), arctan: m({ command: "arctan", content: "tan^{-1}", ariaLabelKey: "shared-calculator-narration-keypad-key-arctan" }), arccsc: m({ command: "arccsc", content: "csc^{-1}", ariaLabelKey: "shared-calculator-narration-keypad-key-arccsc" }), arcsec: m({ command: "arcsec", content: "sec^{-1}", ariaLabelKey: "shared-calculator-narration-keypad-key-arcsec" }), arccot: m({ command: "arccot", content: "cot^{-1}", ariaLabelKey: "shared-calculator-narration-keypad-key-arccot" }), "|a|": u({ typedText: "|", ariaLabelKey: "shared-calculator-narration-keypad-key-abs" }), "|x|": u({ typedText: "|", ariaLabelKey: "shared-calculator-narration-keypad-key-abs" }), ln: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-ln" }), log: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-log" }), quantile: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-quantile" }), quartile: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-quartile" }), var: k({}), varp: k({}), nCr: k({}), loga: m({ command: "loga", content: "log_a", ariaLabelKey: "shared-calculator-narration-keypad-key-loga" }), stdev: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-stdev" }), mad: k({}), nPr: k({}), total: k({}), length: k({}), for: k({}), min: k({}), max: k({}), cov: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-cov" }), covp: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-covp" }), corr: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-corr" }), spearman: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-spearman" }), stats: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-stats" }), polygon: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-polygon" }), distance: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-distance" }), midpoint: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-midpoint" }), mean: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-mean" }), stdevp: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-stdevp" }), mod: k({}), "e^x": u({ typedText: "e^", ariaLabelKey: "shared-calculator-narration-keypad-key-exp" }), "10^n": u({ content: "\\times10^{n}", typedText: "*10^", ariaLabelKey: "shared-calculator-narration-keypad-key-10-n" }), "a^{-1}": u({ typedText: "^-1", ariaLabelKey: "shared-calculator-narration-keypad-key-reciprocal" }), sum: u({ content: "\\sum", ariaLabelKey: "shared-calculator-narration-keypad-key-sum" }), prod: u({ content: "\\prod", ariaLabelKey: "shared-calculator-narration-keypad-key-product" }), floor: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-floor" }), ceil: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-ceil" }), round: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-round" }), abs: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-abs" }), "!": u({ ariaLabelKey: "shared-calculator-narration-keypad-key-factorial" }), "n!": u({ typedText: "!", ariaLabelKey: "shared-calculator-narration-keypad-key-factorial" }), median: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-median" }), lcm: k({}), gcd: k({}), gcf: k({}), ddx: m({ command: "ddx", content: "\\frac{d}{dx}" }), int: u({ content: "\\int", ariaLabelKey: "shared-calculator-narration-keypad-key-int" }), "%": u({ content: "\\%", ariaLabelKey: "shared-calculator-narration-keypad-key-percent-of" }), "->": u({ content: "\\to", ariaLabelKey: "shared-calculator-narration-keypad-key-action-to" }), prime: u({ typedText: "'", content: "f'", ariaLabelKey: "shared-calculator-narration-keypad-key-prime" }), exp: u({}), sign: k({}), normaldist: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-normaldist" }), poissondist: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-poissondist" }), binomialdist: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-binomialdist" }), uniformdist: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-uniformdist" }), erf: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-erf" }), histogram: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-histogram" }), boxplot: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-boxplot" }), dotplot: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-dotplot" }), tscore: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-tscore" }), ittest: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-ittest" }), ttest: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-ttest" }), tdist: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-tdist" }), pdf: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-pdf" }), cdf: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-pdf" }), random: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-random" }), inversecdf: k({ ariaLabelKey: "shared-calculator-narration-keypad-key-inversecdf" }), sort: k({}), shuffle: k({}), unique: k({}), join: k({}), "A^-1": m({ command: "A^-1", content: "A^{-1}", ariaLabelKey: "matrix-calculator-narration-keypad-key-inverse" }), "A^T": m({ command: "A^T", content: "A^T", ariaLabelKey: "matrix-calculator-narration-keypad-key-transpose" }), "A^2": m({ command: "A^2", content: "A^2", ariaLabelKey: "shared-calculator-narration-keypad-key-squared" }), "A^n": u({ content: "A^n", typedText: "^", ariaLabelKey: "shared-calculator-narration-keypad-key-exp" }), det: k({ ariaLabelKey: "matrix-calculator-narration-keypad-key-det" }), trace: k({ ariaLabelKey: "matrix-calculator-narration-keypad-key-trace" }), rref: k({ ariaLabelKey: "matrix-calculator-narration-keypad-key-rref" }), a: u({}), b: u({}), c: u({}), d: u({}), e: u({}), f: u({}), g: u({}), h: u({}), i: u({}), j: u({}), k: u({}), l: u({}), m: u({}), n: u({}), o: u({}), p: u({}), q: u({}), r: u({}), s: u({}), t: u({}), u: u({}), v: u({}), w: u({}), x: u({}), boldX: u({ content: "x", typedText: "x" }), y: u({}), boldY: u({ content: "y", typedText: "y" }), z: u({}), A: u({}), B: u({}), C: u({}), D: u({}), E: u({}), F: u({}), G: u({}), H: u({}), I: u({}), J: u({}), K: u({}), L: u({}), M: u({}), N: u({}), O: u({}), P: u({}), Q: u({}), R: u({}), S: u({}), T: u({}), U: u({}), V: u({}), W: u({}), X: u({}), Y: u({}), Z: u({}), 0: u({}), 1: u({}), 2: u({}), 3: u({}), 4: u({}), 5: u({}), 6: u({}), 7: u({}), 8: u({}), 9: u({}), ",": u({}), "=": u({}), "[": u({}), "]": u({}), "{}_left": d({ keys: ["{", "}"] }), "{}_right": s({ keys: ["{", "}"] }), "()_left": d({ keys: ["(", ")"] }), "()_right": s({ keys: ["(", ")"] }), "[]_left": d({ keys: ["[", "]"] }), "[]_right": s({ keys: ["[", "]"] }), ",'_left": d({ keys: [",", "â²"] }), ",'_right": s({ keys: [",", "â²"], typedText: "'" }), '"': u({}), "'": u({}), "~": u({}), ":": u({}), ">": u({}), "<": u({}), ">=": u({ content: "\\ge" }), "<=": u({ content: "\\le" }), "!%_left": d({ keys: ["!", "{}^{%}"] }), "!%_right": s({ keys: ["!", "{}^{%}"], typedText: "%" }), "~:_left": d({ keys: ["~", "{}^{:}"] }), "~:_right": s({ keys: ["~", "{}^{:}"], typedText: ":" }), "audio-trace-off": y({ contentKey: "graphing-calculator-button-keypad-audio-trace-off", command: "off" }), "hear-graph": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: i(r.style, "blue"), onTap: function () { t({ type: "keypad/audio-trace", command: "hear-graph" }) } }, n.createElement("span", { class: n.const("dcg-play-icon-container") }, n.createElement("i", { class: n.const("dcg-icon-play"), "aria-hidden": n.const("true") })), n.createElement("span", null, function () { return c("graphing-calculator-button-audio-trace-hear-graph") })) }, "stop-graph": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: i(r.style, "blue"), onTap: function () { t({ type: "keypad/audio-trace", command: "stop-graph" }) } }, n.createElement("span", { class: n.const("dcg-stop-icon-container") }, n.createElement("span", { class: n.const("dcg-stop-icon") })), n.createElement("span", null, function () { return c("graphing-calculator-button-audio-trace-stop-graph") })) }, "volume-down": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-volume-down") }, disabled: i(r.disabled, !1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "volume-down" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-volume-down"), "aria-hidden": n.const("true") }))) }, "volume-up": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-volume-up") }, disabled: i(r.disabled, !1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "volume-up" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-volume-up"), "aria-hidden": n.const("true") }))) }, "speed-down": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-speed-down") }, disabled: i(r.disabled, !1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "speed-down" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-hide"), "aria-hidden": n.const("true") }))) }, "speed-up": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { command: n.const(a), ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-speed-up") }, disabled: i(r.disabled, !1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "speed-up" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-show"), "aria-hidden": n.const("true") }))) }, "previous-point": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-previous-point") }, command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "previous-point" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-thin-arrow-left"), "aria-hidden": n.const("true") }))) }, "next-point": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-next-point") }, command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "next-point" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-thin-arrow-right"), "aria-hidden": n.const("true") }))) }, "previous-poi": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-previous-poi") }, command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "previous-poi" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-hide"), "aria-hidden": n.const("true") }))) }, "next-poi": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-next-poi") }, command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "next-poi" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-show"), "aria-hidden": n.const("true") }))) }, "previous-curve": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-previous-curve") }, command: n.const(a), disabled: i(r.disabled, !1), colspan: i(r.colspan, 1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "previous-curve" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-caret-up"), "aria-hidden": n.const("true") }))) }, "next-curve": function (a, t, r, c) { return void 0 === r && (r = {}), n.createElement(e.default, { ariaLabel: function () { return c("graphing-calculator-narration-keypad-key-next-curve") }, command: n.const(a), disabled: i(r.disabled, !1), style: function () { return r.style || "default" }, onTap: function () { return t({ type: "keypad/audio-trace", command: "next-curve" }) } }, n.createElement("span", { class: n.const("dcg-button-icon dcg-icon-only") }, n.createElement("i", { class: n.const("dcg-icon-caret-down"), "aria-hidden": n.const("true") }))) }, "describe-point": y({ contentKey: "graphing-calculator-button-keypad-describe-point", command: "describe-point" }), "describe-curve": y({ contentKey: "graphing-calculator-button-keypad-describe-curve", command: "describe-curve" }) }; a.view = function (a, e, t) { void 0 === t && (t = {}); var n = a.dispatch; return f[e](e, n, t, a.s) }, a.spacer = function (a) { return void 0 === a && (a = 1), n.createElement("div", { style: n.const("flex-grow:" + a) }) } });
define('keypad/dcgview-keypad', ["require", "exports", "tslib", "dcgview"], function (require, t, e, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.init = function () { this.controller = this.props.controller() }, n }(n.Class); t.default = r });

define('loadcss!keypad/keypad', function () { });
define('keypad/keypad', ["require", "exports", "tslib", "dcgview", "./dcgview-keypad", "loadcss!./keypad"], function (require, e, t, n, d) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var i = function (e) { function d() { return null !== e && e.apply(this, arguments) || this } return t.__extends(d, e), d.prototype.template = function () { return n.createElement("div", { class: n.const("dcg-basic-keypad dcg-do-not-blur") }, this.children) }, d }(d.default); e.default = i });

define('loadcss!keypad/row', function () { });
define('keypad/row', ["require", "exports", "tslib", "dcgview", "loadcss!./row"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { return n.createElement("div", { class: n.const("dcg-keypad-row") }, this.children) }, r }(n.Class); e.default = r });
define('graphing-calc/keypads/qwerty', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var w = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(v.default, null, h.view(this, "q"), h.view(this, "w"), h.view(this, "e"), h.view(this, "r"), h.view(this, "t"), h.view(this, "y"), h.view(this, "u"), h.view(this, "i"), h.view(this, "o"), h.view(this, "p")), t.createElement(v.default, null, h.view(this, "a"), h.view(this, "s"), h.view(this, "d"), h.view(this, "f"), h.view(this, "g"), h.view(this, "h"), h.view(this, "j"), h.view(this, "k"), h.view(this, "l"), h.view(this, "theta")), t.createElement(v.default, null, h.view(this, "shift", { colspan: 1.364, style: "highlight" }), h.spacer(.136), h.view(this, "z"), h.view(this, "x"), h.view(this, "c"), h.view(this, "v"), h.view(this, "b"), h.view(this, "n"), h.view(this, "m"), h.spacer(.136), h.view(this, "backspace", { colspan: 1.364, style: "highlight" })), t.createElement(v.default, null, h.view(this, "123", { colspan: 1.818, style: "highlight" }), h.spacer(.182), h.view(this, "a_b"), h.view(this, "!%_left"), h.view(this, "[]_left"), h.view(this, "{}_left"), h.view(this, "~:_left"), h.view(this, ",'_left"), h.spacer(.182), h.view(this, "enter", { colspan: 1.818, style: "blue" }))) }, s }(s.default); e.default = w });
define('graphing-calc/keypads/qwerty-capital', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var w = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(v.default, null, h.view(this, "Q"), h.view(this, "W"), h.view(this, "E"), h.view(this, "R"), h.view(this, "T"), h.view(this, "Y"), h.view(this, "U"), h.view(this, "I"), h.view(this, "O"), h.view(this, "P")), t.createElement(v.default, null, h.view(this, "A"), h.view(this, "S"), h.view(this, "D"), h.view(this, "F"), h.view(this, "G"), h.view(this, "H"), h.view(this, "J"), h.view(this, "K"), h.view(this, "L"), h.view(this, "tau")), t.createElement(v.default, null, h.view(this, "shift", { colspan: 1.364, active: !0, style: "highlight" }), h.spacer(.136), h.view(this, "Z"), h.view(this, "X"), h.view(this, "C"), h.view(this, "V"), h.view(this, "B"), h.view(this, "N"), h.view(this, "M"), h.spacer(.136), h.view(this, "backspace", { colspan: 1.364, style: "highlight" })), t.createElement(v.default, null, h.view(this, "123", { colspan: 1.818, style: "highlight" }), h.spacer(.182), h.view(this, "a^b"), h.view(this, "!%_right"), h.view(this, "[]_right"), h.view(this, "{}_right"), h.view(this, "~:_right"), h.view(this, ",'_right"), h.spacer(.182), h.view(this, "enter", { colspan: 1.818, style: "blue" }))) }, s }(s.default); e.default = w });
define('graphing-calc/keypads/numbers', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "keypad/keypad", "keypad/row", "keypad/btn"], function (require, t, e, i, n, s, l, r, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var h = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.template = function () { var t = this; return i.createElement(l.default, { controller: this.props.controller }, i.createElement(r.default, null, s.view(this, "boldX"), s.view(this, "boldY"), s.view(this, "a^2"), s.view(this, "a^b"), s.spacer(.5), s.view(this, "7", { style: "highlight" }), s.view(this, "8", { style: "highlight" }), s.view(this, "9", { style: "highlight" }), s.view(this, "division"), s.spacer(.5), i.createElement(a.default, { command: this.const("functions"), ariaLabel: function () { return t.controller.s("graphing-calculator-narration-functions") }, colspan: this.const(2), style: this.const("highlight"), active: function () { return t.controller.isKeypadFunctionsPopoverOpen() }, onTap: function () { return t.dispatch({ type: "keypad/functions" }) } }, this.bindFn(this.getFuncsBtnText))), i.createElement(r.default, null, s.view(this, "("), s.view(this, ")"), s.view(this, "<"), s.view(this, ">"), s.spacer(.5), s.view(this, "4", { style: "highlight" }), s.view(this, "5", { style: "highlight" }), s.view(this, "6", { style: "highlight" }), s.view(this, "multiplication"), s.spacer(.5), s.view(this, "left", { style: "highlight" }), s.view(this, "right", { style: "highlight" })), i.createElement(r.default, null, s.view(this, "|a|"), s.view(this, ","), s.view(this, "<="), s.view(this, ">="), s.spacer(.5), s.view(this, "1", { style: "highlight" }), s.view(this, "2", { style: "highlight" }), s.view(this, "3", { style: "highlight" }), s.view(this, "-"), s.spacer(1), s.view(this, "backspace", { colspan: 1.5, style: "highlight" })), i.createElement(r.default, null, i.createElement("div", { class: i.const("dcg-abc-audio-container") }, i.createElement(a.default, { command: i.const("ABC"), colspan: this.const(1), ariaLabel: function () { return t.controller.s("graphing-calculator-narration-toggle-letters") }, style: this.const("highlight"), onTap: function () { t.dispatch({ type: "keypad/abc" }) } }, function () { return t.controller.getLayoutMeasurements().width <= 600 ? t.controller.raw("ABC") : t.controller.raw("A B C") }), i.createElement(a.default, { command: i.const("Audio"), disabled: function () { return !t.controller.canAudioTrace() }, ariaLabel: function () { return t.controller.s("graphing-calculator-narration-toggle-audio-trace") }, colspan: this.const(1), style: function () { return "highlight" }, onTap: function () { return t.dispatch({ type: "keypad/audio-trace", command: "on" }) } }, i.createElement("i", { class: i.const("dcg-icon-volume"), "aria-hidden": i.const("true") }))), s.view(this, "sqrt"), s.view(this, "pi"), s.spacer(.5), s.view(this, "0", { style: "highlight" }), s.view(this, ".", { style: "highlight" }), s.view(this, "="), s.view(this, "+"), s.spacer(.5), s.view(this, "enter", { colspan: 2, style: "blue" }))) }, n.prototype.getFuncsBtnText = function () { return this.controller.isNarrow() ? this.controller.s("graphing-calculator-button-funcs") : this.controller.s("graphing-calculator-button-functions") }, n }(n.default); t.default = h });
define('graphing-calc/keypads/letters', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var w = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(v.default, null, h.view(this, "a"), h.view(this, "b"), h.view(this, "c"), h.view(this, "d"), h.view(this, "e"), h.view(this, "f"), h.view(this, "g"), h.view(this, "h"), h.view(this, "i"), h.view(this, "j")), t.createElement(v.default, null, h.view(this, "k"), h.view(this, "l"), h.view(this, "m"), h.view(this, "n"), h.view(this, "o"), h.view(this, "p"), h.view(this, "q"), h.view(this, "r"), h.view(this, "s"), h.view(this, "t")), t.createElement(v.default, null, h.view(this, "shift", { style: "highlight" }), h.view(this, "u"), h.view(this, "v"), h.view(this, "w"), h.view(this, "x"), h.view(this, "y"), h.view(this, "z"), h.view(this, "theta"), h.view(this, "backspace", { colspan: 2, style: "highlight" })), t.createElement(v.default, null, h.view(this, "123", { colspan: 2, style: "highlight" }), h.view(this, "a_b"), h.view(this, "!%_left"), h.view(this, "[]_left"), h.view(this, "{}_left"), h.view(this, "~:_left"), h.view(this, ",'_left"), h.view(this, "enter", { colspan: 2, style: "blue" }))) }, s }(s.default); e.default = w });
define('graphing-calc/keypads/letters-capital', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var w = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(v.default, null, h.view(this, "A"), h.view(this, "B"), h.view(this, "C"), h.view(this, "D"), h.view(this, "E"), h.view(this, "F"), h.view(this, "G"), h.view(this, "H"), h.view(this, "I"), h.view(this, "J")), t.createElement(v.default, null, h.view(this, "K"), h.view(this, "L"), h.view(this, "M"), h.view(this, "N"), h.view(this, "O"), h.view(this, "P"), h.view(this, "Q"), h.view(this, "R"), h.view(this, "S"), h.view(this, "T")), t.createElement(v.default, null, h.view(this, "shift", { style: "highlight" }), h.view(this, "U"), h.view(this, "V"), h.view(this, "W"), h.view(this, "X"), h.view(this, "Y"), h.view(this, "Z"), h.view(this, "tau"), h.view(this, "backspace", { colspan: 2, style: "highlight" })), t.createElement(v.default, null, h.view(this, "123", { colspan: 2, style: "highlight" }), h.view(this, "a^b"), h.view(this, "!%_right"), h.view(this, "[]_right"), h.view(this, "{}_right"), h.view(this, "~:_right"), h.view(this, ",'_right"), h.view(this, "enter", { colspan: 2, style: "blue" }))) }, s }(s.default); e.default = w });

define('loadcss!graphing-calc/keypads/audio', function () { });
define('graphing-calc/keypads/audio', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "keypad/keypad", "keypad/btn", "../../shared-components/tooltip", "graphing/audiograph", "shared/dcgviews/localize", "loadcss!./audio"], function (require, e, t, i, n, o, a, c, s, r, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var d = i.Components, u = d.If, p = d.IfElse, g = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { var e = this; return i.createElement(a.default, { controller: this.props.controller }, i.createElement("div", { class: i.const("dcg-audio-keypad-container") }, i.createElement("div", { class: i.const("dcg-audio-keypad-column dcg-playback-column") }, i.createElement(s.Tooltip, { tooltip: this.bindFn(this.getDisabledTooltipText), gravity: this.const("s"), sticky: this.const(!1) }, i.createElement("div", { class: i.const("dcg-btn-playback") }, p(function () { return e.controller.isAudioTracing() }, { true: function () { return o.view(e, "stop-graph", { disabled: e.bindFn(e.isAudioDisabled) }) }, false: function () { return o.view(e, "hear-graph", { disabled: e.bindFn(e.isAudioDisabled) }) } }))), i.createElement("div", { class: i.const("dcg-key-nav-section-container") }, i.createElement(s.Tooltip, { tooltip: this.bindFn(this.getDisabledTooltipText), class: this.const("dcg-volume-button-container"), gravity: this.const("s"), sticky: this.const(!1) }, i.createElement("div", { class: i.const("dcg-key-nav-section") }, o.view(this, "volume-down", { disabled: this.bindFn(this.isVolumeDownDisabled) }), i.createElement("div", { role: i.const("heading"), "aria-level": i.const("2"), class: function () { return { "dcg-key-nav-section-title-container": !0, "dcg-disabled": e.isAudioDisabled() } } }, i.createElement("span", { class: i.const("dcg-key-nav-section-title") }, function () { return e.controller.s("graphing-calculator-label-audio-trace-volume") }), i.createElement("span", { class: i.const("dcg-keypad-volume-value dcg-key-nav-section-value") }, function () { return e.getAudioTraceVolume() })), o.view(this, "volume-up", { disabled: this.bindFn(this.isVolumeUpDisabled) })))), i.createElement("div", { class: i.const("dcg-key-nav-section-container") }, i.createElement(s.Tooltip, { tooltip: this.bindFn(this.getDisabledTooltipText), gravity: this.const("s"), sticky: this.const(!1) }, i.createElement("div", { class: i.const("dcg-key-nav-section") }, o.view(this, "speed-down", { disabled: this.bindFn(this.isSpeedDownDisabled) }), i.createElement("div", { class: function () { return { "dcg-key-nav-section-title-container": !0, "dcg-disabled": e.isAudioDisabled() } }, role: i.const("heading"), "aria-level": i.const("2") }, i.createElement("span", { class: i.const("dcg-key-nav-section-title") }, function () { return e.controller.s("graphing-calculator-label-audio-trace-speed") }), i.createElement("span", { class: i.const("dcg-keypad-speed-value dcg-key-nav-section-value") }, function () { return e.getAudioTraceSpeed() })), o.view(this, "speed-up", { disabled: this.bindFn(this.isSpeedUpDisabled) })))), o.view(this, "audio-trace-off", { style: "highlight" })), i.createElement("div", { class: i.const("dcg-audio-keypad-spacer") }), i.createElement("div", { class: i.const("dcg-audio-keypad-column dcg-navigation-column") }, i.createElement("span", { class: i.const("dcg-key-section-title dcg-center-col"), role: i.const("heading"), "aria-level": i.const("2") }, function () { return e.controller.s("graphing-calculator-heading-audio-trace-navigation") }), i.createElement("div", { class: i.const("dcg-key-nav-section dcg-center-col") }, o.view(this, "previous-point", { disabled: this.bindFn(this.isPrevPointDisabled) }), i.createElement("div", { class: i.const("dcg-key-nav-section-title-container"), role: i.const("heading"), "aria-level": i.const("2") }, function () { return e.controller.s("graphing-calculator-label-audio-trace-point") }), o.view(this, "next-point", { disabled: this.bindFn(this.isNextPointDisabled) })), i.createElement("div", { class: i.const("dcg-key-nav-section") }, o.view(this, "previous-poi", { disabled: this.bindFn(this.isPrevPOIDisabled) }), i.createElement("div", { class: i.const("dcg-key-nav-section-title-container dcg-poi-section-container"), role: i.const("heading"), "aria-level": i.const("2") }, i.createElement(l.Localize, { i18n: this.const(this.controller), key: this.const("graphing-calculator-heading-keypad-audio-trace-point-of-interest") }, i.createElement("span", { class: i.const("dcg-key-nav-section-value") }, i.const("Point")), i.createElement("span", { class: i.const("dcg-key-nav-section-title") }, i.const("of Interest")))), o.view(this, "next-poi", { disabled: this.bindFn(this.isNextPOIDisabled) })), i.createElement("div", { class: i.const("dcg-key-nav-section dcg-center-col") }, o.view(this, "previous-curve", { disabled: this.bindFn(this.isPrevCurveDisabled) }), i.createElement("div", { class: i.const("dcg-key-nav-section-title-container"), role: i.const("heading"), "aria-level": i.const("2") }, function () { return e.controller.s("graphing-calculator-label-audio-trace-curve") }), o.view(this, "next-curve", { disabled: this.bindFn(this.isNextCurveDisabled) }))), i.createElement("div", { class: i.const("dcg-audio-keypad-spacer") }), i.createElement("div", { class: i.const("dcg-audio-keypad-column dcg-screenreader-options") }, i.createElement("span", { class: i.const("dcg-key-section-title"), role: i.const("heading"), "aria-level": i.const("2") }, function () { return e.layoutWidth() <= 460 ? e.controller.s("graphing-calculator-heading-audio-trace-describe") : e.controller.s("graphing-calculator-heading-audio-trace-screen-reader") }, i.createElement(s.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-audio-trace-need-screen-reader") }, gravity: this.const("s"), sticky: this.const(!0) }, i.createElement("i", { class: i.const("dcg-icon-question-sign"), "aria-hidden": i.const("true") }))), i.createElement(c.default, { command: i.const("describe-point"), colspan: this.const(1), style: this.const("default"), onTap: function () { e.dispatch({ type: "keypad/audio-trace", command: "describe-point" }) } }, i.createElement("span", null, function () { return e.layoutWidth() <= 460 ? e.controller.s("graphing-calculator-button-audio-trace-describe-point-short") : e.controller.s("graphing-calculator-button-audio-trace-describe-point") })), i.createElement(c.default, { command: i.const("describe-curve"), colspan: this.const(1), style: this.const("default"), onTap: function () { e.dispatch({ type: "keypad/audio-trace", command: "describe-curve" }) } }, i.createElement("span", null, function () { return e.layoutWidth() <= 460 ? e.controller.s("graphing-calculator-button-audio-trace-describe-curve-short") : e.controller.s("graphing-calculator-button-audio-trace-describe-curve") })), i.createElement(u, { predicate: function () { return e.controller.getCanShowKeyboardShortcuts() } }, function () { return i.createElement("div", { class: i.const("dcg-keypad-btn-container dcg-keypad-link") }, i.createElement("a", { class: i.const("dcg-shared-dark-gray-link"), role: i.const("link"), "dcg-command": i.const("keyboard-shortcuts"), onTap: function () { e.dispatch({ type: "keypad/audio-trace", command: "keyboard-shortcuts" }) } }, i.createElement("i", { class: i.const("dcg-icon-keyboard"), "aria-hidden": i.const("true") }), i.createElement("span", null, function () { return e.layoutWidth() <= 700 ? e.controller.s("graphing-calculator-link-audio-trace-shortcuts") : e.controller.s("graphing-calculator-link-audio-trace-keyboard-shortcuts") }))) })))) }, n.prototype.layoutWidth = function () { return this.controller.getLayoutMeasurements().width }, n.prototype.isPrevPointDisabled = function () { var e = this.controller.getAudioGraph(); return !e || !e.agNavigator.canMoveToPrevPoint() }, n.prototype.isNextPointDisabled = function () { var e = this.controller.getAudioGraph(); return !e || !e.agNavigator.canMoveToNextPoint() }, n.prototype.isPrevPOIDisabled = function () { var e = this.controller.getAudioGraph(); return !e || !e.agNavigator.canMoveToPrevPOI() }, n.prototype.isNextPOIDisabled = function () { var e = this.controller.getAudioGraph(); return !e || !e.agNavigator.canMoveToNextPOI() }, n.prototype.isPrevCurveDisabled = function () { var e = this.controller.getAudioGraph(); return !e || !e.agNavigator.canMoveToPrevCurve() }, n.prototype.isNextCurveDisabled = function () { var e = this.controller.getAudioGraph(); return !e || !e.agNavigator.canMoveToNextCurve() }, n.prototype.isAudioDisabled = function () { return !this.controller.getAudio() }, n.prototype.getAudioTraceVolume = function () { var e = this.controller.getAudioGraph(); return !e || this.isAudioDisabled() ? "0%" : 100 * e.tonegen.getAudioVolume() + "%" }, n.prototype.isVolumeDownDisabled = function () { var e = this.controller.getAudioGraph(); return !(e && !this.isAudioDisabled()) || e.tonegen.getAudioVolume() <= 0 }, n.prototype.isVolumeUpDisabled = function () { var e = this.controller.getAudioGraph(); return !(e && !this.isAudioDisabled()) || e.tonegen.getAudioVolume() >= 1 }, n.prototype.getAudioTraceSpeed = function () { var e = this.controller.getAudioGraph(); return !e || this.isAudioDisabled() ? "0" : r.audioSpeedOptions[e.getAudioSpeedIndex()].displayedSpeed }, n.prototype.isSpeedDownDisabled = function () { var e = this.controller.getAudioGraph(); return !(e && !this.isAudioDisabled()) || e.getAudioSpeedIndex() <= 0 }, n.prototype.isSpeedUpDisabled = function () { var e = this.controller.getAudioGraph(); return !(e && !this.isAudioDisabled()) || e.getAudioSpeedIndex() === r.audioSpeedOptions.length - 1 }, n.prototype.getDisabledTooltipText = function () { return this.isAudioDisabled() ? this.controller.s("graphing-calculator-narration-audio-trace-sound-effects-disabled") : "" }, n }(n.default); e.default = g });

define('loadcss!graphing-calc/keypads/functions-popover', function () { });
define('graphing-calc/keypads/functions-popover', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "keypad/keys", "loadcss!./functions-popover"], function (require, t, e, i, n, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var o = i.Components, s = o.If, c = o.For, a = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.template = function () { var t = this; return i.createElement("div", { class: i.const("dcg-functions-popover dcg-popover dcg-top") }, i.createElement("div", { class: i.const("dcg-popover-interior") }, i.createElement("div", { class: i.const("dcg-interior-buttons") }, i.createElement(c, { each: this.bindFn(this.getKeypadKeys), key: function (t) { return t.id } }, i.createElement("div", { class: i.const("dcg-basic-keypad dcg-do-not-blur") }, function (e) { return i.createElement("div", { class: i.const("dcg-keypad-keys-section") }, i.createElement(s, { predicate: function () { return void 0 !== e.title } }, function () { return i.createElement("div", { class: i.const("dcg-section-heading") }, function () { return e.title }, i.createElement(s, { predicate: function () { return !!e.helpLink } }, function () { return i.createElement("a", { href: function () { return e.helpLink.url }, target: i.const("_blank"), "aria-label": function () { return e.helpLink.tooltip } }, i.createElement("i", { class: i.const("dcg-icon-question-sign"), "aria-hidden": i.const("true") })) })) }), i.createElement(s, { predicate: function () { return void 0 === e.title } }, function () { return i.createElement("div", { class: i.const("dcg-popover-section-separator") }) }), i.createElement(c, { each: function () { return e.keys } }, i.createElement("div", { class: i.const("dcg-keypad-keys-buttons") }, function (e) { return t.b(e) }))) })))), i.createElement("div", { class: i.const("dcg-arrow") })) }, n.prototype.getInverseTrigSection = function () { var t = this.controller.areFunctionsRestricted() ? ["arcsin", "arccos", "arctan"] : ["arcsin", "arccos", "arctan", "arccsc", "arcsec", "arccot"]; return { id: "inversetrig", title: this.controller.s("graphing-calculator-heading-inverse-trig"), keys: t } }, n.prototype.getGeometryMethods = function () { var t = !this.controller.areFunctionsRestricted() || this.controller.areGeometryFunctionsForceEnabled() ? ["polygon", "distance", "midpoint"] : ["polygon"]; return { id: "geometry", title: this.controller.s("graphing-calculator-heading-geometry"), keys: t } }, n.prototype.getTrigSection = function () { var t = this.controller.areFunctionsRestricted() ? ["sin", "cos", "tan"] : ["sin", "cos", "tan", "csc", "sec", "cot"]; return { id: "trig", title: this.controller.s("graphing-calculator-heading-trig"), keys: t } }, n.prototype.getHyperbolicTrigSection = function () { var t = this.controller.areFunctionsRestricted() ? ["sinh", "cosh", "tanh"] : ["sinh", "cosh", "tanh", "csch", "sech", "coth"]; return { id: "hyperbtrig", title: this.controller.s("graphing-calculator-heading-hyperbolic-trig"), keys: t } }, n.prototype.getListFunctions = function () { return { id: "lists", title: this.controller.s("graphing-calculator-heading-lists"), keys: ["join", "sort", "shuffle", "unique", "for"] } }, n.prototype.getStatTests = function () { return { id: "stat-tests", title: this.controller.s("graphing-calculator-heading-stat-tests"), keys: ["ttest", "tscore", "ittest"] } }, n.prototype.getStatsSection = function () { var t = ["mean", "median", "min", "max", "quartile", "quantile", "stdev", "stdevp", "var"]; return this.controller.areFunctionsRestricted() || (t = t.concat(["mad", "cov", "covp"])), t = t.concat(["corr", "spearman", "stats", "length", "total"]), { id: "stats", title: this.controller.s("graphing-calculator-heading-stats"), keys: t } }, n.prototype.getMiscSection = function () { return { title: this.controller.s("graphing-calculator-button-functions-menu-number-theory"), id: "misc", keys: ["lcm", "gcd", "mod", "ceil", "floor", "round", "sign", "nthroot", "nPr", "nCr"] } }, n.prototype.getVisualizationsSection = function () { return { title: this.controller.s("graphing-calculator-heading-dist-tab-visualizations"), id: "visualizations", keys: ["histogram", "dotplot", "boxplot"], helpLink: { url: "https://help.desmos.com/hc/en-us/articles/360022405991-Data-Visualizations", tooltip: this.controller.s("graphing-calculator-narration-dist-tab-visualizations") } } }, n.prototype.getCalculusSection = function () { return { title: this.controller.s("graphing-calculator-heading-calculus"), id: "calculus", keys: ["exp", "ln", "log", "loga", "ddx", "prime", "int", "sum", "prod"] } }, n.prototype.getDistributionsSection = function () { return { title: this.controller.s("graphing-calculator-heading-dist-tab-distributions"), id: "distributions", keys: ["normaldist", "tdist", "poissondist", "binomialdist", "uniformdist", "pdf", "cdf", "inversecdf", "random"], helpLink: { url: "https://help.desmos.com/hc/en-us/articles/360022401451-Distributions", tooltip: this.controller.s("graphing-calculator-narration-dist-tab-distributions") } } }, n.prototype.getKeypadKeys = function () { var t = [this.getTrigSection(), this.getInverseTrigSection(), this.getStatsSection(), this.getListFunctions(), this.getVisualizationsSection()]; return this.controller.areDistributionsEnabled() && (t.push(this.getDistributionsSection()), t.push(this.getStatTests())), t.push(this.getCalculusSection()), t.push(this.getHyperbolicTrigSection()), t.push(this.getGeometryMethods()), t.push(this.getMiscSection()), t }, n.prototype.b = function (t) { return r.view(this, t, { style: "popover" }) }, n }(n.default); t.default = a });

define('loadcss!graphing-calc/keypads/graphing-keypad-container', function () { });
define('graphing-calc/keypads/main', ["require", "exports", "tslib", "dcgview", "./dcgview-graphing", "./qwerty", "./qwerty-capital", "./numbers", "./letters", "./letters-capital", "./audio", "./functions-popover", "jquery", "underscore", "../../shared-components/tooltip", "loadcss!./graphing-keypad-container"], function (require, t, e, o, n, r, i, l, c, a, s, d, u, p, h) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var f = o.Components, y = f.SwitchUnion, g = f.If, m = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.template = function () { var t = this; return o.createElement("div", { class: o.const("dcg-keypad"), role: o.const("complementary"), "aria-label": o.const("Keypad") }, o.createElement("div", { class: function () { return { "dcg-keys-container": !0, "dcg-smaller-functions-text": t.controller.getLayoutMeasurements().width < 650, "dcg-small-ABC": t.controller.getLayoutMeasurements().width < 490, "dcg-smaller-ABC": t.controller.getLayoutMeasurements().width < 420, "dcg-smallest-ABC": t.controller.getLayoutMeasurements().width < 380 } }, style: this.bindFn(this.computeStyles), didMount: this.bindFn(this.didMountContainer), "aria-hidden": function () { return !t.controller.isKeypadOpen() } }, o.createElement("div", { class: o.const("dcg-keys-background dcg-do-not-blur"), style: function () { return { background: t.controller.getPillboxBackgroundColor() } } }, o.createElement("div", { class: o.const("dcg-keys") }, y(function () { return t.controller.getKeypadLayout() }, { letters: function () { return o.createElement(r.default, { controller: t.props.controller }) }, capitalLetters: function () { return o.createElement(i.default, { controller: t.props.controller }) }, mainNumbers: function () { return o.createElement(l.default, { controller: t.props.controller }) }, noQwertyLetters: function () { return o.createElement(c.default, { controller: t.props.controller }) }, noQwertyCapitalLetters: function () { return o.createElement(a.default, { controller: t.props.controller }) }, audio: function () { return o.createElement(s.default, { controller: t.props.controller }) } }), o.createElement(g, { predicate: function () { return t.controller.isKeypadFunctionsPopoverOpen() } }, function () { return o.createElement(d.default, { controller: t.props.controller }) })), o.createElement(g, { predicate: this.bindFn(this.isHideKeypadButtonVisible) }, function () { return o.createElement("div", { class: o.const("dcg-minimize-keypad-container") }, o.createElement(h.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-hide-keypad") }, gravity: t.const("ne"), offset: t.const({ left: 6 }) }, o.createElement("div", { role: o.const("button"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-hide-keypad") }, class: o.const("dcg-minimize-keypad"), style: function () { return { "border-bottom-color": t.controller.getPillboxBackgroundColor(), background: t.controller.getPillboxBackgroundColor() } }, onTap: function () { t.controller.dispatch({ type: "keypad/set-minimized", minimized: !0 }) } }, o.createElement("i", { class: o.const("dcg-icon-keyboard"), "aria-hidden": o.const("true") }), o.createElement("i", { class: o.const("dcg-icon-caret-down"), "aria-hidden": o.const("true") })))) }))), o.createElement(g, { predicate: this.bindFn(this.isShowKeypadButtonVisible) }, function () { return o.createElement("div", { class: o.const("dcg-show-keypad-container") }, o.createElement(h.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-show-keypad") }, gravity: t.const("ne") }, o.createElement("div", { role: o.const("button"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-show-keypad") }, class: o.const("dcg-btn-flat-gray dcg-show-keypad dcg-do-not-blur"), style: function () { return { background: t.controller.getPillboxBackgroundColor() } }, onTap: function () { t.controller.dispatch({ type: "keypad/set-minimized", minimized: !1 }) } }, o.createElement("i", { class: o.const("dcg-icon-keyboard"), "aria-hidden": o.const("true") }), o.createElement("i", { class: o.const("dcg-icon-caret-up dcg-do-not-blur"), "aria-hidden": o.const("true") })))) })) }, n.prototype.didMountContainer = function (t) { this.containerElt = t }, n.prototype.isShowKeypadButtonVisible = function () { return "none" === this.controller.getBrailleMode() && (!this.controller.isKeypadOpen() && !this.controller.isNarrow() && !this.controller.isInEditListMode() && (this.controller.isListVisible() || this.controller.inAudioTraceMode())) }, n.prototype.isHideKeypadButtonVisible = function () { return "none" === this.controller.getBrailleMode() && this.controller.isKeypadOpen() && (!this.controller.isNarrow() || this.controller.inAudioTraceMode()) }, n.prototype.didMount = function () { this.updatePopoverPosition() }, n.prototype.didUpdate = function () { this.updatePopoverPosition() }, n.prototype.computeStyles = function () { var t = {}; return this.controller.isNarrow() || (t.transition = "transform .3s, opacity .3s"), this.controller.isKeypadOpen() || (t.opacity = "0", t.transform = "translate3d(0, 255px, 0)"), t }, n.prototype.updatePopoverPosition = function () { if (this.controller.isKeypadFunctionsPopoverOpen()) { var t = this.controller.computeMajorLayout(), e = { keypadTop: t.keypad.top, keypadWidth: t.keypad.width, keypadHeight: t.keypad.height, showToLeft: t.grapher.height < 525 }; if (!p.isEqual(e, this.__popoverCache)) { this.__popoverCache = e; var o = u(this.containerElt), n = o.find("[dcg-command=functions]"), r = o.find(".dcg-functions-popover"), i = o.find(".dcg-arrow"); if (e.showToLeft) { r.removeClass("dcg-top").addClass("dcg-left"); var l = e.keypadHeight - (n.offset().top - o.offset().top) - n.outerHeight() / 2 - 2 - 10; i.css({ left: "auto", bottom: l }) } else r.removeClass("dcg-left").addClass("dcg-top"), i.css({ left: r.width() - n.width() / 2, bottom: "auto" }) } } else this.__popoverCache = void 0 }, n }(n.default); t.default = m });

define('loadcss!pillboxes', function () { });
define('main/graphpaper-branding-view', ["require", "exports", "tslib", "dcgview", "loadcss!pillboxes"], function (require, e, n, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = t.Components.SwitchUnion, c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return n.__extends(c, e), c.prototype.template = function () { var e = this; return this.controller = this.props.controller(), r(function () { return e.controller.getBrandingMode() }, { "static-edit-link": function () { return t.createElement("div", { class: t.const("dcg-graphpaper-branding") }, t.createElement("a", { href: function () { return e.controller.getEditLink() }, target: t.const("_blank") }, t.createElement("span", { class: t.const("dcg-powered-by"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-edit-on-desmos") } }, function () { return e.controller.s("graphing-calculator-link-edit-on-desmos") }), t.createElement("i", { class: t.const("dcg-icon-desmos"), "aria-hidden": t.const("true") }))) }, "edit-link": function () { return t.createElement("div", { class: t.const("dcg-graphpaper-branding") }, t.createElement("span", { class: t.const("dcg-edit-branding"), onTap: function () { return e.controller.dispatch({ type: "open-on-web" }) } }, t.createElement("span", { class: t.const("dcg-powered-by"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-edit-on-desmos") } }, function () { return e.controller.s("graphing-calculator-link-edit-on-desmos") }), t.createElement("i", { class: t.const("dcg-icon-desmos"), "aria-hidden": t.const("true") }))) }, "powered-by": function () { return t.createElement("div", { class: t.const("dcg-graphpaper-branding dcg-unclickable") }, t.createElement("span", { class: t.const("dcg-powered-by"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-powered-by-desmos") } }, function () { return e.controller.s("graphing-calculator-label-powered-by") }), t.createElement("i", { class: t.const("dcg-icon-desmos"), "aria-hidden": t.const("true") })) } }) }, c }(t.Class); e.default = c });

define('loadcss!dcgview-helpers/learn-more-link', function () { });
define('dcgview-helpers/learn-more-link', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip", "loadcss!./learn-more-link"], function (require, e, t, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LearnMoreLink = void 0; var o = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement(r.Tooltip, { tooltip: function () { return e.props.controller().s("shared-calculator-label-toast-learn-more") } }, n.createElement("a", { class: n.const("dcg-learn-more-link"), href: this.props.href, target: n.const("_blank") }, n.createElement("i", { class: n.const("dcg-icon-question-sign"), "aria-hidden": n.const("true") }))) }, o }(n.Class); e.LearnMoreLink = o });

define('loadcss!main/settings-view', function () { });
define('main/settings-view', ["require", "exports", "tslib", "keys", "scroll_helpers", "dcgview", "dcgview-helpers/static-mathquill-view", "dcgview-helpers/mathquill-view", "jquery", "core/graphing-calc/json/graph-settings", "core/math/evaluate-single-expression", "graphing/viewport", "dcgview-helpers/checkbox", "main/manage-focus-helper", "main/mathquill-operators", "../shared-components/mathquill-braille-wrapper", "../expressions/expression_view", "../shared-components/tooltip", "../dcgview-helpers/learn-more-link", "loadcss!./settings-view"], function (require, e, t, n, r, o, i, s, c, a, l, g, d, u, p, h, m, b, f) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var x = o.Components, y = x.Input, v = x.If, E = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { var e = this; return o.createElement(h.default, t.__assign({ latex: function () { return e.props.parent().getLimitLatex(e.props.limit()) }, ariaLabel: function () { return e.props.ariaLabel() }, onBrailleInput: function (t) { return e.props.parent().setLimitLatex(e.props.limit(), t) }, onBrailleFocusedChanged: function (t) { return e.props.parent().onFocusedChanged(e.props.limit(), t) }, brailleShouldFocus: function () { return e.props.parent().getFocusedLimit() === e.props.limit() }, hasError: function () { return e.props.parent().isLimitInvalid(e.props.limit()) }, dataDCGLimit: function () { return e.props.limit() } }, m.getBrailleWrapperProps(this.props.controller()), { capExpressionSize: function () { } }), o.createElement(s.default, { isFocused: function () { return e.props.parent().getFocusedLimit() === e.props.limit() }, latex: function () { return e.props.parent().getLimitLatex(e.props.limit()) }, capExpressionSize: function () { return e.props.parent().getCapExpressionSize() }, config: this.bindFn(this.getMQConfig), getAriaLabel: function () { return e.props.ariaLabel() }, getAriaPostLabel: this.const(""), onUserChangedLatex: function (t) { return e.props.parent().setLimitLatex(e.props.limit(), t) }, onFocusedChanged: function (t) { return e.props.parent().onFocusedChanged(e.props.limit(), t) }, hasError: this.const(!1), selectOnFocus: this.const(!0), needsSystemKeypad: function () { return e.props.needsSystemKeypad() } }, o.createElement("span", { class: function () { return { "dcg-math-field": !0, "dcg-math-input": !0, "dcg-invalid": e.props.parent().isLimitInvalid(e.props.limit()), "dcg-focus": e.props.parent().getFocusedLimit() === e.props.limit() } }, "data-dcg-limit": function () { return e.props.limit() } }))) }, n.prototype.getMQConfig = function () { return { autoOperatorNames: p.getAutoOperators() } }, n }(o.Class), A = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.template = function () { var e = this; return this.controller = this.props.controller(), o.createElement("div", { class: o.const("dcg-settings-view-container") }, o.createElement(b.Tooltip, { tooltip: function () { return e.controller.s("graphing-calculator-label-tooltip-graph-settings") }, gravity: this.const("w") }, o.createElement("div", { class: o.const("dcg-btn-flat-gray dcg-settings-pillbox dcg-action-settings"), role: o.const("button"), tabindex: o.const("0"), "aria-haspopup": o.const("true"), "aria-expanded": function () { return e.controller.isGraphSettingsOpen() }, "aria-label": function () { return e.controller.s("graphing-calculator-label-tooltip-graph-settings") }, onTap: this.bindFn(this.onTapSettingsButton), manageFocus: this.const(u.manageFocusHelper({ controller: this.controller, location: { type: "settings", location: "icon" } })), style: function () { return { background: e.controller.getPillboxBackgroundColor() } } }, o.createElement("i", { class: o.const("dcg-icon-wrench"), "aria-hidden": o.const("true") }), o.createElement(v, { predicate: function () { return e.controller.getLockViewportUserSetting() } }, function () { return o.createElement("i", { class: o.const("dcg-icon-lock"), "aria-hidden": o.const("true") }) }))), o.createElement(v, { predicate: function () { return e.controller.isGraphSettingsOpen() } }, function () { return o.createElement("div", { class: o.const("dcg-settings-container dcg-left dcg-popover dcg-constrained-height-popover"), style: e.bindFn(e.getContainerStyle), didMount: e.bindFn(e.didMountContainer), didUnmount: e.bindFn(e.didUnmountContainer) }, o.createElement("div", { class: o.const("dcg-popover-interior"), role: o.const("complementary"), "aria-label": o.const("Graph Settings") }, o.createElement("div", { class: o.const("dcg-visual-settings") }, o.createElement("div", { class: o.const("dcg-group-title") }, function () { return e.controller.s("shared-calculator-label-settings-display") }), o.createElement("div", { class: o.const("dcg-displaysizegroup dcg-segmented-control-container"), role: o.const("group"), "aria-label": function () { return e.controller.s("shared-calculator-narration-settings-display-size") } }, o.createElement("div", { class: function () { return { "dcg-action-displaysizedefault": !0, "dcg-segmented-control-btn": !0, "dcg-selected dcg-active": !e.getProjectorMode() } }, "aria-pressed": function () { return !e.getProjectorMode() }, role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("shared-calculator-narration-settings-display-size-default") }, onTap: e.bindFn(e.setDefaultDisplaySize) }, o.const("A")), o.createElement("div", { class: function () { return { "dcg-action-displaysizelarge": !0, "dcg-segmented-control-btn": !0, "dcg-selected dcg-active": e.getProjectorMode() } }, "aria-pressed": e.bindFn(e.getProjectorMode), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("shared-calculator-narration-settings-display-size-large") }, onTap: e.bindFn(e.setLargeDisplaySize), manageFocus: e.const(u.manageFocusHelper({ controller: e.controller, location: { type: "settings", location: "projector-mode" } })) }, o.const("A"))), o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-reverse-contrast") }, onChange: e.bindFn(e.toggleInvertedColors), checked: function () { return e.controller.getInvertedColors() } }, function () { return e.controller.s("graphing-calculator-label-settings-reverse-contrast") }), o.createElement(v, { predicate: function () { return e.controller.getBrailleControls() } }, function () { return o.createElement("div", { class: o.const("dcg-braille-container dcg-braille-mode") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-braille-mode") }, onChange: e.bindFn(e.toggleBrailleMode), checked: function () { return "none" !== e.controller.getBrailleMode() } }, function () { return e.controller.s("graphing-calculator-label-settings-braille-mode") }), o.createElement(v, { predicate: function () { return "none" !== e.controller.getBrailleMode() } }, function () { return o.createElement("div", { class: o.const("dcg-braille-options-container") }, o.createElement("div", { role: o.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-label-settings-braille-mode") }, class: o.const("dcg-braille-options-buttons dcg-segmented-control-container") }, o.createElement("span", { class: function () { return { "dcg-segmented-control-btn": !0, "dcg-braille-option": !0, "dcg-selected dcg-active": "nemeth" === e.controller.getBrailleMode() } }, role: o.const("button"), onTap: function () { return e.controller.dispatch({ type: "set-braille-mode", mode: "nemeth" }) }, tabindex: o.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-button-settings-braille-mode-nemeth") }, "aria-pressed": function () { return "nemeth" === e.controller.getBrailleMode() } }, function () { return e.controller.s("graphing-calculator-button-settings-braille-mode-nemeth") }), o.createElement("span", { class: function () { return { "dcg-segmented-control-btn": !0, "dcg-braille-option": !0, "dcg-selected dcg-active": "ueb" === e.controller.getBrailleMode() } }, role: o.const("button"), onTap: function () { return e.controller.dispatch({ type: "set-braille-mode", mode: "ueb" }) }, tabindex: o.const(0), "aria-label": function () { return e.controller.s("graphing-calculator-button-settings-braille-mode-ueb") }, "aria-pressed": function () { return "ueb" === e.controller.getBrailleMode() } }, function () { return e.controller.s("graphing-calculator-button-settings-braille-mode-ueb") })), o.createElement("div", { class: o.const("dcg-checkbox-title dcg-six-key-checkbox") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-six-key-braille") }, onChange: function (t) { return e.controller.dispatch({ type: "set-six-key-input", useSixKeyInput: t }) }, checked: function () { return e.controller.getSixKeyInput() } }, function () { return e.controller.s("graphing-calculator-label-settings-six-key-braille") }), o.createElement("a", { href: o.const("https://www.desmos.com/accessibility#braille"), class: o.const("dcg-six-key-info"), target: o.const("_blank") }, o.createElement("i", { class: o.const("dcg-icon-question-sign"), "aria-hidden": o.const("true") }))), o.createElement("div", { class: o.const("dcg-refreshable-braille-note") }, function () { return e.controller.s("graphing-calculator-text-refreshable-braille-display-note") + " " }, o.createElement("a", { href: function () { return "https://www.desmos.com/braille-examples?" + e.controller.getBrailleMode() }, target: o.const("_blank") }, function () { return e.controller.s("graphing-calculator-link-view-braille-examples") }))) })) })), o.createElement("div", { class: o.const("dcg-top-section-flex dcg-grid-settings-container") }, o.createElement("div", { class: o.const("dcg-grid-settings") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-grid") }, onChange: e.bindFn(e.toggleGrid), checked: e.bindFn(e.getShowGrid) }, function () { return e.controller.s("graphing-calculator-label-settings-grid") }), o.createElement(v, { predicate: e.bindFn(e.getShowGrid) }, function () { return o.createElement("div", { class: o.const("dcg-circle-icon-group dcg-grid-group") }, o.createElement("div", { class: function () { return { "dcg-circle-icon": !0, "dcg-action-cartesian": !0, "dcg-active": !e.getPolarMode() } }, role: o.const("button"), tabindex: o.const("0"), "aria-pressed": function () { return !e.getPolarMode() }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-cartesian-grid") }, onTap: e.bindFn(e.setCartesianMode) }), o.const("Â "), o.createElement("div", { class: function () { return { "dcg-circle-icon": !0, "dcg-action-polar": !0, "dcg-active": e.getPolarMode() } }, role: o.const("button"), tabindex: o.const("0"), "aria-pressed": function () { return e.getPolarMode() }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-polar-grid") }, onTap: e.bindFn(e.setPolarMode) })) }), o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-arrows") }, onChange: e.bindFn(e.toggleArrows), checked: function () { return e.getAxisArrowMode() !== a.AxisArrowModes.NONE } }, function () { return e.controller.s("graphing-calculator-label-settings-arrows") }), o.createElement(v, { predicate: function () { return e.getAxisArrowMode() !== a.AxisArrowModes.NONE } }, function () { return o.createElement("div", { class: o.const("dcg-circle-icon-group dcg-arrow-group") }, o.createElement("div", { role: o.const("button"), tabindex: o.const("0"), class: function () { return { "dcg-circle-icon": !0, "dcg-arrows": !0, "dcg-active": e.getAxisArrowMode() === a.AxisArrowModes.BOTH } }, "dcg-arrows": o.const("BOTH"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-show-both") }, "aria-pressed": function () { return e.getAxisArrowMode() === a.AxisArrowModes.BOTH }, onTap: function () { return e.setAxisArrowMode(a.AxisArrowModes.BOTH) } }, o.createElement("i", { class: o.const("dcg-icon-arrows-two"), "aria-hidden": o.const("true") })), o.const("Â "), o.createElement("div", { role: o.const("button"), tabindex: o.const("0"), class: function () { return { "dcg-circle-icon": !0, "dcg-arrows": !0, "dcg-active": e.getAxisArrowMode() === a.AxisArrowModes.POSITIVE } }, "dcg-arrows": o.const("POSITIVE"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-show-positive") }, "aria-pressed": function () { return e.getAxisArrowMode() === a.AxisArrowModes.POSITIVE }, onTap: function () { return e.setAxisArrowMode(a.AxisArrowModes.POSITIVE) } }, o.createElement("i", { class: o.const("dcg-icon-arrows-one"), "aria-hidden": o.const("true") }))) })), o.createElement("div", { class: o.const("dcg-top-checkboxes-container") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-axis-numbers") }, onChange: e.bindFn(e.toggleAxisNumbers), checked: e.bindFn(e.getAxisNumbers), small: e.const(!0) }, function () { return e.controller.s("graphing-calculator-label-settings-axis-numbers") }), o.createElement(v, { predicate: function () { return e.getShowGrid() && !e.getPolarMode() } }, function () { return o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-minor-gridlines") }, onChange: e.bindFn(e.toggleMinorGridlines), checked: e.bindFn(e.getMinorGridlines), small: e.const(!0) }, function () { return e.controller.s("graphing-calculator-label-settings-minor-gridlines") }) }), o.createElement(v, { predicate: function () { return e.controller.canUseAdvancedStyling() && !e.getPolarMode() } }, function () { return o.createElement(d.Checkbox, { checked: function () { return e.controller.getGraphSettings().restrictGridToFirstQuadrant }, ariaLabel: e.const("One Quadrant"), onChange: function (t) { return e.controller.dispatch({ type: "set-graph-settings", restrictGridToFirstQuadrant: t }) }, small: e.const(!0) }, o.const("One Quadrant")) }), o.createElement(v, { predicate: function () { return !e.getSquareAxes() } }, function () { return o.createElement("div", { role: o.const("button"), tabindex: o.const("0"), class: o.const("dcg-action-zoom-square dcg-btn-light-gray"), onTap: e.bindFn(e.zoomSquare) }, function () { return e.controller.s("graphing-calculator-button-settings-zoom-square") }) }))), o.createElement("div", { class: o.const("dcg-axes-settings-container") }, o.createElement("div", { class: o.const("dcg-checkbox-title dcg-x-axis-title") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-x-axis") }, onChange: e.bindFn(e.toggleXAxis), checked: e.bindFn(e.getShowXAxis) }, function () { return e.controller.s("graphing-calculator-label-settings-x-axis") }), o.createElement(y, { class: e.const("dcg-axis-label dcg-x-axis-label"), placeholder: function () { return e.controller.s("graphing-calculator-label-settings-add-label") }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-x-axis-label") }, disabled: function () { return !e.getShowXAxis() || void 0 }, "aria-disabled": function () { return !e.getShowXAxis() || void 0 }, onInput: e.bindFn(e.onXAxisLabelInput), value: e.bindFn(e.getXAxisLabel) })), o.createElement("div", { class: o.const("dcg-editable-mathquill-container dcg-x-axis-options") }, o.createElement(E, { limit: e.const("xmin"), ariaLabel: function () { return e.controller.s("graphing-calculator-narration-settings-x-axis-min") }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() }, parent: e.const(e), controller: e.props.controller }), o.createElement(i.default, { config: e.const({}), latex: e.const("\\le x\\le") }, o.createElement("span", { class: o.const("dcg-interval-interior") })), o.createElement(E, { limit: e.const("xmax"), ariaLabel: function () { return e.controller.s("graphing-calculator-narration-settings-x-axis-max") }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() }, parent: e.const(e), controller: e.props.controller }), o.createElement(v, { predicate: function () { return !e.getPolarMode() } }, function () { return o.createElement("span", { class: o.const("dcg-step-container") }, o.createElement("span", { class: o.const("dcg-step-label"), "aria-hidden": o.const("true") }, function () { return e.controller.s("graphing-calculator-label-settings-step") }), o.createElement(E, { limit: e.const("xstep"), ariaLabel: function () { return e.controller.s("graphing-calculator-narration-settings-x-axis-step") }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() }, parent: e.const(e), controller: e.props.controller })) })), o.createElement("div", { class: o.const("dcg-checkbox-title dcg-y-axis-title") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-y-axis") }, onChange: e.bindFn(e.toggleYAxis), checked: e.bindFn(e.getShowYAxis) }, function () { return e.controller.s("graphing-calculator-label-settings-y-axis") }), o.createElement(y, { class: e.const("dcg-axis-label dcg-y-axis-label"), placeholder: function () { return e.controller.s("graphing-calculator-label-settings-add-label") }, "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-y-axis-label") }, disabled: function () { return !e.getShowYAxis() || void 0 }, "aria-disabled": function () { return !e.getShowYAxis() || void 0 }, onInput: e.bindFn(e.onYAxisLabelInput), value: e.bindFn(e.getYAxisLabel) })), o.createElement("div", { class: o.const("dcg-editable-mathquill-container dcg-y-axis-options") }, o.createElement(E, { limit: e.const("ymin"), ariaLabel: function () { return e.controller.s("graphing-calculator-narration-settings-y-axis-min") }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() }, parent: e.const(e), controller: e.props.controller }), o.createElement(i.default, { config: e.const({}), latex: e.const("\\le y\\le") }, o.createElement("span", { class: o.const("dcg-interval-interior") })), o.createElement(E, { limit: e.const("ymax"), ariaLabel: function () { return e.controller.s("graphing-calculator-narration-settings-y-axis-max") }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() }, parent: e.const(e), controller: e.props.controller }), o.createElement(v, { predicate: function () { return !e.getPolarMode() } }, function () { return o.createElement("span", { class: o.const("dcg-step-container") }, o.createElement("span", { class: o.const("dcg-step-label"), "aria-hidden": o.const("true") }, function () { return e.controller.s("graphing-calculator-label-settings-step") }), o.createElement(E, { limit: e.const("ystep"), ariaLabel: function () { return e.controller.s("graphing-calculator-narration-settings-y-axis-step") }, needsSystemKeypad: function () { return !e.controller.isKeypadEnabled() }, parent: e.const(e), controller: e.props.controller })) })), o.createElement(v, { predicate: function () { return !e.controller.getLockViewportConfigSetting() } }, function () { return o.createElement("div", { class: o.const("dcg-checkbox-title dcg-lock-viewport-option") }, o.createElement(d.Checkbox, { ariaLabel: function () { return e.controller.s("graphing-calculator-label-settings-lock-viewport") }, onChange: function () { e.controller.dispatch({ type: "toggle-lock-viewport" }) }, checked: function () { return e.controller.getLockViewportUserSetting() } }, function () { return e.controller.s("graphing-calculator-label-settings-lock-viewport") }), o.createElement(f.LearnMoreLink, { href: e.const("https://help.desmos.com/hc/en-us/articles/4405296853517#h_01FZX4DBWKD83TZVMH615XF3QA"), controller: e.props.controller })) })), o.createElement("div", { class: o.const("dcg-radiangroup dcg-segmented-control-container"), role: o.const("group"), "aria-label": function () { return e.controller.s("graphing-calculator-narration-settings-angle") } }, o.createElement("div", { class: function () { return { "dcg-action-radianmode": !0, "dcg-segmented-control-btn": !0, "dcg-selected dcg-active": !e.getDegreeMode() } }, "aria-pressed": function () { return !e.getDegreeMode() }, role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-button-settings-radians") }, onTap: e.bindFn(e.setRadianMode) }, function () { return e.controller.s("graphing-calculator-button-settings-radians") }), o.createElement("div", { class: function () { return { "dcg-action-degreemode": !0, "dcg-segmented-control-btn": !0, "dcg-selected dcg-active": e.getDegreeMode() } }, "aria-pressed": e.bindFn(e.getDegreeMode), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return e.controller.s("graphing-calculator-button-settings-degrees") }, onTap: e.bindFn(e.setDegreeMode), manageFocus: e.const(u.manageFocusHelper({ controller: e.controller, location: { type: "settings", location: "degree-mode" } })) }, function () { return e.controller.s("graphing-calculator-button-settings-degrees") })), o.createElement("div", { class: o.const("dcg-arrow") }))) })) }, s.prototype.didMountContainer = function (e) { var t = this; this.node = e, c(document).on("dcg-tapstart.settings-view wheel.settings-view", function (e) { t.eventShouldClosePopover(e) && t.controller.dispatch({ type: "close-graph-settings", focusIconAfterClose: "keyboard" === e.device }) }), c(document).on("keydown.settings-view", function (e) { if ("Esc" === n.lookup(e) && t.controller.dispatch({ type: "close-graph-settings", focusIconAfterClose: !0 }), t.controller.isGraphSettingsOpen() && "Tab" === n.lookup(e) && !e.altKey && !e.metaKey && !e.ctrlKey) { var r = t.controller.getFocusLocation(); if (!r || "settings" !== r.type) return; e.shiftKey || "degree-mode" !== r.location ? e.shiftKey && "icon" === r.location && (t.controller.dispatch({ type: "set-focus-location", location: { type: "settings", location: "degree-mode" } }), e.preventDefault(), e.stopPropagation()) : (t.controller.dispatch({ type: "set-focus-location", location: { type: "settings", location: "icon" } }), e.preventDefault(), e.stopPropagation()) } }) }, s.prototype.didUnmountContainer = function () { c(document).off(".settings-view") }, s.prototype.didUpdate = function () { if (this.controller.isGraphSettingsOpen()) { var e = this.controller.getKeypadHeight(); e !== this.cachedKeypadHeight && document.activeElement && c(document.activeElement).closest(this.node).length && r.scrollVisible(c(document.activeElement), c(this.node).find(".dcg-popover-interior"), 50), this.cachedKeypadHeight = e } }, s.prototype.eventShouldClosePopover = function (e) { var t = c(e.target), n = !!t.closest(this.node).length, r = !!t.closest(".dcg-action-settings").length, o = this.isMathquillFocused() && t.closest(".dcg-keypad").length, i = !!t.closest(".dcg-action-undo").length || !!t.closest(".dcg-action-redo").length; return !(n || r || o || i) }, s.prototype.onTapSettingsButton = function (e) { this.controller.dispatch({ type: "toggle-graph-settings", focusOnOpen: "keyboard" === e.device }) }, s.prototype.isMathquillFocused = function () { return void 0 !== this.getFocusedLimit() }, s.prototype.getLimitLatex = function (e) { return this.controller.getSettingsViewModel().limitLatex[e] }, s.prototype.setLimitLatex = function (e, t) { t !== this.controller.getSettingsViewModel().limitLatex[e] && this.controller.dispatch({ type: "set-axis-limit-latex", limit: e, latex: t }) }, s.prototype.getFocusedLimit = function () { var e = this.controller.getFocusLocation(); if (e && "settings" === e.type) return e.location }, s.prototype.getInvalidLimits = function () { var e = !!this.controller.getGraphSettings().degreeMode, t = l.default(this.getLimitLatex("xmin"), e), n = l.default(this.getLimitLatex("xmax"), e), r = l.default(this.getLimitLatex("ymin"), e), o = l.default(this.getLimitLatex("ymax"), e), i = "" === this.getLimitLatex("xstep") ? 0 : l.default(this.getLimitLatex("xstep"), e), s = "" === this.getLimitLatex("ystep") ? 0 : l.default(this.getLimitLatex("ystep"), e), c = {}, a = new g.Viewport(t, n, r, o); return isFinite(t) && isFinite(n) ? (c.xmin = !a.isXValid(), c.xmax = c.xmin) : (c.xmin = !isFinite(t), c.xmax = !isFinite(n)), isFinite(r) && isFinite(o) ? (c.ymin = !a.isYValid(), c.ymax = c.ymin) : (c.ymin = !isFinite(r), c.ymax = !isFinite(o)), c.xstep = !isFinite(i) || i < 0, c.ystep = !isFinite(s) || s < 0, c }, s.prototype.isLimitInvalid = function (e) { return this.getInvalidLimits()[e] }, s.prototype.onFocusedChanged = function (e, t) { t ? this.controller.dispatch({ type: "set-focus-location", location: { type: "settings", location: e } }) : this.controller.dispatch({ type: "blur-focus-location", location: { type: "settings", location: e } }) }, s.prototype.onXAxisLabelInput = function (e) { this.controller.dispatch({ type: "set-graph-settings", xAxisLabel: e }) }, s.prototype.onYAxisLabelInput = function (e) { this.controller.dispatch({ type: "set-graph-settings", yAxisLabel: e }) }, s.prototype.getXAxisLabel = function () { return this.controller.getGraphSettings().xAxisLabel }, s.prototype.getYAxisLabel = function () { return this.controller.getGraphSettings().yAxisLabel }, s.prototype.getShowXAxis = function () { return !!this.controller.getGraphSettings().showXAxis }, s.prototype.toggleXAxis = function () { this.controller.dispatch({ type: "set-graph-settings", showXAxis: !this.getShowXAxis() }) }, s.prototype.getShowYAxis = function () { return !!this.controller.getGraphSettings().showYAxis }, s.prototype.toggleYAxis = function () { this.controller.dispatch({ type: "set-graph-settings", showYAxis: !this.getShowYAxis() }) }, s.prototype.getAxisNumbers = function () { return !!this.controller.getGraphSettings().xAxisNumbers }, s.prototype.toggleAxisNumbers = function () { var e = this.getAxisNumbers(); this.controller.dispatch({ type: "set-graph-settings", xAxisNumbers: !e, yAxisNumbers: !e, polarNumbers: !e }) }, s.prototype.getMinorGridlines = function () { return 0 === this.controller.getGraphSettings().xAxisMinorSubdivisions }, s.prototype.toggleMinorGridlines = function () { var e = this.getMinorGridlines() ? 1 : 0; this.controller.dispatch({ type: "set-graph-settings", yAxisMinorSubdivisions: e, xAxisMinorSubdivisions: e }) }, s.prototype.getPolarMode = function () { return !!this.controller.getGraphSettings().polarMode }, s.prototype.setPolarMode = function () { this.controller.dispatch({ type: "set-graph-settings", polarMode: !0 }) }, s.prototype.setCartesianMode = function () { this.controller.dispatch({ type: "set-graph-settings", polarMode: !1 }) }, s.prototype.getDegreeMode = function () { return !!this.controller.getGraphSettings().degreeMode }, s.prototype.setRadianMode = function () { this.controller.dispatch({ type: "set-graph-settings", degreeMode: !1 }) }, s.prototype.setDegreeMode = function () { this.controller.dispatch({ type: "set-graph-settings", degreeMode: !0 }) }, s.prototype.getProjectorMode = function () { return !!this.controller.getGraphSettings().config.projectorMode }, s.prototype.toggleInvertedColors = function () { this.controller.dispatch({ type: "set-inverted-colors", value: !this.controller.getInvertedColors() }) }, s.prototype.toggleBrailleMode = function () { this.controller.dispatch({ type: "set-braille-mode", mode: "none" === this.controller.getBrailleMode() ? "nemeth" : "none" }) }, s.prototype.setDefaultDisplaySize = function () { this.controller.dispatch({ type: "set-projector-mode", value: !1 }) }, s.prototype.setLargeDisplaySize = function () { this.controller.dispatch({ type: "set-projector-mode", value: !0 }) }, s.prototype.getAxisArrowMode = function () { return this.controller.getGraphSettings().xAxisArrowMode }, s.prototype.setAxisArrowMode = function (e) { this.controller.dispatch({ type: "set-graph-settings", xAxisArrowMode: e, yAxisArrowMode: e }) }, s.prototype.getShowGrid = function () { return this.controller.getGraphSettings().showGrid }, s.prototype.toggleGrid = function () { this.controller.dispatch({ type: "set-graph-settings", showGrid: !this.getShowGrid() }) }, s.prototype.toggleArrows = function () { var e = this.getAxisArrowMode() === a.AxisArrowModes.NONE ? a.AxisArrowModes.BOTH : a.AxisArrowModes.NONE; this.controller.dispatch({ type: "set-graph-settings", xAxisArrowMode: e, yAxisArrowMode: e }) }, s.prototype.getSquareAxes = function () { return !!this.controller.getGraphSettings().squareAxes }, s.prototype.getContainerStyle = function () { return this.controller.getKeypadHeight() ? "bottom: 0" : "" }, s.prototype.zoomSquare = function () { this.controller.dispatch({ type: "zoom", direction: "square" }) }, s.prototype.getCapExpressionSize = function () { return !!this.controller.getGraphSettings().config.capExpressionSize }, s }(o.Class); e.default = A });
define('main/zoom-buttons-view', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip", "loadcss!pillboxes"], function (require, t, o, n, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function (t) { function r() { return null !== t && t.apply(this, arguments) || this } return o.__extends(r, t), r.prototype.init = function () { this.controller = this.props.controller() }, r.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-zoom-container") }, n.createElement("div", { class: n.const("dcg-zoominout-pillbox dcg-btn-flat-gray dcg-btn-flat-gray-group"), style: function () { return { background: t.controller.getPillboxBackgroundColor() } } }, n.createElement(e.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-zoom-in") }, gravity: this.const("w") }, n.createElement("div", { class: n.const("dcg-action-zoomin"), role: n.const("button"), tabindex: n.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-label-tooltip-zoom-in") }, onTap: this.bindFn(this.zoomIn), style: function () { return { background: t.controller.getPillboxBackgroundColor() } } }, n.createElement("i", { class: n.const("dcg-icon dcg-icon-plus"), "aria-hidden": n.const("true") }))), n.createElement(e.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-zoom-out") }, gravity: this.const("w") }, n.createElement("div", { class: n.const("dcg-option dcg-action-zoomout dcg-tooltip-e"), tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-zoom-out") }, role: n.const("button"), tabindex: n.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-label-tooltip-zoom-out") }, onTap: this.bindFn(this.zoomOut), style: function () { return { background: t.controller.getPillboxBackgroundColor() } } }, n.createElement("i", { class: n.const("dcg-icon dcg-icon-minus"), "aria-hidden": n.const("true") })))), n.createElement(e.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-zoom-default") }, gravity: this.const("w") }, n.createElement("div", { class: function () { return { "dcg-btn-flat-gray": !0, "dcg-option": !0, "dcg-action-zoomrestore": !0, "dcg-disabled": t.getZoomedDefault() } }, "aria-disabled": this.bindFn(this.getZoomedDefault), role: n.const("button"), tabindex: n.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-zoom-default") }, onTap: this.bindFn(this.zoomRestore), style: function () { return { background: t.controller.getPillboxBackgroundColor() } } }, n.createElement("i", { class: n.const("dcg-icon dcg-icon-home"), "aria-hidden": n.const("true") })))) }, r.prototype.zoomIn = function () { this.controller.dispatch({ type: "zoom", direction: "in" }) }, r.prototype.zoomOut = function () { this.controller.dispatch({ type: "zoom", direction: "out" }) }, r.prototype.zoomRestore = function () { this.controller.dispatch({ type: "zoom", direction: "default" }) }, r.prototype.getZoomedDefault = function () { return this.controller.getGraphSettings().zoomedDefault }, r }(n.Class); t.default = r });
define('main/reset-button-view', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip", "loadcss!pillboxes"], function (require, t, e, o, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.init = function () { this.controller = this.props.controller() }, n.prototype.template = function () { var t = this; return o.createElement("div", { class: o.const("dcg-reset-container") }, o.createElement(r.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-reset") }, gravity: this.const("w") }, o.createElement("div", { class: o.const("dcg-reset-pillbox dcg-action-reset dcg-btn-flat-gray"), role: o.const("button"), tabindex: o.const("0"), "aria-label": function () { return t.controller.s("graphing-calculator-label-tooltip-reset") }, onTap: this.bindFn(this.reset), style: function () { return { background: t.controller.getPillboxBackgroundColor() } } }, o.createElement("i", { class: o.const("dcg-icon dcg-icon-reset"), "aria-hidden": o.const("true") })))) }, n.prototype.reset = function () { this.controller.dispatch({ type: "reset-graph" }) }, n }(o.Class); t.default = n });
define('main/pillbox-view', ["require", "exports", "tslib", "dcgview", "./graphpaper-branding-view", "./settings-view", "./zoom-buttons-view", "./reset-button-view", "loadcss!pillboxes"], function (require, t, e, o, n, r, i, l) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = o.Components.If, c = function (t) { function c() { return null !== t && t.apply(this, arguments) || this } return e.__extends(c, t), c.prototype.init = function () { this.controller = this.props.controller() }, c.prototype.template = function () { var t = this; return o.createElement("div", null, o.createElement(s, { predicate: this.bindFn(this.shouldShowContainer) }, function () { return o.createElement("div", { class: o.const("dcg-pillbox-container"), role: o.const("group"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-graph-settings-controls") } }, o.createElement("div", { class: o.const("dcg-overgraph-pillbox-elements"), style: t.bindFn(t.getContainerStyle) }, o.createElement(s, { predicate: t.bindFn(t.shouldShowSettings) }, function () { return o.createElement(r.default, { controller: t.props.controller }) }), o.createElement(s, { predicate: t.bindFn(t.shouldShowResetButton) }, function () { return o.createElement(l.default, { controller: t.props.controller }) }), o.createElement(s, { predicate: t.bindFn(t.shouldShowZoomButtons) }, function () { return o.createElement(i.default, { controller: t.props.controller }) }))) }), o.createElement(n.default, { controller: function () { return t.props.controller() } })) }, c.prototype.getContainerStyle = function () { var t = this.controller.isKeypadOpen() ? this.controller.getKeypadHeight() : 0; return this.controller.isGraphSettingsOpen() ? "bottom: " + t + "px;" : "bottom: auto" }, c.prototype.shouldShowContainer = function () { return this.shouldShowSettings() || this.shouldShowZoomButtons() || this.shouldShowResetButton() }, c.prototype.shouldShowSettings = function () { return this.controller.getGraphSettings().config.settingsMenu }, c.prototype.shouldShowZoomButtons = function () { return this.controller.getGraphSettings().config.zoomButtons && !this.isViewportLocked() }, c.prototype.isViewportLocked = function () { return this.controller.getGraphSettings().config.lockViewport || this.controller.getGraphSettings().userLockedViewport }, c.prototype.shouldShowResetButton = function () { return this.controller.getGraphSettings().config.showResetButtonOnGraphpaper && this.controller.hasDefaultState() }, c }(o.Class); t.default = c });

define('loadcss!main/toast-view', function () { });
define('main/toast-view', ["require", "exports", "tslib", "dcgview", "loadcss!./toast-view"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ToastView = void 0; var r = n.Components.If, o = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement("span", { class: n.const("dcg-toast") }, n.createElement("i", { class: n.const("dcg-icon-error"), "aria-hidden": n.const("true") }), n.createElement(r, { predicate: function () { return !e.props.showUndo() && (!e.props.showClose || e.props.showClose()) } }, function () { return n.createElement("i", { class: n.const("dcg-icon-remove"), onTap: function () { return e.props.onClose && e.props.onClose() }, role: n.const("link"), tabindex: n.const(0), "aria-label": n.const("Dismiss Notice") }) }), n.createElement("span", { class: n.const("dcg-msg"), "aria-atomic": function () { return !e.props.noAria() }, "aria-live": function () { return e.props.noAria() ? "" : "assertive" } }, function () { return e.props.message() }), n.createElement(r, { predicate: this.props.showUndo }, function () { return n.createElement("a", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-undo"), onTap: function () { return e.props.onUndo && e.props.onUndo() } }, function () { return e.props.s("shared-calculator-label-toast-undo") }) }), n.createElement(r, { predicate: this.props.showLearnMore }, function () { return n.createElement("a", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-learn-more-link"), target: n.const("_blank"), onTap: function () { return e.props.onLearnMore && e.props.onLearnMore() } }, function () { return e.props.s("shared-calculator-label-toast-learn-more") }) }), n.createElement(r, { predicate: function () { return !!e.props.link && !!e.props.link() } }, function () { return n.createElement("a", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-learn-more-link"), target: function () { var t; return null !== (t = e.props.link().target) && void 0 !== t ? t : "_blank" }, href: function () { return e.props.link().url } }, function () { return e.props.link().text }) })) }, o.prototype.shouldUpdate = function () { return !!this.props.message() }, o }(n.Class), s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.template = function () { var e = this; return n.createElement("div", { class: function () { return { "dcg-toast-view": !0, "dcg-visible": !!e.props.message() } }, "toast-style": function () { return e.props.toastStyle && e.props.toastStyle() } }, n.createElement(r, { predicate: function () { return !!e.props.message() } }, function () { return n.createElement("div", { class: n.const("dcg-toast-wrapper") }, n.createElement("div", { class: n.const("dcg-toast-cover") }), n.createElement(o, t.__assign({}, e.props))) })) }, s }(n.Class); e.ToastView = s });
define('main/disable-dragdrop-events', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e) { e.on("drag dragend dragenter dragover dragleave drop", function (e) { e.preventDefault(), e.stopPropagation() }) } });
define('graphing-calc/views/main', ["require", "exports", "tslib", "touchtracking", "ipad.scrollfix", "dcgview", "jquery", "../../expressions/list-view", "graphing-calc/keypads/main", "main/pillbox-view", "main/toast-view", "main/disable-dragdrop-events", "main/manage-focus-helper", "../../shared-components/tooltip"], function (require, t, e, o, r, n, i, c, l, a, s, g, d, p) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var u = n.Components.If, f = function (t) { function f() { return null !== t && t.apply(this, arguments) || this } return e.__extends(f, t), f.prototype.init = function () { this.controller = this.props.controller() }, f.prototype.settings = function () { return this.controller.getGraphSettings() }, f.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-calculator-api-container"), style: n.const("width: 100%; height: 100%; position: relative;") }, n.createElement("div", { class: function () { return { "dcg-container": !0, "dcg-fullscreen": !t.controller.isListVisible(), "dcg-narrow": t.controller.isNarrow(), "dcg-PROJECTOR-MODE": t.settings().config.projectorMode, "dcg-inverted-colors": !!t.settings().config.invertedColors, "dcg-EDIT-LIST-MODE": t.controller.isInEditListMode(), "dcg-no-graphpaper": !t.settings().config.graphpaper, "dcg-no-branding": !t.settings().config.branding, "dcg-no-expression-topbar": !t.settings().config.expressionsTopbar, "dcg-default-border": !!t.settings().config.border, "dcg-no-hyperlinks": !t.settings().config.links, "dcg-has-background-color": t.controller.hasBackgroundColor(), "dcg-is-interactive": t.settings().config.expressions || !(t.settings().config.lockViewport || t.settings().userLockedViewport) } }, style: function () { return { "font-size": t.settings().config.fontSize + "px", background: t.getContainerBackgroundColor(), color: t.controller.getTextColor() } }, role: n.const("application"), "aria-label": function () { return t.controller.s("graphing-calculator-narration-main-desmos-graphing-calculator") }, "x-ms-format-detection": n.const("none"), didMount: this.bindFn(this.didMountRoot) }, n.createElement(u, { predicate: function () { return t.controller.getGraphSettings().config.expressions } }, function () { return n.createElement(c.default, { controller: t.props.controller }) }), n.createElement(u, { predicate: function () { return t.controller.isListEnabled() && !t.controller.isListVisible() } }, function () { return n.createElement("div", { class: function () { return { "dcg-overgraph-icon-container": !0, "dcg-bottom-right": t.controller.isNarrow() } } }, n.createElement(p.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-show-list") }, gravity: function () { return t.controller.isNarrow() ? "nw" : "se" } }, n.createElement("div", { class: function () { return { "dcg-show-expressions-tab": !0, "dcg-overgraph-icon": !0, "dcg-rotated": t.controller.isNarrow() } }, "aria-label": function () { return t.controller.s("graphing-calculator-label-tooltip-show-list") }, role: n.const("button"), tabindex: n.const("0"), onTap: function (e) { t.controller.dispatch({ type: "show-expressions-list", focusHideIcon: "keyboard" === e.device }) }, manageFocus: t.const(d.manageFocusHelper({ controller: t.controller, location: { type: "show-expression-list-btn" } })) }, n.createElement("i", { class: n.const("dcg-icon-show"), "aria-hidden": n.const("true") })))) }), n.createElement(u, { predicate: this.bindFn(this.showHamburger) }, function () { return n.createElement("div", { class: n.const("dcg-overgraph-icon-container") }, n.createElement(p.Tooltip, { tooltip: function () { return t.controller.s("graphing-calculator-label-tooltip-open-graph") }, gravity: t.const("se") }, n.createElement("div", { role: n.const("button"), "aria-label": function () { return t.controller.s("graphing-calculator-label-tooltip-open-graph") }, class: n.const("dcg-action-opendrawer dcg-in-api-action-opendrawer dcg-overgraph-icon"), onTap: function () { return t.controller.dispatch({ type: "open-drawer" }) } }, n.createElement("i", { class: n.const("dcg-icon-hamburger"), "aria-hidden": n.const("true") })))) }), n.createElement(a.default, { controller: this.props.controller }), n.createElement(s.ToastView, { message: function () { var e = t.controller.getToastData().message; return t.controller.raw(e || "") }, link: function () { return t.controller.getToastData().link || void 0 }, showUndo: function () { return !!t.controller.getToastData().undoCallback }, showLearnMore: function () { return !!t.controller.getToastData().learnMoreCallback }, noAria: function () { return !!t.controller.getToastData().noAria }, toastStyle: function () { return t.controller.getToastData().toastStyle }, s: this.controller.s, onUndo: function () { return t.controller.dispatch({ type: "toast/undo" }) }, onLearnMore: function () { return t.controller.dispatch({ type: "toast/learn-more" }) }, onClose: function () { return t.controller.dispatch({ type: "toast/close" }) } }), n.createElement("div", { class: n.const("dcg-grapher") }), n.createElement(u, { predicate: function () { return t.controller.getGraphSettings().config.keypad } }, function () { return n.createElement(l.default, { controller: t.props.controller }) }))) }, f.prototype.showHamburger = function () { return !!this.controller.getGraphSettings().config.showHamburger && (!this.controller.isInEditListMode() && this.controller.isNarrow()) }, f.prototype.getContainerBackgroundColor = function () { return this.controller.hasTransparentBackground() ? "none" : this.controller.getBackgroundColor() }, f.prototype.didMountRoot = function (t) { o.monitor(t), this.controller.getGraphSettings().config.disableScrollFix || r.limitScrollOnElement(t), this.setupFileDragDrop(t) }, f.prototype.setupFileDragDrop = function (t) { var e = this, o = i(t); g.default(o); var r = i(), n = this; function c() { r = i(), o.off(".filedraggedover"), n.controller.dispatch({ type: "file-is-not-dragged-over" }) } o.on("dragenter", function (t) { e.controller.areImagesEnabled() && (0 === r.length && o.on("dcg-tapstart.filedraggedover", c), r = r.add(t.target), e.controller.dispatch({ type: "file-is-dragged-over" })) }).on("dragleave", function (t) { 0 === (r = r.not(t.target)).length && c() }).on("drop", c) }, f }(n.Class); t.default = f });
define('worker/workerpoolconnection', ['require', 'pjs', 'underscore_model'], function (require) { "use strict"; return require("pjs")(require("underscore_model").UnderscoreModel, function (e, o) { e.init = function (e) { o.init.call(this), this.workerPool = e, this.worker = e.allocateWorker(), this.worker.__connections[this.guid] = this }, e.destroy = function () { this.sendMessage({ type: "destroy" }), delete this.worker.__connections[this.guid] }, e.killWorker = function () { this.worker.__isFake || this.workerPool.killWorker(this.worker) }, e.onWorkerKilled = function () { }, e.onResponse = function (e) { }, e.sendMessage = function (e) { this.worker.__isFake ? this.worker.postMessage(e) : this.worker.postMessage({ connectionId: this.guid, originalMessage: e }) } }) });

define('text!worker_src_underlying', [], function () { return 'var requirejs,require,define;!function(e){var n,r,i,t,o={},u={},f={},c={},l=Object.prototype.hasOwnProperty,s=[].slice;function p(e,n){return l.call(e,n)}function a(e,n){var r,i,t,o,u,c,l,s,p,a,d=n&&n.split("/"),g=f.map,q=g&&g["*"]||{};if(e&&"."===e.charAt(0))if(n){for(e=(d=d.slice(0,d.length-1)).concat(e.split("/")),s=0;s<e.length;s+=1)if("."===(a=e[s]))e.splice(s,1),s-=1;else if(".."===a){if(1===s&&(".."===e[2]||".."===e[0]))break;s>0&&(e.splice(s-1,2),s-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((d||q)&&g){for(s=(r=e.split("/")).length;s>0;s-=1){if(i=r.slice(0,s).join("/"),d)for(p=d.length;p>0;p-=1)if((t=g[d.slice(0,p).join("/")])&&(t=t[i])){o=t,u=s;break}if(o)break;!c&&q&&q[i]&&(c=q[i],l=s)}!o&&c&&(o=c,u=l),o&&(r.splice(0,u,o),e=r.join("/"))}return e}function d(n,i){return function(){return r.apply(e,s.call(arguments,0).concat([n,i]))}}function g(e){return function(n){o[e]=n}}function q(r){if(p(u,r)){var i=u[r];delete u[r],c[r]=!0,n.apply(e,i)}if(!p(o,r)&&!p(c,r))throw new Error("No "+r);return o[r]}function O(e){var n,r=e?e.indexOf("!"):-1;return r>-1&&(n=e.substring(0,r),e=e.substring(r+1,e.length)),[n,e]}function h(e){return function(){return f&&f.config&&f.config[e]||{}}}i=function(e,n){var r,i=O(e),t=i[0];return e=i[1],t&&(r=q(t=a(t,n))),t?e=r&&r.normalize?r.normalize(e,function(e){return function(n){return a(n,e)}}(n)):a(e,n):(t=(i=O(e=a(e,n)))[0],e=i[1],t&&(r=q(t))),{f:t?t+"!"+e:e,n:e,pr:t,p:r}},t={require:function(e){return d(e)},exports:function(e){var n=o[e];return void 0!==n?n:o[e]={}},module:function(e){return{id:e,uri:"",exports:o[e],config:h(e)}}},n=function(n,r,f,l){var s,a,O,h,E,j,m=[];if(l=l||n,"function"==typeof f){for(r=!r.length&&f.length?["require","exports","module"]:r,E=0;E<r.length;E+=1)if("require"===(a=(h=i(r[E],l)).f))m[E]=t.require(n);else if("exports"===a)m[E]=t.exports(n),j=!0;else if("module"===a)s=m[E]=t.module(n);else if(p(o,a)||p(u,a)||p(c,a))m[E]=q(a);else{if(!h.p)throw new Error(n+" missing "+a);h.p.load(h.n,d(l,!0),g(a),{}),m[E]=o[a]}O=f.apply(o[n],m),n&&(s&&s.exports!==e&&s.exports!==o[n]?o[n]=s.exports:O===e&&j||(o[n]=O))}else n&&(o[n]=f)},requirejs=require=r=function(o,u,c,l,s){return"string"==typeof o?t[o]?t[o](u):q(i(o,u).f):(o.splice||(f=o,u.splice?(o=u,u=c,c=null):o=e),u=u||function(){},"function"==typeof c&&(c=l,l=s),l?n(e,o,u,c):setTimeout(function(){n(e,o,u,c)},4),r)},r.config=function(e){return(f=e).deps&&r(f.deps,f.callback),r},(define=function(e,n,r){n.splice||(r=n,n=[]),p(o,e)||p(u,e)||(u[e]=[e,n,r])}).amd={jQuery:!0}}(),"undefined"!=typeof ALMOND_OVERRIDES&&ALMOND_OVERRIDES&&(define=ALMOND_OVERRIDES.define||define,require=ALMOND_OVERRIDES.require||require,requirejs=ALMOND_OVERRIDES.requirejs||requirejs);\ndefine("core/vendor/almond", function(){});\n\ndefine("pjs",[],function(){return function(n,t,o){function r(n){return"object"==typeof n}function e(n){return"function"==typeof n}function i(){}return function n(o,p){function u(){var n=new c;return e(n.init)&&n.init.apply(n,arguments),n}function c(){}undefined===p&&(p=o,o=Object),u.Bare=c;var f,y=i.prototype=o.prototype,a=c.prototype=u.prototype=new i;return a.constructor=u,u.mixin=function(t){return c.prototype=u.prototype=n(u,t).prototype,u},(u.open=function(n){if(f={},e(n)?f=n.call(u,a,y,u,o):r(n)&&(f=n),r(f))for(var i in f)t.call(f,i)&&(a[i]=f[i]);return e(a.init)||(a.init=o),u})(p)}}(0,{}.hasOwnProperty)});\ndefine(\'core/math/parser/input-span\',["require","exports"],function(require,n){"use strict";function t(n,t,e){return{input:n,start:t,end:e}}Object.defineProperty(n,"__esModule",{value:!0}),n.slice=n.joinSpans=n.emptySpanAt=n.Span=void 0,n.Span=t,n.emptySpanAt=function(n,e){return t(n,e,e)},n.joinSpans=function(n,e){if(n.input!==e.input)throw new Error("Programming Error: cannot form a span on different inputs");return t(n.input,n.start,e.end)},n.slice=function(n){return n.input.slice(n.start,n.end)}});\ndefine(\'core/math/domaintypes\',["require","exports"],function(require,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.intersectDomains=n.allReals=n.linearPositiveDomain=n.knownDomain=n.unknownDomain=n.emptyDomain=void 0;n.emptyDomain=function(){return{type:"empty"}};n.unknownDomain=function(){return{type:"unknown"}};n.knownDomain=function(e){return isNaN(e[0])||isNaN(e[1])||e[1]<e[0]?n.emptyDomain():{type:"known",bounds:e}};n.linearPositiveDomain=function(e,o){if(0===o)return e>0?n.allReals():n.emptyDomain();var t=-e/o,i=o<0?[-1/0,t]:[t,1/0];return n.knownDomain(i)};n.allReals=function(){return n.knownDomain([-1/0,1/0])};n.intersectDomains=function(e,o){if("empty"===e.type||"empty"===o.type)return n.emptyDomain();if("unknown"===e.type||"unknown"===o.type)return n.unknownDomain();if(e.bounds&&o.bounds){var t=[Math.max(e.bounds[0],o.bounds[0]),Math.min(e.bounds[1],o.bounds[1])];return n.knownDomain(t)}return n.emptyDomain()}});\ndefine(\'core/lib/worker-i18n\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.s=void 0,e.s=function(e,r){return{key:e,vars:r}}});\ndefine(\'core/math/types\',["require","exports","core/lib/worker-i18n"],function(require,e,t){"use strict";var r;function s(t){switch(t){case e.Any:return"Any";case e.Number:return"Number";case e.Bool:return"Bool";case e.Point:return"Point";case e.Distribution:return"Distribution";case e.Action:return"Action";case e.ListOfAny:return"ListOfAny";case e.ListOfNumber:return"ListOfNumber";case e.ListOfBool:return"ListOfBool";case e.ListOfPoint:return"ListOfPoint";case e.ListOfDistribution:return"ListOfDistribution";case e.EmptyList:return"EmptyList";case e.ErrorType:return"ErrorType";case e.SeedType:return"SeedType";case e.RGBColor:return"RGBColor";case e.ListOfColor:return"ListOfColor";case e.Polygon:return"Polygon";case e.ListOfPolygon:return"ListOfPolygon";default:throw new Error("Invalid type: "+t)}}Object.defineProperty(e,"__esModule",{value:!0}),e.isTypeOrListOfType=e.typesMatch=e.isSubType=e.isOneOf=e.hasListType=e.listType=e.elementType=e.isList=e.prettyPrint=e.repr=e.ListOfPolygon=e.Polygon=e.ListOfColor=e.RGBColor=e.SeedType=e.ErrorType=e.EmptyList=e.ListOfDistribution=e.ListOfPoint=e.ListOfBool=e.ListOfNumber=e.ListOfAny=e.Action=e.Distribution=e.Point=e.Bool=e.Number=e.Any=void 0,e.Any=0,e.Number=1,e.Bool=2,e.Point=3,e.Distribution=4,e.Action=5,e.ListOfAny=6,e.ListOfNumber=7,e.ListOfBool=8,e.ListOfPoint=9,e.ListOfDistribution=10,e.EmptyList=11,e.ErrorType=12,e.SeedType=13,e.RGBColor=14,e.ListOfColor=15,e.Polygon=16,e.ListOfPolygon=17,e.repr=s,e.prettyPrint=function(r){switch(r){case e.Any:return t.s("shared-calculator-label-value-type-any");case e.Number:return t.s("shared-calculator-label-value-type-number");case e.Bool:return t.s("shared-calculator-label-value-type-bool");case e.Point:return t.s("shared-calculator-label-value-type-point");case e.Distribution:return t.s("shared-calculator-label-value-type-distribution");case e.Action:return t.s("shared-calculator-label-value-type-action");case e.ListOfAny:return t.s("shared-calculator-label-value-type-list-of-any");case e.ListOfNumber:return t.s("shared-calculator-label-value-type-list-of-numbers");case e.ListOfBool:return t.s("shared-calculator-label-value-type-list-of-bool");case e.ListOfPoint:return t.s("shared-calculator-label-value-type-list-of-points");case e.ListOfDistribution:return t.s("shared-calculator-label-value-type-list-of-distributions");case e.EmptyList:return t.s("shared-calculator-label-value-type-empty-list");case e.ErrorType:return t.s("shared-calculator-label-value-type-error");case e.SeedType:return t.s("shared-calculator-label-value-type-seed");case e.RGBColor:return t.s("shared-calculator-label-value-type-color");case e.ListOfColor:return t.s("shared-calculator-label-value-type-list-of-colors");case e.Polygon:return t.s("shared-calculator-label-value-type-polygon");case e.ListOfPolygon:return t.s("shared-calculator-label-value-type-list-of-polygons");default:throw new Error("Invalid type: "+r)}};(r={})[e.ListOfAny]=e.Any,r[e.EmptyList]=e.Number,r[e.ListOfNumber]=e.Number,r[e.ListOfBool]=e.Bool,r[e.ListOfPoint]=e.Point,r[e.ListOfDistribution]=e.Distribution,r[e.ListOfColor]=e.RGBColor,r[e.ListOfPolygon]=e.Polygon;function o(t){switch(t){case e.ListOfAny:case e.ListOfNumber:case e.ListOfBool:case e.ListOfPoint:case e.ListOfDistribution:case e.ListOfColor:case e.ListOfPolygon:case e.EmptyList:return!0;case e.Any:case e.Number:case e.Bool:case e.Point:case e.Distribution:case e.ErrorType:case e.SeedType:case e.RGBColor:case e.Action:case e.Polygon:return!1;default:throw new Error("Invalid type: "+t)}}function i(t){switch(t){case e.EmptyList:case e.ListOfNumber:return e.Number;case e.ListOfBool:return e.Bool;case e.ListOfPoint:return e.Point;case e.ListOfDistribution:return e.Distribution;case e.ListOfColor:return e.RGBColor;case e.ListOfPolygon:return e.Polygon;case e.ListOfAny:return e.Any;case e.Any:case e.Number:case e.Bool:case e.Point:case e.Distribution:case e.ErrorType:case e.SeedType:case e.RGBColor:case e.Action:case e.Polygon:return e.Any;default:throw new Error("Invalid type: "+t)}}function a(t,r){return!(t!==e.EmptyList||!o(r))||(!(r!==e.ListOfAny||!o(t))||t===r)}e.isList=o,e.elementType=i,e.listType=function(t){switch(t){case e.Any:return e.ListOfAny;case e.Number:return e.ListOfNumber;case e.Bool:return e.ListOfBool;case e.Point:return e.ListOfPoint;case e.Distribution:return e.ListOfDistribution;case e.RGBColor:return e.ListOfColor;case e.Polygon:return e.ListOfPolygon;case e.EmptyList:case e.ListOfNumber:case e.ListOfBool:case e.ListOfPoint:case e.ListOfDistribution:case e.ListOfColor:case e.ListOfPolygon:case e.ListOfAny:case e.ErrorType:case e.SeedType:case e.Action:throw new Error("Type "+s(t)+" does not implement listType.");default:throw new Error("Invalid type: "+t)}},e.hasListType=function(t){switch(t){case e.Any:case e.Number:case e.Bool:case e.Point:case e.Distribution:case e.RGBColor:case e.Polygon:return!0;case e.EmptyList:case e.ListOfNumber:case e.ListOfBool:case e.ListOfPoint:case e.ListOfDistribution:case e.ListOfColor:case e.ListOfPolygon:case e.ListOfAny:case e.ErrorType:case e.SeedType:case e.Action:return!1;default:throw new Error("Invalid type: "+t)}},e.isOneOf=function(e,t){for(var r=0,s=t;r<s.length;r++){if(e===s[r])return!0}return!1},e.isSubType=a,e.typesMatch=function(e,t){return a(e,t)||a(t,e)},e.isTypeOrListOfType=function(t,r){return t===r||!!o(t)&&(t===e.EmptyList||i(t)===r)}});\ndefine(\'core/math/parsenode/base\',[\'require\',\'pjs\',\'core/math/parser/input-span\',\'core/math/domaintypes\',\'core/math/types\'],function(require){"use strict";var e=require("pjs"),n=require("core/math/parser/input-span"),t=require("core/math/domaintypes"),i=require("core/math/types");return e(function(e,s,d){e.init=function(){this._dependencies=[],this._dummyDependencies=[],this._updateSymbols=[],this._scope={definitions:[],dependencies:[],scopes:[]},this._exports=[]},e.exportPenalty=0,e.setInputSpan=function(e){this._inputSpan=e},e.getInputString=function(){return void 0===this.getInputSpan()?"":n.slice(this._inputSpan)},e.getInputSpan=function(){return this._inputSpan},e.shouldExportAns=function(){return!1},e.getAnsVariable=function(){return this.shouldExportAns()&&this.userData&&this.userData.hasOwnProperty("index")?["ans_"+this.userData.index]:[]},e.addDependency=function(e){-1===this._dependencies.indexOf(e)&&this._dependencies.push(e),-1===this._scope.dependencies.indexOf(e)&&this._scope.dependencies.push(e)},e.addDependencies=function(e){for(var n=0;n<e.length;n++)this.addDependency(e[n])},e.addDummyDependency=function(e){-1===this._dependencies.indexOf(e)&&this._dependencies.push(e),-1===this._dummyDependencies.indexOf(e)&&this._dummyDependencies.push(e)},e.addDummyDependencies=function(e){for(var n=0;n<e.length;n++)this.addDummyDependency(e[n])},e.addUpdateSymbol=function(e){-1===this._dependencies.indexOf(e)&&this._dependencies.push(e),-1===this._updateSymbols.indexOf(e)&&this._updateSymbols.push(e)},e.mergeDependencies=function(){for(var e=0;e<arguments.length;e++){var n,t=arguments[e];for(n=0;n<t._dependencies.length;n++)-1===this._dependencies.indexOf(t._dependencies[n])&&this._dependencies.push(t._dependencies[n]);for(n=0;n<t._updateSymbols.length;n++)-1===this._updateSymbols.indexOf(t._updateSymbols[n])&&this._updateSymbols.push(t._updateSymbols[n]);for(n=0;n<t._scope.dependencies.length;n++)-1===this._scope.dependencies.indexOf(t._scope.dependencies[n])&&this._scope.dependencies.push(t._scope.dependencies[n]);this.addDummyDependencies(t.getDummyDependencies()),Array.prototype.push.apply(this._scope.scopes,t._scope.scopes)}},e.mergeDependenciesInScope=function(e,n){this.addDummyDependencies(e);var t=n.getScope(),i={definitions:e,dependencies:t.dependencies,scopes:t.scopes};this._scope.scopes.push(i);for(var s=0;s<n._dependencies.length;s++)-1===this._dependencies.indexOf(n._dependencies[s])&&this._dependencies.push(n._dependencies[s]);for(s=0;s<n._updateSymbols.length;s++)-1===this._updateSymbols.indexOf(n._updateSymbols[s])&&this._updateSymbols.push(n._updateSymbols[s]);this.addDummyDependencies(n.getDummyDependencies())},e.getDependencies=function(){return this._dependencies},e.getDummyDependencies=function(){return this._dummyDependencies},e.getUpdateSymbols=function(){return this._updateSymbols},e.getScope=function(){return this._scope},e.dependsOn=function(e){return this._dependencies.indexOf(e)>-1},e.getExports=function(){return(this._exports||[]).concat(this.getAnsVariable())},e.getLegalExports=function(e){return this.getExports().filter(function(n){return!e.assignmentForbidden(n)})},e.exportsSymbol=function(e){return this._exports.indexOf(e)>-1},e.exportTo=function(e,n,t){for(var i=this.getLegalExports(e),s=0;s<i.length;s++){var d=i[s];if(t[d])return;t[d]=n.blocksExport?n:this}},e.getOperator=function(){return this.operator||"="},e.isInequality=function(){return!1},e.isShadeBetween=function(){return!1},e.getAllIds=function(){return this.userData?[this.userData.id]:[]},e.getEvaluationInfo=function(){return!1},e.shouldPromoteToSlider=function(e){return!1},e.getSliderVariables=function(e,n){var t=e.sliderVariables(n.getDependencies());return n.valueType===i.Point||n.valueType===i.ListOfPoint?t.filter(function(n){return!e.validParametricVariable(n)}):t},e.getCompiledDerivative=function(){var e=this.getDependencies();return this.takeDerivative(e[0]||"x").getCompiledFunction()},e.asValue=function(){},e.boundDomain=function(e){return t.unknownDomain()}})});\ndefine(\'core/math/parsenode/error\',[\'require\',\'pjs\',\'./base\'],function(require){"use strict";return require("pjs")(require("./base"),function(t,n){t.init=function(t){n.init.call(this),this._msg=t,this.blocksExport=!0},t.evaluateOnce=function(t){return this._msg},t.isError=!0,t.getError=function(){return this._msg},t.setDependencies=function(t){return this.addDependencies(t),this},t.setActionValue=function(t){this.actionValue=t},t.allowExport=function(){return this.blocksExport=!1,this}})});\n!function(n,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define("underscore",r):function(){var t=n._,e=r();n._=e,e.noConflict=function(){return n._=t,e}}()}(this,function(){var n="object"==typeof self&&self.self===self&&self||"object"==typeof global&&global.global===global&&global||Function("return this")()||{},r=Array.prototype,t=Object.prototype,e="undefined"!=typeof Symbol?Symbol.prototype:null,u=r.push,o=r.slice,i=t.toString,a=t.hasOwnProperty,f=Array.isArray,c=Object.keys,l=Object.create,p=n.isNaN,s=n.isFinite,v=function(){};function h(n){return n instanceof h?n:this instanceof h?void(this._wrapped=n):new h(n)}var y=h.VERSION="1.10.2";function g(n,r,t){if(void 0===r)return n;switch(null==t?3:t){case 1:return function(t){return n.call(r,t)};case 3:return function(t,e,u){return n.call(r,t,e,u)};case 4:return function(t,e,u,o){return n.call(r,t,e,u,o)}}return function(){return n.apply(r,arguments)}}function d(n,r,t){return null==n?ur:Cn(n)?g(n,r,t):Ln(n)&&!Kn(n)?ir(n):or(n)}function m(n,r){return d(n,r,1/0)}function b(n,r,t){return h.iteratee!==m?h.iteratee(n,r):d(n,r,t)}function j(n,r){return r=null==r?n.length-1:+r,function(){for(var t=Math.max(arguments.length-r,0),e=Array(t),u=0;u<t;u++)e[u]=arguments[u+r];switch(r){case 0:return n.call(this,e);case 1:return n.call(this,arguments[0],e);case 2:return n.call(this,arguments[0],arguments[1],e)}var o=Array(r+1);for(u=0;u<r;u++)o[u]=arguments[u];return o[r]=e,n.apply(this,o)}}function _(n){if(!Ln(n))return{};if(l)return l(n);v.prototype=n;var r=new v;return v.prototype=null,r}function w(n){return function(r){return null==r?void 0:r[n]}}function x(n,r){return null!=n&&a.call(n,r)}function S(n,r){for(var t=r.length,e=0;e<t;e++){if(null==n)return;n=n[r[e]]}return t?n:void 0}h.iteratee=m;var A=Math.pow(2,53)-1,O=w("length");function M(n){var r=O(n);return"number"==typeof r&&r>=0&&r<=A}function E(n,r,t){var e,u;if(r=g(r,t),M(n))for(e=0,u=n.length;e<u;e++)r(n[e],e,n);else{var o=Sn(n);for(e=0,u=o.length;e<u;e++)r(n[o[e]],o[e],n)}return n}function N(n,r,t){r=b(r,t);for(var e=!M(n)&&Sn(n),u=(e||n).length,o=Array(u),i=0;i<u;i++){var a=e?e[i]:i;o[i]=r(n[a],a,n)}return o}function k(n){var r=function(r,t,e,u){var o=!M(r)&&Sn(r),i=(o||r).length,a=n>0?0:i-1;for(u||(e=r[o?o[a]:a],a+=n);a>=0&&a<i;a+=n){var f=o?o[a]:a;e=t(e,r[f],f,r)}return e};return function(n,t,e,u){var o=arguments.length>=3;return r(n,g(t,u,4),e,o)}}var I=k(1),T=k(-1);function B(n,r,t){var e=(M(n)?on:Tn)(n,r,t);if(void 0!==e&&-1!==e)return n[e]}function R(n,r,t){var e=[];return r=b(r,t),E(n,function(n,t,u){r(n,t,u)&&e.push(n)}),e}function F(n,r,t){r=b(r,t);for(var e=!M(n)&&Sn(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(!r(n[i],i,n))return!1}return!0}function q(n,r,t){r=b(r,t);for(var e=!M(n)&&Sn(n),u=(e||n).length,o=0;o<u;o++){var i=e?e[o]:o;if(r(n[i],i,n))return!0}return!1}function D(n,r,t,e){return M(n)||(n=On(n)),("number"!=typeof t||e)&&(t=0),ln(n,r,t)>=0}var W=j(function(n,r,t){var e,u;return Cn(r)?u=r:Kn(r)&&(e=r.slice(0,-1),r=r[r.length-1]),N(n,function(n){var o=u;if(!o){if(e&&e.length&&(n=S(n,e)),null==n)return;o=n[r]}return null==o?o:o.apply(n,t)})});function z(n,r){return N(n,or(r))}function P(n,r,t){var e,u,o=-1/0,i=-1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=M(n)?n:On(n)).length;a<f;a++)null!=(e=n[a])&&e>o&&(o=e);else r=b(r,t),E(n,function(n,t,e){((u=r(n,t,e))>i||u===-1/0&&o===-1/0)&&(o=n,i=u)});return o}function K(n,r,t){if(null==r||t)return M(n)||(n=On(n)),n[ar(n.length-1)];var e=M(n)?Dn(n):On(n),u=O(e);r=Math.max(Math.min(r,u),0);for(var o=u-1,i=0;i<r;i++){var a=ar(i,o),f=e[i];e[i]=e[a],e[a]=f}return e.slice(0,r)}function L(n,r){return function(t,e,u){var o=r?[[],[]]:{};return e=b(e,u),E(t,function(r,u){var i=e(r,u,t);n(o,r,i)}),o}}var V=L(function(n,r,t){x(n,t)?n[t].push(r):n[t]=[r]}),C=L(function(n,r,t){n[t]=r}),J=L(function(n,r,t){x(n,t)?n[t]++:n[t]=1}),U=/[^\\ud800-\\udfff]|[\\ud800-\\udbff][\\udc00-\\udfff]|[\\ud800-\\udfff]/g;var $=L(function(n,r,t){n[t?0:1].push(r)},!0);function G(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[0]:H(n,n.length-r)}function H(n,r,t){return o.call(n,0,Math.max(0,n.length-(null==r||t?1:r)))}function Q(n,r,t){return o.call(n,null==r||t?1:r)}function X(n,r,t,e){for(var u=(e=e||[]).length,o=0,i=O(n);o<i;o++){var a=n[o];if(M(a)&&(Kn(a)||Vn(a)))if(r)for(var f=0,c=a.length;f<c;)e[u++]=a[f++];else X(a,r,t,e),u=e.length;else t||(e[u++]=a)}return e}var Y=j(function(n,r){return rn(n,r)});function Z(n,r,t,e){er(r)||(e=t,t=r,r=!1),null!=t&&(t=b(t,e));for(var u=[],o=[],i=0,a=O(n);i<a;i++){var f=n[i],c=t?t(f,i,n):f;r&&!t?(i&&o===c||u.push(f),o=c):t?D(o,c)||(o.push(c),u.push(f)):D(u,f)||u.push(f)}return u}var nn=j(function(n){return Z(X(n,!0,!0))});var rn=j(function(n,r){return r=X(r,!0,!0),R(n,function(n){return!D(r,n)})});function tn(n){for(var r=n&&P(n,O).length||0,t=Array(r),e=0;e<r;e++)t[e]=z(n,e);return t}var en=j(tn);function un(n){return function(r,t,e){t=b(t,e);for(var u=O(r),o=n>0?0:u-1;o>=0&&o<u;o+=n)if(t(r[o],o,r))return o;return-1}}var on=un(1),an=un(-1);function fn(n,r,t,e){for(var u=(t=b(t,e,1))(r),o=0,i=O(n);o<i;){var a=Math.floor((o+i)/2);t(n[a])<u?o=a+1:i=a}return o}function cn(n,r,t){return function(e,u,i){var a=0,f=O(e);if("number"==typeof i)n>0?a=i>=0?i:Math.max(i+f,a):f=i>=0?Math.min(i+1,f):i+f+1;else if(t&&i&&f)return e[i=t(e,u)]===u?i:-1;if(u!=u)return(i=r(o.call(e,a,f),tr))>=0?i+a:-1;for(i=n>0?a:f-1;i>=0&&i<f;i+=n)if(e[i]===u)return i;return-1}}var ln=cn(1,on,fn),pn=cn(-1,an);function sn(n,r,t,e,u){if(!(e instanceof r))return n.apply(t,u);var o=_(n.prototype),i=n.apply(o,u);return Ln(i)?i:o}var vn=j(function(n,r,t){if(!Cn(n))throw new TypeError("Bind must be called on a function");var e=j(function(u){return sn(n,e,r,this,t.concat(u))});return e}),hn=j(function(n,r){var t=hn.placeholder,e=function(){for(var u=0,o=r.length,i=Array(o),a=0;a<o;a++)i[a]=r[a]===t?arguments[u++]:r[a];for(;u<arguments.length;)i.push(arguments[u++]);return sn(n,e,this,this,i)};return e});hn.placeholder=h;var yn=j(function(n,r){var t=(r=X(r,!1,!1)).length;if(t<1)throw new Error("bindAll must be passed function names");for(;t--;){var e=r[t];n[e]=vn(n[e],n)}});var gn=j(function(n,r,t){return setTimeout(function(){return n.apply(null,t)},r)}),dn=hn(gn,h,1);function mn(n){return function(){return!n.apply(this,arguments)}}function bn(n,r){var t;return function(){return--n>0&&(t=r.apply(this,arguments)),n<=1&&(r=null),t}}var jn=hn(bn,2),_n=!{toString:null}.propertyIsEnumerable("toString"),wn=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];function xn(n,r){var e=wn.length,u=n.constructor,o=Cn(u)&&u.prototype||t,i="constructor";for(x(n,i)&&!D(r,i)&&r.push(i);e--;)(i=wn[e])in n&&n[i]!==o[i]&&!D(r,i)&&r.push(i)}function Sn(n){if(!Ln(n))return[];if(c)return c(n);var r=[];for(var t in n)x(n,t)&&r.push(t);return _n&&xn(n,r),r}function An(n){if(!Ln(n))return[];var r=[];for(var t in n)r.push(t);return _n&&xn(n,r),r}function On(n){for(var r=Sn(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=n[r[u]];return e}function Mn(n){for(var r={},t=Sn(n),e=0,u=t.length;e<u;e++)r[n[t[e]]]=t[e];return r}function En(n){var r=[];for(var t in n)Cn(n[t])&&r.push(t);return r.sort()}function Nn(n,r){return function(t){var e=arguments.length;if(r&&(t=Object(t)),e<2||null==t)return t;for(var u=1;u<e;u++)for(var o=arguments[u],i=n(o),a=i.length,f=0;f<a;f++){var c=i[f];r&&void 0!==t[c]||(t[c]=o[c])}return t}}var kn=Nn(An),In=Nn(Sn);function Tn(n,r,t){r=b(r,t);for(var e,u=Sn(n),o=0,i=u.length;o<i;o++)if(r(n[e=u[o]],e,n))return e}function Bn(n,r,t){return r in t}var Rn=j(function(n,r){var t={},e=r[0];if(null==n)return t;Cn(e)?(r.length>1&&(e=g(e,r[1])),r=An(n)):(e=Bn,r=X(r,!1,!1),n=Object(n));for(var u=0,o=r.length;u<o;u++){var i=r[u],a=n[i];e(a,i,n)&&(t[i]=a)}return t}),Fn=j(function(n,r){var t,e=r[0];return Cn(e)?(e=mn(e),r.length>1&&(t=r[1])):(r=N(X(r,!1,!1),String),e=function(n,t){return!D(r,t)}),Rn(n,e,t)}),qn=Nn(An,!0);function Dn(n){return Ln(n)?Kn(n)?n.slice():kn({},n):n}function Wn(n,r){var t=Sn(r),e=t.length;if(null==n)return!e;for(var u=Object(n),o=0;o<e;o++){var i=t[o];if(r[i]!==u[i]||!(i in u))return!1}return!0}function zn(n,r,t,u){if(n===r)return 0!==n||1/n==1/r;if(null==n||null==r)return!1;if(n!=n)return r!=r;var o=typeof n;return("function"===o||"object"===o||"object"==typeof r)&&function(n,r,t,u){n instanceof h&&(n=n._wrapped);r instanceof h&&(r=r._wrapped);var o=i.call(n);if(o!==i.call(r))return!1;switch(o){case"[object RegExp]":case"[object String]":return""+n==""+r;case"[object Number]":return+n!=+n?+r!=+r:0==+n?1/+n==1/r:+n==+r;case"[object Date]":case"[object Boolean]":return+n==+r;case"[object Symbol]":return e.valueOf.call(n)===e.valueOf.call(r)}var a="[object Array]"===o;if(!a){if("object"!=typeof n||"object"!=typeof r)return!1;var f=n.constructor,c=r.constructor;if(f!==c&&!(Cn(f)&&f instanceof f&&Cn(c)&&c instanceof c)&&"constructor"in n&&"constructor"in r)return!1}u=u||[];var l=(t=t||[]).length;for(;l--;)if(t[l]===n)return u[l]===r;if(t.push(n),u.push(r),a){if((l=n.length)!==r.length)return!1;for(;l--;)if(!zn(n[l],r[l],t,u))return!1}else{var p,s=Sn(n);if(l=s.length,Sn(r).length!==l)return!1;for(;l--;)if(!x(r,p=s[l])||!zn(n[p],r[p],t,u))return!1}return t.pop(),u.pop(),!0}(n,r,t,u)}function Pn(n){return function(r){return i.call(r)==="[object "+n+"]"}}var Kn=f||Pn("Array");function Ln(n){var r=typeof n;return"function"===r||"object"===r&&!!n}var Vn=Pn("Arguments"),Cn=Pn("Function"),Jn=Pn("String"),Un=Pn("Number"),$n=Pn("Date"),Gn=Pn("RegExp"),Hn=Pn("Error"),Qn=Pn("Symbol"),Xn=Pn("Map"),Yn=Pn("WeakMap"),Zn=Pn("Set"),nr=Pn("WeakSet");!function(){Vn(arguments)||(Vn=function(n){return x(n,"callee")})}();var rr=n.document&&n.document.childNodes;function tr(n){return Un(n)&&p(n)}function er(n){return!0===n||!1===n||"[object Boolean]"===i.call(n)}function ur(n){return n}function or(n){return Kn(n)?function(r){return S(r,n)}:w(n)}function ir(n){return n=In({},n),function(r){return Wn(r,n)}}function ar(n,r){return null==r&&(r=n,n=0),n+Math.floor(Math.random()*(r-n+1))}"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof rr&&(Cn=function(n){return"function"==typeof n||!1});var fr=Date.now||function(){return(new Date).getTime()},cr={"&":"&amp;","<":"&lt;",">":"&gt;",\'"\':"&quot;","\'":"&#x27;","`":"&#x60;"},lr=Mn(cr);function pr(n){var r=function(r){return n[r]},t="(?:"+Sn(n).join("|")+")",e=RegExp(t),u=RegExp(t,"g");return function(n){return n=null==n?"":""+n,e.test(n)?n.replace(u,r):n}}var sr=pr(cr),vr=pr(lr);var hr=0;var yr=h.templateSettings={evaluate:/<%([\\s\\S]+?)%>/g,interpolate:/<%=([\\s\\S]+?)%>/g,escape:/<%-([\\s\\S]+?)%>/g},gr=/(.)^/,dr={"\'":"\'","\\\\":"\\\\","\\r":"r","\\n":"n","\\u2028":"u2028","\\u2029":"u2029"},mr=/\\\\|\'|\\r|\\n|\\u2028|\\u2029/g,br=function(n){return"\\\\"+dr[n]};function jr(n,r){return n._chain?h(r).chain():r}function _r(n){return E(En(n),function(r){var t=h[r]=n[r];h.prototype[r]=function(){var n=[this._wrapped];return u.apply(n,arguments),jr(this,t.apply(h,n))}}),h}E(["pop","push","reverse","shift","sort","splice","unshift"],function(n){var t=r[n];h.prototype[n]=function(){var r=this._wrapped;return t.apply(r,arguments),"shift"!==n&&"splice"!==n||0!==r.length||delete r[0],jr(this,r)}}),E(["concat","join","slice"],function(n){var t=r[n];h.prototype[n]=function(){return jr(this,t.apply(this._wrapped,arguments))}}),h.prototype.value=function(){return this._wrapped},h.prototype.valueOf=h.prototype.toJSON=h.prototype.value,h.prototype.toString=function(){return String(this._wrapped)};var wr=_r({default:h,VERSION:y,iteratee:m,restArguments:j,each:E,forEach:E,map:N,collect:N,reduce:I,foldl:I,inject:I,reduceRight:T,foldr:T,find:B,detect:B,filter:R,select:R,reject:function(n,r,t){return R(n,mn(b(r)),t)},every:F,all:F,some:q,any:q,contains:D,includes:D,include:D,invoke:W,pluck:z,where:function(n,r){return R(n,ir(r))},findWhere:function(n,r){return B(n,ir(r))},max:P,min:function(n,r,t){var e,u,o=1/0,i=1/0;if(null==r||"number"==typeof r&&"object"!=typeof n[0]&&null!=n)for(var a=0,f=(n=M(n)?n:On(n)).length;a<f;a++)null!=(e=n[a])&&e<o&&(o=e);else r=b(r,t),E(n,function(n,t,e){((u=r(n,t,e))<i||u===1/0&&o===1/0)&&(o=n,i=u)});return o},shuffle:function(n){return K(n,1/0)},sample:K,sortBy:function(n,r,t){var e=0;return r=b(r,t),z(N(n,function(n,t,u){return{value:n,index:e++,criteria:r(n,t,u)}}).sort(function(n,r){var t=n.criteria,e=r.criteria;if(t!==e){if(t>e||void 0===t)return 1;if(t<e||void 0===e)return-1}return n.index-r.index}),"value")},groupBy:V,indexBy:C,countBy:J,toArray:function(n){return n?Kn(n)?o.call(n):Jn(n)?n.match(U):M(n)?N(n,ur):On(n):[]},size:function(n){return null==n?0:M(n)?n.length:Sn(n).length},partition:$,first:G,head:G,take:G,initial:H,last:function(n,r,t){return null==n||n.length<1?null==r?void 0:[]:null==r||t?n[n.length-1]:Q(n,Math.max(0,n.length-r))},rest:Q,tail:Q,drop:Q,compact:function(n){return R(n,Boolean)},flatten:function(n,r){return X(n,r,!1)},without:Y,uniq:Z,unique:Z,union:nn,intersection:function(n){for(var r=[],t=arguments.length,e=0,u=O(n);e<u;e++){var o=n[e];if(!D(r,o)){var i;for(i=1;i<t&&D(arguments[i],o);i++);i===t&&r.push(o)}}return r},difference:rn,unzip:tn,zip:en,object:function(n,r){for(var t={},e=0,u=O(n);e<u;e++)r?t[n[e]]=r[e]:t[n[e][0]]=n[e][1];return t},findIndex:on,findLastIndex:an,sortedIndex:fn,indexOf:ln,lastIndexOf:pn,range:function(n,r,t){null==r&&(r=n||0,n=0),t||(t=r<n?-1:1);for(var e=Math.max(Math.ceil((r-n)/t),0),u=Array(e),o=0;o<e;o++,n+=t)u[o]=n;return u},chunk:function(n,r){if(null==r||r<1)return[];for(var t=[],e=0,u=n.length;e<u;)t.push(o.call(n,e,e+=r));return t},bind:vn,partial:hn,bindAll:yn,memoize:function(n,r){var t=function(e){var u=t.cache,o=""+(r?r.apply(this,arguments):e);return x(u,o)||(u[o]=n.apply(this,arguments)),u[o]};return t.cache={},t},delay:gn,defer:dn,throttle:function(n,r,t){var e,u,o,i,a=0;t||(t={});var f=function(){a=!1===t.leading?0:fr(),e=null,i=n.apply(u,o),e||(u=o=null)},c=function(){var c=fr();a||!1!==t.leading||(a=c);var l=r-(c-a);return u=this,o=arguments,l<=0||l>r?(e&&(clearTimeout(e),e=null),a=c,i=n.apply(u,o),e||(u=o=null)):e||!1===t.trailing||(e=setTimeout(f,l)),i};return c.cancel=function(){clearTimeout(e),a=0,e=u=o=null},c},debounce:function(n,r,t){var e,u,o=function(r,t){e=null,t&&(u=n.apply(r,t))},i=j(function(i){if(e&&clearTimeout(e),t){var a=!e;e=setTimeout(o,r),a&&(u=n.apply(this,i))}else e=gn(o,r,this,i);return u});return i.cancel=function(){clearTimeout(e),e=null},i},wrap:function(n,r){return hn(r,n)},negate:mn,compose:function(){var n=arguments,r=n.length-1;return function(){for(var t=r,e=n[r].apply(this,arguments);t--;)e=n[t].call(this,e);return e}},after:function(n,r){return function(){if(--n<1)return r.apply(this,arguments)}},before:bn,once:jn,keys:Sn,allKeys:An,values:On,mapObject:function(n,r,t){r=b(r,t);for(var e=Sn(n),u=e.length,o={},i=0;i<u;i++){var a=e[i];o[a]=r(n[a],a,n)}return o},pairs:function(n){for(var r=Sn(n),t=r.length,e=Array(t),u=0;u<t;u++)e[u]=[r[u],n[r[u]]];return e},invert:Mn,functions:En,methods:En,extend:kn,extendOwn:In,assign:In,findKey:Tn,pick:Rn,omit:Fn,defaults:qn,create:function(n,r){var t=_(n);return r&&In(t,r),t},clone:Dn,tap:function(n,r){return r(n),n},isMatch:Wn,isEqual:function(n,r){return zn(n,r)},isEmpty:function(n){return null==n||(M(n)&&(Kn(n)||Jn(n)||Vn(n))?0===n.length:0===Sn(n).length)},isElement:function(n){return!(!n||1!==n.nodeType)},isArray:Kn,isObject:Ln,isArguments:Vn,isFunction:Cn,isString:Jn,isNumber:Un,isDate:$n,isRegExp:Gn,isError:Hn,isSymbol:Qn,isMap:Xn,isWeakMap:Yn,isSet:Zn,isWeakSet:nr,isFinite:function(n){return!Qn(n)&&s(n)&&!p(parseFloat(n))},isNaN:tr,isBoolean:er,isNull:function(n){return null===n},isUndefined:function(n){return void 0===n},has:function(n,r){if(!Kn(r))return x(n,r);for(var t=r.length,e=0;e<t;e++){var u=r[e];if(null==n||!a.call(n,u))return!1;n=n[u]}return!!t},identity:ur,constant:function(n){return function(){return n}},noop:function(){},property:or,propertyOf:function(n){return null==n?function(){}:function(r){return Kn(r)?S(n,r):n[r]}},matcher:ir,matches:ir,times:function(n,r,t){var e=Array(Math.max(0,n));r=g(r,t,1);for(var u=0;u<n;u++)e[u]=r(u);return e},random:ar,now:fr,escape:sr,unescape:vr,result:function(n,r,t){Kn(r)||(r=[r]);var e=r.length;if(!e)return Cn(t)?t.call(n):t;for(var u=0;u<e;u++){var o=null==n?void 0:n[r[u]];void 0===o&&(o=t,u=e),n=Cn(o)?o.call(n):o}return n},uniqueId:function(n){var r=++hr+"";return n?n+r:r},templateSettings:yr,template:function(n,r,t){!r&&t&&(r=t),r=qn({},r,h.templateSettings);var e,u=RegExp([(r.escape||gr).source,(r.interpolate||gr).source,(r.evaluate||gr).source].join("|")+"|$","g"),o=0,i="__p+=\'";n.replace(u,function(r,t,e,u,a){return i+=n.slice(o,a).replace(mr,br),o=a+r.length,t?i+="\'+\\n((__t=("+t+"))==null?\'\':_.escape(__t))+\\n\'":e?i+="\'+\\n((__t=("+e+"))==null?\'\':__t)+\\n\'":u&&(i+="\';\\n"+u+"\\n__p+=\'"),r}),i+="\';\\n",r.variable||(i="with(obj||{}){\\n"+i+"}\\n"),i="var __t,__p=\'\',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,\'\');};\\n"+i+"return __p;\\n";try{e=new Function(r.variable||"obj","_",i)}catch(n){throw n.source=i,n}var a=function(n){return e.call(this,n,h)},f=r.variable||"obj";return a.source="function("+f+"){\\n"+i+"}",a},chain:function(n){var r=h(n);return r._chain=!0,r},mixin:_r});return wr._=wr,wr});\ndefine(\'core/math/distance\',["require","exports"],function(require,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.halfRound=t.approx=t.pointToSegment=t.closestPointOnSegment=t.pointToSegmentParameter=t.mean=t.hypot=void 0;var n=Math.hypot&&Math.hypot(1/0,NaN)===1/0;function r(t){return t===1/0||t===-1/0}function e(n,r,e,o,a,i,u,h,f){var p=t.hypot(u-o,h-a,f-i);return 0===p?0:function(t,n,r,e,o,a){return t*e+n*o+r*a}((n-o)/p,(r-a)/p,(e-i)/p,(u-o)/p,(h-a)/p,(f-i)/p)}function o(t,n,r,o,a,i){var u=e(t,n,0,r,o,0,a,i,0);return u<=0?[r,o]:u>=1?[a,i]:[r+u*(a-r),o+u*(i-o)]}t.hypot=n?Math.hypot:function(t,n,e){if(r(t)||r(n)||void 0!==e&&r(e))return 1/0;if(isNaN(t)||isNaN(n)||void 0!==e&&isNaN(e))return NaN;if(0===t&&0===n&&(void 0===e||0===e))return 0;for(var o=0,a=0,i=0;i<arguments.length;i+=1){var u=Math.abs(Number(arguments[i]));u>o&&(a*=o/u*(o/u),o=u),a+=0===u&&0===o?0:u/o*(u/o)}return o===1/0?1/0:o*Math.sqrt(a)},t.mean=function(t,n){return t>0==n>0?t+.5*(n-t):.5*(t+n)},t.pointToSegmentParameter=e,t.closestPointOnSegment=o,t.pointToSegment=function(n,r,e,a,i,u){var h=o(n,r,e,a,i,u);return t.hypot(n-h[0],r-h[1])},t.approx=function(t,n,r){if(void 0===r&&(r=1),t===n)return!0;if(!isFinite(t)||!isFinite(n))return!1;if(r>50)throw new Error("Within "+(52-r)+" bits isn\'t really approximate any more");var e=Math.max(Math.max(Math.abs(t),Math.abs(n)),1);return e===e+(1===r?.5:Math.pow(.5,r))*Math.abs(n-t)},t.halfRound=function(t){return Math.round(t-.5)+.5}});\ndefine(\'core/math/tofraction\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,r){if(void 0===r&&(r=1e6),e===1/0)return{n:1/0,d:1};if(e===-1/0)return{n:-1/0,d:1};if(!isFinite(e))return{n:NaN,d:1};for(var n,t,i,u=0,f=1,d=1,o=0;!(t=(n=Math.floor(e))*f+u,(i=n*o+d)>r||(u=f,d=o,f=t,o=i,e===n));)e=1/(e-n);return{n:f,d:o}}});\ndefine(\'core/lib/label\',["require","exports","underscore","core/math/distance","core/math/tofraction"],function(require,e,t,n,r){"use strict";function a(e,t){if(void 0===t&&(t=e),isNaN(e)||!isFinite(e))return{ariaString:"undefined",string:"undefined",value:e};if(0===e)return{ariaString:"0",string:"0",value:e};Math.abs(e)>Math.abs(t)&&(t=e);var a,i=r.default(e/Math.PI,24);if(m(t)&&n.approx(i.n/i.d*Math.PI,e,3))return{ariaString:f(a=(0===i.n?"0":1===i.n?"Ï":-1===i.n?"-Ï":i.n.toString()+"Ï")+(1===i.d?"":"/"+i.d.toString())),string:a,value:i.n/i.d*Math.PI};if(m(t))return{ariaString:f(a=function(e){return"-0"===e?"0":e}(l(e.toFixed(v(t))))),string:a,value:parseFloat(a)};var u=p(e.toExponential(v(t/e))).split("e"),o=u[0]+"Ã10",c=u[1].replace("+","");return{ariaString:f(a=p(e.toExponential(v(t/e))).replace("+","")),string:a,mantissa:o,superscript:c,value:parseFloat(a)}}Object.defineProperty(e,"__esModule",{value:!0}),e.trimLatex=e.latexToIdentifier=e.identifierToHTML=e.identifierToLatex=e.formatSymbol=e.truncatedAriaLabel=e.truncatedLatexLabel=e.truncatedPlainmathLabel=e.truncatedHTMLLabel=e.numericLabel=e.canDisplayAsFraction=e.point=e.value=void 0,e.value=a;var i={"[e]":" times 10 to the ","[+]":" plus ","[-]":" minus ","[*]":" times ","[/]":" over ","[Ï]":" pi ","[Ï]":" tau ","[Î¸]":" theta ","[Ï]":" phi "},u=new RegExp(Object.keys(i).join("|"),"gi");function o(e){return i["["+e+"]"]}var c=/(\\.)([0-9]+)/g;function s(e,t,n){return t+n.split("").join(" ").trim()}function f(e){return e.replace(c,s).replace(u,o).replace(/ +/gi," ").trim()}e.point=function(e,t,n,r){var i=a(e,t);return[i,a(r(i.value),n)]};var d=/\\.?0+$/;function l(e){return-1===e.indexOf(".")?e:e.replace(d,"")}function p(e){return e.replace(/\\.?0+e/,"e")}function m(e){return 1e-4<(e=Math.abs(e))&&e<1e7}function v(e){return e=Math.abs(e),e=Math.max(e,1e-16),Math.max(3,Math.floor(4.5-Math.log(e)/Math.LN10))}function h(e){return 1e6/Math.sqrt(Math.abs(e))}function b(e){var t=h(e);if(t<1)return!1;if(t>1e12)return!1;var n=r.default(e,t),a=n.n,i=n.d;return 1!==i&&e===e+Math.pow(2,-3)*Math.abs(a/i-e)}function g(e,t){if(t=t||{},isNaN(e)||!isFinite(e))return{type:"undefined"};if(0===e||t.zeroCutoff&&Math.abs(e)<t.zeroCutoff)return{type:"decimal",value:"0"};var n=t.smallCutoff||.001,a=t.bigCutoff||1e6,i=t.digits||10,u=p(e.toExponential(i-2)).match(/([\\d\\.\\-]+)e\\+?([\\d\\-]+)/);if(!u)return{type:"undefined"};var o=parseInt(u[2],10)>=i;if(b(e)&&t.displayAsFraction){var c=r.default(e,h(e));return{type:"fraction",numerator:c.n.toString(),denominator:c.d.toString()}}if(Math.abs(e)>a||Math.abs(e)<n||o)return{type:"scientific",mantissa:u[1],exponent:u[2]};var s=l(e.toPrecision(i));return e!==Number(s)&&t.addEllipses&&(s+="..."),{type:"decimal",value:s}}function x(e){e=e.replace("\\\\","");var t={pi:"Ï",tau:"Ï",theta:"Î¸",phi:"Ï",div:"Ã·",cdot:"â",times:"Ã",lt:"<",gt:">",le:"â¤",ge:"â¥",sim:"â¼",ldots:"â¦",prime:"â²",approx:"â",to:"â","->":"â"};return t.hasOwnProperty(e)?t[e]:e}e.canDisplayAsFraction=b,e.numericLabel=g,e.truncatedHTMLLabel=function(e,t){var n=g(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return n.value;case"scientific":return n.mantissa+"<span class=\'dcg-cross\'>Ã</span>10<sup>"+n.exponent+"</sup>";case"fraction":return"1"===n.denominator?n.numerator:n.numerator+"/"+n.denominator;default:return n}},e.truncatedPlainmathLabel=function(e,t){var n=g(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return n.value;case"scientific":return n.mantissa+" * 10^"+n.exponent;case"fraction":return"1"===n.denominator?n.numerator:n.numerator+"/"+n.denominator;default:return n}},e.truncatedLatexLabel=function(e,t){var n=g(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return n.value;case"scientific":return n.mantissa+"\\\\times10^{"+n.exponent+"}";case"fraction":return"1"===n.denominator?n.numerator:"-"===n.numerator[0]?"-\\\\frac{"+n.numerator.slice(1)+"}{"+n.denominator+"}":"\\\\frac{"+n.numerator+"}{"+n.denominator+"}";default:return n}},e.truncatedAriaLabel=function(e,t){var n=g(e,t);switch(n.type){case"undefined":return"undefined";case"decimal":return f(n.value);case"scientific":return f(n.mantissa+"e"+n.exponent);case"fraction":return f(n.numerator+"/"+n.denominator);default:return n}},e.formatSymbol=x,e.identifierToLatex=function(e){var t=e.match(/^\\$(\\d+)$/);if(t)return"\\\\token{"+t[1]+"}";var n=e.split("_"),r="";return n[0].length>1&&(r+="\\\\"),r+=n[0],n[1]&&(r+="_{"+n[1]+"}"),r},e.identifierToHTML=function(e){if(!e)return"";var n=e.split("_").map(x).map(t.escape),r=n[0];return n[1]&&(r+="<sub>"+n[1]+"</sub>"),r},e.latexToIdentifier=function(e){var t=e.match(/\\\\token\\{(\\d+)\\}/);return t?"$"+t[1]:(e=e.replace(/\\\\operatorname\\{(.*)\\}/,"$1")).replace(/[{}\\\\]/g,"")},e.trimLatex=function(e){return e.replace(/^(\\\\ | |\\\\space)+/,"").replace(/(\\\\ | |\\\\space)+$/,"")}});\ndefine(\'core/math/errormsg\',["require","exports","core/math/parsenode/error","core/lib/worker-i18n","core/lib/label","core/math/types"],function(require,r,e,o,n,t){"use strict";function a(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-multiply-defined",{dependency:r}))}function i(r){var t=(r=r.map(n.formatSymbol)).pop()||"";return e(o.s("shared-calculator-error-dependency-cycle",{symbols:r.join("\', \'"),lastSymbol:t}))}Object.defineProperty(r,"__esModule",{value:!0}),r.variableLengthProductBodyDependsOnIndex=r.variableLengthSumBodyDependsOnIndex=r.variableLengthDistributionList=r.variableLengthTopLevelList=r.badListComprehensionInputDependency=r.shadowedListComprehensionInput=r.unexpectedForKeyword=r.listComprehensionIncorrectInput=r.listComprehensionInputListTypeError=r.matrixInvalidVariable=r.matrixElementTypeError=r.matrixPowerDimensions=r.matrixFractionalPower=r.matrixMultiplyDimensions=r.matrixSubtractDimensions=r.matrixAddDimensions=r.matrixAssignment=r.clickableObjectInvalidExpression=r.clickableObjectAssignmentNotIdentifier=r.clickableObjectAlreadyAssigned=r.clickableObjectAssignmentNotDefined=r.singularInverse=r.nonSquareInverse=r.nonSquareTrace=r.nonSquareDeterminant=r.fractionsUnavailable=r.featureUnavailable=r.pointsUnsupported=r.regressionsUnsupported=r.inequalitiesUnsupported=r.equationsUnsupported=r.functionDefinitionsUnsupported=r.assignmentsUnsupported=r.variableUnsupported=r.constantUnsupported=r.logbaseUnsupported=r.functionUnsupported=r.variablesUnsupported=r.ansUndefined=r.badSymbolContext=r.variableSeed=r.badSampleSize=r.ttestListTooShort=r.illegalBinWidth=r.percentMissingOf=r.badIntegralBoundDependency=r.shadowedIntegrationVariable=r.mismatchedBraces=r.derivativeMissingBody=r.integralMissingBody=r.productMissingBody=r.sumMissingBody=r.differentialWithSuperscript=r.integralMissingDifferential=r.integralMissingBound=r.badProductBoundDependency=r.badSumBoundDependency=r.incorrectProductLowerBound=r.incorrectSumLowerBound=r.productMissingBound=r.sumMissingBound=r.invalidHalfEmptyRange=r.nonArithmeticRange=r.functionFreeVariable=r.methodRequiresList=r.nonListParameterizedReducer=r.nonListDoubleReducer=r.optimizationError=r.invalidRegressionParameter=r.invalidDependentFirstTableColumn=r.invalidFirstTableColumn=r.invalidTableEntry=r.invalidTableHeader=r.distributionAsFunction=r.variableAsFunction=r.equationRequired=r.complicatedDoubleInequality=r.mismatchedDoubleInequality=r.invalidDoubleInequalityVariables=r.complicatedPolarImplicit=r.inequalitiesDisabled=r.implicitsDisabled=r.singleVariableImplicitEquationsDisabled=r.invalidImplicitVariables=r.invalidInequalityVariables=r.unplottablePolarFunction=r.invalidLHS=r.addArgumentsToDefinition=r.tooManyVariables=r.cdfMaxLessThanMin=r.cdfMaxInvalid=r.cdfMinInvalid=r.domainMaxLessThanMin=r.domainMaxInvalid=r.domainMinInvalid=r.sliderStepInvalid=r.sliderMaxLessThanMin=r.sliderMaxInvalid=r.sliderMinInvalid=r.sliderLimitReferencesExport=r.tickerMinStepNonNegativeNumber=r.selfReferentialFunction=r.tableCycleWithoutGlobalDefinition=r.cycle=r.shadowedIndex=r.multiplyDefinedByTables=r.multiplyDefined=r.cannotSubscript=r.cannotRedefine=r.parameterAlreadyDefined=r.functionNotDefined=r.blankExpression=r.colonMissingCondition=r.piecewisePartMissingCondition=r.piecewiseMissingCondition=r.inequalityChainTooLong=r.badLogExponent=r.badTrigExponent=r.emptyPipe=r.emptySquareBracket=r.emptyParen=r.emptyRadicalIndex=r.emptyRadical=r.primeWithoutParen=r.unexpectedPrime=r.superscriptWithPrime=r.unexpectedSubscript=r.invalidOperatorName=r.invalidSubscript=r.emptySuperscript=r.emptySubscript=r.fractionEmpty=r.fractionMissingDenominator=r.fractionMissingNumerator=r.unaryOperatorMissingRight=r.unaryOperatorMissingLeft=r.binaryOperatorMissingOperand=r.identifierAsFunction=r.tokenWithSubscript=r.adjacentNumbers=r.badImplicitCall=r.badTupleDimensions=r.malformedList=r.malformedPoint=r.zeroArgReducer=r.primedFunctionArity=r.wrongDoubleReducerArity=r.wrongParameterizedReducerArity=r.wrongArity=r.colorArity=r.randomFromBroadcastDistribution=r.randomArity=r.tdistWrongArity=r.cdfTooManyArguments=r.cdfRequiresArguments=r.pdfWrongArity=r.tooManyArguments=r.boxplotBreadthInvalid=r.boxplotOffsetInvalid=r.polygonTwoNumbersError=r.polygonPointArgsError=r.polygonListTypeError=r.maxListSize=r.deeplyNested=r.combineTypeError=r.heterogeneousList=r.eventHandlerTypeError=r.actionMergeFreeVariable=r.updateRuleLocalLHS=r.updateRuleFunctionLHS=r.updateRuleIllegalLHS=r.updateRuleUndefinedLHS=r.duplicateUpdateRules=r.updateRuleNonIdentifierLHS=r.updateRuleTypeError=r.regressionTypeError=r.tableEntryTypeError=r.tableHeaderTypeError=r.piecewiseBranchTypeError=r.piecewiseConditionTypeError=r.derivativeVariableTypeError=r.derivativeTypeError=r.integralArgumentTypeError=r.integralUpperBoundTypeError=r.integralLowerBoundTypeError=r.productArgumentTypeError=r.productInfiniteBoundError=r.productUpperBoundTypeError=r.productLowerBoundTypeError=r.sumArgumentTypeError=r.sumInfiniteBoundError=r.sumUpperBoundTypeError=r.sumLowerBoundTypeError=r.dotLHSTypeError=r.illegalDotCall=r.functionTypeError=r.orderedPairAccessTypeError=r.indexTypeError=r.pointTypeError=r.listTypeError=r.andTypeError=r.comparatorTypeError=r.negativeTypeError=r.exponentTypeError=r.divideTypeError=r.multiplyTypeError=r.subtractTypeError=r.addTypeError=r.unexpectedSymbol=r.unexpectedInequality=r.unrecognizedSymbol=r.parseError=void 0,r.parseError=function(){return e(o.s("shared-calculator-error-parse-error"))},r.unrecognizedSymbol=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-unrecognized-symbol",{symbol:r}))},r.unexpectedInequality=function(){return e(o.s("shared-calculator-error-unexpected-inequality"))},r.unexpectedSymbol=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-unexpected-symbol",{symbol:r}))},r.addTypeError=function(r){return e(o.s("shared-calculator-error-add-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.subtractTypeError=function(r){return e(o.s("shared-calculator-error-subtract-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.multiplyTypeError=function(r){return e(o.s("shared-calculator-error-multiply-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.divideTypeError=function(r){return e(o.s("shared-calculator-error-divide-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.exponentTypeError=function(r){return e(o.s("shared-calculator-error-exponent-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.negativeTypeError=function(r){return e(o.s("shared-calculator-error-negative-type-error",{symbol:r[0]})).allowExport()},r.comparatorTypeError=function(r){return e(o.s("shared-calculator-error-comparator-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.andTypeError=function(r){return e(o.s("shared-calculator-error-and-type-error",{symbol:"and",symbol1:r[0],symbol2:r[1]})).allowExport()},r.listTypeError=function(r){return e(o.s("shared-calculator-error-list-type-error",{symbol1:r[0]})).allowExport()},r.pointTypeError=function(r){return e(o.s("shared-calculator-error-point-type-error",{symbol1:r,symbol2:t.prettyPrint(t.Point)})).allowExport()},r.indexTypeError=function(r){return e(o.s("shared-calculator-error-index-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.orderedPairAccessTypeError=function(r){return e(o.s("shared-calculator-error-ordered-pair-access-type-error",{symbol:r[0]})).allowExport()},r.functionTypeError=function(r,t){switch(t.length){case 1:return e(o.s("shared-calculator-error-function-type-error-1",{fn:n.formatSymbol(r),arg:t[0]})).allowExport();case 2:return e(o.s("shared-calculator-error-function-type-error-2",{fn:n.formatSymbol(r),arg1:t[0],arg2:t[1]})).allowExport();default:return e(o.s("shared-calculator-error-function-type-error-many",{fn:n.formatSymbol(r)})).allowExport()}},r.illegalDotCall=function(r){return e(o.s("shared-calculator-error-illegal-dot-call",{symbol:n.formatSymbol(r)}))},r.dotLHSTypeError=function(r,t){return e(o.s("shared-calculator-error-dot-lhs-type-error",{symbol:n.formatSymbol(r),type:t})).allowExport()},r.sumLowerBoundTypeError=function(r){return e(o.s("shared-calculator-error-sum-lower-bound-type-error",{symbol:r[0]})).allowExport()},r.sumUpperBoundTypeError=function(r){return e(o.s("shared-calculator-error-sum-upper-bound-type-error",{symbol:r[0]})).allowExport()},r.sumInfiniteBoundError=function(){return e(o.s("shared-calculator-error-sum-infinite-bound-type-error"))},r.sumArgumentTypeError=function(r){return e(o.s("shared-calculator-error-sum-argument-type-error",{symbol:r[0]})).allowExport()},r.productLowerBoundTypeError=function(r){return e(o.s("shared-calculator-error-product-lower-bound-type-error",{symbol:r[0]})).allowExport()},r.productUpperBoundTypeError=function(r){return e(o.s("shared-calculator-error-product-upper-bound-type-error",{symbol:r[0]})).allowExport()},r.productInfiniteBoundError=function(){return e(o.s("shared-calculator-error-product-infinite-bound-type-error"))},r.productArgumentTypeError=function(r){return e(o.s("shared-calculator-error-product-argument-type-error",{symbol:r[0]})).allowExport()},r.integralLowerBoundTypeError=function(r){return e(o.s("shared-calculator-error-integral-lower-bound-type-error",{symbol:r[0]})).allowExport()},r.integralUpperBoundTypeError=function(r){return e(o.s("shared-calculator-error-integral-upper-bound-type-error",{symbol:r[0]})).allowExport()},r.integralArgumentTypeError=function(r){return e(o.s("shared-calculator-error-integral-argument-type-error",{symbol:r[0]})).allowExport()},r.derivativeTypeError=function(r){return e(o.s("shared-calculator-error-derivative-type-error",{symbol:r[0]})).allowExport()},r.derivativeVariableTypeError=function(r,t){return e(o.s("shared-calculator-error-derivative-variable-type-error",{symbol1:n.formatSymbol(r),symbol2:t[0]}))},r.piecewiseConditionTypeError=function(r){return e(o.s("shared-calculator-error-piecewise-condition-type-error",{symbol1:t.prettyPrint(t.Bool),symbol2:r[0]})).allowExport()},r.piecewiseBranchTypeError=function(r){return e(o.s("shared-calculator-error-piecewise-branch-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.tableHeaderTypeError=function(r){return e(o.s("shared-calculator-error-table-header-type-error",{symbol:r[0]}))},r.tableEntryTypeError=function(r){return e(o.s("shared-calculator-error-table-entry-type-error",{symbol:r[0]}))},r.regressionTypeError=function(r){return e(o.s("shared-calculator-error-regression-type-error",{symbol1:r[0],symbol2:r[1]}))},r.updateRuleTypeError=function(r){return e(o.s("shared-calculator-error-update-rule-type-error",{symbol:r}))},r.updateRuleNonIdentifierLHS=function(){return e(o.s("shared-calculator-error-update-rule-non-identifier-lhs",{arrow:"â",example:"a"}))},r.duplicateUpdateRules=function(r){return e(o.s("shared-calculator-error-duplicate-update-rules",{symbol:n.formatSymbol(r)}))},r.updateRuleUndefinedLHS=function(r){return e(o.s("shared-calculator-error-update-rule-undefined-lhs",{symbol:n.formatSymbol(r)}))},r.updateRuleIllegalLHS=function(r){return e(o.s("shared-calculator-error-update-rule-illegal-lhs",{symbol:n.formatSymbol(r)}))},r.updateRuleFunctionLHS=function(r){return e(o.s("shared-calculator-error-update-rule-function-lhs",{symbol:n.formatSymbol(r)}))},r.updateRuleLocalLHS=function(r){return e(o.s("shared-calculator-error-update-rule-local-lhs",{symbol:n.formatSymbol(r)}))},r.actionMergeFreeVariable=function(r){var t=r.filter(function(r){return"free"===r.scope}).map(function(r){return r.symbol});return e(o.s("shared-calculator-error-action-merge-free-variable",{symbol:n.formatSymbol(t[0]||"")})).setDependencies(t).allowExport()},r.eventHandlerTypeError=function(r){return e(o.s("shared-calculator-error-event-handler-type-error",{example:"aâa+1"}))},r.heterogeneousList=function(){return e(o.s("shared-calculator-error-heterogeneous-list")).allowExport()},r.combineTypeError=function(r){return e(o.s("shared-calculator-error-combine-type-error",{symbol1:r[0],symbol2:r[1]})).allowExport()},r.deeplyNested=function(){return e(o.s("shared-calculator-error-deeply-nested")).allowExport()},r.maxListSize=function(r){return e(o.s("shared-calculator-error-max-list-size",{maxListSize:r})).allowExport()},r.polygonListTypeError=function(r){return e(o.s("shared-calculator-error-polygon-list-type-error",{type:r[0]}))},r.polygonPointArgsError=function(){return e(o.s("shared-calculator-error-polygon-point-args-error"))},r.polygonTwoNumbersError=function(){return e(o.s("shared-calculator-error-two-numbers-error"))},r.boxplotOffsetInvalid=function(){return e(o.s("shared-calculator-error-boxplot-offset-invalid"))},r.boxplotBreadthInvalid=function(){return e(o.s("shared-calculator-error-boxplot-breadth-invalid"))},r.tooManyArguments=function(r,n){return e(o.s("shared-calculator-error-too-many-arguments",{symbol:r,max:n}))},r.pdfWrongArity=function(){var r=o.s("shared-calculator-error-pdf-wrong-arity-recommendation"),n=o.s("shared-calculator-error-pdf-wrong-arity",{recommendation:r});return e(n)},r.cdfRequiresArguments=function(){var r=o.s("shared-calculator-error-cdf-wrong-arity-recommendation"),n=o.s("shared-calculator-error-cdf-wrong-arity",{recommendation:r});return e(n)},r.cdfTooManyArguments=function(){var r=o.s("shared-calculator-error-cdf-too-many-arguments-recommendation"),n=o.s("shared-calculator-error-cdf-too-many-arguments",{recommendation:r});return e(n)},r.tdistWrongArity=function(){return e(o.s("shared-calculator-error-tdist-wrong-arity"))},r.randomArity=function(){return e(o.s("shared-calculator-error-random-arity"))},r.randomFromBroadcastDistribution=function(){return e(o.s("shared-calculator-error-random-from-broadcast-distribution"))},r.colorArity=function(r){var t="rgb"===r?[150,30,100]:[180,.5,.5],a=o.s("shared-calculator-error-color-arity-recommendation",{recommendation:n.formatSymbol(r)+"("+t.join(", ")+")"}),i=o.s("shared-calculator-error-color-arity",{symbol:r,recommendation:a});return e(i)},r.wrongArity=function(r,t,a,i){var l,s;if(r=n.formatSymbol(r),1===t)i||(i=r+"(x)"),s=o.s("shared-calculator-error-wrong-arity-supplement",{recommendation:i}),l=a>1?o.s("shared-calculator-error-wrong-arity-single-arg-too-many",{dependency:r,supplement:s}):o.s("shared-calculator-error-wrong-arity-single-arg-too-few",{dependency:r,supplement:s});else{var u=[];if(!i){for(var c=0;c<t;c++)u[c]=c+1;i=n.formatSymbol(r)+"("+u.join(", ")+")"}s=o.s("shared-calculator-error-wrong-arity-supplement",{recommendation:i}),l=o.s("shared-calculator-error-wrong-arity-many-arg",{dependency:r,assignment_arity:t,supplement:s})}return e(l)},r.wrongParameterizedReducerArity=function(r){return e(o.s("shared-calculator-error-wrong-two-arg-arity",{symbol:n.formatSymbol(r),recommendation:n.formatSymbol(r)+"([1,2,3], 1)"}))},r.wrongDoubleReducerArity=function(r){return e(o.s("shared-calculator-error-wrong-two-arg-arity",{symbol:n.formatSymbol(r),recommendation:n.formatSymbol(r)+"([1,2,3], [3,2,1])"}))},r.primedFunctionArity=function(){return e(o.s("shared-calculator-error-primed-function-arity"))},r.zeroArgReducer=function(r){return e(o.s("shared-calculator-error-zero-arg-reducer",{symbol:n.formatSymbol(r)}))},r.malformedPoint=function(){return e(o.s("shared-calculator-error-malformed-point"))},r.malformedList=function(){return e(o.s("shared-calculator-error-malformed-list"))},r.badTupleDimensions=function(r){return e(o.s("shared-calculator-error-bad-tuple-dimensions",{symbol:r}))},r.badImplicitCall=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-bad-implicit-call",{symbol:r}))},r.adjacentNumbers=function(r,n){return e(o.s("shared-calculator-error-adjacent-numbers",{left:r,right:n}))},r.tokenWithSubscript=function(){return e(o.s("shared-calculator-error-token-with-subscript"))},r.identifierAsFunction=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-identifier-as-function",{symbol:r}))},r.binaryOperatorMissingOperand=function(r){return"%"===(r=n.formatSymbol(r))&&(r="% of"),e(o.s("shared-calculator-error-binary-operator-missing-operand",{symbol:r}))},r.unaryOperatorMissingLeft=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-unary-operator-missing-left",{symbol:r}))},r.unaryOperatorMissingRight=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-unary-operator-missing-right",{symbol:r}))},r.fractionMissingNumerator=function(){return e(o.s("shared-calculator-error-fraction-missing-numerator"))},r.fractionMissingDenominator=function(){return e(o.s("shared-calculator-error-fraction-missing-denominator"))},r.fractionEmpty=function(){return e(o.s("shared-calculator-error-fraction-empty"))},r.emptySubscript=function(){return e(o.s("shared-calculator-error-empty-subscript"))},r.emptySuperscript=function(){return e(o.s("shared-calculator-error-empty-superscript"))},r.invalidSubscript=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-invalid-subscript",{symbol:r}))},r.invalidOperatorName=function(){return e(o.s("shared-calculator-error-invalid-operator-name"))},r.unexpectedSubscript=function(){return e(o.s("shared-calculator-error-unexpected-subscript"))},r.superscriptWithPrime=function(){return e(o.s("shared-calculator-error-superscript-with-prime"))},r.unexpectedPrime=function(){return e(o.s("shared-calculator-error-unexpected-prime"))},r.primeWithoutParen=function(){return e(o.s("shared-calculator-error-prime-without-paren"))},r.emptyRadical=function(){return e(o.s("shared-calculator-error-empty-radical"))},r.emptyRadicalIndex=function(){return e(o.s("shared-calculator-error-empty-radical-index"))},r.emptyParen=function(){return e(o.s("shared-calculator-error-empty-paren"))},r.emptySquareBracket=function(){return e(o.s("shared-calculator-error-empty-square-bracket"))},r.emptyPipe=function(){return e(o.s("shared-calculator-error-empty-pipe"))},r.badTrigExponent=function(r){var n=r+"^2",t=r+"^-1";return e(o.s("shared-calculator-error-bad-trig-exponent",{form1:n,form2:t}))},r.badLogExponent=function(r){var n=r+"^2";return e(o.s("shared-calculator-error-bad-log-exponent",{form:n}))},r.inequalityChainTooLong=function(){return e(o.s("shared-calculator-error-inequality-chain-too-long"))},r.piecewiseMissingCondition=function(){return e(o.s("shared-calculator-error-piecewise-missing-condition"))},r.piecewisePartMissingCondition=function(){return e(o.s("shared-calculator-error-piecewise-part-missing-condition"))},r.colonMissingCondition=function(){return e(o.s("shared-calculator-error-colon-missing-condition"))},r.blankExpression=function(){return e(o.s("shared-calculator-error-blank-expression"))},r.functionNotDefined=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-function-not-defined",{dependency:r}))},r.parameterAlreadyDefined=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-parameter-already-defined",{dependency:r}))},r.cannotRedefine=function(r,t){return r=n.formatSymbol(r),e(void 0===t?o.s("shared-calculator-error-cannot-redefine",{symbol:r}):o.s("shared-calculator-error-cannot-redefine-root",{symbol:r,symbolRoot:t}))},r.cannotSubscript=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-cannot-subscript",{symbol:r}))},r.multiplyDefined=a,r.multiplyDefinedByTables=function(r){var e=a(r);return e.isMultiplyDefinedByTables=!0,e},r.shadowedIndex=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-shadowed-index",{symbol:r}))},r.cycle=i,r.tableCycleWithoutGlobalDefinition=function(r){var e=i(r);return e.isTableCycleWithoutGlobalDefinition=!0,e},r.selfReferentialFunction=function(r){return e(o.s("shared-calculator-error-self-referential-function",{symbol:n.formatSymbol(r)}))},r.tickerMinStepNonNegativeNumber=function(){return e(o.s("shared-calculator-error-ticker-min-step-nonnegative"))},r.sliderLimitReferencesExport=function(r){return e(o.s("shared-calculator-error-slider-limit-references-export",{symbol:n.formatSymbol(r)}))},r.sliderMinInvalid=function(){return e(o.s("shared-calculator-error-slider-min-invalid"))},r.sliderMaxInvalid=function(){return e(o.s("shared-calculator-error-slider-max-invalid"))},r.sliderMaxLessThanMin=function(){return e(o.s("shared-calculator-error-slider-max-less-than-min"))},r.sliderStepInvalid=function(){return e(o.s("shared-calculator-error-slider-step-invalid"))},r.domainMinInvalid=function(){return e(o.s("shared-calculator-error-domain-min-invalid"))},r.domainMaxInvalid=function(){return e(o.s("shared-calculator-error-domain-max-invalid"))},r.domainMaxLessThanMin=function(){return e(o.s("shared-calculator-error-domain-max-less-than-min"))},r.cdfMinInvalid=function(){return e(o.s("shared-calculator-error-cdf-min-invalid"))},r.cdfMaxInvalid=function(){return e(o.s("shared-calculator-error-cdf-max-invalid"))},r.cdfMaxLessThanMin=function(){return e(o.s("shared-calculator-error-cdf-max-less-than-min"))},r.tooManyVariables=function(r){if(0===(r=r.map(n.formatSymbol)).length)return e(o.s("shared-calculator-error-too-many-variables-no-symbols"));var t=r.pop()||"";return r.length>0?e(o.s("shared-calculator-error-too-many-variables-many-symbols",{variables:r.join("\', \'"),lastVariable:t})):e(o.s("shared-calculator-error-too-many-variables-one-symbol",{variable:t}))},r.addArgumentsToDefinition=function(r,t,a){r=r.map(n.formatSymbol);var i=(t=n.formatSymbol(t))+"("+(a=a.map(n.formatSymbol)).join(",")+","+r.join(",")+")",l=r.pop()||"",s={symbols:r.join("\', \'"),lastSymbol:l,newSignature:i};return r.length?e(o.s("shared-calculator-error-add-arguments-to-definition-many",s)):e(o.s("shared-calculator-error-add-arguments-to-definition-one",s))},r.invalidLHS=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-invalid-lhs",{symbol:r}))},r.unplottablePolarFunction=function(){return e(o.s("shared-calculator-error-unplottable-polar-function"))},r.invalidInequalityVariables=function(){return e(o.s("shared-calculator-error-invalid-inequality-variables"))},r.invalidImplicitVariables=function(){return e(o.s("shared-calculator-error-invalid-implicit-variables"))},r.singleVariableImplicitEquationsDisabled=function(){return e(o.s("shared-calculator-error-single-variable-implicit-equations-disabled"))},r.implicitsDisabled=function(){return e(o.s("shared-calculator-error-implicits-disabled"))},r.inequalitiesDisabled=function(){return e(o.s("shared-calculator-error-inequalities-disabled"))},r.complicatedPolarImplicit=function(){return e(o.s("shared-calculator-error-complicated-polar-implicit"))},r.invalidDoubleInequalityVariables=function(){return e(o.s("shared-calculator-error-invalid-double-inequality-variables"))},r.mismatchedDoubleInequality=function(){return e(o.s("shared-calculator-error-mismatched-double-inequality",{example:"1 < y < 2"}))},r.complicatedDoubleInequality=function(){return e(o.s("shared-calculator-error-complicated-double-inequality"))},r.equationRequired=function(r){return r?(r=n.formatSymbol(r),e(o.s("shared-calculator-error-equation-required-symbol",{lhs:r+"="}))):e(o.s("shared-calculator-error-equation-required"))},r.variableAsFunction=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-variable-as-function",{dependency:r}))},r.distributionAsFunction=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-distribution-as-function",{symbol:r}))},r.invalidTableHeader=function(r){return e(o.s("shared-calculator-error-invalid-table-header",{supplement:r}))},r.invalidTableEntry=function(r){return e(o.s("shared-calculator-error-invalid-table-entry",{supplement:r}))},r.invalidFirstTableColumn=function(){return e(o.s("shared-calculator-error-invalid-first-table-column",{most:"\'y\', \'r\',",last:"\'Î¸\'"}))},r.invalidDependentFirstTableColumn=function(){return e(o.s("shared-calculator-error-invalid-dependent-first-table-column"))},r.invalidRegressionParameter=function(r){return e(o.s("shared-calculator-error-invalid-regression-parameter",{symbol:n.formatSymbol(r)}))},r.optimizationError=function(){return e(o.s("shared-calculator-error-optimization-error"))},r.nonListDoubleReducer=function(r){return e(o.s("shared-calculator-error-non-list-double-reducer",{symbol:n.formatSymbol(r),recommendation:n.formatSymbol(r)+"([1,2,3], [3,2,1])"})).allowExport()},r.nonListParameterizedReducer=function(r){return e(o.s("shared-calculator-error-non-list-parameterized-reducer",{symbol:n.formatSymbol(r),recommendation:n.formatSymbol(r)+"([1,2,3], 1)"})).allowExport()},r.methodRequiresList=function(r){return e(o.s("shared-calculator-error-method-requires-list",{symbol:n.formatSymbol(r),recommendation:n.formatSymbol(r)+"([1,2,3])"})).allowExport()},r.functionFreeVariable=function(r,n){return e(o.s("shared-calculator-error-variable-function-free-variable",{functionSymbol:r,variableSymbol:n})).allowExport()},r.nonArithmeticRange=function(){return e(o.s("shared-calculator-error-non-arithmetic-range")).allowExport()},r.invalidHalfEmptyRange=function(){return e(o.s("shared-calculator-error-invalid-half-empty-range"))},r.sumMissingBound=function(){return e(o.s("shared-calculator-error-sum-missing-bound"))},r.productMissingBound=function(){return e(o.s("shared-calculator-error-product-missing-bound"))},r.incorrectSumLowerBound=function(){return e(o.s("shared-calculator-error-incorrect-sum-lower-bound"))},r.incorrectProductLowerBound=function(){return e(o.s("shared-calculator-error-incorrect-product-lower-bound"))},r.badSumBoundDependency=function(r){return e(o.s("shared-calculator-error-bad-sum-bound-dependency",{symbol:n.formatSymbol(r)}))},r.badProductBoundDependency=function(r){return e(o.s("shared-calculator-error-bad-product-bound-dependency",{symbol:n.formatSymbol(r)}))},r.integralMissingBound=function(){return e(o.s("shared-calculator-error-integral-missing-bound"))},r.integralMissingDifferential=function(){return e(o.s("shared-calculator-error-integral-missing-differential"))},r.differentialWithSuperscript=function(){return e(o.s("shared-calculator-error-differential-with-superscript"))},r.sumMissingBody=function(){return e(o.s("shared-calculator-error-sum-missing-body"))},r.productMissingBody=function(){return e(o.s("shared-calculator-error-product-missing-body"))},r.integralMissingBody=function(){return e(o.s("shared-calculator-error-integral-missing-body"))},r.derivativeMissingBody=function(){return e(o.s("shared-calculator-error-derivative-missing-body"))},r.mismatchedBraces=function(r,t){return r=n.formatSymbol(r),t=n.formatSymbol(t),e(o.s("shared-calculator-error-mismatched-braces",{symbol1:r,symbol2:t}))},r.shadowedIntegrationVariable=function(r){return e(o.s("shared-calculator-error-shadowed-integration-variable",{symbol:n.formatSymbol(r)}))},r.badIntegralBoundDependency=function(r){return e(o.s("shared-calculator-error-bad-integral-bound-dependency",{symbol:n.formatSymbol(r)}))},r.percentMissingOf=function(){return e(o.s("shared-calculator-error-percent-missing-of"))},r.illegalBinWidth=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-illegal-bin-width",{symbol:r}))},r.ttestListTooShort=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-ttest-list-too-short",{symbol:r}))},r.badSampleSize=function(){return e(o.s("shared-calculator-error-bad-sample-size"))},r.variableSeed=function(r){return e(o.s("shared-calculator-error-variable-seed",{symbol:n.formatSymbol(r[0].symbol)})).setDependencies(r.filter(function(r){return"free"===r.scope}).map(function(r){return r.symbol})).allowExport()},r.badSymbolContext=function(r){return e(o.s("shared-calculator-error-bad-symbol-context",{symbol:n.formatSymbol(r)}))},r.ansUndefined=function(){return e(o.s("shared-calculator-error-ans-undefined"))},r.variablesUnsupported=function(r){return e(o.s("shared-calculator-error-variables-unsupported",{variable:n.formatSymbol(r)}))},r.functionUnsupported=function(r){return e(o.s("shared-calculator-error-function-unsupported",{symbol:n.formatSymbol(r)}))},r.logbaseUnsupported=function(){return e(o.s("shared-calculator-error-logbase-unsupported"))},r.constantUnsupported=function(r){return e(o.s("shared-calculator-error-constant-unsupported",{symbol:n.formatSymbol(r)}))},r.variableUnsupported=function(r){return e(o.s("shared-calculator-error-variable-unsupported",{symbol:n.formatSymbol(r)}))},r.assignmentsUnsupported=function(){return e(o.s("shared-calculator-error-assignments-unsupported"))},r.functionDefinitionsUnsupported=function(){return e(o.s("shared-calculator-error-function-definition-unsupported"))},r.equationsUnsupported=function(){return e(o.s("shared-calculator-error-equations-unsupported"))},r.inequalitiesUnsupported=function(){return e(o.s("shared-calculator-error-inequalities-unsupported"))},r.regressionsUnsupported=function(){return e(o.s("shared-calculator-error-regressions-unsupported"))},r.pointsUnsupported=function(){return e(o.s("shared-calculator-error-points-unsupported"))},r.featureUnavailable=function(){return e(o.s("shared-calculator-error-feature-unavailable"))},r.fractionsUnavailable=function(){return e(o.s("basic-calculator-error-fractions-unavailable"))},r.nonSquareDeterminant=function(){return e(o.s("shared-calculator-error-non-square-determinant"))},r.nonSquareTrace=function(){return e(o.s("shared-calculator-error-non-square-trace"))},r.nonSquareInverse=function(){return e(o.s("shared-calculator-error-non-square-inverse"))},r.singularInverse=function(){return e(o.s("shared-calculator-error-non-singular-inverse"))},r.clickableObjectAssignmentNotDefined=function(r){return e(o.s("shared-calculator-error-clickable-object-assignment-not-defined",{symbol:r}))},r.clickableObjectAlreadyAssigned=function(r){return e(o.s("shared-calculator-error-multiply-defined",{dependency:r}))},r.clickableObjectAssignmentNotIdentifier=function(){return e(o.s("shared-calculator-error-clickable-object-assignment-not-identifier"))},r.clickableObjectInvalidExpression=function(){return e(o.s("shared-calculator-error-clickable-object-invalid-expression"))},r.matrixAssignment=function(){return e(o.s("shared-calculator-error-matrix-assignment"))},r.matrixAddDimensions=function(){return e(o.s("shared-calculator-error-matrix-add-dimensions"))},r.matrixSubtractDimensions=function(){return e(o.s("shared-calculator-error-matrix-subtract-dimensions"))},r.matrixMultiplyDimensions=function(){return e(o.s("shared-calculator-error-matrix-multiply-dimensions"))},r.matrixFractionalPower=function(){return e(o.s("shared-calculator-error-matrix-fractional-power"))},r.matrixPowerDimensions=function(){return e(o.s("shared-calculator-error-matrix-power-dimensions"))},r.matrixElementTypeError=function(r){return e(o.s("shared-calculator-error-matrix-element-type-error",{arg:r[0]}))},r.matrixInvalidVariable=function(r){return e(o.s("shared-calculator-error-matrix-invalid-variable",{symbol:n.formatSymbol(r)}))},r.listComprehensionInputListTypeError=function(r,n){return e(o.s("shared-calculator-error-list-comprehension-input-type-error",{identifier:r,actual:n}))},r.listComprehensionIncorrectInput=function(){return e(o.s("shared-calculator-error-incorrect-list-comprehension-input"))},r.unexpectedForKeyword=function(){return e(o.s("shared-calculator-error-unexpected-for-keyword"))},r.shadowedListComprehensionInput=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-shadowed-list-comprehension-input",{symbol:r}))},r.badListComprehensionInputDependency=function(r){return r=n.formatSymbol(r),e(o.s("shared-calculator-error-bad-list-comprehension-input-dependency",{symbol:r}))},r.variableLengthTopLevelList=function(r){var t=r.filter(function(r){return"free"===r.scope}).map(function(r){return r.symbol});return e(o.s("shared-calculator-error-variable-length-top-level-list",{symbol:n.formatSymbol(t[0]||"")})).setDependencies(t).allowExport()},r.variableLengthDistributionList=function(r){return e(o.s("shared-calculator-error-variable-length-distribution-list",{symbol:r[0].symbol})).setDependencies(r.filter(function(r){return"free"===r.scope}).map(function(r){return r.symbol}))},r.variableLengthSumBodyDependsOnIndex=function(r){return e(o.s("shared-calculator-error-variable-length-sum-body-depends-on-index",{symbol:r}))},r.variableLengthProductBodyDependsOnIndex=function(r){return e(o.s("shared-calculator-error-variable-length-product-body-depends-on-index",{symbol:r}))}});\ndefine(\'core/math/parsenode/expression\',[\'require\',\'pjs\',\'./base\',\'core/math/errormsg\'],function(require){"use strict";var r=require("pjs"),e=require("./base");require("core/math/errormsg");return r(e,function(r,e){r.init=function(r){if(!Array.isArray(r))throw new TypeError("Argument to expression constructor must be an Array.");e.init.call(this),this.args=r,this.registerDependencies()},r.shouldExportAns=function(){return!0},r.registerDependencies=function(){for(var r=0;r<this.args.length;r++)this.mergeDependencies(this.args[r])},r.copyWithArgs=function(r){return new this.constructor(r)}})});\ndefine(\'core/math/parsenode/expressionTypes\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";var n=require("pjs"),t=require("./expression"),e={Add:n(t,{}),Subtract:n(t,{}),Multiply:n(t,{}),Divide:n(t,{}),Exponent:n(t,{}),Negative:n(t,{}),And:n(t,{isInequality:function(){return this.args[0].isInequality()&&this.args[1].isInequality()}}),PercentOf:n(t,{})};return e.RawExponent=n(e.Exponent,{}),e});\ndefine(\'core/math/builtin-common\',["require","exports","./tofraction","core/math/distance"],function(require,r,t,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.pow=r.gcd=void 0,r.gcd=function(r,t){if((r=Math.round(r))<0&&(r=-r),(t=Math.round(t))<0&&(t=-t),t>r){var e=t;t=r,r=e}if(0===t)return r;for(var n=r%t;n>0;)n=(r=t)%(t=n);return t},r.pow=function(r,n){if(!isFinite(r)&&0===n)return NaN;if(r>=0||n===Math.floor(n))return Math.pow(r,n);var o=t.default(n,100);return e.approx(o.n/o.d,n,2)&&o.d%2==1?(o.n%2==0?1:-1)*Math.pow(-r,n):NaN}});\ndefine(\'core/math/maybe-rational\',["require","exports","./builtin-common"],function(require,n,t){"use strict";function r(n,t){return{n:n,d:t}}function a(n){return"object"==typeof n&&"number"==typeof n.n&&"number"==typeof n.d}Object.defineProperty(n,"__esModule",{value:!0}),n.total=n.mod=n.nthroot=n.sqrt=n.pow=n.div=n.sub=n.mul=n.add=n.reciprocal=n.abs=n.neg=n.maybeRational=n.isNanFloat=n.asFloat=n.fromDecimalString=n.isRational=void 0,n.isRational=a;var o=Math.pow(2,53)-1;function e(n){return a(n)?n.n/n.d:+n}function u(n,a){if(!isFinite(n)||!isFinite(a)||0===a||Math.floor(n)!==n||Math.floor(a)!==a||Math.abs(n)>o||Math.abs(a)>o)return n/a;a<0&&(n=-n,a=-a);var e=t.gcd(n,a);return r(n/e,a/e)}function i(n){return a(n)?r(-n.n,n.d):-n}function d(n){return a(n)?0===n.n?n.d/n.n:r(n.n<0?-n.d:n.d,Math.abs(n.n)):1/n}function f(n,r){if(!a(n)||!a(r))return e(n)+e(r);var o=t.gcd(n.d,r.d);return u(n.n*(r.d/o)+r.n*(n.d/o),n.d/o*r.d)}function c(n,r){if(!a(n)||!a(r))return e(n)*e(r);var o=t.gcd(n.n,r.d),i=t.gcd(r.n,n.d);return u(n.n/o*(r.n/i),n.d/i*(r.d/o))}function s(n,t){return f(n,i(t))}function h(n,t){return a(n)&&a(t)?c(n,d(t)):e(n)/e(t)}function M(n,r){if(!a(n)||!a(r))return t.pow(e(n),e(r));var o=function(n,r){var o=n,f=r;if(r.n<0&&(f=i(r),o=d(n)),!a(o)||!a(f))return t.pow(e(n),e(r));if(n=o,1===(r=f).d)return u(Math.pow(n.n,r.n),Math.pow(n.d,r.n));var c=n.n<0;if(c&&r.d%2!=1)return NaN;var s=(c?-1:1)*Math.round(Math.pow(Math.abs(n.n),1/r.d)),h=Math.round(Math.pow(Math.abs(n.d),1/r.d));return Math.pow(s,r.d)!==n.n||Math.pow(h,r.d)!==n.d?t.pow(e(n),e(r)):u(Math.pow(s,r.n),Math.pow(h,r.n))}(n,r);return a(o)?o:t.pow(e(n),e(r))}n.fromDecimalString=function(n){var t=n.match(/^(-)?(\\d*)?(?:\\.(\\d*))?$/);if(!t)return NaN;var r=t[1],a=t[2],e=t[3];if(!a&&!e)return NaN;var i=!!r;if(e){var d,f=e.replace(/0+$/,""),c=f.length,s=Math.pow(10,c);return(d=parseInt(a||"0",10)*s+parseInt(f||"0",10))>o||s>o?parseFloat(n):u(i?-d:d,s)}return(d=parseInt(a,10))>o?parseFloat(n):u(i?-d:d,1)},n.asFloat=e,n.isNanFloat=function(n){return!a(n)&&isNaN(n)},n.maybeRational=u,n.neg=i,n.abs=function(n){return a(n)?r(Math.abs(n.n),Math.abs(n.d)):Math.abs(n)},n.reciprocal=d,n.add=f,n.mul=c,n.sub=s,n.div=h,n.pow=M,n.sqrt=function(n){if(!a(n))return Math.sqrt(n);var t=Math.round(Math.sqrt(n.n)),r=Math.round(Math.sqrt(n.d));return t*t!==n.n||r*r!==n.d?Math.sqrt(e(n)):u(t,r)},n.nthroot=function(n,t){return M(n,d(t))},n.mod=function(n,t){if(!a(n)||!a(t)){var o=e(n),u=e(t);return o-u*Math.floor(o/u)}return s(n,c(t,r(Math.floor(e(h(n,t))),1)))},n.total=function(n){for(var t=r(0,1),a=0,o=n;a<o.length;a++){t=f(t,o[a])}return t}});\ndefine(\'core/math/parsenode/constant\',[\'require\',\'pjs\',\'./expression\',\'core/math/maybe-rational\'],function(require){"use strict";var t=require("pjs"),n=require("./expression"),a=require("core/math/maybe-rational");return t(n,function(t,n){t.init=function(t){"number"==typeof t&&(t=a.maybeRational(t,1)),this._constantValue=t,n.init.call(this,[])},t.isConstant=!0,t.asValue=function(){return"boolean"==typeof this._constantValue?this._constantValue:a.asFloat(this._constantValue)},t.asCompilerValue=function(){return this._constantValue},t.scalarExprString=function(){return this.asValue()>0?String(this.asValue()):"("+String(this.asValue())+")"},t.getEvaluationInfo=function(){return[{val:this.asValue()}]},t.isNaN=function(){return"number"==typeof this.asValue()&&isNaN(this.asValue())}})});\ndefine(\'core/math/parsenode/mixednumber\',[\'require\',\'pjs\',\'./constant\'],function(require){"use strict";return require("pjs")(require("./constant"),function(n,i){n.init=function(n){i.init.call(this,n)},n.is_mixed_number=!0})});\ndefine(\'core/math/parsenode/identifier\',[\'require\',\'pjs\',\'./expression\',\'core/lib/label\',\'core/math/parser/input-span\'],function(require){"use strict";var t=require("pjs"),n=require("./expression"),i=require("core/lib/label"),e=require("core/math/parser/input-span");return t(n,function(t,n,s){t.init=function(t){n.init.call(this,[]),this._symbol=i.latexToIdentifier(t),this._errorSymbol=this._symbol,this.addDependency(this._symbol)},t.setInputSpan=function(t){n.setInputSpan.call(this,t),this._errorSymbol=i.latexToIdentifier(this.getInputString())},t.getInputSpan=function(){return void 0===this._inputSpan?new e.Span(this._symbol,0,this._symbol.length):this._inputSpan}})});\ndefine(\'core/math/parsenode/ans\',[\'require\',\'pjs\',\'./identifier\'],function(require){"use strict";return require("pjs")(require("./identifier"),function(i,n,e){})});\ndefine(\'core/math/parsenode/list\',[\'require\',\'pjs\',\'./expression\',\'core/math/types\'],function(require){"use strict";var t=require("pjs"),i=require("./expression"),n=require("core/math/types");return t(i,function(t,i,s){t.init=function(t){i.init.call(this,t),this.length=t.length},t.isList=!0,t.asValue=function(){for(var t=[],i=0;i<this.args.length;i++)t.push(this.args[i].asValue());return t},t.asCompilerValue=function(){for(var t=[],i=0;i<this.args.length;i++)t.push(this.args[i].asCompilerValue());return t},t.getEvaluationInfo=function(){if(this.args.every(function(t){return t.isConstant}))return[{val:this.args.map(function(t){return t.asValue()})}]},s.eachArgs=function(t,i){var s=function(t){for(var i=1/0,n=0;n<t.length;n++)(t[n].isList||t[n].isBroadcast)&&(i=Math.min(i,t[n].length));return i}(t);if(isFinite(s))for(var e=0;e<s;e++){for(var r=[],a=0;a<t.length;a++)r.push(t[a].isList||n.isList(t[a].valueType)?t[a].elementAt(e):t[a]);i(r,e)}else i(t)},s.wrap=function(t){return t.isList||n.isList(t.valueType)?t:s([t])}})});\ndefine(\'core/math/parsenode/range\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(n,i,t){n.init=function(n){i.init.call(this,n),this.beginning=n[0],this.end=n[1]},n.isHalfEmpty=function(){return this.end&&this.end.args&&0===this.end.args.length}})});\ndefine(\'core/math/parsenode/listaccess\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,n){i.init=function(i){n.init.call(this,i),this.list=i[0],this.index=i[1]}})});\ndefine(\'core/math/parsenode/dotaccess\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),{})});\ndefine(\'core/math/parsenode/parenseq\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),{})});\ndefine(\'core/math/parsenode/movablepoint\',[\'require\',\'pjs\',\'./parenseq\',\'core/math/types\'],function(require){"use strict";var t=require("pjs"),e=require("./parenseq"),a=require("core/math/types");return t(e,function(t,e){t.asValue=function(){return[+this.args[0].asValue(),+this.args[1].asValue()]},t.asCompilerValue=function(){return[this.args[0].asCompilerValue(),this.args[1].asCompilerValue()]},t.init=function(t,i,s){e.init.call(this,t),this.moveStrategy=i,this.defaultDragMode=s,this.valueType=a.Point},t.isMovablePoint=!0})});\ndefine(\'core/math/parsenode/orderedpairaccess\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,n){i.init=function(i){n.init.call(this,i),this.point=i[0],this.index=i[1]}})});\ndefine(\'core/math/parsenode/bareseq\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),{})});\ndefine(\'core/math/comparators\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.get=e.table=void 0,e.table={"<":{inclusive:!1,direction:-1},"!=":{inclusive:!1,direction:0},">":{inclusive:!1,direction:1},"<=":{inclusive:!0,direction:-1},"=":{inclusive:!0,direction:0},">=":{inclusive:!0,direction:1}},e.get=function(e,i){switch(i){case-1:return e?"<=":"<";case 0:return e?"=":"!=";case 1:return e?">=":">";default:throw"Programming error.  Comparators must have a direction of -1, 0, or 1"}}});\ndefine(\'core/math/parsenode/basecomparator\',[\'require\',\'pjs\',\'./expression\',\'./expressionTypes\',\'core/math/comparators\'],function(require){"use strict";var t=require("pjs"),n=require("./expression"),i=require("./expressionTypes").Subtract,r=require("core/math/comparators").table;return t(n,function(n,e,o){o.create=function(n){return t(o,function(t,i){t.operator=n,t.isInequality=function(){return 0!==r[n].direction}})},n.init=function(t){e.init.call(this,t),this._difference=-1===r[this.operator].direction?i([t[1],t[0]]):i([t[0],t[1]])},n.asComparator=function(){return this}})});\ndefine(\'core/math/parsenode/comparator\',[\'require\',\'core/math/parsenode/basecomparator\'],function(require){"use strict";var e=require("core/math/parsenode/basecomparator");return{"<":e.create("<"),">":e.create(">"),"<=":e.create("<="),">=":e.create(">="),"=":e.create("=")}});\ndefine(\'core/math/parsenode/doubleinequality\',[\'require\',\'pjs\',\'./base\',\'core/math/comparators\',\'./comparator\'],function(require){"use strict";var i=require("pjs"),e=require("./base"),s=require("core/math/comparators"),t=require("./comparator");return i(e,function(i,e){i.init=function(i){e.init.call(this),this.args=i,this._symbol=i[2]._symbol,this._operators=[i[1],i[3]],this._expressions=[i[0],i[4]];var n=s.get(s.table[i[1]].inclusive&&s.table[i[3]].inclusive,s.table[i[1]].direction);this._indicator=t[n]([i[0],i[4]]),this.addDependency(this._symbol),this.mergeDependencies(this._expressions[0],this._expressions[1])},i.isInequality=function(){return!0},i.isShadeBetween=function(){return!0}})});\ndefine(\'core/math/parsenode/repeatedoperator\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(e,i){e.init=function(e){this._index=e[0],i.init.call(this,e)},e.registerDependencies=function(){this.addDummyDependency(this._index._symbol),this.mergeDependencies(this.args[1]),this.mergeDependencies(this.args[2]),this.mergeDependenciesInScope([this._index._symbol],this.args[3])}})});\ndefine(\'core/math/parsenode/sum\',[\'require\',\'pjs\',\'./repeatedoperator\'],function(require){"use strict";return require("pjs")(require("./repeatedoperator"),function(t,n){t.in_place_operator="+=",t.starting_value=0,t.evaluateConstant=function(t){var n=1+Math.round(t[1])-Math.round(t[0]);return n<=0?this.starting_value:n*t[2]},t.update=function(t,n){return t+n}})});\ndefine(\'core/math/parsenode/product\',[\'require\',\'pjs\',\'./repeatedoperator\'],function(require){"use strict";return require("pjs")(require("./repeatedoperator"),function(t,n){t.in_place_operator="*=",t.starting_value=1,t.evaluateConstant=function(t){var n=1+Math.round(t[1])-Math.round(t[0]);return n<=0?this.starting_value:Math.pow(t[2],n)},t.update=function(t,n){return t*n}})});\ndefine(\'core/math/parsenode/integral\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(e,i){e.init=function(e){this._differential=e[0],i.init.call(this,e)},e.registerDependencies=function(){this.mergeDependencies(this.args[1]),this.mergeDependencies(this.args[2]),this.mergeDependenciesInScope([this._differential._symbol],this.args[3])}})});\ndefine(\'core/math/parsenode/assignmentexpression\',[\'require\',\'./expression\',\'pjs\'],function(require){"use strict";var i=require("./expression");return require("pjs")(i,function(i,n){i.init=function(i){n.init.call(this,i),this._symbol=i[0]._symbol}})});\ndefine(\'core/math/parsenode/listcomprehension\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,e){i.init=function(i,s,n){this._index=i,this._body=s,this._inputLists=n,e.init.call(this,[i,s].concat(n))},i.registerDependencies=function(){for(var i=[],e=0;e<this._inputLists.length;e++){var s=this._inputLists[e],n=s._symbol;this.addDummyDependency(n),i.push(n),this.mergeDependencies(s.args[1])}this.addDummyDependency(this._index._symbol),i.push(this._index._symbol),this.mergeDependenciesInScope(i,this._body)}})});\ndefine(\'core/math/ir/opcodes\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Action=e.BroadcastResult=e.BlockVar=e.ExtendSeed=e.Distribution=e.InboundsListAccess=e.DeferredListAccess=e.ListAccess=e.List=e.NativeFunction=e.Piecewise=e.And=e.GreaterEqual=e.LessEqual=e.Greater=e.Less=e.Equal=e.EndBroadcast=e.BeginBroadcast=e.EndIntegral=e.BeginIntegral=e.EndLoop=e.BeginLoop=e.OrderedPairAccess=e.OrderedPair=e.Negative=e.RawExponent=e.Exponent=e.Divide=e.Multiply=e.Subtract=e.Add=e.MAX_LEAF_OPCODE=e.SymbolicVar=e.LoadArg=e.Constant=e.Noop=void 0,e.Noop=0,e.Constant=1,e.LoadArg=2,e.SymbolicVar=3,e.MAX_LEAF_OPCODE=3,e.Add=8,e.Subtract=9,e.Multiply=10,e.Divide=11,e.Exponent=12,e.RawExponent=13,e.Negative=14,e.OrderedPair=15,e.OrderedPairAccess=16,e.BeginLoop=17,e.EndLoop=18,e.BeginIntegral=19,e.EndIntegral=20,e.BeginBroadcast=21,e.EndBroadcast=22,e.Equal=23,e.Less=24,e.Greater=25,e.LessEqual=26,e.GreaterEqual=27,e.And=30,e.Piecewise=31,e.NativeFunction=37,e.List=38,e.ListAccess=39,e.DeferredListAccess=40,e.InboundsListAccess=41,e.Distribution=42,e.ExtendSeed=44,e.BlockVar=47,e.BroadcastResult=48,e.Action=49});\ndefine(\'core/math/ir/builtin-table\',["require","exports","core/math/types","./opcodes","core/math/maybe-rational"],function(require,e,t,r,n){"use strict";function u(e,r,n){var u,a,l,i,m,o,s=null!==(u=null==n?void 0:n.tag)&&void 0!==u?u:"default",d=null!==(a=null==n?void 0:n.argumentTypes)&&void 0!==a?a:function(e){switch(e){case"default":case"trig":case"inverseTrig":case"never-broadcast":return[t.Number];case"reducer":return[t.ListOfNumber];case"doubleReducer":return[t.ListOfNumber,t.ListOfNumber];case"parameterizedReducer":return[t.ListOfNumber,t.Number];case"color":return[t.Number,t.Number,t.Number]}}(s),g=(null==n?void 0:n.defaultArguments)?n.defaultArguments.length:0,c=null!==(l=null==n?void 0:n.minArity)&&void 0!==l?l:d.length-g,p=null!==(i=null==n?void 0:n.maxArity)&&void 0!==i?i:function(e,t,r){return"reducer"===e?1/0:t+r}(s,c,g),b=null!==(m=null==n?void 0:n.allowDotCall)&&void 0!==m?m:function(e){switch(e){case"default":case"trig":case"inverseTrig":case"doubleReducer":case"color":case"never-broadcast":return!1;case"reducer":case"parameterizedReducer":return!0}}(s);return{module:e,symbol:r,argumentTypes:d,defaultArguments:null==n?void 0:n.defaultArguments,returnType:null!==(o=null==n?void 0:n.returnType)&&void 0!==o?o:t.Number,tag:s,minArity:c,maxArity:p,allowDotCall:b}}function a(e){if(!n.isRational(e))throw new Error("Programming Error: numeric constants should be rational");return{type:r.Constant,valueType:t.Number,value:e}}Object.defineProperty(e,"__esModule",{value:!0}),e.CompilerFunctionTable=e.BuiltInTable=void 0;var l=a(n.maybeRational(0,1)),i=a(n.maybeRational(1,1)),m=a(n.maybeRational(1,2));function o(e,t){var r,n,u,a,l=null==t?void 0:t.defaultArguments,i=null!==(r=null==t?void 0:t.maxArity)&&void 0!==r?r:function(e,t){return t?t.length+e:e}(e,l),m=null!==(n=null==t?void 0:t.fallthroughUnlessDistribution)&&void 0!==n&&n,o=null!==(u=null==t?void 0:t.allowDotCall)&&void 0!==u&&u,s=null!==(a=null==t?void 0:t.isSeeded)&&void 0!==a&&a;return{minArity:e,maxArity:i,defaultArguments:l,fallthroughUnlessDistribution:m,minArityExampleArgs:null==t?void 0:t.minArityExampleArgs,maxArityExampleArgs:null==t?void 0:t.maxArityExampleArgs,dotMinArityExampleArgs:null==t?void 0:t.dotMinArityExampleArgs,dotMaxArityExampleArgs:null==t?void 0:t.dotMaxArityExampleArgs,allowDotCall:o,isSeeded:s}}function s(){return o(0,{maxArity:1/0})}e.BuiltInTable={sin:u("BuiltIn","sin",{tag:"trig"}),cos:u("BuiltIn","cos",{tag:"trig"}),tan:u("BuiltIn","tan",{tag:"trig"}),cot:u("BuiltIn","cot",{tag:"trig"}),sec:u("BuiltIn","sec",{tag:"trig"}),csc:u("BuiltIn","csc",{tag:"trig"}),arcsin:u("Math","asin",{tag:"inverseTrig"}),arccos:u("Math","acos",{tag:"inverseTrig"}),arctan:u("Math","atan2",{argumentTypes:[t.Number,t.Number],defaultArguments:[i],tag:"inverseTrig"}),arccot:u("BuiltIn","acot",{tag:"inverseTrig"}),arcsec:u("BuiltIn","asec",{tag:"inverseTrig"}),arccsc:u("BuiltIn","acsc",{tag:"inverseTrig"}),sinh:u("BuiltIn","sinh"),cosh:u("BuiltIn","cosh"),tanh:u("BuiltIn","tanh"),coth:u("BuiltIn","coth"),sech:u("BuiltIn","sech"),csch:u("BuiltIn","csch"),arcsinh:u("BuiltIn","asinh"),arccosh:u("BuiltIn","acosh"),arctanh:u("BuiltIn","atanh"),arccoth:u("BuiltIn","acoth"),arcsech:u("BuiltIn","asech"),arccsch:u("BuiltIn","acsch"),sqrt:u("Math","sqrt"),rtxsqpone:u("BuiltIn","sqrtxsqp1"),rtxsqmone:u("BuiltIn","sqrtxsqm1"),nthroot:u("BuiltIn","nthroot",{argumentTypes:[t.Number,t.Number]}),hypot:u("BuiltIn","hypot",{argumentTypes:[t.Number,t.Number]}),log:u("BuiltIn","common_log"),logbase:u("BuiltIn","log_base",{argumentTypes:[t.Number,t.Number]}),ln:u("BuiltIn","log"),exp:u("Math","exp"),floor:u("Math","floor"),ceil:u("Math","ceil"),round:u("Math","round"),abs:u("Math","abs"),sign:u("BuiltIn","sign"),mod:u("BuiltIn","mod",{argumentTypes:[t.Number,t.Number]}),nCr:u("BuiltIn","nCr",{argumentTypes:[t.Number,t.Number]}),nPr:u("BuiltIn","nPr",{argumentTypes:[t.Number,t.Number]}),factorial:u("BuiltIn","factorial"),polyGamma:u("BuiltIn","polyGamma",{argumentTypes:[t.Number,t.Number]}),lcm:u("BuiltIn","listLCM",{tag:"reducer"}),gcd:u("BuiltIn","listGCD",{tag:"reducer"}),distance:u("BuiltIn","distance",{argumentTypes:[t.Point,t.Point]}),polygon:u("BuiltIn","polygon",{tag:"never-broadcast",argumentTypes:[t.ListOfPoint],returnType:t.Polygon}),mean:u("BuiltIn","mean",{tag:"reducer"}),total:u("BuiltIn","total",{tag:"reducer"}),stdev:u("BuiltIn","stdev",{tag:"reducer"}),stdevp:u("BuiltIn","stdevp",{tag:"reducer"}),mad:u("BuiltIn","mad",{tag:"reducer"}),length:u("BuiltIn","length",{tag:"reducer",argumentTypes:[t.ListOfAny]}),min:u("BuiltIn","listMin",{tag:"reducer"}),max:u("BuiltIn","listMax",{tag:"reducer"}),argmin:u("BuiltIn","argMin",{tag:"reducer"}),argmax:u("BuiltIn","argMax",{tag:"reducer"}),median:u("BuiltIn","median",{tag:"reducer"}),var:u("BuiltIn","variance",{tag:"reducer"}),varp:u("BuiltIn","varp",{tag:"reducer"}),cov:u("BuiltIn","cov",{tag:"doubleReducer"}),covp:u("BuiltIn","covp",{tag:"doubleReducer"}),corr:u("BuiltIn","corr",{tag:"doubleReducer"}),spearman:u("BuiltIn","spearman",{tag:"doubleReducer"}),quantile:u("BuiltIn","quantile",{tag:"parameterizedReducer"}),quartile:u("BuiltIn","quartile",{tag:"parameterizedReducer"}),upperQuantileIndex:u("BuiltIn","upperQuantileIndex",{tag:"parameterizedReducer"}),lowerQuantileIndex:u("BuiltIn","lowerQuantileIndex",{tag:"parameterizedReducer"}),quartileIndex:u("BuiltIn","quartileIndex",{tag:"parameterizedReducer"}),upperQuartileIndex:u("BuiltIn","upperQuartileIndex",{tag:"parameterizedReducer"}),lowerQuartileIndex:u("BuiltIn","lowerQuartileIndex",{tag:"parameterizedReducer"}),normalcdf:u("BuiltIn","normalcdf",{argumentTypes:[t.Number,t.Number,t.Number,t.Number],defaultArguments:[l,i]}),normalpdf:u("BuiltIn","normalpdf",{argumentTypes:[t.Number,t.Number,t.Number],defaultArguments:[l,i]}),binomcdf:u("BuiltIn","binomcdf",{argumentTypes:[t.Number,t.Number,t.Number,t.Number],defaultArguments:[m]}),binompdf:u("BuiltIn","binompdf",{argumentTypes:[t.Number,t.Number,t.Number],defaultArguments:[m]}),poissoncdf:u("BuiltIn","poissoncdf",{argumentTypes:[t.Number,t.Number,t.Number]}),poissonpdf:u("BuiltIn","poissonpdf",{argumentTypes:[t.Number,t.Number,t.Number]}),uniformcdf:u("BuiltIn","uniformcdf",{argumentTypes:[t.Number,t.Number,t.Number,t.Number],defaultArguments:[l,i]}),uniformpdf:u("BuiltIn","uniformpdf",{argumentTypes:[t.Number,t.Number,t.Number],defaultArguments:[l,i]}),invT:u("BuiltIn","invT",{argumentTypes:[t.Number,t.Number]}),invPoisson:u("BuiltIn","invPoisson",{argumentTypes:[t.Number,t.Number]}),invBinom:u("BuiltIn","invBinom",{argumentTypes:[t.Number,t.Number,t.Number]}),invUniform:u("BuiltIn","invUniform",{argumentTypes:[t.Number,t.Number,t.Number]}),tpdf:u("BuiltIn","tpdf",{argumentTypes:[t.Number,t.Number]}),tcdf:u("BuiltIn","tcdf",{argumentTypes:[t.Number,t.Number,t.Number]}),erf:u("BuiltIn","erf"),invNorm:u("BuiltIn","invNorm"),tscore:u("BuiltIn","tscore",{tag:"parameterizedReducer",defaultArguments:[l]}),normalSample:u("BuiltIn","normalSample",{argumentTypes:[t.SeedType,t.Number,t.Number]}),uniformSample:u("BuiltIn","uniformSample",{argumentTypes:[t.SeedType,t.Number,t.Number]}),tSample:u("BuiltIn","tSample",{argumentTypes:[t.SeedType,t.Number]}),poissonSample:u("BuiltIn","poissonSample",{argumentTypes:[t.SeedType,t.Number]}),binomSample:u("BuiltIn","binomSample",{argumentTypes:[t.SeedType,t.Number,t.Number]}),rgb:u("BuiltIn","rgb",{returnType:t.RGBColor,tag:"color"}),hsv:u("BuiltIn","hsv",{returnType:t.RGBColor,tag:"color"}),validateRangeLength:u("BuiltIn","validateRangeLength",{returnType:t.Number,argumentTypes:[t.ListOfNumber,t.ListOfNumber,t.Number,t.Number],tag:"never-broadcast"}),validateSampleCount:u("BuiltIn","validateSampleCount",{returnType:t.Number,argumentTypes:[t.Number]}),select:u("BuiltIn","select",{argumentTypes:[t.ListOfAny,t.ListOfBool],returnType:function(e){return e[0]},tag:"never-broadcast"}),shuffle:u("BuiltIn","shuffle",{argumentTypes:[t.SeedType,t.ListOfAny],returnType:function(e){return e[1]},tag:"never-broadcast"}),sortPerm:u("BuiltIn","sortPerm",{argumentTypes:[t.ListOfNumber],returnType:t.ListOfNumber,tag:"never-broadcast"}),elementsAt:u("BuiltIn","elementsAt",{argumentTypes:[t.ListOfAny,t.ListOfNumber],returnType:function(e){return e[0]},tag:"never-broadcast"}),uniquePerm:u("BuiltIn","uniquePerm",{argumentTypes:[t.ListOfAny],returnType:t.ListOfNumber,tag:"never-broadcast"})},e.CompilerFunctionTable={round:o(1,{maxArity:2}),midpoint:o(2),sort:o(1,{maxArity:2,minArityExampleArgs:"([3,2,1])",maxArityExampleArgs:"([1,2,3],[3,2,1])",dotMaxArityExampleArgs:"([3,4])",allowDotCall:!0}),shuffle:o(2,{maxArity:3,minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3],2)",dotMaxArityExampleArgs:"(2)",allowDotCall:!0,isSeeded:!0}),join:o(2,{maxArity:1/0,minArityExampleArgs:"([1,2],[3,4])",dotMinArityExampleArgs:"([3,4])",allowDotCall:!0}),unique:o(1,{minArityExampleArgs:"([1,2,3])",maxArityExampleArgs:"([1,2,3])",allowDotCall:!0}),normaldist:o(0,{defaultArguments:[l,i]}),tdist:o(1),binomialdist:o(1,{defaultArguments:[m]}),poissondist:o(1),uniformdist:o(0,{defaultArguments:[l,i]}),pdf:o(2,{allowDotCall:!0}),cdf:o(2,{maxArity:3,allowDotCall:!0}),mean:o(1,{fallthroughUnlessDistribution:!0,allowDotCall:!0}),median:o(1,{fallthroughUnlessDistribution:!0,allowDotCall:!0}),stdev:o(1,{fallthroughUnlessDistribution:!0,allowDotCall:!0}),var:o(1,{fallthroughUnlessDistribution:!0,allowDotCall:!0}),quantile:o(2,{fallthroughUnlessDistribution:!0,allowDotCall:!0,minArityExampleArgs:"([1,2,3], 1)",maxArityExampleArgs:"([1,2,3], 1)",dotMinArityExampleArgs:"(x)",dotMaxArityExampleArgs:"(x)"}),random:o(1,{maxArity:4,allowDotCall:!0,isSeeded:!0}),polygon:o(0,{maxArity:1/0}),histogram:s(),dotplot:s(),boxplot:s(),ttest:s(),ittest:s(),stats:s(),det:s(),inv:s(),transpose:s(),rref:s(),trace:s()}});\ndefine(\'core/math/parsenode/functioncall\',[\'require\',\'pjs\',\'./expression\',\'./identifier\',\'core/math/ir/builtin-table\'],function(require){"use strict";var i=require("pjs"),e=require("./expression"),t=require("./identifier"),r=require("core/math/ir/builtin-table").BuiltInTable;return i(e,function(i,e){i.init=function(i,r){"string"==typeof i&&(i=t(i)),this._identifier=i,this._symbol=i._symbol,this._errorSymbol="logbase"===i._errorSymbol?"log":i._errorSymbol,e.init.call(this,r)},i.registerDependencies=function(){this.addDependency(this._symbol),e.registerDependencies.call(this);var i=r[this._symbol];!i||"trig"!==i.tag&&"inverseTrig"!==i.tag||this.addDependency("trigAngleMultiplier")},i.copyWithArgs=function(i){return new this.constructor(t(this._symbol),i)}})});\ndefine(\'core/math/parsenode/seededfunctioncall\',[\'require\',\'pjs\',\'./functioncall\'],function(require){"use strict";return require("pjs")(require("./functioncall"),function(i,n){i.init=function(i,t){n.init.call(this,i,t),this.seed=t[0]}})});\ndefine(\'core/math/parsenode/functionexponent\',[\'require\',\'pjs\',\'./expression\',\'core/math/ir/builtin-table\'],function(require){"use strict";var e=require("pjs"),i=require("./expression"),t=require("core/math/ir/builtin-table").BuiltInTable;return e(i,function(e,i){e.registerDependencies=function(){if(i.registerDependencies.call(this),"Identifier"===this.args[0].type){var e=this.args[0]._symbol,n=t[e];!n||"trig"!==n.tag&&"inverseTrig"!==n.tag||this.addDependency("trigAngleMultiplier")}}})});\ndefine(\'core/math/parsenode/functionfactorial\',[\'require\',\'pjs\',\'./expression\',\'core/math/ir/builtin-table\'],function(require){"use strict";var e=require("pjs"),i=require("./expression"),t=require("core/math/ir/builtin-table").BuiltInTable;return e(i,function(e,i){e.registerDependencies=function(){if(this.addDependency("factorial"),i.registerDependencies.call(this),"Identifier"===this.args[0].type){var e=this.args[0]._symbol,n=t[e];!n||"trig"!==n.tag&&"inverseTrig"!==n.tag||this.addDependency("trigAngleMultiplier")}}})});\ndefine(\'core/math/parsenode/prime\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(t,i){t.init=function(t,n){i.init.call(this,n),this.order=t},t.copyWithArgs=function(t){return new this.constructor(this.order,t)}})});\ndefine(\'core/math/parsenode/piecewise\',[\'require\',\'pjs\',\'./expression\',\'./constant\',\'core/math/maybe-rational\'],function(require){"use strict";var n=require("pjs"),t=require("./expression"),e=require("./constant"),r=require("core/math/maybe-rational").maybeRational,a=n(t,{});return a.chain=function(n,t){for(var e,r=t;n.length;)e=n.pop(),r=a([e.condition,e.if_expr,r]);return r},a.empty=function(){return a([e(!0),e(r(1,1)),e(NaN)])},a});\ndefine(\'core/math/parsenode/derivative\',[\'require\',\'pjs\',\'./expression\',\'./identifier\'],function(require){"use strict";var i=require("pjs"),n=require("./expression"),s=require("./identifier");return i(n,function(i,n){i.init=function(i,t){this._symbol=i instanceof s?i._symbol:s(i)._symbol,n.init.call(this,t),this.addDependency(this._symbol)}})});\ndefine(\'core/math/parsenode/updaterule\',[\'require\',\'./expression\',\'pjs\'],function(require){"use strict";var e=require("./expression");return require("pjs")(e,function(e,i){e.init=function(e){this._symbol=e[0]._symbol,this._expression=e[1],i.init.call(this,e)},e.registerDependencies=function(){this.addUpdateSymbol(this._symbol),this.mergeDependencies(this._expression)}})});\ndefine(\'core/math/parsenode/histogram\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,n){i.init=function(i){n.init.call(this,i),this._symbol="histogram"}})});\ndefine(\'core/math/parsenode/object3d\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,n){i.init=function(i,t){n.init.call(this,i),this._symbol=t}})});\ndefine(\'core/math/parsenode/dotplot\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,t){i.init=function(i){t.init.call(this,i),this._symbol="dotplot"}})});\ndefine(\'core/math/parsenode/boxplot\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,n){i.init=function(i){n.init.call(this,i),this._symbol="boxplot"}})});\ndefine(\'core/math/parsenode/ttest\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(t,i){t.init=function(){i.init.apply(this,arguments),this._symbol="ttest"}})});\ndefine(\'core/math/parsenode/independent-ttest\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,t){i.init=function(){t.init.apply(this,arguments),this._symbol="ittest"}})});\ndefine(\'core/math/parsenode/stats\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,t){i.init=function(){t.init.apply(this,arguments),this._symbol="stats"}})});\ndefine(\'core/math/parsenode/equation\',[\'require\',\'./base\',\'pjs\',\'./expressionTypes\',\'core/math/parsenode/comparator\'],function(require){"use strict";var s=require("./base"),t=require("pjs"),i=require("./expressionTypes").Subtract,e=require("core/math/parsenode/comparator");return t(s,function(s,t){s.init=function(s,e){t.init.call(this),this.mergeDependencies(s,e),this._lhs=s,this._rhs=e,this._difference=i([this._lhs,this._rhs])},s.asComparator=function(){return e["="]([this._lhs,this._rhs])}})});\ndefine(\'core/math/parsenode/assignment\',[\'require\',\'./base\',\'./equation\',\'./identifier\',\'pjs\'],function(require){"use strict";var e=require("./base"),t=require("./equation"),i=require("./identifier");return require("pjs")(e,function(e,s){e.init=function(e,t){s.init.call(this),e=e._symbol,this.mergeDependencies(t),this._expression=t,this._symbol=e,this._exports=this.computeExports()},e.shouldExportAns=function(){return!0},e.computeExports=function(){for(var e=this._symbol,t=this.getDependencies(),i=0;i<t.length;i++)if(t[i]===e)return[];return[e]},e.isEquation=function(e){return-1!==e.getDependencies().indexOf(this._symbol)},e.asEquation=function(){var e=t(i(this._symbol),this._expression);return e.userData=this.userData,e.metaData=this.metaData,e},e.shouldPromoteToSlider=function(e){return!!this._expression.isConstant&&(!this._expression.is_mixed_number&&("number"==typeof this._expression.asValue()&&(!!isFinite(this._expression.asValue())&&e.isValidSlider(this._symbol))))}})});\ndefine(\'core/math/parsenode/functiondefinition\',[\'require\',\'pjs\',\'./base\',\'core/math/errormsg\',\'./equation\',\'./identifier\',\'./functioncall\'],function(require){"use strict";var t=require("pjs"),e=require("./base"),i=require("core/math/errormsg"),r=require("./equation"),n=require("./identifier"),s=require("./functioncall");return t(e,function(t,e){t.init=function(t,i,r){e.init.call(this),t=t._symbol,this._argSymbols=i.map(function(t){return t._symbol}),this._symbol=t,this._exports=[t],this._expression=r,this.mergeDependenciesInScope(this._argSymbols,this._expression)},t.isFunction=!0,t.getConcreteInvocationTree=function(t,e,r,n){if(r.length!==this._argSymbols.length)throw i.wrongArity(n,this._argSymbols.length,r.length);for(var s=Object.create(e),o=0;o<this._argSymbols.length;o++)s[this._argSymbols[o]]=r[o];return this._expression.getConcreteTree(t,s)},t.getSliderVariables=function(t,i){var r=this._argSymbols;return e.getSliderVariables.call(this,t,i).filter(function(t){return-1===r.indexOf(t)})},t.asEquation=function(){var t=this._argSymbols.map(function(t){return n(t)}),e=r(s(n(this._symbol),t),this._expression);return e.userData=this.userData,e.metaData=this.metaData,e}})});\ndefine(\'core/math/parsenode/regression\',[\'require\',\'pjs\',\'./base\',\'core/math/errormsg\',\'./functioncall\',\'./identifier\',\'./expressionTypes\'],function(require){"use strict";var e=require("pjs"),i=require("./base"),r=require("core/math/errormsg"),s=require("./functioncall"),n=require("./identifier"),t=require("./expressionTypes").Subtract;return e(i,function(e,i,a){e.init=function(e,r){i.init.call(this),this._lhs=e,this.isLhsSimple=e instanceof n,this._logLhs=s("ln",[e]),this._rhs=r,this._difference=t([e,r]),this._logDifference=t([s("ln",[e]),s("ln",[r])]),this.mergeDependencies(e,r)},e.isRegression=!0,e.exportTo=function(e,i,s){if(!i.isError){for(var n in i.parameters)i.parameters.hasOwnProperty(n)&&(e.assignmentForbidden(n)||(s[n]=s[n]?r.multiplyDefined(n):i.parameters[n]));e.assignmentForbidden(i.residualVariable)||(s[i.residualVariable]=i.residuals)}},e.getSliderVariables=function(){return[]}})});\ndefine(\'core/math/parsenode/image\',[\'require\',\'pjs\',\'./base\'],function(require){"use strict";return require("pjs")(require("./base"),function(i,t,e,h){i.isImage=!0,i.init=function(i,e){t.init.call(this),this.center=i.center,this.radianAngle=i.radianAngle,this.width=i.width,this.height=i.height,this.opacity=i.opacity,this.moveStrategy=e,this.mergeDependencies(this.center,this.radianAngle,this.width,this.height,this.opacity)}})});\ndefine(\'core/math/parsenode/ticker\',[\'require\',\'pjs\',\'./base\'],function(require){"use strict";return require("pjs")(require("./base"),function(e,i){e.init=function(e){i.init.call(this),this.handler=e.handler,this.minStep=e.minStep,this.mergeDependencies(this.handler),this.mergeDependencies(this.minStep)}})});\ndefine(\'core/math/parsenode/slider\',[\'require\',\'pjs\',\'./assignment\',\'./identifier\'],function(require){"use strict";var i=require("pjs"),s=require("./assignment"),e=require("./identifier");return i(s,function(i,t,n,r){i.isSlider=!0,i.init=function(i,s){t.init.call(this,e(i._symbol),i._expression),this.setInputSpan(i._inputSpan),this.sliderAssignment=i,this.sliderMin=s.sliderMin,this.sliderMax=s.sliderMax,this.sliderSoftMin=s.sliderSoftMin,this.sliderSoftMax=s.sliderSoftMax,this.sliderStep=s.sliderStep,this.sliderIsPlayingOnce=s.sliderIsPlayingOnce,this.sliderMin&&this.mergeDependencies(this.sliderMin),this.sliderMax&&this.mergeDependencies(this.sliderMax),this.sliderStep&&this.mergeDependencies(this.sliderStep)},i.shouldPromoteToSlider=function(i){return!1},i.asAssignment=function(){return s(this._symbol,this._expression)}})});\ndefine(\'core/math/parsenode/table\',[\'require\',\'pjs\',\'./base\'],function(require){"use strict";return require("pjs")(require("./base"),function(t,n){t.init=function(t){n.init.call(this),this.columns=t,this._exports=[],this.mergeDependencies.apply(this,t);for(var e=0;e<t.length;e++)Array.prototype.push.apply(this._exports,t[e].getExports())},t.exportPenalty=1,t.isTable=!0,t.exportTo=function(t,n,e){for(var s=0;s<this.columns.length;s++){var r=this.columns[s].getExports();if(r.length){var i=r[0];t.assignmentForbidden(i)||e[i]||(n.isError?e[i]=n:this.columns[s].exportTo(t,n.columns[s],e))}}},t.getAllIds=function(){return this.columns.map(function(t){return t.header.userData.id})}})});\ndefine(\'core/math/parsenode/tablecolumn\',[\'require\',\'pjs\',\'./base\',\'./list\',\'./constant\',\'./identifier\'],function(require){"use strict";var e=require("pjs"),t=require("./base"),n=require("./list"),i=require("./constant"),s=require("./identifier");return e(t,function(e,o){function r(e){return e.isConstant?i(e.asCompilerValue()):i(NaN)}e.init=function(e,t,n){o.init.call(this),this.header=e,this.length=t,this.values=n,this.isIndependent=!1,this.registerDependencies(),this._exports=this.computeExports()},e.registerDependencies=function(){this.mergeDependencies(this.header),this.mergeDependencies.apply(this,this.values)},e.computeExports=function(){return this.header instanceof s?[this.header._symbol]:[]},e.isDiscrete=function(e){return!this.continuousConcreteTree||1!==this.continuousConcreteTree.getDependencies().length||1!==e.header.getDependencies().length||this.continuousConcreteTree.getDependencies()[0]!==e.header.getDependencies()[0]},e._exportSymbolsTo=function(e,i,s){if(e.length){var o=e[0];if(i.isError)s[o]=i;else try{s[o]=n(i.values.map(r))}catch(e){if(!(e instanceof t))throw e;s[o]=e}}},e.exportTo=function(e,t,n){var i=this.getLegalExports(e);this._exportSymbolsTo(i,t,n)},e.exportToLocal=function(e,t){this._exportSymbolsTo(this.getExports(),e,t)}})});\ndefine(\'core/math/parsenode/solvedequation\',[\'require\',\'pjs\',\'./base\'],function(require){"use strict";return require("pjs")(require("./base"),function(i,e){i.init=function(i,n,t){e.init.call(this),this._symbol=i,this._expression=n,this.mergeDependencies(n),this.branchMultiplier=t}})});\ndefine(\'core/math/parsenode/optimizedregression\',[\'require\',\'pjs\',\'./base\'],function(require){"use strict";return require("pjs")(require("./base"),function(i,e){i.init=function(i,t,s,r,a){for(var n in e.init.call(this),this.parameters=i,this.residuals=t,this.statistics=s,this.model=r,this.isModelValid=a.isModelValid,this.residualVariable=a.residualVariable,this.residualSuggestionId=a.residualSuggestionId,this.shouldSuggestLogMode=a.shouldSuggestLogMode,this.isLinear=a.isLinear,this.parameterWarning=a.parameterWarning,this._exports=[this.residualVariable],i)i.hasOwnProperty(n)&&this._exports.push(n);this.mergeDependencies(r)},i.getCompiledFunction=function(){return this.model.getCompiledFunction.apply(this.model,arguments)},i.getCompiledDerivative=function(){return this.model.getCompiledDerivative.apply(this.model,arguments)}})});\ndefine(\'core/math/parsenode/seed\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(i,n){i.init=function(i){"string"!=typeof i&&(i=""+i),this._stringValue=i,n.init.call(this,[])},i.isString=!0,i.asValue=function(){return this._stringValue}})});\ndefine(\'core/math/parsenode/extendseed\',[\'require\',\'pjs\',\'./expression\'],function(require){"use strict";return require("pjs")(require("./expression"),function(t,s){t.init=function(t,e){s.init.call(this,e),this.seed=e[0],this.userSeed=e[1],this.tag=t},t.asValue=function(){return this.seed.asValue()+"::"+this.tag+this.userSeed.asValue()},t.copyWithArgs=function(t){return new this.constructor(this.tag,t)}})});\ndefine(\'core/math/context-types\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isActionCompilerValue=void 0,e.isActionCompilerValue=function(e){return!("object"!=typeof e||!e)&&"Action"===e.type}});\ndefine(\'core/math/ir/features/as-value\',["require","exports","../opcodes","core/math/context-types","core/math/maybe-rational"],function(require,e,t,a,r){"use strict";function u(e){if(Array.isArray(e))return e.map(u);switch(typeof e){case"boolean":case"number":case"string":return e;case"object":if(a.isActionCompilerValue(e)){var t={};for(var o in e.updateRules){var n=e.updateRules[o];t[o]={value:u(n.value),valueType:n.valueType}}return{type:"Action",updateRules:t}}return r.asFloat(e);default:throw new Error("Unexpected value: "+e)}}Object.defineProperty(e,"__esModule",{value:!0}),e.compilerValueToRuntimeValue=e.asValue=void 0,e.asValue=function(e,a){var r=e.getInstruction(a);switch(r.type){case t.Constant:return u(r.value);default:throw new Error("Unexpected opcode "+r.type+".")}},e.compilerValueToRuntimeValue=u});\ndefine(\'core/math/ir/features/nan-of-type\',["require","exports","core/math/types"],function(require,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.nanOfType=e.isNanableValueType=void 0,e.isNanableValueType=function(e){switch(e){case a.Bool:case a.Number:case a.Point:case a.Action:case a.RGBColor:case a.Polygon:return!0;default:return!1}},e.nanOfType=function(e){switch(e){case a.Number:return NaN;case a.Point:return[NaN,NaN];case a.RGBColor:return[NaN,NaN,NaN];case a.Action:return{type:"Action",updateRules:{}};case a.Bool:return!1;case a.Polygon:return[];default:throw new Error(e+" does not have a NaN type.")}}});\ndefine(\'core/math/parsenode/irexpression\',[\'require\',\'pjs\',\'./base\',\'core/math/types\',\'core/math/ir/features/as-value\',\'core/math/ir/features/nan-of-type\',\'core/math/errormsg\'],function(require){"use strict";var e=require("pjs"),t=require("./base"),n=require("core/math/types"),i=require("core/math/ir/features/as-value").compilerValueToRuntimeValue,s=require("core/math/ir/features/nan-of-type").nanOfType,u=require("core/math/errormsg");return e(t,function(e,t,r){e.init=function(e){if(t.init.call(this),this._chunk=e,this.valueType=e.getReturnType(),this.addDependencies(e.getLiveArgNames()),this.isList=n.isList(this.valueType),this.isList&&(this.length=this._chunk.getConstantListLength(),void 0===this.length))throw u.variableLengthTopLevelList(e.getListLengthDependencies());var i=e.isConstant();this.isConstant=i&&(this.valueType===n.Number||this.valueType===n.Bool),this.isEmptyAction=i&&this.valueType===n.Action&&0===Object.keys(e.asValue().updateRules).length},e.shouldExportAns=function(){return!0},e.getCompiledFunction=function(e){return this._chunk.getCompiledFunction(e)},e.polynomialOrder=function(e){return this._chunk.polynomialOrder(e,{allowRestriction:!0,allowClosedBlockReferences:!1})},e.getPolynomialCoefficients=function(e){for(var t=this._chunk.getPolynomialCoefficients(e),n=t.chunk,i=t.coefficients,s=[],u=0;u<i.length;u++){var o=n.copy();o.returnIndex=i[u],o.close(),s.push(new r(o))}return s},e.takeDerivative=function(e){var t=this._chunk.copy().takeDerivative(e).close();return new r(t)},e.boundDomain=function(e){return this._chunk.boundDomain(e)},e.asValue=function(){if(this._chunk.isConstant())return this._chunk.asValue();if(this.isList){for(var e=[],t=i(s(n.elementType(this.valueType))),u=0;u<this.length;u++)e.push(t);return e}return i(s(this.valueType))},e.asCompilerValue=function(){return this._chunk.asCompilerValue()},e.isNaN=function(){return"number"==typeof this.asValue()&&isNaN(this.asValue())},e.getEvaluationInfo=function(){return!(!this._chunk.isConstant()||0!==this.getDependencies().length||!n.isTypeOrListOfType(this.valueType,n.Number)&&!n.isTypeOrListOfType(this.valueType,n.Bool))&&[{val:this.asValue()}]},e.elementAt=function(e){var t=this._chunk.elementAt(e);return new r(t)},e.findLinearSubset=function(e){return this._chunk.findLinearSubset(e)},e.deriveRegressionRestrictions=function(){var e=this._chunk.deriveRegressionRestrictions();return e===this._chunk?this:new r(e)},e.eachElement=function(e){for(var t=0;t<this.length;t++)e(this.elementAt(t),t)},e.mapElements=function(e){for(var t=[],n=0;n<this.length;n++)t.push(e(this.elementAt(n),n));return t}})});\ndefine(\'parsenodes\',[\'require\',\'core/math/parsenode/expressionTypes\',\'core/math/parsenode/base\',\'core/math/parsenode/expression\',\'core/math/parsenode/error\',\'core/math/parsenode/constant\',\'core/math/parsenode/mixednumber\',\'core/math/parsenode/identifier\',\'core/math/parsenode/ans\',\'core/math/parsenode/list\',\'core/math/parsenode/range\',\'core/math/parsenode/listaccess\',\'core/math/parsenode/dotaccess\',\'core/math/parsenode/parenseq\',\'core/math/parsenode/movablepoint\',\'core/math/parsenode/orderedpairaccess\',\'core/math/parsenode/bareseq\',\'core/math/parsenode/basecomparator\',\'core/math/parsenode/comparator\',\'core/math/parsenode/doubleinequality\',\'core/math/parsenode/repeatedoperator\',\'core/math/parsenode/sum\',\'core/math/parsenode/product\',\'core/math/parsenode/integral\',\'core/math/parsenode/assignmentexpression\',\'core/math/parsenode/listcomprehension\',\'core/math/parsenode/functioncall\',\'core/math/parsenode/seededfunctioncall\',\'core/math/parsenode/functionexponent\',\'core/math/parsenode/functionfactorial\',\'core/math/parsenode/prime\',\'core/math/parsenode/piecewise\',\'core/math/parsenode/derivative\',\'core/math/parsenode/updaterule\',\'core/math/parsenode/histogram\',\'core/math/parsenode/object3d\',\'core/math/parsenode/dotplot\',\'core/math/parsenode/boxplot\',\'core/math/parsenode/ttest\',\'core/math/parsenode/independent-ttest\',\'core/math/parsenode/stats\',\'core/math/parsenode/assignment\',\'core/math/parsenode/functiondefinition\',\'core/math/parsenode/equation\',\'core/math/parsenode/regression\',\'core/math/parsenode/image\',\'core/math/parsenode/ticker\',\'core/math/parsenode/slider\',\'core/math/parsenode/table\',\'core/math/parsenode/tablecolumn\',\'core/math/parsenode/solvedequation\',\'core/math/parsenode/optimizedregression\',\'core/math/parsenode/seed\',\'core/math/parsenode/extendseed\',\'core/math/parsenode/irexpression\'],function(require){"use strict";var e=require("core/math/parsenode/expressionTypes"),o={Base:require("core/math/parsenode/base"),Expression:require("core/math/parsenode/expression"),Error:require("core/math/parsenode/error"),Constant:require("core/math/parsenode/constant"),MixedNumber:require("core/math/parsenode/mixednumber"),Identifier:require("core/math/parsenode/identifier"),Ans:require("core/math/parsenode/ans"),List:require("core/math/parsenode/list"),Range:require("core/math/parsenode/range"),ListAccess:require("core/math/parsenode/listaccess"),DotAccess:require("core/math/parsenode/dotaccess"),ParenSeq:require("core/math/parsenode/parenseq"),MovablePoint:require("core/math/parsenode/movablepoint"),OrderedPairAccess:require("core/math/parsenode/orderedpairaccess"),BareSeq:require("core/math/parsenode/bareseq"),BaseComparator:require("core/math/parsenode/basecomparator"),Comparator:require("core/math/parsenode/comparator"),DoubleInequality:require("core/math/parsenode/doubleinequality"),RepeatedOperator:require("core/math/parsenode/repeatedoperator"),Sum:require("core/math/parsenode/sum"),Product:require("core/math/parsenode/product"),Integral:require("core/math/parsenode/integral"),AssignmentExpression:require("core/math/parsenode/assignmentexpression"),ListComprehension:require("core/math/parsenode/listcomprehension"),FunctionCall:require("core/math/parsenode/functioncall"),SeededFunctionCall:require("core/math/parsenode/seededfunctioncall"),FunctionExponent:require("core/math/parsenode/functionexponent"),FunctionFactorial:require("core/math/parsenode/functionfactorial"),Prime:require("core/math/parsenode/prime"),Piecewise:require("core/math/parsenode/piecewise"),Derivative:require("core/math/parsenode/derivative"),UpdateRule:require("core/math/parsenode/updaterule"),Histogram:require("core/math/parsenode/histogram"),Object3D:require("core/math/parsenode/object3d"),DotPlot:require("core/math/parsenode/dotplot"),BoxPlot:require("core/math/parsenode/boxplot"),TTest:require("core/math/parsenode/ttest"),IndependentTTest:require("core/math/parsenode/independent-ttest"),Stats:require("core/math/parsenode/stats"),Assignment:require("core/math/parsenode/assignment"),FunctionDefinition:require("core/math/parsenode/functiondefinition"),Equation:require("core/math/parsenode/equation"),Regression:require("core/math/parsenode/regression"),Image:require("core/math/parsenode/image"),Ticker:require("core/math/parsenode/ticker"),Slider:require("core/math/parsenode/slider"),Table:require("core/math/parsenode/table"),TableColumn:require("core/math/parsenode/tablecolumn"),SolvedEquation:require("core/math/parsenode/solvedequation"),OptimizedRegression:require("core/math/parsenode/optimizedregression"),Seed:require("core/math/parsenode/seed"),ExtendSeed:require("core/math/parsenode/extendseed"),IRExpression:require("core/math/parsenode/irexpression")};for(var r in e)o[r]=e[r];for(var a in o)o.hasOwnProperty(a)&&"Comparator"!==a&&(o[a].prototype.type=a);for(var t in o.Comparator)o.Comparator.hasOwnProperty(t)&&(o.Comparator[t].prototype.type="Comparator[\'"+t+"\']");return o});\ndefine(\'core/math/builtinconstants\',[\'require\',\'core/math/parsenode/constant\',\'core/math/maybe-rational\'],function(require){"use strict";var t=require("core/math/parsenode/constant"),a=require("core/math/maybe-rational").maybeRational;return{pi:t(Math.PI),tau:t(2*Math.PI),e:t(Math.E),trigAngleMultiplier:t(a(1,1)),infty:t(1/0)}});\ndefine(\'core/math/builtinframe\',[\'require\',\'core/math/builtinconstants\',\'core/math/ir/builtin-table\'],function(require){"use strict";var n,i=require("core/math/builtinconstants"),t=require("core/math/ir/builtin-table"),r={};for(n in i)i.hasOwnProperty(n)&&(r[n]=i[n]);for(n in t.BuiltInTable)t.BuiltInTable.hasOwnProperty(n)&&(r[n]={isFunction:!0});for(n in t.CompilerFunctionTable)t.CompilerFunctionTable.hasOwnProperty(n)&&(r[n]={isFunction:!0});return r});\ndefine(\'core/math/finddependencyorder\',["require","exports","core/math/builtinframe","underscore"],function(require,e,r,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.findDependencyOrder=void 0,e.findDependencyOrder=function(e,i,t){var l=[],o={},a={},p={},f={},s={},h={},u={},d=0,v=[],c=[];if(!t)for(var y in t=[],i)i.hasOwnProperty(y)&&t.push(y);for(var y in i)if(i.hasOwnProperty(y)){for(var g=i[y].exportPenalty||0;l.length<g+1;)l.push([]);l[g].push(y)}for(var w=0,k=l;w<k.length;w++){for(var x={},D=0,O=k[w];D<O.length;D++){y=O[D];for(var P=i[y],b=(g=i[y].exportPenalty||0,P.isTable),m=0,M=P.getLegalExports(e);m<M.length;m++){var q=M[m];r[q]||(o[q]||(b&&(s[q]=!0),0===g&&(f[q]=!0),x[q]=x[q]||[],x[q].push(y),x[q].length>1&&(!a[q]&&b&&(p[q]=!0),a[q]=!0)))}}for(var q in x)p[q]||(o[q]=x[q])}for(var E=0,L=t;E<L.length;E++){q=L[E];u.hasOwnProperty(q)||T(q)}function T(r){u[r]=u[r]||{};var t,l=u[r];l.id=r,l.index=d,l.lowlink=d,v.push(l),l.instack=!0,d++;for(var a=0,p=i[r].getDependencies();a<p.length;a++){var f=p[a];if(o.hasOwnProperty(f))for(var s=0,y=o[f];s<y.length;s++){var g=y[s];u.hasOwnProperty(g)?(t=u[g]).instack&&(l.lowlink=Math.min(l.lowlink,t.index)):(T(g),t=u[g],l.lowlink=Math.min(l.lowlink,t.lowlink))}}if(l.lowlink===l.index)if((t=v.pop()).instack=!1,t===l)!function(e){c.push(e.id)}(l);else{for(var w=[t];(t=v.pop()).instack=!1,w.push(t),t!==l;);!function(r){for(var t=[],l=r.length-1;l>=0;l--){var o=r[l],a=i[o.id].getLegalExports(e);Array.prototype.push.apply(t,a),t.push(a[0]),c.push(o.id)}(t=n.unique(t)).sort();for(var p=0,f=t;p<f.length;p++){var s=f[p];h[s]=t}}(w)}}return{resolved:c,globallyDefined:f,tableDefined:s,multiplyDefined:a,multiplyDefinedByTables:p,cyclicallyDefined:h}}});\ndefine(\'core/math/workerconfig\',[],function(){"use strict";return{pointsOfInterest:!0,plotSingleVariableImplicitEquations:!0,plotImplicits:!0,plotInequalities:!0,sliders:!0}});\ndefine(\'core/types/graphmode\',["require","exports"],function(require,O){"use strict";Object.defineProperty(O,"__esModule",{value:!0}),O.POLYGON=O.ERROR=O.PARAMETRIC_CURVE_3D=O.Z_3D=O.OBJECT3D=O.VISUALIZATION=O.NONE=O.IMPLICIT=O.POLYGONFILL=O.POLAR=O.PARAMETRIC=O.XYPOINT_MOVABLE=O.XYPOINT=O.Y=O.X=void 0,O.X=1,O.Y=2,O.XYPOINT=3,O.XYPOINT_MOVABLE=4,O.PARAMETRIC=5,O.POLAR=6,O.POLYGONFILL=7,O.IMPLICIT=8,O.NONE=10,O.VISUALIZATION=11,O.OBJECT3D=12,O.Z_3D=13,O.PARAMETRIC_CURVE_3D=14,O.ERROR=15,O.POLYGON=16});\n!function(){var t,e,n,r,o,a,i,c,u,f,l,s,p,y,d,b,_,h,v,w,m,O,j,g,P={};!function(t){var e="object"==typeof P?P:"object"==typeof self?self:"object"==typeof this?this:{};function n(t,n){return t!==e&&("function"==typeof Object.create?Object.defineProperty(t,"__esModule",{value:!0}):t.__esModule=!0),function(e,r){return t[e]=n?n(e,r):r}}"function"==typeof define&&define.amd?define("tslib",["exports"],function(r){t(n(e,n(r)))}):"object"==typeof module&&"object"==typeof module.exports?t(n(e,n(module.exports))):t(n(e))}(function(P){var S=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])};t=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}S(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},r=function(t,e,n,r){var o,a=arguments.length,i=a<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(t,e,n,r);else for(var c=t.length-1;c>=0;c--)(o=t[c])&&(i=(a<3?o(i):a>3?o(e,n,i):o(e,n))||i);return a>3&&i&&Object.defineProperty(e,n,i),i},o=function(t,e){return function(n,r){e(n,r,t)}},a=function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},i=function(t,e,n,r){return new(n||(n=Promise))(function(o,a){function i(t){try{u(r.next(t))}catch(t){a(t)}}function c(t){try{u(r.throw(t))}catch(t){a(t)}}function u(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(i,c)}u((r=r.apply(t,e||[])).next())})},c=function(t,e){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(t,i)}catch(t){a=[6,t],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}},u=function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||g(e,t,n)},g=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]},f=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(void 0===e||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i},s=function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t},p=function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var a=arguments[e],i=0,c=a.length;i<c;i++,o++)r[o]=a[i];return r},y=function(t,e){for(var n=0,r=e.length,o=t.length;n<r;n++,o++)t[o]=e[n];return t},d=function(t){return this instanceof d?(this.v=t,this):new d(t)},b=function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(t,e||[]),a=[];return r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r;function i(t){o[t]&&(r[t]=function(e){return new Promise(function(n,r){a.push([t,e,n,r])>1||c(t,e)})})}function c(t,e){try{(n=o[t](e)).value instanceof d?Promise.resolve(n.value.v).then(u,f):l(a[0][2],n)}catch(t){l(a[0][3],t)}var n}function u(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}},_=function(t){var e,n;return e={},r("next"),r("throw",function(t){throw t}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,o){e[r]=t[r]?function(e){return(n=!n)?{value:d(t[r](e)),done:"return"===r}:o?o(e):e}:o}},h=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=f(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise(function(r,o){(function(t,e,n,r){Promise.resolve(r).then(function(e){t({value:e,done:n})},e)})(r,o,(e=t[n](e)).done,e.value)})}}},v=function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t};var x=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};w=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&g(e,t,n);return x(e,t),e},m=function(t){return t&&t.__esModule?t:{default:t}},O=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},j=function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n},P("__extends",t),P("__assign",e),P("__rest",n),P("__decorate",r),P("__param",o),P("__metadata",a),P("__awaiter",i),P("__generator",c),P("__exportStar",u),P("__createBinding",g),P("__values",f),P("__read",l),P("__spread",s),P("__spreadArrays",p),P("__spreadArray",y),P("__await",d),P("__asyncGenerator",b),P("__asyncDelegator",_),P("__asyncValues",h),P("__makeTemplateObject",v),P("__importStar",w),P("__importDefault",m),P("__classPrivateFieldGet",O),P("__classPrivateFieldSet",j)})}();\ndefine(\'core/math/poi\',["require","exports","core/math/distance"],function(require,i,t){"use strict";function r(i,r){var n;i>r&&(n=i,i=r,r=n);var e=i>0,a=r>0,s=Math.abs(i)>.01,f=Math.abs(r)>.01;if(s||f)return t.mean(i,r);if(0===i)return r*Math.abs(r);if(0===r)return i*Math.abs(i);if(e!==a)return 0;var u=e?Math.sqrt(i*r):-Math.sqrt(i*r);return u>=i&&r>=u?u:t.mean(i,r)}function n(i,t,n,s,f,u,o){var c,F,v,b;if(isFinite(s))return isFinite(t)||(c=e(i,t,n,s,o))&&(i=c[0],t=c[1]),isFinite(u)||(c=e(n,s,f,u,o))&&(f=c[0],u=c[1]),F=t===s?[i,t]:a(i,t,n,s,o,s),v=u===s?[f,u]:a(n,s,f,u,o,s),F&&v&&(b=r(F[0],v[0])),void 0!==b?[b,o(b)]:void 0}function e(i,t,n,e,a){if(isFinite(t)!==isFinite(e))for(;;){var s=r(i,n),f=a(s);if(s===i||s===n)return isFinite(t)?[i,t]:[n,e];isFinite(f)!==isFinite(t)?(n=s,e=f):(i=s,t=f)}}function a(i,t,n,e,a,s){if(t===s!=(e===s))for(;;){var f=r(i,n),u=a(f);if(f===i||f===n)return t===s?[i,t]:[n,e];u===s!=(t===s)?(n=f,e=u):(i=f,t=u)}}function s(i,t){var r=i[0],n=i[1],e=t[0],a=t[1];return(e-r)*(e-r)+(a-n)*(a-n)}function f(i,t,n,e,a,f){var u,o,c,F,v,b,M,h,m,d=f(i),l=f(t),P=f(n),p=s(d,e),C=s(l,e),O=s(P,e);if(!(t<=i||n<=t)&&isFinite(p)&&isFinite(C)&&isFinite(O)&&!(C>=p||C>=O))for(;;){if(Math.abs(P[0]-d[0])<a&&Math.abs(P[1]-d[1])<a)return[i,n];var x=r(i,t),N=f(x),q=s(N,e),E=r(t,n),J=f(E),L=s(J,e);if(!isFinite(q)||!isFinite(L))return;if(x===i||x===t||E===t||E===n)return q<C&&q<L?[x,x]:L<q&&L<C?[E,E]:[t,t];if(!(q!==C&&L!==C||q!==(C=s(l=f(t=.5*(x+t)),e))&&L!==C))return[i,n];q<C&&q<L?(n=(u=[t,x])[0],t=u[1],P=(o=[l,N])[0],l=o[1],O=(c=[C,q])[0],C=c[1]):L<q&&L<C?(i=(F=[t,E])[0],t=F[1],d=(v=[l,J])[0],l=v[1],p=(b=[C,L])[0],C=b[1]):(i=(M=[x,E])[0],n=M[1],d=(h=[N,J])[0],P=h[1],p=(m=[q,L])[0],O=m[1])}}function u(i,t,r){return void 0===t&&(t=-1/0),void 0===r&&(r=1/0),Math.min(r,Math.max(t,i))}function o(i,t,r,n,e,a){var o,c,F,v,b;void 0!==n&&void 0!==e?b=r+.01*(r<.5*(n+e)?e-n:n-e):b=Math.abs(r)>1?1.00001*r:r+1e-5;var M=i(r),h=i(b),m=s(M,t),d=s(h,t);if(isFinite(m)&&isFinite(d)){if(m===d)return[r,b];for(d>m&&(r=(o=[b,r])[0],b=o[1],M=(c=[h,M])[0],h=c[1],m=(F=[d,m])[0],d=F[1]);isFinite(r)&&isFinite(b)&&r!==b;){if(void 0!==e&&b>e)return[e,e];if(void 0!==n&&b<n)return[n,n];var l=r+3*(b-r),P=s(i(l),t);if(!isFinite(P))return[r,b];if(P===d)return[r,b];if(P>d){var p=b>r?f(r,b,l,t,a,i):f(l,b,r,t,a,i);return p?[u(p[0],n,e),u(p[1],n,e)]:p}r=(v=[b,d,l,P])[0],m=v[1],b=v[2],d=v[3]}return[r,b]}}function c(i,t,r,n){return!r||!!n&&Math.min(s(i(n[0]),t),s(i(n[1]),t))<Math.min(s(i(r[0]),t),s(i(r[1]),t))}function F(i,t,r,n,e,a,s,f){var u=Math.abs(n-t),o=Math.abs(a-n),c=Math.abs(f-a);return u>o&&u>c?[[i,t],[r,n]]:c>o&&c>u?[[e,a],[s,f]]:[[r,n],[e,a]]}Object.defineProperty(i,"__esModule",{value:!0}),i.bisectJump=i.findLocalClosestPointOnParametric=i.clamp=i.bisectClosestPointOnParametric=i.bisectExtremum=i.bisectFinite=i.flatCenter=i.bisectZero=i.floatMiddle=void 0,i.floatMiddle=r,i.bisectZero=function(i,t,e,a,s){if(!isNaN(t)&&!isNaN(a)&&t<0!=a<0)for(;;){var f=r(i,e),u=s(f);if(!isFinite(u))return;if(f===i||f===e)return Math.abs(t)<=Math.abs(a)?[i,t]:[e,a];if(0===u)return n(i,t,f,u,e,a,s);t<0!=u<0?(e=f,a=u):(i=f,t=u)}},i.flatCenter=n,i.bisectFinite=e,i.bisectExtremum=function(i,t,e,a,s,f,u){if(i<e&&e<s&&isFinite(t)&&isFinite(a)&&isFinite(f)&&t!==a&&a!==f&&a>t==a>f)for(;;){var o=r(i,e),c=u(o),F=r(e,s),v=u(F);if(!isFinite(c)||!isFinite(v))return;if(o===i||o===e||F===e||F===s)return c>a==a>t?[o,c]:v>a==a>t?[F,v]:[e,a];if(c===a||v===a)return n(i,t,e,a,s,f,u);c>t==a>t&&c>t==c>a?(s=e,f=a,e=o,a=c):v>f==a>f&&v>a==v>f?(i=e,t=a,e=F,a=v):(i=o,t=c,s=F,f=v)}},i.bisectClosestPointOnParametric=f,i.clamp=u,i.findLocalClosestPointOnParametric=function(i,t,r,n,e,a){var s=o(i,t,r,n,e,a);if(void 0!==n){var f=o(i,t,n,n,e,a);c(i,t,s,f)&&(s=f)}if(void 0!==e){var u=o(i,t,e,n,e,a);c(i,t,s,u)&&(s=u)}return s},i.bisectJump=function(i,n,a,s,f,u,o,c){if(c||(c=0),!((a-i)*(f-a)<=0)&&isFinite(i)&&isFinite(a)&&isFinite(f)&&isFinite(n)&&isFinite(u)){if(!isFinite(s)){var v=e(i,n,a,s,o),b=e(a,s,f,u,o);if(!v||!b)return;return[v,b]}if(!(Math.abs(s-((f-a)*n+(a-i)*u)/(f-i))<c))for(;;){var M=r(i,a),h=o(M),m=r(a,f),d=o(m),l=Math.abs(h-t.mean(n,s)),P=Math.abs(s-t.mean(h,d)),p=Math.abs(d-t.mean(s,u));if(l<=c&&P<=c&&p<=c)return;if(!isFinite(h)){v=e(i,n,M,h,o),b=e(M,h,f,u,o);if(!v||!b)return;return[v,b]}if(!isFinite(d)){v=e(i,n,m,d,o),b=e(m,d,f,u,o);if(!v||!b)return;return[v,b]}if(!(M!==i&&M!==a||m!==a&&m!==f))return Math.abs(s-n)>Math.abs(u-s)?[[i,n],[a,s]]:[[a,s],[f,u]];if(M===i||M===a)return F(i,n,a,s,m,d,f,u);if(m===a||m===f)return F(i,n,M,h,a,s,f,u);l>p&&l>=P?(f=a,u=s,a=M,s=h):p>l&&p>=P?(i=a,n=s,a=m,s=d):(i=M,n=h,f=m,u=d)}}}});\ndefine(\'core/math/curve-accumulator\',["require","exports","core/math/distance"],function(require,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Accumulator=void 0;var i=function(){function t(t){t?(this.xtolerance=t.xtolerance||t.tolerance||0,this.ytolerance=t.ytolerance||t.tolerance||0,this.ztolerance=t.ztolerance||t.tolerance||0,this.map=t.map):this.xtolerance=this.ytolerance=this.ztolerance=0,this.segments=[],this.segment=[],this.pivotPoint=void 0,this.pendingPoint=void 0}return t.prototype.colinear=function(t,i,n){this.map&&(t=this.map(t),i=this.map(i),n=this.map(n));var s=e.pointToSegmentParameter(n[0],n[1],n[2]||0,t[0],t[1],t[2]||0,i[0],i[1],i[2]||0);if(s<1)return!1;var h=[t[0]+s*(i[0]-t[0]),t[1]+s*(i[1]-t[1]),3===t.length?t[2]+s*(i[2]-t[2]):0];return Math.abs(n[0]-h[0])<=this.xtolerance&&Math.abs(n[1]-h[1])<=this.ytolerance&&(2===t.length||Math.abs(n[2]-h[2])<=this.ztolerance)},t.prototype.addPoint=function(t){if(this.dimensions=t.length,this.xtolerance<0&&this.ytolerance<0&&(2===this.dimensions||this.ztolerance<0))this.segment.push.apply(this.segment,t);else if(this.segment.length){var i=2===this.dimensions?[this.segment[this.segment.length-2],this.segment[this.segment.length-1]]:[this.segment[this.segment.length-3],this.segment[this.segment.length-2],this.segment[this.segment.length-1]];if(t[0]!==i[0]||t[1]!==i[1]||t[2]!==i[2]){if(!this.pivotPoint||!this.pendingPoint)return this.pivotPoint=t,void(this.pendingPoint=t);(!this.colinear(i,this.pivotPoint,t)||e.hypot(i[0]-t[0],i[1]-t[1],(i[2]||0)-(t[2]||0))<e.hypot(i[0]-this.pendingPoint[0],i[1]-this.pendingPoint[1],(i[2]||0)-(this.pendingPoint[2]||0)))&&(this.flushPending(),this.pivotPoint=t),this.pendingPoint=t}}else this.segment.push.apply(this.segment,t)},t.prototype.flushPending=function(){this.pendingPoint&&(this.segment.push.apply(this.segment,this.pendingPoint),this.pivotPoint=void 0,this.pendingPoint=void 0)},t.prototype.breakSegment=function(){this.flushPending(),this.segment.length>(this.dimensions||2)&&this.segments.push(this.segment),this.segment=[]},t.prototype.getSegments=function(){return this.breakSegment(),this.segments},t.prototype.finish=function(){return{segments:this.getSegments(),resolved:!0}},t}();t.Accumulator=i});\ndefine(\'core/math/implicit-plotter\',["require","exports","core/math/distance","./curve-accumulator"],function(require,e,r,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.displayTriangles=e.traceContours=e.triangulate=e.buildQuadTree=e.sampleImplicitDiagnostic=e.sampleImplicit=void 0;var n=Math.pow(2,14);function t(e,r){var i=Math.pow(2,-5),n=u(r,i),t=u(r,2*i),c=v(e,n,t),a=k(c.root,e,n);return{paddedDomain:n,rootDomain:t,quadTree:c,triangles:a,contours:I(a,e,n)}}function c(e,r,i){return{x:e,y:r,z:i}}function a(e,r,i){return{x:e,y:r,isZero:i}}function s(e,r,i){return{vertices:[e,r,i],visited:!1,next:void 0}}function u(e,r){var i=(1+r)*e.xmin-r*e.xmax,n=(1+r)*e.xmax-r*e.xmin;return{xmin:i,ymin:(1+r)*e.ymin-r*e.ymax,xmax:n,ymax:(1+r)*e.ymax-r*e.ymin,xtolerance:e.xtolerance,ytolerance:e.ytolerance}}function o(e,r){return{depth:e,vertices:r,children:void 0,center:void 0}}function l(e,r,i){e.center=p(e.vertices[0],e.vertices[1],e.vertices[2],e.vertices[3],r,i)}function v(e,r,i){var t=function(e,r){var i=r.xmin,n=r.xmax,t=r.ymin,c=r.ymax;return o(0,[m(i,c,e),m(n,c,e),m(n,t,e),m(i,t,e)])}(e,i),c=[],a=[];a.push(t);var s=1,u=!0;e:for(;a.length;){var v=c;c=a,a=v;for(var h=void 0;h=c.pop();)if(d(h,e,r)){if(f(h,e),!h.children){u=!1;break e}if(a.push(h.children[0]),a.push(h.children[1]),a.push(h.children[2]),a.push(h.children[3]),(s+=3)>=n){u=!1;break e}}else l(h,e,r)}for(var x=0;x<c.length;x++)l(c[x],e,r);for(x=0;x<a.length;x++)l(a[x],e,r);return{root:t,resolved:u}}function f(e,r){var i=e.depth+1,n=e.vertices[0],t=e.vertices[1],c=e.vertices[2],a=e.vertices[3],s=y(n,t,r),u=y(t,c,r),l=y(c,a,r),v=y(a,n,r),f=y(n,c,r);e.children=[o(i,[n,s,f,v]),o(i,[s,t,u,f]),o(i,[f,u,c,l]),o(i,[v,f,l,a])]}function d(e,r,i){if(e.depth<5)return!0;if(function(e,r){return e.vertices[0].x<r.xmin||e.vertices[0].y>r.ymax||e.vertices[2].x>r.xmax||e.vertices[2].y<r.ymin}(e,i))return!1;if(function(e,r){if(e.vertices[1].x-e.vertices[0].x<10*r.xtolerance)return!0;if(e.vertices[0].y-e.vertices[3].y<10*r.ytolerance)return!0;return!1}(e,i))return!1;var n=e.vertices[0],t=e.vertices[1],c=e.vertices[2],a=e.vertices[3];if(isNaN(n.z)&&isNaN(t.z)&&isNaN(c.z)&&isNaN(a.z))return!1;if(isNaN(n.z)||isNaN(t.z)||isNaN(c.z)||isNaN(a.z))return!0;var s=p(n,t,c,a,r,i),u=N(n,t,r,i),o=N(t,c,r,i),l=N(c,a,r,i),v=N(a,n,r,i);return x(n,u,r)||x(t,u,r)||x(t,o,r)||x(c,o,r)||x(c,l,r)||x(a,l,r)||x(a,v,r)||x(n,v,r)||h(n,u,s,r,i)||h(u,t,s,r,i)||h(t,o,s,r,i)||h(o,c,s,r,i)||h(c,l,s,r,i)||h(l,a,s,r,i)||h(a,v,s,r,i)||h(v,n,s,r,i)}function h(e,i,n,t,c){if(e.z>0==i.z>0&&i.z>0==n.z>0)return!1;var a,s,u,o;if(e.z>0==i.z>0){if((a=y(e,i,t)).z>0!=e.z>0)return!0;s=b(e,n,t,c),u=b(i,n,t,c),o=b(a,n,t,c)}else if(i.z>0==n.z>0){if((a=y(i,n,t)).z>0!=i.z>0)return!0;s=b(i,e,t,c),u=b(n,e,t,c),o=b(a,e,t,c)}else{if((a=y(n,e,t)).z>0!=n.z>0)return!0;s=b(n,i,t,c),u=b(e,i,t,c),o=b(a,i,t,c)}var l=c.xtolerance,v=c.ytolerance;return r.pointToSegment(v*o.x,l*o.y,v*s.x,l*s.y,v*u.x,l*u.y)>l*v}function x(e,r,i){if(isNaN(e.z)&&isNaN(r.z))return!1;if(isNaN(e.z)||isNaN(r.z))return e.z>0||r.z>0;var n=4*y(e,r,i).z-r.z-3*e.z,t=1e-4,c=(i(.9999*e.x+t*r.x,.9999*e.y+t*r.y)-e.z)/t,a=Math.max(Math.abs(e.z),Math.abs(r.z));return Math.abs(n-c)>.125*a}function z(e,r){return e.x<r.xmin||e.x>r.xmax||e.y<r.ymin||e.y>r.ymax}function m(e,r,i){return c(e,r,i(e,r))}function y(e,r,i){return m(.5*(e.x+r.x),.5*(e.y+r.y),i)}function N(e,r,i,n){if(z(e,n)||z(r,n))return y(e,r,i);if(isNaN(e.z)||isNaN(r.z))return function(e,r,i,n){if(isNaN(e.z)===isNaN(r.z))return y(e,r,i);if(isNaN(e.z)){var t=e;e=r,r=t}var a=e.x,s=r.x,u=e.y,o=r.y,l=e.z,v=n.xtolerance,f=n.ytolerance;for(;Math.abs(a-s)>v||Math.abs(u-o)>f;){var d=.5*(a+s),h=.5*(u+o),x=i(d,h);isNaN(x)===isNaN(l)?(a=d,u=h,l=x):(s=d,o=h)}return c(a,u,l)}(e,r,i,n);if(e.z>0!=r.z>0)return y(e,r,i);var t=.01,a=i(.99*e.x+t*r.x,.99*e.y+t*r.y)-e.z,s=r.z-i(t*e.x+.99*r.x,t*e.y+.99*r.y);return isNaN(a)||isNaN(s)||a>0==s>0?y(e,r,i):g(c(e.x,e.y,a),c(r.x,r.y,s),i)}function p(e,r,i,n,t,c){var a=N(e,i,t,c);return e.z>0==i.z>0&&a.z>0!=e.z>0?a:(a=N(r,n,t,c),r.z>0==n.z>0&&a.z>0!=r.z>0?a:y(e,i,t))}function g(e,r,i){if(isNaN(e.z))return r;if(isNaN(r.z))return e;if(isFinite(e.z)||isFinite(r.z)){if(isFinite(e.z)){if(isFinite(r.z)){var n=1-e.z/r.z,t=1-r.z/e.z;return m(e.x/n+r.x/t,e.y/n+r.y/t,i)}return e}return r}return y(e,r,i)}function b(e,r,i,n){var t=e.x,s=r.x,u=e.y,o=r.y,l=e.z,v=r.z,f=n.xtolerance,d=n.ytolerance;if(z(e,n)||z(r,n)){var h=y(e,r,i);return a(h.x,h.y,!1)}for(;Math.abs(t-s)>f||Math.abs(u-o)>d;){var x=.5*(t+s),m=.5*(u+o),N=i(x,m);N>0==l>0?(t=x,u=m,l=N):(s=x,o=m,v=N)}if(isNaN(l))return a(s,o,!1);if(isNaN(v))return a(t,u,!1);var p=g(c(t,u,l),c(s,o,v),i),b=0===l||0===v||0===p.z||p.z>=l==v>=p.z&&Math.abs(p.z)<1e250;return a(p.x,p.y,b)}function k(e,r,i){var n={triangles:[],edgeCache:{},domain:i,fn:r};return M(e,n),n.triangles}function M(e,r){e.children&&(M(e.children[0],r),M(e.children[1],r),M(e.children[2],r),M(e.children[3],r),A(e.children[0],e.children[1],r),A(e.children[3],e.children[2],r),S(e.children[1],e.children[2],r),S(e.children[0],e.children[3],r))}function A(e,r,i){e.children&&r.children?(A(e.children[1],r.children[0],i),A(e.children[2],r.children[3],i)):e.children?(A(e.children[1],r,i),A(e.children[2],r,i)):r.children?(A(e,r.children[0],i),A(e,r.children[3],i)):function(e,r,i){if(!e.center||!r.center)return;var n,t;e.depth>=r.depth?(n=N(e.vertices[1],e.vertices[2],i.fn,i.domain),t=T(e.vertices[1],r.center,e.vertices[2],e.center,n)):(n=N(r.vertices[0],r.vertices[3],i.fn,i.domain),t=T(r.vertices[0],r.center,r.vertices[3],e.center,n));D(t,i.edgeCache,i.domain);for(var c=0;c<4;c++)i.triangles.push(t[c])}(e,r,i)}function S(e,r,i){e.children&&r.children?(S(e.children[2],r.children[1],i),S(e.children[3],r.children[0],i)):e.children?(S(e.children[2],r,i),S(e.children[3],r,i)):r.children?(S(e,r.children[1],i),S(e,r.children[0],i)):function(e,r,i){if(!e.center||!r.center)return;var n,t;e.depth>=r.depth?(n=N(e.vertices[3],e.vertices[2],i.fn,i.domain),t=T(e.vertices[2],r.center,e.vertices[3],e.center,n)):(n=N(r.vertices[1],r.vertices[0],i.fn,i.domain),t=T(r.vertices[1],r.center,r.vertices[0],e.center,n));D(t,i.edgeCache,i.domain);for(var c=0;c<4;c++)i.triangles.push(t[c])}(e,r,i)}function T(e,r,i,n,t){return[s(e,t,r),s(r,t,i),s(i,t,n),s(n,t,e)]}function C(e,r,i){return e.z>0&&!z(e,i)&&(!(r.z>0)||z(r,i))}function w(e,r){return e.x+","+e.y+","+r.x+","+r.y}function D(e,r,i){F(e[0],e[1],e[2],w(e[1].vertices[2],e[1].vertices[0]),r,i),F(e[1],e[2],e[3],w(e[2].vertices[0],e[2].vertices[2]),r,i),F(e[2],e[3],e[0],w(e[3].vertices[2],e[3].vertices[0]),r,i),F(e[3],e[0],e[1],w(e[0].vertices[0],e[0].vertices[2]),r,i)}function F(e,r,i,n,t,c){var a=r.vertices[0],s=r.vertices[1],u=r.vertices[2];C(s,u,c)&&(r.next=i),C(a,s,c)&&(r.next=e),C(u,a,c)&&function(e,r,i){i[r]?e.next=i[r]:i[r]=e}(r,n,t),C(a,u,c)&&function(e,r,i){i[r]?i[r].next=e:i[r]=e}(r,n,t)}function I(e,r,n){for(var t={fillAccumulator:new i.Accumulator(n),strokeAccumulator:new i.Accumulator(n),fn:r,domain:n},c=0;c<e.length;c++){var a=e[c];a.next&&!a.visited&&q(a,t)}return{strokeSegments:t.strokeAccumulator.finish().segments,fillSegments:t.fillAccumulator.finish().segments}}function q(e,r){for(;;){var i=e.vertices[0],n=e.vertices[1],t=e.vertices[2];if(P(i,n,r),P(n,t,r),P(t,i,r),e.visited)break;if(!e.next)break;e.visited=!0,e=e.next}r.strokeAccumulator.breakSegment(),r.fillAccumulator.breakSegment()}function P(e,r,i){if(C(e,r,i.domain)){var n=b(e,r,i.fn,i.domain);i.fillAccumulator.addPoint([n.x,n.y]),n.isZero?i.strokeAccumulator.addPoint([n.x,n.y]):i.strokeAccumulator.breakSegment()}}e.sampleImplicit=function(e,r){var i=t(e,r);return{segments:i.contours.strokeSegments,fillSegments:i.contours.fillSegments,resolved:i.quadTree.resolved}},e.sampleImplicitDiagnostic=t,e.buildQuadTree=v,e.triangulate=k,e.traceContours=I,e.displayTriangles=function(e){for(var r=[],i=0;i<e.length;i++){var n=e[i];r.push([n.vertices[0].x,n.vertices[0].y,n.vertices[1].x,n.vertices[1].y,n.vertices[2].x,n.vertices[2].y,n.vertices[0].x,n.vertices[0].y])}return r}});\ndefine(\'core/math/poi-finding-accumulator\',["require","exports","core/math/workerconfig","tslib","./curve-accumulator","./poi"],function(require,e,t,i,r,s){"use strict";function u(e){return Math.abs(e)<5e-8}Object.defineProperty(e,"__esModule",{value:!0});var f=function(e){function r(t,i,r){var s=e.call(this,t)||this;return s.domain=t,s.fn=i,s.derivative=r,s.poiData={zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}},s.zeroBuffer=[],s.extremumBuffer=[],s}return i.__extends(r,e),r.prototype.getPOI=function(){return t.pointsOfInterest?(void 0!==this.fn&&(this.poiData.intercept=this.findIntercept(this.fn)),this.poiData):{zeros:{x:[],y:[]},intercept:{x:[],y:[]},extrema:{x:[],y:[]}}},r.prototype.addLinearZero=function(e){var t=-e[0]/e[1];this.isOutsideDomain(t)||(this.poiData.zeros={x:[t],y:[0]})},r.prototype.addLinearIntercept=function(e){this.isOutsideDomain(0)||(this.poiData.intercept={x:[0],y:[e[0]]})},r.prototype.isOutsideDomain=function(e){return!this.domain||void 0===this.domain.min||void 0===this.domain.max||(e<this.domain.min||e>this.domain.max||isNaN(e))},r.prototype.addPoint=function(t){0===this.segment.length&&u(t[1])&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.updateZeroBuffer(t),this.updateExtremumBuffer(t),e.prototype.addPoint.call(this,t)},r.prototype.updateZeroBuffer=function(e){if(this.fn)if(isFinite(e[0])&&isFinite(e[1]))switch(this.zeroBuffer.length){case 0:if(u(e[1]))return;return void this.zeroBuffer.push(e);case 1:return 0===e[1]?void this.zeroBuffer.push(e):e[1]>0!=this.zeroBuffer[0][1]>0?((t=s.bisectZero(this.zeroBuffer[0][0],this.zeroBuffer[0][1],e[0],e[1],this.fn))&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.zeroBuffer.length=0,void this.zeroBuffer.push(e)):(this.zeroBuffer.length=0,void this.zeroBuffer.push(e));case 2:if(0===e[1])return;var t;return e[1]>0!=this.zeroBuffer[0][1]>0?((t=s.flatCenter(this.zeroBuffer[0][0],this.zeroBuffer[0][1],this.zeroBuffer[1][0],this.zeroBuffer[1][1],e[0],e[1],this.fn))&&(this.poiData.zeros.x.push(t[0]),this.poiData.zeros.y.push(t[1])),this.zeroBuffer.length=0,void this.zeroBuffer.push(e)):(this.zeroBuffer.length=0,void this.zeroBuffer.push(e))}else this.zeroBuffer.length=0},r.prototype.updateExtremumBuffer=function(e){if(this.fn)if(isFinite(e[0])&&isFinite(e[1]))switch(this.extremumBuffer.length){case 0:return void this.extremumBuffer.push(e);case 1:return e[1]===this.extremumBuffer[0][1]&&(this.extremumBuffer.length=0),void this.extremumBuffer.push(e);case 2:if(e[1]===this.extremumBuffer[1][1])return void this.extremumBuffer.push(e);if(e[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){if(t=this.bisectExtremumUsingDerivative(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],e[0],e[1]))this.poiData.extrema.x.push(t[0]),this.poiData.extrema.y.push(t[1]),!!!s.bisectJump(this.extremumBuffer[0][0],this.extremumBuffer[0][1],t[0],t[1],e[0],e[1],this.fn,this.ytolerance)&&t[0]>this.segment[this.segment.length-2]&&(this.pendingPoint=t);return this.extremumBuffer.shift(),void this.extremumBuffer.push(e)}return this.extremumBuffer.shift(),void this.extremumBuffer.push(e);case 3:if(e[1]===this.extremumBuffer[1][1])return;if(e[1]>this.extremumBuffer[1][1]!=this.extremumBuffer[1][1]>this.extremumBuffer[0][1]){var t=void 0,i=.5*(this.extremumBuffer[1][0]+this.extremumBuffer[2][0]),r=this.fn(i);return(t=r===this.extremumBuffer[1][1]?s.flatCenter(this.extremumBuffer[0][0],this.extremumBuffer[0][1],this.extremumBuffer[1][0],this.extremumBuffer[1][1],e[0],e[1],this.fn):this.bisectExtremumUsingDerivative(this.extremumBuffer[1][0],this.extremumBuffer[1][1],i,r,this.extremumBuffer[2][0],this.extremumBuffer[2][1]))&&(this.poiData.extrema.x.push(t[0]),this.poiData.extrema.y.push(t[1])),this.extremumBuffer.shift(),this.extremumBuffer.shift(),void this.extremumBuffer.push(e)}return this.extremumBuffer.shift(),this.extremumBuffer.shift(),void this.extremumBuffer.push(e)}else this.zeroBuffer.length=0},r.prototype.bisectExtremumUsingDerivative=function(e,t,i,r,u,f){if(this.fn){var h;if(this.derivative){var n=this.derivative(e),m=this.derivative(u);if(!isNaN(n)&&!isNaN(m)&&n<0!=m<0){var o=s.bisectZero(e,n,u,m,this.derivative);o&&(h=[o[0],this.fn(o[0])])}}return h||(h=s.bisectExtremum(e,t,i,r,u,f,this.fn)),h}},r.prototype.breakSegment=function(){this.zeroBuffer.length=0,this.extremumBuffer.length=0,this.flushPending(),this.segment.length>2&&(this.segments.push(this.segment),u(this.segment[this.segment.length-1])&&(this.poiData.zeros.x.push(this.segment[this.segment.length-2]),this.poiData.zeros.y.push(this.segment[this.segment.length-1]))),this.segment=[]},r.prototype.findIntercept=function(e){if(!e)return{x:[],y:[]};var t=e(0);return isFinite(t)?{x:[0],y:[e(0)]}:{x:[],y:[]}},r.prototype.finish=function(){return{segments:this.getSegments(),resolved:!0,poi:this.getPOI()}},r}(r.Accumulator);e.default=f});\ndefine(\'core/math/copy-defined-pois\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.default=function(e){for(var r=[],t=[],u=e.length,n=0;n<u;n++)r.push(e[n][0]),t.push(e[n][1]);return{defined:{x:r,y:t}}}});\ndefine(\'core/math/plotter\',["require","exports","tslib","core/math/distance","./poi","./implicit-plotter","./curve-accumulator","./poi-finding-accumulator","core/types/graphmode","./domaintypes","core/math/copy-defined-pois"],function(require,e,n,i,t,r,a,o,s,m,c){"use strict";function l(e,n){var i=new o.default(n),t=e[0]+n.min*e[1],r=e[0]+n.max*e[1];return isFinite(t)&&isFinite(r)?(i.addPoint([n.min,t]),i.addPoint([n.max,r]),i.addLinearZero(e),i.addLinearIntercept(e),i.finish()):i.finish()}function u(e,i){var t=e(i);return{segments:[n.__spreadArray(n.__spreadArray([],t),t)],resolved:!0}}function d(e,n,r){var a=r.fn,o=r.jumpTolerance,s=e[0],m=e[1],c=n[0],l=n[1],u=i.mean(s,c),d=a(u);return t.bisectJump(s,m,u,d,c,l,a,o)}Object.defineProperty(e,"__esModule",{value:!0}),e.errorBranch=void 0,e.errorBranch=function(e){return{graphMode:s.ERROR,error:e,segments:[]}};var p=function(e,n,i){var t=i.fn,r=i.jumpTolerance,a=i.accumulator;if(!isFinite(r)||r<=0)return n;var o=d(e,n,i);if(!o)return n;for(var s=(n[0]-e[0])/10,m=[-s,s],c=n,l=0;l<m.length;l++){var u=e[0]+m[l],p=t(u);isFinite(p)||(u=e[0],p=e[1],u=e[0],p=e[1]);var f=n[0]+m[l],h=t(f);if(isFinite(h)?c=[f,h]:(f=n[0],h=n[1]),d([u,p],[f,h],i)){var v=o[0],g=o[1];return a.addPoint(v),a.breakSegment(),a.addPoint(g),n}}return c},f=function(e,n,i){this.derivative=i,this.accumulator=new o.default(n,e,i),this.fn=e,this.jumpTolerance=n.ytolerance||n.tolerance||0};function h(e,n,i){var t=n,r=e(t);return isFinite(r)||(r=e(t=n+i)),isFinite(r)||(r=e(t=n-i)),[t,r]}function v(e,n,i){var r,a,o,s,m,c,l,u=new f(e,n,i),d=n.step/10,v=n.min,g=[l=(r=h(e,v,d))[0],c=r[1]];isFinite(c)&&u.accumulator.addPoint([l,c]);for(var x=Math.ceil((n.max-n.min)/n.step),y=1;y<=x;y++)l=(a=h(e,v=(x-y)/x*n.min+y/x*n.max,d))[0],c=a[1],isFinite(c)&&isFinite(g[1])?(l=(o=p(g,[l,c],u))[0],c=o[1],u.accumulator.addPoint([l,c])):isFinite(c)&&!isFinite(g[1])?(m=t.bisectFinite(g[0],g[1],l,c,e))&&(m[0]!==l&&u.accumulator.addPoint(m),l=(s=p(m,[l,c],u))[0],c=s[1],u.accumulator.addPoint([l,c])):!isFinite(c)&&isFinite(g[1])&&(m=t.bisectFinite(g[0],g[1],l,c,e))&&((m=p(g,m,u))[0]!==g[0]&&u.accumulator.addPoint(m),u.accumulator.breakSegment()),g=[l,c];return u.accumulator.finish()}function g(e,n,i,t){var r,a,o,s=n.min,m=n.max-n.min,c=n.xtolerance&&n.ytolerance?Math.min(n.xtolerance,n.ytolerance):n.tolerance?n.tolerance:0,l=Math.floor(m/(Math.PI/i));function u(e,n){var r=n%2==0?1:-1;if(!t&&-1===r)return!1;for(var a=n*(Math.PI/i),o=[s,s+1,s+2,s+3],m=!1,l=0,u=o.length;l<u;l++){var d=e(o[l]),p=e(o[l]+a);if(isFinite(d)&&isFinite(p)&&(m=!0),isFinite(d)!==isFinite(p)||Math.abs(d-r*p)>c)return!1}return!!m}for(r=1;r<=l;r++)if(u(e,r)){for(o=r,a=2;a*r<=l;a++)u(e,a*r)||(o=void 0);if(o)break}return o?o*(Math.PI/i):null}function x(e){return[e[1]*Math.cos(e[0]),e[1]*Math.sin(e[0])]}function y(e,n){return n.map=x,v(e,n)}function F(e,n){if(n.max<n.min)return{segments:[],resolved:!0};var i,t=new a.Accumulator(n),r=n.min,o=e(r);return isFinite(o[0])&&isFinite(o[1])&&t.addPoint(o),function(e,n){for(var i=e.min,t=e.max,r=e.step,a=t-i,o=Math.ceil(a/r),s=a/o,m=0;m<o;m++)n(i+m*s);n(t)}(n,function(n){i=e(n),w(e,r,o,n,i,10,t),r=n,o=i}),t.finish()}function w(e,n,t,r,a,o,s){if(r!==n){var m=s.xtolerance,c=s.ytolerance,l=s.ztolerance,u=i.mean(n,r),d=e(u),p=isFinite(t[0])&&isFinite(t[1])&&(2===t.length||isFinite(t[2])),f=isFinite(a[0])&&isFinite(a[1])&&(2===a.length||isFinite(a[2])),h=isFinite(d[0])&&isFinite(d[1])&&(2===d.length||isFinite(d[2]));if(0===o||u===n||u===r)return s.breakSegment(),void(f&&s.addPoint(a));if(p||f)if(p===f){if(p&&h&&f){var v=i.pointToSegmentParameter(d[0],d[1],d[2]||0,t[0],t[1],t[2]||0,a[0],a[1],a[2]||0);if(v>.2&&v<.8&&Math.abs(d[0]-(t[0]+v*(a[0]-t[0])))<=m&&Math.abs(d[1]-(t[1]+v*(a[1]-t[1])))<=c&&(2===t.length||Math.abs(d[2]-(t[2]+v*(a[2]-t[2])))<=l))return void s.addPoint(a)}t[0]===d[0]&&t[1]===d[1]||w(e,n,t,u,d,o-1,s),a[0]===d[0]&&a[1]===d[1]||w(e,u,d,r,a,o-1,s)}else{for(var g=n,x=r,y=t,F=a;n!==u&&u!==r;)h==p?(n=u,t=d,p=h):(r=u,a=d,f=h),d=e(u=n+(r-n)/2),h=isFinite(d[0])&&isFinite(d[1])&&(2===d.length||isFinite(d[2]));p?(w(e,g,y,n,t,o-1,s),s.breakSegment()):(s.breakSegment(),s.addPoint(a),w(e,r,a,x,F,o-1,s))}}}function P(e,n,i){var t=e.viewport.xmin,r=e.viewport.xmax,a=e.viewport.ymin,o=e.viewport.ymax,c=n.lineWidth;if(c>3){var l=c*(r-t)/e.screen.width,u=c*(o-a)/e.screen.height;t-=l,r+=l,a-=u,o+=u}var d,p,f=e.trigAngleMultiplier||1,h=e.oversample||4,v=1/h*(r-t)/e.screen.width,x=1/h*(o-a)/e.screen.height,y=n.domainBound;switch(n.graphMode){case s.X:switch((d=m.intersectDomains(m.knownDomain([a,o]),y)).type){case"empty":return!1;case"known":a=d.bounds[0],o=d.bounds[1]}p={min:a,max:o,xtolerance:x,ytolerance:v,step:x};break;case s.Y:switch((d=m.intersectDomains(m.knownDomain([t,r]),y)).type){case"empty":return!1;case"known":t=d.bounds[0],r=d.bounds[1]}p={min:t,max:r,xtolerance:v,ytolerance:x,step:v};break;case s.POLAR:if(!n.domain)throw new Error("Expected polar graph to have domain");if(p={min:n.domain.min,max:n.domain.max,step:2*Math.PI/f/1e3,tolerance:Math.min(v,x)},!n.domain.isExplicit){var F=g(i,p,f,"="===n.operator);F&&(p.max=p.min+F)}p.step=Math.max(p.step,(p.max-p.min)/11999);break;case s.PARAMETRIC:case s.PARAMETRIC_CURVE_3D:var w=n.domain?n.domain.min:0,P=n.domain?n.domain.max:1,M=n.domain?n.domain.step:.01;switch((d=m.intersectDomains(m.knownDomain([w,P]),y)).type){case"empty":return!1;case"known":w=d.bounds[0],P=d.bounds[1]}p={min:w,max:P,step:M,xtolerance:v,ytolerance:x,ztolerance:Math.min(v,x)};break;case s.IMPLICIT:p={xmin:t,xmax:r,ymin:a,ymax:o,xtolerance:v,ytolerance:x};break;case s.Z_3D:return{xmin:-10,xmax:10,ymin:-10,ymax:10};default:return!1}return p}function M(e,n,i){var t,r,a,o,m=[],c=null;switch(i){case s.POLAR:c=x;break;case s.X:c=function(e){return[e[1],e[0]]}}for(t=0;t<e.length;t++)for(o=e[t],r=0;r<o.length;r+=2)a=[o[r],o[r+1]],c&&(a=c(a)),m.push(a[0],a[1]);for(t=n.length-1;t>=0;t--)for(r=(o=n[t]).length-2;r>=0;r-=2)a=[o[r],o[r+1]],c&&(a=c(a)),m.push(a[0],a[1]);return m}function b(e){for(var n=[],i={},t=0;t<e.length;t++){var r=e[t],a=r[0],o=r[1];isNaN(a)||isNaN(o)?i[t]=!0:n.push(r)}return{points:n,droppedIndices:i}}e.default={sampleLinear:l,sampleXY:v,findPiPeriod:g,samplePolar:y,sampleParametricRecursive:F,subsampleParametricRecursive:w,validateViewState:function(e){if(!e)return!1;var n=e.viewport.xmin,i=e.viewport.xmax,t=e.viewport.ymin,r=e.viewport.ymax;return!(!isFinite(n)||!isFinite(i)||i<=n)&&(!(!isFinite(t)||!isFinite(r)||r<=t)&&(!(!isFinite(e.screen.width)||e.screen.width<=0)&&!(!isFinite(e.screen.height)||e.screen.height<=0)))},computeDomain:P,computeGraphData:function(e){var n,i,t,a=e.viewState,o=e.graphInfo,m=e.compiled,c=e.derivative,d=m.fn,p=P(a,o,d),f=o.graphMode;if(p){switch(f){case s.X:case s.Y:var h=c?c.fn:void 0;n=o.isLinear?l(o.linearCoefficients,p):v(d,p,h);break;case s.POLAR:n=y(d,p);break;case s.IMPLICIT:n=r.sampleImplicit(d,p);break;case s.PARAMETRIC:p.step||(p.step=(p.max-p.min)/1e3),n=p.max===p.min?u(d,p.min):o.isLinear?function(e,n){var i=l(e[0],n),t=l(e[1],n);return i.segments.length&&t.segments.length&&4===i.segments[0].length&&4===t.segments[0].length?{segments:[[i.segments[0][1],t.segments[0][1],i.segments[0][3],t.segments[0][3]]],resolved:!0}:{segments:[],resolved:!0}}(o.linearCoefficients,p):F(d,p);break;case s.PARAMETRIC_CURVE_3D:return p.step||(p.step=(p.max-p.min)/1e3),n=p.max===p.min?u(d,p.min):F(d,p),{graphMode:s.PARAMETRIC_CURVE_3D,segments:n.segments,cacheKey:m.source+":"+JSON.stringify(p),color:o.color,style:"dummy"};case s.Z_3D:return{meshData:function(e,n){for(var i=e.fn,t=n.xmin,r=n.xmax,a=n.ymin,o=30,s=(r-t)/30,m=(n.ymax-a)/o,c=[],l=[],u=[],d=s/1e3,p=m/1e3,f=0;f<30;f++)for(var h=0;h<o;h++){var v=t+f*s,g=a+h*m,x=i(v,g);c.push(v,g,x);var y=(i(v+d,g)-x)*p,F=(i(v,g+p)-x)*d,w=-d*p,P=Math.sqrt(y*y+F*F+w*w);l.push(y/P,F/P,w/P)}for(f=0;f<29;f++)for(h=0;h<29;h++){var M=h*o+f,b=h*o+f+1,I=(h+1)*o+f,k=(h+1)*o+f+1;u.push(M,I,b),u.push(I,k,b)}return{cacheKey:e.source+":"+JSON.stringify(n),positions:new Float32Array(c),normals:new Float32Array(l),faces:new Int16Array(u)}}(m,p),color:o.color,graphMode:s.Z_3D,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},compiled:m,style:"dummy"};default:throw new Error("Programming Error: unexpected graphmode "+f)}t=n.poi}else n={segments:[],resolved:!0};if((!t||t.zeros.x.length+t.extrema.x.length+t.intercept.x.length>250)&&(t={zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}}),f===s.X)for(var g in t)if(t.hasOwnProperty(g)){var x=g;i=t[x].y,t[x].y=t[x].x,t[x].x=i}var w={segments:n.segments,resolved:n.resolved,graphMode:f,color:o.color,style:o.lineStyle,lineWidth:o.lineWidth,lineOpacity:o.lineOpacity,listIndex:o.listIndex,operator:o.operator,poi:t,compiled:m};if(f===s.POLAR){var M=p;w.sampledDomain={min:M.min,max:M.max,step:M.step}}return n.fillSegments&&(w.fillSegments=n.fillSegments),w},computeDiscreteGraphData:function(e){var n,i=e.viewState,t=e.graphInfo,r=e.compiled,a=e.maxOverride,o=e.showPoint,m=r.fn,l=P(i,t,m);l||(n={segments:[],resolved:!0});var u=l,d=u.min,p=u.max,f=u.step,h=b((n=function(e){for(var n=e.fn,i=e.domain,t=i.min,r=i.max,a=Math.floor(t),o=Math.ceil(r),s=[],m=a;m<=o;m++){var c=n(m);isFinite(m)&&isFinite(c)&&s.push([m,c])}return{segments:s,resolved:!0}}({fn:m,domain:{min:Math.max(d,0),max:void 0!==a?Math.min(a,p):p,step:f}})).segments);return{segments:[h.points],droppedIndices:h.droppedIndices,graphMode:s.XYPOINT,color:t.color,style:t.pointStyle,poi:c.default(n.segments),showPoint:o}},polygonsFromSegments:function(e,n,t){for(var r=function(e){var n=e[e.length-1];return n[n.length-2]},a=[],o=0,s=0,m=[],c=[],l=-1/0,u=-1/0;;){if(l<=u){if(o>=n.length)break;c.push(n[o++])}if(u<=l){if(s>=e.length)break;m.push(e[s++])}if(l=r(c),u=r(m),i.approx(l,u,4)){a.push(M(m,c,t)),c=[],m=[];var d=Math.max(l,u);l=d,u=d}}return a},dropUndefinedPoints:b}});\ndefine(\'core/math/findIntersections\',[\'require\',\'core/types/graphmode\',\'./plotter\',\'parsenodes\',\'core/math/distance\'],function(require){"use strict";var n=require("core/types/graphmode"),t=require("./plotter").default,e=require("parsenodes"),r=require("core/math/distance");function i(n){for(var t=[],e=0;e<n;e++)t[e]={x:[],y:[],intersects:[]};return t}function o(t,e,r,i){return r===n.X&&i===n.X||r===n.Y&&i===n.Y?function(n){return e(n)-t(n)}:(r===n.X&&i===n.Y||r===n.Y&&i===n.X)&&function(n){return n-e(t(n))}}function s(n,t){t instanceof e.SolvedEquation?t=t._expression:t instanceof e.OptimizedRegression&&(t=t.model);var r=[],i=[];return t instanceof e.DoubleInequality?e.List.eachArgs(t._expressions,function(n){r.push(n[0].getCompiledFunction()),i.push(n[0].isConstant&&n[1].isNaN()),r.push(n[1].getCompiledFunction()),i.push(n[1].isConstant&&n[1].isNaN())}):e.List.wrap(t).eachElement(function(n){r.push(n.getCompiledFunction()),i.push(n.isConstant&&n.isNaN())}),{functions:r,skipIntersecting:i}}function p(n,t){n.intersects=Array(n.x.length);for(var e=0;e<n.x.length;e++)n.intersects[e]=t}function u(t,e){if(e===n.X){var r=t.y;t.y=t.x,t.x=r}}function c(n,t){Array.prototype.push.apply(n.x,t.x),Array.prototype.push.apply(n.y,t.y),Array.prototype.push.apply(n.intersects,t.intersects)}function a(n,e,i){var o=t.sampleXY(n,e),s=o.poi.zeros,p=o.poi.extrema,u=[],c=0,a=0;for(c=0;c<s.x.length;c++){for(;a<p.x.length&&p.x[a]<s.x[c];a++)r.approx(p.y[a],0)&&u.push(p.x[a]);u.push(s.x[c])}for(;a<p.x.length;a++)r.approx(p.y[a],0)&&u.push(p.x[a]);return{x:u,y:u.map(i)}}return{findIntersections:function(n,e,r){var f,h,g,l=n[r],y=l.getGraphInfo(),x=l.getGraphMode();try{h=i((f=s(l.policy,l.concreteTree)).functions.length),g=function(n,t){var e=[];for(var r in n)if(n.hasOwnProperty(r)&&String(r)!==String(t)&&n[r].shouldIntersect()){var i=n[r],o=s(i.policy,i.concreteTree);e.push({id:r,graphMode:i.getGraphMode(),functions:o.functions,skipIntersecting:o.skipIntersecting})}return e}(n,r)}catch(n){return i(0)}if(!g)return h;for(var d=0,v=0;v<g.length;v++)for(var m=g[v],I=0;I<f.functions.length;I++)if(!f.skipIntersecting[I])for(var C=f.functions[I].fn,N=t.computeDomain(e,y,C),X=0;X<m.functions.length;X++)if(!g[v].skipIntersecting[X]){var k=o(C,m.functions[X].fn,x,m.graphMode);if(k){var A=a(k,N,C);if((d+=A.x.length)>100)return i(f.functions.length);p(A,m.id),u(A,x),c(h[I],A)}}return h},findIndicatorZeros:a}});\ndefine(\'core/vendor/d3-color\',[\'require\'],function(require){function e(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function t(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function r(){}var n=.7,i=1/n,a="\\\\s*([+-]?\\\\d+)\\\\s*",o="\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)\\\\s*",s="\\\\s*([+-]?\\\\d*\\\\.?\\\\d+(?:[eE][+-]?\\\\d+)?)%\\\\s*",l=/^#([0-9a-f]{3,8})$/,h=new RegExp("^rgb\\\\("+[a,a,a]+"\\\\)$"),u=new RegExp("^rgb\\\\("+[s,s,s]+"\\\\)$"),g=new RegExp("^rgba\\\\("+[a,a,a,o]+"\\\\)$"),c=new RegExp("^rgba\\\\("+[s,s,s,o]+"\\\\)$"),d=new RegExp("^hsl\\\\("+[o,s,s]+"\\\\)$"),b=new RegExp("^hsla\\\\("+[o,s,s,o]+"\\\\)$"),p={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function m(){return this.rgb().formatHex()}function f(){return this.rgb().formatRgb()}function y(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=l.exec(e))?(r=t[1].length,t=parseInt(t[1],16),6===r?w(t):3===r?new v(t>>8&15|t>>4&240,t>>4&15|240&t,(15&t)<<4|15&t,1):8===r?k(t>>24&255,t>>16&255,t>>8&255,(255&t)/255):4===r?k(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|240&t,((15&t)<<4|15&t)/255):null):(t=h.exec(e))?new v(t[1],t[2],t[3],1):(t=u.exec(e))?new v(255*t[1]/100,255*t[2]/100,255*t[3]/100,1):(t=g.exec(e))?k(t[1],t[2],t[3],t[4]):(t=c.exec(e))?k(255*t[1]/100,255*t[2]/100,255*t[3]/100,t[4]):(t=d.exec(e))?E(t[1],t[2]/100,t[3]/100,1):(t=b.exec(e))?E(t[1],t[2]/100,t[3]/100,t[4]):p.hasOwnProperty(e)?w(p[e]):"transparent"===e?new v(NaN,NaN,NaN,0):null}function w(e){return new v(e>>16&255,e>>8&255,255&e,1)}function k(e,t,r,n){return n<=0&&(e=t=r=NaN),new v(e,t,r,n)}function N(e){return e instanceof r||(e=y(e)),e?new v((e=e.rgb()).r,e.g,e.b,e.opacity):new v}function x(e,t,r,n){return 1===arguments.length?N(e):new v(e,t,r,null==n?1:n)}function v(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}function M(){return"#"+q(this.r)+q(this.g)+q(this.b)}function R(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===e?")":", "+e+")")}function q(e){return((e=Math.max(0,Math.min(255,Math.round(e)||0)))<16?"0":"")+e.toString(16)}function E(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new C(e,t,r,n)}function $(e){if(e instanceof C)return new C(e.h,e.s,e.l,e.opacity);if(e instanceof r||(e=y(e)),!e)return new C;if(e instanceof C)return e;var t=(e=e.rgb()).r/255,n=e.g/255,i=e.b/255,a=Math.min(t,n,i),o=Math.max(t,n,i),s=NaN,l=o-a,h=(o+a)/2;return l?(s=t===o?(n-i)/l+6*(n<i):n===o?(i-t)/l+2:(t-n)/l+4,l/=h<.5?o+a:2-o-a,s*=60):l=h>0&&h<1?0:s,new C(s,l,h,e.opacity)}function H(e,t,r,n){return 1===arguments.length?$(e):new C(e,t,r,null==n?1:n)}function C(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}function j(e,t,r){return 255*(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)}return e(r,y,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:m,formatHex:m,formatHsl:function(){return $(this).formatHsl()},formatRgb:f,toString:f}),e(v,x,t(r,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new v(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=null==e?n:Math.pow(n,e),new v(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:M,formatHex:M,formatRgb:R,toString:R})),e(C,H,t(r,{brighter:function(e){return e=null==e?i:Math.pow(i,e),new C(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=null==e?n:Math.pow(n,e),new C(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+360*(this.h<0),t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new v(j(e>=240?e-240:e+120,i,n),j(e,i,n),j(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return(1===(e=isNaN(e)?1:Math.max(0,Math.min(1,e)))?"hsl(":"hsla(")+(this.h||0)+", "+100*(this.s||0)+"%, "+100*(this.l||0)+"%"+(1===e?")":", "+e+")")}})),{Color:r,darker:n,brighter:i,color:y,rgbConvert:N,rgb:x,Rgb:v,hslConvert:$,hsl:H}});\ndefine(\'core/math/policyFourFunction\',["require","exports"],function(require,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.PolicySingleExpressionFourFunction=n.PolicyFourFunction=void 0;var e=function(){function n(n){this.singleExpression=n.singleExpression}return n.prototype.assignmentForbidden=function(n){return"ans"!==n.slice(0,3)},n.prototype.isValidSlider=function(n){return!1},n.prototype.sliderVariables=function(){return[]},n.prototype.graphingEnabled=function(){return!1},n.prototype.ansEnabled=function(){return!this.singleExpression},n.prototype.dimensionVarsEnabled=function(){return!1},n.prototype.disabledFeatures=function(){return["Sum","Product","Integral","List","Derivative","Piecewise","Exponent","PercentOf"]},n}();n.PolicyFourFunction=new e({singleExpression:!1}),n.PolicySingleExpressionFourFunction=new e({singleExpression:!0})});\ndefine(\'core/math/policyScientific\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PolicySingleExpressionScientific=e.PolicyScientific=void 0;var i=function(){function e(e){this.singleExpression=e.singleExpression}return e.prototype.assignmentForbidden=function(e){return this.singleExpression?"ans"!==e.slice(0,3):"tmp"===e.slice(0,3)},e.prototype.isValidSlider=function(e){return!1},e.prototype.sliderVariables=function(){return[]},e.prototype.graphingEnabled=function(){return!1},e.prototype.ansEnabled=function(){return!this.singleExpression},e.prototype.dimensionVarsEnabled=function(){return!1},e.prototype.disabledFeatures=function(){return this.singleExpression?["Sum","Product","Integral","Derivative","Piecewise","PercentOf"]:["Sum","Product","Integral","Derivative","Piecewise"]},e}();e.PolicyScientific=new i({singleExpression:!1}),e.PolicySingleExpressionScientific=new i({singleExpression:!0})});\ndefine(\'core/math/policyGraphing\',["require","exports","./builtinframe","core/types/graphmode"],function(require,t,r,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PolicyGraphing3D=t.PolicyGraphing=void 0;var e=function(){function t(){}return t.prototype.dimensions=function(){return 2},t.prototype.assignmentForbidden=function(t){return"x"===t||"y"===t||"theta"===t||"index"===t||"dt"===t||"tmp"===t.slice(0,3)||r.hasOwnProperty(t)},t.prototype.isValidSlider=function(t){return"x"===t||"y"===t||"ans"!==t.slice(0,3)&&!this.assignmentForbidden(t)},t.prototype.sliderVariables=function(t){var r=this;return-1!==t.indexOf("theta")&&(t=t.filter(function(t){return"r"!==t})),t.filter(function(t){return!r.assignmentForbidden(t)&&("ans"!==t.slice(0,3)&&"_"!==t[0])})},t.prototype.graphingEnabled=function(){return!0},t.prototype.ansEnabled=function(){return!1},t.prototype.dimensionVarsEnabled=function(){return!0},t.prototype.validRegressionParameter=function(t){return"x"!==t&&"y"!==t},t.prototype.validLHS=function(t){return"theta"!==t},t.prototype.unplottablePolarFunction=function(t,r){return"theta"===t&&-1!==r.indexOf("r")},t.prototype.validDoubleInequalitySymbol=function(t){return"x"===t||"y"===t},t.prototype.validDoubleInequalityVariables=function(t){return!(t.length>2)&&t.every(this.validDoubleInequalitySymbol)},t.prototype.validExpressionVariables=function(t){return 1===t.length&&"x"===t[0]},t.prototype.validSolvedVariable=function(t){return"x"===t||"y"===t||"r"===t},t.prototype.validImplicitVariables=function(t){switch(t.length){case 0:return!0;case 1:return"x"===t[0]||"y"===t[0]||"r"===t[0];case 2:return"x"===t[0]&&"y"===t[1]||"y"===t[0]&&"x"===t[1]||"r"===t[0]&&"theta"===t[1]||"theta"===t[0]&&"r"===t[1];default:return!1}},t.prototype.graphableListVariables=function(t,r){return"x"===t||"y"===t||"r"===t||"x"===r||"y"===r},t.prototype.validParametricVariable=function(t){return"t"===t},t.prototype.validParametricVariables=function(t){return 1===t.length&&this.validParametricVariable(t[0])},t.prototype.validInequalityVariables=function(t){switch(t.length){case 1:return"x"===t[0]||"y"===t[0]||"r"===t[0];case 2:return this.validImplicitVariables(t);default:return!1}},t.prototype.validFirstColumnVariable=function(t){return"y"!==t&&"r"!==t&&"theta"!==t&&!t.match(/y_(\\d+)/)},t.prototype.validActionVariable=function(t){return"dt"===t||"index"===t},t.prototype.complicatedPolarImplicit=function(t,r){return"theta"===t||"r"===t&&1!==r},t.prototype.constantGraphMode=function(t){return"x"===t?n.X:"r"===t?n.POLAR:n.Y},t.prototype.graphMode=function(t,r){var e=r[0];return"y"===e||"x"===t?n.X:"r"===t&&"theta"===e?n.POLAR:n.Y},t.prototype.tableableAsConstant=function(t){return"x"!==t&&("r"!==t&&"theta"!==t)},t.prototype.implicitIndependent=function(t){return"x"},t.prototype.implicitDependency=function(t){return 1!==t.length?"y":"y"===t[0]?"x":"theta"===t[0]?"r":"y"},t.prototype.graphableAsConstant=function(t){return"y"===t||"x"===t||"r"===t},t.prototype.disabledFeatures=function(){return[]},t}(),i=function(){function t(){}return t.prototype.dimensions=function(){return 3},t.prototype.assignmentForbidden=function(t){return"x"===t||"y"===t||"z"===t||"tmp"===t.slice(0,3)||r.hasOwnProperty(t)},t.prototype.isValidSlider=function(t){return"x"===t||"y"===t||"z"===t||"ans"!==t.slice(0,3)&&!this.assignmentForbidden(t)},t.prototype.sliderVariables=function(t){var r=this;return t.filter(function(t){return!r.assignmentForbidden(t)&&"ans"!==t.slice(0,3)})},t.prototype.graphingEnabled=function(){return!0},t.prototype.ansEnabled=function(){return!1},t.prototype.dimensionVarsEnabled=function(){return!0},t.prototype.validRegressionParameter=function(t){return!1},t.prototype.validLHS=function(t){return!0},t.prototype.unplottablePolarFunction=function(t,r){return!1},t.prototype.validDoubleInequalitySymbol=function(t){return!1},t.prototype.validDoubleInequalityVariables=function(t){return!1},t.prototype.validExpressionVariables=function(t){var r=t.join("");return"x"===r||"y"===r||"xy"===r||"yx"===r},t.prototype.validSolvedVariable=function(t){return"x"===t||"y"===t||"z"===t},t.prototype.validImplicitVariables=function(t){return!1},t.prototype.graphableListVariables=function(t,r){return"x"===t||"y"===t||"x"===r||"y"===r},t.prototype.validParametricVariable=function(t){return"t"===t},t.prototype.validParametricVariables=function(t){return 1===t.length&&this.validParametricVariable(t[0])},t.prototype.validInequalityVariables=function(t){return!1},t.prototype.validFirstColumnVariable=function(t){return!1},t.prototype.validActionVariable=function(t){return"dt"===t||"index"===t},t.prototype.complicatedPolarImplicit=function(t,r){return!1},t.prototype.constantGraphMode=function(t){return n.Z_3D},t.prototype.graphMode=function(t,r){return"z"===t&&this.validExpressionVariables(r)?n.Z_3D:n.NONE},t.prototype.tableableAsConstant=function(t){return"x"!==t&&"r"!==t},t.prototype.implicitIndependent=function(t){return"x"},t.prototype.implicitDependency=function(t){if(2!==t.length)return"z";var r=t[0]<t[1]?t[0]+t[1]:t[1]+t[0];return"xy"===r?"z":"xz"===r?"y":"yz"===r?"x":"z"},t.prototype.graphableAsConstant=function(t){return"z"===t},t.prototype.disabledFeatures=function(){return[]},t}();t.PolicyGraphing=new e,t.PolicyGraphing3D=new i});\ndefine(\'core/math/frameFourFunction\',[\'require\',\'core/math/builtinframe\'],function(require){"use strict";var t=require("core/math/builtinframe");return{getFrame:function(i){var n={};return i.additionalFunctions&&-1!==i.additionalFunctions.indexOf("sqrt")&&(n.sqrt=t.sqrt),i.width&&(n.width=i.width),i.height&&(n.height=i.height),n}}});\ndefine(\'core/math/frameScientific\',[\'require\',\'core/math/builtinframe\'],function(require){"use strict";var r=require("core/math/builtinframe"),t=["pi","e","trigAngleMultiplier"],n=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","mean","round","stdev","stdevp","nCr","nPr","exp","factorial"];function e(r,t){for(var n=0;n<r.length;n++){var e=r[n];if(!t.hasOwnProperty(e))throw new Error("Programming Error: key \'"+e+"\' does not exist in table. Must be one of:\\n"+Object.keys(t).join("\\n"))}}return e(t,r),e(n,r),{getFrame:function(e){var i={};return t.forEach(function(t){i[t]=r[t]}),n.forEach(function(t){e.replaceRoundWithReciprocal&&"round"===t||(i[t]=r[t])}),e.trigAngleMultiplier&&(i.trigAngleMultiplier=e.trigAngleMultiplier),e.width&&(i.width=e.width),e.height&&(i.height=e.height),i}}});\ndefine(\'core/math/frameSingleExpressionScientific\',[\'require\',\'core/math/builtinframe\'],function(require){"use strict";var r=require("core/math/builtinframe"),t=["pi","e","trigAngleMultiplier"],i=["sqrt","nthroot","abs","ln","sin","cos","tan","log","arcsin","arccos","arctan","exp","factorial"];function n(r,t){for(var i=0;i<r.length;i++){var n=r[i];if(!t.hasOwnProperty(n))throw new Error("Programming Error: key \'"+n+"\' does not exist in table. Must be one of:\\n"+Object.keys(t).join("\\n"))}}return n(t,r),n(i,r),{getFrame:function(n){var e={};return t.forEach(function(t){e[t]=r[t]}),i.forEach(function(t){e[t]=r[t]}),n.trigAngleMultiplier&&(e.trigAngleMultiplier=n.trigAngleMultiplier),n.width&&(e.width=n.width),n.height&&(e.height=n.height),e}}});\ndefine(\'core/math/frameGraphing\',[\'require\',\'core/math/builtinframe\'],function(require){"use strict";var t=require("core/math/builtinframe"),i=["csc","sec","cot","arccsc","arcsec","arccot","csch","sech","coth","arccsch","arcsech","arccoth","mad","cov","distance","midpoint"],e=["erf","ttest","tscore","ittest","normaldist","tdist","poissondist","binomialdist","pdf","cdf","random","histogram","dotplot","boxplot"],n=["distance","midpoint"],o=["det","inv","transpose","rref","trace"];function r(t,i){for(var e=0;e<t.length;e++){var n=t[e];if(!i.hasOwnProperty(n))throw new Error("Programming Error: key \'"+n+"\' does not exist in table. Must be one of:\\n"+Object.keys(i).join("\\n"))}}return r(i,t),r(e,t),{getFrame:function(r){var a,c={};for(a in t)t.hasOwnProperty(a)&&(!0!==r.restrictedFunctions||-1===i.indexOf(a)||!0===r.forceEnableGeometryFunctions&&-1!==n.indexOf(a))&&(!1===r.distributions&&-1!==e.indexOf(a)||-1===o.indexOf(a)&&(c[a]=t[a]));return r.trigAngleMultiplier&&(c.trigAngleMultiplier=r.trigAngleMultiplier),r.globalRandomSeed&&(c.globalRandomSeed=r.globalRandomSeed),r.initialEvaluation&&(c.initialEvaluation=r.initialEvaluation),r.globalEventCount&&(c.globalEventCount=r.globalEventCount),r.width&&(c.width=r.width),r.height&&(c.height=r.height),c}}});\ndefine(\'core/math/parser/char-codes\',["require","exports"],function(require,e){"use strict";function t(e){return 97<=e&&e<=122}function i(e){return 65<=e&&e<=90}Object.defineProperty(e,"__esModule",{value:!0}),e.isWhitespace=e.isSingleQuote=e.isDot=e.isBackslash=e.isLetter=e.isUpperCaseLetter=e.isLowerCaseLetter=e.isDigit=void 0,e.isDigit=function(e){return 48<=e&&e<=57},e.isLowerCaseLetter=t,e.isUpperCaseLetter=i,e.isLetter=function(e){return t(e)||i(e)},e.isBackslash=function(e){return 92===e},e.isDot=function(e){return 46===e},e.isSingleQuote=function(e){return 39===e},e.isWhitespace=function(e){if(9<=e&&e<=13)return!0;if(8192<=e&&e<=8202)return!0;switch(e){case 32:case 160:case 5760:case 8232:case 8233:case 8239:case 8287:case 12288:case 65279:return!0;default:return!1}}});\ndefine(\'core/math/parser/latex-lexer\',["require","exports","./char-codes","./input-span"],function(require,e,t,n){"use strict";function r(e,t,n){return{type:e,span:t,val:n}}function a(e,a,i){for(;t.isWhitespace(e.charCodeAt(a));)a+=1;var o=function(e,a){var i=a;if(a>=e.length)return r("End",n.emptySpanAt(e,a),"");var o=e.charCodeAt(a);if(t.isDigit(o))return r("Digit",u=n.Span(e,i,a+1),e.charAt(i));if(t.isLetter(o))return r("Letter",u=n.Span(e,i,a+1),e.charAt(i));if(t.isBackslash(o)){if(a+=1,t.isLetter(e.charCodeAt(a))){for(;t.isLetter(e.charCodeAt(a));)a+=1;var u=n.Span(e,i,a),c=n.slice(u);return r(p[c]||"Cmd",u,c)}return a+=1,r("EscapedSymbol",u=n.Span(e,i,a),c=n.slice(u))}if(t.isSingleQuote(o)){for(a+=1;t.isSingleQuote(e.charCodeAt(a));)a+=1;return"^"===e.charAt(a)?(a+=1,r("Primes^",u=n.Span(e,i,a),c=n.slice(u))):r("Primes",u=n.Span(e,i,a),c=n.slice(u))}u=n.Span(e,i,a+1),c=e.charAt(i);return r(s[c]||"Symbol",u,c)}(e,a);return function(e,t,n,r){return{input:e,prevSpan:t,pos:n,token:r}}(e,i,a,o)}function i(e){return a(e.input,e.token.span.end,e.token.span)}function o(e){return e.token}Object.defineProperty(e,"__esModule",{value:!0}),e.isDone=e.isAt=e.eat=e.peek=e.advance=e.lex=e.LatexToken=e.spanStates=void 0,e.spanStates=function(e,t){return n.joinSpans(e.token.span,t.prevSpan)},e.LatexToken=r,e.lex=function(e){return a(e,0,n.emptySpanAt(e,0))},e.advance=i,e.peek=o,e.eat=function(e,t){if(o(e).type!==t)throw"Parse Error: expected "+t+".";return i(e)},e.isAt=function(e,t){return o(e).type===t},e.isDone=function(e){return e.pos>=e.input.length};var p={"\\\\left":"Left","\\\\right":"Right","\\\\sqrt":"Sqrt","\\\\frac":"Frac","\\\\operatorname":"OperatorName","\\\\token":"Token"},s={"[":"[","]":"]","{":"{","}":"}","^":"^",_:"_"}});\ndefine(\'core/math/parser/latex-node\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Symbol=e.TokenNode=e.OperatorName=e.LeftRight=e.SupSub=e.Frac=e.Sqrt=e.Group=void 0,e.Group=function(e,r){return{type:"Group",span:e,args:r}},e.Sqrt=function(e,r,t){return{type:"Sqrt",span:e,optArg:r,arg:t}},e.Frac=function(e,r,t){return{type:"Frac",span:e,num:r,den:t}},e.SupSub=function(e,r,t,n){return{type:"SupSub",span:e,sup:r,sub:t,nprimes:n}},e.LeftRight=function(e,r,t,n){return{type:"LeftRight",span:e,left:r,right:t,arg:n}},e.OperatorName=function(e,r){return{type:"OperatorName",span:e,arg:r}},e.TokenNode=function(e,r){return{type:"TokenNode",span:e,arg:r}},e.Symbol=function(e,r){return{type:"Symbol",span:e,val:r}}});\ndefine(\'core/math/parser/latex-parser\',["require","exports","./latex-lexer","./input-span","./latex-node"],function(require,e,r,a,t){"use strict";function s(e){switch(e){case"Frac":return 2;case"^":case"_":case"Primes^":case"Left":case"Sqrt":case"OperatorName":case"Token":return 1;default:return 0}}function n(e,r){return{state:e,tree:r}}function c(e,a){var s,c=e,p=[];e:for(;!r.isDone(e);){var u=r.peek(e);switch(u.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":case"[":case"{":case"^":case"_":case"Primes":case"Primes^":case"Left":case"Frac":case"Sqrt":case"OperatorName":case"Token":case"]":if("]"===u.type&&a)break e;var i;if(e=(s=o(e)).state,"Group"===(i=s.tree).type)for(var v=0,f=i.args;v<f.length;v++){var d=f[v];p.push(d)}else p.push(i);break;case"}":case"Right":case"End":break e;default:throw"Unexpected token type "+u.type+"."}}var l=r.spanStates(c,e);return n(e,t.Group(l,p))}function o(e){var a,s=r.peek(e);switch(s.type){case"Cmd":case"EscapedSymbol":case"Letter":case"Digit":case"Symbol":return n(e=r.advance(e),s);case"[":case"]":return n(e=r.advance(e),t.Symbol(s.span,s.val));case"{":var o;return e=(a=c(e=r.advance(e),!1)).state,o=a.tree,n(e=r.eat(e,"}"),o);case"^":case"_":case"Primes":case"Primes^":return function(e){var a,s,c,o,u,i=e,v=0;e:for(;!r.isDone(e);){var f=r.peek(e);switch(f.type){case"^":if(e=r.advance(e),o)throw"Parse Error: double superscript.";e=(a=p(e,f)).state,o=a.tree;break;case"_":if(e=r.advance(e),u)throw"Parse Error: double subscript.";e=(s=p(e,f)).state,u=s.tree;break;case"Primes":if(e=r.advance(e),v>0)throw"Parse Error: double primes.";v=f.val.length;break;case"Primes^":if(e=r.advance(e),v>0)throw"Parse Error: double primes.";if(o)throw"Parse Error: double superscript";v=f.val.length-1,e=(c=p(e,f)).state,o=c.tree;break;default:break e}}var d=r.spanStates(i,e);return n(e,t.SupSub(d,o,u,v))}(e);case"Left":return function(e){var a,s=e;e=r.eat(e,"Left");var o,p=r.peek(e);e=r.advance(e),a=c(e,!1),e=a.state,o=a.tree,e=r.eat(e,"Right");var u=r.peek(e);e=r.advance(e);var i=r.spanStates(s,e);return n(e,t.LeftRight(i,p,u,o))}(e);case"Frac":return function(e){var a,s,c,o,u=e,i=r.peek(e);e=r.eat(e,"Frac"),a=p(e,i),e=a.state,c=a.tree,s=p(e,i),e=s.state,o=s.tree;var v=r.spanStates(u,e);return n(e,t.Frac(v,c,o))}(e);case"Sqrt":return function(e){var a,s,o,u,i=e,v=r.peek(e);e=r.eat(e,"Sqrt"),r.isAt(e,"[")&&(a=function(e){var a,t;return e=r.eat(e,"["),a=c(e,!0),e=a.state,t=a.tree,n(e=r.eat(e,"]"),t)}(e),e=a.state,o=a.tree);s=p(e,v),e=s.state,u=s.tree;var f=r.spanStates(i,e);return n(e,t.Sqrt(f,o,u))}(e);case"OperatorName":return function(e){var a,s,c=e,o=r.peek(e);e=r.eat(e,"OperatorName"),a=p(e,o),e=a.state,s=a.tree;var u=r.spanStates(c,e);return n(e,t.OperatorName(u,s))}(e);case"Token":return function(e){var a,s,c=e,o=r.peek(e);e=r.eat(e,"Token"),a=p(e,o),e=a.state,s=a.tree;var u=r.spanStates(c,e);return n(e,t.TokenNode(u,s))}(e);case"}":case"Right":throw"Parse Error: unexpected "+s.val+".";case"End":throw"Parse Error: unexpected end.";default:throw"Unexpected token type "+s.type+"."}}function p(e,c){var p,u,i=s(c.type);if(i<=0)throw new Error("Programming Error: greediness must be greater than 0.");var v=s(r.peek(e).type);if(v>0&&v<=i){var f=a.slice(c.span);throw"Parse Error: can\'t use "+a.slice(r.peek(e).span)+" as argument of "+f+". Use {}."}return e=(p=o(e)).state,"Group"!==(u=p.tree).type&&(u=t.Group(u.span,[u])),n(e,u)}Object.defineProperty(e,"__esModule",{value:!0}),e.parse=void 0,e.parse=function(e){var t=c(r.lex(e),!1),s=t.state,n=t.tree;if(!r.isDone(s))throw"Parse error: unexpected "+a.slice(r.peek(s).span)+".";return n}});\ndefine(\'core/math/parser/command-aliases\',["require","exports","./char-codes"],function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.translateCmd=void 0;var s={mcd:"gcd",gcf:"gcd",mcm:"lcm",signum:"sign",sgn:"sign",stdDevP:"stdevp",stddevp:"stdevp",stdDev:"stdev",stddev:"stdev",variance:"var",TTest:"ttest",TScore:"tscore",IndependentTTest:"ittest",iTTest:"ittest",inverseCdf:"quantile",inversecdf:"quantile",arsinh:"arcsinh",arcosh:"arccosh",artanh:"arctanh",arcsch:"arccsch",arsech:"arcsech",arcoth:"arccoth"};e.translateCmd=function(e){for(var c=0;t.isBackslash(e.charCodeAt(c));)c+=1;return c>0&&(e=e.slice(c)),s[e]||e}});\ndefine(\'core/math/parser/surface-node\',["require","exports","./command-aliases"],function(require,n,t){"use strict";function e(n){if("Subscript"===n.type){if("Alphanumeric"!==n.args[1].type)return!1;n=n.args[0]}switch(n.type){case"Cmd":case"Letter":return!0;default:return!1}}Object.defineProperty(n,"__esModule",{value:!0}),n.unwrapSeq=n.isDerivative=n.isSuperscriptedIdentifier=n.isIdentifier=n.MixedNumber=n.Alphanumeric=n.Cmd=n.Decimal=n.Letter=n.Juxt=n.RightArrow=n.PercentOf=n.Dot=n.For=n.Ellipsis=n.Colon=n.EmptyRangeEnd=n.EmptyPiecewise=n.Piecewise=n.Product=n.Sum=n.EmptyIntegral=n.Integral=n.Derivative=n.Frac=n.Nthroot=n.Sqrt=n.Seq=n.Prime=n.Superscript=n.Subscript=n.Pipes=n.List=n.Paren=n.Index=n.ImplicitCall=n.Call=n.Bang=n.Div=n.Mul=n.Sub=n.Add=n.Neg=n.Pos=n.Tilde=n.InequalityChain=n.TrailingInequalityPiece=n.Inequality=n.Equals=void 0,n.Equals=function(n,t){return{type:"Equals",span:n,args:t}},n.Inequality=function(n,t,e){return{type:"Inequality",span:n,symbol:t,args:e}},n.TrailingInequalityPiece=function(n,t,e){return{type:"TrailingInequalityPiece",span:n,symbol:t,args:e}},n.InequalityChain=function(n,t,e){return{type:"InequalityChain",span:n,first:t,chain:e}},n.Tilde=function(n,t){return{type:"Tilde",span:n,args:t}},n.Pos=function(n,t){return{type:"Pos",span:n,args:t}},n.Neg=function(n,t){return{type:"Neg",span:n,args:t}},n.Add=function(n,t){return{type:"Add",span:n,args:t}},n.Sub=function(n,t){return{type:"Sub",span:n,args:t}},n.Mul=function(n,t){return{type:"Mul",span:n,args:t}},n.Div=function(n,t){return{type:"Div",span:n,args:t}},n.Bang=function(n,t){return{type:"Bang",span:n,args:t}},n.Call=function(n,t){return{type:"Call",span:n,args:t}},n.ImplicitCall=function(n,t){return{type:"ImplicitCall",span:n,args:t}},n.Index=function(n,t){return{type:"Index",span:n,args:t}},n.Paren=function(n,t){return{type:"Paren",span:n,args:t}},n.List=function(n,t){return{type:"List",span:n,args:t}},n.Pipes=function(n,t){return{type:"Pipes",span:n,args:t}},n.Subscript=function(n,t){return{type:"Subscript",span:n,args:t}},n.Superscript=function(n,t){return{type:"Superscript",span:n,args:t}},n.Prime=function(n,t,e){return{type:"Prime",span:n,nprimes:t,args:e}},n.Seq=function(n,t){return{type:"Seq",span:n,args:t}},n.Sqrt=function(n,t){return{type:"Sqrt",span:n,args:t}},n.Nthroot=function(n,t){return{type:"Nthroot",span:n,args:t}},n.Frac=function(n,t){return{type:"Frac",span:n,args:t}},n.Derivative=function(n,t){return{type:"Derivative",span:n,args:t}},n.Integral=function(n,t){return{type:"Integral",span:n,args:t}},n.EmptyIntegral=function(n,t){return{type:"EmptyIntegral",span:n,args:t}},n.Sum=function(n,t){return{type:"Sum",span:n,args:t}},n.Product=function(n,t){return{type:"Product",span:n,args:t}},n.Piecewise=function(n,t){return{type:"Piecewise",span:n,args:t}},n.EmptyPiecewise=function(n){return{type:"EmptyPiecewise",span:n}},n.EmptyRangeEnd=function(n){return{type:"EmptyRangeEnd",span:n}},n.Colon=function(n,t){return{type:"Colon",span:n,args:t}},n.Ellipsis=function(n,t){return{type:"Ellipsis",span:n,args:t}},n.For=function(n,t){return{type:"For",span:n,args:t}},n.Dot=function(n,t){return{type:"Dot",span:n,args:t}},n.PercentOf=function(n,t){return{type:"PercentOf",span:n,args:t}},n.RightArrow=function(n,t){return{type:"RightArrow",span:n,args:t}},n.Juxt=function(n,t){return{type:"Juxt",span:n,args:t}},n.Letter=function(n,t){return{type:"Letter",span:n,val:t}},n.Decimal=function(n,t){return{type:"Decimal",span:n,val:t}},n.Cmd=function(n,e){return{type:"Cmd",span:n,val:t.translateCmd(e)}},n.Alphanumeric=function(n,t){return{type:"Alphanumeric",span:n,val:t}},n.MixedNumber=function(n,t,e,r){return{type:"MixedNumber",span:n,whole:t,num:e,den:r}},n.isIdentifier=e,n.isSuperscriptedIdentifier=function(n){return"Superscript"===n.type&&e(n.args[0])},n.isDerivative=function(n,t){if("Letter"!==n.type||"d"!==n.val)return!1;if("Juxt"!==t.type)return!1;var r=t.args,i=r[0],a=r[1];return"Letter"===i.type&&"d"===i.val&&e(a)},n.unwrapSeq=function(n){return"Seq"===n.type?n.args:[n]}});\ndefine(\'core/math/parser/surface-node-error\',["require","exports"],function(require,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TokenWithSubscript=t.UnexpectedFor=t.AdjacentNumbers=t.FractionEmpty=t.FractionMissingDenominator=t.FractionMissingNumerator=t.DifferentialWithSuperscript=t.IntegralMissingDifferential=t.DerivativeMissingBody=t.IntegralMissingBody=t.ProductMissingBody=t.SumMissingBody=t.IntegralMissingBound=t.MissingBound=t.ProductMissingBound=t.SumMissingBound=t.UnexpectedPrime=t.SuperscriptWithPrime=t.PrimeWithoutParen=t.PercentMissingOf=t.FunctionMissingArgument=t.UnexpectedSubscript=t.InvalidSubscript=t.InvalidOperatorName=t.UnrecognizedSymbol=t.UnexpectedDifferential=t.UnexpectedCloseDelimiter=t.MissingCloseDelimiter=t.UnaryOperatorMissingLeft=t.UnaryOperatorMissingRight=t.BinaryOperatorMissingLeft=t.BinaryOperatorMissingRight=t.UnexpectedEnd=t.EmptyRadicalIndex=t.EmptyPipe=t.EmptySquareBracket=t.EmptyRadical=t.EmptySuperscript=t.EmptySubscript=t.EmptyGroup=t.EmptyInput=t.UnexpectedParseError=t.Err=void 0,t.Err=function(t,n){return{type:"Err",span:t,error:n}},t.UnexpectedParseError=function(){return{type:"UnexpectedParseError"}},t.EmptyInput=function(){return{type:"EmptyInput"}},t.EmptyGroup=function(){return{type:"EmptyGroup"}},t.EmptySubscript=function(){return{type:"EmptySubscript"}},t.EmptySuperscript=function(){return{type:"EmptySuperscript"}},t.EmptyRadical=function(){return{type:"EmptyRadical"}},t.EmptySquareBracket=function(){return{type:"EmptySquareBracket"}},t.EmptyPipe=function(){return{type:"EmptyPipe"}},t.EmptyRadicalIndex=function(){return{type:"EmptyRadicalIndex"}},t.UnexpectedEnd=function(){return{type:"UnexpectedEnd"}},t.BinaryOperatorMissingRight=function(t){return{type:"BinaryOperatorMissingRight",val:t}},t.BinaryOperatorMissingLeft=function(t){return{type:"BinaryOperatorMissingLeft",val:t}},t.UnaryOperatorMissingRight=function(t){return{type:"UnaryOperatorMissingRight",val:t}},t.UnaryOperatorMissingLeft=function(t){return{type:"UnaryOperatorMissingLeft",val:t}},t.MissingCloseDelimiter=function(t,n){return{type:"MissingCloseDelimiter",open:t,close:n}},t.UnexpectedCloseDelimiter=function(t,n){return{type:"UnexpectedCloseDelimiter",open:t,close:n}},t.UnexpectedDifferential=function(){return{type:"UnexpectedDifferential"}},t.UnrecognizedSymbol=function(t){return{type:"UnrecognizedSymbol",val:t}},t.InvalidOperatorName=function(t){return{type:"InvalidOperatorName",val:t}},t.InvalidSubscript=function(t){return{type:"InvalidSubscript",val:t}},t.UnexpectedSubscript=function(t){return{type:"UnexpectedSubscript",base:t}},t.FunctionMissingArgument=function(t){return{type:"FunctionMissingArgument",val:t}},t.PercentMissingOf=function(){return{type:"PercentMissingOf"}},t.PrimeWithoutParen=function(){return{type:"PrimeWithoutParen"}},t.SuperscriptWithPrime=function(){return{type:"SuperscriptWithPrime"}},t.UnexpectedPrime=function(){return{type:"UnexpectedPrime"}},t.SumMissingBound=function(){return{type:"SumMissingBound"}},t.ProductMissingBound=function(){return{type:"ProductMissingBound"}},t.MissingBound=function(){return{type:"MissingBound"}},t.IntegralMissingBound=function(){return{type:"IntegralMissingBound"}},t.SumMissingBody=function(){return{type:"SumMissingBody"}},t.ProductMissingBody=function(){return{type:"ProductMissingBody"}},t.IntegralMissingBody=function(){return{type:"IntegralMissingBody"}},t.DerivativeMissingBody=function(){return{type:"DerivativeMissingBody"}},t.IntegralMissingDifferential=function(){return{type:"IntegralMissingDifferential"}},t.DifferentialWithSuperscript=function(){return{type:"DifferentialWithSuperscript"}},t.FractionMissingNumerator=function(){return{type:"FractionMissingNumerator"}},t.FractionMissingDenominator=function(){return{type:"FractionMissingDenominator"}},t.FractionEmpty=function(){return{type:"FractionEmpty"}},t.AdjacentNumbers=function(t){return{type:"AdjacentNumbers",args:t}},t.UnexpectedFor=function(){return{type:"UnexpectedFor"}},t.TokenWithSubscript=function(){return{type:"TokenWithSubscript"}}});\ndefine(\'core/math/parser/expression-token-tables\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.allTokenTypes=e.rightTable=e.leftTable=e.escapedSymbolTable=e.symbolTable=e.commandTable=void 0;e.commandTable={"\\\\lt":"<","\\\\gt":">","\\\\le":"<=","\\\\ge":">=","\\\\leq":"<=","\\\\geq":">=","\\\\ldots":"...","\\\\sim":"~","\\\\to":"->","\\\\cdot":"*","\\\\times":"*","\\\\div":"/","\\\\ln":"Ln","\\\\log":"Log","\\\\int":"Int","\\\\sum":"Sum","\\\\prod":"Prod","\\\\backslash":"Err","\\\\for":"for"};for(var a=0,l=["sin","cos","tan","cot","sec","csc"];a<l.length;a++){var o=l[a];e.commandTable["\\\\"+o]="Trig",e.commandTable["\\\\"+o+"h"]="Trig",e.commandTable["\\\\arc"+o]="Trig",e.commandTable["\\\\arc"+o+"h"]="Trig",e.commandTable["\\\\ar"+o+"h"]="Trig"}e.symbolTable={"+":"+","-":"-","*":"*","/":"/","!":"!","(":"(",")":")","[":"[","]":"]",",":",","...":"...",":":":","=":"=",">=":">=","<=":"<=",">":">","<":"<","~":"~",".":"."},e.escapedSymbolTable={"\\\\{":"\\\\{","\\\\}":"\\\\}","\\\\%":"%"},e.leftTable={"|":"(|","\\\\{":"\\\\{","[":"[","(":"("},e.rightTable={"|":"|)","\\\\}":"\\\\}","]":"]",")":")"},e.allTokenTypes=Object.keys({"+":!0,"-":!0,"*":!0,"/":!0,"!":!0,"(":!0,")":!0,"\\\\{":!0,"\\\\}":!0,"(|":!0,"|)":!0,"[":!0,"]":!0,",":!0,"...":!0,":":!0,"=":!0,">":!0,"<":!0,">=":!0,"<=":!0,"->":!0,"~":!0,"%":!0,".":!0,for:!0,Letter:!0,Decimal:!0,Cmd:!0,TokenNode:!0,Differential:!0,End:!0,Trig:!0,Ln:!0,Log:!0,Int:!0,Sum:!0,Prod:!0,Err:!0})});\ndefine(\'core/math/parser/expression-lexer\',["require","exports","./expression-token-tables","./input-span","./input-span","./surface-node"],function(require,e,n,r,t,a){"use strict";function s(e,n,r,t,a,s,i,p){return{opts:e,input:n,prevSpan:r,startIndex:t,endIndex:a,token:s,mode:i,parent:p}}function i(e,n,r){return{type:e,span:n,val:r}}function p(e,r,t,a,p,u){var f=r.args;if(t>f.length&&u)return o(u,a);var v=g(r,t=m(f,t),p),d=v.token,y=v.endIndex;if("End"===d.type&&u){var S=u.input.args[u.startIndex];if("LeftRight"===S.type){var h=S.right;return s(e,r,a,t,y,i(n.rightTable[h.val]||"Err",h.span,h.val),p,u)}}else"Int"===d.type?p=l(p):"Differential"===d.type&&(p=c(p));return s(e,r,a,t,y,d,p,u)}function o(e,n){var r=e.input,t=e.endIndex,a=e.mode,s=e.parent;return p(e.opts,r,t+1,n,a,s)}function u(e){return e.token}function l(e){return{type:"integral",parent:e}}function c(e){if(!e||"integral"!==e.type)throw new Error("Programming Error: expected lexer to be in integral mode.");return e.parent}function f(e,n){return{token:n,endIndex:e}}function g(e,t,a){if(t>=e.args.length)return f(t,i("End",r.emptySpanAt(e.span.input,e.span.end),""));var s=e.args[t];switch(s.type){case"Sqrt":case"Frac":case"SupSub":return f(t,s);case"Letter":if(!a||"integral"!==a.type)return f(t,s);if("d"!=s.val)return f(t,s);var p=g(e,t+1,a),o=p.endIndex,u=p.token;return"Letter"===u.type||"Cmd"===u.type?f(o,function(e,n){return{type:"Differential",span:e,val:n}}(r.joinSpans(s.span,u.span),u.val)):f(t,s);case"LeftRight":var l=s.left;return f(t,i(n.leftTable[l.val]||"Err",r.joinSpans(s.span,l.span),l.val));case"OperatorName":for(var c=[],d=0,h=s.arg.args;d<h.length;d++){var b=h[d];if("Letter"!==b.type)return f(t,i("Err",s.span,r.slice(s.arg.span)));c.push(b.val)}var k="\\\\"+c.join("");return f(t,i(n.commandTable[k]||"Cmd",s.span,k));case"TokenNode":var x="$";if(0===s.arg.args.length)return f(t,i("Err",s.span,r.slice(s.arg.span)));for(var j=0,E=s.arg.args;j<E.length;j++){var I=E[j];if("Digit"!==I.type)return f(t,i("Err",s.span,r.slice(s.arg.span)));x+=I.val}return f(t,i("TokenNode",s.span,x));case"Cmd":return f(t,i(n.commandTable[s.val]||"Cmd",s.span,s.val));case"EscapedSymbol":return f(t,i(n.escapedSymbolTable[s.val]||"Err",s.span,s.val));case"Symbol":return function(e,t,a){switch(a.val){case".":return function(e,t){var a=e.args[t];if("Symbol"!==a.type||"."!==a.val)throw new Error("Programming Error: expected \'.\'");if(t+2<e.args.length&&y(e.args[t+1])&&y(e.args[t+2])){var s=r.joinSpans(a.span,e.args[t+2].span);return f(t+2,i("...",s,r.slice(s)))}var p=m(e.args,t+1);if(p<e.args.length&&"Digit"===e.args[p].type)return v(e,t);var o=n.symbolTable[a.val]||"Err";return f(t,i(o,a.span,a.val))}(e,t);case"-":if((s=e.args[t+1])&&S(s,">"))return f(t+1,i("->",r.joinSpans(a.span,s.span),"->"));break;case"<":if((s=e.args[t+1])&&S(s,"="))return f(t+1,i("<=",r.joinSpans(a.span,s.span),"<="));break;case">":var s;if((s=e.args[t+1])&&S(s,"="))return f(t+1,i(">=",r.joinSpans(a.span,s.span),">="))}var p=n.symbolTable[a.val]||"Err";return f(t,i(p,a.span,a.val))}(e,t,s);case"Digit":return v(e,t);default:throw"Unexpected atom "+s.type+"."}}function v(e,n){var t=function(e,n){for(var t=e.args,s=t[n].span,i=[];n<t.length;n++){var p=m(t,n);if(p>=t.length)break;if("Digit"!==(S=t[p]).type)break;n=p,i.push(S.val)}if((n=m(t,n))>=t.length)return;var o=t[n];if("Frac"!==o.type)return;for(var u=[],l=[],c=0,g=o.num.args;c<g.length;c++){if(!d(S=g[c])){if("Digit"!==S.type)return;u.push(S.val)}}for(var v=0,y=o.den.args;v<y.length;v++){var S;if(!d(S=y[v])){if("Digit"!==S.type)return;l.push(S.val)}}var h=r.joinSpans(s,o.span);return f(n,a.MixedNumber(h,i.join(""),u.join(""),l.join("")))}(e,n);if(t)return t;for(var s=e.args,p=e.args[n].span,o=[],u=!1,l=!1;n<s.length;n++){var c=m(s,n);if(c>=s.length)break;var g=s[c];if("Digit"===g.type)n=c,u=!0,o.push(g.val);else{if(l||!y(g))break;if(c+1<s.length&&y(e.args[c+1]))break;n=c,l=!0,o.push(".")}}if(!u)throw new Error("Programming Error: decimals must have at least one digit.");return f(n-1,i("Decimal",r.joinSpans(p,e.args[n-1].span),o.join("")))}function d(e){switch(e.type){case"Sqrt":case"Frac":case"SupSub":case"LeftRight":case"OperatorName":case"TokenNode":case"Symbol":case"Letter":case"Digit":return!1;case"Cmd":return"\\\\space"===e.val;case"EscapedSymbol":return"\\\\ "===e.val||"\\\\:"===e.val||"\\\\,"===e.val||"\\\\;"===e.val;default:throw"Unexpected atom "+e.type+"."}}function m(e,n){for(;n<e.length&&d(e[n]);)n+=1;return n}function y(e){return S(e,".")}function S(e,n){return"Symbol"===e.type&&e.val===n}Object.defineProperty(e,"__esModule",{value:!0}),e.didAdvance=e.isDone=e.isAt=e.endIntegral=e.beginIntegral=e.peek=e.advance=e.lexAt=e.lex=e.emptySpanAtState=e.joinState=e.spanStates=e.Span=void 0,Object.defineProperty(e,"Span",{enumerable:!0,get:function(){return t.Span}}),e.spanStates=function(e,n){return r.joinSpans(e.token.span,n.prevSpan)},e.joinState=function(e,n){return r.joinSpans(e,n.prevSpan)},e.emptySpanAtState=function(e){return r.emptySpanAt(e.token.span.input,e.token.span.start)},e.lex=function(e,n){return p(n,e,0,r.emptySpanAt(e.span.input,e.span.start),undefined,undefined)},e.lexAt=p,e.advance=function(e){var n=e.input.args[e.startIndex],r=e.token.span;return n&&"LeftRight"===n.type?p(e.opts,n.arg,0,r,e.mode,e):o(e,r)},e.peek=u,e.beginIntegral=l,e.endIntegral=c,e.isAt=function(e,n){return u(e).type===n},e.isDone=function(e){return e.startIndex>=e.input.args.length},e.didAdvance=function(e,n){return n.token.span.start>e.token.span.start}});\ndefine(\'core/math/parser/precspec\',["require","exports","./expression-token-tables"],function(require,e,r){"use strict";function t(e,t){for(var n=0,i=r.allTokenTypes;n<i.length;n++){var o=i[n];if(void 0===t[o])throw new Error("Programming Error: token "+o+" must be a assigned a "+e+" precedence")}}function n(e,r,t,n){if(void 0!==r[t])throw new Error("Programming Error: duplicate "+e+" entry for token "+t+".");r[t]=n}Object.defineProperty(e,"__esModule",{value:!0}),e.precSpec=e.ra=e.la=e.r=e.l=e.initial=void 0,e.initial=function(e){return{type:"initial",tokenType:e}},e.l=function(e){return{type:"l",tokenType:e}},e.r=function(e){return{type:"r",tokenType:e}},e.la=function(e){return{type:"la",tokenType:e}},e.ra=function(e){return{type:"ra",tokenType:e}},e.precSpec=function(e){for(var r={},i={},o={},a=0;a<e.length;a++)for(var c=0,l=e[a];c<l.length;c++){var u=l[c],f=u.type,p=u.tokenType;switch(f){case"initial":n("initial",r,p,a);break;case"l":n("left",i,p,a);break;case"r":n("right",o,p,a);break;case"la":n("left",i,p,a),n("right",o,p,a);break;case"ra":n("left",i,p,a),n("right",o,p,a-1)}}function s(e){return o[e]}return t("left",i),t("right",o),{rightPrec:s,leftPrec:function(e){return i[e]},initialPrec:function(e){var t=r[e];return void 0===t?s(e):t}}}});\ndefine(\'core/math/inverses\',[],function(){"use strict";var c={};return["sin","cos","tan","cot","sec","csc","sinh","cosh","tanh","coth","sech","csch"].forEach(function(n){c[n]="arc"+n,c["arc"+n]=n}),c});\ndefine(\'core/math/parser/lower\',["require","exports","core/math/inverses","tslib","core/math/errormsg","./input-span","./surface-node","../maybe-rational"],function(require,e,r,t,a,n,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isLegalAssignmentLhs=e.isFunctionSignature=e.lower=void 0;var c=0;function u(e,r){for(var t=[],a=0;a<r.length;a++)t.push(d(e,r[a]));return t}function o(e){if("Call"===e.type){var r=e.args,t=r[0],a=r[1],n=s.unwrapSeq(a);return s.isIdentifier(t)&&n.every(s.isIdentifier)?{base:t,args:n}:void 0}}function p(e){return s.isIdentifier(e)}function l(e){if("Paren"!==e.type)return!1;var r=e.args[0];return"Seq"===r.type&&2===r.args.length}function d(e,r){return e.setInput(g(e,r),r.span)}function g(e,r){var t=e.nodes;switch(r.type){case"Pos":return g(e,r.args[0]);case"Neg":for(var o=-1,p=r.args[0];;)if("Pos"===p.type||"Paren"===p.type&&!l(p))p=p.args[0];else{if("Neg"!==p.type)break;p=p.args[0],o*=-1}switch(p.type){case"Decimal":var P=w(p);return t.Constant(-1===o?i.neg(P):P);case"MixedNumber":P=S(p);return t.MixedNumber(-1===o?i.neg(P):P);default:return-1===o?t.Negative([d(e,p)]):g(e,p)}case"Add":return t.Add(u(e,r.args));case"Sub":return t.Subtract(u(e,r.args));case"Mul":return t.Multiply(u(e,r.args));case"Div":return t.Divide(u(e,r.args));case"Bang":var M=r.args[0];return"Call"===M.type?t.FunctionFactorial(u(e,M.args)):t.FunctionCall("\\\\factorial",u(e,r.args));case"PercentOf":return t.PercentOf(u(e,r.args));case"Call":return m(e,r);case"ImplicitCall":return function(e){var r=e.args,t=r[0],n=r[1];"Superscript"===t.type&&(t=t.args[0]);if("Cmd"===t.type&&"logbase"===t.val&&"Seq"===n.type&&2===n.args.length){if(!I(n.args[0]))throw a.badImplicitCall("log")}else if(!I(n)){if("Cmd"===t.type)throw a.badImplicitCall(t.val);throw a.parseError()}}(r),m(e,r);case"Dot":var D=r.args[1],A=u(e,r.args),L=A[0],F=A[1];if(C(D)){var B=n.emptySpanAt(D.span.input,D.span.end),O=e.setInput(q(e),B);F=e.setInput(t.SeededFunctionCall(F,[O]),D.span)}else if("Letter"===D.type)switch(D.val){case"x":return t.OrderedPairAccess([L,t.Constant(1)]);case"y":return t.OrderedPairAccess([L,t.Constant(2)])}else if("Call"===D.type){if("Letter"===(U=D.args[0]).type)switch(U.val){case"x":return t.Multiply([t.OrderedPairAccess([L,t.Constant(1)]),d(e,D.args[1])]);case"y":return t.Multiply([t.OrderedPairAccess([L,t.Constant(2)]),d(e,D.args[1])])}}return t.DotAccess([L,F]);case"Prime":var N=r.args[0];if("Call"===N.type){var R=N.args,U=R[0],_=R[1],k=s.unwrapSeq(_).length;if("Cmd"===U.type&&"logbase"===U.val){if(2!==k)throw a.primedFunctionArity()}else if(1!==k)throw a.primedFunctionArity();return t.Prime(r.nprimes,u(e,r.args))}throw"ImplicitCall"===N.type?a.primeWithoutParen():a.unexpectedPrime();case"Index":var T=r.args,W=T[0],j=T[1];if("Seq"===j.type)return t.ListAccess([g(e,W),t.List(u(e,j.args))]);if("Ellipsis"===j.type){var z=j.args,H=z[0],J=z[1];return t.ListAccess([g(e,W),t.Range([t.List(u(e,s.unwrapSeq(H))),t.List("EmptyRangeEnd"===J.type?[]:u(e,s.unwrapSeq(J)))])])}return h(j)?t.ListAccess([g(e,W),v(e,j)]):t.ListAccess(u(e,r.args));case"Paren":var K=r.args[0];if("Seq"===K.type){if(0===K.args.length)throw a.emptyParen();return t.ParenSeq(u(e,K.args))}return g(e,K);case"List":if(0===r.args.length)return t.List([]);var G=r.args[0];if("Ellipsis"===G.type){var Q=G.args;H=Q[0],J=Q[1];return t.Range([t.List(u(e,s.unwrapSeq(H))),t.List(u(e,s.unwrapSeq(J)))])}if("For"===G.type){for(var V=G.args,X=V[0],Y=V[1],Z=e.setInput(t.Identifier("_comprehensionIndex_"+c++),X.span),$=d(E(e,{prefix:"li",expr:Z}),X),ee=[],re=0,te=s.unwrapSeq(Y);re<te.length;re++){var ae=te[re];if(!x(ae))throw a.listComprehensionIncorrectInput();ee.push(e.setInput(t.AssignmentExpression(u(e,ae.args)),ae.span))}return t.ListComprehension(Z,$,ee)}return t.List(u(e,s.unwrapSeq(G)));case"Pipes":return t.FunctionCall("\\\\abs",u(e,r.args));case"Subscript":var ne=r.args,se=ne[0],ie=ne[1];if(0===ie.val.length)throw a.emptySubscript();var ce=void 0;switch(se.type){case"Letter":case"Cmd":ce=se.val;break;default:throw a.unexpectedSubscript()}return t.Identifier(ce+"_"+ie.val);case"Superscript":var ue=r.args,oe=(se=ue[0],ue[1]);if("Call"!==se.type||"Seq"===se.args[1].type||function(e){if("Call"!==e.type)return!1;var r=e.args[0];for(;"Superscript"===r.type||"Subscript"===r.type||"Prime"===r.type;)r=r.args[0];return"Cmd"===r.type&&(f(r.val)||y(r.val))}(se)){if("Dot"===se.type){D=se.args[1];var pe=u(e,se.args),le=(L=pe[0],F=pe[1],d(e,oe));if("Letter"===D.type)switch(D.val){case"x":return t.Exponent([t.OrderedPairAccess([L,t.Constant(1)]),le]);case"y":return t.Exponent([t.OrderedPairAccess([L,t.Constant(2)]),le])}else if("Call"===D.type){if("Letter"===(U=D.args[0]).type)switch(U.val){case"x":return t.Multiply([t.OrderedPairAccess([L,t.Constant(1)]),t.Exponent([d(e,D.args[1]),le])]);case"y":return t.Multiply([t.OrderedPairAccess([L,t.Constant(2)]),t.Exponent([d(e,D.args[1]),le])])}}return t.Exponent([t.DotAccess([L,F]),le])}return t.Exponent(u(e,r.args))}return t.FunctionExponent(u(e,[se.args[0],se.args[1],oe]));case"Sqrt":return t.FunctionCall("sqrt",u(e,r.args));case"Nthroot":return t.FunctionCall("nthroot",u(e,[r.args[1],r.args[0]]));case"Frac":return t.Divide(u(e,r.args));case"Derivative":var de=u(e,r.args);if(!s.isIdentifier(r.args[0]))throw a.parseError();return t.Derivative(de[0],[de[1]]);case"Integral":var ge=r.args;de=u(e,[ye=ge[0],ge[1],he=ge[2],ve=ge[3]]);return t.Integral(de);case"EmptyIntegral":var fe=u(e,r.args),ye=fe[0],me=fe[1],he=fe[2],ve=t.Constant(i.maybeRational(1,1));return t.Integral([ye,me,he,ve]);case"Sum":var we=r.args,Se=(X=we[0],we[1]);he=we[2];if(!x(Se))throw a.incorrectSumLowerBound();var xe=d(E(e,{prefix:"ro",expr:(de=u(e,[Se.args[0],Se.args[1],he]))[0]}),X);return t.Sum(de.concat(xe));case"Product":var be=r.args,Ie=(X=be[0],be[1]);he=be[2];if(!x(Ie))throw a.incorrectProductLowerBound();xe=d(E(e,{prefix:"ro",expr:(de=u(e,[Ie.args[0],Ie.args[1],he]))[0]}),X);return t.Product(de.concat(xe));case"Juxt":return t.Multiply(u(e,r.args));case"Letter":return t.Identifier(r.val);case"Cmd":var Ce=r.val;switch(Ce){case"ans":if(void 0===e.currentIndex)throw a.badSymbolContext("ans");return t.Ans("ans_{"+(e.currentIndex-1)+"}");case"approx":throw a.unrecognizedSymbol(Ce);case"dt":if(!e.allowDt)throw a.badSymbolContext(Ce);return t.Identifier(Ce);case"index":if(!e.allowIndex)throw a.badSymbolContext(Ce);return t.Identifier(Ce);default:return t.Identifier(Ce)}case"Decimal":return t.Constant(w(r));case"MixedNumber":return t.MixedNumber(S(r));case"Piecewise":return function(e,r){var t,n=e.nodes,c=r.args[0],u=s.unwrapSeq(c),o=[];e:for(t=0;t<u.length;t++){var p=u[t];switch(p.type){case"Colon":var l=p.args,g=l[0],f=l[1];if(!h(g))throw a.colonMissingCondition();o.push({condition:v(e,g),if_expr:d(e,f)});break;case"Equals":case"Inequality":case"InequalityChain":o.push({condition:v(e,p),if_expr:n.Constant(i.maybeRational(1,1))});break;default:break e}}if(0===t)throw a.piecewiseMissingCondition();if(t<u.length-1)throw a.piecewisePartMissingCondition();var y=t===u.length-1?d(e,u[t]):n.Constant(NaN);if(!n.Piecewise.chain)throw a.featureUnavailable();return n.Piecewise.chain(o,y)}(e,r);case"RightArrow":return function(e,r){var t=e.nodes;if(!s.isIdentifier(r.args[0]))throw a.updateRuleNonIdentifierLHS();return e=E(e,{prefix:"ec",expr:e.setInput(t.Identifier("globalEventCount"),n.emptySpanAt(r.span.input,r.span.start))}),t.UpdateRule(u(e,r.args))}(e,r);case"Seq":return t.BareSeq(u(e,r.args));case"EmptyPiecewise":if(!t.Piecewise.empty)throw a.featureUnavailable();return t.Piecewise.empty();case"Equals":throw a.unexpectedSymbol("=");case"Inequality":case"InequalityChain":throw a.unexpectedInequality();case"Tilde":throw a.unexpectedSymbol("~");case"Colon":throw a.unexpectedSymbol(":");case"Ellipsis":throw a.unexpectedSymbol("...");case"For":throw a.unexpectedForKeyword();case"EmptyRangeEnd":throw a.invalidHalfEmptyRange();case"Err":throw function(e){switch(e.type){case"UnexpectedParseError":case"MissingBound":case"EmptyGroup":case"UnexpectedDifferential":case"UnexpectedEnd":return a.parseError();case"InvalidOperatorName":return a.invalidOperatorName();case"UnexpectedCloseDelimiter":case"MissingCloseDelimiter":return a.mismatchedBraces(e.open,e.close);case"UnrecognizedSymbol":return"."===e.val?a.unexpectedSymbol(e.val):a.unrecognizedSymbol(e.val);case"EmptyInput":return a.blankExpression();case"BinaryOperatorMissingRight":case"BinaryOperatorMissingLeft":return a.binaryOperatorMissingOperand("%"===e.val?"% of":e.val);case"UnaryOperatorMissingLeft":return a.unaryOperatorMissingLeft(e.val);case"UnaryOperatorMissingRight":return a.unaryOperatorMissingRight(e.val);case"UnexpectedSubscript":return a.cannotSubscript(e.base);case"PercentMissingOf":return a.percentMissingOf();case"SumMissingBound":return a.sumMissingBound();case"ProductMissingBound":return a.productMissingBound();case"IntegralMissingBound":return a.integralMissingBound();case"SumMissingBody":return a.sumMissingBody();case"ProductMissingBody":return a.productMissingBody();case"IntegralMissingBody":return a.integralMissingBody();case"DerivativeMissingBody":return a.derivativeMissingBody();case"IntegralMissingDifferential":return a.integralMissingDifferential();case"DifferentialWithSuperscript":return a.differentialWithSuperscript();case"FractionMissingNumerator":return a.fractionMissingNumerator();case"FractionMissingDenominator":return a.fractionMissingDenominator();case"FractionEmpty":return a.fractionEmpty();case"EmptySuperscript":return a.emptySuperscript();case"EmptySubscript":return a.emptySubscript();case"InvalidSubscript":return a.invalidSubscript(e.val);case"SuperscriptWithPrime":return a.superscriptWithPrime();case"PrimeWithoutParen":return a.primeWithoutParen();case"UnexpectedPrime":return a.unexpectedPrime();case"EmptyRadical":return a.emptyRadical();case"EmptyRadicalIndex":return a.emptyRadicalIndex();case"EmptySquareBracket":return a.emptySquareBracket();case"EmptyPipe":return a.emptyPipe();case"FunctionMissingArgument":return a.wrongArity(e.val,1,0);case"AdjacentNumbers":return a.adjacentNumbers(b(e.args[0]),b(e.args[1]));case"TokenWithSubscript":return a.tokenWithSubscript();case"UnexpectedFor":return a.unexpectedForKeyword();default:throw"Unexpected surface node "+e.type+"."}}(r.error);default:throw"Unexpected surface node "+r.type+"."}}function f(e){return r.hasOwnProperty(e)}function y(e){return"ln"===e||"log"===e||"logbase"===e}function m(e,t){var i=e.nodes,c=t.args,o=c[0],p=c[1],l=d(e,o),g=u(e,s.unwrapSeq(p));if(C(o)){var m=n.emptySpanAt(p.span.input,p.span.start),h=e.setInput(q(e),m);return i.SeededFunctionCall(l,[h].concat(g))}if(s.isIdentifier(o))return i.FunctionCall(l,g);if("Superscript"===o.type){var v=o.args,w=v[0],S=v[1];if("Cmd"===w.type){var x=w.val;if(f(x)||y(x)){if(function(e){return"Decimal"===e.type&&"2"===e.val}(S))return i.Exponent([i.FunctionCall(x,g),d(e,S)]);if(function(e){return"Neg"===e.type&&"Decimal"===(e=e.args[0]).type&&"1"===e.val}(S)&&void 0!==r[x])return i.FunctionCall(r[x],g);throw f(x)?a.badTrigExponent(x):a.badLogExponent("logbase"===x?"log":x)}}}return i.Multiply([l,d(e,p)])}function h(e){return"Equals"===e.type||"Inequality"===e.type||"InequalityChain"===e.type}function v(e,r){var t=e.nodes;switch(r.type){case"Equals":return t.Comparator["="](u(e,r.args));case"Inequality":return t.Comparator[r.symbol](u(e,r.args));case"InequalityChain":if(r.chain.length>1)throw a.inequalityChainTooLong();var i=r.first,c=i.symbol,o=i.args,p=o[0],l=o[1],d=r.chain[0],g=d.symbol,f=d.args[0],y=n.emptySpanAt(r.span.input,r.span.start);return t.And([v(e,s.Inequality(y,c,[p,l])),v(e,s.Inequality(y,g,[l,f]))]);default:throw a.parseError()}}function w(e){return i.fromDecimalString(e.val)}function S(e){var r=i.fromDecimalString(e.whole),t=i.fromDecimalString(e.num),a=i.fromDecimalString(e.den);return i.add(r,i.div(t,a))}function x(e){return"Equals"===e.type&&s.isIdentifier(e.args[0])}function b(e){switch(e.type){case"Decimal":return e.val;case"MixedNumber":return e.whole+" "+e.num+"/"+e.den;default:throw new Error("Unexpected node type "+e.type)}}function I(e){switch(e.type){case"Letter":case"Decimal":case"MixedNumber":case"Cmd":case"EmptyPiecewise":return!0;case"Neg":for(var r=e.args[0];;)if("Pos"===r.type||"Paren"===r.type&&!l(r))r=r.args[0];else{if("Neg"!==r.type)break;r=r.args[0]}return"Decimal"===r.type||"MixedNumber"===r.type;case"Pos":case"Paren":return I(e.args[0]);case"Juxt":case"Mul":case"Div":return I(e.args[0])&&I(e.args[1]);case"Subscript":return I(e.args[0]);case"Superscript":case"Frac":case"Add":case"Sub":return I(e.args[0])&&I(e.args[1]);case"Piecewise":return"Equals"===(r=e.args[0]).type||"Inequality"===r.type||"InequalityChain"===r.type;case"Call":var t=e.args,a=t[0],n=t[1];return!s.isIdentifier(a)&&!s.isSuperscriptedIdentifier(a)&&(I(a)&&I(n));case"Derivative":case"Sqrt":case"Nthroot":case"Pipes":case"Bang":return!1;case"Equals":case"Inequality":case"InequalityChain":case"Tilde":case"ImplicitCall":case"Index":case"List":case"Seq":case"Integral":case"EmptyIntegral":case"Sum":case"Product":case"Colon":case"Ellipsis":case"For":case"Dot":case"PercentOf":case"Prime":case"EmptyRangeEnd":case"RightArrow":return!1;default:throw"Unexpected surface node "+e.type+"."}}function C(e){return"Cmd"===e.type&&("random"===e.val||"shuffle"===e.val)}function q(e){var r=e.nodes.ExtendSeed("",[e.nodes.Identifier("globalRandomSeed"),e.nodes.Seed(e.nextSeed())]);if(!e.seedExtensions)return r;for(var t=0,a=e.seedExtensions;t<a.length;t++){var n=a[t],s=n.prefix,i=n.expr;r=e.nodes.ExtendSeed(s,[r,i])}return r}function E(e,r){var a=e.seedExtensions||[];return t.__assign(t.__assign({},e),{seedExtensions:a.concat(r)})}e.lower=function(e,r){return function(e,r){return e.setInput(function(e,r){var t=e.nodes;switch(r.type){case"Equals":var n=r.args,i=n[0],c=n[1],l=o(i);if(l){var f=l.base,y=l.args;return t.FunctionDefinition(d(e,f),u(e,y),d(e,c))}return p(i)?t.Assignment(d(e,i),d(e,c)):t.Equation(d(e,i),d(e,c));case"Tilde":var m=u(e,r.args);i=m[0],c=m[1];return t.Regression(i,c);case"Inequality":return v(e,r);case"InequalityChain":if(r.chain.length>1)throw a.inequalityChainTooLong();var h=r.first,w=h.symbol,S=h.args,x=S[0],b=S[1],I=r.chain[0],C=I.symbol,q=I.args[0];return s.isIdentifier(b)?t.DoubleInequality([d(e,x),w,d(e,b),C,d(e,q)]):v(e,r);case"Call":var E=r.args,P=E[0],M=E[1];if("Cmd"===P.type)switch(P.val){case"histogram":return t.Histogram(u(e,s.unwrapSeq(M)));case"cube":case"sphere":case"cone":case"dodecahedron":case"octahedron":case"tetrahedron":return t.Object3D(u(e,s.unwrapSeq(M)),P.val);case"dotplot":return t.DotPlot(u(e,s.unwrapSeq(M)));case"boxplot":return t.BoxPlot(u(e,s.unwrapSeq(M)));case"ttest":return t.TTest(u(e,s.unwrapSeq(M)));case"ittest":return t.IndependentTTest(u(e,s.unwrapSeq(M)));case"stats":return t.Stats(u(e,s.unwrapSeq(M)));default:return g(e,r)}return g(e,r);default:return g(e,r)}}(e,r),r.span)}(e,r)},e.isFunctionSignature=function(e){return void 0!==o(e)},e.isLegalAssignmentLhs=p});\ndefine(\'core/math/parser/expression-parser\',["require","exports","tslib","core/math/errormsg","./surface-node","./surface-node-error","./input-span","./expression-lexer","./precspec","./lower"],function(require,e,r,t,a,n,s,i,p,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parse=void 0;var c=[[p.initial("("),p.la(")"),p.initial("\\\\{"),p.la("\\\\}"),p.r("["),p.la("]"),p.initial("(|"),p.la("|)"),p.la("Differential"),p.la("End")],[p.r("for")],[p.ra("...")],[p.la(",")],[p.ra(":")],[p.r("->")],[p.la("="),p.la(">"),p.la("<"),p.la(">="),p.la("<="),p.la("~")],[p.l("->")],[p.l("for")],[p.la("+"),p.la("-")],[p.la("*"),p.la("/"),p.la("Decimal"),p.la("MixedNumber"),p.la("Letter"),p.la("Cmd"),p.la("TokenNode"),p.la("%"),p.r("("),p.la("\\\\{"),p.la("(|"),p.la("Frac"),p.la("Sqrt"),p.la("Trig"),p.la("Ln"),p.la("Log"),p.ra("Int"),p.ra("Sum"),p.ra("Prod")],[p.initial("+"),p.initial("-")],[p.la("!")],[p.la("SupSub")],[p.l("["),p.la(".")],[p.l("(")],[p.la("Err")]],o=p.precSpec(c),l=o.leftPrec,d=o.rightPrec,E=o.initialPrec,f={trailingComma:!1};function y(e,r){var t=(void 0===r?{isToplevel:!1}:r).isToplevel;if(i.isDone(e))return n.Err(i.spanStates(e,e),n.EmptyGroup());var a=S(e,0,{isToplevel:t}),s=a.state,p=a.tree;return"Err"===p.type||i.isDone(s)?p:j(s).tree}function v(e,r){return{state:e,tree:r}}function S(e,r,s){var p,u,c,o=(void 0===s?{isToplevel:!1}:s).isToplevel,f=e;if(p=function(e){var r,s,p,u,c,o,d,f,g,b,x,P,C,w,B,I,L,N,O,T=e,q=i.peek(e),F=E(q.type);switch(q.type){case"+":if(e=(r=S(e=i.advance(e),F)).state,"Err"===(O=r.tree).type){if(!m(O.error))return v(e,O);var R=i.spanStates(T,e);return v(e,n.Err(R,n.UnaryOperatorMissingRight(q.val)))}return v(e,a.Pos(i.spanStates(T,e),[O]));case"-":if(e=(s=S(e=i.advance(e),F)).state,"Err"===(O=s.tree).type){if(!m(O.error))return v(e,O);R=i.spanStates(T,e);return v(e,n.Err(R,n.UnaryOperatorMissingRight(q.val)))}return v(e,a.Neg(i.spanStates(T,e),[O]));case"(":return A(e);case"\\\\{":return e=i.advance(e),i.isAt(e,"\\\\}")?v(e=i.advance(e),a.EmptyPiecewise(i.spanStates(T,e))):(e=(u=U(T,e=(p=S(e,F)).state,O=p.tree,"\\\\{","\\\\}")).state,"Err"===(O=u.tree).type?v(e,O):v(e,a.Piecewise(i.spanStates(T,e),[O])));case"[":return e=i.advance(e),i.isAt(e,"]")?v(e=i.advance(e),a.List(i.spanStates(T,e),[])):(e=(o=U(T,e=(c=S(e,F)).state,O=c.tree,"[","]")).state,"Err"===(O=o.tree).type?v(e,O):v(e,a.List(i.spanStates(T,e),[O])));case"(|":if(e=i.advance(e),i.isAt(e,"|)")){e=i.advance(e);R=i.spanStates(T,e);return v(e,n.Err(R,n.EmptyPipe()))}return e=(f=U(T,e=(d=S(e,F)).state,O=d.tree,"(|","|)")).state,"Err"===(O=f.tree).type?v(e,O):v(e,a.Pipes(i.spanStates(T,e),[O]));case"Frac":if(e.opts.disallowFrac)throw t.fractionsUnavailable();e=i.advance(e);var G=y(i.lex(q.num,e.opts)),_=y(i.lex(q.den,e.opts));if("Err"===G.type&&"EmptyGroup"===G.error.type&&"Err"===_.type&&"EmptyGroup"===_.error.type){R=i.spanStates(T,e);return v(e,n.Err(R,n.FractionEmpty()))}if("Err"===G.type&&"EmptyGroup"===G.error.type){R=i.spanStates(T,e);return v(e,n.Err(R,n.FractionMissingNumerator()))}if("Err"===_.type&&"EmptyGroup"===_.error.type){R=i.spanStates(T,e);return v(e,n.Err(R,n.FractionMissingDenominator()))}if("Err"===G.type)return v(e,G);if("Err"===_.type)return v(e,_);if(a.isDerivative(G,_)&&"Juxt"===_.type){var W=_.args[1],J=void 0;if(e=(g=S(e,l("*")-1)).state,"Err"===(J=g.tree).type){if(m(J.error)){R=i.spanStates(T,e);return v(e,n.Err(R,n.DerivativeMissingBody()))}return v(e,J)}return v(e,a.Derivative(i.spanStates(T,e),[W,J]))}return v(e,a.Frac(i.spanStates(T,e),[G,_]));case"Sqrt":if(e=i.advance(e),q.optArg){var z=y(i.lex(q.optArg,e.opts));return"Err"===z.type?"EmptyGroup"===z.error.type?v(e,n.Err(z.span,n.EmptyRadicalIndex())):v(e,z):"Err"===(H=y(i.lex(q.arg,e.opts))).type?"EmptyGroup"===H.error.type?v(e,n.Err(H.span,n.EmptyRadical())):v(e,H):v(e,a.Nthroot(i.spanStates(T,e),[z,H]))}var H;return"Err"===(H=y(i.lex(q.arg,e.opts))).type?"EmptyGroup"===H.error.type?v(e,n.Err(H.span,n.EmptyRadical())):v(e,H):v(e,a.Sqrt(i.spanStates(T,e),[H]));case"Trig":case"Ln":e=i.advance(e);var K=a.Cmd(i.spanStates(T,e),q.val),Q=0;if("SupSub"===(ie=i.peek(e)).type){if(e=i.advance(e),ie.sub){R=i.spanStates(T,e);return v(e,n.Err(R,n.UnexpectedSubscript(K.val)))}if(Z=h(ie,e.opts)){if("Err"===Z.type)return v(e,Z);K=a.Superscript(i.spanStates(T,e),[K,Z])}Q=ie.nprimes}if(V=i.isAt(e,"(")){if(e=(b=A(e)).state,"Err"===(O=b.tree).type)return v(e,O);O=a.Call(i.spanStates(T,e),[K,O.args[0]])}else{if(e=(x=S(e,F-1)).state,"Err"===(O=x.tree).type)return m(O.error)?v(e,n.Err(i.spanStates(T,e),n.FunctionMissingArgument(q.val))):v(e,O);O=a.ImplicitCall(i.spanStates(T,e),[K,O])}if(Q>0){R=i.spanStates(T,e);if(!V)return v(e,n.Err(R,n.PrimeWithoutParen()));O=a.Prime(R,Q,[O])}return v(e,O);case"Log":e=i.advance(e);var V,X=i.spanStates(T,e),Y=(K=a.Cmd(X,q.val),Q=0,void 0),Z=void 0;if("SupSub"===(ie=i.peek(e)).type&&(Y=M(ie,(e=i.advance(e)).opts),Z=h(ie,e.opts),Q=ie.nprimes),Y&&"Err"===Y.type)return v(e,Y);if(Z&&"Err"===Z.type)return v(e,Z);if(V=i.isAt(e,"(")){if(e=(P=A(e)).state,"Err"===(O=P.tree).type)return v(e,O);O=O.args[0]}else if(e=(C=S(e,F-1)).state,"Err"===(O=C.tree).type)return m(O.error)?v(e,n.Err(i.spanStates(T,e),n.FunctionMissingArgument(q.val))):v(e,O);var $=Y?a.Cmd(X,"\\\\logbase"):K,ee=Y?a.Seq(i.spanStates(T,e),a.unwrapSeq(O).concat(Y)):O;if(Z&&($=a.Superscript(i.spanStates(T,e),[$,Z])),O=V?a.Call(i.spanStates(T,e),[$,ee]):a.ImplicitCall(i.spanStates(T,e),[$,ee]),Q>0){R=i.spanStates(T,e);if(!V)return v(e,n.Err(R,n.PrimeWithoutParen()));O=a.Prime(R,Q,[O])}return v(e,O);case"Int":if(e=i.advance(e),"Err"===(te=D(ie=i.peek(e),T,e=i.advance(e))).type)return"MissingBound"===te.error.type?v(e,n.Err(te.span,n.IntegralMissingBound())):v(e,te);Z=te.sup,Y=te.sub,W=void 0;if(i.isAt(e,"Differential"))return e=(w=k(e)).state,"Err"===(W=w.tree).type?v(e,W):v(e,a.EmptyIntegral(i.spanStates(T,e),[W,Y,Z]));if(e=(B=S(e,F)).state,"Err"===(O=B.tree).type)return m(O.error)?v(e,n.Err(O.span,n.IntegralMissingBody())):v(e,O);var re=O;return i.isAt(e,"Differential")?(e=(I=k(e)).state,"Err"===(W=I.tree).type?v(e,W):v(e,a.Integral(i.spanStates(T,e),[W,Y,Z,re]))):v(e,n.Err(i.spanStates(T,e),n.IntegralMissingDifferential()));case"Sum":if(e=i.advance(e),"Err"===(te=D(ie=i.peek(e),T,e=i.advance(e))).type)return"MissingBound"===te.error.type?v(e,n.Err(te.span,n.SumMissingBound())):v(e,te);Z=te.sup,Y=te.sub;return e=(L=S(e,F)).state,"Err"===(O=L.tree).type?m(O.error)?v(e,n.Err(O.span,n.SumMissingBody())):v(e,O):v(e,a.Sum(i.spanStates(T,e),[O,Y,Z]));case"Prod":var te;if(e=i.advance(e),"Err"===(te=D(ie=i.peek(e),T,e=i.advance(e))).type)return"MissingBound"===te.error.type?v(e,n.Err(te.span,n.ProductMissingBound())):v(e,te);Z=te.sup,Y=te.sub;return e=(N=S(e,F)).state,"Err"===(O=N.tree).type?m(O.error)?v(e,n.Err(O.span,n.ProductMissingBody())):v(e,O):v(e,a.Product(i.spanStates(T,e),[O,Y,Z]));case"Cmd":return v(e=i.advance(e),O=a.Cmd(i.spanStates(T,e),q.val));case"TokenNode":return e=i.advance(e),"SupSub"===(ie=i.peek(e)).type&&ie.sub?v(e=i.advance(e),n.Err(i.spanStates(T,e),n.TokenWithSubscript())):v(e,O=a.Cmd(i.spanStates(T,e),q.val));case"Letter":return v(e=i.advance(e),O=a.Letter(i.spanStates(T,e),q.val));case"Decimal":e=i.advance(e);var ae=a.Decimal(i.spanStates(T,e),q.val);if("Decimal"===(ie=e.token).type||"MixedNumber"===ie.type){var ne=e;e=i.advance(e);R=i.spanStates(T,e);var se="MixedNumber"===ie.type?ie:a.Decimal(i.spanStates(ne,e),ie.val);return v(e,n.Err(R,n.AdjacentNumbers([ae,se])))}return v(e,ae);case"MixedNumber":if(e.opts.disallowFrac)throw t.fractionsUnavailable();var ie;if("Decimal"===(ie=(e=i.advance(e)).token).type||"MixedNumber"===ie.type){ne=e;e=i.advance(e);R=i.spanStates(T,e),se="MixedNumber"===ie.type?ie:a.Decimal(i.spanStates(ne,e),ie.val);return v(e,n.Err(R,n.AdjacentNumbers([q,se])))}return v(e,q);case"*":case"/":case",":case"=":case">":case"<":case">=":case"<=":case"->":case"~":case":":case"...":case"%":case".":e=i.advance(e);R=i.spanStates(T,e);return v(e,n.Err(R,n.BinaryOperatorMissingLeft(q.val)));case"for":e=i.advance(e);R=i.spanStates(T,e);return v(e,n.Err(R,n.UnexpectedFor()));case"!":e=i.advance(e);R=i.spanStates(T,e);return v(e,n.Err(R,n.UnaryOperatorMissingLeft(q.val)));case"SupSub":e=i.advance(e);var pe="supsub";q.sub?pe="subscript":q.sup?pe="superscript":q.nprimes>0&&(pe="prime");R=i.spanStates(T,e);return v(e,n.Err(R,n.UnaryOperatorMissingLeft(pe)));case")":case"\\\\}":case"]":case"|)":case"Differential":return j(e);case"Err":e=i.advance(e);R=i.spanStates(T,e);return v(e,n.Err(R,n.UnrecognizedSymbol(q.val)));case"End":R=i.spanStates(T,e);return v(e,n.Err(R,n.UnexpectedEnd()));default:throw"Unexpected token type "+q.type+"."}}(f),f=p.state,"Err"===(c=p.tree).type)return v(f,c);if(!i.didAdvance(e,f))throw new Error("Programming Error: parseInitial did not advance state.");for(;!i.isDone(f);){if(r>=(i.isAt(f,"(")&&!x(c)?d("("):l(i.peek(f).type)))break;var P=f;if(f=(u=b(f,c,g(f,c,o)?l(",")-1:d(i.peek(f).type))).state,"Err"===(c=u.tree).type)return v(f,c);if(!i.didAdvance(P,f))throw new Error("Programming Error: parseSuccessor did not advance state.")}return v(f,c)}function m(e){return"UnexpectedDifferential"===e.type||"UnexpectedCloseDelimiter"===e.type||"UnexpectedEnd"===e.type||"BinaryOperatorMissingLeft"===e.type}function g(e,r,t){return i.isAt(e,"=")&&t&&(u.isFunctionSignature(r)||u.isLegalAssignmentLhs(r))}function b(e,r,t){var s,p,u,c,o,d,E,f,y,g,b,x,M,D=i.peek(e);switch(D.type){case"+":case"-":case"*":case"/":case"=":case"~":case":":case".":case"->":case"for":if(e=(s=S(e=i.advance(e),t)).state,"Err"===(M=s.tree).type){if(m(M.error)){var k=i.joinState(r.span,e);return v(e,n.Err(k,n.BinaryOperatorMissingRight(D.val)))}return v(e,M)}return v(e,function(e,r,t){switch(e){case"+":return a.Add(r,t);case"-":return a.Sub(r,t);case"*":return a.Mul(r,t);case"/":return a.Div(r,t);case"=":return a.Equals(r,t);case"~":return a.Tilde(r,t);case":":return a.Colon(r,t);case".":return a.Dot(r,t);case"->":return a.RightArrow(r,t);case"for":return a.For(r,t);default:throw"Unexpected token type "+e+"."}}(D.type,i.joinState(r.span,e),[r,M]));case"%":e=i.advance(e);var w=i.peek(e);if("Cmd"!==w.type||"of"!==w.val&&"\\\\of"!==w.val)return v(e,n.Err(D.span,n.PercentMissingOf()));if(e=(p=S(e=i.advance(e),t)).state,"Err"===(M=p.tree).type){if(m(M.error)){k=i.joinState(r.span,e);return v(e,n.Err(k,n.BinaryOperatorMissingRight(D.val)))}return v(e,M)}return v(e,a.PercentOf(i.joinState(r.span,e),[r,M]));case">=":case"<=":case">":case"<":var B=D.type;if(e=(u=S(e=i.advance(e),t)).state,"Err"===(M=u.tree).type){if(m(M.error)){k=i.joinState(r.span,e);return v(e,n.Err(k,n.BinaryOperatorMissingRight(D.val)))}return v(e,M)}for(var I=a.Inequality(i.joinState(r.span,e),B,[r,M]),L=[],N=i.peek(e).type;">="===N||"<="===N||">"===N||"<"===N;){var O=e;if(B=N,e=(c=S(e=i.advance(e),t)).state,"Err"===(M=c.tree).type){if(m(M.error)){k=i.joinState(r.span,e);return v(e,n.Err(k,n.BinaryOperatorMissingRight(D.val)))}return v(e,M)}L.push(a.TrailingInequalityPiece(i.spanStates(O,e),B,[M])),N=i.peek(e).type}return L.length?v(e,a.InequalityChain(i.joinState(r.span,e),I,L)):v(e,I);case"!":return v(e=i.advance(e),a.Bang(i.joinState(r.span,e),[r]));case"[":O=e;if(e=i.advance(e),i.isAt(e,"]")){e=i.advance(e);k=i.spanStates(O,e);return v(e,n.Err(k,n.EmptySquareBracket()))}return e=(d=U(O,e=(o=S(e,t)).state,M=o.tree,"[","]")).state,"Err"===(M=d.tree).type?v(e,M):v(e,a.Index(i.joinState(r.span,e),[r,M]));case"Sqrt":case"Frac":case"Letter":case"Cmd":case"TokenNode":case"Trig":case"Ln":case"Log":case"Sum":case"Int":case"Prod":case"Decimal":case"MixedNumber":case"\\\\{":case"(|":return e=(E=S(e,t)).state,"Err"===(M=E.tree).type?v(e,M):v(e,a.Juxt(i.joinState(r.span,e),[r,M]));case"(":if(a.isIdentifier(r)){if(e=(f=A(e)).state,"Err"===(M=f.tree).type)return v(e,M);k=i.joinState(r.span,e);return v(e,a.Call(k,[r,M.args[0]]))}if("Prime"===r.type&&a.isIdentifier(r.args[0])){if(e=(y=A(e)).state,"Err"===(M=y.tree).type)return v(e,M);k=i.joinState(r.span,e);return v(e,a.Prime(k,r.nprimes,[a.Call(k,[r.args[0],M.args[0]])]))}return e=(g=S(e,t)).state,"Err"===(M=g.tree).type?v(e,M):v(e,a.Juxt(i.joinState(r.span,e),[r,M]));case"SupSub":e=i.advance(e);var T=P(D),q=h(D,e.opts);if(T&&"Err"===T.type)return v(e,T);if(q&&"Err"===q.type)return v(e,q);if(T&&(r=a.Subscript(i.joinState(r.span,e),[r,T])),q&&(r=a.Superscript(i.joinState(r.span,e),[r,q])),D.nprimes>0){k=i.joinState(r.span,e);if(!a.isIdentifier(r))return v(e,n.Err(k,n.UnexpectedPrime()));r=a.Prime(k,D.nprimes,[r])}return v(e,r);case",":for(var F=[r];i.isAt(e,",")&&(e=i.advance(e),!i.isAt(e,"..."))&&(!e.opts.trailingComma||!C(e));){if(e=(b=S(e,t)).state,"Err"===(M=b.tree).type){if(m(M.error)){k=i.joinState(r.span,e);return v(e,n.Err(k,n.BinaryOperatorMissingRight(D.val)))}return v(e,M)}F.push(M)}return v(e,a.Seq(i.joinState(r.span,e),F));case"...":if(e=i.advance(e),i.isAt(e,",")&&(e=i.advance(e)),t>=l(i.peek(e).type))return v(e,a.Ellipsis(i.joinState(r.span,e),[r,a.EmptyRangeEnd(i.emptySpanAtState(e))]));if(e=(x=S(e,t)).state,"Err"===(M=x.tree).type){if(m(M.error)){k=i.joinState(r.span,e);return v(e,n.Err(k,n.BinaryOperatorMissingRight(D.val)))}return v(e,M)}return v(e,a.Ellipsis(i.joinState(r.span,e),[r,M]));case"]":case")":case"\\\\}":case"|)":case"Differential":return j(e);case"Err":return S(e,t);case"End":k=i.spanStates(e,e);return v(e,n.Err(k,n.UnexpectedEnd()));default:throw"Unexpected token type "+D.type+"."}}function x(e){return!!a.isIdentifier(e)||!("Prime"!==e.type||!a.isIdentifier(e.args[0]))}function M(e,r){if(e.sub){var t=e.sub,a=y(i.lex(t,r));return"Err"===a.type&&"EmptyGroup"===a.error.type?n.Err(a.span,n.EmptySubscript()):a}}function P(e){if(e.sub){var r=e.sub;if(0===r.args.length)return n.Err(r.span,n.EmptySubscript());for(var t=[],i=0,p=r.args;i<p.length;i++){var u=p[i];if("Digit"!==u.type&&"Letter"!==u.type){var c=u.span;return n.Err(c,n.InvalidSubscript(s.slice(c)))}t.push(u.val)}return a.Alphanumeric(r.span,t.join(""))}}function h(e,r){if(e.sup){var t=y(i.lex(e.sup,r));return"Err"===t.type?"EmptyGroup"===t.error.type?n.Err(t.span,n.EmptySuperscript()):t:e.nprimes>0?n.Err(e.span,n.SuperscriptWithPrime()):t}}function D(e,r,t){if("SupSub"!==e.type){var a=i.spanStates(r,t);return n.Err(a,n.MissingBound())}if(e.nprimes>0){a=i.spanStates(r,t);return n.Err(a,n.UnexpectedPrime())}var s=M(e,t.opts),p=h(e,t.opts);if(!s||"Err"===s.type&&"EmptySubscript"===s.error.type||!p||"Err"===p.type&&"EmptySuperscript"===p.error.type){a=i.spanStates(r,t);return n.Err(a,n.MissingBound())}return"Err"===s.type?s:"Err"===p.type?p:{type:"Bounds",sup:p,sub:s}}function A(e){var r,t,n,s=e,p=i.peek(e),u=E(p.type);if(!i.isAt(e,"("))throw new Error("Programming Error: expected \'(\' at start of parseParen.");if(e=i.advance(e),i.isAt(e,")")){var c=a.Seq(i.emptySpanAtState(e),[]);e=i.advance(e);var o=i.spanStates(s,e);return v(e,a.Paren(o,[c]))}return e=(t=U(s,e=(r=S(e,u)).state,n=r.tree,"(",")")).state,"Err"===(n=t.tree).type?v(e,n):v(e,a.Paren(i.spanStates(s,e),[n]))}function k(e){var r=e,t=i.peek(e);if("Differential"!==t.type)throw new Error("Programming Error: expected differential");e=i.advance(e);var s=a.Cmd(t.span,t.val),p=i.peek(e);if("SupSub"===p.type){e=i.advance(e);var u=i.spanStates(r,e),c=P(p);if(c){if("Err"===c.type)return v(e,c);s=a.Subscript(u,[s,c])}if(p.sup)return v(e,n.Err(u,n.DifferentialWithSuperscript()));if(p.nprimes>0)return v(e,n.Err(u,n.UnexpectedPrime()))}return v(e,s)}function U(e,r,t,a,s){if("Err"===t.type&&"UnexpectedEnd"!==t.error.type)return v(r,t);if("Err"===t.type||!i.isAt(r,s)){var p=i.spanStates(e,r);return v(r,n.Err(p,n.MissingCloseDelimiter(a,s)))}return v(r=i.advance(r),t)}function j(e){var r=e;switch(i.peek(e).type){case")":e=i.advance(e);var t=i.spanStates(r,e);return v(e,n.Err(t,n.UnexpectedCloseDelimiter("(",")")));case"]":e=i.advance(e);t=i.spanStates(r,e);return v(e,n.Err(t,n.UnexpectedCloseDelimiter("[","]")));case"\\\\}":e=i.advance(e);t=i.spanStates(r,e);return v(e,n.Err(t,n.UnexpectedCloseDelimiter("\\\\{","\\\\}")));case"|)":e=i.advance(e);t=i.spanStates(r,e);return v(e,n.Err(t,n.UnexpectedCloseDelimiter("|","|")));case"Differential":e=i.advance(e);t=i.spanStates(r,e);return v(e,n.Err(t,n.UnexpectedDifferential()));default:e=i.advance(e);t=i.spanStates(r,e);return v(e,n.Err(t,n.UnexpectedParseError()))}}function C(e){return i.isAt(e,")")||i.isAt(e,"]")||i.isAt(e,"\\\\}")}e.parse=function(e,t){var a=t?r.__assign(r.__assign({},f),t):f,s=y(i.lex(e,a),{isToplevel:!0});return"Err"===s.type&&"EmptyGroup"===s.error.type?n.Err(s.span,n.EmptyInput()):s}});\ndefine(\'core/math/baseparser\',["require","exports","parsenodes","core/math/errormsg","core/math/parser/latex-parser","core/math/parser/expression-parser","core/math/parser/lower"],function(require,r,e,a,t,o,n){"use strict";function i(){throw a.featureUnavailable()}function s(r,e){return r.setInputSpan(e),r}Object.defineProperty(r,"__esModule",{value:!0}),r.parse=void 0,r.parse=function(r,l){void 0===l&&(l={});var d=typeof r;if("string"!==d)throw new Error("Type Error: parse can only be called with strings, got "+JSON.stringify(r)+" of type "+d);var c=e;if(l.disabledFeatures){c=Object.create(c);for(var p=0,u=l.disabledFeatures;p<u.length;p++){var f=u[p];if(!c[f])throw new Error("Programming Error: "+f+" cannot be disabled because it is not a parsenode.");c[f]=i}}var v=void 0===l.seedPrefix?"":l.seedPrefix,w=0,m={nodes:c,currentIndex:l.index,setInput:s,nextSeed:function(){var r=v+"::vc"+w;return w+=1,r},allowDt:!!l.allowDt,allowIndex:!!l.allowIndex},g={};void 0!==l.trailingComma&&(g.trailingComma=l.trailingComma),l.disallowFrac&&(g.disallowFrac=!0);try{var h=t.parse(r),x=o.parse(h,g);return n.lower(m,x)}catch(r){return r instanceof e.Error?r:"string"==typeof r?e.Error(r):a.parseError()}}});\ndefine(\'core/math/sliders\',["require","exports"],function(require,e){"use strict";function a(e,a){var r=Math.round(1e6*e)/1e6;return Math.abs(r-e)<a?r:e}function r(e){var r=e.target,t=e.hardMin,i=e.hardMax,n=e.step,o=1e-10;if(void 0!==t&&void 0!==i&&(o=Math.min(o,Math.abs(i-t)/1e3)),n&&(o=Math.min(o,n/10)),void 0!==t&&(t=a(t,o)),void 0!==i&&(i=a(i,o)),e.forceSliderToMax&&void 0!==i&&(r=i),t>i)return t;if(r<=t)return t;if(r>=i)return i;if(n){var d=void 0!==t?t:0;r=n*Math.round((r-d)/n)+d}var u=a(r,o);return(n||t===u||i===u)&&(r=u),r<=t?t:r>=i?i:r}Object.defineProperty(e,"__esModule",{value:!0}),e.computeSoftMax=e.constrainSliderValueLikeEvaluator=e.determineWhichLimitsAreCompatibleWithValue=e.roundToReasonableDecimal=void 0,e.roundToReasonableDecimal=a,e.determineWhichLimitsAreCompatibleWithValue=function(e){var a=!0,t=!0,i=!0;return void 0!==e.hardMin&&e.target<e.hardMin&&(a=!1),void 0!==e.hardMax&&e.target>e.hardMax&&(t=!1),e.step&&r({target:e.target,step:e.step,hardMin:a?e.hardMin:void 0,hardMax:t?e.hardMax:void 0})!==e.target&&(i=!1),{min:a,max:t,step:i}},e.constrainSliderValueLikeEvaluator=r,e.computeSoftMax=function(e){var a=e.storedMax,t=e.sliderValue,i=e.hardMin,n=e.step,o=10;if(a>o&&(o=a),t>o&&(o=t),i>o&&(o=i),n){var d=r({target:o,hardMin:i,hardMax:void 0,step:n});o=d>=o?d:d+n}return o}});\ndefine(\'core/math/features/getConcreteTree\',[\'require\',\'parsenodes\',\'core/math/errormsg\',\'core/math/types\',\'core/math/maybe-rational\',\'core/math/sliders\'],function(require){"use strict";var e=require("parsenodes"),t=require("core/math/errormsg"),r=require("core/math/types"),i=require("core/math/maybe-rational"),s=(e.List,e.ParenSeq,e.Constant),n=e.Identifier,o=require("core/math/sliders");function a(e,r){return e.isError?e:-1===r.indexOf(e.valueType)?t.parseError():e}function l(e,t,r){if(t){var i=t.getDependencies();if(t.isError)r.errors[e]=!0;else if(i.length>0){r.errors[e]=!0;for(var s=0;s<i.length;s++)i[s]===r.exportedSymbol?r.errors.cycle=!0:r.missingVars.push(i[s])}else r.values[e]=+t.asValue();r.valids[e]=isFinite(r.values[e]),r.valids[e]||(r.values[e]=void 0)}else r.valids[e]=!0}function c(e){return e&&e.valueType===r.ListOfNumber&&1===e.length&&e.args?e.args[0]:e}function u(i,s){if(!s[this._symbol])throw t.functionUnsupported(this._symbol);var n=this.args.map(function(e){return e.getConcreteTree(i,s)});if(n.length>0){if(1===n.length&&n.push(e.Constant(1).getConcreteTree(i,s)),n[1].getDependencies().length)throw t.illegalBinWidth(this._symbol).setDependencies(n[1].getDependencies());if(n[1].valueType!==r.Number)throw t.illegalBinWidth(this._symbol);var o=n[1].asValue();if(!isFinite(o)||o<=0)throw t.illegalBinWidth(this._symbol)}return this.typeCheck(i,n),new this.constructor(n)}function h(e,r){if(!r[this._symbol])throw t.functionUnsupported(this._symbol);var i=this.args.map(function(t){return t.getConcreteTree(e,r)});return this.typeCheck(e,i),new this.constructor(i)}e.Base.prototype.tryGetConcreteTree=function(){var r;try{r=this.getConcreteTree.apply(this,arguments)}catch(i){r=i instanceof e.Base?i:t.parseError()}return r},e.Base.prototype.getConcreteTree=function(e,t){var r=this.buildIRExpression(e,t);if(r.isError)throw r;return r},e.DoubleInequality.prototype.getConcreteTree=function(t,r){return new this.constructor([e.Piecewise([this._indicator,this._expressions[0],s(NaN)]).getConcreteTree(t,r),this._operators[0],n(this._symbol),this._operators[1],e.Piecewise([this._indicator,this._expressions[1],s(NaN)]).getConcreteTree(t,r)])},e.Error.prototype.getConcreteTree=function(e,t){return this},e.Image.prototype.getConcreteTree=function(t,i){var s=this.center.tryGetConcreteTree(t,i),n=this.radianAngle.tryGetConcreteTree(t,i),o=this.width.tryGetConcreteTree(t,i),l=this.height.tryGetConcreteTree(t,i),c=this.opacity.tryGetConcreteTree(t,i),u=[r.Point,r.ListOfPoint,r.EmptyList],h=[r.Number,r.ListOfNumber,r.EmptyList];return s=a(s,u),n=a(n,h),o=a(o,h),l=a(l,h),c=a(c,h),e.Image({center:s,radianAngle:n,width:o,height:l,opacity:c},this.moveStrategy)},e.Ticker.prototype.getConcreteTree=function(i,s){var n=this.handler.tryGetConcreteTree(i,s);n.isError||n.valueType===r.Action||(n=t.eventHandlerTypeError(r.prettyPrint(n.valueType)));var o=n.getDependencies().filter(function(e){return!i.validActionVariable(e)});return o.length&&(n=t.tooManyVariables(i.sliderVariables(o)).setDependencies(o)),e.Ticker({handler:n,minStep:this.minStep.tryGetConcreteTree(i,s)})},e.Slider.prototype.getConcreteTree=function(e,r){var n=this._expression.getConcreteTree(e,r),a=c(this.sliderMin&&this.sliderMin.tryGetConcreteTree(e,r)),u=c(this.sliderMax&&this.sliderMax.tryGetConcreteTree(e,r)),h=c(this.sliderStep&&this.sliderStep.tryGetConcreteTree(e,r)),p={exportedSymbol:this._symbol,errors:{},values:{},valids:{},missingVars:[],errMsg:void 0};if(l("min",a,p),l("max",u,p),l("step",h,p),h&&p.valids.step&&(0===p.values.step?delete p.values.step:p.values.step=Math.abs(p.values.step)),p.errors.cycle?n=t.sliderLimitReferencesExport(p.exportedSymbol):(p.errors.min||!p.valids.min?p.errMsg=t.sliderMinInvalid():p.errors.max||!p.valids.max?p.errMsg=t.sliderMaxInvalid():!p.errors.step&&p.valids.step||(p.errMsg=t.sliderStepInvalid()),p.values.min>p.values.max&&(p.valids.min=!1,p.valids.max=!1,p.errMsg||(p.errMsg=t.sliderMaxLessThanMin()))),n.isConstant){var d=r.initialEvaluation&&r.initialEvaluation.asValue()&&this.sliderIsPlayingOnce,y=p.values.max,v=+n.asValue(),g=p.values.min,T=p.values.step;if(d&&!isFinite(y)){var m=c(this.sliderSoftMax&&this.sliderSoftMax.tryGetConcreteTree(e,r));m&&(y=o.computeSoftMax({storedMax:+m.asValue(),sliderValue:v,step:T,hardMin:g}))}var f=o.constrainSliderValueLikeEvaluator({target:v,hardMin:g,hardMax:y,step:T,forceSliderToMax:d}),C=i.fromDecimalString(f.toString()),b=isFinite(i.asFloat(C))?C:f;n=s(b).getConcreteTree(e,r)}return n.sliderInfo=p,n},e.Histogram.prototype.getConcreteTree=u,e.DotPlot.prototype.getConcreteTree=u,e.BoxPlot.prototype.getConcreteTree=function(e,i){if(!i[this._symbol])throw t.functionUnsupported(this._symbol);var s=this.args.map(function(t){return t.getConcreteTree(e,i)});return this.typeCheck(e,s),1!==s.length||s[0].valueType!==r.ListOfNumber&&s[0].valueType!==r.EmptyList?t.parseError():new this.constructor(s)},e.TTest.prototype.getConcreteTree=h,e.IndependentTTest.prototype.getConcreteTree=h,e.Stats.prototype.getConcreteTree=h,e.Table.prototype.getConcreteTree=function(e,t){for(var r=[],i=Object.create(t),s=0;s<this.columns.length;s++){var n=this.columns[s].getConcreteTree(e,i);n.isIndependent&&this.columns[s].exportToLocal(n,i),r.push(n)}return new this.constructor(r)},e.TableColumn.prototype.getConcreteTree=function(i,s,n){var o,a,l=this.header.getConcreteTree(i,s);if(this.header instanceof e.Identifier&&!s[this.header._symbol]){o=[];for(var c=0;c<this.values.length;c++)if(this.values[c].tableError())o.push(t.invalidTableEntry(this.values[c].tableError()));else{var u=this.values[c].tryGetConcreteTree(i,s);u.isError?o.push(u):u.tableError()?o.push(t.invalidTableEntry(u.tableError())):u.valueType===r.Number?o.push(u):o.push(t.tableEntryTypeError([r.prettyPrint(u.valueType)]))}return(a=new this.constructor(l,this.length,o)).isIndependent=!0,a}if(l.isConstant){for(var h=[],p=0;p<this.length;p++)h.push(l);o=h}else o=l.isList?l.mapElements(function(e){return e}):[];if(l.isError||l.valueType===r.Number||l.valueType===r.ListOfNumber||l.valueType===r.EmptyList||(l=t.tableHeaderTypeError([r.prettyPrint(l.valueType)])),a=new this.constructor(l,this.length,o),void 0!==n){var d=this.header.tryGetConcreteTree(i,n);d.isError||d.valueType!==r.Number||(a.continuousConcreteTree=d)}return a}});\ndefine(\'core/math/ir/scope\',["require","exports"],function(require,e){"use strict";function o(e,o){return{symbolMap:e,maxIndex:o}}Object.defineProperty(e,"__esModule",{value:!0}),e.childScope=e.setSymbol=e.getSymbol=e.Scope=void 0,e.Scope=o,e.getSymbol=function(e,o){return e.symbolMap[o]},e.setSymbol=function(e,o,t){e.symbolMap[o]=t,e.maxIndex=Math.max(e.maxIndex,t)},e.childScope=function(e){return o(Object.create(e.symbolMap),e.maxIndex)}});\ndefine(\'core/math/mathshim\',["require","exports"],function(require,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.sign=n.sqrtxsqm1=n.sqrtxsqp1=n.log1p=n.expm1=n.atanh=n.asinh=n.acosh=n.tanh=n.sinh=n.cosh=void 0;var t=Math;n.cosh=t.cosh||function(n){return.5*(Math.exp(n)+Math.exp(-n))},n.sinh=t.sinh&&0!==t.sinh(1e-20)?t.sinh:function(t){var a=t>0?1:-1;return t=t>0?t:-t,.5*-a*Math.exp(t)*n.expm1(-2*t)},n.tanh=t.tanh&&0!==t.tanh(1e-20)?t.tanh:function(t){var a=t>0?1:-1;t=t>0?t:-t;var r=n.expm1(-2*t);return-a*r/(2+r)},n.acosh=t.acosh||function(t){return t<1?NaN:Math.log(t+n.sqrtxsqm1(t))},n.asinh=t.asinh&&0!==t.asinh(1e-20)?t.asinh:function(t){var a=t>0?1:-1;return 1+(t=t>0?t:-t)*t==1?a*n.log1p(t):a*Math.log(t+n.sqrtxsqp1(t))},n.atanh=t.atanh&&0!==t.atanh(1e-20)?t.atanh:function(t){return.5*(n.log1p(t)-n.log1p(-t))},n.expm1=t.expm1||function(n){return n+.5*n*n===n?n:Math.exp(n)-1},n.log1p=t.log1p||function(n){return n-.5*n*n===n?n:Math.log(1+n)};n.sqrtxsqp1=function(n){var t=n*n;return 1+t===1?1:1+t===t?Math.abs(n):Math.sqrt(t+1)};n.sqrtxsqm1=function(n){var t=n*n;return t<1?NaN:t-1===t?Math.abs(n):Math.sqrt(t-1)},n.sign=t.sign||function(n){return 0===n?0:n>0?1:n<0?-1:NaN}});\ndefine(\'core/math/quadrature\',[\'require\',\'core/math/mathshim\',\'core/math/poi\'],function(require){"use strict";var a=require("core/math/mathshim"),r=require("core/math/poi"),t=r.bisectJump,i=r.bisectFinite,n=Math.pow(2,-13),e=n*n,o=e*e,s=e,u=[],h=[];!function(r,t){for(var i=32;i>0;i--){var n=.09856311095410075*i,e=a.sinh(n),o=a.cosh(Math.PI/2*e),s=1/(Math.exp(Math.PI/2*e)*o),u=a.cosh(n)/(o*o);r.push(s),t.push(u)}}(u,h);for(var N=0,f=0;f<h.length;f++)N+=h[f];var m=1/(1+2*N);function x(a,r,t){return.5*(r*(2-t)+a*t)}function M(a,r,i){var n=.5*(r+i),e=t(r,a(r),n,a(n),i,a(i),a,0);return e?.5*(e[0][0]+e[1][0]):n}function v(a,r,t,i,n){return{x1:a,x2:r,value:t,error:i,minerror:n}}function b(a,r,t){var i=Math.abs(a(x(r,t,e))),n=Math.abs(a(x(r,t,2*e))),o=Math.abs(a(x(r,t,4*e)));return!(i<e||n<e)&&(i>1.95*n&&n>1.95*o)}function c(a,r,t){var n,e,o=x(t,r,u[0]),N=x(r,t,u[0]),f=a(o),M=a(N),c=x(r,t,1),l=a(c);if(isFinite(l)&&!isFinite(f)){if(n=i(o,f,c,l,a),Math.abs((n[0]-r)/(t-r))>s)return v(r,t,NaN,NaN,NaN);r=n[0],f=n[1]}if(isFinite(l)&&!isFinite(M)){if(e=i(c,l,N,M,a),Math.abs((e[0]-t)/(t-r))>s)return v(r,t,NaN,NaN,NaN);t=e[0],M=e[1]}if(isFinite(f)&&isFinite(M)&&!isFinite(l)){if(n=i(o,f,c,l,a),e=i(c,l,N,M,a),Math.abs((e[0]-n[0])/(t-r))>s)return v(r,t,NaN,NaN,NaN);l=.5*(n[1]+e[1])}if(b(a,r,t)||b(a,t,r))return v(r,t,NaN,NaN,NaN);for(var F=l,p=0,d=0,g=0,I=0,P=0,q=0,w=0;w<32;w+=4)P=a(x(r,t,u[w])),q=a(x(t,r,u[w])),I=Math.max(I,Math.abs(P),Math.abs(q)),p+=h[w]*(P+q),P=a(x(r,t,u[w+1])),q=a(x(t,r,u[w+1])),I=Math.max(I,Math.abs(P),Math.abs(q)),g+=h[w+1]*(P+q),P=a(x(r,t,u[w+2])),q=a(x(t,r,u[w+2])),I=Math.max(I,Math.abs(P),Math.abs(q)),d+=h[w+2]*(P+q),P=a(x(r,t,u[w+3])),q=a(x(t,r,u[w+3])),I=Math.max(I,Math.abs(P),Math.abs(q)),g+=h[w+3]*(P+q);var J,j=F+p,k=j+d,y=k+g,z=Math.abs(d-j),A=Math.abs(g-k),B=m*(t-r)*y,C=m*Math.abs(t-r)*I*h[0];return J=0===z?m*Math.abs(t-r)*A:m*Math.abs(t-r)*A*(A/z)*(A/z),v(r,t,B,J=Math.max(J,C),C)}function l(a){for(var r=-1/0,t=-1/0,i=-1,n=0,e=0;e<a.length;e++){var o=a[e];n+=o.value,o.error>r&&(r=o.error,i=e),o.minerror>t&&(t=o.minerror)}return{maxerror:r,maxminerror:t,maxindex:i,totalvalue:n}}return{quad:function a(r,t,i,n){if(void 0===n&&(n=32),isNaN(t)||isNaN(i))return NaN;var e=1;if(t>i){var s=t;t=i,i=s,e=-1}if(t===1/0&&i===1/0)return NaN;if(t===-1/0&&i===-1/0)return NaN;if(t===-1/0&&i===1/0)return e*a(function(a){return r(a/((1+a)*(1-a)))*(1+a*a)/((1+a)*(1+a)*(1-a)*(1-a))},-1,1,n);if(t===-1/0)return e*a(function(a){return-r(i-a/(1-a))/((1-a)*(1-a))},1,0,n);if(i===1/0)return e*a(function(a){return r(t+a/(1-a))/((1-a)*(1-a))},0,1,n);for(var u=[c(r,t,i)],h=l(u),N=1;N<n&&(!(Math.abs(h.maxerror/h.totalvalue)<=32*o||h.maxerror<=32*o||h.maxerror<=32*h.maxminerror)&&isFinite(h.maxerror)&&isFinite(h.maxminerror));N++){var f=u[u.length-1];u[u.length-1]=u[h.maxindex],u[h.maxindex]=f;var m=u.pop(),v=M(r,x(m.x2,m.x1,.125),x(m.x1,m.x2,.125));u.push(c(r,m.x1,v)),u.push(c(r,v,m.x2)),h=l(u)}return isFinite(h.maxerror)&&isFinite(h.maxminerror)?Math.abs(h.totalvalue)<=10*h.maxminerror?0:e*h.totalvalue:NaN}}});\ndefine(\'core/lib/md5\',["require","exports"],function(require,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(n){function r(n,r){var t=(65535&n)+(65535&r);return(n>>16)+(r>>16)+(t>>16)<<16|65535&t}function t(n,t,e,u,o,c){return r((f=r(r(t,n),r(u,c)))<<(i=o)|f>>>32-i,e);var f,i}function e(n,r,e,u,o,c,f){return t(r&e|~r&u,n,r,o,c,f)}function u(n,r,e,u,o,c,f){return t(r&u|e&~u,n,r,o,c,f)}function o(n,r,e,u,o,c,f){return t(r^e^u,n,r,o,c,f)}function c(n,r,e,u,o,c,f){return t(e^(r|~u),n,r,o,c,f)}function f(n,t){var f,i,a,h,l;n[t>>5]|=128<<t%32,n[14+(t+64>>>9<<4)]=t;var v=1732584193,d=-271733879,g=-1732584194,s=271733878;for(f=0;f<n.length;f+=16)i=v,a=d,h=g,l=s,v=e(v,d,g,s,n[f],7,-680876936),s=e(s,v,d,g,n[f+1],12,-389564586),g=e(g,s,v,d,n[f+2],17,606105819),d=e(d,g,s,v,n[f+3],22,-1044525330),v=e(v,d,g,s,n[f+4],7,-176418897),s=e(s,v,d,g,n[f+5],12,1200080426),g=e(g,s,v,d,n[f+6],17,-1473231341),d=e(d,g,s,v,n[f+7],22,-45705983),v=e(v,d,g,s,n[f+8],7,1770035416),s=e(s,v,d,g,n[f+9],12,-1958414417),g=e(g,s,v,d,n[f+10],17,-42063),d=e(d,g,s,v,n[f+11],22,-1990404162),v=e(v,d,g,s,n[f+12],7,1804603682),s=e(s,v,d,g,n[f+13],12,-40341101),g=e(g,s,v,d,n[f+14],17,-1502002290),v=u(v,d=e(d,g,s,v,n[f+15],22,1236535329),g,s,n[f+1],5,-165796510),s=u(s,v,d,g,n[f+6],9,-1069501632),g=u(g,s,v,d,n[f+11],14,643717713),d=u(d,g,s,v,n[f],20,-373897302),v=u(v,d,g,s,n[f+5],5,-701558691),s=u(s,v,d,g,n[f+10],9,38016083),g=u(g,s,v,d,n[f+15],14,-660478335),d=u(d,g,s,v,n[f+4],20,-405537848),v=u(v,d,g,s,n[f+9],5,568446438),s=u(s,v,d,g,n[f+14],9,-1019803690),g=u(g,s,v,d,n[f+3],14,-187363961),d=u(d,g,s,v,n[f+8],20,1163531501),v=u(v,d,g,s,n[f+13],5,-1444681467),s=u(s,v,d,g,n[f+2],9,-51403784),g=u(g,s,v,d,n[f+7],14,1735328473),v=o(v,d=u(d,g,s,v,n[f+12],20,-1926607734),g,s,n[f+5],4,-378558),s=o(s,v,d,g,n[f+8],11,-2022574463),g=o(g,s,v,d,n[f+11],16,1839030562),d=o(d,g,s,v,n[f+14],23,-35309556),v=o(v,d,g,s,n[f+1],4,-1530992060),s=o(s,v,d,g,n[f+4],11,1272893353),g=o(g,s,v,d,n[f+7],16,-155497632),d=o(d,g,s,v,n[f+10],23,-1094730640),v=o(v,d,g,s,n[f+13],4,681279174),s=o(s,v,d,g,n[f],11,-358537222),g=o(g,s,v,d,n[f+3],16,-722521979),d=o(d,g,s,v,n[f+6],23,76029189),v=o(v,d,g,s,n[f+9],4,-640364487),s=o(s,v,d,g,n[f+12],11,-421815835),g=o(g,s,v,d,n[f+15],16,530742520),v=c(v,d=o(d,g,s,v,n[f+2],23,-995338651),g,s,n[f],6,-198630844),s=c(s,v,d,g,n[f+7],10,1126891415),g=c(g,s,v,d,n[f+14],15,-1416354905),d=c(d,g,s,v,n[f+5],21,-57434055),v=c(v,d,g,s,n[f+12],6,1700485571),s=c(s,v,d,g,n[f+3],10,-1894986606),g=c(g,s,v,d,n[f+10],15,-1051523),d=c(d,g,s,v,n[f+1],21,-2054922799),v=c(v,d,g,s,n[f+8],6,1873313359),s=c(s,v,d,g,n[f+15],10,-30611744),g=c(g,s,v,d,n[f+6],15,-1560198380),d=c(d,g,s,v,n[f+13],21,1309151649),v=c(v,d,g,s,n[f+4],6,-145523070),s=c(s,v,d,g,n[f+11],10,-1120210379),g=c(g,s,v,d,n[f+2],15,718787259),d=c(d,g,s,v,n[f+9],21,-343485551),v=r(v,i),d=r(d,a),g=r(g,h),s=r(s,l);return[v,d,g,s]}function i(n){var r,t="",e=32*n.length;for(r=0;r<e;r+=8)t+=String.fromCharCode(n[r>>5]>>>r%32&255);return t}function a(n){var r,t=[];for(t[(n.length>>2)-1]=void 0,r=0;r<t.length;r+=1)t[r]=0;var e=8*n.length;for(r=0;r<e;r+=8)t[r>>5]|=(255&n.charCodeAt(r/8))<<r%32;return t}function h(n){var r,t,e="0123456789abcdef",u="";for(t=0;t<n.length;t+=1)r=n.charCodeAt(t),u+=e.charAt(r>>>4&15)+e.charAt(15&r);return u}function l(n){return unescape(encodeURIComponent(n))}function v(n){return function(n){return i(f(a(n),8*n.length))}(l(n))}function d(n,r){return function(n,r){var t,e,u=a(n),o=[],c=[];for(o[15]=c[15]=void 0,u.length>16&&(u=f(u,8*n.length)),t=0;t<16;t+=1)o[t]=909522486^u[t],c[t]=1549556828^u[t];return e=f(o.concat(a(r)),512+8*r.length),i(f(c.concat(e),640))}(l(n),l(r))}return function(n,r,t){return r?t?d(r,n):h(d(r,n)):t?v(n):h(v(n))}}()});\ndefine(\'core/math/builtin\',["require","exports","core/vendor/d3-color","core/math/quadrature","core/lib/md5","core/math/mathshim","core/math/mathshim","core/math/distance","core/math/distance","core/math/tofraction","core/math/poi","./maybe-rational","./builtin-common"],function(require,t,r,n,e,a,u,o,i,f,h,c,s){"use strict";function l(t,r,n){return Math.max(r,Math.min(n,t))}function M(r,n){r=Math.round(r),n=Math.round(n);var e=t.gcd(r,n);return Math.abs(r/e*n)}function v(t){return p(t+1)}function p(t){if(t<0)return Math.PI/(P(Math.PI*t)*p(1-t));if(t>170)return 1/0;var r,n=Math.round(t)===t;return r=t<15?g(t):t<120?function(t){var r=t-1;return Math.pow(r,r)*Math.exp(T(r)-r)*Math.sqrt(2*Math.PI*r)}(t):Math.exp(d(t)),n?Math.round(r):r}function g(t){var r=1+t*(4.077131788261185+t*(7.024675027156382+t*(6.657107767450176+t*(3.766266976716022+t*(1.2792371666711133+t*(.24304596436338005+.020049769312165774*t)))))),n=1+t*(4.154347453162709+t*(7.270007565107539+t*(6.97805297331391+t*(3.989651532924167+t*(1.367176195613119+t*(.26175627691546965+.021742722739397567*t))))));return Math.E*Math.pow((1+t)/Math.E,1+t)/(t*Math.sqrt(1+t))*(r/n)}function d(t){var r=t-1;return r*(Math.log(r)-1)+.5*Math.log(2*Math.PI*r)+T(r)}function m(t,r){if(t!==Math.floor(t))return NaN;if(t<0)return NaN;if(0===t)return 1/I(r);var n=P(r);if(1===t)return-1/(n*n);var e=w(r);if(2===t)return 2*e/(n*n*n);for(var a=[0,2],u=[],o=3;o<=t;o++){u=[];for(var i=0;i<o;i++){var f=0,h=0;i>0&&(f=(o-i+1)*a[i-1]),i+2<o&&(h=(i+1)*a[i+1]),u.push(-(f+h))}a=u}var c=0;for(i=t-1;i>=0;i--)c=u[i]+e*c;return c/Math.pow(n,t+1)}function N(t,r){return 0===r?NaN:(n=r===Math.E?Math.log(t):2===r&&Math.log2?Math.log2(t):10===r&&Math.log10?Math.log10(t):Math.log(t)/Math.log(r),Math.pow(r,Math.round(n))===t?Math.round(n):n);var n}Object.defineProperty(t,"__esModule",{value:!0}),t.uniquePerm=t.elementsAt=t.select=t.polygon=t.hsv=t.rgb=t.distance=t.quad=t.stdevp=t.stdev=t.spearman=t.rank=t.validateSampleCount=t.validateRangeLength=t.corr=t.cov=t.covp=t.variance=t.mad=t.varp=t.argMax=t.argMin=t.median=t.lowerQuartileIndex=t.upperQuartileIndex=t.lowerQuantileIndex=t.upperQuantileIndex=t.quartileIndex=t.sortPerm=t.quartile=t.quantile=t.listMax=t.listMin=t.length=t.stats=t.ittest=t.ttest=t.itscore=t.tscore=t.invUniform=t.invT=t.invBinom=t.invPoisson=t.invNorm=t.erfcx=t.erf=t.uniformcdf=t.uniformpdf=t.poissoncdf=t.poissonpdf=t.binompdf=t.binomcdf=t.poissonSample=t.binomSample=t.tSample=t.normalSample=t.uniformSample=t.randomPerm=t.shuffle=t.random=t.normalpdf=t.normalcdf=t.tcdf=t.tpdf=t.total=t.mean=t.acoth=t.acsch=t.asech=t.coth=t.csch=t.sech=t.asec=t.acsc=t.acot=t.cot=t.csc=t.sec=t.tan=t.cos=t.sin=t.nthroot=t.common_log=t.log_base=t.log=t.polyGamma=t.cotDerivative=t.bernoulliTable=t.lnGamma=t.gamma=t.factorial=t.nPr=t.nCr=t.listLCM=t.listGCD=t.lcm=t.mod=t.pow=t.gcd=t.toFraction=t.hypot=t.sign=t.sqrtxsqm1=t.sqrtxsqp1=t.log1p=t.expm1=t.atanh=t.asinh=t.acosh=t.tanh=t.sinh=t.cosh=t.md5Spyable=void 0,t.md5Spyable=e.default,Object.defineProperty(t,"cosh",{enumerable:!0,get:function(){return u.cosh}}),Object.defineProperty(t,"sinh",{enumerable:!0,get:function(){return u.sinh}}),Object.defineProperty(t,"tanh",{enumerable:!0,get:function(){return u.tanh}}),Object.defineProperty(t,"acosh",{enumerable:!0,get:function(){return u.acosh}}),Object.defineProperty(t,"asinh",{enumerable:!0,get:function(){return u.asinh}}),Object.defineProperty(t,"atanh",{enumerable:!0,get:function(){return u.atanh}}),Object.defineProperty(t,"expm1",{enumerable:!0,get:function(){return u.expm1}}),Object.defineProperty(t,"log1p",{enumerable:!0,get:function(){return u.log1p}}),Object.defineProperty(t,"sqrtxsqp1",{enumerable:!0,get:function(){return u.sqrtxsqp1}}),Object.defineProperty(t,"sqrtxsqm1",{enumerable:!0,get:function(){return u.sqrtxsqm1}}),Object.defineProperty(t,"sign",{enumerable:!0,get:function(){return u.sign}}),Object.defineProperty(t,"hypot",{enumerable:!0,get:function(){return i.hypot}}),t.toFraction=f.default,t.gcd=s.gcd,t.pow=s.pow,t.mod=function(t,r){var n=t%r;return t*r<0&&0!==n?n+r:n},t.lcm=M,t.listGCD=function(r){if(0===r.length)return NaN;for(var n=r[0],e=1;e<r.length;e++)n=t.gcd(n,r[e]);return n},t.listLCM=function(t){if(0===t.length)return NaN;for(var r=t[0],n=1;n<t.length;n++)r=M(r,t[n]);return r},t.nCr=function(t,r){if(t=Math.round(t),(r=Math.round(r))>t||t<0||r<0)return 0;if(r===1/0||t===1/0)return NaN;r>t-r&&(r=t-r);for(var n=1,e=0;e<r;e++)n*=(t-e)/(e+1);return Math.round(n)},t.nPr=function(t,r){if(t=Math.round(t),(r=Math.round(r))>t||t<0||r<0)return 0;if(r===1/0||t===1/0)return NaN;for(var n=1,e=0;e<r;e++)n*=t-e;return n},t.factorial=v,t.gamma=p,t.lnGamma=function(t){return t<0?NaN:t<15?Math.log(g(t)):d(t)},t.bernoulliTable=[1/6,-1/30,1/42,-1/30,5/66,-691/2730,7/6,-3617/510,43867/798,-174611/330,854513/138,-236364091/2730,8553103/6,-23749461029/870],t.cotDerivative=m,t.polyGamma=function r(n,e){if(n<0)return NaN;if(n!==Math.floor(n))return NaN;var a=n%2==0?-1:1;if(e<0)return-a*r(n,1-e)-Math.pow(Math.PI,n+1)*m(n,Math.PI*e);for(var u=v(n),o=0,i=Math.pow(e,-(n+1));e<10;)o+=i,e++,i=Math.pow(e,-(n+1));o+=0===n?-Math.log(e):i*e/n,o+=.5*i;for(var f=t.bernoulliTable,h=n+1,c=2,s=i*e*h/c,l=1/(e*e),M=1;M<=14;M++)o+=(s*=l)*f[M-1],s*=++h/++c,s*=++h/++c;return u*a*o},t.log=function(t){var r=Math.log(t);return Math.exp(Math.round(r))===t?Math.round(r):r},t.log_base=N,t.common_log=function(t){return N(t,10)},t.nthroot=function(r,n){return t.pow(r,1/n)};var b=1/Math.PI;function q(t){return!(t>1e12)&&Math.round(b*t)*Math.PI===t}function x(t){if(t>1e12)return!1;var r=Math.round(2*b*t);return r%2==1&&r*Math.PI==2*t}function P(t){return q(Math.abs(t))?0:Math.sin(t)}function w(t){return x(Math.abs(t))?0:Math.cos(t)}function I(t){var r=Math.abs(t);return q(r)?0:x(r)?1/0:Math.tan(t)}function y(t){for(var r=0,n=0;n<t.length;n++)r+=t[n];return r/t.length}function S(t){return t>50?Math.exp(.5*((1-t)*a.log1p(-1/(t-1))-1)+O(.5*(t-1))-O(.5*(t-2)))*Math.sqrt((1-1/t)/(2*Math.PI)):p((t+1)/2)/(p(t/2)*Math.sqrt(t*Math.PI))}function j(t,r,n){if(void 0===n&&(n=t-r),Math.abs(n)<.1*(t+r))for(var e=n/(t+r),a=n*n/(t+r),u=2*t*e,o=1;o<10;o++){var i=a+(u*=e*e)/(2*o+1);if(i==a)return i;a=i}return t*Math.log(t/r)+r-t}t.sin=P,t.cos=w,t.tan=I,t.sec=function(t){return x(Math.abs(t))?1/0:1/Math.cos(t)},t.csc=function(t){return q(Math.abs(t))?1/0:1/Math.sin(t)},t.cot=function(t){var r=Math.abs(t);return q(r)?1/0:x(r)?0:1/Math.tan(t)},t.acot=function(t){return Math.PI/2-Math.atan(t)},t.acsc=function(t){return Math.asin(1/t)},t.asec=function(t){return Math.acos(1/t)},t.sech=function(t){return 1/a.cosh(t)},t.csch=function(t){return 1/a.sinh(t)},t.coth=function(t){return 1/a.tanh(t)},t.asech=function(t){return a.acosh(1/t)},t.acsch=function(t){return a.asinh(1/t)},t.acoth=function(t){return a.atanh(1/t)},t.mean=y,t.total=function(t){for(var r=0,n=0;n<t.length;n++)r+=t[n];return r};var F=[0,.08106146679532726,.0413406959554093,.02767792568499834,.020790672103765093,.016644691189821193,.013876128823070748,.01189670994589177,.010411265261972096,.009255462182712733,.00833056343336287,.007573675487951841,.00694284010720953,.006408994188004207,.0059513701127588475,.005554733551962801];function O(t){return t>15?T(t):t<0?NaN:t===Math.floor(t)?F[t]:Math.log(v(t)/(Math.pow(t,t)*Math.exp(-t)*Math.sqrt(2*Math.PI*t)))}function T(t){var r=t*t;return(.08333333333333333-(.002777777777777778-(.0007936507936507937-(.0005952380952380953-.0008417508417508417/r)/r)/r)/r)/t}function Q(t,r){return r<=0?NaN:S(r)*Math.pow(1+t*t/r,-(r+1)/2)}function C(t,r){if(r>0)return 1-C(t,-r);if(r===-1/0)return 0;if(0===r)return.5;if(t>=40&&r>-1)return.5+S(t)*function(t,r){for(var n=r*r/t,e=r,a=e,u=1;u<=15;u++)a+=e*=-(2*u-1)/(2*u+1)*(.5*(t+1)+u-1)/u*n;return a}(t,r);if(r/t<-1e3){var n=r*r;return S(t)*Math.pow(t,.5*(t-1))*Math.pow(Math.abs(r),-t)*(1-t*t*(t+1)*(1/(2+t)+t*(t+3)/(4*(4+t)*n))/(2*n))}var e=Math.sqrt(r*r+t);return function(t,r,n){if(t<0||t>1)throw new RangeError("First argument must be between 0 and 1.");if(1===r&&1===n)return t;if(0===t)return 0;if(1===t)return 1;if(0===r)return 1;if(0===n)return 0;var e=O(r+n)-O(r)-O(n)-j(r,(r+n)*t)-j(n,(r+n)*(1-t),(r+n)*t-r),a=Math.exp(e)*Math.sqrt(r*n/(2*Math.PI*(r+n)));return t<(r+1)/(r+n+2)?a*R(t,r,n)/r:1-a*R(1-t,n,r)/n}((r+e)/(2*e),t/2,t/2)}function E(t,r,n){return n<=0?NaN:t===-1/0?C(n,r):t>0&&r>0?C(n,-t)-C(n,-r):C(n,r)-C(n,t)}function R(t,r,n){var e=Math.pow(2,-52),a=1e-300,u=r+n,o=r+1,i=r-1,f=1,h=1-u*t/o;Math.abs(h)<a&&(h=a);for(var c=h=1/h,s=1;s<=100;s++){var l=2*s,M=s*(n-s)*t/((i+l)*(r+l));h=1+M*h,Math.abs(h)<a&&(h=a),f=1+M/f,Math.abs(f)<a&&(f=a),c*=(h=1/h)*f,h=1+(M=-(r+s)*(u+s)*t/((r+l)*(o+l)))*h,Math.abs(h)<a&&(h=a),f=1+M/f,Math.abs(f)<a&&(f=a);var v=(h=1/h)*f;if(c*=v,Math.abs(v-1)<=e)return c}return c}function _(t,r,n){return(t-r)/(Math.SQRT2*Math.abs(n))}function G(t){return t<0?.5*Math.exp(-t*t)*K(-t):1-.5*Math.exp(-t*t)*K(t)}function A(r){var n=t.md5Spyable(r);return(4294967296*(2097151&parseInt(n.slice(0,8),16))+parseInt(n.slice(8,16),16))/9007199254740992}function D(t,r){for(var n=r.length-1;n>0;n--){var e=t+"::sc"+n,a=Math.floor(A(e)*(n+1)),u=r[n];r[n]=r[a],r[a]=u}}function L(t,r,n){return A(t)*(n-r)+r}function k(t,r,n){return t>=r?1:t<0?0:t<Math.floor((r+1)*n)?B(t,r,n):1-B(r-t-1,r,1-n)}function B(t,r,n){for(var e=(1-n)/n,a=U(t,r,n),u=a;t>0&&u+(a*=t/(r-t+1)*e)!==u;t--)u+=a;return u}function U(t,r,n){if(t=Math.round(t),(r=l(Math.round(r),0,1/0))===1/0)return NaN;if(n=l(n,0,1),t<0||t>r)return 0;if(0===n)return 0===t?1:0;if(1===n)return t===r?1:0;if(0===t)return Math.exp(r*a.log1p(-n));if(t===r)return Math.pow(n,r);var e=O(r)-O(t)-O(r-t)-j(t,r*n)-j(r-t,r*(1-n),r*n-t);return Math.exp(e)*Math.sqrt(r/(2*Math.PI*t*(r-t)))}function z(t,r){return r<0?NaN:(t=Math.round(t))<0?0:0===r?0===t?1:0:0===t?Math.exp(-r):Math.exp(-O(t)-j(t,r))/Math.sqrt(2*Math.PI*t)}function H(t,r){if(isNaN(t)||isNaN(r))return NaN;if(t===1/0)return 1;if((t=Math.floor(t))<0)return 0;if(0===r)return 1;if(t+1>12&&2.35*(t+1)>r&&.3*(t+1)<r)return function(t,r){for(var n=r/t,e=a.sign(r-t)*Math.sqrt(2*j(1,n)),u=[1,-.3333333333333333,.08333333333333333,-.014814814814814815,.0011574074074074073,.0003527336860670194,-.0001787551440329218,3919263178522438e-20,-2185448510679992e-21,-185406221071516e-20,8.296711340953087e-7,-1.7665952736826078e-7,6.707853543401498e-9,1.0261809784240309e-8,-4.382036018453353e-9,9.14769958223679e-10,-25514193994946248e-27,-5830772132550426e-26,24361948020667415e-27,-50276692801141755e-28,11004392031956135e-29,3371763262400985e-28,-1392388722418162e-28,28534893807047445e-30,-5139111834242572e-31,-19752288294349442e-31,8099521156704561e-31],o=u.length-2,i=0,f=0,h=0,c=0;o>=0;o--)c=e*c+(h=(o+2)*i/t+u[o+1]),i=f,f=h;if(c*=t/(t+i),r<t){var s=Math.exp(-.5*t*e*e)*(.5*K(-e*Math.sqrt(t/2))-c/Math.sqrt(2*Math.PI*t));return isFinite(s)?1-s:1}var l=Math.exp(-.5*t*e*e)*(.5*K(e*Math.sqrt(t/2))+c/Math.sqrt(2*Math.PI*t));return isFinite(l)?l:0}(t+1,r);if(t+1>=r){var n=function(t,r){var n=Math.pow(2,-52),e=1e-300,a=1/t,u=1/e,o=1/t,i=2,f=0,h=t,c=-(t-1),s=0;do{0===(o=o*(c-=1)*r+(h+=1))&&(o=e),0===(u=h+c*r/u)&&(u=e),a*=f=u*(o=1/o),0===(o=o*(s+=1)*r+(h+=1))&&(o=e),0===(u=h+s*r/u)&&(u=e),a*=f=u*(o=1/o),i+=2}while(i<100&&Math.abs(f-1)>n);return a}(t+1,r);return isFinite(n)?1-r*z(t,r)*n:1}n=function(t,r){var n=Math.pow(2,-52),e=1e-300,a=r+1-t,u=1/a,o=1/e,i=1/a,f=2,h=0,c=a;do{var s=-(f-1)*(f-t-1);0===(i=i*s+(c+=2))&&(i=e),0===(o=c+s/o)&&(o=e),u*=h=o*(i=1/i),f+=1}while(f<100&&Math.abs(h-1)>n);return u}(t+1,r);return isFinite(n)?r*z(t,r)*n:0}function J(t,r,n){return n<=r?NaN:t<r?0:t>n?1:(t-r)/(n-r)}function K(t){if(t<0)return t<-6.1?2*Math.exp(t*t):2*Math.exp(t*t)-K(-t);if(t>50){var r=.5641895835477563,n=t*t;return t>5e7?r/t:r*(n*(n+4.5)+2)/(t*(n*(n+5)+3.75))}return(.9999999999999999+t*(2.224574423459406+t*(2.444115549920689+t*(1.7057986861852539+t*(.8257463703357973+t*(.28647031042892007+t*(.07124513844341643+t*(.012296749268608364+t*(.001347817214557592+7263959403471071e-20*t)))))))))/(1+t*(3.352953590554884+t*(5.227518529742423+t*(5.003720878235473+t*(3.266590890998987+t*(1.5255421920765353+t*(.5185887413188858+t*(.12747319185915415+t*(.02185979575963238+t*(.0023889438122503674+.00012875032817508128*t))))))))))}function V(t){var r,n,e;return t>.5?-V(1-t):.5===t?0:t<0?NaN:0===t?-1/0:(e=t<.02425?(((((-.00778489400243029*(r=Math.sqrt(-2*Math.log(t)))-.322396458041136)*r-2.40075827716184)*r-2.54973253934373)*r+4.37466414146497)*r+2.93816398269878)/((((.00778469570904146*r+.32246712907004)*r+2.445134137143)*r+3.75440866190742)*r+1):(((((-39.6968302866538*(n=(r=t-.5)*r)+220.946098424521)*n-275.928510446969)*n+138.357751867269)*n-30.6647980661472)*n+2.50662827745924)*r/(((((-54.4760987982241*n+161.585836858041)*n-155.698979859887)*n+66.8013118877197)*n-13.2806815528857)*n+1))-Math.sqrt(2*Math.PI)*(.5*K(-e/Math.SQRT2)-Math.exp(.5*e*e)*t)}function W(t,r){if(r<=0||t<0||t>1)return NaN;if(0===t)return 0;if(1===t)return 1/0;for(var n=1,e=1,a=1;Math.exp(-r)*e<t;){if(e+(n*=r/a)===e)return 1/0;e+=n,a+=1}return a-1}function X(t,r,n){if(r!==Math.round(r))return NaN;if(n<0||n>1)return NaN;if(t<0||t>1)return NaN;if(0===t)return 0;if(1===t)return r;if(0===r)return 0;if(1===n)return r;if(0===n)return 0;for(var e=n/(1-n),a=Math.pow(1-n,r),u=a,o=1;u<t;){if(u+(a*=(r-o+1)/o*e)===u)return r;if(o>r)return r;u+=a,o+=1}return o-1}function Y(t,r){var n=4*r*(1-r);switch(t){case 1:return Math.tan(Math.PI*(r-.5));case 2:return 2*(r-.5)*Math.sqrt(2/n);case 4:var e=Math.cos(Math.acos(Math.sqrt(n))/3)/Math.sqrt(n);return 2*a.sign(r-.5)*Math.sqrt(e-1);default:throw new Error("_invTSimple() must be called with 1, 2, or 4 df.")}}function Z(t,r){var n=Mt(t);return(y(t)-r)*Math.sqrt(t.length)/n}function $(t,r){var n=t.length,e=y(t),a=Mt(t),u=r.length,o=y(r),i=Mt(r);return(e-o)/(Math.sqrt(((n-1)*a*a+(u-1)*i*i)/(n+u-2))*Math.sqrt(1/n+1/u))}function tt(t,r,n){return n<0?E(-1/0,t,r):n>0?E(-1/0,-t,r):2*E(-1/0,-Math.abs(t),r)}function rt(t){if(t.length<1)return NaN;var r=t[0];if(isNaN(r))return NaN;for(var n=1;n<t.length;n++){if(isNaN(t[n]))return NaN;t[n]<r&&(r=t[n])}return r}function nt(t){if(t.length<1)return NaN;var r=t[0];if(isNaN(r))return NaN;for(var n=1;n<t.length;n++){if(isNaN(t[n]))return NaN;t[n]>=r&&(r=t[n])}return r}function et(t,r){if(!isFinite(r)||r<0||r>1)return NaN;if(t.some(isNaN))return NaN;if(0===t.length)return NaN;var n=t.length,e=ut(t),a=r*(n-1);return Math.floor(a)===a?t[e[a]]:(Math.ceil(a)-a)*t[e[Math.floor(a)]]+(a-Math.floor(a))*t[e[Math.ceil(a)]]}function at(t,r){if(!isFinite(r)||r<0||r>4)return NaN;if(t.some(isNaN))return NaN;var n=ut(t),e=ot(t,r),a=Math.floor(e),u=Math.ceil(e);return(t[n[a]]+t[n[u]])/2}function ut(t){for(var r=t.length,n=[],e=0;e<r;e++)n.push(e);return n.sort(function(r,n){return c.asFloat(c.sub(t[r],t[n]))}),n}function ot(t,r){r=Math.round(r);var n,e=t.length,a=e%2==1;return 1===e?0:(0===r&&(n=0),2===r&&(n=(e-1)/2),4===r&&(n=e-1),1===r&&(n=a?(e+1)/4-1:(e+2)/4-1),3===r&&(n=a?(3*e+3)/4-1:(3*e+2)/4-1),void 0===n?NaN:n)}function it(t){return et(t,.5)}function ft(t){for(var r=y(t),n=0,e=0;e<t.length;e++){var a=t[e]-r;n+=a*a}return n/t.length}function ht(t){var r=t.length;return ft(t)*r/(r-1)}function ct(t,r){var n=Math.min(t.length,r.length);t.length!==n&&(t=t.slice(0,n)),r.length!==n&&(r=r.slice(0,n));for(var e=y(t),a=y(r),u=0,o=0;o<n;o++)u+=(t[o]-e)*(r[o]-a);return u/n}function st(t,r){var n=Math.min(t.length,r.length);t.length!==n&&(t=t.slice(0,n)),r.length!==n&&(r=r.slice(0,n));for(var e=y(t),a=y(r),u=0,o=0,i=0,f=0;f<n;f++){var h=t[f]-e,c=r[f]-a;u+=h*h,o+=c*c,i+=h*c}return i/Math.sqrt(u*o)}function lt(t){var r=t.length;if(0===r)return[];for(var n=[],e=[],a=0;a<r;a++)e.push([t[a],a]);e.sort(function(t,r){var n=t[0],e=r[0];return n===1/0&&e===1/0||n===-1/0&&e===-1/0?0:n-e});for(var u=0,o=1,i=1;u<r;){for(var f=u;f<r-1&&e[f][0]===e[f+1][0];)f+=1;i=f-u+1;var h=void 0;for(f=0;f<i;f++)n[h=e[u+f][1]]=isNaN(t[h])?NaN:o+.5*(i-1);o+=i,u+=i}return n}function Mt(t){return Math.sqrt(ht(t))}function vt(t,r,n){return[l(Math.round(t),0,255),l(Math.round(r),0,255),l(Math.round(n),0,255)]}function pt(t){if(Array.isArray(t))return"["+t.map(pt).join(",")+"]";switch(typeof t){case"string":return t;case"boolean":case"number":return t.toString();case"object":if("object"==typeof(e=t)&&e&&"Action"===e.type){var r=[];for(var n in t.updateRules)r.push(\'"\'+n+\'": \'+pt(t.updateRules[n].value));return"{"+r.join(",")+"}"}return t.n+"/"+t.d;default:return t}var e}t.tpdf=Q,t.tcdf=E,t.normalcdf=function(t,r,n,e){var a=_(r,n,e);if(t===-1/0)return G(a);var u=_(t,n,e);return t>0&&r>0?G(-u)-G(-a):G(a)-G(u)},t.normalpdf=function(t,r,n){return 1/Math.sqrt(2*Math.PI*n*n)*Math.exp(-(t-r)*(t-r)/(2*n*n))},t.random=A,t.shuffle=function(t,r){var n=r.slice();return D(t,n),n},t.randomPerm=function(t,r){for(var n=[],e=0;e<r;e++)n.push(e);return D(t,n),n},t.uniformSample=L,t.normalSample=function(t,r,n){var e,a,u,o,i=0;do{e=t+"::sc"+i,i+=1,a=2*L(e,0,1)-1,e=t+"::sc"+i,i+=1,o=a*a+(u=2*L(e,0,1)-1)*u}while(o>=1||0===o);return r+n*a*Math.sqrt(-2*Math.log(o)/o)},t.tSample=function(t,r){if(r<=0)return NaN;var n,e,a,u,o=0;do{n=t+"::sc"+o,o+=1,e=2*L(n,0,1)-1,n=t+"::sc"+o,o+=1,u=e*e+(a=2*L(n,0,1)-1)*a}while(u>1);var i=e*e/u,f=r*(Math.pow(u,-2/r)-1);return n=t+"::sc"+o,o+=1,(L(n,0,1)<.5?-1:1)*Math.sqrt(i*f)},t.binomSample=function(t,r,n){return(r=l(Math.round(r),0,1/0))===1/0?NaN:(n=l(n,0,1),X(L(t,0,1),r,n))},t.poissonSample=function(t,r){return r<=0?NaN:W(L(t,0,1),r)},t.binomcdf=function(t,r,n,e){return(n=l(Math.round(n),0,1/0))===1/0?NaN:(e=l(e,0,1),r<0?0:(t=Math.ceil(t),r=Math.floor(r),t===-1/0?k(r,n,e):k(r,n,e)-k(t-1,n,e)))},t.binompdf=U,t.poissonpdf=z,t.poissoncdf=function(t,r,n){return n<=0?NaN:(t=Math.ceil(t),(r=Math.floor(r))<0?0:t===-1/0?H(r,n):H(r,n)-H(t-1,n))},t.uniformpdf=function(t,r,n){return n<=r?NaN:t<r||t>n?0:1/(n-r)},t.uniformcdf=function(t,r,n,e){return J(r,n,e)-J(t,n,e)},t.erf=function(t){var r=-t*t;return r<-750?t>=0?1:-1:t>=.065?1-Math.exp(r)*K(t):t<=-.065?Math.exp(r)*K(-t)-1:t*(1.1283791670955126+r*(.37612638903183754+r*(.11283791670955126+r*(.026866170645131252+.005223977625442188*r))))},t.erfcx=K,t.invNorm=V,t.invPoisson=W,t.invBinom=X,t.invT=function t(r,n){return isNaN(n)||n<=0||r<0||r>1?NaN:0===r?-1/0:1===r?1/0:1===n||2===n||4===n?Y(n,r):.5===r?0:r>.5?function(t,r,n,e){if(!isFinite(n)||!isFinite(e))return NaN;var a=n,u=e;for(;;){var o=h.floatMiddle(a,u),i=C(t,o);if(o===a||o===u)return i>r?a:u;i<r?a=o:u=o}}(n,r,n>1?V(r):Y(1,r),n>1?Y(1,r):Math.pow(Q(0,n)*Math.pow(n,(n-1)/2)/(1-r),1/n)):-t(1-r,n)},t.invUniform=function(t,r,n){return t<0||t>1||n<=r?NaN:0===t?r:1===t?n:r+t*(n-r)},t.tscore=Z,t.itscore=$,t.ttest=function(t,r){1===arguments.length&&(r=0);var n=Z(t,r),e=t.length-1;return{lessThan:tt(n,e,-1),greaterThan:tt(n,e,1),notEqual:tt(n,e,0)}},t.ittest=function(t,r){var n=$(t,r),e=t.length+r.length-2;return{lessThan:tt(n,e,-1),greaterThan:tt(n,e,1),notEqual:tt(n,e,0)}},t.stats=function(t){return{min:rt(t),q1:at(t,1),median:it(t),q3:at(t,3),max:nt(t)}},t.length=function(t){return t.length},t.listMin=rt,t.listMax=nt,t.quantile=et,t.quartile=at,t.sortPerm=ut,t.quartileIndex=ot,t.upperQuantileIndex=function(t,r){return ut(t)[Math.ceil(r*(t.length-1))]+1},t.lowerQuantileIndex=function(t,r){return ut(t)[Math.floor(r*(t.length-1))]+1},t.upperQuartileIndex=function(t,r){return ut(t)[Math.ceil(ot(t,r))]+1},t.lowerQuartileIndex=function(t,r){return ut(t)[Math.floor(ot(t,r))]+1},t.median=it,t.argMin=function(t){if(t.length<1)return 0;var r=t[0];if(isNaN(r))return 0;for(var n=0,e=1;e<t.length;e++){if(isNaN(t[e]))return 0;t[e]<r&&(n=e,r=t[e])}return n+1},t.argMax=function(t){if(t.length<1)return 0;var r=t[0];if(isNaN(r))return 0;for(var n=0,e=1;e<t.length;e++)if(t[e]>=r){if(isNaN(t[e]))return 0;n=e,r=t[e]}return n+1},t.varp=ft,t.mad=function(t){for(var r=y(t),n=0,e=0;e<t.length;e++)n+=Math.abs(t[e]-r);return n/t.length},t.variance=ht,t.covp=ct,t.cov=function(t,r){var n=Math.min(t.length,r.length);return ct(t,r)*n/(n-1)},t.corr=st,t.validateRangeLength=function(t,r,n,e){for(var a=t[0],u=2;u<t.length;u++){var i=c.asFloat(c.div(c.sub(t[u],a),n));if(!o.approx(i,u,10))return 0}var f=c.asFloat(e);for(u=0;u<r.length-1;u++){i=c.asFloat(c.div(c.sub(r[u],a),n));if(!o.approx(i,f-r.length+u,10))return 0}return!isFinite(f)||f<t.length||f<r.length?0:f},t.validateSampleCount=function(t){return t<0||!isFinite(t)?0:t},t.rank=lt,t.spearman=function(t,r){var n=Math.min(t.length,r.length);return t.length!==n&&(t=t.slice(0,n)),r.length!==n&&(r=r.slice(0,n)),st(lt(t),lt(r))},t.stdev=Mt,t.stdevp=function(t){return Math.sqrt(ft(t))},t.quad=n.quad,t.distance=function(t,r){return o.hypot(r[0]-t[0],r[1]-t[1])},t.rgb=vt,t.hsv=function(t,n,e){t=l(t,0,360),n=l(n,0,1);var a=(e=l(e,0,1))*(1-n/2);n=0===a||1===a?0:(e-a)/Math.min(a,1-a);var u=r.hsl(t,n,a).rgb();return vt(u.r,u.g,u.b)},t.polygon=function(t){return t},t.select=function(t,r){for(var n=[],e=0;e<t.length;e++)r[e]&&n.push(t[e]);return n},t.elementsAt=function(t,r){for(var n=[],e=0,a=r;e<a.length;e++){var u=a[e];n.push(t[u])}return n},t.uniquePerm=function(t){for(var r=[],n={},e=0;e<t.length;e++){var a=pt(t[e]);n.hasOwnProperty(a)||(n[a]=!0,r.push(e))}return r}});\ndefine(\'core/math/functions\',["require","exports","core/math/builtin"],function(require,e,t){"use strict";function n(e){delete e.fn}function r(e){e.fn=i(e.args,e.source,e.constants)}function i(e,n,r){var i=e.join(",");return new Function("BuiltIn","_C","return (function("+i+\'){"use strict"; \'+n+"})")(t,r)}Object.defineProperty(e,"__esModule",{value:!0}),e.closureFunctionWithBuiltIn=e.rehydrateCompiledFunction=e.dehydrateCompiledFunction=e.rehydrateGraphData=e.dehydrateGraphData=void 0,e.dehydrateGraphData=function(e){for(var t=0,r=e;t<r.length;t++){var i=r[t].compiled;i&&n(i)}},e.rehydrateGraphData=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t].compiled;i&&r(i)}},e.dehydrateCompiledFunction=n,e.rehydrateCompiledFunction=r,e.closureFunctionWithBuiltIn=i});\ndefine(\'core/math/ir/instructions\',["require","exports","./opcodes"],function(require,e,n){"use strict";function t(e){return e.type<=n.MAX_LEAF_OPCODE}Object.defineProperty(e,"__esModule",{value:!0}),e.endsBlock=e.beginsBlock=e.isInternalInstruction=e.isLeafInstruction=void 0,e.isLeafInstruction=t,e.isInternalInstruction=function(e){return!t(e)},e.beginsBlock=function(e){switch(e.type){case n.BeginIntegral:case n.BeginBroadcast:case n.BeginLoop:return!0;default:return!1}},e.endsBlock=function(e){switch(e.type){case n.EndLoop:case n.EndIntegral:case n.EndBroadcast:return!0;default:return!1}}});\ndefine(\'core/math/ir/features/print\',["require","exports","../instructions","../opcodes","core/math/types","../../context-types"],function(require,e,r,t,n,s){"use strict";function a(e,r){var s=e.getInstruction(r);switch(s.type===t.Noop&&s.removedInstructionForDebuggingOnly&&(s=s.removedInstructionForDebuggingOnly),s.type){case t.Noop:return c(s.type);case t.LoadArg:return c(s.type)+" "+n.repr(s.valueType)+" "+e.argNames[r];case t.SymbolicVar:return c(s.type)+" "+n.repr(s.valueType);case t.Constant:return c(s.type)+" "+n.repr(s.valueType)+" "+o(s.value);case t.NativeFunction:case t.Distribution:return c(s.type)+" "+n.repr(s.valueType)+" "+s.symbol+" "+s.args.join(" ");case t.ExtendSeed:return c(s.type)+" "+n.repr(s.valueType)+" "+s.tag+" "+s.args.join(" ");case t.BroadcastResult:return c(s.type)+" "+n.repr(s.valueType)+" "+s.args.join(" ")+(s.isConstantBroadcast?" (constant)":"");case t.Add:case t.Subtract:case t.Multiply:case t.Divide:case t.RawExponent:case t.Exponent:case t.Negative:case t.OrderedPair:case t.OrderedPairAccess:case t.BeginLoop:case t.EndLoop:case t.BeginIntegral:case t.EndIntegral:case t.BeginBroadcast:case t.EndBroadcast:case t.Equal:case t.Less:case t.Greater:case t.LessEqual:case t.GreaterEqual:case t.And:case t.Piecewise:case t.List:case t.ListAccess:case t.DeferredListAccess:case t.InboundsListAccess:case t.BlockVar:case t.Action:return c(s.type)+" "+n.repr(s.valueType)+" "+s.args.join(" ");default:throw new Error("Unexpected opcode "+s.type)}}function c(e){switch(e){case t.Noop:return"Noop";case t.Constant:return"Constant";case t.Add:return"Add";case t.Subtract:return"Subtract";case t.Multiply:return"Multiply";case t.Divide:return"Divide";case t.Exponent:return"Exponent";case t.RawExponent:return"RawExponent";case t.Negative:return"Negative";case t.OrderedPair:return"OrderedPair";case t.OrderedPairAccess:return"OrderedPairAccess";case t.BeginLoop:return"BeginLoop";case t.EndLoop:return"EndLoop";case t.BeginIntegral:return"BeginIntegral";case t.EndIntegral:return"EndIntegral";case t.BeginBroadcast:return"BeginBroadcast";case t.EndBroadcast:return"EndBroadcast";case t.Equal:return"Equal";case t.Less:return"Less";case t.Greater:return"Greater";case t.LessEqual:return"LessEqual";case t.GreaterEqual:return"GreaterEqual";case t.And:return"And";case t.Piecewise:return"Piecewise";case t.List:return"List";case t.ListAccess:return"ListAccess";case t.DeferredListAccess:return"DeferredListAccess";case t.InboundsListAccess:return"InboundsListAccess";case t.NativeFunction:return"NativeFunction";case t.Distribution:return"Distribution";case t.LoadArg:return"LoadArg";case t.BlockVar:return"BlockVar";case t.BroadcastResult:return"BroadcastResult";case t.SymbolicVar:return"SymbolicVar";case t.ExtendSeed:return"ExtendSeed";case t.Action:return"Action";default:throw new Error("Unexpected opcode "+e.type)}}function o(e){if(Array.isArray(e))return"["+e.map(o).join(",")+"]";switch(typeof e){case"string":return e;case"boolean":case"number":return e.toString();case"object":if(s.isActionCompilerValue(e)){var r=[];for(var t in e.updateRules)r.push(\'"\'+t+\'": \'+o(e.updateRules[t].value));return"{"+r.join(", ")+"}"}return e.n+"/"+e.d;default:throw new Error("Unexpected value: "+e)}}function i(e,r){var t=e.toString();return u(r-t.length)+t}function u(e){for(var r="",t=0;t<e;t++)r+=" ";return r}Object.defineProperty(e,"__esModule",{value:!0}),e.printValue=e.printOp=e.printInstruction=e.print=void 0,e.print=function(e){for(var n="",s=(e.instructionsLength()-1).toString().length,c=0,o=!1,d=0;d<e.instructionsLength();d++){var p=e.getInstruction(d),l=e.comments[d]||"",g=p.type===t.Noop&&p.removedInstructionForDebuggingOnly;if((r.endsBlock(p)||g&&r.endsBlock(g))&&(c-=1),p.type!==t.Noop||g){o=!1;var y=g?" [X]":"    ";n+=i(d,s)+":"+y+" "+u(2*c)+a(e,d)+(l?"\\t\\t# "+l:"")+"\\n"}else o||(n+=i(d,s)+": "+u(2*c)+"...\\n"),o=!0;(r.beginsBlock(p)||g&&r.beginsBlock(g))&&(c+=1)}return n},e.printInstruction=a,e.printOp=c,e.printValue=o});\ndefine(\'core/math/ir/features/is-constant\',["require","exports","../opcodes","./print"],function(require,t,n,s){"use strict";function o(t){return t.type===n.Constant}function r(t){return t.type===n.BroadcastResult&&t.isConstantBroadcast}Object.defineProperty(t,"__esModule",{value:!0}),t.isConstantOrConstantBroadcast=t.isConstantBroadcast=t.assertConstant=t.isConstant=void 0,t.isConstant=o,t.assertConstant=function(t){if(!o(t))throw new Error("Programming error: expected constant instruction but found "+s.printOp(t.type)+" instead.")},t.isConstantBroadcast=r,t.isConstantOrConstantBroadcast=function(t){return o(t)||r(t)}});\ndefine(\'core/math/ir/features/depends-on-outer-variable\',["require","exports","../instructions","./is-constant"],function(require,t,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dependsOnOuterVariable=void 0,t.dependsOnOuterVariable=function(t,e,s){var i=t.getInstruction(s);if(!n.isLeafInstruction(i))for(var a=0,o=i.args;a<o.length;a++){var u=o[a];if(!r.isConstantOrConstantBroadcast(t.getInstruction(u)))return!0}if(e<s)return!r.isConstantOrConstantBroadcast(t.getInstruction(e));for(var f=[!0],c=s+1;c<=e;c++)f.push(!1);for(var d=[e];d.length;){if(!f[(c=d.pop())-s]){f[c-s]=!0;var g=t.getInstruction(c);if(!n.isLeafInstruction(g))for(var v=0,l=g.args;v<l.length;v++){if((u=l[v])<s){if(!r.isConstantOrConstantBroadcast(t.getInstruction(u)))return!0}else f[u-s]||d.push(u)}}}return!1}});\ndefine(\'core/math/ir/features/reconstitute-ir\',["require","exports","core/math/types"],function(require,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.reconstituteIR=void 0,e.reconstituteIR=function e(r,n,o){if(t.isList(n)){for(var s=[],i=0;i<o.length;i++)s.push(e(r,t.elementType(n),o[i]));return r.ConstantOfType(n,s)}switch(n){case t.Number:return r.Constant(o);case t.Bool:case t.Point:case t.RGBColor:return r.ConstantOfType(n,o);default:throw new Error("Cannot reconstitute value of a "+t.prettyPrint(n)+".")}}});\ndefine(\'core/math/ir/features/list-length\',["require","exports","../opcodes","core/math/types","./print"],function(require,t,n,e,r){"use strict";function s(t,n){var e=i(t,n);if(!(e<0))return e}function i(t,s,a){var o,u=a&&a[s];if(u)return u;var c,g=t.getInstruction(s);switch(g.type){case n.List:c=g.args.length;break;case n.Constant:c=g.value.length;break;case n.BroadcastResult:c=null!==(o=g.constantLength)&&void 0!==o?o:-1}return void 0===c&&(c=function(t,s,a){switch(s.type){case n.Piecewise:var o=i(t,s.args[1],a);return o===i(t,s.args[2],a)?o:-1;case n.NativeFunction:switch(s.symbol){case"elementsAt":return i(t,s.args[1],a);case"sortPerm":return i(t,s.args[0],a);case"shuffle":return i(t,s.args[1],a);default:return-1}default:if(e.isList(s.valueType))return-1;throw new Error("Programming Error: cannot find the list length of "+r.printOp(s.type)+" "+e.prettyPrint(s.valueType)+".")}}(t,g,a=a||{})),a&&(a[s]=c),c}function a(t,r){var s=t.getInstruction(r);if(!e.isList(s.valueType))throw new Error("Programming Error: cannot find the list length of "+t.printInstruction(r));switch(s.type){case n.List:return t.Constant(s.args.length);case n.Constant:return t.Constant(s.value.length);case n.BroadcastResult:var i=t.getInstruction(s.args[0]);return t.getInstruction(i.args[0]).args[0];case n.NativeFunction:switch(s.symbol){case"elementsAt":return a(t,s.args[1]);case"sortPerm":return a(t,s.args[0]);case"shuffle":return a(t,s.args[1])}}return t.SyntheticNativeFunction("length",[r])}Object.defineProperty(t,"__esModule",{value:!0}),t.minListLengthIndex=t.listLengthIndex=t.getConstantListLength=t.assertConstantListLength=void 0,t.assertConstantListLength=function(t,n,e){var i=s(t,n);if(void 0===i)throw new Error(e+\'\\nNon-constant instruction: "\'+r.printInstruction(t,a(t,n))+\'"\');return i},t.getConstantListLength=s,t.listLengthIndex=a,t.minListLengthIndex=function(t,n){for(var r=[],i=0,o=n;i<o.length;i++){var u=o[i];e.isList(t.getInstruction(u).valueType)&&r.push(u)}if(0!==r.length){if(1===r.length)return a(t,r[0]);for(var c,g=[],h=0,l=r;h<l.length;h++){var f=l[h];g.push(s(t,f))}for(var v=1/0,p=0;p<g.length;p++){var L=r[p],d=g[p];if(void 0===d)return t.SyntheticNativeFunction("min",[t.List(r.map(function(n){return a(t,n)}))]);d<v&&(c=L,v=d)}return void 0!==c?a(t,c):t.Constant(v)}}});\ndefine(\'core/math/ir/features/contains-nan-value\',["require","exports","core/math/types","core/math/maybe-rational"],function(require,e,t,n){"use strict";function a(e,a){switch(e){case t.Number:return n.isNanFloat(a);case t.Point:var r=a,o=r[0],i=r[1];return n.isNanFloat(o)||n.isNanFloat(i);case t.RGBColor:var s=a,u=s[0],c=s[1],l=s[2];return n.isNanFloat(u)||n.isNanFloat(c)||n.isNanFloat(l);case t.Action:return 0===Object.keys(a.updateRules).length;case t.Bool:return!1;default:throw new Error("Type cannot contain a NaN value: "+t.prettyPrint(e)+".")}}Object.defineProperty(e,"__esModule",{value:!0}),e.containsNanValue=void 0,e.containsNanValue=function(e,n){if(t.isList(e)){for(var r=t.elementType(e),o=0;o<n.length;o++)if(a(r,n[o]))return!0;return!1}return a(e,n)}});\ndefine(\'core/math/ir/features/interpret\',["require","exports","tslib","core/math/maybe-rational","../opcodes","core/math/types","../instructions","../builtin-table","./as-value","./nan-of-type","../../builtin","../../errormsg"],function(require,r,e,t,a,n,s,u,o,c,i,l){"use strict";function g(r,e){return t.add(r,e)}function d(r,e){return t.sub(r,e)}function p(r,e){return t.mul(r,e)}function f(r,e){return t.div(r,e)}function v(r,e){return t.pow(r,e)}function h(r,e){return v(r,e)}function y(r){return t.neg(r)}function m(r,e){return[r,e]}function E(r,e){return r[t.asFloat(e)-1]}function L(r,e){return t.asFloat(r)===t.asFloat(e)}function A(r,e){return t.asFloat(r)<t.asFloat(e)}function I(r,e){return t.asFloat(r)>t.asFloat(e)}function b(r,e){return t.asFloat(r)<=t.asFloat(e)}function F(r,e){return t.asFloat(r)>=t.asFloat(e)}function B(r){return r}function w(r,e,a){var n=Math.floor(t.asFloat(a))-1;return!isFinite(n)||n<0||n>=e.length?c.nanOfType(r):e[n]}function R(r,e){return r[Math.floor(t.asFloat(e))-1]}function q(r,e,a){return t.isRational(a)&&(a=t.asFloat(a)),e+"::"+r+a}function P(r,e){switch(r){case"mod":return t.mod(e[0],e[1]);case"abs":return t.abs(e[0]);case"sqrt":return t.sqrt(e[0]);case"nthroot":return t.nthroot(e[0],e[1]);case"total":return t.total(e[0]);case"length":return e[0].length;case"validateRangeLength":var a=e[0],n=e[1],s=e[2],c=e[3];if(0===(g=i.validateRangeLength(a,n,s,c)))throw l.nonArithmeticRange();return g;case"validateSampleCount":var g;c=o.compilerValueToRuntimeValue(e[0]);if(0===(g=i.validateSampleCount(c))&&0!==c)throw l.badSampleSize();return g;case"select":case"elementsAt":case"uniquePerm":case"sortPerm":var d=u.BuiltInTable[r];return i[d.symbol].apply(null,e);default:return("Math"===(d=u.BuiltInTable[r]).module?Math:i)[d.symbol].apply(null,o.compilerValueToRuntimeValue(e))}}function T(r,e,a){if(e.constantLength)return e.constantLength;var n=e.args[0],s=r.getInstruction(n).args[0],u=r.getInstruction(s);return t.asFloat(M(r,u.args[0],a))}function x(r,e,t,a){var s=r.getInstruction(e),u=T(r,s,a);if(!isFinite(t)||t<0||t>=u)return c.nanOfType(n.elementType(s.valueType));var o=s.args[0],i=e-o,l=r.getInstruction(o),g=l.args[0],d=l.args[i];a[g]=t+1;for(var p=M(r,d,a),f=g;f<=o;f++)a[f]=void 0;return p}function S(r,n,s){var u=M(r,n.args[1],s),o=n.args[0],c=r.getInstruction(o);if(c.type===a.BroadcastResult)return x(r,o,t.asFloat(u)-1,s);if(c.type===a.Piecewise){var i=M(r,c.args[0],s);return S(r,e.__assign(e.__assign({},n),{args:[i?c.args[1]:c.args[2],n.args[1]]}),s)}var l=M(r,n.args[0],s);return w(n.valueType,l,u)}function M(r,e,a){var n=a[e];if(void 0!==n)return n;var s=O(r,e,a);return"number"==typeof s&&s===Math.floor(s)&&(s=t.maybeRational(s,1)),a[e]=s,s}function O(r,e,t){var n=r.getInstruction(e);switch(n.type){case a.Constant:return n.value;case a.Add:return g(M(r,n.args[0],t),M(r,n.args[1],t));case a.Subtract:return d(M(r,n.args[0],t),M(r,n.args[1],t));case a.Multiply:return p(M(r,n.args[0],t),M(r,n.args[1],t));case a.Divide:return f(M(r,n.args[0],t),M(r,n.args[1],t));case a.Exponent:return v(M(r,n.args[0],t),M(r,n.args[1],t));case a.RawExponent:return h(M(r,n.args[0],t),M(r,n.args[1],t));case a.Negative:return y(M(r,n.args[0],t));case a.OrderedPair:return m(M(r,n.args[0],t),M(r,n.args[1],t));case a.OrderedPairAccess:return E(M(r,n.args[0],t),M(r,n.args[1],t));case a.Equal:return L(M(r,n.args[0],t),M(r,n.args[1],t));case a.Less:return A(M(r,n.args[0],t),M(r,n.args[1],t));case a.Greater:return I(M(r,n.args[0],t),M(r,n.args[1],t));case a.LessEqual:return b(M(r,n.args[0],t),M(r,n.args[1],t));case a.GreaterEqual:return F(M(r,n.args[0],t),M(r,n.args[1],t));case a.And:return M(r,n.args[0],t)&&M(r,n.args[1],t);case a.ExtendSeed:return q(n.tag,M(r,n.args[0],t),M(r,n.args[1],t));case a.Piecewise:var u=M(r,n.args[0],t);return M(r,u?n.args[1]:n.args[2],t);case a.NativeFunction:for(var o=[],c=0,i=n.args;c<i.length;c++){var l=i[c];o.push(M(r,l,t))}return P(n.symbol,o);case a.List:o=[];for(var B=0,w=n.args;B<w.length;B++){l=w[B];o.push(M(r,l,t))}return o;case a.ListAccess:case a.DeferredListAccess:case a.InboundsListAccess:return S(r,n,t);case a.BroadcastResult:return function(r,e,t){for(var a=r.getInstruction(e),n=[],s=T(r,a,t)-1;s>=0;s--)n[s]=x(r,e,s,t);return n}(r,e,t);case a.BlockVar:var R=n.args[0],O=r.getInstruction(R).args[0],D=e-R,N=r.getInstruction(R).args[D],V=[];V[N]=!0;for(var _=N;_>=O;_--)if(V[_]){var C=r.getInstruction(_);if(!s.isLeafInstruction(C))for(var G=0,k=C.args;G<k.length;G++){(l=k[G])<O?M(r,l,t):V[l]=!0}}var W=r.copy();W.truncate(O);for(_=0;_<O;_++){var j=t[_],z=r.getInstruction(_);if(void 0!==j){var H=z.valueType;W.replaceInstructionWithConstant(_,{type:a.Constant,valueType:H,value:j})}}var J=[];for(_=O;_<e;_++){var K=r.getInstruction(_);if(s.isLeafInstruction(K))J.push(W.copyInstruction(K));else{for(var Q=[],U=0,X=K.args;U<X.length;U++){l=X[U];Q.push(l<O?l:J[l-O])}K.type===a.DeferredListAccess?J.push(W.InboundsListAccess(Q)):J.push(W.copyInstructionWithArgs(K,Q))}}return W.Noop(),W.replaceInstructionWithBlockVar(W.returnIndex,{type:a.BlockVar,valueType:n.valueType,args:[R<O?R:J[R-O]]}),W.close().getCompiledFunction().fn();case a.BeginLoop:case a.EndLoop:case a.BeginIntegral:case a.EndIntegral:case a.BeginBroadcast:case a.EndBroadcast:case a.Distribution:case a.Noop:case a.LoadArg:case a.SymbolicVar:case a.Action:throw new Error("Programming Error: cannot interpret opcode "+n.type);default:throw new Error("Programming Error: unexpected opcode "+n.type)}}Object.defineProperty(r,"__esModule",{value:!0}),r._interpretRecursive=r.interpretBroadcastElements=r.interpretBroadcastElement=r.interpret=r.NativeFunction=r.ExtendSeed=r.InboundsListAccess=r.DeferredListAccess=r.ListAccess=r.List=r.And=r.GreaterEqual=r.LessEqual=r.Greater=r.Less=r.Equal=r.OrderedPairAccess=r.OrderedPair=r.Negative=r.RawExponent=r.Exponent=r.Divide=r.Multiply=r.Subtract=r.Add=void 0,r.Add=g,r.Subtract=d,r.Multiply=p,r.Divide=f,r.Exponent=v,r.RawExponent=h,r.Negative=y,r.OrderedPair=m,r.OrderedPairAccess=E,r.Equal=L,r.Less=A,r.Greater=I,r.LessEqual=b,r.GreaterEqual=F,r.And=function(r,e){return r&&e},r.List=B,r.ListAccess=w,r.DeferredListAccess=function(r,e){return R(r,e)},r.InboundsListAccess=R,r.ExtendSeed=q,r.NativeFunction=P,r.interpret=function(r,e){return M(r,e,Array(e+1))},r.interpretBroadcastElement=function(r,e,t){return x(r,e,t,Array(e+1))},r.interpretBroadcastElements=function(r,e,t){for(var a=Array(e+1),n=[],s=0,u=t;s<u.length;s++){var o=u[s];n.push(x(r,e,o,a))}return n},r._interpretRecursive=O});\ndefine(\'core/math/ir/features/find-dependency-symbols\',["require","exports","../instructions","../opcodes"],function(require,e,o,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.findDependencySymbols=void 0,e.findDependencySymbols=function(e,r){for(var n=[],a=[],t=0;t<r;t++)a.push(!1);for(a.push(!0),t=r;t>=0;t--)if(a[t]){var i=e.getInstruction(t);if(i.type===s.LoadArg)n.push({symbol:e.argNames[t],scope:"free"});else if(o.beginsBlock(i))switch(i.type){case s.BeginIntegral:n.push({symbol:i.callData.indexSymbol,scope:"integral"});break;case s.BeginLoop:n.push({symbol:i.callData.indexSymbol,scope:i.callData.type});break;case s.BeginBroadcast:if(i.listComprehensionCallData)for(var l=0,c=i.listComprehensionCallData.inputListSymbols;l<c.length;l++){var p=c[l];n.push({symbol:p,scope:"comprehension"})}break;default:throw new Error("Programming Error: unexpected loop instruction "+i.type)}else i.type===s.SymbolicVar&&i.symbol&&n.push({symbol:i.symbol,scope:"symbolic-var"});if(!o.isLeafInstruction(i))for(var y=0,u=i.args;y<u.length;y++){a[u[y]]=!0}}return n.reverse()}});\ndefine(\'core/math/ir/features/fuse-broadcast\',["require","exports","../opcodes","core/math/types","../instructions","./interpret","./list-length","../../errormsg","./find-dependency-symbols"],function(require,t,r,e,n,s,i,o,u){"use strict";function a(t,r,n){if(n.valueType===e.ListOfDistribution){var a=i.getConstantListLength(t,r);if(null==a)throw o.variableLengthDistributionList(u.findDependencySymbols(t,r));for(var c=[],f=0;f<a;f++){var d=t.InboundsListAccess([r,t.Constant(f+1)]);c.push(d)}return t.List(c)}var p=s.interpret(t,r);return r===t.returnIndex&&t.popInstruction(),t.ConstantOfType(n.valueType,p)}Object.defineProperty(t,"__esModule",{value:!0}),t.fuseBroadcast=void 0,t.fuseBroadcast=function(t,e){var s=t.getInstruction(e);if(s.type!==r.BroadcastResult)return e;if(s.isConstantBroadcast)return a(t,e,s);for(var i=s.args[0],o=t.getInstruction(i),u=o.args[0],c=!1,f=u+1;f<i;f++){var d=t.getInstruction(f);if(d.type===r.DeferredListAccess&&d.args[1]===u){c=!0;break}}if(!c)return e;for(var p=[],g=u;g<=i+o.args.length-1;g++){var v=t.getInstruction(g);if(n.isLeafInstruction(v))p.push(t.copyInstruction(v));else{for(var l=[],y=0,I=v.args;y<I.length;y++){var h=I[y];l.push(h>=u?p[h-u]:h)}v.type===r.DeferredListAccess?p.push(t.InboundsListAccess(l)):p.push(t.copyInstructionWithArgs(v,l))}}var L=t.getInstruction(t.returnIndex);return L.type===r.BroadcastResult&&L.isConstantBroadcast?a(t,t.returnIndex,L):t.returnIndex}});\ndefine(\'core/math/ir/features/element-at\',["require","exports","./list-length","./interpret","../opcodes","core/math/types","./nan-of-type"],function(require,t,e,n,s,a,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.elementsAt=t.elementAt=void 0,t.elementAt=function(t,r,o){var i=t.getInstruction(r);if(a.isList(i.valueType)){var p=e.getConstantListLength(t,r);if(o=Math.floor(o),isNaN(o)||o<0||void 0!==p&&o>=p){var l=a.elementType(i.valueType);return t.NanOfType(l)}return i.type===s.List?i.args[o]:i.type===s.Constant&&a.isList(i.valueType)?t.ConstantOfType(a.elementType(i.valueType),i.value[o]):i.type===s.BroadcastResult&&i.isConstantBroadcast?t.ConstantOfType(a.elementType(i.valueType),n.interpretBroadcastElement(t,r,o)):void 0!==p?t.InboundsListAccess([r,t.Constant(o+1)]):t.ListAccess([r,t.Constant(o+1)])}if(i.valueType===a.Point)return isNaN(o)||o<0||o>2?t.Constant(NaN):i.type===s.OrderedPair?i.args[o]:i.type===s.Constant?t.Constant(i.value[o]):t.OrderedPairAccess([r,t.Constant(o+1)]);throw new Error("Cannot access elements of "+a.prettyPrint(i.valueType))},t.elementsAt=function(t,o,i){var p=t.getInstruction(o);if(0===i.length)return t.ConstantOfType(p.valueType,[]);if(p.type===s.Constant&&a.isList(p.valueType)){for(var l=[],u=a.elementType(p.valueType),y=0,c=i;y<c.length;y++){var v=c[y],f=Math.floor(v);isNaN(f)||f<0||f>=e.assertConstantListLength(t,o,"Programming error: expected Constant list instruction to have constant length.")?l.push(r.nanOfType(u)):l.push(p.value[f])}return t.ConstantOfType(p.valueType,l)}if(p.type===s.List){l=[];for(var T=0,h=i;T<h.length;T++){v=h[T],f=Math.floor(v);if(isNaN(f)||f<0||f>=e.assertConstantListLength(t,o,"Programming error: expected List instruction to have constant length.")){var d=a.elementType(p.valueType);l.push(t.NanOfType(d))}else l.push(p.args[f])}return t.List(l)}if(p.type===s.BroadcastResult&&p.isConstantBroadcast)return t.ConstantOfType(p.valueType,n.interpretBroadcastElements(t,o,i));for(var g=[],C=!0,L=e.getConstantListLength(t,o),m=0,N=i;m<N.length;m++){v=N[m],f=Math.floor(v);g.push(t.Constant(f+1)),(isNaN(f)||f<0||void 0===L||f>=L)&&(C=!1)}var O=[o,t.List(g)];return C?t.InboundsListAccess(O):t.ListAccess(O)}});\ndefine(\'core/math/ir/features/constant-collapse\',["require","exports","../opcodes","../instructions","core/math/types","core/math/maybe-rational","./depends-on-outer-variable","./is-constant","./as-value","./reconstitute-ir","./list-length","./contains-nan-value","./interpret","./fuse-broadcast","./element-at","../../builtin"],function(require,t,n,e,r,s,a,o,u,i,c,p,l,g,I,v){"use strict";function y(t,n){for(var e=[],r=0,s=n;r<s.length;r++){var a=s[r],u=t.getInstruction(a);if(!o.isConstant(u))return;e.push(u.value)}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.constantCollapse=void 0,t.constantCollapse=function(t){if(t.instructionsLength()-1!==t.returnIndex)throw new Error("Programming Error: only the final instruction in a chunk can be constant collapsed");var d=t.getInstruction(t.returnIndex);if(e.isLeafInstruction(d))return t.returnIndex;switch(d.type){case n.Add:var C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.Constant(l.Add(C.value,f.value))):C.type===n.Constant&&0===s.asFloat(C.value)?(t.popInstruction(),d.args[1]):f.type===n.Constant&&0===s.asFloat(f.value)?(t.popInstruction(),d.args[0]):t.returnIndex;case n.Subtract:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.Constant(l.Subtract(C.value,f.value))):C.type===n.Constant&&0===s.asFloat(C.value)?(t.popInstruction(),t.Negative([d.args[1]])):f.type===n.Constant&&0===s.asFloat(f.value)?(t.popInstruction(),d.args[0]):t.returnIndex;case n.Multiply:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.Constant(l.Multiply(C.value,f.value))):C.type===n.Constant&&1===s.asFloat(C.value)?(t.popInstruction(),d.args[1]):f.type===n.Constant&&1===s.asFloat(f.value)?(t.popInstruction(),d.args[0]):t.returnIndex;case n.Divide:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.Constant(l.Divide(C.value,f.value))):f.type===n.Constant&&1===s.asFloat(f.value)?(t.popInstruction(),d.args[0]):t.returnIndex;case n.Exponent:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);if(C.type===n.Constant&&f.type===n.Constant)return t.popInstruction(),t.Constant(l.Exponent(C.value,f.value));if(C.type===n.Constant&&C.valueType===r.Number){if((x=s.asFloat(C.value))===Math.E)return t.popInstruction(),t.SyntheticNativeFunction("exp",[d.args[1]]);if(x>0)return t.popInstruction(),t.RawExponent(d.args)}if(f.type===n.Constant&&f.valueType===r.Number){var x;if(1===(x=s.asFloat(f.value)))return t.popInstruction(),d.args[0];if(x===Math.floor(x))return t.popInstruction(),t.RawExponent(d.args);if(s.isRational(f.value)){var h=f.value,T=h.n;if(h.d%2==1){t.popInstruction();var L=t.RawExponent([t.SyntheticNativeFunction("abs",[d.args[0]]),d.args[1]]);return T%2==0?L:t.Multiply([t.SyntheticNativeFunction("sign",[d.args[0]]),L])}}}return t.returnIndex;case n.RawExponent:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.Constant(l.Exponent(C.value,f.value))):f.type===n.Constant&&1===s.asFloat(f.value)?(t.popInstruction(),d.args[0]):t.returnIndex;case n.Negative:return(C=t.getInstruction(d.args[0])).type===n.Constant?(t.popInstruction(),t.Constant(l.Negative(C.value))):t.returnIndex;case n.Equal:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.ConstantOfType(r.Bool,l.Equal(C.value,f.value))):t.returnIndex;case n.Less:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.ConstantOfType(r.Bool,l.Less(C.value,f.value))):t.returnIndex;case n.Greater:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.ConstantOfType(r.Bool,l.Greater(C.value,f.value))):t.returnIndex;case n.LessEqual:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.ConstantOfType(r.Bool,l.LessEqual(C.value,f.value))):t.returnIndex;case n.GreaterEqual:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.ConstantOfType(r.Bool,l.GreaterEqual(C.value,f.value))):t.returnIndex;case n.And:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&f.type===n.Constant?(t.popInstruction(),t.ConstantOfType(r.Bool,l.And(C.value,f.value))):t.returnIndex;case n.Piecewise:return(C=t.getInstruction(d.args[0])).type===n.Constant?(t.popInstruction(),C.value?d.args[1]:d.args[2]):t.returnIndex;case n.OrderedPairAccess:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.OrderedPair&&f.type===n.Constant?(t.popInstruction(),C.args[s.asFloat(f.value)-1]):C.type===n.Constant&&C.valueType===r.Point&&f.type===n.Constant?(t.popInstruction(),t.Constant(C.value[s.asFloat(f.value)-1])):t.returnIndex;case n.List:if(function(t,n){for(var e=0,r=n;e<r.length;e++){var s=r[e],a=t.getInstruction(s);if(!o.isConstant(a))return!1}return!0}(t,d.args)){t.popInstruction();for(var E=[],b=0,A=d.args;b<A.length;b++){var m=A[b];E.push(t.getInstruction(m).value)}return t.ConstantOfType(d.valueType,E)}return t.returnIndex;case n.ListAccess:case n.InboundsListAccess:var O=d.args[0],N=t.getInstruction(O),F=t.getInstruction(d.args[1]);if(N.type===n.Piecewise&&F.type===n.Constant){var B=d.type===n.ListAccess?t.ListAccess([N.args[1],d.args[1]]):t.InboundsListAccess([N.args[1],d.args[1]]),w=d.type===n.ListAccess?t.ListAccess([N.args[2],d.args[1]]):t.InboundsListAccess([N.args[2],d.args[1]]);return t.Piecewise([N.args[0],B,w])}if(N.type===n.BroadcastResult){if(F.type===n.Constant&&N.isConstantBroadcast&&N.valueType!==r.ListOfDistribution)return t.ConstantOfType(d.valueType,l.interpret(t,t.returnIndex));t.popInstruction();var q=N.args[0],P=O-q,R=(et=t.getInstruction(q)).args[0],M=void 0,S=void 0;if(d.type===n.InboundsListAccess)M=d.args[1];else{var V=c.getConstantListLength(t,O);if(F.type===n.Constant&&F.valueType===r.Number&&void 0!==V){var D=s.asFloat(F.value),G=Math.floor(D);if(G<1||G>V)return t.NanOfType(d.valueType);M=D===G?d.args[1]:t.Constant(G)}else{var k=t.Constant(1),_=t.getInstruction(R).args[0],j=t.SyntheticNativeFunction("floor",[d.args[1]]),U=t.GreaterEqual([j,k]),W=t.LessEqual([j,_]);M=t.Piecewise([U,t.Piecewise([W,j,_]),k]),S={one:k,lengthIndex:_,roundedIndex:j,greaterEqualIndex:U,lessEqualIndex:W}}}if(et.args[P]<R)return et.args[P];for(var z=[M],H=R+1;H<=et.args[P];H++){var J=t.getInstruction(H);if(e.isLeafInstruction(J))z.push(t.copyInstruction(J));else{for(var K=[],Q=0,X=J.args;Q<X.length;Q++){m=X[Q];K.push(m>=R?z[m-R]:m)}J.type===n.DeferredListAccess?z.push(t.InboundsListAccess(K)):z.push(t.copyInstructionWithArgs(J,K))}}if(S){U=S.greaterEqualIndex,W=S.lessEqualIndex,_=S.lengthIndex,k=S.one;var Y=r.elementType(N.valueType),Z=t.NanOfType(Y),$=z[z.length-1],tt=t.And([t.And([U,W]),t.GreaterEqual([_,k])]);return t.Piecewise([tt,$,Z])}return z[z.length-1]}if(F.type===n.Constant&&F.valueType===r.Number){if(N.type===n.List){t.popInstruction();var nt=Math.floor(s.asFloat(F.value))-1;return isNaN(nt)||nt<0||nt>=N.args.length?t.NanOfType(d.valueType):N.args[nt]}if(N.type===n.Constant){t.popInstruction();nt=Math.floor(s.asFloat(F.value))-1;return isNaN(nt)||nt<0||nt>=N.value.length?t.NanOfType(d.valueType):t.ConstantOfType(r.elementType(N.valueType),N.value[nt])}return t.returnIndex}return t.returnIndex;case n.BlockVar:var et=t.getInstruction(d.args[0]);if(!e.endsBlock(et))return t.returnIndex;P=t.returnIndex-d.args[0];if(a.dependsOnOuterVariable(t,et.args[P],et.args[0]))return t.returnIndex;var rt=t.copy();rt.close();E=rt.getCompiledFunction().fn();return t.popInstruction(),i.reconstituteIR(t,d.valueType,E);case n.NativeFunction:switch(d.symbol){case"nthroot":if(void 0!==(gt=y(t,d.args)))return t.Constant(s.nthroot(gt[0],gt[1]));var st=t.getInstruction(d.args[1]);return st.type===n.Constant&&st.valueType===r.Number?t.Exponent([d.args[0],t.Constant(s.reciprocal(st.value))]):t.returnIndex;case"length":return void 0!==(V=c.getConstantListLength(t,d.args[0]))?(t.popInstruction(),t.Constant(V)):t.returnIndex;case"select":if(o.isConstant(t.getInstruction(d.args[1]))){t.popInstruction();var at=u.asValue(t,d.args[1]),ot=[];for(H=0;H<at.length;H++)at[H]&&ot.push(H);return I.elementsAt(t,d.args[0],ot)}return t.returnIndex;case"shuffle":var ut=d.args[0];N=d.args[1];if(void 0!==(V=c.getConstantListLength(t,N))&&o.isConstant(t.getInstruction(ut))){t.popInstruction();var it=v.randomPerm(u.asValue(t,ut),V);return I.elementsAt(t,N,it)}return t.returnIndex;case"elementsAt":var ct=d.args[0],pt=d.args[1];if(o.isConstant(t.getInstruction(pt))){t.popInstruction();var lt=u.asValue(t,pt);return I.elementsAt(t,ct,lt)}return t.returnIndex;default:var gt;return void 0===(gt=y(t,d.args))?t.returnIndex:(t.popInstruction(),t.ConstantOfType(d.valueType,l.NativeFunction(d.symbol,gt)))}case n.ExtendSeed:var It=t.getInstruction(d.args[0]),vt=t.getInstruction(d.args[1]);return o.isConstant(It)&&o.isConstant(vt)?t.ConstantOfType(r.SeedType,l.ExtendSeed(d.tag,u.asValue(t,d.args[0]),u.asValue(t,d.args[1]))):t.returnIndex;case n.OrderedPair:C=t.getInstruction(d.args[0]),f=t.getInstruction(d.args[1]);return C.type===n.Constant&&C.valueType===r.Number&&f.type===n.Constant&&f.valueType===r.Number?t.ConstantOfType(r.Point,[C.value,f.value]):t.returnIndex;case n.BroadcastResult:return void 0!==(V=c.getConstantListLength(t,t.returnIndex))&&0===V?(t.popInstruction(),t.ConstantOfType(d.valueType,[])):t.returnIndex;case n.Action:for(var yt=0,dt=d.args;yt<dt.length;yt++){m=dt[yt];if(!o.isConstantOrConstantBroadcast(t.getInstruction(m)))return t.returnIndex}t.popInstruction();var Ct={};for(H=0;H<d.symbols.length;H++){var ft=d.symbols[H],xt=t.getInstruction(d.args[H]);if(xt.type===n.BroadcastResult&&(xt=t.getInstruction(g.fuseBroadcast(t,d.args[H]))),xt.type!==n.Constant)throw new Error("Expected instruction to be constant");var ht=xt.valueType;E=xt.value;p.containsNanValue(ht,E)||(Ct[ft]={value:E,valueType:ht})}return t.ConstantOfType(r.Action,{type:"Action",updateRules:Ct});case n.EndLoop:case n.EndIntegral:case n.BeginBroadcast:case n.EndBroadcast:case n.DeferredListAccess:case n.Distribution:case n.BeginIntegral:case n.BeginLoop:return t.returnIndex;default:throw new Error("Unexpected opcode "+d.type)}}});\ndefine(\'core/math/ir/features/type-check\',["require","exports","core/math/errormsg","../opcodes","core/math/types","../builtin-table","../instructions"],function(require,e,r,t,a,s,n){"use strict";function i(e,r){for(var t=[],s=0,n=r;s<n.length;s++){var i=n[s];t.push(a.prettyPrint(e.getInstruction(i).valueType))}return t}function u(e,r,t){for(var s=0;s<r.length;s++){var n=e.getInstruction(r[s]).valueType,i=t[s];if(!a.isSubType(n,i))return!1}return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.typeCheck=e.argIsTypeOrListOfType=e.argTypesMatch=e.extractScalarValueTypes=e.extractValueTypes=void 0,e.extractValueTypes=i,e.extractScalarValueTypes=function(e,r){for(var t=[],s=0,n=r;s<n.length;s++){var i=n[s],u=e.getInstruction(i).valueType,o=a.isList(u)?a.elementType(u):u;t.push(a.prettyPrint(o))}return t},e.argTypesMatch=u,e.argIsTypeOrListOfType=function(e,r,t){return a.isTypeOrListOfType(e.getInstruction(r).valueType,t)},e.typeCheck=function(e,o){var c=e.getInstruction(o);if(!n.isLeafInstruction(c))switch(c.type){case t.Add:var p=[a.Number,a.Number];if(!u(e,c.args,p))throw r.addTypeError(i(e,c.args));return;case t.Subtract:p=[a.Number,a.Number];if(!u(e,c.args,p))throw r.subtractTypeError(i(e,c.args));return;case t.Multiply:p=[a.Number,a.Number];if(!u(e,c.args,p))throw r.multiplyTypeError(i(e,c.args));return;case t.Divide:p=[a.Number,a.Number];if(!u(e,c.args,p))throw r.divideTypeError(i(e,c.args));return;case t.Exponent:case t.RawExponent:p=[a.Number,a.Number];if(!u(e,c.args,p))throw r.exponentTypeError(i(e,c.args));return;case t.Negative:p=[a.Number];if(!u(e,c.args,p))throw r.negativeTypeError(i(e,c.args));return;case t.Equal:case t.Less:case t.Greater:case t.LessEqual:case t.GreaterEqual:p=[a.Number,a.Number];if(!u(e,c.args,p))throw r.comparatorTypeError(i(e,c.args));return;case t.And:p=[a.Bool,a.Bool];if(!u(e,c.args,p))throw r.andTypeError(i(e,c.args));return;case t.Piecewise:if(e.getInstruction(c.args[0]).valueType!==a.Bool)throw r.piecewiseConditionTypeError(i(e,c.args));if(!a.isSubType(e.getInstruction(c.args[1]).valueType,c.valueType)||!a.isSubType(e.getInstruction(c.args[2]).valueType,c.valueType))throw r.piecewiseBranchTypeError([a.prettyPrint(e.getInstruction(c.args[1]).valueType),a.prettyPrint(e.getInstruction(c.args[2]).valueType)]);return;case t.OrderedPair:for(var g=0,y=c.args;g<y.length;g++){var l=y[g];if((m=e.getInstruction(l).valueType)!==a.Number)throw r.pointTypeError(a.prettyPrint(m))}return;case t.OrderedPairAccess:p=[a.Point,a.Number];if(!u(e,c.args,p))throw r.orderedPairAccessTypeError(i(e,c.args));return;case t.BeginIntegral:var T=e.getInstruction(c.args[0]).valueType,v=e.getInstruction(c.args[1]).valueType;if(T!==a.Number)throw r.integralLowerBoundTypeError([a.prettyPrint(T)]);if(v!==a.Number)throw r.integralUpperBoundTypeError([a.prettyPrint(v)]);return;case t.EndIntegral:var f=e.getInstruction(c.args[1]).valueType;if(f!==a.Number)throw r.integralArgumentTypeError([a.prettyPrint(f)]);return;case t.List:if(0===c.args.length)return;var d=e.getInstruction(c.args[0]).valueType;if(!a.hasListType(d))throw r.listTypeError([a.prettyPrint(d)]);for(var h=0,b=c.args;h<b.length;h++){l=b[h];var m=e.getInstruction(l).valueType;if(!a.hasListType(m))throw r.listTypeError([a.prettyPrint(m)]);if(m!==d)throw r.heterogeneousList()}return;case t.ListAccess:case t.DeferredListAccess:case t.InboundsListAccess:var w=e.getInstruction(c.args[0]).valueType,I=a.isList(w),E=e.getInstruction(c.args[1]).valueType===a.Number;if(!I||!E)throw r.indexTypeError(i(e,c.args));return;case t.NativeFunction:var L=c.args,N=c.symbol,P=s.BuiltInTable[N],B=(p=P.argumentTypes,c.callData.errorSymbol);if(!u(e,c.args,p)){if("doubleReducer"===P.tag){if(!a.isList(e.getInstruction(L[0]).valueType)||!a.isList(e.getInstruction(L[1]).valueType))throw r.nonListDoubleReducer(B)}else if("parameterizedReducer"===P.tag&&!a.isList(e.getInstruction(L[0]).valueType))throw r.nonListParameterizedReducer(B);var O=L;throw r.functionTypeError(B,i(e,O))}return;case t.ExtendSeed:if(e.getInstruction(c.args[0]).valueType!==a.SeedType||e.getInstruction(c.args[1]).valueType!==a.SeedType&&e.getInstruction(c.args[1]).valueType!==a.Number)throw r.parseError();return;case t.Action:for(var x=0,S=c.args;x<S.length;x++){l=S[x];var A=e.getInstruction(l).valueType;if(!a.isTypeOrListOfType(A,a.Number)&&!a.isTypeOrListOfType(A,a.Point))throw r.updateRuleTypeError(a.prettyPrint(A))}for(var R={},D=0,V=c.symbols;D<V.length;D++){if(R[N=V[D]])throw r.duplicateUpdateRules(N);R[N]=!0}return;case t.BroadcastResult:case t.BlockVar:case t.BeginBroadcast:case t.EndBroadcast:case t.BeginLoop:case t.EndLoop:case t.Distribution:return;default:throw new Error("Unexpected opcode: "+c.type)}}});\ndefine(\'core/math/ir/features/count-references\',["require","exports","../opcodes","../instructions"],function(require,e,n,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.countReferences=void 0,e.countReferences=function(e){for(var t=[],s=0;s<e.instructionsLength();s++){t.push(0);var o=e.getInstruction(s);if(!r.isLeafInstruction(o))if(r.endsBlock(o)&&o.type!==n.EndIntegral)for(var i=0,c=o.args;i<c.length;i++){t[c[i]]=1/0}else for(var u=0,f=o.args;u<f.length;u++){t[f[u]]+=1}}return t}});\ndefine(\'core/math/ir/features/emit-js\',["require","exports","../opcodes","./print","../instructions","core/math/maybe-rational","core/math/types","../builtin-table","./count-references","core/math/context-types","./as-value","./nan-of-type"],function(require,e,r,n,t,a,s,o,c,u,i,g){"use strict";function d(e){return"_"+e}function l(e,r){var n=r[e];return void 0!==n?n:d(e)}function p(e,t,a,c,u,p){var v=a+1;switch(t.type){case r.Noop:case r.BlockVar:case r.BroadcastResult:case r.EndIntegral:case r.Action:return{source:"",nextIdx:v};case r.BeginIntegral:return{source:f(e,t,a,c,u,p),nextIdx:t.endIndex};case r.LoadArg:return u[a]=e.argNames[a],{source:"",nextIdx:v};case r.BeginBroadcast:return{source:x(e,t,a,u),nextIdx:v};case r.EndBroadcast:return{source:I(e,t,a,u),nextIdx:v};case r.BeginLoop:return{source:y(e,t,a,u),nextIdx:v};case r.EndLoop:return{source:h(e,t,a,u),nextIdx:v};default:var m=function(e,t,a){switch(e.type){case r.Constant:return e.valueType===s.Number||e.valueType===s.Bool||e.valueType===s.Point?B(e.value):(a.push(i.compilerValueToRuntimeValue(e.value)),"_C["+(a.length-1)+"]");case r.Add:return l(e.args[0],t)+"+"+l(e.args[1],t);case r.Subtract:return l(e.args[0],t)+"-"+l(e.args[1],t);case r.Multiply:return l(e.args[0],t)+"*"+l(e.args[1],t);case r.Divide:return l(e.args[0],t)+"/"+l(e.args[1],t);case r.Exponent:return"BuiltIn.pow("+l(e.args[0],t)+","+l(e.args[1],t)+")";case r.RawExponent:return"Math.pow("+l(e.args[0],t)+","+l(e.args[1],t)+")";case r.Negative:return"-"+l(e.args[0],t);case r.Equal:return l(e.args[0],t)+"==="+l(e.args[1],t);case r.Less:return l(e.args[0],t)+"<"+l(e.args[1],t);case r.Greater:return l(e.args[0],t)+">"+l(e.args[1],t);case r.LessEqual:return l(e.args[0],t)+"<="+l(e.args[1],t);case r.GreaterEqual:return l(e.args[0],t)+">="+l(e.args[1],t);case r.And:return l(e.args[0],t)+"&&"+l(e.args[1],t);case r.Piecewise:return l(e.args[0],t)+"?"+l(e.args[1],t)+":"+l(e.args[2],t);case r.OrderedPair:return"["+l(e.args[0],t)+","+l(e.args[1],t)+"]";case r.OrderedPairAccess:return l(e.args[0],t)+"["+l(e.args[1],t)+"-1]";case r.List:return"["+e.args.map(function(e){return l(e,t)}).join(",")+"]";case r.DeferredListAccess:case r.Distribution:case r.SymbolicVar:throw new Error("Programming Error: expect "+n.printOp(e.type)+" to be removed before emitting code.");case r.ListAccess:var c=l(e.args[0],t);return"(Math.floor("+(u=l(e.args[1],t))+")>=1&&Math.floor("+u+")<="+c+".length)?"+c+"[Math.floor("+u+")-1]:"+B(g.nanOfType(e.valueType));case r.InboundsListAccess:var u;return(c=l(e.args[0],t))+"["+(u=l(e.args[1],t))+"-1]";case r.NativeFunction:var d=o.BuiltInTable[e.symbol],p=e.args.map(function(e){return l(e,t)}).join(",");return d.module+"."+d.symbol+"("+p+")";case r.ExtendSeed:return l(e.args[0],t)+"+\'::"+e.tag+"\'+"+l(e.args[1],t);case r.LoadArg:case r.Noop:case r.BeginIntegral:case r.EndIntegral:case r.BeginLoop:case r.EndLoop:case r.BeginBroadcast:case r.EndBroadcast:case r.BlockVar:case r.BroadcastResult:case r.Action:throw new Error("Unexpected opcode "+e.type);default:throw new Error("Unexpected opcode "+e.type)}}(t,u,p);return c[a]<=1?(u[a]="("+m+")",{source:"",nextIdx:v}):{source:d(a)+"="+m+";\\n",nextIdx:v}}}function f(e,r,n,t,a,s){var o="BuiltIn.quad(";o+=function(e,r,n,t,a,s){var o=r.endIndex,c="function("+d(n)+") {\\n";c+=v(e,n+1,o-1,t);for(var u=n+1;u<o;){var i=e.getInstruction(u),g=p(e,i,u,t,a,s);c+=g.source,u=g.nextIdx}return c+"return "+l(e.getInstruction(o).args[1],a)+";\\n}"}(e,r,n,t,a,s),o+=","+l(r.args[0],a)+","+l(r.args[1],a)+")";var c=r.endIndex;return t[c+1]<=1?(a[c+1]=o,""):d(c+1)+"="+o+";"}function v(e,n,a,s){for(var o="",c=!1,u=n;u<=a;u++){var i=e.getInstruction(u);if(i.type!==r.Noop&&i.type!==r.EndBroadcast&&i.type!==r.EndLoop)if(i.type!==r.BeginIntegral)s[u]<=1&&!t.beginsBlock(i)&&!t.endsBlock(i)&&i.type!==r.BlockVar&&i.type!==r.BroadcastResult||(c?o+=",":(o+="var ",c=!0),o+=d(u));else{var g=i.endIndex;u=s[g+1]<=1?g+1:g}}return c&&(o+=";\\n"),o}function x(e,n,t,a){for(var s=d(t),o=e.getInstruction(n.endIndex),c=l(n.args[0],a),u="",i=1;i<o.args.length;i++){var g=n.endIndex+i;if(e.getInstruction(g).type===r.BroadcastResult)u+=d(g)+"=[];\\n"}return u+="for("+s+"=1;"+s+"<="+c+";"+s+"++){\\n"}function I(e,n,t,a){for(var s="",o=1;o<n.args.length;o++){var c=t+o;if(!(c>=e.instructionsLength()))if(e.getInstruction(c).type===r.BroadcastResult)s+=d(t+o)+".push("+l(n.args[o],a)+");\\n"}return s+="}\\n"}function y(e,n,t,a){for(var s=d(t),o=""+l(n.args[0],a),c=""+l(n.args[1],a),u="if(!isFinite("+c+"-"+o+")){\\n",i=2;i<n.args.length;i++){var p=n.endIndex+i-1;if(!(p>=e.instructionsLength())){var f=e.getInstruction(p);if(f.type===r.BlockVar)u+=d(p)+"="+B(g.nanOfType(f.valueType))+";\\n"}}u+="}else{\\n";for(i=2;i<n.args.length;i++){var v=t+i-1;if(e.getInstruction(v).type===r.BlockVar)u+=d(v)+"="+l(n.args[i],a)+";\\n"}return u+="for("+s+"="+o+";"+s+"<="+c+";"+s+"++){\\n"}function h(e,n,t,a){for(var s="",o=1;o<n.args.length;o++){var c=n.args[0]+o;if(e.getInstruction(c).type===r.BlockVar)s+=d(c)+"="+l(n.args[o],a)+";\\n"}s+="}\\n";for(o=1;o<n.args.length;o++){var u=t+o;if(!(u>=e.instructionsLength()))if(e.getInstruction(u).type===r.BlockVar)s+=d(u)+"="+l(n.args[0]+o,a)+";\\n"}return s+="}\\n"}function B(e){if(Array.isArray(e))return"["+e.map(B).join(",")+"]";switch(typeof e){case"boolean":case"number":return e.toString();case"string":return""+JSON.stringify(e);case"object":if(u.isActionCompilerValue(e))throw new Error("Action values cannot be compiled");return a.asFloat(e).toString();default:throw new Error("Unexpected value: "+e)}}Object.defineProperty(e,"__esModule",{value:!0}),e.emitJS=void 0,e.emitJS=function(e){for(var r=c.countReferences(e),n=[],t=[],a=v(e,e.argNames.length,e.instructionsLength()-1,r),s=0;s<e.instructionsLength();){var o=e.getInstruction(s),u=p(e,o,s,r,n,t);a+=u.source,s=u.nextIdx}return{source:a+="return "+l(e.returnIndex,n)+";",constants:t}}});\ndefine(\'core/math/ir/features/get-value-type\',["require","exports","../opcodes","core/math/types"],function(require,e,s,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getValueType=void 0,e.getValueType=function(e,a,c){switch(a){case s.Add:case s.Subtract:case s.Multiply:case s.Divide:case s.Exponent:case s.RawExponent:case s.Negative:case s.OrderedPairAccess:case s.BeginIntegral:case s.BeginLoop:case s.BeginBroadcast:return t.Number;case s.Equal:case s.Less:case s.Greater:case s.LessEqual:case s.GreaterEqual:case s.And:return t.Bool;case s.Piecewise:var r=e.getInstruction(c[1]).valueType,n=e.getInstruction(c[2]).valueType;return r===t.EmptyList&&t.isList(n)?n:r;case s.OrderedPair:return t.Point;case s.List:if(0===c.length)return t.EmptyList;var i=e.getInstruction(c[0]).valueType;return t.hasListType(i)?t.listType(i):t.ListOfAny;case s.ListAccess:case s.DeferredListAccess:case s.InboundsListAccess:var o=e.getInstruction(c[0]).valueType;return t.isList(o)?t.elementType(o):t.Any;case s.ExtendSeed:return t.SeedType;case s.Action:return t.Action;case s.Constant:case s.LoadArg:case s.NativeFunction:case s.Distribution:case s.BlockVar:case s.BroadcastResult:case s.SymbolicVar:case s.Noop:case s.EndIntegral:case s.EndBroadcast:case s.EndLoop:return t.Any;default:throw new Error("Unexpected opcode "+a)}}});\ndefine(\'core/math/ir/features/drop-unreferenced-instructions\',["require","exports","../instructions"],function(require,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.dropUnreferencedInstructions=void 0,e.dropUnreferencedInstructions=function(e){for(var r=[],t=0;t<e.instructionsLength();t++)r.push(!1);for(r[e.returnIndex]=!0,t=e.instructionsLength()-1;t>=0;t--)if(r[t]){var i=e.getInstruction(t);if(!n.isLeafInstruction(i))for(var o=0,s=i.args;o<s.length;o++){r[s[o]]=!0}}else e.replaceInstructionWithNoop(t)}});\ndefine(\'core/math/ir/features/copy-instruction\',["require","exports","../opcodes"],function(require,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.copyInstructionWithArgs=e.copyInstruction=void 0,e.copyInstruction=function(e,r){return e.pushLeafInstruction(r)},e.copyInstructionWithArgs=function(e,t,s){switch(t.type){case r.Add:return e.Add(s);case r.Subtract:return e.Subtract(s);case r.Multiply:return e.Multiply(s);case r.Divide:return e.Divide(s);case r.Exponent:return e.Exponent(s);case r.RawExponent:return e.RawExponent(s);case r.Negative:return e.Negative(s);case r.Equal:return e.Equal(s);case r.Less:return e.Less(s);case r.Greater:return e.Greater(s);case r.LessEqual:return e.LessEqual(s);case r.GreaterEqual:return e.GreaterEqual(s);case r.And:return e.And(s);case r.Piecewise:return e.Piecewise(s);case r.BlockVar:return e.BlockVar(t.valueType,s);case r.BroadcastResult:return e.BroadcastResult(t.valueType,s);case r.OrderedPair:return e.OrderedPair(s);case r.OrderedPairAccess:return e.OrderedPairAccess(s);case r.NativeFunction:return e.NativeFunction(t.symbol,t.callData,s);case r.Distribution:return e.Distribution(t.symbol,s);case r.BeginIntegral:return e.BeginIntegral(t.callData,s);case r.EndIntegral:return e.EndIntegral(s);case r.BeginBroadcast:return e.BeginBroadcast(s);case r.EndBroadcast:return e.EndBroadcast(s);case r.BeginLoop:return e.BeginLoop(t.callData,s);case r.EndLoop:return e.EndLoop(s);case r.List:return e.List(s);case r.ListAccess:return e.ListAccess(s);case r.DeferredListAccess:return e.DeferredListAccess(s);case r.InboundsListAccess:return e.InboundsListAccess(s);case r.ExtendSeed:return e.ExtendSeed(t.tag,s);case r.Action:return e.Action(t.symbols,s);default:throw new Error("Unexpected opcode "+t.type)}}});\ndefine(\'core/math/ir/features/convert-to-broadcast\',["require","exports","core/math/errormsg","../opcodes","core/math/types","./list-length","../instructions","../builtin-table","./fuse-broadcast","./is-constant","./as-value","./copy-instruction"],function(require,r,e,t,s,n,a,c,o,i,u,d){"use strict";function g(r,e,a){for(var c=e.args,g=!1,l=[],p=0;p<c.length;p++)if(!a||a[p]){var h=c[p],v=r.getInstruction(h).valueType;s.isList(v)&&-1===l.indexOf(h)&&l.push(h),v===s.EmptyList&&(g=!0)}if(0===l.length)return r.returnIndex;if(e.type===t.Piecewise&&-1==l.indexOf(e.args[0])&&l.indexOf(e.args[1])>=0&&l.indexOf(e.args[2])>=0){var I=o.fuseBroadcast(r,e.args[1]),y=o.fuseBroadcast(r,e.args[2]);return I!==e.args[1]||y!==e.args[2]?d.copyInstructionWithArgs(r,e,[e.args[0],I,y]):r.returnIndex}r.popInstruction();var m=n.minListLengthIndex(r,l);if(void 0===m)throw new Error("Programming Error: expected minListLength to be defined for "+l.length+" lists");var L=m;if(i.isConstant(r.getInstruction(L))&&0===u.asValue(r,L)&&g)return r.ConstantOfType(s.EmptyList,[]);for(var x=r.BeginBroadcast([L]),B=[],E=0,b=l;E<b.length;E++){var w=b[E];B.push(f(r,w,x))}var A=[];for(p=0;p<c.length;p++){h=c[p];if(a&&!a[p])A.push(h);else{var T=l.indexOf(h);A.push(-1===T?h:B[T])}}var O=r.copyInstructionWithArgs(e,A),P=r.EndBroadcast([x,O]);return r.BroadcastResult(s.listType(r.getInstruction(O).valueType),[P])}function f(r,e,s){return r.getInstruction(e).type==t.BroadcastResult?r.DeferredListAccess([e,s]):r.InboundsListAccess([e,s])}Object.defineProperty(r,"__esModule",{value:!0}),r.deferredOrInboundsAccess=r.convertToBroadcast=void 0,r.convertToBroadcast=function(r){if(r.instructionsLength()-1!==r.returnIndex)throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast");var n=r.getInstruction(r.returnIndex);if(a.isLeafInstruction(n))return r.returnIndex;switch(n.type){case t.Add:case t.Subtract:case t.Multiply:case t.Divide:case t.Exponent:case t.RawExponent:case t.Equal:case t.Less:case t.Greater:case t.LessEqual:case t.GreaterEqual:case t.And:case t.OrderedPair:case t.Negative:case t.Piecewise:case t.OrderedPairAccess:return g(r,n);case t.Distribution:return o.fuseBroadcast(r,g(r,n));case t.NativeFunction:var i=c.BuiltInTable[n.symbol];switch(i.tag){case"default":case"trig":case"inverseTrig":case"color":return g(r,n);case"never-broadcast":for(var u=[],d=!1,f=0,l=n.args;f<l.length;f++){var p=l[f],h=o.fuseBroadcast(r,p);h!==p?(d=!0,u.push(h)):u.push(p)}return d?r.copyInstructionWithArgs(n,u):r.returnIndex;case"reducer":if(function(r,e){for(var t=0,n=e;t<n.length;t++){var a=n[t];if(s.isList(r.getInstruction(a).valueType))return!0}return!1}(r,n.args)){if(1===n.args.length){var v=n.args[0],I=o.fuseBroadcast(r,v);return I!==v?r.copyInstructionWithArgs(n,[I]):r.returnIndex}return g(r,n)}r.popInstruction();var y=function(r,e){var t=r.getInstruction(e[0]).valueType;if(!s.hasListType(t))return s.ListOfAny;for(var n=0,a=e;n<a.length;n++){var c=a[n];if(r.getInstruction(c).valueType!==t)return s.ListOfAny}return s.listType(t)}(r,n.args);if(!s.isSubType(y,i.argumentTypes[0]))throw e.functionTypeError(n.callData.errorSymbol,[s.prettyPrint(y)]);var m=r.List(n.args);return r.copyInstructionWithArgs(n,[m]);case"doubleReducer":if(2!==n.args.length)throw new Error("Programming error: double reducers must have two arguments");var L=o.fuseBroadcast(r,n.args[0]),x=o.fuseBroadcast(r,n.args[1]);return L!==n.args[0]||x!==n.args[1]?r.copyInstructionWithArgs(n,[L,x]):r.returnIndex;case"parameterizedReducer":if(2!==n.args.length)throw new Error("Programming error: double reducers must have two arguments");return(L=o.fuseBroadcast(r,n.args[0]))===n.args[0]?g(r,n,[!1,!0]):r.copyInstructionWithArgs(n,[L,n.args[1]]);default:var B=i.tag;throw new Error("Programming Error: unexpected tag "+B)}case t.ListAccess:case t.DeferredListAccess:case t.InboundsListAccess:return g(r,n,[!1,!0]);case t.BeginIntegral:case t.EndIntegral:case t.BeginLoop:case t.EndLoop:return r.returnIndex;case t.List:case t.BlockVar:case t.BeginBroadcast:case t.EndBroadcast:case t.BroadcastResult:case t.ExtendSeed:case t.Action:return r.returnIndex;default:throw new Error("Unexpected opcode "+n.type)}},r.deferredOrInboundsAccess=f});\ndefine(\'core/math/ir/features/to-dot\',["require","exports","../instructions","./print","../opcodes"],function(require,t,n,r,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(t){var i=[];i.push("digraph {");for(var s=0;s<t.instructionsLength();s++){(o=t.getInstruction(s)).type!==e.Noop&&i.push(s+\' [label="\'+s+": "+r.printInstruction(t,s)+\'"];\')}for(s=0;s<t.instructionsLength();s++){var o=t.getInstruction(s);if(n.isInternalInstruction(o))for(var u=0,c=o.args;u<c.length;u++){var p=c[u];i.push(s+" -> "+p+";")}}return i.push("}"),i.join("\\n")}});\ndefine(\'core/math/ir/features/get-dependency-mask\',["require","exports","../instructions"],function(require,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getDependencyMask=void 0,e.getDependencyMask=function(e,n){for(var t=[],s=0;s<e.instructionsLength();s++)t.push(!1);t[n]=!0;for(var i=0;i<=1;i++){var o=!1;for(s=n+1;s<e.instructionsLength();s++){var a=e.getInstruction(s);if(!r.isLeafInstruction(a)&&!t[s]){for(var u=!1,c=0,f=a.args;c<f.length;c++){if(t[f[c]]){u=!0;break}}t[s]=u,u&&r.endsBlock(a)&&!t[a.args[0]]&&(t[a.args[0]]=!0,o=!0)}}if(!o)break}return t}});\ndefine(\'core/math/ir/features/polynomial-order\',["require","exports","../opcodes","core/math/maybe-rational","./get-dependency-mask","../instructions"],function(require,e,r,a,s,t){"use strict";function n(e,r,a){var t=a.allowRestriction,n=a.allowClosedBlockReferences;return{chunk:e,argIndex:r,orderTable:[],mask:s.getDependencyMask(e,r),allowRestriction:t,allowClosedBlockReferences:n}}function c(e,s){var n=e.orderTable[s];if(void 0!==n)return n;var o=function(e,s){var n=e.chunk,o=e.mask,i=e.argIndex,l=e.allowRestriction;if(!e.allowClosedBlockReferences&&n.isInClosedBlock(s))return 1/0;if(s===i)return 1;var u=n.getInstruction(s);if(t.beginsBlock(u)||t.endsBlock(u))return 1/0;switch(u.type){case r.Add:case r.Subtract:case r.Less:case r.LessEqual:case r.Greater:case r.GreaterEqual:var d=u.args,f=d[0],v=d[1];return Math.max(c(e,f),c(e,v));case r.Multiply:var p=u.args;f=p[0],v=p[1];return c(e,f)+c(e,v);case r.Negative:return c(e,u.args[0]);case r.Divide:var g=u.args;f=g[0];return c(e,v=g[1])>0?1/0:c(e,f);case r.Exponent:case r.RawExponent:var y=u.args,k=(f=y[0],v=y[1],n.getInstruction(v));if(0===c(e,f)&&0===c(e,v))return 0;if(k.type===r.Constant){var m=a.asFloat(k.value);return m===Math.round(m)&&m>0?c(e,f)*m:1/0}return 1/0;case r.Piecewise:if(!o[s])return 0;var x=n.getInstruction(u.args[2]);return l&&x.type===r.Constant&&isNaN(a.asFloat(x.value))?c(e,u.args[1]):1/0;case r.LoadArg:case r.Noop:case r.Constant:case r.Equal:case r.And:case r.OrderedPair:case r.OrderedPairAccess:case r.List:case r.ListAccess:case r.DeferredListAccess:case r.InboundsListAccess:case r.NativeFunction:case r.Distribution:case r.BroadcastResult:case r.BlockVar:case r.SymbolicVar:case r.ExtendSeed:case r.Action:return o[s]?1/0:0;default:throw new Error("Unexpected opcode "+u.type)}}(e,s);return e.orderTable[s]=o,o}Object.defineProperty(e,"__esModule",{value:!0}),e.instructionOrder=e.polynomialOrderContext=e.polynomialOrder=void 0,e.polynomialOrder=function(e,r,a){var s=e.argNames.indexOf(r);return-1===s?0:c(n(e,s,a),e.returnIndex)},e.polynomialOrderContext=n,e.instructionOrder=c});\ndefine(\'core/math/ir/features/get-polynomial-coefficients\',["require","exports","../chunk","../opcodes","core/math/maybe-rational","./polynomial-order","../instructions","./copy-instruction"],function(require,e,n,r,t,a,s,o){"use strict";function i(e){var t,a,i=e.chunk,c=e.argIndex;if(i.isInClosedBlock(c))throw new Error("Programming Error: cannot find polynomial coefficients of an instruction in a closed block");c>=0&&c<i.argNames.length?(t=i.argNames.slice(),a=i.argTypes.slice(),t.splice(c,1),a.splice(c,1)):(t=i.argNames,a=i.argTypes);for(var u=new n.Chunk({argNames:t,argTypes:a}),l=[],p=0;p<i.instructionsLength();p++){var d=i.getInstruction(p);if(d.type===r.LoadArg)p<c||c<0?l.push(p):p===c?l.push(u.SymbolicVar(i.argTypes[p])):l.push(p-1);else if(s.isLeafInstruction(d))l.push(o.copyInstruction(u,d));else{for(var f=[],g=0,h=d.args;g<h.length;g++){var y=h[g];f.push(l[y])}l.push(o.copyInstructionWithArgs(u,d,f))}}var m=u.Constant(0),v=u.Constant(1),C=u.Constant(NaN);return{chunk:i,newChunk:u,orderCtx:e,coefficientTable:[],mask:e.mask,valueMap:l,argIndex:c,zero:m,one:v,nan:C}}function c(e,n){var s,o=e.newChunk,i=e.orderCtx,u=e.coefficientTable,l=e.mask,p=e.valueMap,d=e.argIndex,f=e.zero,g=e.one,h=e.nan,y=u[n];if(void 0!==y)return y;for(s=l[n]?n===d?[f,g]:a.instructionOrder(i,n)>2?[h]:function(e,n){var a,s=e.chunk.getInstruction(n),o=e.newChunk;switch(s.type){case r.Add:for(var i=s.args,u=i[0],l=i[1],p=c(e,u),d=c(e,l),f=p.length-1,g=d.length-1,h=[],y=0;y<=Math.max(f,g);y++)f>=y&&g>=y?h.push(o.Add([p[y],d[y]])):h.push(f>g?p[y]:d[y]);return h;case r.Subtract:case r.Less:case r.LessEqual:case r.Greater:case r.GreaterEqual:var m=s.args;u=m[0],l=m[1];s.type!==r.Less&&s.type!=r.LessEqual||(u=(a=[l,u])[0],l=a[1]);p=c(e,u),d=c(e,l),f=p.length-1,g=d.length-1,h=[];for(var v=0;v<=Math.max(f,g);v++)f>=v&&g>=v?h.push(o.Subtract([p[v],d[v]])):h.push(f>g?p[v]:o.Negative([d[v]]));return h;case r.Negative:p=c(e,u=s.args[0]),h=[];for(var C=0;C<p.length;C++)h.push(o.Negative([p[C]]));return h;case r.Multiply:for(var w=s.args,x=(u=w[0],l=w[1],p=c(e,u),d=c(e,l),f=p.length-1,g=d.length-1,h=[],0);x<=f;x++)for(var I=0;I<=g;I++)if(!(x+I>2)){var k=o.Multiply([p[x],d[I]]),E=h[x+I];h[x+I]=void 0===E?k:o.Add([E,k])}return h;case r.Divide:for(var L=s.args,b=(u=L[0],l=L[1],p=c(e,u),d=c(e,l),h=[],0);b<p.length;b++)h.push(o.Divide([p[b],d[0]]));return h;case r.Exponent:case r.RawExponent:var A=s.args;u=A[0],l=A[1],p=c(e,u),d=c(e,l);if(0===(f=p.length-1))return[o.RawExponent([p[0],d[0]])];var M=o.getInstruction(d[0]);switch(t.asFloat(M.value)){case 0:return[o.Constant(0)];case 1:return p;case 2:return[o.Multiply([p[0],p[0]]),o.Multiply([o.Constant(2),o.Multiply([p[0],p[1]])]),o.Multiply([p[1],p[1]])]}case r.Piecewise:return c(e,s.args[1]);case r.Noop:case r.BeginBroadcast:case r.LoadArg:case r.Constant:case r.Equal:case r.And:case r.OrderedPair:case r.OrderedPairAccess:case r.List:case r.ListAccess:case r.DeferredListAccess:case r.InboundsListAccess:case r.NativeFunction:case r.Distribution:case r.BeginIntegral:case r.EndIntegral:case r.BeginLoop:case r.EndLoop:case r.EndBroadcast:case r.BroadcastResult:case r.BlockVar:case r.SymbolicVar:case r.ExtendSeed:case r.Action:throw new Error("Cannot find polynomial coefficients of opcode "+s.type+" that depends on symbol.");default:throw new Error("Unexpected opcode "+s.type)}}(e,n):[p[n]];s.length>1;){var m=o.getInstruction(s[s.length-1]);if(m.type!==r.Constant||0!==t.asFloat(m.value))break;s.pop()}if(0===s.length)throw new Error("Programming Error: coefficients cannot be empty");return u[n]=s,s}Object.defineProperty(e,"__esModule",{value:!0}),e.instructionCoefficients=e.polynomialCoefficientContext=e.getPolynomialCoefficients=void 0,e.getPolynomialCoefficients=function(e,n){var t=e.argNames.indexOf(n),s=i(a.polynomialOrderContext(e,t,{allowRestriction:!0,allowClosedBlockReferences:!1}));if(a.instructionOrder(s.orderCtx,e.returnIndex)>2)throw new Error("Programming Error: cannot compute polynomial coefficients for polynomials of order greater than 2");for(var o=c(s,e.returnIndex),u=!1,l=0;l<e.instructionsLength();l++)e.getInstruction(l).type===r.Piecewise&&s.mask[l]&&(u=!0);return{chunk:s.newChunk,coefficients:o,mappedArgIndex:s.valueMap[t],mappedReturnIndex:s.valueMap[e.returnIndex],isRestrictedPolynomial:u}},e.polynomialCoefficientContext=i,e.instructionCoefficients=c});\ndefine(\'core/math/ir/features/lift-point-operations\',["require","exports","../opcodes","core/math/types","../instructions"],function(require,e,r,s,a){"use strict";function t(e,r){return e.getInstruction(r).valueType===s.Point}function n(e,r){return e.getInstruction(r).valueType===s.Number}Object.defineProperty(e,"__esModule",{value:!0}),e.liftPointOperations=void 0,e.liftPointOperations=function(e){if(e.instructionsLength()-1!==e.returnIndex)throw new Error("Programming Error: only the final instruction in a chunk can be converted to broadcast");var s=e.getInstruction(e.returnIndex);if(a.isLeafInstruction(s))return e.returnIndex;switch(s.type){case r.Add:if(t(e,s.args[0])&&t(e,s.args[1])){var c=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Add([e.OrderedPairAccess([s.args[0],c]),e.OrderedPairAccess([s.args[1],c])]),e.Add([e.OrderedPairAccess([s.args[0],i]),e.OrderedPairAccess([s.args[1],i])])])}return e.returnIndex;case r.Subtract:if(t(e,s.args[0])&&t(e,s.args[1])){c=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Subtract([e.OrderedPairAccess([s.args[0],c]),e.OrderedPairAccess([s.args[1],c])]),e.Subtract([e.OrderedPairAccess([s.args[0],i]),e.OrderedPairAccess([s.args[1],i])])])}return e.returnIndex;case r.Negative:if(t(e,s.args[0])){c=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Negative([e.OrderedPairAccess([s.args[0],c])]),e.Negative([e.OrderedPairAccess([s.args[0],i])])])}return e.returnIndex;case r.Multiply:if(t(e,s.args[0])&&n(e,s.args[1])){c=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([e.OrderedPairAccess([s.args[0],c]),s.args[1]]),e.Multiply([e.OrderedPairAccess([s.args[0],i]),s.args[1]])])}if(n(e,s.args[0])&&t(e,s.args[1])){c=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Multiply([s.args[0],e.OrderedPairAccess([s.args[1],c])]),e.Multiply([s.args[0],e.OrderedPairAccess([s.args[1],i])])])}return e.returnIndex;case r.Divide:if(t(e,s.args[0])&&n(e,s.args[1])){c=e.Constant(1),i=e.Constant(2);return e.OrderedPair([e.Divide([e.OrderedPairAccess([s.args[0],c]),s.args[1]]),e.Divide([e.OrderedPairAccess([s.args[0],i]),s.args[1]])])}return e.returnIndex;case r.Exponent:case r.RawExponent:case r.Equal:case r.Less:case r.Greater:case r.LessEqual:case r.GreaterEqual:case r.And:case r.OrderedPair:case r.Piecewise:case r.OrderedPairAccess:case r.NativeFunction:case r.Distribution:case r.ListAccess:case r.DeferredListAccess:case r.InboundsListAccess:case r.BeginIntegral:case r.EndIntegral:case r.BeginLoop:case r.EndLoop:case r.List:case r.BlockVar:case r.BeginBroadcast:case r.EndBroadcast:case r.BroadcastResult:case r.ExtendSeed:case r.Action:return e.returnIndex;default:throw new Error("Unexpected opcode "+s.type)}}});\ndefine(\'core/math/policy\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.defaultPolicy=void 0;var n=["Sum","Product","Integral","List","Derivative","Piecewise","Exponent","PercentOf","FunctionDefinition","UpdateRule"];e.defaultPolicy={assignmentForbidden:function(e){return!0},graphingEnabled:function(){return!1},isValidSlider:function(e){return!1},sliderVariables:function(e){return[]},ansEnabled:function(){return!1},disabledFeatures:function(){return n},dimensionVarsEnabled:function(){return!1}}});\ndefine(\'core/math/ir/features/substitute\',["require","exports","../instructions","./copy-instruction","../opcodes"],function(require,r,t,n,e){"use strict";function s(r,n){var o=r.chunk,a=r.argMap,u=r.start;if(n<u)return n;var c=a[n-u];if(void 0!==c)return c;var g=i(r,n);r.argMap[n-u]=g;var f=o.getInstruction(n);if(t.beginsBlock(f))switch(f.type){case e.BeginBroadcast:case e.BeginIntegral:break;case e.BeginLoop:for(var p=f.args.length-2,v=0;v<p;v++)s(r,n+1+v);break;default:throw new Error("Programming Error. Unexpected OpCode: "+f.type)}else if(t.endsBlock(f))for(p=f.args.length-1,v=0;v<p;v++)s(r,n+1+v);return g}function i(r,e){var i=r.chunk,o=r.start,a=i.getInstruction(e);if(t.endsBlock(a))for(var u=a.args[0],c=u;c<=e;c++){var g=i.getInstruction(c);if(!t.isLeafInstruction(g))for(var f=0,p=g.args;f<p.length;f++){(h=p[f])<u&&s(r,h)}}if(t.isLeafInstruction(a))return n.copyInstruction(i,a);for(var v=[],d=0,l=a.args;d<l.length;d++){var h=l[d];v.push(s(r,h))}var I=r.argMap[e-o];return void 0!==I?I:n.copyInstructionWithArgs(i,a,v)}Object.defineProperty(r,"__esModule",{value:!0}),r._substituteInstruction=r.substitute=void 0,r.substitute=function(r,t,n,e){return s(function(r,t,n){return{chunk:r,argMap:t,start:n}}(r,[t],n),e)},r._substituteInstruction=i});\ndefine(\'core/math/ir/dependencies\',["require","exports","core/math/builtinframe"],function(require,e,n){"use strict";function r(e,n){return"FunctionDefinition"===n.type&&(n=n._expression),i(e,n,{})}function t(e,n,r){for(var i=[],p=[],f=0,o=n.scopes;f<o.length;f++){for(var d=t(e,o[f],r),u=0,a=d.freeDependencies;u<a.length;u++){var c=a[u];-1===i.indexOf(c)&&-1===n.definitions.indexOf(c)&&i.push(c)}for(var l=0,y=d.updateSymbols;l<y.length;l++){c=y[l];-1===p.indexOf(c)&&p.push(c)}}for(var h=0,g=n.dependencies;h<g.length;h++){for(var v=s(e,g[h],r),D=0,S=v.freeDependencies;D<S.length;D++){c=S[D];-1===i.indexOf(c)&&-1===n.definitions.indexOf(c)&&i.push(c)}for(var m=0,b=v.updateSymbols;m<b.length;m++){c=b[m];-1===p.indexOf(c)&&p.push(c)}}return{freeDependencies:i,updateSymbols:p}}function i(e,n,r){if("Slider"===n.type||"Assignment"===n.type)return i(e,n._expression,r);var s=t(e,n.getScope(),r),p=s.freeDependencies,f=s.updateSymbols,o=n.getUpdateSymbols();if(o.length>0){f=f.slice();for(var d=0,u=o;d<u.length;d++){var a=u[d];-1===f.indexOf(a)&&f.push(a)}}return{freeDependencies:p,updateSymbols:f}}function s(e,r,t){if(t[r])return t[r];if(n[r])return t[r]={freeDependencies:[],updateSymbols:[]},t[r];var s=e[r];return s?(t[r]={freeDependencies:[r],updateSymbols:[]},t[r]=i(e,s,t),t[r]):(t[r]={freeDependencies:[r],updateSymbols:[]},t[r])}Object.defineProperty(e,"__esModule",{value:!0}),e.getCacheKeys=e.analyzeDependencies=e.getFreeDependencies=e.FRAME_SENTINEL=void 0,e.FRAME_SENTINEL={},e.getFreeDependencies=function(e,n){return r(e,n).freeDependencies},e.analyzeDependencies=r,e.getCacheKeys=function(n,r){for(var t={},i=r.getDependencies().slice();i.length;){var s=i.pop();if(!t.hasOwnProperty(s)){var p=n[s];if(p===e.FRAME_SENTINEL)return;t[s]=p,p&&p.getDependencies&&Array.prototype.push.apply(i,p.getDependencies())}}return function(e){var n=[];for(var r in e)n.push([r,e[r]]);return n}(t)}});\ndefine(\'core/math/ir/features/take-derivative\',["require","exports","core/math/builtinframe","tslib","core/math/errormsg","../scope","../instructions","../opcodes","./get-dependency-mask","core/math/policy","core/math/baseparser","../build-ir","./copy-instruction","core/math/types","./substitute","./list-length","../dependencies","core/math/maybe-rational"],function(require,t,e,r,n,a,s,x,i,o,u,c,p,y,l,d,f,g){"use strict";function v(t,e,r){for(var n=t.chunk,a=t.valueMap,i=t.derivativeMap,o=t.backwardMask,u=e;u<=r;u++){var c=n.getInstruction(u);if(o[u]&&s.beginsBlock(c)&&-1!==c.endIndex)switch(c.type){case x.BeginIntegral:u=_(t,u);continue;case x.BeginLoop:case x.BeginBroadcast:u=h(t,u);continue}a.push(m(t,u)),i.push(I(t,u))}return r}function _(t,e){var n=t.chunk,a=t.forwardMask,x=t.valueMap,i=t.derivativeMap,o=t.ZERO,u=n.getInstruction(e),c=u.endIndex,y=n.getInstruction(c),d=o;if(a[u.args[1]]){var f=x[u.args[1]];d=n.Add([d,n.Multiply([i[u.args[1]],l.substitute(n,f,e,y.args[1])])])}if(a[u.args[0]]){f=x[u.args[0]];d=n.Subtract([d,n.Multiply([i[u.args[0]],l.substitute(n,f,e,y.args[1])])])}if(function(t,e,r){var n=t.getInstruction(e),a=t.getInstruction(n.endIndex);if(a.args[1]<e+1)return r[a.args[1]];for(var x=e+1;x<=a.args[1];x++){var i=t.getInstruction(x);if(!s.isLeafInstruction(i))for(var o=0,u=i.args;o<u.length;o++){var c=u[o];if(c<e&&r[c])return!0}}return!1}(n,e,a)){var g=x.slice();g.push(p.copyInstructionWithArgs(n,u,[g[u.args[0]],g[u.args[1]]])),i.push(o),v(r.__assign(r.__assign({},t),{valueMap:g,mustCopy:!0}),e+1,c-1);var _=p.copyInstructionWithArgs(n,y,[g[y.args[0]],i[y.args[1]]]);i.push(_),d=n.Add([d,p.copyInstructionWithArgs(n,n.getInstruction(c+1),[_])])}else for(var h=e;h<=c;h++)i.push(o);if(function(t,e,r){for(var n=t.getInstruction(e),a=e;a<=n.endIndex;a++){var x=t.getInstruction(a);if(!s.isLeafInstruction(x))for(var i=0,o=x.args;i<o.length;i++){var u=o[i];if(r[u]!==u)return!0}}return!1}(n,e,x)){var I=r.__assign(r.__assign({},t),{mustCopy:!0});for(h=e;h<=c+1;h++)x.push(m(I,h))}else for(h=e;h<=c+1;h++)x.push(h);return i.push(d),c+y.args.length-1}function h(t,e){var n=t.chunk,a=t.derivativeMap,s=t.valueMap,i=t.ZERO,o=n.getInstruction(e),u=o.endIndex,c=n.getInstruction(u);if(o.type===x.BeginBroadcast)s.push(p.copyInstructionWithArgs(n,o,o.args)),a.push(i);else{var y=[];y.push(s[o.args[0]],s[o.args[1]]);for(var l=2;l<o.args.length;l++)y.push(s[o.args[l]],a[o.args[l]]);s.push(p.copyInstructionWithArgs(n,o,y)),a.push(i);for(l=2;l<o.args.length;l++)s.push(p.copyInstructionWithArgs(n,n.getInstruction(e+l-1),[s[e]])),a.push(p.copyInstructionWithArgs(n,n.getInstruction(e+l-1),[s[e]]))}v(r.__assign(r.__assign({},t),{mustCopy:!0}),a.length,u-1);var d=[];d.push(s[c.args[0]]);for(l=1;l<c.args.length;l++)d.push(s[c.args[l]],a[c.args[l]]);s.push(p.copyInstructionWithArgs(n,c,d)),a.push(i);for(l=1;l<c.args.length;l++)s.push(p.copyInstructionWithArgs(n,n.getInstruction(u+l),[s[u]])),a.push(p.copyInstructionWithArgs(n,n.getInstruction(u+l),[s[u]]));return u+c.args.length-1}function m(t,e){var r=t.chunk,n=t.valueMap,a=t.mustCopy,x=r.getInstruction(e);if(s.isLeafInstruction(x))return a?p.copyInstruction(r,x):e;for(var i=[],o=!1,u=0,c=x.args;u<c.length;u++){var y=c[u];i.push(n[y]),n[y]!==y&&(o=!0)}return o||a?p.copyInstructionWithArgs(r,x,i):e}function I(t,e){var r=t.chunk,n=t.derivativeVarIndex,a=t.forwardMask,i=t.backwardMask,o=t.valueMap,u=t.derivativeMap,c=t.ZERO,l=t.ONE,f=t.NAN,v=r.getInstruction(e);if(!i[e])return c;if(e===n){if(y.isList(v.valueType)){var _=d.listLengthIndex(r,e),h=r.BeginBroadcast([_]),m=r.EndBroadcast([h,l]);return r.BroadcastResult(y.ListOfNumber,[m])}return l}if(s.beginsBlock(v)||s.endsBlock(v)||v.type===x.BlockVar||v.type===x.BroadcastResult||v.type===x.Equal||v.type===x.Greater||v.type===x.Less||v.type===x.GreaterEqual||v.type===x.LessEqual||v.type===x.And||v.type===x.Distribution||v.type===x.ExtendSeed||v.type===x.Action)return c;if(!a[e]||s.isLeafInstruction(v))return v.valueType!==y.Number?r.Multiply([c,o[e]]):v.type!==x.Constant||isFinite(g.asFloat(v.value))?c:f;if(v.type===x.List||v.type===x.OrderedPair){for(var I=[],b=0,M=v.args;b<M.length;b++){var A=M[b];I.push(u[A])}return p.copyInstructionWithArgs(r,v,I)}if(v.type===x.Piecewise)return p.copyInstructionWithArgs(r,v,[o[v.args[0]],u[v.args[1]],u[v.args[2]]]);for(var q=c,w=[],E=0,N=v.args;E<N.length;E++){var k=N[E];w.push(o[k])}for(var L=0;L<v.args.length;L++)if(a[v.args[L]]){var O=u[v.args[L]];if(O!==c){var T=z(t,v,L,w,O);T!==c&&(q=q===c?T:r.Add([T,q]))}}return q}function z(t,r,n,s,i){var u=t.chunk,y=t.ZERO,l=t.ONE,d=t.NAN;switch(r.type){case x.Add:return i;case x.Subtract:switch(n){case 0:return i;default:return u.Negative([i])}case x.Multiply:switch(n){case 0:return u.Multiply([i,s[1]]);default:return u.Multiply([s[0],i])}case x.Divide:switch(n){case 0:return u.Divide([i,s[1]]);default:return u.Multiply([s[0],u.Divide([u.Negative([i]),u.Multiply([s[1],s[1]])])])}case x.Negative:return u.Negative([i]);case x.Exponent:case x.RawExponent:switch(n){case 0:return u.Multiply([u.Multiply([s[1],u.Exponent([s[0],u.Subtract([s[1],l])])]),i]);default:return u.Multiply([u.Piecewise([u.Equal([s[0],y]),u.Piecewise([u.GreaterEqual([s[1],y]),y,d]),u.Multiply([u.SyntheticNativeFunction("ln",[s[0]]),u.Exponent([s[0],s[1]])])]),i])}case x.NativeFunction:return function(t,r,n,s){for(var x=Object.create(e),i=a.Scope({},-1),u=0;u<n.length;u++){var p=b[u];a.setSymbol(i,p,n[u]),x[p]=f.FRAME_SENTINEL}return a.setSymbol(i,"x_1",s),x.x_1=f.FRAME_SENTINEL,c.addToIR(c.Ctx(o.defaultPolicy,x,t,i,void 0),r)}(u,A[r.symbol][n],s,i);case x.ListAccess:case x.DeferredListAccess:case x.InboundsListAccess:case x.OrderedPairAccess:switch(n){case 0:return p.copyInstructionWithArgs(u,r,[i,s[1]]);default:return y}default:throw new Error("Unimplemented derivative for opcode "+r.type)}}Object.defineProperty(t,"__esModule",{value:!0}),t.takeDerivative=void 0,t.takeDerivative=function(t,e,r){var a=t.getInstruction(e);if(!y.isTypeOrListOfType(a.valueType,y.Number)&&!y.isTypeOrListOfType(a.valueType,y.Point))throw n.derivativeTypeError([y.prettyPrint(a.valueType)]);var o=t.getInstruction(r);if(!y.isTypeOrListOfType(o.valueType,y.Number)&&o.type!==x.Noop)throw n.parseError();var u=t.Constant(0);if(e<r)return u;for(var c=t.Constant(1),p=t.Constant(NaN),l=i.getDependencyMask(t,r),d=function(t,e){for(var r=[],n=0;n<e;n++)r.push(!1);r.push(!0);for(n=e;n>=0;n--)if(r[n]){var a=t.getInstruction(n);if(!s.isLeafInstruction(a))if(a.type===x.Piecewise)r[a.args[1]]=!0,r[a.args[2]]=!0;else for(var i=0,o=a.args;i<o.length;i++){r[o[i]]=!0}}return r}(t,e),f=[],g=[],_=0;_<r;_++)g.push(_),f.push(u);return v({chunk:t,derivativeVarIndex:r,forwardMask:l,backwardMask:d,valueMap:g,derivativeMap:f,mustCopy:!1,ZERO:u,ONE:c,NAN:p},r,e),f[e]};var b=["x","y","z","u"],M={exp:["\\\\exp(x)*x_1"],ln:["\\\\{x >= 0: x_1/x \\\\}"],log:["\\\\{x >= 0: x_1/(x*\\\\ln(10)) \\\\}"],sqrt:["x_1/(2*\\\\sqrt{x})"],rtxsqpone:["x*x_1/\\\\rtxsqpone(x)"],rtxsqmone:["x*x_1/\\\\rtxsqmone(x)"],sin:["\\\\cos(x)*x_1"],cos:["-\\\\sin(x)*x_1"],tan:["\\\\sec(x)^2*x_1"],arcsin:["x_1/\\\\sqrt{1 - x^2}"],arccos:["-x_1/\\\\sqrt{1 - x^2}"],sinh:["\\\\cosh(x)*x_1"],cosh:["\\\\sinh(x)*x_1"],tanh:["(\\\\sech(x))^2*x_1"],arcsinh:["x_1/\\\\sqrt{x^2 + 1}"],arccosh:["\\\\{ x > 0: x_1/\\\\rtxsqmone(x) \\\\}"],arctanh:["\\\\{ \\\\abs(x) < 1: x_1/(1 - x^2) \\\\}"],csc:["-\\\\cot(x)*\\\\csc(x)*x_1"],sec:["\\\\tan(x)*\\\\sec(x)*x_1"],cot:["-\\\\csc(x)^2*x_1"],arccsc:["-x_1/(\\\\abs(x)*\\\\rtxsqmone(x))"],arcsec:["x_1/(\\\\abs(x)*\\\\rtxsqmone(x))"],arccot:["-x_1/(1+x^2)"],csch:["-\\\\coth(x)*\\\\csch(x)*x_1"],sech:["-\\\\tanh(x)*\\\\sech(x)*x_1"],coth:["-(\\\\csch(x))^2*x_1"],arccsch:["-x_1/(\\\\abs(x)*\\\\rtxsqpone(x))"],arcsech:["\\\\{ x >= 0: -x_1/(x*\\\\sqrt{1 - x^2}) \\\\}"],arccoth:["\\\\{ \\\\abs(x) > 1 : x_1/(1 - x^2) \\\\}"],factorial:["(x)!*\\\\polyGamma(0, x + 1)*x_1"],floor:["\\\\{ \\\\mod(x, 1) > 0: 0*x_1 \\\\}"],ceil:["\\\\{ \\\\mod(x, 1) > 0: 0*x_1 \\\\}"],round:["\\\\{ \\\\abs(\\\\mod(x, 1) - 0.5) > 0: 0*x_1 \\\\}"],abs:["\\\\{ \\\\abs(x) > 0: \\\\sign(x)*x_1 \\\\}"],sign:["\\\\{ \\\\abs(x) > 0: 0*x_1 \\\\}"],distance:["-((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/\\\\distance(x,y)","((y.x-x.x)*x_1.x+(y.y-x.y)*x_1.y)/\\\\distance(x,y)"],mean:["\\\\mean(x_1)"],total:["\\\\total(x_1)"],length:["0"],var:["2*\\\\cov(x, x_1)"],varp:["2*\\\\cov(x, x_1)*(\\\\length(x)-1)/\\\\length(x)"],stdev:["\\\\cov(x, x_1)/\\\\stdev(x)"],stdevp:["\\\\covp(x, x_1)/\\\\stdevp(x)"],mad:["\\\\mean(\\\\sign(x-\\\\mean(x))*(x_1 - \\\\mean(x_1)))"],min:["x_1[\\\\argmin(x)]"],max:["x_1[\\\\argmax(x)]"],median:["0.5*(x_1[\\\\lowerQuantileIndex(x, 0.5)] + x_1[\\\\upperQuantileIndex(x, 0.5)])"],argmin:["0/0"],argmax:["0/0"],gcd:["0/0"],lcm:["0/0"],erf:["\\\\frac{2x_1}{\\\\sqrt{\\\\pi }}e^{-x^2}"],invNorm:["\\\\frac{x_1}{\\\\pdf(\\\\normaldist(0,1),\\\\invNorm(x))}"],logbase:["\\\\{x > 0: \\\\frac{x_1}{x*\\\\ln(y)} \\\\}","\\\\frac{-\\\\log_{y}(x)*x_1}{y*\\\\ln(y)}"],nthroot:["x^{1/y - 1}/y*x_1","-\\\\frac{x^{1/y}*\\\\ln(x)*x_1}{y^2}"],hypot:["x_1*x/\\\\hypot(x,y)","x_1*y/\\\\hypot(x,y)"],polyGamma:["0/0","\\\\polyGamma(1 + x, y)*x_1"],mod:["\\\\{ \\\\abs(\\\\mod(x, y)) > 0: x_1 \\\\}","\\\\{ \\\\mod(x/y, 1) > 0: -\\\\floor(x/y)*x_1 \\\\}"],cov:["\\\\cov(x_1, y)","\\\\cov(x, x_1)"],covp:["\\\\covp(x_1, y)","\\\\covp(x, x_1)"],corr:["(\\\\cov(x_1, y) - (\\\\cov(x, y)*\\\\cov(x, x_1)/\\\\var(x)))/(\\\\stdevp(x)\\\\stdevp(y))","(\\\\cov(x, x_1) - (\\\\cov(x, y)*\\\\cov(y, x_1)/\\\\var(y)))/(\\\\stdevp(x)\\\\stdevp(y))"],spearman:["0/0","0/0"],quantile:["\\\\{ \\\\floor(y*(\\\\length(x)-1)) = y*(\\\\length(x)-1) :   x_1[\\\\upperQuantileIndex(x, y)],  (\\\\ceil(y*(\\\\length(x)-1)) - y*(\\\\length(x)-1))*x_1[\\\\lowerQuantileIndex(x, y)] +   (y*(\\\\length(x)-1) - \\\\floor(y*(\\\\length(x)-1)))*x_1[\\\\upperQuantileIndex(x, y)]\\\\}","\\\\{ \\\\floor(y*(\\\\length(x)-1)) < y*(\\\\length(x)-1) :   (x[\\\\upperQuantileIndex(x, y)] - x[\\\\lowerQuantileIndex(x, y)])*x_1\\\\}"],quartile:["0.5*(x_1[\\\\lowerQuartileIndex(x, y)] + x_1[\\\\upperQuartileIndex(x, y)])","0/0"],tscore:["\\\\frac{\\\\sqrt{\\\\length(x)}(\\\\stdev(x)*\\\\mean(x_1)-(\\\\mean(x)-y)*\\\\frac{\\\\cov(x,x_1)}{\\\\stdev(x)})}{\\\\stdev(x)^2}","-x_1*\\\\sqrt{\\\\length(x)}/\\\\stdev(x)"],quartileIndex:["0/0","0/0"],upperQuartileIndex:["0/0","0/0"],lowerQuartileIndex:["0/0","0/0"],upperQuantileIndex:["0/0","0/0"],lowerQuantileIndex:["0/0","0/0"],nCr:["0/0","0/0"],nPr:["0/0","0/0"],arctan:["x_1*y/(y^2+x^2)","-x_1*x/(y^2+x^2)"],poissonpdf:["0/0","x_1\\\\frac{e^{-y}(\\\\floor(x)-y)y^{(\\\\floor(x)-1)}}{(\\\\floor(x))!}"],invPoisson:["0/0","0/0"],tpdf:["x_1*\\\\pdf(\\\\tdist(y),x)*\\\\frac{-(y+1)*x}{y+x^2}","x_1*\\\\frac{1}{2}\\\\pdf(\\\\tdist(y),x)(  \\\\frac{x^2-1}{y + x^2} + \\\\ln(\\\\frac{y}{y + x^2}) +   \\\\polyGamma(0, \\\\frac{1+y}{2}) - \\\\polyGamma(0, y/2))"],invT:["x_1/\\\\pdf(\\\\tdist(y),\\\\invT(x, y))","0/0"],tcdf:["-x_1*\\\\pdf(\\\\tdist(z),x)","x_1*\\\\pdf(\\\\tdist(z),y)","0/0"],poissoncdf:["0/0","0/0","x_1\\\\sum _{n=\\\\max(0,\\\\floor(\\\\min(x,y)))}^{\\\\floor(\\\\max(x,y))}\\\\frac{e^{-z}(n-z)z^{(n-1)}}{n!}"],normalpdf:["-x_1*\\\\frac{x-y}{z^2} \\\\pdf(\\\\normaldist(y,z),x)","x_1*\\\\frac{x-y}{z^2} \\\\pdf(\\\\normaldist(y,z),x)","x_1*(\\\\frac{(x-y-z)*(x-y+z)}{z^3}) \\\\pdf(\\\\normaldist(y,z),x)"],binompdf:["0/0","0/0","\\\\{0<=z<=1: x_1*\\\\pdf(\\\\binomialdist(y,z),x)*(\\\\frac{\\\\round(x)}{z}-\\\\frac{\\\\round(y)-\\\\round(x)}{1-z}), 0 \\\\}"],invBinom:["0/0","0/0","0/0"],uniformpdf:["0","\\\\{y<=x: \\\\frac{x_1}{(z-y)^2}, 0\\\\}","\\\\{z>=x: -\\\\frac{x_1}{(z-y)^2}, 0\\\\}"],invUniform:["\\\\{y<=x<=z: x_1*(z-y), 0\\\\}","\\\\{y<=x<=z: x_1*(1-x), 0\\\\}","\\\\{y<=x<=z: x_1*x, 0\\\\}"],normalcdf:["-x_1\\\\pdf(\\\\normaldist(z,u), x)","x_1\\\\pdf(\\\\normaldist(z,u), y)","-x_1*(\\\\pdf(\\\\normaldist(z,u), y) - \\\\pdf(\\\\normaldist(z,u), x))","x_1*(  \\\\{\\\\abs(y)=1/0:0,\\\\frac{z-y}{u}\\\\pdf(\\\\normaldist(z,u),y)\\\\} -   \\\\{\\\\abs(x)=1/0:0,\\\\frac{z-x}{u}\\\\pdf(\\\\normaldist(z,u),x)\\\\})"],binomcdf:["0/0","0/0","0/0","\\\\{0<=u<=1: x_1*\\\\sum _{n=\\\\max(0,\\\\round(\\\\min(x,y)))}^{\\\\round(\\\\max(x,y))}(  \\\\pdf(\\\\binomialdist(z,u),n)*(\\\\frac{n}{u}-\\\\frac{\\\\round(z)-n}{1-u})), 0 \\\\}"],uniformcdf:["\\\\{z>u: 0/0, -x_1\\\\pdf(\\\\uniformdist(z,u), x)\\\\}","\\\\{z>u: 0/0, x_1\\\\pdf(\\\\uniformdist(z,u), y)\\\\}","\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:u-x,0\\\\} + \\\\{z<y<u:y-u,0\\\\}}{(u-z)^2})\\\\}","\\\\{z>u: 0/0, x_1*(\\\\frac{\\\\{z<x<u:x-z,0\\\\} + \\\\{z<y<u:z-y,0\\\\}}{(u-z)^2})\\\\}"],normalSample:["0/0","0/0","0/0"],uniformSample:["0/0","0/0","0/0"],tSample:["0/0","0/0"],poissonSample:["0/0","0/0"],binomSample:["0/0","0/0","0/0"],rgb:["0/0","0/0","0/0"],hsv:["0/0","0/0","0/0"],polygon:["\\\\polygon(x_1)"],validateRangeLength:["0","0","0","\\\\{\\\\validateRangeLength(x,y,z,u) \\\\ge 1: x_1, 0\\\\}"],validateSampleCount:["\\\\{x<0:0,1\\\\}*x_1"],select:["\\\\select(x_1, y)","0*\\\\select(x,y)"],shuffle:["0*y","\\\\shuffle(x, x_1)"],sortPerm:["0*x"],elementsAt:["\\\\elementsAt(x_1, y)","0*\\\\elementsAt(x,y)"],uniquePerm:["0*\\\\uniquePerm(x)"]},A={};for(var q in M){for(var w=q,E=M[w],N=[],k=0;k<E.length;k++){var L=E[k];N.push(u.parse(L,{}))}A[w]=N}});\ndefine(\'core/math/ir/features/bound-domain\',["require","exports","core/math/domaintypes","core/math/types","core/math/maybe-rational","../opcodes","./polynomial-order","./get-polynomial-coefficients","../instructions","./is-constant","./as-value"],function(require,e,a,n,t,r,s,i,o,c,u){"use strict";function l(e,m){var f=e.domainTable,d=f[m];if(void 0!==d)return d;var v=function(e,m){var f=e.chunk,d=e.mask,v=e.orderCtx,p=f.getInstruction(m);if(o.isLeafInstruction(p)){if(p.type===r.Constant)if(p.valueType==n.Number){if(isNaN(t.asFloat(p.value)))return a.emptyDomain()}else if(p.valueType===n.ListOfNumber)for(var y=0,g=p.value;y<g.length;y++){var D=g[y];if(isNaN(t.asFloat(D)))return a.unknownDomain()}return a.allReals()}switch(p.type){case r.And:case r.Add:case r.Subtract:case r.Multiply:case r.Divide:case r.Exponent:case r.RawExponent:case r.Negative:case r.BlockVar:case r.BroadcastResult:case r.OrderedPair:case r.OrderedPairAccess:case r.NativeFunction:case r.Distribution:case r.BeginIntegral:case r.EndIntegral:case r.BeginBroadcast:case r.EndBroadcast:case r.BeginLoop:case r.EndLoop:case r.ListAccess:case r.DeferredListAccess:case r.InboundsListAccess:case r.ExtendSeed:case r.Action:for(var k=a.allReals(),b=0,N=p.args;b<N.length;b++){var w=N[b];k=a.intersectDomains(k,l(e,w))}return k;case r.List:if(!d[m])return a.allReals();var C=l(e,p.args[0]);if("known"!==C.type)return a.unknownDomain();for(var h=1;h<p.args.length;h++){if("known"!==(k=l(e,p.args[h])).type)return a.unknownDomain();if(k.bounds[0]!==C.bounds[0]||k.bounds[1]!==C.bounds[1])return a.unknownDomain()}return C;case r.Equal:return d[m]?a.unknownDomain():a.allReals();case r.Piecewise:var x=f.getInstruction(p.args[2]);return x.type===r.Constant&&x.valueType===n.Number&&isNaN(t.asFloat(x.value))?a.intersectDomains(l(e,p.args[0]),l(e,p.args[1])):a.unknownDomain();case r.Less:case r.Greater:case r.LessEqual:case r.GreaterEqual:if(!d[m])return a.allReals();if(s.instructionOrder(v,m)>1)return a.unknownDomain();var E=e.coefficientCtx;void 0===E&&(E=i.polynomialCoefficientContext(v),e.coefficientCtx=E);var L=E.newChunk,R=i.instructionCoefficients(E,m),B=R[0],I=R[1];if(!c.isConstant(L.getInstruction(B)))return a.unknownDomain();var A=u.asValue(L,B);if(isNaN(A))return a.emptyDomain();for(var O=a.allReals(),q=0,T=p.args;q<T.length;q++){w=T[q];O=a.intersectDomains(O,l(e,w))}if(void 0===I)return p.type===r.LessEqual||p.type===r.GreaterEqual?A>=0?O:a.emptyDomain():A>0?O:a.emptyDomain();var F=u.asValue(L,I);return a.intersectDomains(O,a.linearPositiveDomain(A,F))}}(e,m);return f[m]=v,v}Object.defineProperty(e,"__esModule",{value:!0}),e.boundDomain=void 0,e.boundDomain=function(e,i,o){var c=e.argNames.indexOf(i);if(-1===c){var u=e.getInstruction(o);return u.type===r.Constant&&u.valueType===n.Number&&isNaN(t.asFloat(u.value))?a.emptyDomain():a.allReals()}return l(function(e){var a=e.chunk,n=e.mask;return{chunk:a,mask:n,orderCtx:e,domainTable:[]}}(s.polynomialOrderContext(e,c,{allowRestriction:!0,allowClosedBlockReferences:!1})),o)}});\ndefine(\'core/math/ir/features/find-linear-subset\',["require","exports","../opcodes","core/math/types","../instructions"],function(require,e,r,s,a){"use strict";function t(e,r,s){var t=e.getInstruction(s),n=function(e){for(var r=[],s=0;s<e;s++)r.push(!1);return r}(e.argNames.length);if(a.isLeafInstruction(t))return n;for(var c=0,u=t.args;c<u.length;c++)for(var o=r[u[c]],i=0;i<o.length;i++)n[i]=n[i]||o[i];return n}function n(e,s,t,n){var u=e.getInstruction(n);if(a.isLeafInstruction(u))return c(e.argNames.length);switch(u.type){case r.Add:case r.Subtract:case r.Negative:case r.List:for(var o=c(e.argNames.length),i=0;i<u.args.length;i++)for(var g=t[u.args[i]],d=0;d<g.length;d++)o[d]=o[d]&&g[d];return o;case r.Divide:for(var f=[],h=t[u.args[0]],l=s[u.args[1]],p=0;p<h.length;p++)f.push(h[p]&&!l[p]);return f;case r.Multiply:for(var v=t[u.args[0]].slice(),L=t[u.args[1]].slice(),E=s[u.args[0]],I=s[u.args[1]],N=0,m=0,b=0;b<v.length;b++){var x=v[b]&&!I[b],A=L[b]&&!E[b];v[b]=x,L[b]=A,x&&(N+=1),A&&(m+=1)}return N>=m?v:L;case r.Piecewise:var B=s[u.args[0]],y=t[u.args[1]],w=t[u.args[2]],q=[];for(n=0;n<B.length;n++)q.push(!B[n]&&y[n]&&w[n]);return q;case r.ListAccess:case r.DeferredListAccess:case r.InboundsListAccess:var P=t[u.args[0]],S=s[u.args[1]],D=[];for(n=0;n<S.length;n++)D.push(P[n]&&!S[n]);return D;case r.BroadcastResult:var O=u.args[0],G=n-O;return t[e.getInstruction(O).args[G]];case r.OrderedPair:case r.OrderedPairAccess:case r.Exponent:case r.RawExponent:case r.Less:case r.LessEqual:case r.Greater:case r.GreaterEqual:case r.Equal:case r.And:case r.NativeFunction:case r.Distribution:case r.BeginIntegral:case r.EndIntegral:case r.BeginLoop:case r.EndLoop:case r.BeginBroadcast:case r.EndBroadcast:case r.BlockVar:case r.ExtendSeed:case r.Action:for(var M=[],R=0,_=s[n];R<_.length;R++){var j=_[R];M.push(!j)}return M;default:throw new Error("Unexpected opcode "+u.type)}}function c(e){for(var r=[],s=0;s<e;s++)r.push(!0);return r}Object.defineProperty(e,"__esModule",{value:!0}),e.findLinearSubset=void 0,e.findLinearSubset=function(e){for(var r=[],a=[],c=0;c<e.argNames.length;c++){for(var u=[],o=[],i=0;i<e.argNames.length;i++)u.push(e.argTypes[i]===s.Number),o.push(c===i);a.push(o),r.push(u)}for(c=e.argNames.length;c<=e.returnIndex;c++)a.push(t(e,a,c)),r.push(n(e,a,r,c));return r[e.returnIndex]}});\ndefine(\'core/math/ir/features/derive-regression-restrictions\',["require","exports","../opcodes","core/math/types","../instructions","./is-constant","./as-value","./polynomial-order","./get-polynomial-coefficients","core/math/domaintypes","./list-length"],function(require,n,e,t,i,o,r,s,a,u,c){"use strict";function l(n,e,t,i,o,r){if("known"!==e.type)return t;if(e.bounds[0]===-1/0&&e.bounds[1]===1/0)return t;var s=n.And([n.LessEqual([n.Constant(e.bounds[0]),i]),n.LessEqual([i,n.Constant(e.bounds[1])])]);return n.Multiply([t,n.Piecewise([s,o,r])])}function f(n,e){for(var t=[],i=0;i<n.argNames.length;i++)t.push(i);var o=[];for(i=0;i<=e;i++)o.push(p(n,t,o,i));return o[e]}function g(n){return n.type===e.NativeFunction&&("sin"===n.symbol||"cos"===n.symbol)}function v(n){for(var e=1/0,t=-1/0,i=n.length,o=0,r=n;o<r.length;o++){var s=r[o];e=Math.min(e,s),t=Math.max(t,s)}return{min:e,max:t,length:i}}function p(n,e,t,o){for(var r=n.getInstruction(o),s=function(n){for(var e=[],t=0;t<n;t++)e.push(!1);return e}(e.length),a=0;a<e.length;a++)if(e[a]===o)return s[a]=!0,s;if(i.isLeafInstruction(r))return s;for(var u=0,c=r.args;u<c.length;u++)for(var l=t[c[u]],f=0;f<l.length;f++)s[f]=s[f]||l[f];return s}Object.defineProperty(n,"__esModule",{value:!0}),n.deriveRegressionRestrictions=void 0,n.deriveRegressionRestrictions=function(n){var i=n.getInstruction(n.returnIndex);if(i.type!==e.BroadcastResult)return n;var h=i.args[0],d=n.returnIndex-h,m=n.getInstruction(h),C=m.args[0],y=m.args[d],w=[],x=[];w.push(C);var I=c.assertConstantListLength(n,n.returnIndex,"Programming error: cannot optimize regression on non-constant-length list");x.push({min:1,max:I,length:I});for(var k=!1,R=!1,b=C+1;b<=y;b++){if((W=n.getInstruction(b)).type===e.ListAccess||W.type===e.InboundsListAccess||W.type===e.DeferredListAccess){if(W.args[1]!==C)continue;var L=W.args[0];if(n.getInstruction(L).valueType!==t.ListOfNumber)continue;if(!o.isConstant(n.getInstruction(L)))continue;var D=v(r.asValue(n,L));if(!isFinite(D.min)||!isFinite(D.max))continue;w.push(b),x.push(D)}else g(W)?k=!0:W.type!==e.Exponent&&W.type!==e.RawExponent||(R=!0)}if(0===w.length)return n;if(!R&&!k)return n;var O=[],P=[];for(b=0;b<n.argNames.length;b++)P.push(b),O.push(u.allReals());var N=[],B=[];for(b=0;b<=y;b++)N.push(p(n,P,N,b)),B.push(p(n,w,B,b));for(b=0;b<=y;b++){if((W=n.getInstruction(b)).type===e.Piecewise)for(var E=N[b],F=0;F<E.length;F++)E[F]&&(O[F]=u.unknownDomain());else if(W.type===e.Exponent||W.type===e.RawExponent){var M=!1,V=!1;for(F=0;F<w.length;F++)B[W.args[0]][F]&&(M=!0),B[W.args[1]][F]&&(V=!0);if(M)continue;if(!V)continue;E=N[W.args[0]];var A=0,q=void 0;for(F=0;F<E.length;F++)E[F]&&(q=F,A+=1);if(1!==A)continue;if(void 0===q)continue;var _=P[q],j=s.polynomialOrderContext(n.copy().reopenFinalBlock(),_,{allowRestriction:!1,allowClosedBlockReferences:!1});if(1!==s.instructionOrder(j,W.args[0]))continue;var z=a.polynomialCoefficientContext(j),T=a.instructionCoefficients(z,W.args[0]),G=T[0];if(void 0===(en=T[1]))continue;var H=r.asValue(z.newChunk,en),J=r.asValue(z.newChunk,G);O[q]=u.intersectDomains(O[q],u.linearPositiveDomain(J,H))}}if(k)for(var K=n.copy().reopenFinalBlock(),Q=0;Q<w.length;Q++){var S=s.polynomialOrderContext(K,w[Q],{allowRestriction:!1,allowClosedBlockReferences:!1}),U=a.polynomialCoefficientContext(S);for(b=C+1;b<=y;b++){var W;if(g(W=K.getInstruction(b))){var X=W.args[0];if(1!==s.instructionOrder(S,X))continue;var Y=a.instructionCoefficients(U,X)[1];if(void 0===Y)continue;var Z=f(U.newChunk,Y),$=(q=void 0,0);for(F=0;F<Z.length;F++)Z[F]&&(q=F,$+=1);if(1!==$)continue;if(void 0===q)continue;var nn=s.polynomialOrderContext(U.newChunk,q,{allowRestriction:!1,allowClosedBlockReferences:!1});if(1!==s.instructionOrder(nn,Y))continue;var en,tn=a.polynomialCoefficientContext(nn),on=a.instructionCoefficients(tn,Y);G=on[0];if(void 0===(en=on[1])||!o.isConstant(tn.newChunk.getInstruction(G))||!o.isConstant(tn.newChunk.getInstruction(en)))continue;J=r.asValue(tn.newChunk,G),H=r.asValue(tn.newChunk,en);var rn=(x[Q].max-x[Q].min)/Math.min(x[Q].length-1,31),sn=Math.PI/rn;if(!isFinite(sn))continue;if(sn<=0)continue;O[q]=u.intersectDomains(O[q],u.linearPositiveDomain(J,H)),O[q]=u.intersectDomains(O[q],u.linearPositiveDomain(sn-J,-H))}}}for(var an=!1,un=0,cn=O;un<cn.length;un++){var ln=cn[un];if("known"!==ln.type)return n;ln.bounds[0]===-1/0&&ln.bounds[1]===1/0||(an=!0)}if(!an)return n;var fn=n.copy(),gn=n.returnIndex,vn=fn.Constant(1),pn=fn.Constant(NaN);for(F=0;F<fn.argNames.length;F++)gn=l(fn,O[F],gn,F,vn,pn);return fn.close(),fn}});\ndefine(\'core/math/ir/chunk\',["require","exports","core/math/errormsg","core/math/types","core/math/maybe-rational","core/math/functions","./opcodes","./builtin-table","./features/constant-collapse","./features/type-check","./features/emit-js","./features/get-value-type","./features/is-constant","./features/list-length","./features/drop-unreferenced-instructions","./features/convert-to-broadcast","./features/print","./features/to-dot","./features/fuse-broadcast","./features/polynomial-order","./features/get-polynomial-coefficients","./features/copy-instruction","./features/lift-point-operations","./features/element-at","./features/take-derivative","./features/bound-domain","./features/find-linear-subset","./features/derive-regression-restrictions","./features/as-value","./features/depends-on-outer-variable","./features/nan-of-type","./features/find-dependency-symbols"],function(require,t,e,n,r,s,i,o,u,a,p,c,h,y,l,g,f,d,v,I,T,m,b,L,x,k,V,C,A,B,N,D){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Chunk=void 0;var E=1e4,S=function(){function t(t){if(this.instructions=[],this.blockMask=[],this.comments=[],t.argNames.length!==t.argTypes.length)throw new Error("Programming Error: length of argNames must match length of argTypes");this.argNames=t.argNames,this.argTypes=t.argTypes;for(var e=0;e<this.argTypes.length;e++){var n=this.argTypes[e];this.LoadArg(n)}this.returnIndex=-1}return t.prototype.addComments=function(t){for(var e in t){var n=this.comments[e]||"";this.comments[e]=n+t[e]}return this},t.prototype.instructionsLength=function(){return this.instructions.length},t.prototype.getInstruction=function(t){return this.instructions[t]},t.prototype.popInstruction=function(){return this.instructions.pop()},t.prototype.truncate=function(t){this.instructions.length=t,this.blockMask.length=t,this.comments.length=t},t.prototype.pushInstructionChecked=function(t){if(this.instructions.length>=32768)throw e.deeplyNested();this.instructions.push(t),this.returnIndex=this.instructions.length-1},t.prototype.pushLeafInstruction=function(t){return this.pushInstructionChecked(t),this.returnIndex},t.prototype.pushInstruction=function(t){return this.checkInstructionArguments(t),this.pushInstructionChecked(t),this.returnIndex=g.convertToBroadcast(this),this.returnIndex=b.liftPointOperations(this),a.typeCheck(this,this.returnIndex),this.returnIndex=u.constantCollapse(this),this.returnIndex},t.prototype.checkInstructionArguments=function(t){for(var e=0,n=t.args;e<n.length;e++){var r=n[e];if(this.blockMask[r])throw new Error("Programming Error: cannot reference an instruction in a closed block")}},t.prototype.markClosedBlock=function(t,e){for(var n=t;n<e;n++)this.blockMask[n]=!0},t.prototype.LoadArg=function(t){return this.pushLeafInstruction({type:i.LoadArg,valueType:t})},t.prototype.BlockVar=function(t,e){return this.pushInstruction({type:i.BlockVar,valueType:t,args:e})},t.prototype.SymbolicVar=function(t,e){return this.pushLeafInstruction({type:i.SymbolicVar,valueType:t,symbol:e})},t.prototype.BroadcastResult=function(t,e){var n=e[0],r=this.instructions[n],s=r.args[0],o=this.instructions.length-n,u=r.args[o],a=!B.dependsOnOuterVariable(this,u,s),p=this.getInstruction(s).args[0],c=this.getInstruction(p);return this.pushInstruction({type:i.BroadcastResult,valueType:t,args:e,isConstantBroadcast:a,constantLength:h.isConstant(c)?A.asValue(this,p):void 0})},t.prototype.Constant=function(t){return this.ConstantOfType(n.Number,t)},t.prototype.ConstantOfType=function(t,s){if("number"==typeof s&&(s=r.maybeRational(s,1)),n.isList(t)&&s.length>E)throw e.maxListSize(E.toLocaleString());return this.pushLeafInstruction({type:i.Constant,valueType:t,value:s})},t.prototype.NanOfType=function(t){if(t===n.Distribution){var e=this.Constant(NaN);return this.Distribution("uniformdist",[e,e])}return this.ConstantOfType(t,N.nanOfType(t))},t.prototype.Add=function(t){var e=i.Add,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Subtract=function(t){var e=i.Subtract,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Multiply=function(t){var e=i.Multiply,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Divide=function(t){var e=i.Divide,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Exponent=function(t){var e=i.Exponent,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.RawExponent=function(t){var e=i.RawExponent,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Negative=function(t){var e=i.Negative,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Equal=function(t){var e=i.Equal,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Less=function(t){var e=i.Less,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Greater=function(t){var e=i.Greater,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.LessEqual=function(t){var e=i.LessEqual,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.GreaterEqual=function(t){var e=i.GreaterEqual,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.And=function(t){var e=i.And,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.Piecewise=function(t){var e=i.Piecewise,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.OrderedPair=function(t){var e=i.OrderedPair,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.OrderedPairAccess=function(t){var e=i.OrderedPairAccess,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.List=function(t){var n=i.List,r=c.getValueType(this,n,t);if(t.length>E)throw e.maxListSize(E.toLocaleString());return this.pushInstruction({type:n,valueType:r,args:t})},t.prototype.ListAccess=function(t){var e=i.ListAccess,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.DeferredListAccess=function(t){var e=i.DeferredListAccess,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.InboundsListAccess=function(t){var e=i.InboundsListAccess,n=c.getValueType(this,e,t);return this.pushInstruction({type:e,valueType:n,args:t})},t.prototype.NativeFunction=function(t,e,n){var r=this,s=i.NativeFunction,u=o.BuiltInTable[t].returnType,a="function"==typeof u?u(n.map(function(t){return r.getInstruction(t).valueType})):u;return this.pushInstruction({type:s,valueType:a,args:n,symbol:t,callData:e})},t.prototype.SyntheticNativeFunction=function(t,e){var n=this,r=i.NativeFunction,s=o.BuiltInTable[t].returnType,u="function"==typeof s?s(e.map(function(t){return n.getInstruction(t).valueType})):s,a={errorSymbol:t,providedArity:e.length,isDotCall:!1};return this.pushInstruction({type:r,valueType:u,args:e,symbol:t,callData:a})},t.prototype.Distribution=function(t,e){var r=i.Distribution,s=n.Distribution;return this.pushInstruction({type:r,valueType:s,args:e,symbol:t})},t.prototype.BeginIntegral=function(t,e){var n=i.BeginIntegral,r=c.getValueType(this,n,[]);return this.pushInstruction({type:n,valueType:r,args:e,endIndex:-1,callData:t})},t.prototype.EndIntegral=function(t){var e=i.EndIntegral,n=c.getValueType(this,e,t),r=t[0],s=this.getInstruction(r);this.instructions[r]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};var o=this.pushInstruction({type:e,valueType:n,args:t});return this.markClosedBlock(r,o),o},t.prototype.BeginBroadcast=function(t,n){var r=i.BeginBroadcast,s=c.getValueType(this,r,[]),o=this.getInstruction(t[0]);if(h.isConstant(o)&&A.asValue(this,t[0])>E)throw e.maxListSize(E.toLocaleString());return this.pushInstruction({type:r,valueType:s,endIndex:-1,args:t,listComprehensionCallData:n})},t.prototype.EndBroadcast=function(t){var e=i.EndBroadcast,n=c.getValueType(this,e,t),r=t[0],s=this.getInstruction(r),o={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength()};this.instructions[r]=o;var u=this.pushInstruction({type:e,valueType:n,args:t});return this.markClosedBlock(r,u),u},t.prototype.BeginLoop=function(t,e){var n=i.BeginLoop,r=c.getValueType(this,n,e);return this.pushInstruction({type:n,valueType:r,args:e,endIndex:-1,callData:t})},t.prototype.EndLoop=function(t){var e=i.EndLoop,n=c.getValueType(this,e,t),r=t[0],s=this.getInstruction(r);this.instructions[r]={type:s.type,valueType:s.valueType,args:s.args,endIndex:this.instructionsLength(),callData:s.callData};var o=this.pushInstruction({type:e,valueType:n,args:t});return this.markClosedBlock(r,o),o},t.prototype.ExtendSeed=function(t,e){var r=i.ExtendSeed,s=n.SeedType;return this.pushInstruction({type:r,valueType:s,args:e,tag:t})},t.prototype.Noop=function(){var t=i.Noop,e=n.Any;return this.pushLeafInstruction({type:t,valueType:e})},t.prototype.Action=function(t,e){return this.pushInstruction({type:i.Action,valueType:n.Action,args:e,symbols:t})},t.prototype.replaceInstructionWithConstant=function(t,e){this.instructions[t]=e,this.blockMask[t]=void 0},t.prototype.replaceInstructionWithBlockVar=function(t,e){this.instructions[t]=e},t.prototype.reopenFinalBlock=function(){var t=this.getInstruction(this.returnIndex);if(t.type!==i.BroadcastResult)return this;for(var e=t.args[0],n=this.getInstruction(e).args[0];n<e;n++)this.blockMask[n]=void 0;return this.truncate(e),this},t.prototype.isInClosedBlock=function(t){return this.blockMask[t]},t.prototype.copy=function(){var e=new t({argNames:this.argNames,argTypes:this.argTypes});return e.instructions=this.instructions.slice(),e.blockMask=this.blockMask.slice(),e.comments=this.comments.slice(),e.returnIndex=this.returnIndex,e},t.prototype.close=function(){return this.returnIndex=v.fuseBroadcast(this,this.returnIndex),l.dropUnreferencedInstructions(this),this},t.prototype.copyInstruction=function(t){return m.copyInstruction(this,t)},t.prototype.copyInstructionWithArgs=function(t,e){return m.copyInstructionWithArgs(this,t,e)},t.prototype.replaceInstructionWithNoop=function(t){this.instructions[t]={type:i.Noop,valueType:n.Any}},t.prototype.getReturnType=function(){return this.instructions[this.returnIndex].valueType},t.prototype.isConstant=function(){return h.isConstant(this.instructions[this.returnIndex])},t.prototype.asValue=function(){return A.asValue(this,this.returnIndex)},t.prototype.asCompilerValue=function(){var t=this.instructions[this.returnIndex];switch(t.type){case i.Constant:return t.value;default:throw new Error("Unexpected opcode "+t.type+".")}},t.prototype.getConstantListLength=function(){return y.getConstantListLength(this,this.returnIndex)},t.prototype.getListLengthDependencies=function(){var t=this.copy(),e=y.listLengthIndex(t,t.returnIndex);return D.findDependencySymbols(t,e)},t.prototype.elementAt=function(t){var e=this.copy(),n=e.returnIndex;return e.returnIndex=L.elementAt(e,n,t),e.close(),e},t.prototype.getCompiledFunction=function(t){var e;if(t){e=t.slice();for(var n=0,r=this.argNames;n<r.length;n++){var i=r[n];-1===e.indexOf(i)&&e.push(i)}}else e=this.argNames;var o=p.emitJS(this),u=o.source,a=o.constants;return{args:e,source:u,constants:a,fn:s.closureFunctionWithBuiltIn(e,u,a)}},t.prototype.polynomialOrder=function(t,e){return I.polynomialOrder(this,t,e)},t.prototype.getPolynomialCoefficients=function(t){return T.getPolynomialCoefficients(this,t)},t.prototype.takeDerivative=function(t){var e=this.copy(),n=this.argNames.indexOf(t);return-1===n?(e.Constant(0),e.close(),e):(e.returnIndex=x.takeDerivative(e,e.returnIndex,n),e.close(),e)},t.prototype.deriveRegressionRestrictions=function(){return C.deriveRegressionRestrictions(this)},t.prototype.boundDomain=function(t){return k.boundDomain(this,t,this.returnIndex)},t.prototype.findLinearSubset=function(t){for(var e=V.findLinearSubset(this),n=[],r=0,s=t;r<s.length;r++){var i=s[r],o=this.argNames.indexOf(i);if(-1===o)throw new Error("Programming Error: findLinearSubset called with a non-dependency");n.push(e[o])}return n},t.prototype.print=function(){return f.print(this)},t.prototype.printInstruction=function(t){return f.printInstruction(this,t)},t.prototype.toDot=function(){return d.default(this)},t.prototype.getLiveArgNames=function(){for(var t=[],e=0;e<this.argNames.length;e++){this.instructions[e].type===i.LoadArg&&t.push(this.argNames[e])}return t},t}();t.Chunk=S});\ndefine(\'core/math/ir/distribution-table\',["require","exports","./features/list-length"],function(require,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomSampleFromList=t.DistributionTable=void 0,t.DistributionTable={normaldist:{pdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("normalpdf",i.concat(r.args))},cdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("normalcdf",i.concat(r.args))},mean:function(t,n,i){return t.getInstruction(n).args[0]},median:function(n,i,r){return t.DistributionTable.normaldist.mean(n,i,r)},stdev:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("abs",[r.args[1]])},var:function(t,n,i){var r=t.getInstruction(n);return t.Multiply([r.args[1],r.args[1]])},quantile:function(t,n,i){var r=t.getInstruction(n);return t.Add([t.Multiply([t.SyntheticNativeFunction("invNorm",i),t.SyntheticNativeFunction("abs",[r.args[1]])]),r.args[0]])},random:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("normalSample",[i[0],r.args[0],r.args[1]])}},tdist:{pdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("tpdf",i.concat(r.args))},cdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("tcdf",i.concat(r.args))},mean:function(t,n,i){return t.Constant(0)},median:function(t,n,i){return t.Constant(0)},stdev:function(n,i,r){return n.SyntheticNativeFunction("sqrt",[t.DistributionTable.tdist.var(n,i,r)])},var:function(t,n,i){var r=t.getInstruction(n),e=t.Constant(2),a=r.args[0];return t.Piecewise([t.GreaterEqual([a,e]),t.Divide([a,t.Subtract([a,e])]),t.Constant(NaN)])},quantile:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("invT",[i[0],r.args[0]])},random:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("tSample",[i[0],r.args[0]])}},poissondist:{pdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("poissonpdf",i.concat(r.args))},cdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("poissoncdf",i.concat(r.args))},mean:function(t,n,i){return t.getInstruction(n).args[0]},median:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("invPoisson",[t.Constant(.5),r.args[0]])},stdev:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("sqrt",[r.args[0]])},var:function(n,i,r){return t.DistributionTable.poissondist.mean(n,i,r)},quantile:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("invPoisson",[i[0],r.args[0]])},random:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("poissonSample",[i[0],r.args[0]])}},binomialdist:{pdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("binompdf",i.concat(r.args))},cdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("binomcdf",i.concat(r.args))},mean:function(t,n,i){var r=t.getInstruction(n);return t.Multiply([r.args[0],r.args[1]])},median:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("invBinom",[t.Constant(.5),r.args[0],r.args[1]])},stdev:function(n,i,r){return n.SyntheticNativeFunction("sqrt",[t.DistributionTable.binomialdist.var(n,i,r)])},var:function(t,n,i){var r=t.getInstruction(n).args,e=r[0],a=r[1];return t.Multiply([e,t.Multiply([a,t.Subtract([t.Constant(1),a])])])},quantile:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("invBinom",[i[0],r.args[0],r.args[1]])},random:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("binomSample",[i[0],r.args[0],r.args[1]])}},uniformdist:{pdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("uniformpdf",i.concat(r.args))},cdf:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("uniformcdf",i.concat(r.args))},mean:function(t,n,i){var r=t.getInstruction(n);return t.Divide([t.Add([r.args[0],r.args[1]]),t.Constant(2)])},median:function(n,i,r){return t.DistributionTable.uniformdist.mean(n,i,r)},stdev:function(n,i,r){return n.SyntheticNativeFunction("sqrt",[t.DistributionTable.uniformdist.var(n,i,r)])},var:function(t,n,i){var r=t.getInstruction(n),e=t.Subtract([r.args[1],r.args[0]]);return t.Divide([t.Multiply([e,e]),t.Constant(12)])},quantile:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("invUniform",[i[0],r.args[0],r.args[1]])},random:function(t,n,i){var r=t.getInstruction(n);return t.SyntheticNativeFunction("uniformSample",[i[0],r.args[0],r.args[1]])}}},t.randomSampleFromList=function(t,i,r){var e=r[0],a=t.Constant(0),o=t.Constant(1);if(0===n.getConstantListLength(t,i))return t.Constant(NaN);var u=n.listLengthIndex(t,i);return t.InboundsListAccess([i,t.Add([t.SyntheticNativeFunction("floor",[t.Multiply([t.SyntheticNativeFunction("uniformSample",[e,a,o]),u])]),o])])}});\ndefine(\'core/math/ir/features/depends-on-instruction\',["require","exports","../instructions"],function(require,r,n){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.dependsOnInstruction=void 0,r.dependsOnInstruction=function(r,e,t){if(e===t)return!0;if(e<t)return!1;for(var i=[!0],u=t+1;u<=e;u++)i.push(!1);for(var s=[e];s.length;){if(!i[(u=s.pop())-t]){i[u-t]=!0;var o=r.getInstruction(u);if(!n.isLeafInstruction(o))for(var f=0,c=o.args;f<c.length;f++){var a=c[f];if(a===t)return!0;a<t||(i[a-t]||s.push(a))}}}return!1}});\ndefine(\'core/math/cache-stats\',["require","exports"],function(require,e){"use strict";var a;Object.defineProperty(e,"__esModule",{value:!0}),e.markCacheRead=e.markCacheWrite=e.markCacheMiss=e.markCacheHit=e.setCacheStatStore=void 0,e.setCacheStatStore=function(e){a=e},e.markCacheHit=function(){a&&(a.cacheHits+=1)},e.markCacheMiss=function(){a&&(a.cacheMisses+=1)},e.markCacheWrite=function(){a&&(a.cacheWrites+=1)},e.markCacheRead=function(){a&&(a.cacheReads+=1)}});\ndefine(\'core/math/ir/build-ir\',["require","exports","parsenodes","core/math/builtinframe","core/math/errormsg","./scope","./chunk","core/math/types","core/math/maybe-rational","./opcodes","./builtin-table","./features/list-length","./features/is-constant","./features/type-check","./distribution-table","./features/fuse-broadcast","./features/find-dependency-symbols","./features/element-at","./features/take-derivative","./features/substitute","./features/convert-to-broadcast","./features/copy-instruction","./features/depends-on-instruction","./dependencies","../cache-stats","./features/nan-of-type"],function(require,e,t,r,n,i,a,s,o,u,c,l,d,p,y,f,g,v,m,h,b,T,L,S,I,w){"use strict";function A(e,t,r,n,i){return{policy:e,frame:t,chunk:r,scope:n,parentNode:i}}function E(e){var t=e.policy,r=e.frame,n=e.argNames,s=e.argTypes,o=new a.Chunk({argNames:n,argTypes:s});return A(t,r,o,function(e){for(var t=i.Scope({},-1),r=0;r<e.argNames.length;r++)i.setSymbol(t,e.argNames[r],r);return t}(o),void 0)}function x(e,t,r){if("FunctionDefinition"===t.type)for(var i=0,a=r;i<a.length;i++){var o=a[i];if(-1!==t._argSymbols.indexOf(o)||t._symbol===o)throw n.updateRuleLocalLHS(o);if(t._sybmol===o)throw n.updateRuleFunctionLHS(o)}for(var u=[],c=0,l=r;c<l.length;c++){o=l[c];e.frame[o]||u.push(o)}if(u.length){var d=U(e,u[0]).setDependencies(e.chunk.argNames.concat(u));throw e.chunk.isConstant()&&e.chunk.getReturnType()===s.Action&&d.setActionValue(e.chunk.asValue()),d}}function C(e,a){var c;if(I.markCacheRead(),_(e.frame,a))I.markCacheHit(),c=e.chunk.copyInstruction(a.__IRCache.instruction);else{I.markCacheMiss();var y=e.chunk.instructionsLength(),g=e.policy,v=e.frame,T=e.chunk,E=e.scope,x=e.parentNode;if(c=function(e,a){var c=e.policy,y=e.frame,g=e.chunk,v=e.scope,T=e.parentNode;switch(a.type){case"Constant":var I=a._constantValue,E="boolean"==typeof I?s.Bool:s.Number;return g.ConstantOfType(E,I);case"MixedNumber":return g.Constant(a._constantValue);case"Negative":return g.Negative(function(e,t){return[C(e,t[0])]}(e,a.args));case"Add":return g.Add(D(e,a.args));case"Subtract":return g.Subtract(D(e,a.args));case"Multiply":return g.Multiply(D(e,a.args));case"Divide":return g.Divide(D(e,a.args));case"Exponent":return g.Exponent(D(e,a.args));case"Comparator[\'=\']":return g.Equal(D(e,a.args));case"Comparator[\'>\']":return g.Greater(D(e,a.args));case"Comparator[\'<\']":return g.Less(D(e,a.args));case"Comparator[\'>=\']":return g.GreaterEqual(D(e,a.args));case"Comparator[\'<=\']":return g.LessEqual(D(e,a.args));case"And":return g.And(D(e,a.args));case"PercentOf":return g.Divide([g.Multiply(D(e,a.args)),g.Constant(100)]);case"ParenSeq":return function(e,t){for(var r,i,a,o,u=e.chunk,c=e.policy,l=B(e,t.args),d=!1,p=0;p<l.length;p++){var y=u.getInstruction(l[p]).valueType;if(y===s.Action){if(d=!0,void 0!==o)throw n.combineTypeError([s.prettyPrint(o),s.prettyPrint(s.Action)])}else{if(d)throw n.combineTypeError([s.prettyPrint(s.Action),s.prettyPrint(y)]);o=y}}if(d)return V(e,l);var f=null!==(a=null===(i=(r=c).dimensions)||void 0===i?void 0:i.call(r))&&void 0!==a?a:2;if(2!==f)throw new Error("3D points not implemented.");if(l.length!==f)throw n.badTupleDimensions(f);return u.OrderedPair(l)}(e,a);case"BareSeq":return function(e,t){var r=e.chunk,i=B(e,t.args);if(i.length<2)throw n.unexpectedSymbol(",");for(var a=r.getInstruction(i[0]).valueType,o=1;o<i.length;o++){var u=r.getInstruction(i[o]).valueType;if(a!==u)throw n.combineTypeError([s.prettyPrint(a),s.prettyPrint(u)])}if(a===s.Number)throw 2===i.length?n.malformedPoint():n.malformedList();return a===s.Action?V(e,i):r.List(i)}(e,a);case"OrderedPairAccess":return g.OrderedPairAccess(D(e,a.args));case"UpdateRule":var x=y[ne=a._symbol];if(x){if(x.isError)throw x;if("Assignment"!==x.type&&"Slider"!==x.type)throw U(e,ne)}return g.Action([ne],[C(e,a.args[1])]);case"List":if(a.getDependencies().length>0)return g.List(B(e,a.args));if(0===a.args.length)return g.ConstantOfType(s.EmptyList,[]);for(var N=g.instructionsLength(),F=[],O=void 0,_=void 0,R=0,k=a.args;R<k.length;R++){var M=C(e,k[R]),H=g.getInstruction(M);if(void 0===O){if(O=H.valueType,!s.hasListType(O))throw n.listTypeError([s.prettyPrint(O)]);_=s.listType(O)}else if(H.valueType!==O)throw n.heterogeneousList();if(H.type!==u.Constant)throw new Error("Programming error: expected list with no dependencies to constant collapse.");F.push(H.value),g.truncate(N)}return g.ConstantOfType(_,F);case"ListAccess":var j=C(e,a.args[0]),z=g.getInstruction(j);if("Range"===a.args[1].type&&0===a.args[1].args[1].length){if(!s.isList(z.valueType))throw n.indexTypeError([s.prettyPrint(z.valueType),s.prettyPrint(s.Number)]);var W=l.listLengthIndex(g,j),G=q(e,C(e,a.args[1].args[0]),g.List([W]),{stepMustBePositive:!0});return g.ListAccess([j,G])}G=C(e,a.args[1]);var K=g.getInstruction(G);if(!s.isList(z.valueType))throw n.indexTypeError([s.prettyPrint(z.valueType),s.prettyPrint(K.valueType)]);return K.valueType===s.ListOfBool?g.SyntheticNativeFunction("select",[j,G]):g.ListAccess([j,G]);case"Range":var J=D(e,a.args);return q(e,J[0],J[1],{stepMustBePositive:!1});case"ListComprehension":return function(e,t){for(var r=e.policy,a=e.frame,o=e.chunk,c=e.scope,d=e.parentNode,p=t._body,y=[],f=o.Constant(1),g=Object.create(a),v=0,m=t._inputLists;v<m.length;v++){var h=m[v]._symbol;g[h]=n.badListComprehensionInputDependency(h)}for(var b=i.childScope(c),T=t._inputLists.length-1;T>=0;T--){var L=t._inputLists[T],I=L._symbol,w=C(A(r,g,o,b,d),L.args[1]),E=o.getInstruction(w);if(!s.isList(E.valueType))throw n.listComprehensionInputListTypeError(I,s.prettyPrint(E.valueType));var x=l.listLengthIndex(o,w);y.push({symbol:I,assignedList:w,lengthIndex:x}),f=o.Multiply([f,x])}var N=o.Constant(1),F=o.BeginBroadcast([f],{inputListSymbols:y.map(function(e){return e.symbol})}),O=i.childScope(c);i.setSymbol(O,t._index._symbol,F);var _=N;for(T=y.length-1;T>=0;T--){var D=y[T],B=(I=D.symbol,w=D.assignedList,x=D.lengthIndex,void 0);if(1===y.length)B=F;else{var P=o.SyntheticNativeFunction("floor",[o.Divide([o.Subtract([F,N]),_])]);B=o.Add([o.SyntheticNativeFunction("mod",[P,x]),N]),T>0&&(_=o.Multiply([_,x]))}var R=i.getSymbol(O,I);if(void 0!==a[I]||void 0!==R&&o.getInstruction(R).type!==u.LoadArg)throw n.shadowedListComprehensionInput(I);i.setSymbol(O,I,o.ListAccess([w,B]))}for(var k=Object.create(a),M=0,V=y;M<V.length;M++){k[V[M].symbol]=S.FRAME_SENTINEL}var U=C(A(r,k,o,O,d),p),q=o.getInstruction(U);if(!s.hasListType(q.valueType))throw n.listTypeError([s.prettyPrint(q.valueType)]);var H=o.EndBroadcast([F,U]);return o.BroadcastResult(s.listType(q.valueType),[H])}(e,a);case"Piecewise":var Q=function(e,t){return[C(e,t[0]),C(e,t[1]),C(e,t[2])]}(e,a.args),X=g.getInstruction(Q[0]),Y=g.getInstruction(Q[1]),Z=g.getInstruction(Q[2]);if(X.type===u.Constant&&X.valueType===s.Bool&&s.typesMatch(Y.valueType,Z.valueType)){var $=Q[X.value?1:2],ee=g.getInstruction($),te=Y.valueType!==s.EmptyList?Y.valueType:Z.valueType;return ee.valueType===s.EmptyList&&te!==s.EmptyList?g.ConstantOfType(te,[]):$}if(!s.typesMatch(Y.valueType,Z.valueType)&&d.isConstant(Z)&&Z.valueType===s.Number&&o.isNanFloat(Z.value)&&w.isNanableValueType(Y.valueType)){var re=g.NanOfType(Y.valueType);Q=[Q[0],Q[1],re]}return g.Piecewise(Q);case"Ans":case"Identifier":var ne=a._symbol,ie=a._errorSymbol;if("Ans"===a.type&&-1!==g.argNames.indexOf(ne))throw n.ansUndefined();G=i.getSymbol(v,ne);var ae=y[ne];if(void 0!==G){if(v.symbolMap.hasOwnProperty(ne))return G;if(void 0===ae||ae===S.FRAME_SENTINEL)return G}if(void 0===ae){if(r[a._symbol])throw r[a._symbol].isFunction?n.functionUnsupported(ie):n.constantUnsupported(ie);throw new Error("Programming Error: reached undefined symbol "+ne)}if(ae.isError)throw ae;if(ae.isFunction)throw n.identifierAsFunction(ie);var se=C(A(c,y,g,v,void 0),ae);return i.setSymbol(v,ne,se),se;case"FunctionCall":case"SeededFunctionCall":Q=B(e,a.args);return P(e,a._symbol,a._errorSymbol,Q);case"FunctionExponent":return y[tt=a.args[0]._symbol]&&y[tt].isFunction?C(e,t.Exponent([t.FunctionCall(tt,[a.args[1]]),a.args[2]])):C(e,t.Multiply([a.args[0],t.Exponent([a.args[1],a.args[2]])]));case"FunctionFactorial":return y[tt=a.args[0]._symbol]&&y[tt].isFunction?C(e,t.FunctionCall("\\\\factorial",[t.FunctionCall(tt,[a.args[1]])])):C(e,t.Multiply([a.args[0],t.FunctionCall("\\\\factorial",[a.args[1]])]));case"DotAccess":var oe=a.args[0],ue=a.args[1];if(("Identifier"===ue.type||"FunctionCall"===ue.type)&&y[ue._symbol]&&y[ue._symbol].isFunction)return P(e,ne=ue._symbol,ie=ue._errorSymbol,Q=B(e,"Identifier"===ue.type?[oe]:[oe].concat(ue.args)),{dotLHSIndex:Q[0]});if("SeededFunctionCall"===ue.type)return P(e,ne=ue._symbol,ie=ue._errorSymbol,Q=B(e,[ue.seed,oe].concat(ue.args.slice(1))),{dotLHSIndex:Q[1]});throw n.unexpectedSymbol(".");case"Seed":return g.ConstantOfType(s.SeedType,a._stringValue);case"ExtendSeed":return g.ExtendSeed(a.tag,D(e,a.args));case"Integral":var ce=a._differential._symbol,le=i.getSymbol(v,ce);if(void 0!==y[ce]||void 0!==le&&g.getInstruction(le).type!==u.LoadArg)throw n.shadowedIntegrationVariable(ce);(xe=Object.create(y))[ce]=n.badIntegralBoundDependency(ce);var de=C(Ne=A(c,xe,g,i.childScope(v),T),a.args[1]),pe=C(Ne,a.args[2]),ye=g.getInstruction(de),fe=g.getInstruction(pe),ge=g.SymbolicVar(s.Number,ce),ve=i.childScope(v);i.setSymbol(ve,ce,ge);var me=Object.create(y);me[ce]=S.FRAME_SENTINEL;var he=C(A(c,me,g,ve,T),a.args[3]);if(!L.dependsOnInstruction(g,he,ge))return g.Multiply([he,g.Subtract([pe,de])]);var be=de;void 0!==(Ue=void 0!==(Re=l.minListLengthIndex(g,[de,pe,he]))?g.BeginBroadcast([Re]):void 0)&&s.isList(ye.valueType)&&(be=b.deferredOrInboundsAccess(g,de,Ue));var Te=pe;void 0!==Ue&&s.isList(fe.valueType)&&(Te=b.deferredOrInboundsAccess(g,pe,Ue));var Le=g.BeginIntegral({indexSymbol:ce},[be,Te]),Se=h.substitute(g,Le,ge,he),Ie=g.getInstruction(Se);void 0!==Ue&&s.isList(Ie.valueType)&&(Se=b.deferredOrInboundsAccess(g,Se,Ue));var we=g.EndIntegral([Le,Se]),Ae=g.BlockVar(s.Number,[we]);if(void 0!==Ue){var Ee=g.EndBroadcast([Ue,Ae]);return g.BroadcastResult(s.ListOfNumber,[Ee])}return Ae;case"Sum":case"Product":ce=a._index._symbol,le=i.getSymbol(v,ce);if(void 0!==y[ce]||void 0!==le&&g.getInstruction(le).type!==u.LoadArg)throw n.shadowedIndex(ce);var xe,Ce="Sum"===a.type;(xe=Object.create(y))[ce]=Ce?n.badSumBoundDependency(ce):n.badProductBoundDependency(ce);var Ne,Fe=C(Ne=A(c,xe,g,i.childScope(v),T),a.args[1]),Oe=C(Ne,a.args[2]);if(!p.argIsTypeOrListOfType(g,Fe,s.Number)){var _e=p.extractScalarValueTypes(g,[Fe]);throw Ce?n.sumLowerBoundTypeError(_e):n.productLowerBoundTypeError(_e)}if(!p.argIsTypeOrListOfType(g,Oe,s.Number)){_e=p.extractScalarValueTypes(g,[Oe]);throw Ce?n.sumUpperBoundTypeError(_e):n.productUpperBoundTypeError(_e)}de=g.SyntheticNativeFunction("round",[Fe]),pe=g.SyntheticNativeFunction("round",[Oe]),ye=g.getInstruction(de),fe=g.getInstruction(pe);if(ye.type===u.Constant&&ye.valueType===s.Number&&!isFinite(o.asFloat(ye.value)))throw Ce?n.sumInfiniteBoundError():n.productInfiniteBoundError();if(fe.type===u.Constant&&fe.valueType===s.Number&&!isFinite(o.asFloat(fe.value)))throw Ce?n.sumInfiniteBoundError():n.productInfiniteBoundError();var De=g.SymbolicVar(s.Number,ce),Be=i.childScope(v);i.setSymbol(Be,ce,De);var Pe=Object.create(y);Pe[ce]=S.FRAME_SENTINEL;var Re,ke=C(A(c,Pe,g,Be,T),a.args[3]);if(!L.dependsOnInstruction(g,ke,De)){var Me=g.Add([g.Subtract([pe,de]),g.Constant(1)]);Me=g.SyntheticNativeFunction("max",[Me,g.Constant(0)]);var Ve=Ce?g.Multiply([ke,Me]):g.Exponent([ke,Me]);return g.Piecewise([g.Less([Me,g.Constant(1/0)]),Ve,g.Constant(NaN)])}if(!p.argIsTypeOrListOfType(g,ke,s.Number)){_e=p.extractScalarValueTypes(g,[ke]);throw Ce?n.sumArgumentTypeError(_e):n.productArgumentTypeError(_e)}if(void 0!==(Re=l.minListLengthIndex(g,[de,pe,ke]))&&L.dependsOnInstruction(g,Re,De))throw Ce?n.variableLengthSumBodyDependsOnIndex(ce):n.variableLengthProductBodyDependsOnIndex(ce);var Ue;be=de;void 0!==(Ue=void 0!==Re?g.BeginBroadcast([Re]):void 0)&&s.isList(ye.valueType)&&(be=b.deferredOrInboundsAccess(g,de,Ue));Te=pe;null!=Ue&&s.isList(fe.valueType)&&(Te=b.deferredOrInboundsAccess(g,pe,Ue));var qe=g.Constant(Ce?0:1),He=(Le=g.BeginLoop({type:Ce?"sum":"product",indexSymbol:ce},[be,Te,qe]),g.BlockVar(s.Number,[Le])),je=h.substitute(g,Le,De,ke),ze=g.getInstruction(je);void 0!==Ue&&s.isList(ze.valueType)&&(je=b.deferredOrInboundsAccess(g,je,Ue));var We=Ce?g.Add([He,je]):g.Multiply([He,je]),Ge=(we=g.EndLoop([Le,We]),g.BlockVar(s.Number,[we]));if(void 0!==Ue){Ee=g.EndBroadcast([Ue,Ge]);return g.BroadcastResult(s.ListOfNumber,[Ee])}return Ge;case"Derivative":var Ke=C(e,t.Identifier(a._symbol));if(!p.argIsTypeOrListOfType(g,Ke,s.Number))throw n.derivativeVariableTypeError(a._symbol,p.extractScalarValueTypes(g,[Ke]));var Je=void 0,Qe=void 0;if((rt=g.getInstruction(Ke)).type===u.LoadArg&&rt.valueType===s.Number)Je=e,Qe=Ke;else{var Xe=i.childScope(v);Qe=g.SymbolicVar(rt.valueType),i.setSymbol(Xe,a._symbol,Qe);var Ye=Object.create(y);Ye[a._symbol]=S.FRAME_SENTINEL,Je=A(c,Ye,g,Xe,T)}for(var Ze=1;"Derivative"===a.args[0].type&&a.args[0]._symbol===a._symbol;)Ze+=1,a=a.args[0];for(var $e=f.fuseBroadcast(g,C(Je,a.args[0])),et=0;et<Ze;et++)$e=m.takeDerivative(g,$e,Qe);return Qe===Ke?$e:h.substitute(g,Ke,Qe,$e);case"Prime":var tt;if(!y[(tt=a.args[0])._symbol])throw n.functionNotDefined(tt._symbol);var rt;Ke=C(e,tt.args[0]),Qe=void 0;Qe=(rt=g.getInstruction(Ke)).type===u.LoadArg&&rt.valueType===s.Number?Ke:g.SymbolicVar(rt.valueType);Q=void 0;if("logbase"===tt._symbol){if(2!==tt.args.length)throw n.primedFunctionArity();Q=[Qe,C(e,tt.args[1])]}else{if(1!==tt.args.length)throw n.primedFunctionArity();Q=[Qe]}$e=f.fuseBroadcast(g,P(e,tt._symbol,tt._errorSymbol,Q));for(var nt=0;nt<a.order;nt++)$e=m.takeDerivative(g,$e,Qe);return Qe===Ke?$e:h.substitute(g,Ke,Qe,$e);case"Slider":return e.chunk.Constant(a.getConcreteTree(c,y).asCompilerValue());case"Assignment":return C(e,a._expression);case"FunctionDefinition":for(var it=0;it<a._argSymbols.length;it++){if(y[a._argSymbols[it]])throw n.parameterAlreadyDefined(a._argSymbols[it]);if(a._argSymbols[it]===a._symbol)throw n.parameterAlreadyDefined(a._argSymbols[it])}return C(e,a._expression);default:throw new Error("Programming error, unimplemented node type "+a.type)}}(A(g,v,T,E,a),a),!F(a,x)){var R=T.getInstruction(c);R.type===u.BroadcastResult&&R.isConstantBroadcast&&(c=f.fuseBroadcast(T,c))}O(e,a,c=N(e,y,c))}return e.chunk.returnIndex=c,c}function N(e,t,r){var n=e.chunk,i=e.scope;if(r<=t)return r;var a=n.getInstruction(r);return d.isConstant(a)?(n.truncate(Math.max(t,i.maxIndex+1)),T.copyInstruction(n,a)):r}function F(e,t){if(!t)return!1;if(!e.getScope||!t.getScope)return!1;var n=t.getScope().dependencies,i=e.getScope().dependencies;if(i.length===n.length)return!0;for(var a=0,s=0,o=i;s<o.length;s++){var u=o[s];r[u]||(a+=1)}for(var c=0,l=0,d=n;l<d.length;l++){u=d[l];r[u]||(c+=1)}return a===c}function O(e,t,r){var n=e.frame,i=e.chunk,a=e.parentNode,s=i.getInstruction(r);if(d.isConstant(s)&&!F(t,a)){var o=S.getCacheKeys(n,t);o&&(I.markCacheWrite(),t.__IRCache={keys:o,instruction:s})}}function _(e,t){if(!t.__IRCache)return!1;for(var r=0,n=t.__IRCache.keys;r<n.length;r++){var i=n[r],a=i[0],s=i[1];if(e[a]!==s)return!1}return!0}function D(e,t){return[C(e,t[0]),C(e,t[1])]}function B(e,t){for(var r=[],n=0,i=t;n<i.length;n++){var a=i[n];r.push(C(e,a))}return r}function P(e,a,m,h,b){var T=e.policy,L=e.frame,I=e.chunk,w=e.scope,E=e.parentNode,x=i.getSymbol(w,a);if(void 0!==x){if(1==h.length)return I.Multiply([x,h[0]]);throw I.getInstruction(x).type===u.LoadArg?n.functionNotDefined(m):I.getInstruction(x).valueType===s.Distribution?n.distributionAsFunction(m):n.variableAsFunction(m)}var N=L[a];if(N&&N.isError)throw N;if(void 0===N||!N.isFunction){if(r[a]&&r[a].isFunction){if("logbase"===a&&L.ln&&L.log)throw n.logbaseUnsupported();throw n.functionUnsupported(m)}if(N){var F=C(e,N);if(I.getInstruction(F).valueType===s.Distribution)throw n.distributionAsFunction(m)}if(1==h.length)return I.Multiply([C(e,t.Identifier(a)),h[0]]);throw N?n.variableAsFunction(m):new Error("Programming Error: reached undefined symbol "+a)}if("FunctionDefinition"===N.type){if(b&&void 0!==b.dotLHSIndex)throw n.illegalDotCall(m);if(h.length!==N._argSymbols.length)throw n.wrongArity(m,N._argSymbols.length,h.length);for(var O=i.childScope(w),_=Object.create(L),D=0;D<N._argSymbols.length;D++)i.setSymbol(O,N._argSymbols[D],h[D]),_[N._argSymbols[D]]=S.FRAME_SENTINEL;return C(A(T,_,I,O,E),N._expression)}if(c.CompilerFunctionTable.hasOwnProperty(a))return function(e,t,r,i,a){var m=e.chunk,h=!(!a||void 0===a.dotLHSIndex),b=c.CompilerFunctionTable[t];if(b.fallthroughUnlessDistribution&&(0===i.length||m.getInstruction(i[0]).valueType===s.EmptyList||!s.isTypeOrListOfType(m.getInstruction(i[0]).valueType,s.Distribution)))return k(e,t,r,i,a);var T=b.minArity,L=b.maxArity,S=b.allowDotCall;if(a&&void 0!==a.dotLHSIndex){if(!S)throw n.illegalDotCall(r);R(m,a.dotLHSIndex,"."+r)}var I,w=i.length;if(w<T)throw function(e,t,r,i,a){var s=a.isDotCall;s&&(r-=1,i-=1,t="."+t);var o=c.CompilerFunctionTable[e];o.isSeeded&&(r-=1,i-=1);var u=void 0;s&&o.dotMinArityExampleArgs?u=t+o.dotMinArityExampleArgs:o.minArityExampleArgs&&(u=t+o.minArityExampleArgs);switch(e){case"pdf":return s?n.wrongArity(t,r,i,u):n.pdfWrongArity();case"cdf":return s?n.wrongArity(t,r,i,u):n.cdfRequiresArguments();case"tdist":return n.tdistWrongArity();case"random":return n.randomArity();case"round":case"midpoint":case"normaldist":case"poissondist":case"binomialdist":case"uniformdist":case"mean":case"median":case"stdev":case"var":case"quantile":case"sort":case"shuffle":case"join":case"unique":case"polygon":return n.wrongArity(t,r,i,u);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw n.parseError();default:throw new Error("Unexpected compiler function "+e)}}(t,r,T,w,{isDotCall:h});if(w>L)throw function(e,t,r,i,a){var s=a.isDotCall;s&&(r-=1,i-=1,t="."+t);var o=c.CompilerFunctionTable[e];o.isSeeded&&(r-=1,i-=1);var u=void 0;s&&o.dotMaxArityExampleArgs?u=t+o.dotMaxArityExampleArgs:o.maxArityExampleArgs&&(u=t+o.maxArityExampleArgs);switch(e){case"pdf":return s?n.wrongArity(t,r,i,u):n.pdfWrongArity();case"cdf":return s?n.wrongArity(t,r,i,u):n.cdfTooManyArguments();case"tdist":return n.tdistWrongArity();case"random":return n.randomArity();case"round":case"midpoint":case"normaldist":case"poissondist":case"binomialdist":case"uniformdist":case"mean":case"median":case"stdev":case"var":case"quantile":case"sort":case"shuffle":case"join":case"unique":case"polygon":return n.wrongArity(t,r,i,u);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw n.parseError();default:throw new Error("Unexpected compiler function "+e)}}(t,r,L,w,{isDotCall:h});if("cdf"===t)I=2===w?[i[0],m.Constant(-1/0),i[1]]:i;else if("random"===t)if(1===w||w<4&&!s.isList(m.getInstruction(i[1]).valueType)&&m.getInstruction(i[1]).valueType!==s.Distribution){var A=m.Distribution("uniformdist",[m.Constant(0),m.Constant(1)]);I=[i[0],A].concat(i.slice(1))}else I=i;else I=M(m,i,b);switch(t){case"round":if(1===I.length)return m.SyntheticNativeFunction("round",I);if(!p.argIsTypeOrListOfType(m,I[0],s.Number)||!p.argIsTypeOrListOfType(m,I[1],s.Number))throw n.functionTypeError(r,p.extractScalarValueTypes(m,I));var E=m.SyntheticNativeFunction("round",[I[1]]),x=m.RawExponent([m.Constant(10),E]);return m.Divide([m.SyntheticNativeFunction("round",[m.Multiply([I[0],x])]),x]);case"midpoint":if(!p.argIsTypeOrListOfType(m,I[0],s.Point)||!p.argIsTypeOrListOfType(m,I[1],s.Point))throw n.functionTypeError(r,p.extractScalarValueTypes(m,I));var C=m.Constant(o.maybeRational(1,2));return m.Multiply([C,m.Add(I)]);case"normaldist":case"tdist":case"poissondist":case"binomialdist":case"uniformdist":for(var N=0,F=I;N<F.length;N++){var O=F[N];if(!p.argIsTypeOrListOfType(m,O,s.Number))throw n.functionTypeError(r,p.extractScalarValueTypes(m,i))}return m.Distribution(t,I);case"pdf":case"cdf":case"mean":case"median":case"stdev":case"var":case"quantile":var _=I[0],D=m.getInstruction(_);if(!s.isTypeOrListOfType(D.valueType,s.Distribution))throw n.functionTypeError(r,p.extractScalarValueTypes(m,i));for(var B=I.slice(1),P=0,V=B;P<V.length;P++){O=V[P];if(!s.isTypeOrListOfType(m.getInstruction(O).valueType,s.Number))throw n.functionTypeError(r,p.extractScalarValueTypes(m,i))}if(s.isList(D.valueType)){for(var U=[],H=1/0,j=0,z=I;j<z.length;j++){O=z[j];var W=f.fuseBroadcast(m,O);U.push(W);var G=m.getInstruction(W);if(s.isList(G.valueType)){if(void 0===(se=l.getConstantListLength(m,W)))throw n.variableLengthDistributionList(g.findDependencySymbols(m,W));H=Math.min(H,se)}}for(var K=[],J=0;J<H;J++){var Q=v.elementAt(m,U[0],J),X=m.getInstruction(Q);if(X.type!==u.Distribution)throw n.parseError();for(var Y=[],Z=0,$=U.slice(1);Z<$.length;Z++){O=$[Z];s.isList(m.getInstruction(O).valueType)?Y.push(v.elementAt(m,O,J)):Y.push(O)}K.push(y.DistributionTable[X.symbol][t](m,Q,Y))}return m.List(K)}if(D.type!==u.Distribution)throw n.parseError();return y.DistributionTable[D.symbol][t](m,_,B);case"random":var ee=I[0],te=(_=I[1],m.getInstruction(I[0]));D=m.getInstruction(_);if(te.valueType!==s.SeedType)throw n.parseError();if(D.valueType===s.ListOfDistribution)throw n.randomFromBroadcastDistribution();var re=void 0;if(s.isList(D.valueType))re=y.randomSampleFromList;else{if(D.valueType!==s.Distribution)throw n.randomArity();if(D.type!==u.Distribution)throw n.parseError();re=y.DistributionTable[D.symbol][t]}if(I.length>2){var ne=I[2];if(m.getInstruction(ne).valueType!==s.Number)throw n.randomArity();if(4===I.length){var ie=m.getInstruction(I[3]);if(ie.valueType!==s.Number)throw n.randomArity();if(!d.isConstant(ie))throw n.variableSeed(g.findDependencySymbols(m,I[3]));ee=m.ExtendSeed("us",[ee,I[3]])}var ae=m.Constant(1),se=m.SyntheticNativeFunction("round",[m.SyntheticNativeFunction("validateSampleCount",[ne])]),oe=m.BeginBroadcast([se]);ee=m.ExtendSeed("lc",[ee,m.Subtract([oe,ae])]);var ue=re(m,_,[ee]),ce=m.EndBroadcast([oe,ue]);return m.BroadcastResult(s.listType(m.getInstruction(ue).valueType),[ce])}return re(m,_,[ee]);case"shuffle":ee=I[0];var le=I[1],de=I[2];if(!s.isList(m.getInstruction(le).valueType)||void 0!==de&&m.getInstruction(de).valueType!==s.Number)throw n.functionTypeError(r,p.extractValueTypes(m,i.slice(1)));if(void 0!==de){if(!d.isConstant(m.getInstruction(de)))throw n.variableSeed(g.findDependencySymbols(m,de));ee=m.ExtendSeed("us",[ee,de])}return m.SyntheticNativeFunction("shuffle",[ee,le]);case"sort":var pe=2===I.length?I[1]:I[0],ye=m.getInstruction(pe);if(!s.isList(m.getInstruction(I[0]).valueType)||ye.valueType!==s.ListOfNumber&&ye.valueType!==s.EmptyList)throw n.functionTypeError(r,p.extractValueTypes(m,i));if(0===l.getConstantListLength(m,pe))return pe;var fe=m.SyntheticNativeFunction("min",[l.listLengthIndex(m,I[0]),l.listLengthIndex(m,pe)]);return pe=m.ListAccess([pe,q(e,m.List([m.Constant(1)]),m.List([fe]),{stepMustBePositive:!0})]),m.SyntheticNativeFunction("elementsAt",[I[0],m.SyntheticNativeFunction("sortPerm",[pe])]);case"join":for(var ge=[],ve=!0,me=0,he=I;me<he.length;me++){O=he[me];var be=m.getInstruction(O);d.isConstantOrConstantBroadcast(be)||(ve=!1);var Te=be.valueType;if(Te!==s.EmptyList)if(s.isList(Te))ge.push({isList:!0,index:O,elementType:s.elementType(Te)});else{if(!s.hasListType(Te))throw n.functionTypeError(r,p.extractValueTypes(m,i));ge.push({isList:!1,index:O,elementType:Te})}}if(0===ge.length)return m.ConstantOfType(s.EmptyList,[]);for(var Le=0,Se=ge;Le<Se.length;Le++){if((Ee=Se[Le]).elementType!==ge[0].elementType)throw n.functionTypeError(r,p.extractValueTypes(m,i))}if(ve){for(var Ie=[],we=0,Ae=ge;we<Ae.length;we++){var Ee=Ae[we],xe=m.getInstruction(f.fuseBroadcast(m,Ee.index));d.assertConstant(xe),Ee.isList?Ie.push.apply(Ie,xe.value):Ie.push(xe.value)}return m.ConstantOfType(s.listType(ge[0].elementType),Ie)}for(var Ce=m.Constant(0),Ne=m.Constant(1),Fe={},Oe=0,_e=ge;Oe<_e.length;Oe++){(Ee=_e[Oe]).isList&&void 0===Fe[Ee.index]&&(Fe[Ee.index]=l.listLengthIndex(m,Ee.index))}for(var De=m.SyntheticNativeFunction("total",ge.map(function(e){return e.isList?Fe[e.index]:Ne})),Be=(oe=m.BeginBroadcast([De]),Ce),Pe=[],Re=[],ke=0,Me=ge;ke<Me.length;ke++){var Ve=(Ee=Me[ke]).isList?m.ListAccess([Ee.index,m.Subtract([oe,Be])]):Ee.index;if(Re.push(Ve),Ee!==ge[ge.length-1]){se=Ee.isList?Fe[Ee.index]:Ne;Be=m.Add([Be,se]),Pe.push(m.LessEqual([oe,Be]))}}var Ue=Re[Re.length-1];for(J=Re.length-2;J>=0;J--)Ue=m.Piecewise([Pe[J],Re[J],Ue]);ce=m.EndBroadcast([oe,Ue]);return m.BroadcastResult(s.listType(ge[0].elementType),[ce]);case"unique":var qe=I[0],He=m.getInstruction(qe);if(!s.isList(He.valueType)||He.valueType===s.ListOfDistribution)throw n.functionTypeError("unique",[s.prettyPrint(He.valueType)]);return m.SyntheticNativeFunction("elementsAt",[qe,m.SyntheticNativeFunction("uniquePerm",[qe])]);case"polygon":var je=void 0,ze=I.map(function(e){return m.getInstruction(e)});if(1===ze.length){if((He=ze[0]).valueType!==s.ListOfPoint)throw n.polygonListTypeError([s.prettyPrint(He.valueType)]);je=I[0]}else if(2===ze.length&&s.isTypeOrListOfType(ze[0].valueType,s.Number)&&s.isTypeOrListOfType(ze[1].valueType,s.Number)){if(ze[0].valueType===s.Number&&ze[1].valueType===s.Number)throw n.polygonTwoNumbersError();je=m.OrderedPair(I)}else{if(!ze.every(function(e){return e.valueType===s.Point}))throw n.polygonPointArgsError();je=m.List(I)}return m.SyntheticNativeFunction("polygon",[je]);case"histogram":case"dotplot":case"boxplot":case"ttest":case"ittest":case"stats":case"det":case"inv":case"transpose":case"rref":case"trace":throw n.unexpectedSymbol(r);default:throw new Error("Programming Error: unexpected compiler function "+t)}}(e,a,m,h,b);if(c.BuiltInTable.hasOwnProperty(a))return k(e,a,m,h,b);throw n.functionUnsupported(m)}function R(e,t,r){var i=e.getInstruction(t).valueType;if(!s.isList(i)&&i!==s.Distribution)throw n.dotLHSTypeError(r,s.prettyPrint(i))}function k(e,r,i,a,s){var o=e.chunk,u=c.BuiltInTable[r],l=!(!s||void 0===s.dotLHSIndex),d=a.length,p=u.minArity,y=u.maxArity,f=u.allowDotCall;if(s&&void 0!==s.dotLHSIndex){if(!f)throw n.illegalDotCall(i);R(o,s.dotLHSIndex,"."+i)}if("logbase"===r&&2!==d)throw n.wrongArity(i,1,d-1);if(d>y)throw l&&(p-=1,y-=1,d-=1,i="."+i),"doubleReducer"===u.tag?n.wrongDoubleReducerArity(i):"parameterizedReducer"===u.tag?n.wrongParameterizedReducerArity(i):"color"===u.tag?n.colorArity(i):n.wrongArity(i,y,d);if(d<p)throw l&&(p-=1,y-=1,d-=1,i="."+i),"reducer"===u.tag&&0===d?n.zeroArgReducer(i):"doubleReducer"===u.tag?n.wrongDoubleReducerArity(i):"parameterizedReducer"===u.tag?n.wrongParameterizedReducerArity(i):"color"===u.tag?n.colorArity(i):n.wrongArity(i,p,d);var g=M(o,a,u),v={errorSymbol:i,providedArity:d,isDotCall:l};switch(u.tag){case"default":case"reducer":case"doubleReducer":case"parameterizedReducer":case"color":case"never-broadcast":return o.NativeFunction(r,v,g);case"trig":var m=C(e,t.Identifier("trigAngleMultiplier")),h=o.Multiply([g[0],m]);return o.NativeFunction(r,v,[h]);case"inverseTrig":m=C(e,t.Identifier("trigAngleMultiplier"));var b=o.NativeFunction(r,v,g);return o.Divide([b,m]);default:var T=u.tag;throw new Error("Programming Error: unexpected tag "+T)}}function M(e,t,r){var n=r.minArity,i=r.defaultArguments;if(!i)return t;if(!(t.length-n<i.length))return t;for(var a=t.slice();a.length-n<i.length;)a.push(e.copyInstruction(i[a.length-n]));return a}function V(e,t){for(var r=e.chunk,i=[],a=[],s=0,o=t;s<o.length;s++){var c=o[s],l=r.getInstruction(c);switch(l.type){case u.Action:Array.prototype.push.apply(i,l.symbols),Array.prototype.push.apply(a,l.args);break;case u.Constant:var d=l.value.updateRules;for(var p in d)i.push(p),a.push(r.ConstantOfType(d[p].valueType,d[p].value));break;default:var y=g.findDependencySymbols(r,c);throw y.length>0?n.actionMergeFreeVariable(y):n.parseError()}}return r.Action(i,a)}function U(e,t){var r=e.frame[t];return e.policy.assignmentForbidden(t)?n.updateRuleIllegalLHS(t):r===S.FRAME_SENTINEL?n.updateRuleLocalLHS(t):r&&"FunctionDefinition"===r.type?n.updateRuleFunctionLHS(t):n.updateRuleUndefinedLHS(t).allowExport()}function q(e,t,r,i){var a,o=i.stepMustBePositive,u=e.chunk,c=u.getInstruction(t),d=u.getInstruction(r),p=l.assertConstantListLength(u,t,"Programming error: expected range start list to have constant length."),y=l.assertConstantListLength(u,r,"Programming error: expected range start list to have constant length.");if(c.valueType!==s.ListOfNumber||d.valueType!==s.ListOfNumber)throw n.nonArithmeticRange();var f=u.Constant(1),g=u.Constant(0),v=u.ListAccess([t,f]),m=u.ListAccess([t,u.Constant(2)]),h=u.ListAccess([r,u.Constant(y)]),b=u.Subtract([h,v]),T=p>1?u.Subtract([m,v]):u.Piecewise([u.GreaterEqual([b,g]),f,u.Constant(-1)]),L=u.Add([f,u.SyntheticNativeFunction("round",[u.Divide([b,T])])]),S=u.SyntheticNativeFunction("validateRangeLength",[t,r,T,L]);o&&(S=u.Piecewise([u.GreaterEqual([T,g]),S,g]));var I=u.BeginBroadcast([S]),w=u.Add([v,u.Multiply([T,u.Subtract([I,f])])]),A=u.EndBroadcast([I,w]);return u.addComments(((a={})[v]="start",a[m]="second",a[h]="last",a[L]="proposedLength",a[T]="step",a[w]="body",a)),u.BroadcastResult(s.listType(u.getInstruction(w).valueType),[A])}Object.defineProperty(e,"__esModule",{value:!0}),e.isCacheValid=e.maybeCacheIR=e.hasSameUserDependenciesAsParent=e.maybeDropIntermediates=e.addToIR=e.checkForUndefinedUpdateSymbols=e.buildIR=e.buildIRContext=e.Ctx=void 0,e.Ctx=A,e.buildIRContext=E,e.buildIR=function(e,t){var r=e.policy,n=e.frame,i=e.argNames,a=e.argTypes,o=S.analyzeDependencies(n,t),u=o.freeDependencies,c=o.updateSymbols;if(i||(i=u),!a){a=[];for(var l=0;l<i.length;l++)a.push(s.Number)}var d=E({policy:r,frame:n,argNames:i,argTypes:a});return C(d,t),e.wrapInList&&!s.isList(d.chunk.getReturnType())&&d.chunk.List([d.chunk.returnIndex]),d.chunk.close(),x(d,t,c),d.chunk},e.checkForUndefinedUpdateSymbols=x,e.addToIR=C,e.maybeDropIntermediates=N,e.hasSameUserDependenciesAsParent=F,e.maybeCacheIR=O,e.isCacheValid=_});\ndefine(\'core/math/features/buildIRExpression\',[\'require\',\'core/math/ir/build-ir\',\'core/math/parsenode/base\',\'core/math/parsenode/irexpression\',\'core/math/errormsg\',\'core/math/parsenode/error\'],function(require){"use strict";var r=require("core/math/ir/build-ir").buildIR,e=require("core/math/parsenode/base"),t=require("core/math/parsenode/irexpression"),o=require("core/math/errormsg"),i=require("core/math/parsenode/error");e.prototype.buildIRExpression=function(i,n,s){try{var a=r({policy:i,frame:n,wrapInList:s&&s.wrapInList},this);return new t(a)}catch(r){return r instanceof e?r:o.parseError()}},i.prototype.buildIRExpression=function(){return this}});\ndefine(\'core/math/features/typeCheck\',[\'require\',\'parsenodes\',\'core/math/types\',\'core/math/errormsg\'],function(require){"use strict";var t=require("parsenodes"),e=require("core/math/types"),i=require("core/math/errormsg"),o=e.isOneOf;function s(t){for(var i=[],o=0;o<t.length;o++)i.push(e.prettyPrint(t[o].valueType));return i}function r(t,s){var r=s.length,h=s[0];if(r<2)throw i.methodRequiresList(this._symbol);if(!o(h.valueType,[e.ListOfNumber,e.EmptyList]))throw i.methodRequiresList(this._symbol);if(r>2)throw i.tooManyArguments(this._symbol,2)}var h={Object3D:function(t,e){if(e.length<3)throw i.wrongArity(this._symbol,3,e.length)},Histogram:r,DotPlot:r,BoxPlot:function(t,s){var r=s.length,h=s[0];if(0===r)throw i.methodRequiresList(this._symbol);if(!o(h.valueType,[e.ListOfNumber,e.EmptyList]))throw i.methodRequiresList(this._symbol);if(r>1)throw i.methodRequiresList(this._symbol)},TTest:function(t,o){var r=this._symbol;if(0===o.length)throw i.methodRequiresList(r);if(o[0].valueType===e.EmptyList)throw i.ttestListTooShort(r);if(o[0].valueType!==e.ListOfNumber)throw i.methodRequiresList(r);if(o.length>2)throw i.tooManyArguments(r,2);if(o[0].length<2)throw i.ttestListTooShort(r);if(o[1]&&o[1].valueType!==e.Number)throw i.functionTypeError(r,s(o))},IndependentTTest:function(t,o){var r=this._symbol;if(2!==o.length)throw i.wrongDoubleReducerArity(r);if(!e.isList(o[0].valueType)||!e.isList(o[1].valueType))throw i.nonListDoubleReducer(r);if(o[0].valueType===e.EmptyList||o[1].valueType===e.EmptyList)throw i.ttestListTooShort("ittest");if(o[0].valueType!==e.ListOfNumber||o[1].valueType!==e.ListOfNumber)throw i.functionTypeError(r,s(o));if(o[0].length<2||o[1].length<2)throw i.ttestListTooShort("ittest")},Stats:function(t,o){var r=o.length,h=o[0];if(0===r)throw i.methodRequiresList(this._symbol);if(h.valueType===e.EmptyList)throw i.functionTypeError(this._symbol,s(o));if(h.valueType!==e.ListOfNumber)throw i.methodRequiresList(this._symbol);if(r>1)throw i.methodRequiresList(this._symbol)}};for(var n in h)t[n].prototype.typeCheck=h[n]});\ndefine(\'core/math/features/repr\',[\'require\',\'parsenodes\'],function(require){"use strict";var r=require("parsenodes"),t=function(r,t,e){e=e||0;var i=Array(e+1).join("  "),n=i+"  ";return"[\\n"+n+r.map(function(r){return r.repr(t,e+1)}).join(",\\n"+n)+"\\n"+i+"]"},e=function(r,t){return""+(t=t||"")+r};r.Expression.prototype.repr=function(r,i){return e(this.type,r)+"("+t(this.args,r,i)+")"},r.IRExpression.prototype.repr=function(r,t){t=t||0;var i=Array(t+1).join("  "),n=i+"  ",s=this._chunk.print().split("\\n");return s.pop(),e(this.type,r)+"(`\\n"+n+s.join("\\n"+n)+"\\n"+i+"`)"},r.DoubleInequality.prototype.repr=function(r,t){t=t||0;var i=Array(t+1).join("  "),n=i+"  ";return e(this.type,r)+"([\\n"+n+this.args[0].repr(r,t+1)+",\\n"+n+"\'"+this.args[1]+"\',\\n"+n+this.args[2].repr(r,t+1)+",\\n"+n+"\'"+this.args[3]+"\',\\n"+n+this.args[4].repr(r,t+1)+"\\n"+i+"])"},r.Identifier.prototype.repr=function(r){return e(this.type,r)+"(\'"+this._symbol+"\')"},r.Constant.prototype.repr=function(r){return e(this.type,r)+"("+this.asValue()+")"},r.ExtendSeed.prototype.repr=function(r,i){return e(this.type,r)+"(\'"+this.tag+"\', "+t(this.args,r,i)+")"},r.Seed.prototype.repr=function(r){return e(this.type,r)+"("+this.asValue()+")"},r.FunctionCall.prototype.repr=function(r,i){return e(this.type,r)+"(\'"+this._symbol+"\', "+t(this.args,r,i)+")"},r.Assignment.prototype.repr=function(t,i){return e(this.type,t)+"("+r.Identifier(this._symbol).repr(t,i)+", "+this._expression.repr(t,i)+")"},r.Regression.prototype.repr=r.Equation.prototype.repr=function(r,t){return e(this.type,r)+"("+this._lhs.repr(r,t)+", "+this._rhs.repr(r,t)+")"},r.FunctionDefinition.prototype.repr=function(i,n){return e(this.type,i)+"("+r.Identifier(this._symbol).repr(i,n)+", "+t(this._argSymbols.map(function(t){return r.Identifier(t)}),i,n)+", "+this._expression.repr(i,n)+")"},r.Error.prototype.repr=function(r,t){return e(this.type,r)+"(\'"+this._msg+"\')"},r.Derivative.prototype.repr=function(r,i){return e(this.type,r)+"(\'"+this._symbol+"\', "+t(this.args,r,i)+")"},r.SolvedEquation.prototype.repr=function(r,t){return e(this.type,r)+"(\'"+this._symbol+"\', "+this._expression.repr(r,t)+")"},r.OptimizedRegression.prototype.repr=function(r,t){return e(this.type,r)+"("+JSON.stringify(this.parameters)+", "+JSON.stringify(this.residuals)+", "+JSON.stringify(this.statistics)+", "+this.model.repr(r,t+1)+", "+JSON.stringify({isModelValid:this.isModelValid,residualVariable:this.residualVariable,residualSuggestionId:this.residualSuggestionId,shouldSuggestLogMode:this.shouldSuggestLogMode,isLinear:this.isLinear,parameterWarning:this.parameterWarning})+")"},r.Table.prototype.repr=function(r,i){return e(this.type,r)+"("+t(this.columns,r,i)+")"},r.TableColumn.prototype.repr=function(r,i){return e(this.type,r)+"("+this.header.repr(r,i)+", "+this.length+", "+t(this.values,r,i)+")"},r.Image.prototype.repr=function(r,t){var i=Array(t+1).join("  "),n=i+"  ";return e(this.type,r)+"({\\n"+n+"center: "+this.center.repr(r,t+1)+",\\n"+n+"radianAngle: "+this.radianAngle.repr(r,t+1)+",\\n"+n+"width: "+this.width.repr(r,t+1)+",\\n"+n+"height: "+this.height.repr(r,t+1)+"},\\n"+n+"opacity: "+this.opacity.repr(r,t+1)+",\\n"+n+JSON.stringify(this.moveStrategy)+"\\n"+i+"})"},r.Ticker.prototype.repr=function(r,t){var i=Array(t+1).join("  "),n=i+"  ";return e(this.type,r)+"({\\n"+n+"handler: "+this.handler.repr(r,t+1)+",\\n"+n+"minStep: "+this.minStep.repr(r,t+1)+"\\n"+i+"})"},r.Slider.prototype.repr=function(r,t){var i=Array(t+1).join("  "),n=i+"  ";return e(this.type,r)+"({\\n"+n+"sliderAssignment: "+this.sliderAssignment.repr(r,t+1)+",\\n"+n+"sliderMin: "+(this.sliderMin&&this.sliderMin.repr(r,t+1))+",\\n"+n+"sliderMax: "+(this.sliderMax&&this.sliderMax.repr(r,t+1))+",\\n"+n+"sliderStep: "+(this.sliderStep&&this.sliderStep.repr(r,t+1))+"},\\n"+i+")"}});\ndefine(\'core/math/features/substitute\',[\'require\',\'parsenodes\'],function(require){"use strict";var t=require("parsenodes"),i=function(t,i){return t.map(function(t){return t.substitute(i)})},r={Identifier:function(t){return t[this._symbol]?t[this._symbol]:this},FunctionCall:function(r){var n=r[this._symbol];if(n){if("Identifier"===n.type)return t.FunctionCall(n,i(this.args,r));if("Constant"===n.type)return t.Multiply([n,1===this.args.length?this.args[0].substitute(r):t.Constant(NaN)])}return t.Expression.prototype.substitute.call(this,r)},Constant:function(t){return this},Expression:function(t){return this.copyWithArgs(i(this.args,t))},Derivative:function(r){var n=r[this._symbol];if(n){if("Identifier"===n.type)return t.Derivative(n,i(this.args,r));throw new Error("Cannot substitute for a derivative variable with a non-Identifier")}return t.Derivative(this._symbol,i(this.args,r))}};for(var n in r)t[n].prototype.substitute=r[n]});\ndefine(\'core/math/features/simpleFunctionExpression\',[\'require\',\'parsenodes\'],function(require){"use strict";var n=require("parsenodes");n.Expression.prototype.simpleFunctionExpression=function(){return this},n.Assignment.prototype.simpleFunctionExpression=function(){return this._expression},n.FunctionDefinition.prototype.simpleFunctionExpression=function(){return this._expression},n.Equation.prototype.simpleFunctionExpression=function(){return this.asComparator().simpleFunctionExpression()}});\ndefine(\'core/math/distribution-spec\',["require","exports","core/math/baseparser","tslib"],function(require,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFunctionSpecFromTree=t.parseToplevelFunction=t.DistributionParameterDefaultsMap=void 0,t.DistributionParameterDefaultsMap={normaldist:{type:"distribution",symbol:"normaldist",params:["mean","stdev"],defaults:["0","1"],discrete:!1},tdist:{type:"distribution",symbol:"tdist",params:["dof"],defaults:[void 0],discrete:!1},binomialdist:{type:"distribution",symbol:"binomialdist",params:["trials","probsuccess"],defaults:[void 0,"0.5"],discrete:!0},poissondist:{type:"distribution",symbol:"poissondist",params:["mean"],defaults:[void 0],discrete:!0},uniformdist:{type:"distribution",symbol:"uniformdist",params:["min","max"],defaults:["0","1"],discrete:!1}};var e={Histogram:{type:"visualization",symbol:"histogram",params:["data","binwidth"],defaults:[void 0,"1"]},DotPlot:{type:"visualization",symbol:"dotplot",params:["data","binwidth"],defaults:[void 0,"1"]},BoxPlot:{type:"visualization",symbol:"boxplot",params:["data"],defaults:[void 0]}};function a(i){var a=i,o=e[a.type];if(!o)switch("Assignment"===a.type&&(a=a._expression),a.type){case"FunctionCall":o=t.DistributionParameterDefaultsMap[a._symbol];break;default:return}if(o){for(var r={},n=o.params,d=a.args,l=0;l<n.length;l++){var u=d[l];r[n[l]]=u&&u.getInputString()||""}return s.__assign(s.__assign({},o),{span:a.getInputSpan(),values:r})}}t.parseToplevelFunction=function(t){return a(i.parse(t,{trailingComma:!0}))},t.getFunctionSpecFromTree=a});\ndefine(\'core/lib/number-to-latex\',["require","exports"],function(require,e){"use strict";function r(e){var r=e+"";if(/\\d+\\.?\\d*e[\\+\\-]*\\d+/i.test(r)){var t=String(r).toLowerCase().split("e"),n=parseFloat(t[0]),i=parseInt(t[1],10),a=Math.abs(i),o=Math.abs(n).toString().split(".");if(i<0)r="0."+new Array(a).join("0")+o.join("");else{var f=o[1];f&&(a-=f.length),r=o.join("")+new Array(a+1).join("0")}n<0&&(r="-"+r)}return r}Object.defineProperty(e,"__esModule",{value:!0}),e.numberToStatsConfidenceLatex=e.numberToDecimalString=void 0,e.default=function(e){if("string"==typeof e)return e;if(void 0===e)return"";if(isNaN(e))return"\\\\frac{0}{0}";if(e===1/0)return"\\\\infty";if(e===-1/0)return"-\\\\infty";var r=e+"";return r=(r=r.replace(/^1e\\+?([-\\d]+)/,"10^{$1}")).replace(/([-\\d\\.]+)e\\+?([-\\d]+)/,"$1\\\\cdot 10^{$2}")},e.numberToDecimalString=r,e.numberToStatsConfidenceLatex=function(e,t){void 0===t&&(t=2);var n,i=r(e),a=i.indexOf(".");if(-1===a)return i;for(var o=a+1;o<i.length;o++)if(n){if(i[o]!==n)break}else{if("0"!==i[o]&&"9"!==i[o])break;n=i[o]}return i.substr(0,Math.max(a+5,o+t))}});\ndefine(\'core/math/ir/features/value-to-latex\',["require","exports","core/math/types","../../../lib/number-to-latex"],function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.valueToLatex=void 0,e.valueToLatex=function e(a,i){if(t.isList(a)){for(var u=[],n=0;n<i.length;n++)u.push(e(t.elementType(a),i[n]));return"\\\\left["+u.join(",")+"\\\\right]"}switch(a){case t.Number:return r.default(i);case t.Point:var o=i,l=o[0],f=o[1];return"\\\\left("+r.default(l)+","+r.default(f)+"\\\\right)";default:throw new Error("Cannot serialize a value of type "+t.prettyPrint(a)+".")}}});\ndefine(\'core/math/ir/features/action-to-latex\',["require","exports","../../../lib/label","./value-to-latex"],function(require,e,t,a){"use strict";function o(e,o){var i=e.updateRules[o],r=i.valueType,u=i.value;return t.identifierToLatex(o)+"="+a.valueToLatex(r,u)}Object.defineProperty(e,"__esModule",{value:!0}),e.actionLatexForSymbol=e.actionToLatex=void 0,e.actionToLatex=function(e){var t={};for(var a in e.updateRules)t[a]=o(e,a);return t},e.actionLatexForSymbol=o});\ndefine(\'core/math/evaluationstate\',["require","exports","core/vendor/d3-color","parsenodes","tslib","core/math/errormsg","core/types/graphmode","core/lib/label","core/math/distribution-spec","./types","./ir/features/action-to-latex"],function(require,e,r,i,a,t,n,s,o,l,u){"use strict";function d(e){return e.isError?e.getError():void 0===e.asValue()?"":+e.asValue()}function c(){return{operator:"=",variables:[]}}function p(e,r,i){var a=e.variables;if(a&&a.length){for(var t={},n=0,s=a;n<s.length;n++){t[o=s[n]]=!0}for(var o in i)t[o]=!0;i=t}e.variables=r.sliderVariables(Object.keys(i))}function g(e,r){if(r.blocksExport)return!1;var i=r.getDependencies();if(0===i.length)return!1;for(var a=0,t=i;a<t.length;a++){var n=t[a];if(!e.validActionVariable(n))return!1}return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.isErrorExportableActionDefinition=e.addSliderPrompts=e.EvaluationState=e.defaultEvaluationState=void 0,e.defaultEvaluationState=c,e.EvaluationState=function(e,c,v){if(c.isTable)return function(e,r,i){for(var a=[],t=0;t<r.columns.length;t++){var n=i.columns[t],s=n.isError?[]:n.values.map(d),o={dependent:!n.isIndependent,discrete:!!n.isIndependent,values:s};n.isError&&(o.error=n.getError()),a.push(o)}return{column_data:a}}(0,c,v);if(c.isImage)return function(e,r,a){var t={variables:[],errorMap:{},dimensions:{}};if(a.center.isError&&(t.errorMap.center=!0),a.radianAngle.isError&&(t.errorMap.angle=!0),a.width.isError&&(t.errorMap.width=!0),a.height.isError&&(t.errorMap.height=!0),a.opacity.isError&&(t.errorMap.opacity=!0),a.center.isError||a.radianAngle.isError||a.width.isError||a.height.isError||a.opacity.isError)return t.variables=r.getSliderVariables(e,a),t;t.dimensions.x=[],t.dimensions.y=[],t.dimensions.radianAngle=[],t.dimensions.width=[],t.dimensions.height=[],t.dimensions.opacity=[];var s=[a.center,a.radianAngle,a.width,a.height,a.opacity];return s.some(function(e){return e&&e.valueType&&l.isList(e.valueType)})&&(t.is_concrete_list=!0),i.List.eachArgs(s,function(e){var r=e[0].asValue(),i=+e[1].asValue(),a=Math.atan2(Math.sin(i),Math.cos(i));t.dimensions.x.push(+r[0]),t.dimensions.y.push(+r[1]),t.dimensions.radianAngle.push(a),t.dimensions.width.push(+e[2].asValue()),t.dimensions.height.push(+e[3].asValue()),t.dimensions.opacity.push(Math.max(0,Math.min(1,+e[4].asValue())))}),(e.graphingEnabled()?r.getGraphMode(e,a):n.NONE)!==n.NONE&&(t.is_graphable=!0),a.moveStrategy&&(t.move_strategy=a.moveStrategy),r.center&&("Identifier"===r.center.type?(t.center_reference_id=r.center.referencedStatementId,t.center_reference_symbol=r.center._symbol):"ParenSeq"===r.center.type&&a.center.valueType===l.Point&&(t.center_is_point_literal=!0)),t}(e,c,v);if(c instanceof i.Ticker)return function(e,r,i){for(var n,s=i.handler,o=i.minStep,l={},u={},d=0,c=s.getDependencies();d<c.length;d++){var v=c[d];e.validActionVariable(v)||(l[v]=!0)}for(var f=0,m=o.getDependencies();f<m.length;f++)u[v=m[f]]=!0;if(o.isError)n={status:"error",error:o.getError()};else{var h=o.asValue();n="number"==typeof h&&!isNaN(h)&&h>=0?{status:"valid",value:h}:{status:"error",error:t.tickerMinStepNonNegativeNumber().getError()}}var b=Object.keys(l);b.length>0&&(s=t.tooManyVariables(b).setDependencies(s.getDependencies()));var _={handler:s.isError&&!g(e,s)?{status:"error",error:s.getError()}:s.isEmptyAction?{status:"empty"}:{status:"maybe-valid"},minStep:n,variables:[]};return p(_,e,a.__assign(a.__assign({},l),u)),_}(e,0,v);var f={operator:"=",variables:[]};if(v.isError&&(!(c instanceof i.FunctionDefinition)||v.blocksExport))return f.error=v.getError(),f.variables=c.getSliderVariables(e,v),f.is_single_identifier=c instanceof i.Identifier,v.actionValue&&(f.action_value=u.actionToLatex(v.actionValue)),f;if(v.valueType===l.RGBColor&&0===v.getDependencies().length){var m=v.asValue();f.rgb_value=r.rgb(m[0],m[1],m[2]).formatHex()}v.valueType===l.Action&&0===v.getDependencies().length&&(f.action_value=u.actionToLatex(v.asValue())),v.moveStrategy&&(f.move_strategy=v.moveStrategy,f.default_drag_mode=v.defaultDragMode),c.isInequality()&&(f.is_inequality=!0),f.operator=c.getOperator(),v instanceof i.SolvedEquation?!0!==v._expression.asValue()&&!1!==v._expression.asValue()&&(f.assignment=v._symbol):c instanceof i.Assignment&&(f.assignment=c._symbol);var h=e.graphingEnabled()?c.getGraphMode(e,v):n.NONE;if(h!==n.NONE){f.is_graphable=!0,f.expression_type=c.getExpressionType(h,v.valueType),v.isShadeBetween()&&(f.is_shade_between=!0);var b=c.tableInfo(e,v);b&&(f.is_tableable=!0,f.table_info=b)}if(void 0!==v.valueType&&l.isList(v.valueType)&&(f.is_concrete_list=!0,v.valueType===l.ListOfColor&&0===v.getDependencies().length)){var _=v.asValue();_&&(f.rgb_value=_.map(function(e){return r.rgb(e[0],e[1],e[2]).formatHex()}))}f.variables=f.is_graphable?[]:c.getSliderVariables(e,v),f.is_single_identifier=c instanceof i.Identifier,v.isConstant&&(f.constant_value=v.asValue());var y=v.getEvaluationInfo();if(!y||"="!==f.operator||c.isConstant||c.isFunction||v.valueType===l.Bool||v.valueType===l.ListOfBool||c instanceof i.Equation||c instanceof i.And||(f.is_evaluable=!0,f.zero_values=y),v instanceof i.OptimizedRegression){var E=v,V={};for(var S in E.parameters)E.parameters.hasOwnProperty(S)&&(V[s.identifierToLatex(S)]=+E.parameters[S].asValue());f.is_regression=!0,f.regression={parameters:V,residualVariable:s.identifierToLatex(E.residualVariable),residualSuggestionId:E.residualSuggestionId,shouldSuggestLogMode:E.shouldSuggestLogMode,isLinear:E.isLinear,statistics:E.statistics,parameterWarning:E.parameterWarning}}var x=o.getFunctionSpecFromTree(c);return x&&x.discrete&&(f.is_discrete_distribution=!0),f},e.addSliderPrompts=p,e.isErrorExportableActionDefinition=g});\ndefine(\'core/math/statementanalysis\',[\'require\',\'core/math/evaluationstate\',\'pjs\',\'core/types/graphmode\',\'core/math/workerconfig\'],function(require){"use strict";var e=require("core/math/evaluationstate").EvaluationState,t=require("pjs"),r=require("core/types/graphmode"),i=require("core/math/workerconfig");return t(function(t){t.init=function(t,r,i){this.policy=t,this.rawTree=r,this.concreteTree=i,this.evaluationState=e(t,r,i)},t.exportTo=function(e,t){this.rawTree.exportTo(e,this.concreteTree,t)},t.graph=function(e){return this.rawTree.tryGraph(this.policy,this.concreteTree,e)},t.getGraphMode=function(){return this.rawTree.getGraphMode(this.policy,this.concreteTree)},t.getGraphInfo=function(){return this.rawTree.getGraphInfo(this.policy,this.concreteTree)},t.shouldIntersect=function(){if(!this.evaluationState.is_graphable)return!1;if(!this.rawTree.userData.shouldGraph)return!1;if(!i.pointsOfInterest)return!1;var e=this.getGraphMode();return e===r.X||e===r.Y}})});\ndefine(\'core/math/expression-types\',["require","exports"],function(require,i){"use strict";var s;Object.defineProperty(i,"__esModule",{value:!0}),i.isClickableExpressionType=i.getReconciledExpressionProps=i.EXPRESSION_PROP_DEFAULTS=i.ExpressionType=void 0,function(i){i.X_OR_Y="X_OR_Y",i.SINGLE_POINT="SINGLE_POINT",i.POINT_LIST="POINT_LIST",i.PARAMETRIC="PARAMETRIC",i.POLAR="POLAR",i.IMPLICIT="IMPLICIT",i.POLYGON="POLYGON",i.HISTOGRAM="HISTOGRAM",i.DOTPLOT="DOTPLOT",i.BOXPLOT="BOXPLOT",i.TTEST="TTEST",i.STATS="STATS",i.CUBE="CUBE",i.SPHERE="SPHERE"}(s=i.ExpressionType||(i.ExpressionType={})),i.EXPRESSION_PROP_DEFAULTS={X_OR_Y:{points:!1,lines:!0,fill:!1},SINGLE_POINT:{points:!0,lines:!1,fill:!1},POINT_LIST:{points:!0,lines:!1,fill:!1},PARAMETRIC:{points:!1,lines:!0,fill:!1},POLAR:{points:!1,lines:!0,fill:!1},IMPLICIT:{points:!1,lines:!0,fill:!1},POLYGON:{points:!1,lines:!0,fill:!0},HISTOGRAM:{points:!1,lines:!0,fill:!0},DOTPLOT:{points:!0,lines:!1,fill:!1},BOXPLOT:{points:!1,lines:!0,fill:!1},TTEST:{points:!1,lines:!1,fill:!1},STATS:{points:!1,lines:!1,fill:!1},CUBE:{points:!1,lines:!1,fill:!0},SPHERE:{points:!1,lines:!1,fill:!0}},i.getReconciledExpressionProps=function(e,T){if(void 0===e)return{points:!1,lines:!1,fill:!1};var l=i.EXPRESSION_PROP_DEFAULTS[e];switch(e){case s.SINGLE_POINT:return{points:!0,lines:!1,fill:!1};case s.POINT_LIST:case s.DOTPLOT:return{points:void 0===T.points?l.points:T.points,lines:void 0===T.lines?l.lines:T.lines,fill:!1};case s.PARAMETRIC:case s.POLYGON:case s.X_OR_Y:case s.POLAR:case s.IMPLICIT:case s.HISTOGRAM:case s.BOXPLOT:case s.TTEST:case s.STATS:case s.CUBE:case s.SPHERE:return{points:!1,lines:void 0===T.lines?l.lines:T.lines,fill:void 0===T.fill?l.fill:T.fill};default:return e}},i.isClickableExpressionType=function(i){if(void 0===i)return!1;switch(i){case s.SINGLE_POINT:case s.POINT_LIST:case s.PARAMETRIC:case s.POLYGON:case s.X_OR_Y:case s.POLAR:case s.IMPLICIT:return!0;case s.HISTOGRAM:case s.BOXPLOT:case s.DOTPLOT:case s.TTEST:case s.STATS:case s.CUBE:case s.SPHERE:return!1;default:return i}}});\ndefine(\'core/math/ir/features/reapply-restrictions\',["require","exports","../instructions","../opcodes","./get-dependency-mask"],function(require,e,r,n,t){"use strict";function s(e,r){for(var n=[],t=0,s=r;t<s.length;t++){var i=s[t];n.push(e[i])}return n}Object.defineProperty(e,"__esModule",{value:!0}),e.reapplyRestrictions=void 0,e.reapplyRestrictions=function(e,i){for(var p=[],o=e.returnIndex,u=t.getDependencyMask(e,i.mappedArgIndex),c=function(e,t,s){for(var i=[],p=0;p<s;p++)i.push(!1);i[s]=t[s];for(p=s;p>=0;p--)if(i[p]&&t[p]){var o=e.getInstruction(p);if(o.type===n.Piecewise)i[o.args[1]]=!0;else if(!r.isLeafInstruction(o))for(var u=0,c=o.args;u<c.length;u++){i[c[u]]=!0}}return i}(e,u,i.mappedReturnIndex),a=o,f=e.NanOfType(e.getReturnType()),d=0;d<i.mappedReturnIndex;d++){var g=e.getInstruction(d);if(d!==i.mappedArgIndex)if(u[d]||e.isInClosedBlock(d))if(r.isLeafInstruction(g))p.push(e.copyInstruction(g));else{var l=s(p,g.args);p.push(e.copyInstructionWithArgs(g,l)),g.type===n.Piecewise&&c[d]&&(a=e.Piecewise([l[0],a,f]))}else p.push(d);else p.push(o)}return a}});\ndefine(\'core/math/ir/features/solve\',["require","exports","parsenodes","core/math/workerconfig","core/math/parsenode/irexpression","core/math/errormsg","../build-ir","../dependencies","core/math/comparators","../opcodes","./fuse-broadcast","./reapply-restrictions","core/math/types","core/math/maybe-rational"],function(require,e,i,r,t,a,n,s,c,l,o,u,d,v){"use strict";function f(e,i){return i?function(e){var i=e.chunk,r=e.coefficients,t=r[0],a=r[1],n=r[2],s=i.Constant(v.maybeRational(0,1));void 0===n&&(n=s);void 0===a&&(a=s);void 0===t&&(t=s);var c=i.Constant(v.maybeRational(2,1)),l=i.Constant(NaN),o=i.Constant(v.maybeRational(1e305,1)),u=i.Negative([o]),d=i.Multiply([c,n]),f=i.Negative([a]),p=i.Subtract([i.Multiply([a,a]),i.Multiply([c,i.Multiply([d,t])])]),g=i.SyntheticNativeFunction("sqrt",[p]),m=i.Divide([i.Add([f,g]),d]),y=i.Divide([i.Subtract([f,g]),d]),b=i.Negative([i.Divide([t,a])]),h=i.Equal([n,s]),w=i.Greater([n,s]),P=i.Equal([a,s]),I=i.Greater([a,s]),N=i.Less([a,s]),O=i.Greater([t,s]),q=i.Less([p,s]);return[i.Piecewise([h,i.Piecewise([N,b,l]),i.Piecewise([w,y,l])]),i.Piecewise([h,i.Piecewise([P,i.Piecewise([O,u,l]),l]),i.Piecewise([w,i.Piecewise([q,u,l]),m])]),i.Piecewise([h,i.Piecewise([P,i.Piecewise([O,o,l]),l]),i.Piecewise([w,i.Piecewise([q,o,l]),y])]),i.Piecewise([h,i.Piecewise([I,b,l]),i.Piecewise([w,m,l])])]}(e):function(e){var i=e.chunk,r=e.coefficients,t=r[0],a=r[1],n=r[2],s=i.Constant(v.maybeRational(0,1)),c=i.Constant(NaN);if(void 0===n){void 0===a&&(a=s);var o=i.Negative([i.Divide([t,a])]),u=i.Equal([a,s]);return[i.Piecewise([u,c,o])]}var d=i.Constant(v.maybeRational(2,1)),f=i.Multiply([d,n]),p=i.Negative([a]),g=i.Subtract([i.Multiply([a,a]),i.Multiply([d,i.Multiply([f,t])])]),m=i.Equal([n,s]),y=i.getInstruction(g);if(y.type===l.Constant&&0===v.asFloat(y.value))return[i.Piecewise([m,c,i.Divide([p,f])])];var b=i.SyntheticNativeFunction("sqrt",[g]),h=i.Less([a,s]),w=i.Greater([a,s]),P=i.Divide([i.Add([p,b]),f]),I=i.Divide([i.Subtract([p,b]),f]);o=i.Negative([i.Divide([t,a])]);return[i.Piecewise([m,i.Piecewise([h,o,c]),I]),i.Piecewise([m,i.Piecewise([w,o,c]),P])]}(e)}Object.defineProperty(e,"__esModule",{value:!0}),e.trySolve=void 0,e.trySolve=function(e,v){try{return function(e,v){for(var p=e.policy,g=e.frame,m=s.getFreeDependencies(g,v),y=[],b=0;b<m.length;b++)y.push(d.Number);var h=n.buildIRContext({policy:p,frame:g,argNames:m,argTypes:y}),w=h.chunk,P=n.addToIR(h,v.args[0]),I=n.addToIR(h,v.args[1]),N=v.getOperator(),O="="!==N;switch(N){case"<":w.Less([P,I]);break;case">":w.Greater([P,I]);break;case"<=":w.LessEqual([P,I]);break;case">=":w.GreaterEqual([P,I]);break;case"=":w.Equal([P,I])}if(w.returnIndex=o.fuseBroadcast(w,w.returnIndex),w.isConstant())return new t(w.close());var q=w.getInstruction(P).type!==l.LoadArg||-1!==s.getFreeDependencies(g,v.args[1]).indexOf(w.argNames[P]);if(!r.plotImplicits&&q)throw a.implicitsDisabled();-1===c.table[N].direction?w.Subtract([I,P]):w.Subtract([P,I]);w.close();var D=w.getLiveArgNames();if(0===D.length)throw a.parseError();if(1===D.length&&!O&&!r.plotSingleVariableImplicitEquations)return a.singleVariableImplicitEquationsDisabled();if(D.length>2)return a.tooManyVariables(p.sliderVariables(D)).setDependencies(D);if(O&&!p.validInequalityVariables(D))return a.invalidInequalityVariables().setDependencies(D);var C=function(e,i){var r=e.chunk,t=e.policy,a=r.argNames,n=d.isList(r.getReturnType()),s=[];e:for(var c=0;c<a.length;c++){var l=a[c],o=a.length>1&&!t.validSolvedVariable(l);s[c]={localFrames:[],effectiveOrder:0,variableOfInterest:l};var u=!i;if(o)s[c].effectiveOrder=1/0;else{var v=n?r.getConstantListLength():1;if(null==v)throw new Error("Programming error: cannot solve a variable-length list expression");for(var f=0;f<v;f++){var p=n?r.elementAt(f):r;if(p.polynomialOrder(l,{allowRestriction:u,allowClosedBlockReferences:!1})>2){s[c].effectiveOrder=1/0;continue e}var g=p.getPolynomialCoefficients(l);s[c].localFrames.push(g),s[c].effectiveOrder=Math.max(s[c].effectiveOrder,g.coefficients.length-1)}}}return 1===a.length?s[0]:("y"===a[0]&&(s=[s[1],s[0]]),0===s[0].effectiveOrder?s[1]:0===s[1].effectiveOrder?s[0]:s[s[0].effectiveOrder<s[1].effectiveOrder?0:1])}(h,O),E=C.localFrames,R=C.effectiveOrder,S=C.variableOfInterest;if(p.complicatedPolarImplicit(S,R))return a.complicatedPolarImplicit().setDependencies(D);if(!p.validImplicitVariables(D))return a.invalidImplicitVariables();if(R>2)return new t(w.close());for(var k=[],L=1,M=0,x=E;M<x.length;M++){var V=x[M],F=f(V,O);L=F.length;for(var G=0,A=F;G<A.length;G++){var T=A[G],B=V.chunk.copy();B.returnIndex=T,V.isRestrictedPolynomial&&(B.returnIndex=u.reapplyRestrictions(B,V)),B.close(),k.push(new t(B))}}return i.SolvedEquation(S,i.List(k),L)}(e,v)}catch(e){return e instanceof i.Base?e:a.parseError()}}});\ndefine(\'numeric\',[],function(){"use strict";var r="undefined"==typeof exports?function(){}:exports;return"undefined"!=typeof global&&(global.numeric=r),r.version="1.2.6",r._myIndexOf=function(r){var n,e=this.length;for(n=0;n<e;++n)if(this[n]===r)return n;return-1},r.myIndexOf=Array.prototype.indexOf?Array.prototype.indexOf:r._myIndexOf,r.precision=4,r.largeArray=50,r.compile=function(){var n=Array.prototype.slice.call(arguments),e=n.pop();return e="return function ("+n.join(",")+") {"+e+"}",new Function(["numeric"],e)(r)},r._dim=function(r){for(var n=[];"object"==typeof r;)n.push(r.length),r=r[0];return n},r.dim=function(n){var e;return"object"==typeof n?"object"==typeof(e=n[0])?"object"==typeof e[0]?r._dim(n):[n.length,e.length]:[n.length]:[]},r.mapreduce=function(n,e){return r.compile("x","accum","_s","_k",\'if(typeof accum === "undefined") accum = \'+e+\';\\nif(typeof x === "number") { var xi = x; \'+n+\'; return accum; }\\nif(typeof _s === "undefined") _s = numeric.dim(x);\\nif(typeof _k === "undefined") _k = 0;\\nvar _n = _s[_k];\\nvar i,xi;\\nif(_k < _s.length-1) {\\n    for(i=_n-1;i>=0;i--) {\\n        accum = arguments.callee(x[i],accum,_s,_k+1);\\n    }    return accum;\\n}\\nfor(i=_n-1;i>=1;i-=2) { \\n    xi = x[i];\\n    \'+n+";\\n    xi = x[i-1];\\n    "+n+";\\n}\\nif(i === 0) {\\n    xi = x[i];\\n    "+n+"\\n}\\nreturn accum;")},r.mapreduce2=function(n,e){return r.compile("x","var n = x.length;\\nvar i,xi;\\n"+e+"\\nfor(i=n-1;i!==-1;--i) { \\n    xi = x[i];\\n    "+n+"\\n}\\nreturn accum;")},r.rep=function(n,e,t){void 0===t&&(t=0);var i,o=n[t],a=Array(o);if(t===n.length-1){for(i=o-2;i>=0;i-=2)a[i+1]=e,a[i]=e;return-1===i&&(a[0]=e),a}for(i=o-1;i>=0;i--)a[i]=r.rep(n,e,t+1);return a},r.dotMMsmall=function(r,n){var e,t,i,o,a,f,u,c,s,m,l;for(o=r.length,a=n.length,f=n[0].length,u=Array(o),e=o-1;e>=0;e--){for(c=Array(f),s=r[e],i=f-1;i>=0;i--){for(m=s[a-1]*n[a-1][i],t=a-2;t>=1;t-=2)l=t-1,m+=s[t]*n[t][i]+s[l]*n[l][i];0===t&&(m+=s[0]*n[0][i]),c[i]=m}u[e]=c}return u},r._getCol=function(r,n,e){var t;for(t=r.length-1;t>0;--t)e[t]=r[t][n],e[--t]=r[t][n];0===t&&(e[0]=r[0][n])},r.dotMMbig=function(n,e){var t,i,o,a=r._getCol,f=e.length,u=Array(f),c=n.length,s=e[0].length,m=new Array(c),l=r.dotVV;for(--f,i=--c;-1!==i;--i)m[i]=Array(s);for(i=--s;-1!==i;--i)for(a(e,i,u),o=c;-1!==o;--o)0,t=n[o],m[o][i]=l(t,u);return m},r.dotMV=function(n,e){var t,i=n.length,o=(e.length,Array(i)),a=r.dotVV;for(t=i-1;t>=0;t--)o[t]=a(n[t],e);return o},r.dotVM=function(r,n){var e,t,i,o,a,f,u;for(i=r.length,o=n[0].length,a=Array(o),t=o-1;t>=0;t--){for(f=r[i-1]*n[i-1][t],e=i-2;e>=1;e-=2)u=e-1,f+=r[e]*n[e][t]+r[u]*n[u][t];0===e&&(f+=r[0]*n[0][t]),a[t]=f}return a},r.dotVV=function(r,n){var e,t,i=r.length,o=r[i-1]*n[i-1];for(e=i-2;e>=1;e-=2)t=e-1,o+=r[e]*n[e]+r[t]*n[t];return 0===e&&(o+=r[0]*n[0]),o},r.dot=function(n,e){var t=r.dim;switch(1e3*t(n).length+t(e).length){case 2002:return e.length<10?r.dotMMsmall(n,e):r.dotMMbig(n,e);case 2001:return r.dotMV(n,e);case 1002:return r.dotVM(n,e);case 1001:return r.dotVV(n,e);case 1e3:return r.mulVS(n,e);case 1:return r.mulSV(n,e);case 0:return n*e;default:throw new Error("numeric.dot only works on vectors and matrices")}},r.diag=function(r){var n,e,t,i,o=r.length,a=Array(o);for(n=o-1;n>=0;n--){for(i=Array(o),e=n+2,t=o-1;t>=e;t-=2)i[t]=0,i[t-1]=0;for(t>n&&(i[t]=0),i[n]=r[n],t=n-1;t>=1;t-=2)i[t]=0,i[t-1]=0;0===t&&(i[0]=0),a[n]=i}return a},r.getDiag=function(r){var n,e=Math.min(r.length,r[0].length),t=Array(e);for(n=e-1;n>=1;--n)t[n]=r[n][n],t[--n]=r[n][n];return 0===n&&(t[0]=r[0][0]),t},r.identity=function(n){return r.diag(r.rep([n],1))},r.pointwise=function(n,e,t){void 0===t&&(t="");var i,o,a=[],f=/\\[i\\]$/,u="",c=!1;for(i=0;i<n.length;i++)f.test(n[i])?u=o=n[i].substring(0,n[i].length-3):o=n[i],"ret"===o&&(c=!0),a.push(o);return a[n.length]="_s",a[n.length+1]="_k",a[n.length+2]=\'if(typeof _s === "undefined") _s = numeric.dim(\'+u+\');\\nif(typeof _k === "undefined") _k = 0;\\nvar _n = _s[_k];\\nvar i\'+(c?"":", ret = Array(_n)")+";\\nif(_k < _s.length-1) {\\n    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+n.join(",")+",_s,_k+1);\\n    return ret;\\n}\\n"+t+"\\nfor(i=_n-1;i!==-1;--i) {\\n    "+e+"\\n}\\nreturn ret;",r.compile.apply(null,a)},r.pointwise2=function(n,e,t){void 0===t&&(t="");var i,o,a=[],f=/\\[i\\]$/,u="",c=!1;for(i=0;i<n.length;i++)f.test(n[i])?u=o=n[i].substring(0,n[i].length-3):o=n[i],"ret"===o&&(c=!0),a.push(o);return a[n.length]="var _n = "+u+".length;\\nvar i"+(c?"":", ret = Array(_n)")+";\\n"+t+"\\nfor(i=_n-1;i!==-1;--i) {\\n"+e+"\\n}\\nreturn ret;",r.compile.apply(null,a)},r._biforeach=function r(n,e,t,i,o){var a;if(i!==t.length-1)for(a=t[i]-1;a>=0;a--)r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,t,i+1,o);else o(n,e)},r._biforeach2=function r(n,e,t,i,o){if(i===t.length-1)return o(n,e);var a,f=t[i],u=Array(f);for(a=f-1;a>=0;--a)u[a]=r("object"==typeof n?n[a]:n,"object"==typeof e?e[a]:e,t,i+1,o);return u},r._foreach=function r(n,e,t,i){var o;if(t!==e.length-1)for(o=e[t]-1;o>=0;o--)r(n[o],e,t+1,i);else i(n)},r._foreach2=function r(n,e,t,i){if(t===e.length-1)return i(n);var o,a=e[t],f=Array(a);for(o=a-1;o>=0;o--)f[o]=r(n[o],e,t+1,i);return f},r.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},r.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",bandeq:"&=",boreq:"|=",bxoreq:"^="},r.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan","isNaN","isFinite"],r.mathfuns2=["atan2","pow","max","min"],r.ops1={neg:"-",not:"!",bnot:"~",clone:""},r.mapreducers={any:["if(xi) return true;","var accum = false;"],all:["if(!xi) return false;","var accum = true;"],sum:["accum += xi;","var accum = 0;"],prod:["accum *= xi;","var accum = 1;"],norm2Squared:["accum += xi*xi;","var accum = 0;"],norminf:["accum = max(accum,abs(xi));","var accum = 0, max = Math.max, abs = Math.abs;"],norm1:["accum += abs(xi);","var accum = 0, abs = Math.abs;"],sup:["accum = max(accum,xi);","var accum = -Infinity, max = Math.max;"],inf:["accum = min(accum,xi);","var accum = Infinity, min = Math.min;"]},function(){var n,e;for(n=0;n<r.mathfuns2.length;++n)e=r.mathfuns2[n],r.ops2[e]=e;for(n in r.ops2)if(r.ops2.hasOwnProperty(n)){e=r.ops2[n];var t,i,o="";-1!==r.myIndexOf.call(r.mathfuns2,n)?(o="var "+e+" = Math."+e+";\\n",t=function(r,n,t){return r+" = "+e+"("+n+","+t+")"},i=function(r,n){return r+" = "+e+"("+r+","+n+")"}):(t=function(r,n,t){return r+" = "+n+" "+e+" "+t},i=r.opseq.hasOwnProperty(n+"eq")?function(r,n){return r+" "+e+"= "+n}:function(r,n){return r+" = "+r+" "+e+" "+n}),r[n+"VV"]=r.pointwise2(["x[i]","y[i]"],t("ret[i]","x[i]","y[i]"),o),r[n+"SV"]=r.pointwise2(["x","y[i]"],t("ret[i]","x","y[i]"),o),r[n+"VS"]=r.pointwise2(["x[i]","y"],t("ret[i]","x[i]","y"),o),r[n]=r.compile("var n = arguments.length, i, x = arguments[0], y;\\nvar VV = numeric."+n+"VV, VS = numeric."+n+"VS, SV = numeric."+n+\'SV;\\nvar dim = numeric.dim;\\nfor(i=1;i!==n;++i) { \\n  y = arguments[i];\\n  if(typeof x === "object") {\\n      if(typeof y === "object") x = numeric._biforeach2(x,y,dim(x),0,VV);\\n      else x = numeric._biforeach2(x,y,dim(x),0,VS);\\n  } else if(typeof y === "object") x = numeric._biforeach2(x,y,dim(y),0,SV);\\n  else \'+i("x","y")+"\\n}\\nreturn x;\\n"),r[e]=r[n],r[n+"eqV"]=r.pointwise2(["ret[i]","x[i]"],i("ret[i]","x[i]"),o),r[n+"eqS"]=r.pointwise2(["ret[i]","x"],i("ret[i]","x"),o),r[n+"eq"]=r.compile("var n = arguments.length, i, x = arguments[0], y;\\nvar V = numeric."+n+"eqV, S = numeric."+n+\'eqS\\nvar s = numeric.dim(x);\\nfor(i=1;i!==n;++i) { \\n  y = arguments[i];\\n  if(typeof y === "object") numeric._biforeach(x,y,s,0,V);\\n  else numeric._biforeach(x,y,s,0,S);\\n}\\nreturn x;\\n\')}for(n=0;n<r.mathfuns2.length;++n)e=r.mathfuns2[n],delete r.ops2[e];for(n=0;n<r.mathfuns.length;++n)e=r.mathfuns[n],r.ops1[e]=e;for(n in r.ops1)r.ops1.hasOwnProperty(n)&&(o="",e=r.ops1[n],-1!==r.myIndexOf.call(r.mathfuns,n)&&Math.hasOwnProperty(e)&&(o="var "+e+" = Math."+e+";\\n"),r[n+"eqV"]=r.pointwise2(["ret[i]"],"ret[i] = "+e+"(ret[i]);",o),r[n+"eq"]=r.compile("x",\'if(typeof x !== "object") return \'+e+"x\\nvar i;\\nvar V = numeric."+n+"eqV;\\nvar s = numeric.dim(x);\\nnumeric._foreach(x,s,0,V);\\nreturn x;\\n"),r[n+"V"]=r.pointwise2(["x[i]"],"ret[i] = "+e+"(x[i]);",o),r[n]=r.compile("x",\'if(typeof x !== "object") return \'+e+"(x)\\nvar i;\\nvar V = numeric."+n+"V;\\nvar s = numeric.dim(x);\\nreturn numeric._foreach2(x,s,0,V);\\n"));for(n=0;n<r.mathfuns.length;++n)e=r.mathfuns[n],delete r.ops1[e];for(n in r.mapreducers)r.mapreducers.hasOwnProperty(n)&&(e=r.mapreducers[n],r[n+"V"]=r.mapreduce2(e[0],e[1]),r[n]=r.compile("x","s","k",e[1]+\'if(typeof x !== "object") {    xi = x;\\n\'+e[0]+\'\\n    return accum;\\n}if(typeof s === "undefined") s = numeric.dim(x);\\nif(typeof k === "undefined") k = 0;\\nif(k === s.length-1) return numeric.\'+n+"V(x);\\nvar xi;\\nvar n = x.length, i;\\nfor(i=n-1;i!==-1;--i) {\\n   xi = arguments.callee(x[i]);\\n"+e[0]+"\\n}\\nreturn accum;\\n"))}(),r.inv=function(n){var e,t,i,o,a,f,u,c=r.dim(n),s=Math.abs,m=c[0],l=c[1],h=r.clone(n),d=r.identity(m);for(f=0;f<l;++f){var p=-1,y=-1;for(a=f;a!==m;++a)(u=s(h[a][f]))>y&&(p=a,y=u);for(t=h[p],h[p]=h[f],h[f]=t,o=d[p],d[p]=d[f],d[f]=o,n=t[f],u=f;u!==l;++u)t[u]/=n;for(u=l-1;-1!==u;--u)o[u]/=n;for(a=m-1;-1!==a;--a)if(a!==f){for(e=h[a],i=d[a],n=e[f],u=f+1;u!==l;++u)e[u]-=t[u]*n;for(u=l-1;u>0;--u)i[u]-=o[u]*n,i[--u]-=o[u]*n;0===u&&(i[0]-=o[0]*n)}}return d},r.det=function(n){var e=r.dim(n);if(2!==e.length||e[0]!==e[1])throw new Error("numeric: det() only works on square matrices");var t,i,o,a,f,u,c,s,m=e[0],l=1,h=r.clone(n);for(i=0;i<m-1;i++){for(o=i,t=i+1;t<m;t++)Math.abs(h[t][i])>Math.abs(h[o][i])&&(o=t);for(o!==i&&(c=h[o],h[o]=h[i],h[i]=c,l*=-1),a=h[i],t=i+1;t<m;t++){for(u=(f=h[t])[i]/a[i],o=i+1;o<m-1;o+=2)s=o+1,f[o]-=a[o]*u,f[s]-=a[s]*u;o!==m&&(f[o]-=a[o]*u)}if(0===a[i])return 0;l*=a[i]}return l*h[i][i]},r.transpose=function(r){var n,e,t,i,o,a=r.length,f=r[0].length,u=Array(f);for(e=0;e<f;e++)u[e]=Array(a);for(n=a-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=f-1;e>=1;--e)(o=u[e])[n]=i[e],o[n-1]=t[e],(o=u[--e])[n]=i[e],o[n-1]=t[e];0===e&&((o=u[0])[n]=i[0],o[n-1]=t[0])}if(0===n){for(t=r[0],e=f-1;e>=1;--e)u[e][0]=t[e],u[--e][0]=t[e];0===e&&(u[0][0]=t[0])}return u},r.negtranspose=function(r){var n,e,t,i,o,a=r.length,f=r[0].length,u=Array(f);for(e=0;e<f;e++)u[e]=Array(a);for(n=a-1;n>=1;n-=2){for(i=r[n],t=r[n-1],e=f-1;e>=1;--e)(o=u[e])[n]=-i[e],o[n-1]=-t[e],(o=u[--e])[n]=-i[e],o[n-1]=-t[e];0===e&&((o=u[0])[n]=-i[0],o[n-1]=-t[0])}if(0===n){for(t=r[0],e=f-1;e>=1;--e)u[e][0]=-t[e],u[--e][0]=-t[e];0===e&&(u[0][0]=-t[0])}return u},r.norm2=function(n){return Math.sqrt(r.norm2Squared(n))},r.linspace=function(r,n,e){if(void 0===e&&(e=Math.max(Math.round(n-r)+1,1)),e<2)return 1===e?[r]:[];var t,i=Array(e);for(t=--e;t>=0;t--)i[t]=(t*n+(e-t)*r)/e;return i},r.getBlock=function(n,e,t){var i=r.dim(n);return function r(n,o){var a,f=e[o],u=t[o]-f,c=Array(u);if(o===i.length-1){for(a=u;a>=0;a--)c[a]=n[a+f];return c}for(a=u;a>=0;a--)c[a]=r(n[a+f],o+1);return c}(n,0)},r.setBlock=function(n,e,t,i){var o=r.dim(n);return function r(n,i,a){var f,u=e[a],c=t[a]-u;if(a===o.length-1)for(f=c;f>=0;f--)n[f+u]=i[f];for(f=c;f>=0;f--)r(n[f+u],i[f],a+1)}(n,i,0),n},r.getRange=function(r,n,e){var t,i,o,a,f=n.length,u=e.length,c=Array(f);for(t=f-1;-1!==t;--t)for(c[t]=Array(u),o=c[t],a=r[n[t]],i=u-1;-1!==i;--i)o[i]=a[e[i]];return c},r.blockMatrix=function(n){var e=r.dim(n);if(e.length<4)return r.blockMatrix([n]);var t,i,o,a,f,u=e[0],c=e[1];for(t=0,i=0,o=0;o<u;++o)t+=n[o][0].length;for(a=0;a<c;++a)i+=n[0][a][0].length;var s=Array(t);for(o=0;o<t;++o)s[o]=Array(i);var m,l,h,d,p,y=0;for(o=0;o<u;++o){for(m=i,a=c-1;-1!==a;--a)for(m-=(f=n[o][a])[0].length,h=f.length-1;-1!==h;--h)for(p=f[h],l=s[y+h],d=p.length-1;-1!==d;--d)l[m+d]=p[d];y+=n[o][0].length}return s},r.tensor=function(n,e){if("number"==typeof n||"number"==typeof e)return r.mul(n,e);var t=r.dim(n),i=r.dim(e);if(1!==t.length||1!==i.length)throw new Error("numeric: tensor product is only defined for vectors");var o,a,f,u,c=t[0],s=i[0],m=Array(c);for(a=c-1;a>=0;a--){for(o=Array(s),u=n[a],f=s-1;f>=3;--f)o[f]=u*e[f],o[--f]=u*e[f],o[--f]=u*e[f],o[--f]=u*e[f];for(;f>=0;)o[f]=u*e[f],--f;m[a]=o}return m},r.epsilon=2220446049250313e-31,r.LU=function(n,e){e=e||!1;var t,i,o,a,f,u,c,s,m,l=Math.abs,h=n.length,d=h-1,p=new Array(h);for(e||(n=r.clone(n)),o=0;o<h;++o){for(c=o,m=l((u=n[o])[o]),i=o+1;i<h;++i)m<(a=l(n[i][o]))&&(m=a,c=i);for(p[o]=c,c!=o&&(n[o]=n[c],n[c]=u,u=n[o]),f=u[o],t=o+1;t<h;++t)n[t][o]/=f;for(t=o+1;t<h;++t){for(s=n[t],i=o+1;i<d;++i)s[i]-=s[o]*u[i],s[++i]-=s[o]*u[i];i===d&&(s[i]-=s[o]*u[i])}}return{LU:n,P:p}},r.LUsolve=function(n,e){var t,i,o,a,f,u=n.LU,c=u.length,s=r.clone(e),m=n.P;for(t=c-1;-1!==t;--t)s[t]=e[t];for(t=0;t<c;++t)for(o=m[t],m[t]!==t&&(f=s[t],s[t]=s[o],s[o]=f),a=u[t],i=0;i<t;++i)s[t]-=s[i]*a[i];for(t=c-1;t>=0;--t){for(a=u[t],i=t+1;i<c;++i)s[t]-=s[i]*a[i];s[t]/=a[t]}return s},r.solve=function(n,e,t){return r.LUsolve(r.LU(n,t),e)},r});\ndefine(\'core/math/qr\',["require","exports"],function(require,r){"use strict";function t(r,t){for(var n=r.length,e=t.length,a=0,l=0,h=e-n;h<e;h++)a+=r[h+n-e]*t[h],l+=r[h+n-e]*r[h+n-e];var o=a/l;for(h=e-n;h<e;h++)t[h]=2*o*r[h+n-e]-t[h]}function n(r,t,n){for(var e=r.length,a=t.length,l=0,h=0,o=a-e;o<a;o++)l+=r[o+e-a]*t[o][n],h+=r[o+e-a]*r[o+e-a];var f=l/h;for(o=a-e;o<a;o++)t[o][n]=2*f*r[o+e-a]-t[o][n]}function e(r,t,n,e){var a=Array(r.length-t);if(1===a.length)return a[0]=1,a;if(0===e){a[0]=1;for(var l=1;l<a.length;l++)a[l]=0;return a}var h=r[t][n]<0?-1:1;a[0]=r[t][n]+h*Math.sqrt(e);for(var o=t+1;o<r.length;o++)a[o-t]=r[o][n];return a}function a(r,t,n){for(var e=0;t<r.length;t++)e+=r[t][n]*r[t][n];return e}function l(r,n,e){for(var a=r.reflectors,l=r.r,h=r.p,o=n.slice(),f=0;f<a.length;f++)t(a[f],o);for(f=a.length;f<l[0].length;f++)o[f]=0;o.length=l[0].length;var g=Math.pow(2,-52),i=e.regularize?g*Math.abs(l[0][0])*Math.max(l.length,l[0].length):0;for(f=a.length-1;f>=0;f--){var u=l[f];if(Math.abs(u[f])<=i)o[f]=0;else{for(var v=f+1;v<a.length;v++)o[f]-=o[v]*u[v];o[f]/=u[f]}}for(f=h.length-1;f>=0;f--)if(h[f]!==f){var c=o[f];o[f]=o[h[f]],o[h[f]]=c}return o}function h(r){var t=r.r,n=Math.min(t.length,t[0].length),e=t[0][0],a=t[n-1][n-1];return 0===e?1/0:Math.abs(e/a)}Object.defineProperty(r,"__esModule",{value:!0}),r.isNumericallyFullRank=r.conditionNumber=r.qrSolve=r.qr=void 0,r.qr=function(r,t){if(!t||!t.mutateInput){var l=r;r=Array(r.length);for(var h=0;h<l.length;h++)r[h]=l[h].slice()}for(var o=Math.min(r.length,r[0].length),f=Array(o),g=[],i=0;i<o;i++){for(var u=-1/0,v=i,c=i;c<r[i].length;c++){var s=a(r,i,c);s>u&&(u=s,v=c)}if(f[i]=v,v!==i)for(h=0;h<r.length;h++){var y=r[h][v];r[h][v]=r[h][i],r[h][i]=y}var M=e(r,i,i,u);for(c=i;c<r[i].length;c++)n(M,r,c);g.push(M)}return{reflectors:g,r:r,p:f}},r.qrSolve=function(r,t,n){return Array.isArray(t[0])?function(r,t,n){for(var e=Array(r.r[0].length),a=0;a<e.length;a++)e[a]=Array(t[0].length);for(var h=Array(t.length),o=0;o<t[0].length;o++){for(a=0;a<t.length;a++)h[a]=t[a][o];var f=l(r,h,n);for(a=0;a<f.length;a++)e[a][o]=f[a]}return e}(r,t,n):l(r,t,n)},r.conditionNumber=h,r.isNumericallyFullRank=function(r){var t=Math.pow(2,-52);return Math.max(r.r.length,r.r[0].length)*t*h(r)<1}});\ndefine(\'core/math/least-squares\',["require","exports","numeric","core/math/distance","./qr"],function(require,r,e,n,t){"use strict";function a(r,e){for(var n=[],t=0;t<e;t++)n.push(r);return n}function i(r,e){for(var n=o(r,e),t=0,a=0,i=n;a<i.length;a++){var u=i[a];t+=u*u}return t/n.length}function o(r,e){return r.apply(void 0,e)}function u(r,e){for(var n=[],t=0,a=r;t<a.length;t++){var i=a[t].apply(void 0,e);n.push(i)}return n}function s(r,e){for(var n=[],t=0;t<r.length;t++)e[t]&&n.push(r[t]);return n}function l(r,e,n){for(var t=[],a=0,i=0;a<r.length;a++){var o=0;n[a]&&(o=e[i],i+=1),t.push(r[a]+o)}return t}function v(r,n,v,f){var S,p=f.maxIterations,g=f.linearSubset||a(!1,v.length),h=e.not(g),d=s(n,g),M=s(n,h),c=v,E=0,m=.001;if(e.any(g)){S={Jv:G=e.transpose(u(d,c)),F:N=t.qr(G)};var q=o(r,c);c=l(c,e.neg(t.qrSolve(N,q,{regularize:!0})),g)}for(var b=!1,x=i(r,c);E<p&&!b&&isFinite(x);){q=o(r,c);var y=u(M,c),z=e.transpose(y),I=void 0,F=void 0;if(S){var N=S.F,G=S.Jv;I=e.dot(y,e.sub(q,e.dot(G,t.qrSolve(N,q,{regularize:!0})))),F=e.dot(y,e.sub(z,e.dot(G,t.qrSolve(N,z,{regularize:!0}))))}else I=e.dot(y,q),F=e.dot(y,z);for(var L=c,J=!1;E<p&&!b&&!J;){E+=1;var O=e.add(F,e.diag(a(m,M.length)));L=l(c,e.neg(e.solve(O,I,!0)),h),b=e.all(e.eq(L,c));var P=void 0;if(S){P={Jv:G=e.transpose(u(d,L)),F:N=t.qr(G)};var R=o(r,L);L=l(L,e.neg(t.qrSolve(N,R,{regularize:!0})),g)}var k=i(r,L);(J=k<x)?(c=L,x=k,S=P,m*=.1):(m=Math.max(m,1e-64),m*=2)}}return{solution:c,MSE:x}}Object.defineProperty(r,"__esModule",{value:!0}),r.testOnlyExports=r.optimizeNonLinear=r.optimizeLinear=r.tryRoundingSmallParametersToZero=r.evaluateMeanSquare=void 0,r.evaluateMeanSquare=i,r.tryRoundingSmallParametersToZero=function(r,e){var n=e.solution.map(function(r){return Math.abs(r)<1e-6?0:r}),t=i(r,n);return isFinite(e.MSE)&&!isFinite(e.MSE)||t<e.MSE||e.MSE!==e.MSE+Math.pow(.5,8)*(t-e.MSE)?e:{solution:n,MSE:t}},r.optimizeLinear=function(r,n){for(var s=a(0,n.length),l=u(n,s),v=t.qr(e.transpose(l),{mutateInput:!0}),f=0;f<2;f++){var S=o(r,s),p=e.neg(t.qrSolve(v,S,{regularize:!1}));s=e.add(s,p)}var g=i(r,s);if(t.isNumericallyFullRank(v))return{solution:s,MSE:g};var h=a(0,n.length);for(f=0;f<2;f++){S=o(r,h),p=e.neg(t.qrSolve(v,S,{regularize:!0}));h=e.add(h,p)}var d=i(r,h);return.999*d<=g?{solution:h,MSE:d}:{solution:s,MSE:g}};var f=[18.9,.105,.0113,.089,4.414,.373,.06,.149,1.84,9.26,5,.7,.2,1.13,2.61,1,.007,30,120,1500,4e-4,7.23,-1,-.0081,-.03,-28.6,-1.71,-.4,-6.94,-.777,-500],S=function(r){for(var e=[],n=0;n<f.length;n++){for(var t=[],a=0;a<r;a++)t[a]=0===n&&1!==r?0:1===n&&1!==r?1:f[503*(n*r+a)%f.length];e.push(t)}return e},p=function(r,e,n,t,a){for(var i=[],o=0,u=n;o<u.length;o++){var s=u[o];i.push({soln:v(r,e,s,a),initialGuess:s})}i.sort(function(r,e){return isNaN(r.soln.MSE)?1:isNaN(e.soln.MSE)?-1:r.soln.MSE-e.soln.MSE});for(var l=[],f=0;f<t;f++)l.push(i[f].initialGuess);return l};function g(r,e,n,t){if(!e)return r;if("known"!==e.type)return r;var a=e.bounds;return a[0]===-1/0&&a[1]===1/0?r:a[0]===-1/0?a[1]-Math.exp(-r):a[1]===1/0?a[0]+Math.exp(r):n/(t-1)*a[1]+(t-1-n)/(t-1)*a[0]}var h=[3,5,7,11,13,17,19];function d(r,e){for(var n=[],t=0;t<r.length;t++){for(var a=r[t],i=[],o=0;o<a.length;o++){var u=h[o%h.length]*t%r.length;i.push(g(a[o],e[o],u,r.length))}n.push(i)}return n}r.optimizeNonLinear=function(r,e,t){t||(t={});var a=t.linearSubset,i=t.bounds,o=t.preferredInitialGuess,u=S(e.length);i&&(u=d(u,i));var s=p(r,e,u,5,{maxIterations:3,linearSubset:a}),l=v(r,e,p(r,e,s,1,{maxIterations:60,linearSubset:a})[0],{maxIterations:250,linearSubset:a});if(!o)return l;var f=v(r,e,o,{maxIterations:100,linearSubset:a});return isFinite(f.MSE)&&(f.MSE<l.MSE||n.approx(f.MSE,l.MSE,8))?f:l},r.testOnlyExports={generateInitialGuesses:S,mapInitialGuesses:d}});\ndefine(\'core/math/ir/features/reparameterize-regression\',["require","exports","core/math/builtin","../opcodes","core/math/types","../instructions","./is-constant","./as-value","./polynomial-order","./get-polynomial-coefficients","./copy-instruction","core/math/maybe-rational","./list-length"],function(require,e,r,t,a,n,i,s,o,u,c,l,v){"use strict";function p(e){return{chunk:e,isLazy:!0}}function f(e){return e.slice()}function h(e){if(!e.isLazy)return e;var r=e.chunk.copy();return r.reopenFinalBlock(),{chunk:r,forwardParameterMap:f,reverseParameterMap:f,isLazy:!1,valueMap:F(e.chunk.instructionsLength()),replacementMask:N(e.chunk.argNames.length)}}function d(e){var r=e.chunk,t=e.forwardParameterMap,a=e.reverseParameterMap,n=e.isLazy,i=e.valueMap,s=e.replacementMask,o=e.didShiftScale;return{chunk:r.copy(),forwardParameterMap:t,reverseParameterMap:a,isLazy:n,valueMap:i.slice(),replacementMask:s.slice(),didShiftScale:o}}function g(e){for(var r=1/0,t=-1/0,a=e.length,n=0,i=e;n<i.length;n++){var s=i[n];r=Math.min(r,s),t=Math.max(t,s)}return{min:r,max:t,length:a}}function m(e,r,t,a){if(void 0!==t){var i=e.getInstruction(a);if(n.isLeafInstruction(i))for(var s=0,o=t;s<o.length;s++){(v=o[s]).valueMap[a]=a}else for(var u=0,l=t;u<l.length;u++){for(var v,p=(v=l[u]).chunk,f=v.valueMap,h=[],d=0,g=0,m=i.args;g<m.length;g++){var M=m[g];if(f[M]!==M){if((d+=1)>1)return void(t.length=0)}else for(var y=r[M],k=0;k<y.length;k++)if(y[k]&&v.replacementMask[k])return void(t.length=0);h.push(f[M])}f[a]=d>0?c.copyInstructionWithArgs(p,i,h):a}}}function M(e,r){for(var t,a=e.listAccessDependencyTable,n=e.listAccesses,i=e.listStatisticsTable,s=a[r],o=0;o<s.length;o++)if(s[o]){if(t)return;t={listAccessIndex:n[o],listStatistics:i[o]}}return t}function y(e,r){for(var t=0,a=e.listAccessDependencyTable[r];t<a.length;t++){if(a[t])return!0}return!1}function k(e,r){for(var a,n=[],i=0;i<=r;i++){if(e.getInstruction(i).type===t.LoadArg){var s=N(e.argNames.length);s[i]=!0,n.push(s)}else n.push(L(e,n,e.argNames.length,i))}var o=n[r];for(i=0;i<o.length;i++)if(o[i]){if(void 0!==a)return;a=i}return a}function x(e,a,n,i,s){var o=e.chunk,u=k(o,n);if(void 0!==u){var c=w(e,n,u);if(void 0!==c){var l=o.getInstruction(i),v=l.args[0];if(void 0!==(c=b(c,v,s))){var p=c.chunk,f=c.valueMap,h=p.getInstruction(f[v]);if(h.type===t.Add){var d=h.args[1],g=p.getInstruction(h.args[0]);if(g.type===t.Multiply){var m=g.args,M=m[0],y=m[1],x=u,P=d,C=M,I=y,L=p.Multiply([C,I]),N=p.SyntheticNativeFunction("cos",[L]),F=p.SyntheticNativeFunction("sin",[L]),S="sin"===l.symbol?p.Add([p.Multiply([x,F]),p.Multiply([P,N])]):p.Subtract([p.Multiply([x,N]),p.Multiply([P,F])]);f[a]=S;var A=c.replacementMask.slice();return A[u]=!0,A[M]=!0,A[d]=!0,{chunk:p,forwardParameterMap:function(e){var r=c.forwardParameterMap(e),t=r[u],a=r[d],n=t*Math.cos(a),i=t*Math.sin(a);return r[u]=n,r[d]=i,r},reverseParameterMap:function(e){var t=e.slice(),a=e[u],n=e[d],i=r.hypot(a,n),s=Math.atan2(n,a);return t[u]=i,t[d]=s,c.reverseParameterMap(t)},valueMap:f,replacementMask:A,isLazy:!1}}}}}}}function P(e,r,n,i){var s=e.chunk,o=s.getInstruction(r).args,u=o[0],c=o[1],v=s.getInstruction(u);if(v.type===t.Constant&&v.valueType===a.Number&&l.asFloat(v.value)>0){var p=h(e),f=p.chunk,d=p.valueMap,g=f.Multiply([f.SyntheticNativeFunction("ln",[d[u]]),d[c]]);return d[c]=g,d[r]=f.SyntheticNativeFunction("exp",[g]),I(p,r,c,n,i)||p}var m=k(s,u);if(void 0!==m){var M=w(e,u,m);if(void 0!==M){var y=M.chunk,x=M.valueMap,P=y.Multiply([x[u],x[c]]);x[c]=P,x[r]=y.SyntheticNativeFunction("exp",[P]);var C=M.replacementMask.slice();C[m]=!0;var b={chunk:y,forwardParameterMap:function(e){var r=M.forwardParameterMap(e),t=r[m],a=Math.log(t);return r[m]=a,r},reverseParameterMap:function(e){var r=e.slice(),t=r[m],a=Math.exp(t);return r[m]=a,M.reverseParameterMap(r)},isLazy:!1,valueMap:x,replacementMask:C};return I(b,r,c,n,i)||b}}}function C(e,r,t,a,n,i){if(e.isLazy||!e.didShiftScale){var s=e.isLazy?e:d(e),o=k(e.chunk,t);if(void 0!==o){var u=w(e,t,o);if(void 0!==u){var c=u.chunk,l=u.valueMap,v=c.getInstruction(l[a]).args[0],p=c.Add([v,l[t]]);l[t]=p,l[r]=c.SyntheticNativeFunction("exp",[p]);var f=u.replacementMask.slice();f[o]=!0;var g=h(s);g.valueMap[r]=g.chunk.Multiply([g.valueMap[t],g.valueMap[a]]);var m={chunk:c,forwardParameterMap:function(e){var r=u.forwardParameterMap(e),t=r[o],a=Math.log(t);return r[o]=a,r},reverseParameterMap:function(e){var r=e.slice(),t=r[o],a=Math.exp(t);return r[o]=a,u.reverseParameterMap(r)},isLazy:!1,valueMap:l,replacementMask:f},M=d(m);return M.forwardParameterMap=function(e){var r=u.forwardParameterMap(e),t=r[o],a=Math.log(-t);return r[o]=a,r},M.reverseParameterMap=function(e){var r=e.slice(),t=r[o],a=-Math.exp(t);return r[o]=a,u.reverseParameterMap(r)},m=I(m,r,t,n,i)||m,(M=I(M,r,t,n,i)||M).valueMap[r]=M.chunk.Negative([M.valueMap[r]]),[g,m,M]}}}}function I(e,r,a,n,i){var s=function(e,r,a,n){var i=b(e,r,a);if(void 0===i)return;var s=i.chunk,o=i.valueMap,u=s.getInstruction(o[r]);if(u.type!==t.Add)return;var c=u.args[1],l=s.getInstruction(u.args[0]);if(l.type!==t.Multiply)return;var v=l.args,p=v[0],f=v[1],h=n.min,d=n.max,g=d-h,m=.5*(d+h),M=s.Divide([s.Subtract([f,s.Constant(m)]),s.Constant(g)]),y=s.Add([s.Multiply([p,M]),c]);function k(e){var r=i.forwardParameterMap(e),t=r[p],a=r[c],n=t*g,s=a+m*t;return r[p]=n,r[c]=s,r}function x(e){var r=e.slice(),t=e[p],a=e[c],n=t/g,s=a-n*m;return r[p]=n,r[c]=s,i.reverseParameterMap(r)}return o[r]=y,{chunk:s,forwardParameterMap:k,reverseParameterMap:x,isLazy:!1,valueMap:o,replacementMask:i.replacementMask,didShiftScale:!0}}(e,a,n,i);if(void 0!==s)return s.valueMap[r]=s.chunk.SyntheticNativeFunction("exp",[s.valueMap[a]]),s}function w(e,r,n){var i=e.chunk,s=o.polynomialOrderContext(i,n,{allowRestriction:!1,allowClosedBlockReferences:!1});if(1===o.instructionOrder(s,r)){var c=u.polynomialCoefficientContext(s),v=u.instructionCoefficients(c,r),p=v[0],f=v[1];if(void 0!==f){var d=c.newChunk.getInstruction(p);if(d.type===t.Constant&&d.valueType===a.Number){var g=c.newChunk.getInstruction(f);if(g.type===t.Constant&&g.valueType===a.Number){var m=h(e),M=m.chunk,y=m.valueMap,k=l.asFloat(d.value),x=l.asFloat(g.value);y[r]=n;var P=m.replacementMask.slice();return P[n]=!0,{chunk:M,forwardParameterMap:function(e){var r=m.forwardParameterMap(e),t=r[n],a=k+x*t;return r[n]=a,r},reverseParameterMap:function(e){var r=e.slice(),t=(r[n]-k)/x;return r[n]=t,m.reverseParameterMap(r)},isLazy:!1,valueMap:y,replacementMask:P}}}}}}function b(e,r,n){var i=e.chunk,s=e.isLazy?r:e.valueMap[r],c=o.polynomialOrderContext(i,n,{allowRestriction:!1,allowClosedBlockReferences:!0});if(1===o.instructionOrder(c,s)){e.isLazy&&(c=o.polynomialOrderContext(i.copy().reopenFinalBlock(),n,{allowRestriction:!1,allowClosedBlockReferences:!1}));var v=u.polynomialCoefficientContext(c),p=u.instructionCoefficients(v,s),f=p[0],d=p[1];if(void 0!==d){for(var g,m,M=v.newChunk,y=Math.max(d,f),k=[],x=0;x<=y;x++){if(M.getInstruction(x).type===t.LoadArg){var P=N(M.argNames.length);P[x]=!0,k.push(P)}else k.push(L(M,k,M.argNames.length,x))}for(x=0;x<i.argNames.length;x++)if(k[d][x]){if(void 0!==g)return;g=x}else if(k[f][x]){if(void 0!==m)return;m=x}if(void 0!==g&&void 0!==m){var C=o.polynomialOrderContext(M,g,{allowRestriction:!1,allowClosedBlockReferences:!1});if(1===o.instructionOrder(C,d)){var I=o.polynomialOrderContext(M,m,{allowRestriction:!1,allowClosedBlockReferences:!1});if(1===o.instructionOrder(I,f)){var w=u.polynomialCoefficientContext(C),b=u.polynomialCoefficientContext(I),F=u.instructionCoefficients(w,d),S=F[0],A=F[1],z=w.newChunk.getInstruction(S);if(z.type===t.Constant&&z.valueType===a.Number){var R=w.newChunk.getInstruction(A);if(R.type===t.Constant&&R.valueType===a.Number){var O=h(e),T=O.chunk,B=O.valueMap,D=T.Add([T.Multiply([g,n]),m]);B[r]=D;var E=M.copy();E.List([d,f]);var _=E.close().getCompiledFunction().fn,j=l.asFloat(z.value),q=l.asFloat(R.value),V=u.instructionCoefficients(b,f),W=V[0],G=V[1],H=b.newChunk.copy();H.List([W,G]);var J=H.close().getCompiledFunction().fn,K=O.replacementMask.slice();return K[g]=!0,K[m]=!0,{chunk:T,forwardParameterMap:function(e){var r=O.forwardParameterMap(e),t=_.apply(null,r),a=t[0],n=t[1];return r[g]=a,r[m]=n,r},reverseParameterMap:function(e){var r=e.slice(),t=e[g],a=e[m],n=(t-j)/q,i=e.slice();i[g]=n,i.splice(m,1);var s=J.apply(null,i),o=(a-s[0])/s[1];return r[g]=n,r[m]=o,O.reverseParameterMap(r)},isLazy:!1,valueMap:B,replacementMask:K}}}}}}}}}function L(e,r,t,a){var i=e.getInstruction(a),s=N(t);if(n.isLeafInstruction(i))return s;for(var o=0,u=i.args;o<u.length;o++)for(var c=r[u[o]],l=0;l<c.length;l++)s[l]=s[l]||c[l];return s}function N(e){for(var r=[],t=0;t<e;t++)r.push(!1);return r}function F(e){for(var r=[],t=0;t<e;t++)r.push(t);return r}function S(e){return e.type===t.NativeFunction&&("sin"===e.symbol||"cos"===e.symbol)}Object.defineProperty(e,"__esModule",{value:!0}),e.reparameterizeRegression=void 0,e.reparameterizeRegression=function(e){var r=e.getInstruction(e.returnIndex);if(r.type===t.BroadcastResult){var o=r.args[0],u=e.returnIndex-o,c=e.getInstruction(o);if(2===c.args.length){var l=c.args[0],f=c.args[u],h=[],d=[];h.push(l),d.push({min:1,max:v.assertConstantListLength(e,e.returnIndex,"Programming error: cannot optimize regression on non-constant-length list"),length:v.assertConstantListLength(e,e.returnIndex,"Programming error: cannot optimize regression on non-constant-length list")});for(var k=!1,w=!1,b=l+1;b<=f;b++){if((D=e.getInstruction(b)).type===t.ListAccess||D.type===t.InboundsListAccess||D.type===t.DeferredListAccess){if(D.args[1]!==l)continue;var F=D.args[0];if(e.getInstruction(F).valueType!==a.ListOfNumber)continue;if(!i.isConstant(e.getInstruction(F)))continue;var A=g(s.asValue(e,F));if(!isFinite(A.min)||!isFinite(A.max))continue;h.push(b),d.push(A)}else if(D.type===t.NativeFunction)"exp"===D.symbol?w=!0:S(D)&&(k=!0);else if(D.type===t.Exponent||D.type===t.RawExponent)w=!0;else if(n.beginsBlock(D)||n.endsBlock(D))return}if(0!==h.length&&(w||k)){var z=[];for(b=0;b<=f;b++){if(-1!==(ie=h.indexOf(b)))(O=N(h.length))[ie]=!0,z.push(O);else z.push(L(e,z,h.length,b))}var R=[];for(b=0;b<=e.returnIndex;b++){var O;if((D=e.getInstruction(b)).type===t.LoadArg)(O=N(e.argNames.length))[b]=!0,R.push(O);else R.push(L(e,R,e.argNames.length,b))}var T={listAccessDependencyTable:z,listAccesses:h,listStatisticsTable:d},B=void 0;for(b=l+1;b<=e.returnIndex;b++){var D;switch((D=e.getInstruction(b)).type){case t.NativeFunction:if("exp"===D.symbol){var E=D.args[0],_=M(T,E);if(void 0===_){m(e,R,B,b);break}var j=_.listStatistics,q=_.listAccessIndex;(ve=I(p(e),b,E,q,j))?B=[ve]:m(e,R,B,b)}break;case t.Exponent:case t.RawExponent:var V=D.args,W=V[0],G=M(T,V[1]);if(void 0===G||y(T,W)){m(e,R,B,b);break}var H=G.listStatistics,J=G.listAccessIndex;(ve=P(p(e),b,J,H))?B=[ve]:m(e,R,B,b);break;case t.Multiply:if(B&&B.length>1){m(e,R,B,b);break}var K=B&&B.length>0?B[0]:p(e),Q=D.args,U=Q[0],X=Q[1],Y=K.isLazy?U:K.valueMap[U],Z=K.isLazy?X:K.valueMap[X],$=K.chunk.getInstruction(Y),ee=K.chunk.getInstruction(Z),re=void 0,te=void 0,ae=void 0;if($.type===t.NativeFunction)re=U,ae=$,te=X;else{if(ee.type!==t.NativeFunction){m(e,R,B,b);break}re=X,ae=ee,te=U}var ne=M(T,re);if(void 0===ne||y(T,te)){m(e,R,B,b);break}var ie=ne.listAccessIndex,se=ne.listStatistics;if("exp"===ae.symbol){var oe=C(K,b,te,re,ie,se);if(oe){B=oe;break}}else if(S(ae)){if(ve=x(K,b,te,re,ie)){B=[ve];break}}m(e,R,B,b);break;default:m(e,R,B,b)}}if(void 0!==B&&0!==B.length){for(var ue=[],ce=0,le=B;ce<le.length;ce++){var ve=le[ce];ue.push({chunk:ve.chunk.close(),forwardParameterMap:ve.forwardParameterMap,reverseParameterMap:ve.reverseParameterMap})}return ue}}}}}});\ndefine(\'core/math/parsenode-from-value\',["require","exports","parsenodes","core/math/types"],function(require,e,r,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.parseNodeFromValue=void 0,e.parseNodeFromValue=function e(t,s){switch(t){case o.Number:case o.Bool:return r.Constant(s);case o.SeedType:return r.Seed(s);case o.Point:return r.ParenSeq([e(o.Number,s[0]),e(o.Number,s[1])]);case o.RGBColor:return r.FunctionCall("rgb",[e(o.Number,s[0]),e(o.Number,s[1]),e(o.Number,s[2])]);case o.EmptyList:case o.ListOfNumber:case o.ListOfBool:case o.ListOfPoint:case o.ListOfColor:case o.ListOfPolygon:case o.ErrorType:for(var n=[],a=o.elementType(t),i=0,c=s;i<c.length;i++){var u=c[i];n.push(e(a,u))}return r.List(n);case o.Polygon:return r.FunctionCall("\\\\polygon",[e(o.ListOfPoint,s)]);case o.Any:case o.Distribution:case o.ListOfAny:case o.ListOfDistribution:case o.Action:throw new Error("Programming error: cannot create parse node from valueType: "+o.repr(t));default:var l=t;throw new Error("Programming error: unexpected valueType: "+o.repr(l))}}});\ndefine(\'core/math/ir/features/optimize-regression\',["require","exports","parsenodes","core/math/builtin","core/math/parsenode/irexpression","tslib","core/math/errormsg","core/math/distance","core/lib/label","core/math/types","core/math/least-squares","./reparameterize-regression","core/math/ir/build-ir","../../parsenode-from-value"],function(require,e,r,i,n,t,a,s,o,u,l,f,p,d){"use strict";function v(e,r,i){for(var n,t,a=e.policy,s=e.frame,o=0,l=r._rhs.getDependencies();o<l.length;o++){var f=l[o];if(!i.hasOwnProperty(f)){var p=s[f];if(p&&("Assignment"===p.type&&(p=p._expression),p.buildIRExpression)){var d=p.buildIRExpression(a,s);if(!d.isError&&d.valueType===u.ListOfNumber){if(void 0!==n){n=void 0,t=void 0;break}0===d.getDependencies().length&&(n=f,t=d)}}}}var v=Object.create(s);void 0!==n&&(v[n]=void 0);var c=r._rhs.buildIRExpression(a,v),g=Object.create(v);for(var m in i)g[m]=i[m];var h=r._rhs.buildIRExpression(a,g);return t?{node:c,substituted:h,listNode:t,isValid:!0}:{node:c,substituted:h,listNode:t,isValid:!1}}function c(e,r){var i=r.getDependencies(),n=r.getCompiledFunction(i).fn;if(i.length){for(var a=r.findLinearSubset(i),s=a.every(function(e){return e}),o=[],u=0,f=i;u<f.length;u++){var p=f[u];o.push(r.takeDerivative(p).getCompiledFunction(i).fn)}if(s)return t.__assign(t.__assign({},l.tryRoundingSmallParametersToZero(n,l.optimizeLinear(n,o))),{isLinear:s});for(var d=[],v=0,c=i;v<c.length;v++){p=c[v];d.push(r.boundDomain(p))}var g={linearSubset:a,bounds:d,preferredInitialGuess:e};return t.__assign(t.__assign({},l.tryRoundingSmallParametersToZero(n,l.optimizeNonLinear(n,o,g))),{isLinear:s})}return{solution:[],MSE:l.evaluateMeanSquare(n,[]),isLinear:!0}}function g(e,i){for(var n={},t=i.getDependencies(),a=0;a<t.length;a++)n[t[a]]=r.Constant(e[a]);return n}function m(e,n,t,o,f,p){if(o.getDependencies().length)throw a.optimizationError();var d=function(e){var r=0;return e.eachElement(function(e){var i=+e.asValue();r+=i*i}),r/e.length}(o);if(!isFinite(d))throw a.optimizationError();if(n.getDependencies().length>0)return{RMSE:Math.sqrt(d)};var v=u.isList(n.valueType)?i.varp(n.asValue()):0;if(n.getDependencies().length||!isFinite(v)||v<=0||!e.isLhsSimple)return{RMSE:Math.sqrt(d)};var c=1-d/v;if(t.isValid){var g=[],m=[],h=f&&(p===L.LINLOG||p===L.LOGLOG);r.List.eachArgs([t.listNode,n],function(e){g.push(h?Math.log(+e[0].asValue()):+e[0].asValue()),m.push(+e[1].asValue())});var E=i.corr(g,m);if(s.approx(function(e,r){function i(i,n){for(var t=[],a=0;a<e.length;a++)t.push(r[a]-(i*e[a]+n));return t}var n=[function(){return e.map(function(e){return-e})},function(){return e.map(function(){return-1})}];return l.optimizeLinear(i,n)}(g,m).MSE,d,8))return{r:E,rsquared:E*E}}return{Rsquared:c}}function h(e,r){var i=e.length,n=e[0],t=r[0],a=e[i-1],o=r[i-1];if(!(isFinite(n)&&isFinite(a)&&isFinite(t)&&isFinite(o)))return!1;if(o-t==0)return!1;var u=a-n;if(0===u)return!1;for(var l=1;l<i-1;l++){var f=e[l],p=r[l],d=(o*(f-n)+t*(a-f))/u;if(!s.approx(p,d,5))return!1}return!0}Object.defineProperty(e,"__esModule",{value:!0}),e.tryOptimize=void 0,e.tryOptimize=function(e,i){try{return function(e,i){var n,t=e.policy,s=e.frame,l=e.exportFrame,f=e.lastExportFrame,p=e.priorAnalysis,d=i._lhs.buildIRExpression(t,s),c=i._rhs.buildIRExpression(t,s);if(d.isError)throw d;if(c.isError)throw c;if(d.valueType!==u.Number&&d.valueType!==u.ListOfNumber||c.valueType!==u.Number&&c.valueType!==u.ListOfNumber)throw a.regressionTypeError([u.prettyPrint(d.valueType),u.prettyPrint(c.valueType)]);var g=i._difference.buildIRExpression(t,s,{wrapInList:!0});if(g.isError)throw g;for(var N=0,b=g.getDependencies();N<b.length;N++){var y=b[N];if(!t.validRegressionParameter(y))throw a.invalidRegressionParameter(y)}var R,_=function(e,r,i){var n=[];r||(r={});i||(i={});for(var t=0,a=e;t<a.length;t++){var s=a[t],u=o.identifierToLatex(s);i[s]&&isFinite(i[s].asValue())?n.push(+i[s].asValue()):r.hasOwnProperty(u)&&isFinite(+r[u])?n.push(+r[u]):n.push(1)}return n}(g.getDependencies(),i.userData.regressionParameters,f),D=O(_,g),I=D.parameters,x=D.isLinear,M=D.parameterWarning,w={policy:t,frame:s},V=v(w,i,I),T=E(w,i._difference,I),F=function(e,i,n){if(!e.isLhsSimple)return L.NONE;if(!n.isValid)return L.NONE;var t=n.substituted;if(t.isError)return L.NONE;if(t.valueType!==u.Number)return L.NONE;var a=t.getDependencies();if(1!==a.length)return L.NONE;if(isFinite(n.node.polynomialOrder(a[0])))return L.NONE;var s=t.getCompiledFunction(a).fn,o=n.listNode;if(t.valueType!==u.Number)return L.NONE;var l=o.mapElements(function(e){return+e.asValue()});if(l.length<3)return L.NONE;l.sort(function(e,r){return e-r});var f=l.map(s),p=f.map(Math.log),d=l.map(Math.log),v=!0;return r.List.wrap(i).eachElement(function(e){isFinite(Math.log(+e.asValue()))||(v=!1)}),h(l,p)&&v?L.LOGLIN:h(d,p)&&v?L.LOGLOG:h(d,f)?L.LINLOG:L.NONE}(i,d,V);if(!i.userData.isLogModeRegression||F!==L.LOGLIN&&F!==L.LOGLOG)R=m(i,d,V,T,i.userData.isLogModeRegression,F);else{var S=i._logDifference.buildIRExpression(t,s,{wrapInList:!0});if(S.isError)throw S;var G=i._logLhs.buildIRExpression(t,s,{wrapInList:!0});if(G.isError)throw G;I=(n=O(_,S)).parameters,x=n.isLinear,M=n.parameterWarning,V=v(w,i,I),T=E(w,i._difference,I),R=m(i,G,V,E(w,i._logDifference,I),i.userData.isLogModeRegression,F)}var P=function(e,r){if(e.userData&&e.userData.residualVariable){var i=o.latexToIdentifier(e.userData.residualVariable);if(!r[i])return i}for(var n,t=e.getDependencies(),a=0,s=t;a<s.length;a++){var u=s[a].match(/_(.*)/);if(u&&!r[n="e_"+u[1]])return n}var l=1;for(;;){if(!r[n="e_"+l])return n;l++}}(i,l),z=function(e,r,i){var n,t=e._rhs.getDependencies();for(var a in i)if(i.hasOwnProperty(a)){var s=i[a].concreteTree;if(s.isTable&&s.columns[0]){var o=i[a].rawTree.columns;if(o&&o.length){var u=o[0].getExports();if(1===u.length&&-1!==t.indexOf(u[0])){for(var l=1;l<o.length;l++)if(-1!==o[l].getDependencies().indexOf(r))return;n=n||a}}}}return n||void 0}(i,P,p);return i.userData.residualVariable=o.identifierToLatex(P),r.OptimizedRegression(I,T,R,V.substituted,{isModelValid:V.isValid,residualVariable:P,residualSuggestionId:z,shouldSuggestLogMode:F!==L.NONE,isLinear:x,parameterWarning:M})}(e,i)}catch(e){return e instanceof r.Error?e:a.parseError()}};var L={NONE:0,LOGLIN:1,LOGLOG:2,LINLOG:3};function E(e,r,i){var n=e.policy,t=e.frame,a=Object.create(t);for(var s in i)i.hasOwnProperty(s)&&(a[s]=i[s]);var o=p.buildIR({policy:n,frame:a,wrapInList:!0},r);return d.parseNodeFromValue(o.getReturnType(),o.asCompilerValue())}function O(e,r){var i,t,a=r._chunk;if(a&&(t=f.reparameterizeRegression(a)),!t||0===t.length)return{parameters:g((i=c(e,r=r.deriveRegressionRestrictions())).solution,r),isLinear:i.isLinear,parameterWarning:!1};for(var s=r.getDependencies(),o=r.getCompiledFunction(s).fn,u=1/0,p={},d=!1,v=0,m=t;v<m.length;v++){var h=m[v],L=new n(h.chunk);if(L=L.deriveRegressionRestrictions(),(i=c(h.forwardParameterMap(e),L)).MSE<u){var E=h.reverseParameterMap(i.solution),O=l.evaluateMeanSquare(o,E);if(p&&(!isFinite(O)||O>=u)){isFinite(O)||(d=!0);continue}u=i.MSE,p=g(E,r)}}return{parameters:p,isLinear:!1,parameterWarning:d}}});\ndefine(\'core/math/features/analyze\',[\'require\',\'underscore\',\'parsenodes\',\'core/math/statementanalysis\',\'core/math/builtin\',\'core/math/builtinframe\',\'core/math/errormsg\',\'core/math/comparators\',\'core/math/types\',\'core/types/graphmode\',\'core/math/expression-types\',\'core/math/distribution-spec\',\'core/math/workerconfig\',\'core/math/ir/features/solve\',\'core/math/ir/features/optimize-regression\',\'core/math/ir/dependencies\'],function(require){"use strict";var e=require("underscore"),t=require("parsenodes"),i=require("core/math/statementanalysis"),r=require("core/math/builtin"),n=require("core/math/builtinframe"),a=require("core/math/errormsg"),s=require("core/math/comparators"),o=require("core/math/types"),l=require("core/types/graphmode"),c=require("core/math/expression-types").ExpressionType,u=require("core/math/distribution-spec").DistributionParameterDefaultsMap,h=require("core/math/workerconfig"),p=require("core/math/ir/features/solve").trySolve,d=require("core/math/ir/features/optimize-regression").tryOptimize,y=require("core/math/ir/dependencies").getFreeDependencies;function v(e,t,r,n){if(n.isError)return i(e,r,n);var s=n.getDependencies();switch(n.valueType){case o.Distribution:case o.ListOfDistribution:case o.EmptyList:return i(e,r,n);case o.RGBColor:case o.ListOfColor:case o.Action:case o.Polygon:case o.ListOfPolygon:return s.length?i(e,r,a.tooManyVariables(r.getSliderVariables(e,n)).setDependencies(s)):i(e,r,n);case o.Point:case o.ListOfPoint:if(s.length){if(!e.validParametricVariables(s)){var l=r.getSliderVariables(e,n);return i(e,r,a.tooManyVariables(l).setDependencies(l))}return i(e,r,n)}return i(e,r,n);case o.Number:case o.ListOfNumber:return 0===s.length?i(e,r,n):s.length<=e.dimensions()-1?e.validExpressionVariables(s)?i(e,r,n):i(e,r,a.equationRequired(e.implicitDependency(s)).setDependencies(s)):e.validImplicitVariables(s)?i(e,r,a.equationRequired().setDependencies(s)):i(e,r,a.tooManyVariables(r.getSliderVariables(e,n)).setDependencies(s));default:return i(e,r,a.parseError())}}function f(e){return t.FunctionCall("pdf",[e,t.Identifier("x")])}function g(e,t){var r=this.tryGetConcreteTree(e,t),n=r.getDependencies();return n.length?i(e,this,a.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):i(e,this,this.tryGetConcreteTree(e,t))}function b(e){return function(t,r){var n=this.tryGetConcreteTree(t,r),s=n.getDependencies();if(s.length)return i(t,this,a.tooManyVariables(this.getSliderVariables(t,n)).setDependencies(s));var o=i(t,this,this.tryGetConcreteTree(t,r));if(!n.isError){o.evaluationState.expression_type=c.TTEST;var l=n.args.map(function(e){return e.asValue()});o.evaluationState.ttest_results=e.apply(null,l)}return o}}function m(e,t){return e.filter(function(e){return!t[e]})}t.Base.prototype.analyze=function(e,t){return i(e,this,this.tryGetConcreteTree(e,t))},t.FunctionCall.prototype.analyze=function(e,t){return v(e,0,this,u[this._symbol]&&0===y(t,this).length?f(this).tryGetConcreteTree(e,t):this.tryGetConcreteTree(e,t))},t.Expression.prototype.analyze=function(e,t){return v(e,0,this,this.tryGetConcreteTree(e,t))},t.FunctionDefinition.prototype.analyze=function(e,t){if(n[this._symbol])return this.asEquation().analyze(e,t);var r=this._symbol.split("_")[0];if(n[r]&&n[r].isFunction)return i(e,this,a.cannotRedefine(this._symbol,r));var s=this.tryGetConcreteTree(e,t);if(s.isError)return i(e,this,s);var o=this._argSymbols,l=s.getDependencies();if(-1!==l.indexOf(this._symbol))return i(e,this,a.selfReferentialFunction(this._symbol));var c=l.filter(function(e){return-1===o.indexOf(e)});if(e.unplottablePolarFunction(this._symbol,l))return i(e,this,a.unplottablePolarFunction());if(c.some(e.assignmentForbidden))return i(e,this,a.addArgumentsToDefinition(c,this._symbol,o).setDependencies(l));if(c.length){var u=this.getSliderVariables(e,s);return i(e,this,a.tooManyVariables(u).setDependencies(u))}return i(e,this,s)},t.Assignment.prototype.analyze=function(e,r,s){var l,c=this._symbol;if(!e.validLHS(c))return i(e,this,a.invalidLHS(c));if(n[c])return this.asEquation().analyze(e,r);if(this._expression instanceof t.FunctionCall&&u[this._expression._symbol]&&0===y(r,this).length)l=f(this._expression).tryGetConcreteTree(e,r);else{var h=Object.create(r);h[c]=e.validSolvedVariable(c)?void 0:a.invalidImplicitVariables(),l=this.tryGetConcreteTree(e,h)}if(l.isError)return i(e,this,l);var p=l.getDependencies();if(this.isEquation(l))return this.asEquation().analyze(e,r);var d=l.valueType===o.RGBColor||l.valueType===o.ListOfColor;if(p.length>1||d&&p.length){var v=this.getSliderVariables(e,l);return d||v.length?i(e,this,a.tooManyVariables(v).allowExport().setDependencies(v)):i(e,this,l)}var g=this.getMoveStrategy(e,r,l,s,this.userData);if(g){var b=this.getDefaultDragMode(g);return i(e,this,t.MovablePoint([l.elementAt(0),l.elementAt(1)],g,b))}return i(e,this,l)},t.Regression.prototype.analyze=function(e,t,r,n,a){return i(e,this,d({policy:e,frame:t,exportFrame:r,lastExportFrame:n,priorAnalysis:a},this))},t.Histogram.prototype.analyze=g,t.Object3D.prototype.analyze=g,t.DotPlot.prototype.analyze=g,t.BoxPlot.prototype.analyze=g,t.TTest.prototype.analyze=b(r.ttest),t.IndependentTTest.prototype.analyze=b(r.ittest),t.Stats.prototype.analyze=function(e,t){var n=this.tryGetConcreteTree(e,t),s=n.getDependencies();if(s.length)return i(e,this,a.tooManyVariables(this.getSliderVariables(e,n)).setDependencies(s));var o=i(e,this,this.tryGetConcreteTree(e,t));if(!n.isError){o.evaluationState.expression_type=c.STATS;var l=n.args.map(function(e){return e.asValue()});o.evaluationState.stats_results=r.stats.apply(null,l)}return o},t.Equation.prototype.analyze=t.BaseComparator.prototype.analyze=function(e,r){var n="="!==this.getOperator();if(!h.plotInequalities&&n)return i(e,this,a.inequalitiesDisabled());var s=p({policy:e,frame:r},this.asComparator());if(s.isError)return i(e,this,s);if(s instanceof t.SolvedEquation&&s.getDependencies().length){var o=s.getDependencies().concat(s._symbol);if(!e.validImplicitVariables(o))return i(e,this,a.invalidImplicitVariables().setDependencies(o))}return this.getGraphMode(e,s)!==l.IMPLICIT||e.validImplicitVariables(s.getDependencies())?i(e,this,s):i(e,this,a.invalidImplicitVariables().setDependencies(s.getDependencies()))},t.DoubleInequality.prototype.analyze=function(e,t){if(!h.plotInequalities)return i(e,this,a.inequalitiesDisabled());var r=this.tryGetConcreteTree(e,t);if(r.isError)return i(e,this,r);var n=r.getDependencies();return s.table[this._operators[0]].direction!==s.table[this._operators[1]].direction?i(e,this,a.mismatchedDoubleInequality()):e.validDoubleInequalitySymbol(r._symbol)&&e.validDoubleInequalityVariables(n)?n.length>2?i(e,this,a.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):-1!==r._expressions[0].getDependencies().indexOf(r._symbol)||-1!==r._expressions[1].getDependencies().indexOf(r._symbol)?i(e,this,a.complicatedDoubleInequality().setDependencies(n)):i(e,this,r):i(e,this,a.invalidDoubleInequalityVariables().setDependencies(n))},t.And.prototype.analyze=function(e,t){var r=this.tryGetConcreteTree(e,t);if(r.isError)return i(e,this,r);var n=r.getDependencies();return n.length?e.validDoubleInequalityVariables(n)?i(e,this,a.complicatedDoubleInequality().setDependencies(n)):i(e,this,a.tooManyVariables(this.getSliderVariables(e,r)).setDependencies(n)):i(e,this,r)},t.ParenSeq.prototype.analyze=function(e,r,n){var a=this.tryGetConcreteTree(e,r);if(a.isError)return i(e,this,a);var s=this.getMoveStrategy(e,r,a,n,this.userData);if(s){var o=this.getDefaultDragMode(s),l=a.asCompilerValue(),c=[t.Constant(l[0]),t.Constant(l[1])];return i(e,this,t.MovablePoint(c,s,o))}return v(e,0,this,a)},t.Table.prototype.analyze=function(e,r){for(var n=Object.create(r),s=Object.create(n),o=[],l=function(e){for(var i={},r=0;r<e.length;r++){var n=e[r];if(n.header instanceof t.Identifier){var a=n.header._symbol;void 0===i[a]&&(i[a]=0),i[a]+=1}}return i}(this.columns),c=0;c<this.columns.length;c++){var u=this.columns[c];if(u.header instanceof t.Identifier){var h=u.header._symbol,p=n[h],d=l[h]>1;p&&p.isError&&(p.isTableCycleWithoutGlobalDefinition||p.isMultiplyDefinedByTables&&!d)&&(n[h]=void 0)}var y=u.analyze(e,n,s);if(0===c)if(y.concreteTree.isIndependent){var v=y.concreteTree.getDependencies()[0];e.validFirstColumnVariable(v)?s[v]=void 0:y=i(e,u,a.invalidFirstTableColumn())}else y=i(e,u,a.invalidDependentFirstTableColumn());if(y.concreteTree.isIndependent)y.rawTree.exportToLocal(y.concreteTree,n);else if(!y.concreteTree.isError){var f=m(y.concreteTree.header.getDependencies(),n);f.length&&(y=i(e,u,a.tooManyVariables(f).setDependencies(f)))}o.push(y.concreteTree)}var g=t.Table(o),b=i(e,this,g);return b.evaluationState.is_graphable=!0,b},t.TableColumn.prototype.analyze=function(e,t,r){var n=this.header.tableError();if(n)return i(e,this,a.invalidTableHeader(n));var s=this.tryGetConcreteTree(e,t,r);if(s.isError)return i(e,this,s);if(s.header.isError)return i(e,this,s.header);if(s.values.isError)return i(e,this,s.values);for(var o=0;o<s.values.length;o++)if(!s.values[o].isError){var l=this.values[o]&&this.values[o].tableError();if(l)s.values[o]=a.invalidTableEntry(l);else{var c=s.values[o].getDependencies();c.length&&(s.values[o]=a.tooManyVariables(c).setDependencies(c))}}return i(e,this,s)},t.Image.prototype.analyze=function(e,r,n){var s=this.tryGetConcreteTree(e,r);if(s.radianAngle.isError||s.center.isError||s.width.isError||s.height.isError||s.opacity.isError)return i(e,this,s);var o=s.center.getDependencies(),l=s.radianAngle.getDependencies(),c=s.width.getDependencies(),u=s.height.getDependencies(),h=s.opacity.getDependencies();return o.length||l.length||c.length||u.length||h.length?i(e,this,t.Image({center:o.length?a.tooManyVariables(l).setDependencies(o):s.center,radianAngle:l.length?a.tooManyVariables(l).setDependencies(l):s.radianAngle,width:c.length?a.tooManyVariables(c).setDependencies(c):s.width,height:u.length?a.tooManyVariables(u).setDependencies(u):s.height,opacity:h.length?a.tooManyVariables(h).setDependencies(h):s.opacity})):(s.moveStrategy=this.getMoveStrategy(e,r,s,n,this.userData),i(e,this,s))},t.Slider.prototype.analyze=function(t,r){var n,s=this.tryGetConcreteTree(t,r),o=s.sliderInfo;if(o.missingVars.length){var l=e.unique(o.missingVars);n=i(t,this,a.tooManyVariables(t.sliderVariables(l)).setDependencies(l).allowExport())}else n=i(t,this,s);var c=n.evaluationState;if(h.sliders){c.assignment=o.exportedSymbol,c.slider_min_number=o.values.min,c.slider_max_number=o.values.max,c.slider_step_number=o.values.step,c.slider_min_valid=o.valids.min,c.slider_max_valid=o.valids.max,c.slider_step_valid=o.valids.step;var u=c.slider_min_valid&&c.slider_max_valid&&c.slider_step_valid;c.is_slider=!0,c.raw_slider_latex=this.getInputString(),c.is_slidable=u,c.is_animatable=c.is_slidable&&!c.is_graphable,o.errMsg&&(c.error=o.errMsg.getError())}return delete c.is_evaluable,delete c.zero_values,n}});\ndefine(\'core/math/features/analyzeFourFunction\',[\'require\',\'parsenodes\',\'core/math/statementanalysis\',\'core/math/errormsg\',\'core/math/builtinframe\'],function(require){"use strict";var n=require("parsenodes"),t=require("core/math/statementanalysis"),e=require("core/math/errormsg"),r=require("core/math/builtinframe");function o(n,r){return t(n,this,e.inequalitiesUnsupported())}n.Base.prototype.analyzeFourFunction=function(n,r){var o=this.tryGetConcreteTree(n,r);return o.isError?t(n,this,o):t(n,this,e.parseError())},n.Expression.prototype.analyzeFourFunction=function(n,o){var i=this.tryGetConcreteTree(n,o);if(i.isError)return t(n,this,i);var u=i.getDependencies();if(u.length>0){var s,a=u[0],p=r[a];return s=p?p.isFunction?e.functionUnsupported(a):e.constantUnsupported(a):e.variablesUnsupported(a),t(n,this,s)}return t(n,this,i)},n.Assignment.prototype.analyzeFourFunction=function(n,r){return t(n,this,e.assignmentsUnsupported())},n.FunctionDefinition.prototype.analyzeFourFunction=function(n,r){return t(n,this,e.functionDefinitionsUnsupported())},n.Equation.prototype.analyzeFourFunction=function(n,r){return t(n,this,e.equationsUnsupported())},n.And.prototype.analyzeFourFunction=o,n.DoubleInequality.prototype.analyzeFourFunction=o,n.BaseComparator.prototype.analyzeFourFunction=o,n.Regression.prototype.analyzeFourFunction=function(n,r){return t(n,this,e.regressionsUnsupported())},n.ParenSeq.prototype.analyzeFourFunction=function(n,r){return t(n,this,e.pointsUnsupported())}});\ndefine(\'core/math/features/analyzeScientific\',[\'require\',\'parsenodes\',\'core/math/statementanalysis\',\'core/math/errormsg\',\'core/math/builtinframe\'],function(require){"use strict";var t=require("parsenodes"),e=require("core/math/statementanalysis"),i=require("core/math/errormsg"),n=require("core/math/builtinframe");function r(t,n){return e(t,this,i.inequalitiesUnsupported())}t.Base.prototype.analyzeScientific=function(t,n){var r=this.tryGetConcreteTree(t,n);return r.isError?e(t,this,r):e(t,this,i.parseError())},t.Expression.prototype.analyzeScientific=function(t,n){var r=this.tryGetConcreteTree(t,n);if(r.isError)return e(t,this,r);var s=r.getDependencies();return s.length>0?e(t,this,i.tooManyVariables(s)):e(t,this,r)},t.Assignment.prototype.analyzeScientific=function(t,r){var s=this._symbol;if(n[s])return e(t,this,i.cannotRedefine(s));var o=Object.create(r);o[s]=i.equationsUnsupported();var a=this.tryGetConcreteTree(t,o);if(a.isError)return e(t,this,a);var c=a.getDependencies();return this.isEquation(a)?e(t,this,i.equationsUnsupported()):c.length>0?e(t,this,i.tooManyVariables(c)):e(t,this,a)},t.FunctionDefinition.prototype.analyzeScientific=function(t,r){if(n[this._symbol])return e(t,this,i.cannotRedefine(this._symbol));var s=this.tryGetConcreteTree(t,r);if(s.isError)return e(t,this,s);var o=this._argSymbols,a=s.getDependencies();if(-1!==a.indexOf(this._symbol))return e(t,this,i.selfReferentialFunction(this._symbol));var c=a.filter(function(t){return-1===o.indexOf(t)});return c.length?e(t,this,i.addArgumentsToDefinition(c,this._symbol,o)):e(t,this,s)},t.Equation.prototype.analyzeScientific=function(t,n){return e(t,this,i.equationsUnsupported())},t.And.prototype.analyzeScientific=r,t.DoubleInequality.prototype.analyzeScientific=r,t.BaseComparator.prototype.analyzeScientific=r,t.Regression.prototype.analyzeScientific=function(t,n){return e(t,this,i.regressionsUnsupported())},t.ParenSeq.prototype.analyzeScientific=function(t,n){return e(t,this,i.pointsUnsupported())}});\ndefine(\'core/math/features/analyzeSingleExpressionScientific\',[\'require\',\'parsenodes\',\'core/math/statementanalysis\',\'core/math/errormsg\',\'core/math/builtinframe\'],function(require){"use strict";var e=require("parsenodes"),n=require("core/math/statementanalysis"),i=require("core/math/errormsg"),t=require("core/math/builtinframe");function r(e,t){return n(e,this,i.inequalitiesUnsupported())}e.Base.prototype.analyzeSingleExpressionScientific=function(e,t){var r=this.tryGetConcreteTree(e,t);return r.isError?n(e,this,r):n(e,this,i.parseError())},e.Expression.prototype.analyzeSingleExpressionScientific=function(e,r){var s=this.tryGetConcreteTree(e,r);if(s.isError)return n(e,this,s);var o=s.getDependencies();if(o.length>0){var p,a=o[0],c=t[a];return p=c?c.isFunction?i.functionUnsupported(a):i.constantUnsupported(a):i.variablesUnsupported(a),n(e,this,p)}return n(e,this,s)},e.Assignment.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.assignmentsUnsupported())},e.FunctionDefinition.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.functionDefinitionsUnsupported())},e.Equation.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.equationsUnsupported())},e.And.prototype.analyzeSingleExpressionScientific=r,e.DoubleInequality.prototype.analyzeSingleExpressionScientific=r,e.BaseComparator.prototype.analyzeSingleExpressionScientific=r,e.Regression.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.regressionsUnsupported())},e.ParenSeq.prototype.analyzeSingleExpressionScientific=function(e,t){return n(e,this,i.pointsUnsupported())}});\ndefine(\'core/lib/dragmode\',["require","exports"],function(require,e){"use strict";var r;Object.defineProperty(e,"__esModule",{value:!0}),e.reconcileDragMode=e.DragMode=void 0,function(e){e.NONE="NONE",e.X="X",e.Y="Y",e.XY="XY",e.AUTO="AUTO"}(r=e.DragMode||(e.DragMode={})),e.reconcileDragMode=function(e,n){var t=function(e){return e?"none"===e[0].type&&"none"===e[1].type?r.NONE:"none"===e[1].type?r.X:"none"===e[0].type?r.Y:r.XY:r.NONE}(n);switch(e){case r.NONE:return r.NONE;case r.AUTO:case r.XY:return t;case r.X:return t===r.X||t===r.XY?r.X:r.NONE;case r.Y:return t===r.Y||t===r.XY?r.Y:r.NONE;default:return r.NONE}}});\ndefine(\'core/math/features/getgraphmode\',[\'require\',\'parsenodes\',\'core/types/graphmode\',\'core/lib/dragmode\',\'core/lib/dragmode\',\'core/math/types\'],function(require){"use strict";var e=require("parsenodes"),t=require("core/types/graphmode"),r=require("core/lib/dragmode").reconcileDragMode,o=require("core/lib/dragmode").DragMode,n=require("core/math/types");function s(e,s){if(s.isMovablePoint&&function(e,t){var n;return n=e&&e.hasOwnProperty("dragMode")?e.dragMode===o.AUTO?t.defaultDragMode:e.dragMode:t.defaultDragMode,r(n,t.moveStrategy)}(this.userData,s)!==o.NONE)return t.XYPOINT_MOVABLE;var i=s.getDependencies();switch(s.valueType){case n.Point:case n.ListOfPoint:return 0===i.length?t.XYPOINT:e.validParametricVariables(i)?2===e.dimensions()?t.PARAMETRIC:t.PARAMETRIC_CURVE_3D:t.NONE;case n.Number:case n.ListOfNumber:return 2===e.dimensions()&&1===i.length?t.Y:3===e.dimensions()&&2===i.length?t.Z_3D:t.NONE;case n.Polygon:case n.ListOfPolygon:return t.POLYGON;default:return t.NONE}}function i(e,r){var o=r._expression.getDependencies();if(o.length>1)return t.NONE;if(r._expression.isList&&0===r._expression.length)return t.NONE;var n=r._symbol;return e.graphMode(n,o)}function a(e,r){return r.isError?t.NONE:t.VISUALIZATION}e.Base.prototype.getGraphMode=function(e,r){return t.NONE},e.Expression.prototype.getGraphMode=s,e.Equation.prototype.getGraphMode=e.BaseComparator.prototype.getGraphMode=function(r,o){var n=o.getDependencies();return o.isConstant?t.NONE:o instanceof e.SolvedEquation?0===n.length?r.graphableAsConstant(o._symbol)?r.constantGraphMode(o._symbol):t.NONE:i(r,o):1===n.length||2===n.length?t.IMPLICIT:t.NONE},e.DoubleInequality.prototype.getGraphMode=function(e,t){return e.constantGraphMode(t._symbol)},e.Assignment.prototype.getGraphMode=function(r,o){if(o instanceof e.SolvedEquation)return i(r,o);if(this.isEquation(o))return this.asEquation().getGraphMode(r,o);var a=o.getDependencies();switch(o.valueType){case n.Number:case n.ListOfNumber:case n.EmptyList:switch(a.length){case 0:return r.graphableAsConstant(this._symbol)?r.constantGraphMode(this._symbol):t.NONE;case 1:return o.valueType!==n.ListOfNumber||r.graphableListVariables(this._symbol,a[0])?this.isSlider?t.NONE:r.graphMode(this._symbol,a):t.NONE;case 2:return 3===r.dimensions()&&"z"===this._symbol?t.Z_3D:t.NONE;default:return t.NONE}break;default:return s.call(this,r,o)}},e.FunctionDefinition.prototype.getGraphMode=function(e,r){if(1!==this._argSymbols.length)return t.NONE;var o=e.graphMode(this._symbol,this._argSymbols),s=r.getDependencies();switch(r.valueType){case n.Number:case n.ListOfNumber:switch(s.length){case 0:return o;case 1:return s[0]!==this._argSymbols[0]?t.NONE:o;default:return t.NONE}break;default:return t.NONE}},e.Regression.prototype.getGraphMode=function(e,r){return this.isLhsSimple&&r.isModelValid?1!==r.model.getDependencies().length?t.NONE:t.Y:t.NONE},e.Object3D.prototype.getGraphMode=function(e,r){return r.isError?t.NONE:t.OBJECT3D},e.Histogram.prototype.getGraphMode=a,e.DotPlot.prototype.getGraphMode=a,e.BoxPlot.prototype.getGraphMode=a,e.Image.prototype.getGraphMode=function(e,r){return this.userData.showPoints?this.center.isError||this.radianAngle.isError||this.width.isError||this.height.isError||this.opacity.isError?t.NONE:t.XYPOINT:t.NONE}});\ndefine(\'core/lib/color-helpers\',["require","exports"],function(require,e){"use strict";function r(e){return t(e)?(e.match(/^#([A-Fa-f0-9]{3})$/g)&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]),e.toLowerCase()):e}function t(e){return"string"==typeof e&&(e.match(/^#([A-Fa-f0-9]{3})$/g)||e.match(/^#([A-Fa-f0-9]{6})$/g))}Object.defineProperty(e,"__esModule",{value:!0}),e.colors=e.getDisplayColor=e.mutateOpacity=e.parseHex=e.invertColor=e.shadeColor=e.isValidHexColor=e.normalizeColor=void 0,e.normalizeColor=r,e.isValidHexColor=t,e.shadeColor=function(e,a){if(!t(e=r(e)))return e;a>1&&(a=1),a<-1&&(a=-1);var o=parseInt(e.slice(1),16),n=a<0?0:255,i=a<0?-1*a:a,l=o>>16,c=o>>8&255,s=255&o;return"#"+(16777216+65536*(Math.round((n-l)*i)+l)+256*(Math.round((n-c)*i)+c)+(Math.round((n-s)*i)+s)).toString(16).slice(1)},e.invertColor=function(e){if(!t(e=r(e)))return e;var a="0123456789abcdef";return"#"+e.slice(1).split("").map(function(e){return a[15-a.indexOf(e)]}).join("")},e.parseHex=function(e){if(3===(e=e.replace(/#/,"")).length)var r=parseInt(e.slice(0,1)+e.slice(0,1),16),t=parseInt(e.slice(1,2)+e.slice(1,2),16),a=parseInt(e.slice(2,3)+e.slice(2,3),16);else if(6===e.length)r=parseInt(e.slice(0,2),16),t=parseInt(e.slice(2,4),16),a=parseInt(e.slice(4,6),16);else r=0,t=0,a=0;return{r:r,g:t,b:a}},e.mutateOpacity=function(e,r){var t=/(rgba\\([\\d]+\\,\\ ?[\\d]+\\,\\ ?[\\d]+\\,\\ ?)[\\d.]+(\\))/;return e.match(t)?e.replace(t,"$1"+r+"$2"):e},e.getDisplayColor=function(e,r){if(r&&r.colorLatexValue){var t=r.colorLatexValue;return Array.isArray(t)?t[0]:t}return e.color},e.colors={RED:"#c74440",BLUE:"#2d70b3",GREEN:"#388c46",PURPLE:"#6042a6",ORANGE:"#fa7e19",BLACK:"#000000",GRAY:"#aaaaaa"}});\ndefine(\'core/math/features/getgraphinfo\',[\'require\',\'parsenodes\',\'core/math/domaintypes\',\'core/math/types\',\'core/lib/color-helpers\'],function(require){"use strict";var e=require("parsenodes"),t=require("core/math/domaintypes"),n=require("core/math/types"),a=require("core/lib/color-helpers").getDisplayColor;function r(e){switch(e.valueType){case n.Number:return o(e);case n.Point:var t=o(e.elementAt(0)),a=o(e.elementAt(1));if(!t||!a)return;return[t,a];default:return}}function o(e){var t=e.getDependencies();switch(t.length){case 0:return[+e.asValue(),0];case 1:if(e.polynomialOrder(t[0])>1)return;var n=e.getPolynomialCoefficients(t[0]);return[n[0]?+n[0].asValue():0,n[1]?+n[1].asValue():0];default:return}}e.Base.prototype.getGraphInfo=function(e,n){var o,i,s=n.getDependencies();switch(s.length){case 0:o=r(n),i=n.boundDomain("x");break;case 1:"known"===(i=n.boundDomain(s[0])).type&&(o=r(n));break;case 2:i=t.unknownDomain()}return{graphMode:this.getGraphMode(e,n),color:a(this.userData,this.metaData),pointStyle:this.userData.pointStyle,lineStyle:this.userData.lineStyle,operator:this.getOperator(),isLinear:!!o,linearCoefficients:o,domainBound:i}}});\ndefine(\'core/math/features/getMoveStrategy\',["require","exports","parsenodes","core/math/types","core/math/maybe-rational","core/math/functions"],function(require,e,t,n,i,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=t.Constant(i.maybeRational(0,1));function o(e,t,n,i,r){return{type:"updateSliderNonlinear",inputString:e,id:t,initialValue:n.constant_value,min:n.slider_min_number,max:n.slider_max_number,compiled:i,hasLinearComponent:r}}function s(e,t,n,i,r,o){for(var s=t.getDependencies(),p=0,u=s;p<u.length;p++){if(r[u[p]])return}for(var c=s.length-1;c>=0;c--){var d=s[c];if(!o[d]){var f=i[d];if(void 0!==f){var l=n[d];if(1===l.order){var g=l.tree.getPolynomialCoefficients(d),y=g[1]||a,v=g[0]||a;if(v.isConstant&&y.isConstant)if(isFinite(v.asValue())&&isFinite(y.asValue()))if(0!==y.asValue())return{symbol:d,id:f,coefficients:[-v.asValue()/y.asValue(),1/y.asValue()]}}}}}}function p(e,t){var n=function(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t}(e),i={};for(var r in t){var a=t[r].evaluationState.assignment;t[r].evaluationState.is_slidable&&n[a]&&(i[a]=r)}return i}function u(e,t,n,i){for(var r=[],a=0;a<n.length;a++){var o=n[a],s={};r.push(s);for(var p=0;p<i.length;p++){var u=i[p],c=Object.create(t);c[u]=void 0;var d=o.tryGetConcreteTree(e,c);d.isError?s[u]={tree:d,order:1/0}:s[u]={tree:d,order:d.polynomialOrder(u)}}}return r}function c(e,t,n){for(var i=0;i<e.length;i++){var r=e[i];0!==t[r].order&&(n[r]=!0)}}t.Base.prototype.getMoveStrategy=function(){},t.Assignment.prototype.getMoveStrategy=function(e,n,i,r,a){if(this._expression instanceof t.ParenSeq)return this._expression.getMoveStrategy(e,n,i,r,a)},t.ParenSeq.prototype.getMoveStrategy=function(e,t,i,a,d){if(i.valueType===n.Point&&0===i.getDependencies().length){for(var f=p(this.getDependencies(),a),l=Object.keys(f),g=this.args,y=u(e,t,g,l),v=[],h={},S={},m=0;m<2;m++){var C=g[m],b=C.getInputString();if(C.isConstant)v[m]={type:"updateCoordinate",inputString:b};else{var _=s(0,C,y[m],f,h,S);_&&(v[m]={type:"updateSlider",inputString:b,id:_.id,coefficients:_.coefficients},h[_.symbol]=!0,c(l,y[m],S)),v[m]||(v[m]={type:"none",inputString:b})}}var D,I=v[0],P=v[1];if("none"===I.type&&"updateSlider"===P.type)for(var V=0,M=g[0].getDependencies();V<M.length;V++){f[x=M[V]]===P.id&&(D=x)}else if("updateSlider"===I.type&&"none"===P.type)for(var O=0,j=g[1].getDependencies();O<j.length;O++){var x;f[x=j[O]]===I.id&&(D=x)}else"none"===I.type&&"none"===P.type&&1===l.length&&(D=l[0]);if(!D)return"none"!==I.type||"none"!==P.type?v:void 0;var q,F=f[D];try{var T=Object.create(t);T[D]=void 0,q=this.getConcreteTree(e,T).getCompiledFunction()}catch(e){return}return r.dehydrateCompiledFunction(q),[o(g[0].getInputString(),F,a[F].evaluationState,q,"updateSlider"===I.type||"updateSlider"===P.type),{type:"none",inputString:g[1].getInputString()}]}},t.Image.prototype.getMoveStrategy=function(e,t,i,r,a){if(i.center.valueType===n.Point&&0===i.center.getDependencies().length&&i.width.isConstant&&i.height.isConstant&&i.radianAngle.isConstant&&i.opacity.isConstant){var o=p(this.getDependencies(),r),d=Object.keys(o),f=[this.width,this.height];"ParenSeq"===this.center.type?f.push(this.center.args[0],this.center.args[1]):"Identifier"===this.center.type&&(this.center.referencedStatementId=function(e,t){for(var n in t)if(t[n].evaluationState.assignment===e)return n}(this.center._symbol,r));for(var l={},g={},y=u(e,t,f,d),v=[],h=[2,3,0,1],S=0;S<h.length;S++){var m=h[S],C=f[m];if(C){var b=C.getInputString();if(C.isConstant)v[m]={type:"updateCoordinate",inputString:b};else{var _=s(0,C,y[m],o,l,g);_&&(v[m]={type:"updateSlider",inputString:b,id:_.id,coefficients:_.coefficients},l[_.symbol]=!0,c(d,y[m],g)),v[m]||(v[m]={type:"none",inputString:b})}}else v[m]={type:"none",inputString:""}}if("none"!==v[0].type||"none"!==v[1].type||"none"!==v[2].type||"none"!==v[3].type)return v}}});\ndefine(\'core/math/features/getDefaultDragMode\',[\'require\',\'parsenodes\',\'core/lib/dragmode\'],function(require){"use strict";var e=require("parsenodes"),t=require("core/lib/dragmode").DragMode;e.Base.prototype.getMoveStrategy=function(){return t.NONE},e.Assignment.prototype.getDefaultDragMode=function(e){return"none"!==e[0].type&&"none"!==e[1].type?t.XY:"none"!==e[0].type?t.X:"none"!==e[1].type?t.Y:t.NONE},e.ParenSeq.prototype.getDefaultDragMode=function(e){return"updateSlider"===e[0].type&&"updateSlider"===e[1].type?t.XY:"updateSlider"===e[0].type?t.X:"updateSlider"===e[1].type?t.Y:"updateSliderNonlinear"===e[0].type&&e[0].hasLinearComponent?t.X:t.NONE}});\ndefine(\'core/math/features/tableinfo\',[\'require\',\'parsenodes\',\'core/math/types\',\'core/lib/label\',\'core/math/distribution-spec\'],function(require){"use strict";var e=require("parsenodes"),t=e.List,n=require("core/math/types"),i=require("core/lib/label"),r=require("core/math/distribution-spec").getFunctionSpecFromTree;e.Base.prototype.tableInfo=function(e,t){return!1},e.Identifier.prototype.tableInfo=function(e,t){return!!e.validFirstColumnVariable(this._symbol)&&{independent_variable:this._symbol,dependent_column:this.getInputString(),by_reference:!1}},e.Expression.prototype.tableInfo=function(e,i){var o=i.getDependencies();if(r(this))return!1;switch(i.valueType){case n.Point:case n.ListOfPoint:return 0===o.length&&((!i.isMovablePoint||"updateSlider"!==i.moveStrategy[0].type&&"updateSlider"!==i.moveStrategy[1].type)&&{independent_variable:"x",dependent_column:"y",by_reference:!1,values:t.wrap(i).asValue()});case n.Number:if(1!==o.length)return!1;var a=o[0];return!!e.validFirstColumnVariable(a)&&{independent_variable:a,dependent_column:this.getInputString(),by_reference:!1};default:return!1}},e.Assignment.prototype.tableInfo=function(t,n){if(n instanceof e.SolvedEquation)return!1;if(!this.getInputString().length)return!1;if(r(this))return!1;var o,a=n.getDependencies();if(a.length>1)return!1;if(0===a.length){if(!t.tableableAsConstant(this._symbol))return!1;o=t.implicitIndependent(this._symbol)}else o=a[0];return!!t.validFirstColumnVariable(o)&&{independent_variable:o,dependent_column:t.assignmentForbidden(this._symbol)?i.trimLatex(this.getInputString().replace(/[^=]*=/,"")):i.trimLatex(this.getInputString().split("=")[0]),by_reference:!t.assignmentForbidden(this._symbol)}},e.FunctionDefinition.prototype.tableInfo=function(e,t){if(1!==this._argSymbols.length)return!1;if(!this.getInputString().length)return!1;if(t.getDependencies().length>1)return!1;var n=this._argSymbols[0];if(!e.validFirstColumnVariable(n))return!1;var r=e.assignmentForbidden(this._symbol);return{independent_variable:n,dependent_column:r?i.trimLatex(this.getInputString().replace(/[^=]*=/,"")):i.trimLatex(this.getInputString().split("=")[0]),by_reference:!r}},e.BaseComparator.prototype.tableInfo=function(e,t){return!1},e.DoubleInequality.prototype.tableInfo=function(e,t){return!1},e.Equation.prototype.tableInfo=function(e,t){return!1}});\ndefine(\'core/math/features/tableerror\',[\'require\',\'parsenodes\',\'core/lib/worker-i18n\'],function(require){"use strict";var r=require("parsenodes"),e=require("core/lib/worker-i18n");r.Base.prototype.tableError=function(){return this.isInequality()?e.s("shared-calculator-error-table-inequality-supplement"):!(this instanceof r.Expression||this instanceof r.IRExpression)&&e.s("shared-calculator-error-table-generic-supplement")},r.List.prototype.tableError=function(){return e.s("shared-calculator-error-table-list-supplement")},r.Equation.prototype.tableError=r.Assignment.prototype.tableError=function(){return e.s("shared-calculator-error-table-equation-supplement")},r.FunctionDefinition.prototype.tableError=function(){return e.s("shared-calculator-error-table-function-definition-supplement")},r.Regression.prototype.tableError=function(){return e.s("shared-calculator-error-table-regression-supplement")}});\ndefine(\'core/lib/deepCopy\',["require","exports"],function(require,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=function r(e){var t=e;if(t&&"function"==typeof t.toJSON&&(t=t.toJSON()),!t)return t;if("object"!=typeof t)return t;if(Array.isArray(t))return t.map(r);var n={};for(var o in t)t.hasOwnProperty(o)&&(n[o]=r(t[o]));return n}});\ndefine(\'core/types/styles\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineStyle=e.PointStyle=void 0,function(e){e.POINT="POINT",e.OPEN="OPEN",e.CROSS="CROSS"}(e.PointStyle||(e.PointStyle={})),function(e){e.SOLID="SOLID",e.DASHED="DASHED",e.DOTTED="DOTTED"}(e.LineStyle||(e.LineStyle={}))});\ndefine(\'core/math/cdf-branches\',["require","exports","tslib","core/lib/deepCopy","core/math/plotter","core/math/domaintypes","core/types/styles"],function(require,e,o,n,i,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.makeContinuousCDFTopBranches=e.makeDiscreteCDFTopBranches=void 0;function d(e){var o=e.viewState,d=e.graphInfo,r=e.compiled,s=e.bounds,p=e.included,u=e.showPoint,c=n.default(d),h=t.intersectDomains(d.domainBound,t.knownDomain(s));if("known"===h.type)return c.domainBound=h,c.pointStyle=p?a.PointStyle.POINT:a.PointStyle.OPEN,i.default.computeDiscreteGraphData({graphInfo:c,viewState:o,compiled:r,showPoint:u,maxOverride:void 0})}e.makeDiscreteCDFTopBranches=function(e){var n,i=e.viewState,t=e.graphInfo,a=e.compiled,r=e.bounds,s=e.maxOverride,p=e.showPoint,u=r[0],c=r[1],h=[];u=Math.ceil(u),c=Math.floor(c);var l,v,m,f,w,S=void 0!==s?s:1/0;if(u===-1/0&&c>=S)n=d({bounds:[u,S],included:!0,viewState:i,graphInfo:t,compiled:a,showPoint:p}),h.push(n);else if(u===-1/0&&c<1/0)n=d({bounds:[u,c],included:!0,viewState:i,graphInfo:t,compiled:a,showPoint:p}),h.push(n),h.push(d({bounds:[c+1,S],included:!1,viewState:i,graphInfo:t,compiled:a,showPoint:p}));else if(u>-1/0&&c>=S)n=d({bounds:[u,S],included:!0,viewState:i,graphInfo:t,compiled:a,showPoint:p}),h.push(d({bounds:[-1/0,u-1],included:!1,viewState:i,graphInfo:t,compiled:a,showPoint:p})),h.push(n);else{n=d({bounds:[u,c],included:!0,viewState:i,graphInfo:t,compiled:a,showPoint:p});var g=d({bounds:[-1/0,u-1],included:!1,viewState:i,graphInfo:t,compiled:a,showPoint:p}),I=d({bounds:[c+1,S],included:!1,viewState:i,graphInfo:t,compiled:a,showPoint:p});h.push(n);var b=void 0;g&&I&&(v=I,m=(l=g).segments[0],f=v.segments[0],w=[o.__spreadArray(o.__spreadArray([],m),f)],b=o.__assign(o.__assign({},l),{segments:w}),h.push(b))}return{cdfTopBranch:n,topBranches:h}};e.makeContinuousCDFTopBranches=function(e){var o=e.viewState,d=e.graphInfo,r=e.compiled,s=e.derivative,p=e.bounds;return{cdfTopBranch:function(e){var o=e.viewState,d=e.graphInfo,r=e.compiled,s=e.derivative,p=e.bounds,u=n.default(d),c=t.intersectDomains(d.domainBound,t.knownDomain(p));if("known"===c.type)return u.domainBound=c,u.lineStyle=a.LineStyle.SOLID,i.default.computeGraphData({graphInfo:u,viewState:o,compiled:r,derivative:s})}({bounds:[p[0],p[1]],viewState:o,graphInfo:d,compiled:r,derivative:s}),topBranches:[i.default.computeGraphData({viewState:o,graphInfo:d,compiled:r,derivative:s})]}}});\ndefine(\'core/types/opacity\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HIGH=e.DEFAULT=e.LOW=void 0,e.LOW=.2,e.DEFAULT=.4,e.HIGH=.8});\ndefine(\'core/types/slider-loop-modes\',["require","exports"],function(require,e){"use strict";var o;Object.defineProperty(e,"__esModule",{value:!0}),e.getSliderIcon=e.SliderLoopMode=void 0,function(e){e.LOOP_FORWARD_REVERSE="LOOP_FORWARD_REVERSE",e.LOOP_FORWARD="LOOP_FORWARD",e.PLAY_ONCE="PLAY_ONCE",e.PLAY_INDEFINITELY="PLAY_INDEFINITELY"}(o=e.SliderLoopMode||(e.SliderLoopMode={})),e.getSliderIcon=function(e){switch(e){case o.LOOP_FORWARD:return"dcg-icon-arrow-one-way";case o.LOOP_FORWARD_REVERSE:return"dcg-icon-arrow-two-way";case o.PLAY_ONCE:return"dcg-icon-arrow-once";case o.PLAY_INDEFINITELY:return"dcg-icon-arrow-infinite"}}});\ndefine(\'core/types/label-sizes\',["require","exports"],function(require,e){"use strict";var i;Object.defineProperty(e,"__esModule",{value:!0}),e.maybeMigrateLabelSizeEnumToLatex=e.LabelSize=void 0,function(e){e.SMALL="small",e.MEDIUM="medium",e.LARGE="large"}(i=e.LabelSize||(e.LabelSize={})),e.maybeMigrateLabelSizeEnumToLatex=function(e){return e===i.SMALL?".85":e===i.MEDIUM?"1":e===i.LARGE?"1.35":void 0}});\ndefine(\'core/types/label-orientations\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LabelOrientation=void 0,function(e){e.DEFAULT="default",e.CENTER="center",e.CENTER_AUTO="center_auto",e.AUTO_CENTER="auto_center",e.ABOVE="above",e.ABOVE_LEFT="above_left",e.ABOVE_RIGHT="above_right",e.ABOVE_AUTO="above_auto",e.BELOW="below",e.BELOW_LEFT="below_left",e.BELOW_RIGHT="below_right",e.BELOW_AUTO="below_auto",e.LEFT="left",e.AUTO_LEFT="auto_left",e.RIGHT="right",e.AUTO_RIGHT="auto_right"}(e.LabelOrientation||(e.LabelOrientation={}))});\ndefine(\'core/lib/default-spec\',["require","exports","underscore","core/lib/deepCopy"],function(require,e,r,t){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.populateDefaults=e.stripDefaultsAndMaybeReturnUndefined=e.stripDefaults=void 0,e.stripDefaults=function(e,t){var n={};for(var a in t)t.hasOwnProperty(a)&&(r.isEqual(e[a],t[a])||(n[a]=t[a]));return n},e.stripDefaultsAndMaybeReturnUndefined=function(e,t){var n=void 0,a={};for(var u in t)t.hasOwnProperty(u)&&(r.isEqual(e[u],t[u])||(a[u]=t[u],n=a));return n},e.populateDefaults=function(e,r){r||(r={});var n={};for(var a in e)e.hasOwnProperty(a)&&!r.hasOwnProperty(a)&&(n[a]=t.default(e[a]));for(var a in r)r.hasOwnProperty(a)&&(n[a]=r[a]);return n}});\ndefine(\'core/lib/copy-properties\',["require","exports","core/lib/deepCopy"],function(require,r,e){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.makeTrueMap=r.extractPropertiesLike=r.copyAllProperties=r.copyProperties=void 0,r.copyProperties=function(r){var o=r.from,t=r.to,i=r.props;for(var n in i)i[n]&&o.hasOwnProperty(n)&&(t[n]=e.default(o[n]))},r.copyAllProperties=function(r,e){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])},r.extractPropertiesLike=function(r,e){var o={};for(var t in e)e.hasOwnProperty(t)&&(o[t]=r[t]);return o},r.makeTrueMap=function(r){var e={};for(var o in r)r.hasOwnProperty(o)&&(e[o]=!0);return e}});\ndefine(\'core/graphing-calc/json/expression\',["require","exports","tslib","core/types/opacity","core/types/styles","core/lib/dragmode","core/types/slider-loop-modes","core/types/label-sizes","core/types/label-orientations","core/lib/default-spec","../../lib/copy-properties"],function(require,e,i,a,l,t,s,r,n,o,d){"use strict";var L;function D(i){return d.extractPropertiesLike(i,e.DEFAULTS_DYNAMIC)}Object.defineProperty(e,"__esModule",{value:!0}),e.computeParsableState=e.areDynamicPropertiesStrictEqual=e.extractDynamicProperties=e.stripDefaults=e.inflateDefaults=e.SLIDER_DEFAULTS=e.DEFAULTS=e.DEFAULTS_DYNAMIC=e.DEFAULT_SLIDER_PERIOD=e.EditableLabelMode=e.CLICKABLEINFO_DEFAULTS=e.VIZ_DEFAULTS=e.CDF_DEFAULTS=void 0,e.CDF_DEFAULTS={show:!1,min:"",max:""},e.VIZ_DEFAULTS={breadth:"",axisOffset:"",alignedAxis:"x",showBoxplotOutliers:!0,binAlignment:"center",dotplotXMode:"exact",histogramMode:""},e.CLICKABLEINFO_DEFAULTS={enabled:!1,latex:""},function(e){e.None="NONE",e.Math="MATH",e.Text="TEXT"}(L=e.EditableLabelMode||(e.EditableLabelMode={})),e.DEFAULT_SLIDER_PERIOD=4e3,e.DEFAULTS_DYNAMIC={polarDomain:{min:"",max:""},parametricDomain:{min:"",max:""},cdf:e.CDF_DEFAULTS,colorLatex:"",description:"",fillOpacity:""+a.DEFAULT,lineOpacity:"",pointOpacity:"",pointSize:"",lineWidth:"",labelAngle:"",vizProps:e.VIZ_DEFAULTS,clickableInfo:e.CLICKABLEINFO_DEFAULTS},e.DEFAULTS=i.__assign(i.__assign({folderId:"",latex:"",color:"",showLabel:!1,label:"",hidden:!1,secret:!1,dragMode:t.DragMode.AUTO,labelSize:"",labelOrientation:n.LabelOrientation.DEFAULT,suppressTextOutline:!1,interactiveLabel:!1,editableLabelMode:L.None,residualVariable:"",isLogModeRegression:!1,pointStyle:l.PointStyle.POINT,lineStyle:l.LineStyle.SOLID,regressionParameters:{},displayEvaluationAsFraction:!1,slider:{}},e.DEFAULTS_DYNAMIC),{points:void 0,lines:void 0,fill:void 0}),e.SLIDER_DEFAULTS={hardMin:!1,hardMax:!1,animationPeriod:e.DEFAULT_SLIDER_PERIOD,loopMode:s.SliderLoopMode.LOOP_FORWARD_REVERSE,playDirection:1,isPlaying:!1,min:"-10",max:"10",step:""},e.inflateDefaults=function(a){return i.__assign(i.__assign(i.__assign({},e.DEFAULTS),a),{slider:i.__assign(i.__assign({},e.SLIDER_DEFAULTS),a.slider),cdf:i.__assign(i.__assign({},e.CDF_DEFAULTS),a.cdf),vizProps:i.__assign(i.__assign({},e.VIZ_DEFAULTS),a.vizProps),clickableInfo:i.__assign(i.__assign({},e.CLICKABLEINFO_DEFAULTS),a.clickableInfo)})},e.stripDefaults=function(a){var l=o.stripDefaults(e.DEFAULTS,i.__assign(i.__assign({},a),{slider:o.stripDefaults(e.SLIDER_DEFAULTS,a.slider)})),t=o.stripDefaultsAndMaybeReturnUndefined(e.CDF_DEFAULTS,a.cdf);void 0===t?delete l.cdf:l.cdf=t;var s=o.stripDefaultsAndMaybeReturnUndefined(e.VIZ_DEFAULTS,a.vizProps);void 0===s?delete l.vizProps:l.vizProps=s;var r=o.stripDefaultsAndMaybeReturnUndefined(e.CLICKABLEINFO_DEFAULTS,a.clickableInfo);return void 0===r?delete l.clickableInfo:l.clickableInfo=r,l},e.extractDynamicProperties=D,e.areDynamicPropertiesStrictEqual=function(i,a){for(var l in e.DEFAULTS_DYNAMIC)if(e.DEFAULTS_DYNAMIC.hasOwnProperty(l)&&i[l]!==a[l])return!1;return!0},e.computeParsableState=function(e){var a=r.maybeMigrateLabelSizeEnumToLatex(e.labelSize),l=a||e.labelSize;return i.__assign({type:"statement",id:e.id,latex:e.latex,label:e.label,color:e.color,fill:e.fill,points:e.points,lines:e.lines,pointStyle:e.pointStyle,lineStyle:e.lineStyle,dragMode:e.dragMode,labelSize:l,labelOrientation:e.labelOrientation,suppressTextOutline:e.suppressTextOutline,interactiveLabel:e.interactiveLabel,editableLabelMode:e.editableLabelMode,residualVariable:e.residualVariable,regressionParameters:e.regressionParameters,isLogModeRegression:e.isLogModeRegression,showLabel:e.showLabel,shouldGraph:e.hidden,slider:{min:e.slider.hardMin?e.slider.min:"",max:e.slider.hardMax?e.slider.max:"",softMin:e.slider.hardMin?"":e.slider.min,softMax:e.slider.hardMax?"":e.slider.max,step:e.slider.step,isPlayingOnce:e.slider.isPlaying&&e.slider.loopMode===s.SliderLoopMode.PLAY_ONCE}},D(e))}});\ndefine(\'core/math/features/getListIdx\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getListIdxFromBranchIdx=void 0,e.getListIdxFromBranchIdx=function(e,r){var t;switch(r){case"solvedEquation":t=2;break;case"baseComparator":t=4;break;default:t=1}return Math.floor(e/t)}});\ndefine(\'core/types/point-size\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DOTPLOT_DEFAULT=e.DEFAULT=void 0,e.DEFAULT=9,e.DOTPLOT_DEFAULT=14});\ndefine(\'core/math/features/graph\',["require","exports","parsenodes","core/math/comparators","core/math/parsenode/irexpression","tslib","core/math/errormsg","core/math/builtin","core/math/plotter","core/types/graphmode","core/lib/dragmode","core/math/expression-types","core/math/cdf-branches","core/math/copy-defined-pois","core/math/distribution-spec","core/graphing-calc/json/expression","core/types/opacity","core/lib/color-helpers","core/types/styles","core/math/types","../ir/opcodes","core/math/ir/features/as-value","./getListIdx","core/types/point-size"],function(require,e,t,a,i,o,r,s,n,l,p,u,h,c,d,m,g,f,y,v,D,x,L,b){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var O=t.List;function I(e,t,a){for(var i=1/0,o=0,r=t;o<r.length;o++){var s=e[r[o]];Array.isArray(s)&&s.length<i&&(i=s.length)}var n=1;return"solvedEquation"===a?n=2:"baseComparator"===a&&(n=4),n*i}function M(e,t,a){return Array.isArray(e)?e[L.getListIdxFromBranchIdx(t,a)]:e}function P(e,t){for(var a=1/0,i=-1/0,o=1/0,r=-1/0,s=0,n=t;s<n.length;s++)for(var l=n[s],p=0;p<l.length;p+=2){var u=l[p],h=l[p+1];u<a&&(a=u),u>i&&(i=u),h<o&&(o=h),h>r&&(r=h)}if(isFinite(a)&&isFinite(o))return{type:e,xmin:a,ymin:o,xmax:i,ymax:r}}function V(e,t){if(void 0!==e&&"binomialdist"===e.symbol&&t instanceof i){var a=t._chunk,o=a.getInstruction(a.returnIndex);if(o.type===D.NativeFunction&&"binompdf"===o.symbol)return x.asValue(a,o.args[1])}}function A(e,t,a){var i={};a-=.5*t;for(var o=e.length-1;o>=0;o--){var r=e[o],s=Math.floor((r-a)/t);i[s]?i[s].data.push(r):i[s]={id:s,data:[r],min:s*t+a,max:s*t+a+t,center:s*t+a+t/2}}return i}t.Base.prototype._graph=function(e,a,r,p,g){var y=this;if(a instanceof t.SolvedEquation)return this._graph(e,a._expression,r,p,2===a.branchMultiplier?"solvedEquation":void 0);function b(e){var t=e.editableLabelMode;return t===m.EditableLabelMode.Text||t===m.EditableLabelMode.Math}var P=a.getExpressionType(p.graphMode,a.valueType),A=u.getReconciledExpressionProps(P,{points:this.userData.points,lines:this.userData.lines,fill:this.userData.fill});switch(p.graphMode){case l.XYPOINT_MOVABLE:var E=n.default.dropUndefinedPoints([a.asValue()]),F=E.points,S=E.droppedIndices,N=this.userData.shouldGraph&&A.points,C=this.userData.showLabel&&!N;return N?[{segments:[F],graphMode:p.graphMode,droppedIndices:S,color:f.getDisplayColor(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:b(this.userData),labels:this.computedLabels||[],poi:c.default(F),movablePointInfo:[]}]:C?[{segments:[F],graphMode:l.XYPOINT,color:f.getDisplayColor(this.userData,this.metaData),style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,nakedLabel:!0,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,editableLabel:b(this.userData),labels:this.computedLabels||[],poi:c.default(F),showPoint:!1}]:[];case l.XYPOINT:var B=[],w=this.userData.shouldGraph&&A.points,_=this.userData.shouldGraph&&A.lines,z=["colorLatexValue"];w&&z.push("computedPointOpacity","computedPointSize"),(this.userData.showLabel||w)&&z.push("computedLabelSize","computedLabelAngle");var G=I(this.metaData,z,g),W=O.wrap(a).asValue();W.length>G&&(W.length=G);var Y=this.userData.showLabel&&!w&&!_,R=n.default.dropUndefinedPoints(W);return(this.userData.showLabel||w)&&B.push({segments:[R.points],graphMode:p.graphMode,droppedIndices:R.droppedIndices,color:this.metaData.colorLatexValue||this.userData.color,style:this.userData.pointStyle,showLabel:!!this.userData.showLabel,showPoint:w,labelSize:this.metaData.computedLabelSize,labelAngle:this.metaData.computedLabelAngle,labelOrientation:this.userData.labelOrientation,pointSize:this.metaData.computedPointSize,pointOpacity:this.metaData.computedPointOpacity,suppressTextOutline:this.userData.suppressTextOutline,interactiveLabel:!!this.userData.interactiveLabel,editableLabel:b(this.userData),nakedLabel:Y,labels:this.computedLabels||[],poi:c.default(W)}),_&&B.push({segments:T(W),graphMode:l.PARAMETRIC,color:f.getDisplayColor(this.userData,this.metaData),style:this.userData.lineStyle,lineWidth:this.metaData.computedLineWidth,lineOpacity:this.metaData.computedLineOpacity,poi:{}}),B;case l.PARAMETRIC:case l.PARAMETRIC_CURVE_3D:var X=this.userData,q=this.metaData,k=[];z=["colorLatexValue"];A.lines&&z.push("computedLineOpacity","computedLineWidth"),A.fill&&z.push("computedFillOpacity");var U=I(this.metaData,z,g);B=O.wrap(a).mapElements(function(t,a){if(a>=U)return{segments:[],poi:{},graphMode:l.X,color:""};var i=L.getListIdxFromBranchIdx(a,g),o=M(y.metaData.computedLineWidth,a,g),s=M(y.metaData.computedLineOpacity,a,g),u=y.metaData.colorLatexValue?M(y.metaData.colorLatexValue,a,g):y.userData.color;if(0===t.getDependencies().length){var h=n.default.dropUndefinedPoints([t.asValue()]),d=h.points,m=h.droppedIndices;return{segments:[d],graphMode:l.XYPOINT,droppedIndices:m,color:f.getDisplayColor(X,q),style:X.lineStyle,lineWidth:o,lineOpacity:s,poi:c.default(d)}}var v=t.getCompiledFunction(),D=y.getGraphInfo(e,t);return D.graphMode=p.graphMode,D.domain={min:y.metaData.evaluatedDomainMin,max:y.metaData.evaluatedDomainMax},D.style=y.userData.lineStyle,D.lineWidth=o,D.lineOpacity=s,D.color=u,D.listIndex=i,n.default.computeGraphData({viewState:r,graphInfo:D,compiled:v})});if(A.fill){if(B.forEach(function(e,t){t>=U||k.push({segments:e.segments,color:y.metaData.colorLatexValue?M(y.metaData.colorLatexValue,t,g):y.userData.color,fillOpacity:M(y.metaData.computedFillOpacity,t,g),listIndex:L.getListIdxFromBranchIdx(t,g),graphMode:l.POLYGONFILL,poi:{}})}),!A.lines)return k;B=B.concat(k)}return B;case l.X:case l.Y:case l.IMPLICIT:case l.POLAR:case l.Z_3D:var j=[],Z=a.valueType===v.Number,J=I(this.metaData,["computedLineOpacity","computedLineWidth","colorLatexValue","fillOpacity"],g);return O.wrap(a).eachElement(function(t,a){if(!(a>=J)){var u,c=p.graphMode===l.IMPLICIT||p.graphMode===l.Z_3D?t.getCompiledFunction(["x","y"]):t.getCompiledFunction(),m=d.getFunctionSpecFromTree(y),f=m&&m.discrete,v=function(e,t){if(!e)return;if(!(t instanceof i))return;var a=t._chunk,o=a.getInstruction(a.returnIndex);if(o.type!==D.NativeFunction)return;var r=e.discrete?"discreteDistribution":"continuousDistribution";if("binomialdist"===e.symbol&&"binompdf"===o.symbol){var n=x.asValue(a,o.args[1]),l=x.asValue(a,o.args[2]);return{type:r,xmin:0,xmax:n,ymin:0,ymax:h=s.binompdf(l*n,n,l)}}if("poissondist"===e.symbol&&"poissonpdf"===o.symbol){return{type:r,xmin:0,xmax:2.5*(p=x.asValue(a,o.args[1])),ymin:0,ymax:h=Math.max(s.poissonpdf(Math.floor(p),p),s.poissonpdf(Math.ceil(p),p))}}if("normaldist"===e.symbol&&"normalpdf"===o.symbol){var p=x.asValue(a,o.args[1]),u=x.asValue(a,o.args[2]),h=s.normalpdf(p,p,u);return{type:r,xmin:p-2*Math.abs(u),xmax:p+2*Math.abs(u),ymin:0,ymax:h}}if("uniformdist"===e.symbol&&"uniformpdf"===o.symbol){var c=x.asValue(a,o.args[1]),d=x.asValue(a,o.args[2]),m=(p=(c+d)/2,d-c);return{type:r,xmin:c-m/3,xmax:d+m/3,ymin:0,ymax:h=s.uniformpdf(p,c,d)}}if("tdist"===e.symbol&&"tpdf"===o.symbol){var g=x.asValue(a,o.args[1]);return{type:r,xmin:-3,xmax:3,ymin:0,ymax:h=s.tpdf(0,g)}}return}(m,t);try{u=t.getCompiledDerivative()}catch(e){}var b=y.getGraphInfo(e,t);b.listIndex=L.getListIdxFromBranchIdx(a,g),b.graphMode=p.graphMode,b.style=y.userData.lineStyle,b.lineWidth=M(y.metaData.computedLineWidth,a,g),b.lineOpacity=M(y.metaData.computedLineOpacity,a,g);var O=M(y.metaData.computedFillOpacity,a,g);b.fillOpacity=O,p.graphMode===l.POLAR&&(b.domain={min:y.metaData.evaluatedDomainMin,max:y.metaData.evaluatedDomainMax,isExplicit:y.metaData.isExplicitDomain});var I=y.metaData.colorLatexValue?M(y.metaData.colorLatexValue,a,g):y.userData.color;b.color=I;var P=y.metaData.evaluatedCDFMin,A=y.metaData.evaluatedCDFMax;if(isNaN(P)||isNaN(A)||!Z)if(f){var E=n.default.computeDiscreteGraphData({viewState:r,graphInfo:b,compiled:c,showPoint:y.userData.shouldGraph,maxOverride:V(m,t)});v&&(E.boundingBox=v),j.push(E)}else{var F=void 0===y.userData.lines||y.userData.lines,S={viewState:r,graphInfo:b,compiled:c,derivative:u};E=n.default.computeGraphData(S);if(v&&(E.boundingBox=v),E.fillSegments){E.fillSegments;var T=o.__rest(E,["fillSegments"]);F||(T.lineWidth=0),j.push(T)}else F||(E.lineWidth=0),j.push(E);b.graphMode===l.IMPLICIT&&"="!==b.operator&&j.push({graphMode:l.POLYGONFILL,segments:E.fillSegments,poi:{},listIndex:b.listIndex,color:I,fillOpacity:O})}else if(f){var N={viewState:r,graphInfo:b,compiled:c,bounds:[P,A],maxOverride:V(m,t),showPoint:y.userData.shouldGraph},C=(w=h.makeDiscreteCDFTopBranches(N)).cdfTopBranch;if((_=w.topBranches).forEach(function(e){e&&v&&(e.boundingBox=v)}),_.every(function(e){return void 0!==e})&&(j=_,C&&C.segments[0].length)){var B=[];C.segments[0].forEach(function(e){isNaN(e[0])||isNaN(e[1])||B.push([e[0],0,e[0],e[1]])}),j.push({graphMode:l.PARAMETRIC,segments:B,boundingBox:v,poi:{},color:I})}}else{var w,_;N={viewState:r,graphInfo:b,compiled:c,derivative:u,bounds:[P,A]},C=(w=h.makeContinuousCDFTopBranches(N)).cdfTopBranch;if((_=w.topBranches).forEach(function(e){e&&v&&(e.boundingBox=v)}),j=_,C&&C.segments.length){for(var z=void 0,G=void 0,W=0;W<C.segments.length;W++){if((Y=C.segments[W]).length>=4){z=Y[0];break}}for(W=C.segments.length-1;W>=0;W--){var Y;if((Y=C.segments[W]).length>=4){G=Y[Y.length-2];break}}if(void 0!==z&&void 0!==G&&isFinite(z)&&isFinite(G)){var R=n.default.polygonsFromSegments(C.segments,[[z,0,G,0]],C.graphMode);j.push({graphMode:l.POLYGONFILL,segments:R,poi:{},color:I})}}}}}),j;case l.POLYGON:B=[];var H=void 0===this.userData.lines||this.userData.lines,K=void 0===this.userData.fill||this.userData.fill;if(!K&&!H)return B;G=I(this.metaData,["computedLineOpacity","computedLineWidth","colorLatexValue","fillOpacity"],g);var Q=a.asValue();v.isList(a.valueType)||(Q=[Q]);for(var $=0;$<Q.length;$++)if(!($>G-1)){var ee=Q[$];if(ee.length){var te=this.getGraphInfo(e,a),ae=L.getListIdxFromBranchIdx($,g),ie=M(this.metaData.computedLineWidth,$,g),oe=M(this.metaData.computedLineOpacity,$,g),re=M(this.metaData.computedFillOpacity,$,g),se=this.metaData.colorLatexValue?M(this.metaData.colorLatexValue,$,g):this.userData.color,ne=T(ee=o.__spreadArray(o.__spreadArray([],ee),[ee[0]]));ne.length&&(K&&B.push({segments:ne,graphMode:l.POLYGONFILL,poi:{},color:se,fillOpacity:re,style:te.style,listIndex:ae}),H&&B.push({segments:ne,graphMode:l.PARAMETRIC,poi:{},color:se,style:this.userData.lineStyle,lineWidth:ie,lineOpacity:oe,listIndex:ae}))}}return B;case l.POLYGONFILL:case l.VISUALIZATION:case l.OBJECT3D:case l.NONE:case l.ERROR:return!1;default:var le=p.graphMode;throw new Error("Unexpected graphMode: "+le)}},t.Base.prototype.tryGraph=function(e,a,i){try{return this.graph(e,a,i)}catch(e){var o=e instanceof t.Error?e.getError():r.parseError().getError();return[n.errorBranch(o)]}},t.Base.prototype.graph=function(e,t,a){var i=this.getGraphInfo(e,t);return this._graph(e,t,a,i)},t.BaseComparator.prototype.graph=function(e,i,o){var r=this.getGraphInfo(e,i),s=r.graphMode,p="baseComparator",u=void 0===this.userData.lines||this.userData.lines;if(s===l.IMPLICIT)return this._graph(e,i,o,r);if(s===l.NONE)return!1;if(!(i instanceof t.SolvedEquation))return!1;var h=this.getOperator(),c=[],d=[],m=!0;i._expression.eachElement(function(e){c.push(e.getCompiledFunction());try{d.push(e.getCompiledDerivative())}catch(e){m=!1}}),m||(d=void 0);for(var g=[],f=[-1,0,0,1],y=I(this.metaData,["computedLineWidth","computedLineOpacity","computedFillOpacity","colorLatexValue"],p),v=Math.min(c.length,y),D=0;D<v;D++){var x=this.getGraphInfo(e,i._expression.args[D]);x.graphMode=s,x.listIndex=L.getListIdxFromBranchIdx(D,p),x.style=this.userData.lineStyle,x.color=this.metaData.colorLatexValue?M(this.metaData.colorLatexValue,D,p):this.userData.color,r.graphMode===l.POLAR&&(x.domain={min:this.metaData.evaluatedDomainMin,max:this.metaData.evaluatedDomainMax,isExplicit:this.metaData.isExplicitDomain});var b=n.default.computeGraphData({viewState:o,graphInfo:x,compiled:c[D],derivative:d?d[D]:void 0});b.lineWidth=M(this.metaData.computedLineWidth,D,p),b.lineOpacity=M(this.metaData.computedLineOpacity,D,p),b.fillOpacity=M(this.metaData.computedFillOpacity,D,p),b.operator=a.get(a.table[h].inclusive,f[D%4]),u||(b.lineWidth=0),g.push(b)}for(D=0;D<v;D+=4){var O=n.default.polygonsFromSegments(g[D+1].segments,g[D+2].segments,s);g.push({graphMode:l.POLYGONFILL,listIndex:g[D].listIndex,segments:O,poi:{},fillOpacity:g[D].fillOpacity,color:g[D].color})}return g},t.DoubleInequality.prototype.graph=function(e,t,i){var o=this,r=this.getGraphInfo(e,t);if(r.graphMode===l.NONE)return!1;var s=[],p=a.get(a.table[this._operators[0]].inclusive,0),u=a.get(a.table[this._operators[1]].inclusive,0),h=this.userData,c=this.metaData,d=void 0===h.lines||h.lines,m=["colorLatexValue","computedFillOpacity"];d&&m.push("computedLineWidth","computedLineOpacity");var g=I(c,m);return O.eachArgs(t._expressions,function(t,a){if(!(a>=g)){t[0].userData=t[1].userData=h,t[0].metaData=t[1].metaData=c;var m=o.metaData.colorLatexValue?M(c.colorLatexValue,a):h.color,f=M(c.computedLineWidth,a),y=M(c.computedLineOpacity,a),v=M(c.computedFillOpacity,a),D=o._graph(e,t[0],i,r)[0];D.listIndex=a,D.operator=p,D.color=m,D.lineWidth=f,D.lineOpacity=y,s.push(D);var x=o._graph(e,t[1],i,r)[0];x.listIndex=a,x.operator=u,x.color=m,x.lineWidth=f,x.lineOpacity=y,s.push(x);var L=n.default.polygonsFromSegments(D.segments,x.segments,D.graphMode);d||(D.lineWidth=0,x.lineWidth=0),s.push({graphMode:l.POLYGONFILL,listIndex:D.listIndex,segments:L,lineOpacity:y,fillOpacity:v,poi:{},color:m})}}),s},t.Regression.prototype.graph=function(e,t,a){var i=this.getGraphInfo(e,t);return this._graph(e,t.model,a,i)};var E=function(e){var t=[];return O.wrap(e).eachElement(function(e){t.push(e.args.map(function(e){return e.asValue()}))}),t};function F(e){return Array.prototype.concat.apply([],e)}function S(e,t,a){return!!e&&(0===t&&0===a?"none"!==e[2].type||"none"!==e[3].type:0!==t&&0!==a?"none"!==e[0].type&&"none"!==e[1].type:0!==t?"none"!==e[0].type:0!==a&&"none"!==e[1].type)}function T(e){for(var t=[],a=[],i=0,o=e;i<o.length;i++){var r=o[i],s=r[0],n=r[1];isNaN(s)||isNaN(n)?(t.length>=4&&a.push(t),t=[]):t.push(s,n)}return t.length>=4&&a.push(t),a}t.Object3D.prototype.graph=function(e,t,a){var i=this.getGraphInfo(e,t);return[{segments:[E(t)],color:i.color,objectName:this._symbol,graphMode:l.OBJECT3D}]},t.Histogram.prototype.graph=function(e,t,a){var i=this.getGraphInfo(e,t),o=t.args[0].asValue(),r=t.args[1].asValue(),s=A(o,r,this.userData.vizProps&&"left"===this.userData.vizProps.binAlignment?r/2:0),n=1;this.userData.vizProps&&"density"===this.userData.vizProps.histogramMode?n=1/(o.length*r):this.userData.vizProps&&"relative"===this.userData.vizProps.histogramMode&&(n=1/o.length);var p=[],u=[];for(var h in s){var c=s[h],d=c.data.length;u.push([c.min,0*n,c.min,d*n,c.max,d*n,c.max,0*n]);var m=0;s[c.id+1]&&(m=s[c.id+1].data.length);var f=[c.min,0*n,c.min,d*n,c.max,d*n];m<d&&f.push(c.max,m*n),p.push(f)}var y=P("histogram",u);return y&&r&&(y.binWidth=r),[{segments:u,graphMode:l.POLYGONFILL,boundingBox:y,poi:{},color:i.color,fillOpacity:g.DEFAULT},{segments:p,graphMode:l.Y,poi:{zeros:{x:[],y:[]},extrema:{x:[],y:[]},intercept:{x:[],y:[]}},color:i.color}]},t.DotPlot.prototype.graph=function(e,t,a){var i,o=this.getGraphInfo(e,t),r=t.args[1].asValue(),s=this.userData.vizProps&&"left"===this.userData.vizProps.binAlignment?r/2:0,n=A(t.args[0].asValue(),r,s),p=!1,u=[];for(var h in n)for(var d=(g=n[h]).data.length-1;d>=0;d--)g.center!==g.data[d]&&(p=!0);if(this.userData.vizProps&&"exact"===this.userData.vizProps.dotplotXMode)for(var h in n){(i=(g=n[h]).data).reverse();for(var m=0;m<i.length;m++)u.push([i[m],m+1])}else for(var h in n){var g;i=(g=n[h]).data;for(m=0;m<i.length;m++)u.push([g.center,m+1])}var f=P("dotplot",u);f&&r&&(f.ymin=0,f.xmin-=.5*r,f.xmax+=.5*r,f.binWidth=r);var y=this.metaData,v=y.computedPointOpacity,D=y.computedPointSize,x=M(v,0),L=this.userData.pointSize?M(D,0):b.DOTPLOT_DEFAULT;return[{segments:[u],graphMode:l.XYPOINT,boundingBox:f,poi:c.default(u),color:o.color,style:this.userData.pointStyle,pointSize:L,pointOpacity:x,showPoint:!0,needsDotplotXMode:p}]},t.BoxPlot.prototype.graph=function(e,t,a){var i=this.getGraphInfo(e,t),o=this.metaData.evaluatedAxisOffset,r=this.metaData.evaluatedBreadth,n=t.args[0].asValue();if(isNaN(r)||isNaN(o))return!1;var p=Math.min.apply(null,n),u=Math.max.apply(null,n),h=s.quartile(n,1),d=s.quartile(n,2),m=s.quartile(n,3),g=o,f=g-r/2,v=g+r/2,D=r/10,x=[];if(this.userData.vizProps.showBoxplotOutliers){var L=m-h,b=h-1.5*L,O=m+1.5*L;p=1/0,u=-1/0,n.forEach(function(e){b<=e&&e<p&&(p=e),u<e&&e<=O&&(u=e),(e<b||e>O)&&x.push([e,g])})}var I=[[h,f,m,f,m,v,h,v,h,f],[d,f,d,v],[h,g,p,g],[m,g,u,g],[p,g-D,p,g+D],[u,g-D,u,g+D]];if(this.userData.vizProps&&"y"===this.userData.vizProps.alignedAxis){for(var M=0,V=I;M<V.length;M++)for(var A=V[M],E=0;E<A.length;E+=2){var F=A[E];A[E]=A[E+1],A[E+1]=F}for(var S=0,T=x;S<T.length;S++){var N=T[S];F=N[0];N[0]=N[1],N[1]=F}}var C=[{segments:I,graphMode:l.PARAMETRIC,boundingBox:P("boxplot",I.concat(x)),poi:{},color:i.color}];return x.length&&C.push({segments:[x],graphMode:l.XYPOINT,color:i.color,style:y.PointStyle.OPEN,showPoint:!0,poi:c.default(x)}),C},t.Table.prototype.isValueDraggable=function(e,t,a){if(!e.columns[t].isIndependent)return!1;var i=this.columns[t].values,o=i&&i[a];return!(!o||!isFinite(o.asValue())||0!==o.getDependencies().length)},t.Table.prototype.graph=function(e,t,a){var i={};if(t.columns[0].isError)return i;for(var o=t.columns[0],r=o.values,s=1;s<this.columns.length;s++){var n=t.columns[s];if(!n.isError){var u=this.columns[s].header.userData,h=this.columns[s].header.metaData;if(!u.hidden){for(var d=I(h,["colorLatexValue","computedPointSize","computedPointOpacity"]),m=u.dragMode,g=m===p.DragMode.X||m===p.DragMode.XY,y=m===p.DragMode.Y||m===p.DragMode.XY,v=!!u.points,D=!!u.lines,x=n.isDiscrete(o),L=D&&x,b=D&&!x,O=[],M=[],P=[],V=[],A=[],E=[],S=1/0,T=-1/0,N=1/0,C=-1/0,B={},w=0;w<r.length;w++){var _=r[w],z=n.values[w];if(_&&z&&isFinite(_.asValue())&&isFinite(z.asValue())){var G=_.asValue(),W=z.asValue();if(v){if(w>=d)continue;var Y=g&&this.isValueDraggable(t,0,w),R=y&&this.isValueDraggable(t,s,w);Y||R?(P.push([G,W]),V.push({index:w,dragX:Y,dragY:R})):M.push([G,W])}L&&E.push([G,W]),G<S&&(S=G),G>T&&(T=G),W<N&&(N=W),W>C&&(C=W)}else B[w]=!0,L&&(E.length>1&&A.push(E),E=[])}var X={type:"table",xmin:S,xmax:T,ymin:N,ymax:C};if(P.length&&O.push({graphMode:l.XYPOINT_MOVABLE,segments:[P],color:h.colorLatexValue||u.color,tableId:u.tableId,poi:c.default(P),movablePointInfo:V,boundingBox:X,pointOpacity:h.computedPointOpacity}),M.length&&O.push({segments:[M],droppedIndices:B,graphMode:l.XYPOINT,showPoint:!0,poi:c.default(M),color:h.colorLatexValue||u.color,pointSize:h.computedPointSize,pointOpacity:h.computedPointOpacity,style:u.pointStyle,tableId:u.tableId,boundingBox:X}),(A.length||E.length)&&(A.push(E),O.push({segments:A.map(F),graphMode:l.PARAMETRIC,poi:{},color:f.getDisplayColor(u,h),style:u.lineStyle,lineWidth:Array.isArray(h.computedLineWidth)?h.computedLineWidth[0]:h.computedLineWidth,lineOpacity:Array.isArray(h.computedLineOpacity)?h.computedLineOpacity[0]:h.computedLineOpacity,tableId:u.tableId,boundingBox:X})),b){var q=this.columns[s].header.graph(e,t.columns[s].continuousConcreteTree,a);q.length&&Array.prototype.push.apply(O,q)}O.length&&(i[u.id]=O)}}}return i},t.Image.prototype.graph=function(e,t,a){var i=[];if(!(t.center.valueType===v.Point&&0===t.center.getDependencies().length&&t.radianAngle.isConstant&&t.width.isConstant&&t.height.isConstant&&t.opacity.isConstant))return i;for(var o=[],r=[],s=t.width.asValue()/2,n=t.height.asValue()/2,p=t.radianAngle.asValue(),u=-1;u<=1;u++)for(var h=-1;h<=1;h++){var d=t.center.asValue(),m=d[0],g=d[1],y=[m+u*s*Math.cos(p)+h*n*Math.sin(p),g-u*s*Math.sin(p)+h*n*Math.cos(p)];S(t.moveStrategy,u,h)&&(o.push(y),r.push([u,h]))}return i.push({segments:[o],scaleFactors:[r],graphMode:l.XYPOINT_MOVABLE,color:f.getDisplayColor(this.userData,this.metaData),style:this.userData.style,poi:c.default(o),movablePointInfo:[],pointOpacity:1}),i}});\ndefine(\'core/math/features/elementAt\',[\'require\',\'parsenodes\'],function(require){"use strict";var t=require("parsenodes");t.List.prototype.elementAt=function(e){return(e=Math.floor(e))>=0&&e<this.args.length?this.args[e]:t.Constant(NaN)},t.List.prototype.eachElement=function(t){for(var e=0;e<this.length;e++)t(this.elementAt(e),e)},t.List.prototype.mapElements=function(t){for(var e=[],n=0;n<this.length;n++)e.push(t(this.elementAt(n),n));return e},t.ParenSeq.prototype.elementAt=function(e){return e<0||e>this.args.length-1?t.Constant(NaN):this.args[e]}});\ndefine(\'core/math/features/printLatex\',[\'require\',\'parsenodes\',\'core/lib/label\',\'core/lib/number-to-latex\'],function(require){"use strict";var t=require("parsenodes"),r=require("core/lib/label"),i=require("core/lib/number-to-latex").default;function e(t){switch(t){case">":return">";case"<":return"<";case">=":return"\\\\ge ";case"<=":return"\\\\le ";case"=":return"="}}function n(t){return t.printLatex()}function a(t){return t.isConstant&&!0===t.asValue()}t.Identifier.prototype.printLatex=function(){return r.identifierToLatex(this._symbol)+" "},t.Constant.prototype.printLatex=function(){return i(this.asValue())},t.Ticker.prototype.printLatex=function(){return"\\\\ticker\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.Negative.prototype.printLatex=function(){return"-\\\\left("+this.args[0].printLatex()+"\\\\right)"},t.Add.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)+\\\\left("+this.args[1].printLatex()+"\\\\right)"},t.PercentOf.prototype.printLatex=function(){return this.args[0].printLatex()+" \\\\% \\\\operatorname{of} "+this.args[1].printLatex()},t.Subtract.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)-\\\\left("+this.args[1].printLatex()+"\\\\right)"},t.Multiply.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)*\\\\left("+this.args[1].printLatex()+"\\\\right)"},t.Divide.prototype.printLatex=function(){return"\\\\frac{"+this.args[0].printLatex()+"}{"+this.args[1].printLatex()+"}"},t.Exponent.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)^{"+this.args[1].printLatex()+"}"},t.Assignment.prototype.printLatex=function(){return r.identifierToLatex(this._symbol)+"="+this._expression.printLatex()},t.Equation.prototype.printLatex=function(){return this._lhs.printLatex()+"="+this._rhs.printLatex()},t.BaseComparator.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)"+e(this.operator)+"\\\\left("+this.args[1].printLatex()+"\\\\right)"},t.DoubleInequality.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)"+e(this.args[1])+this.args[2].printLatex()+e(this.args[3])+"\\\\left("+this.args[4].printLatex()+"\\\\right)"},t.And.prototype.printLatex=function(){if(!(this.args[0]instanceof t.BaseComparator&&this.args[1]instanceof t.BaseComparator))throw new Error("Not implemented");if(this.args[0].args[1].printLatex()!==this.args[1].args[0].printLatex())throw new Error("Not implemented");return"\\\\left("+this.args[0].args[0].printLatex()+"\\\\right)"+e(this.args[0].operator)+"\\\\left("+this.args[0].args[1].printLatex()+"\\\\right)"+e(this.args[1].operator)+"\\\\left("+this.args[1].args[1].printLatex()+"\\\\right)"},t.FunctionCall.prototype.printLatex=function(){switch(this._symbol){case"sqrt":return"\\\\sqrt{"+this.args[0].printLatex()+"}";case"nthroot":return"\\\\sqrt["+this.args[1].printLatex()+"]{"+this.args[0].printLatex()+"}";case"logbase":return"\\\\log_{"+this.args[1].printLatex()+"}\\\\left("+this.args[0].printLatex()+"\\\\right)";default:return r.identifierToLatex(this._symbol)+"\\\\left("+this.args.map(n).join(", ")+"\\\\right)"}},t.SeededFunctionCall.prototype.printLatex=function(){return r.identifierToLatex(this._symbol)+"\\\\left("+this.args.slice(1).map(n).join(", ")+"\\\\right)"},t.DotAccess.prototype.printLatex=function(){return"("+this.args[0].printLatex()+").("+this.args[1].printLatex()+")"},t.Prime.prototype.printLatex=function(){switch(this.args[0]._symbol){case"logbase":return"\\\\log_{"+this.args[0].args[1].printLatex()+"}"+Array(this.order+1).join("\'")+"\\\\left("+this.args[0].args[0].printLatex()+"\\\\right)";default:return r.identifierToLatex(this.args[0]._symbol)+Array(this.order+1).join("\'")+"\\\\left("+this.args[0].args.map(n).join(", ")+"\\\\right)"}},t.List.prototype.printLatex=function(){return"\\\\left["+this.args.map(n).join(", ")+"\\\\right]"},t.Range.prototype.printLatex=function(){return"\\\\left["+this.args[0].args.map(n).join(", ")+" ... "+this.args[1].args.map(n).join(", ")+"\\\\right]"},t.UpdateRule.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\to("+this.args[1].printLatex()+")"},t.ListAccess.prototype.printLatex=function(){return"\\\\left("+this.args[0].printLatex()+"\\\\right)\\\\left["+this.args[1].printLatex()+"\\\\right]"},t.ParenSeq.prototype.printLatex=function(){return"\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.BareSeq.prototype.printLatex=function(){return this.args.map(n).join(", ")},t.Sum.prototype.printLatex=function(){return"\\\\sum_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)"},t.Product.prototype.printLatex=function(){return"\\\\prod_{"+this.args[0].printLatex()+"="+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)"},t.Integral.prototype.printLatex=function(){return"\\\\int_{"+this.args[1].printLatex()+"}^{"+this.args[2].printLatex()+"}\\\\left("+this.args[3].printLatex()+"\\\\right)d"+this.args[0].printLatex()},t.FunctionExponent.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\left("+this.args[1].printLatex()+"\\\\right)^{"+this.args[2].printLatex()+"}"},t.FunctionFactorial.prototype.printLatex=function(){return this.args[0].printLatex()+"\\\\left("+this.args[1].printLatex()+"\\\\right)!"},t.Piecewise.prototype.printLatex=function(){var r=this;if(a(r.args[0]))return r.args[1].printLatex();for(var i,e=["\\\\left\\\\{"];;){if(a(r.args[0])){e.push(r.args[1].printLatex());break}if(e.push(r.args[0].printLatex(),": "),(i=r.args[2]).isConstant&&i.isNaN()){e.push(r.args[1].printLatex());break}if(e.push(r.args[1].printLatex(),", "),!(r.args[2]instanceof t.Piecewise)){e.push(r.args[2].printLatex());break}r=r.args[2]}return e.push("\\\\right\\\\}"),e.join("")},t.FunctionDefinition.prototype.printLatex=function(){return r.identifierToLatex(this._symbol)+"\\\\left("+this._argSymbols.map(r.identifierToLatex).join(", ")+"\\\\right) = "+this._expression.printLatex()},t.Derivative.prototype.printLatex=function(){return"\\\\frac{d}{d"+r.identifierToLatex(this._symbol)+"}\\\\left("+this.args[0].printLatex()+"\\\\right)"},t.Regression.prototype.printLatex=function(){return"\\\\left("+this._lhs.printLatex()+"\\\\right)\\\\sim\\\\left("+this._rhs.printLatex()+"\\\\right)"},t.Histogram.prototype.printLatex=function(){return"\\\\histogram\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.Object3D.prototype.printLatex=function(){return"\\\\"+this._symbol+"\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.DotPlot.prototype.printLatex=function(){return"\\\\dotplot\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.BoxPlot.prototype.printLatex=function(){return"\\\\boxplot\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.TTest.prototype.printLatex=function(){return"\\\\TTest\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.IndependentTTest.prototype.printLatex=function(){return"\\\\IndependentTTest\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.Stats.prototype.printLatex=function(){return"\\\\Stats\\\\left("+this.args.map(n).join(", ")+"\\\\right)"},t.AssignmentExpression.prototype.printLatex=function(){return r.identifierToLatex(this._symbol)+"="+this.args[1].printLatex()},t.ListComprehension.prototype.printLatex=function(){return"\\\\left["+this._body.printLatex()+"\\\\operatorname{for}"+this._inputLists.map(n).join(", ")+"\\\\right]"}});\ndefine(\'core/math/features/getExpressionType\',[\'require\',\'parsenodes\',\'core/types/graphmode\',\'core/math/expression-types\',\'core/math/types\'],function(require){"use strict";var e=require("parsenodes"),t=require("core/types/graphmode"),o=require("core/math/expression-types").ExpressionType,r=require("core/math/types");e.Base.prototype.getExpressionType=function(e,p){return e===t.X||e===t.Y?o.X_OR_Y:e===t.XYPOINT||e===t.XYPOINT_MOVABLE?p===r.Point?o.SINGLE_POINT:o.POINT_LIST:e===t.PARAMETRIC||e===t.PARAMETRIC_CURVE_3D?o.PARAMETRIC:e===t.POLAR?o.POLAR:e===t.IMPLICIT?o.IMPLICIT:r.isTypeOrListOfType(p,r.Polygon)?o.POLYGON:o.X_OR_Y},e.Histogram.prototype.getExpressionType=function(e,t){return o.HISTOGRAM},e.Object3D.prototype.getExpressionType=function(e,t){return o.CUBE},e.DotPlot.prototype.getExpressionType=function(e,t){return o.DOTPLOT},e.BoxPlot.prototype.getExpressionType=function(e,t){return o.BOXPLOT}});\ndefine(\'core/math/parser\',["require","exports","tslib","core/math/baseparser","core/math/features/getConcreteTree","core/math/features/buildIRExpression","core/math/features/typeCheck","core/math/features/repr","core/math/features/substitute","core/math/features/simpleFunctionExpression","core/math/features/analyze","core/math/features/analyzeFourFunction","core/math/features/analyzeScientific","core/math/features/analyzeSingleExpressionScientific","core/math/features/getgraphmode","core/math/features/getgraphinfo","core/math/features/getMoveStrategy","core/math/features/getDefaultDragMode","core/math/features/tableinfo","core/math/features/tableerror","core/math/features/graph","core/math/features/elementAt","core/math/features/printLatex","core/math/features/getExpressionType"],function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),t.__exportStar(r,e)});\ndefine(\'core/math/interpolatedlabel\',["require","exports","parsenodes","core/lib/label","./policy","core/math/types"],function(require,e,t,n,r,a){"use strict";function u(e){if(e.length<2)return"text";var t=e.split("`").length-1;return t<2?"text":2===t&&"`"===e[0]&&"`"===e[e.length-1]?"latex":"mixed"}function i(e){if(0===e.length)return[""];for(var t=[],n=e.split(/(`)/),r=!1,a="",u=0;u<n.length;u++){var i=n[u];i.length&&("`"===i?(a+="`",(r=!r)||(t.push(a),a="")):(a+=i,r||(t.push(a),a="")))}return a.length&&t.push(a),t}function l(e){for(var t,n="\\\\$({"+["[a-zA-Z][0-9]*","[a-zA-Z]_[a-zA-Z0-9]+","[a-zA-Z]_\\\\{[a-zA-Z0-9]+\\\\}","\\\\\\\\[a-zA-Z]+","\\\\\\\\[a-zA-Z]+_{[a-zA-Z0-9]+}","\\\\\\\\[a-zA-Z]+_[a-zA-Z0-9]+"].join("})|\\\\$({")+"})",r=new RegExp(n,"g"),a=[],u=0,i=0;t=r.exec(e);){(i=t.index)>u&&a.push(e.substr(u,i-u));var l=t[0],s=l.replace(/[{}\\$]/g,"").replace(/^([a-zA-Z])([0-9]+)$/,"$1_$2");a.push({symbol:s,str:l}),u=t.index+l.length}return u<e.length&&a.push(e.substr(u)),{raw:e,parts:a}}function s(e,t){return t?"{"+n.truncatedLatexLabel(e,{bigCutoff:1e7,digits:8})+"}":n.truncatedPlainmathLabel(e,{bigCutoff:1e7,digits:8})}Object.defineProperty(e,"__esModule",{value:!0}),e.interpolate=e.parse=e.chunkLabel=e.classifyLabelText=void 0,e.classifyLabelText=u,e.chunkLabel=i,e.parse=function(e){return i(e).map(l)},e.interpolate=function(e,n,i){return e.map(function(e){return function(e,n,i){for(var l=[],o="latex"===u(e.raw),p=0,f=e.parts;p<f.length;p++){var c=f[p];if("string"==typeof c)l.push(c);else{var h=t.Identifier(c.symbol).tryGetConcreteTree(r.defaultPolicy,n);if(h.valueType===a.Number&&0===h.getDependencies().length){if("number"==typeof(g=h.asValue())){l.push(s(g,o));continue}}else if(h.valueType===a.ListOfNumber&&i<h.length&&0===h.getDependencies().length){var g;if("number"==typeof(g=h.elementAt(i).asValue())){l.push(s(g,o));continue}}o?l.push("{?}"):l.push("?")}}return l.join("")}(e,n,i)}).join("")}});\ndefine(\'core/math/getCLSymbolMap\',["require","exports","underscore","core/lib/label"],function(require,e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getCLSymbolMap=void 0,e.getCLSymbolMap=function(){var e={},a={},s={},i=[];for(var n in this.statements){if(this.statements.hasOwnProperty(n))switch((u=this.statements[n]).type){case"Error":break;case"Regression":s[n]=[],i.push(n);break;default:var o=u.getLegalExports(this.policy);if(o){for(var p=0,l=o;p<l.length;p++){var c=l[p];u.exportPenalty>0?a[c]=n:e[c]=n}s[n]=t.difference(u.getDependencies(),u.getDummyDependencies(),o)}}}for(var d=0,f=i;d<f.length;d++){n=f[d];var u=this.statements[n],h=r.latexToIdentifier(u.userData.residualVariable);h&&(a[h]=n);var v=u.getDependencies().slice(),g={};for(c=void 0;c=v.pop();)if(!g[c]){g[c]=!0;var y=e[c]||a[c];y?(v.push.apply(v,s[y]),s[n].push(c)):a[c]=n}}return{exportMap:e,weakExportMap:a,dependencyMap:s}}});\ndefine(\'core/types/line-width\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.THICK=e.DEFAULT=e.THIN=void 0,e.THIN=1,e.DEFAULT=2.5,e.THICK=5});\ndefine(\'core/types/point-opacity\',["require","exports"],function(require,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT=void 0,e.DEFAULT=.9});\ndefine(\'core/math/context\',["require","exports","parsenodes","./finddependencyorder","./workerconfig","./findIntersections","core/vendor/d3-color","./policyFourFunction","./policyScientific","./policyGraphing","./frameFourFunction","./frameScientific","./frameSingleExpressionScientific","./frameGraphing","tslib","core/math/parser","core/math/errormsg","core/math/finddependencyorder","underscore","./plotter","core/types/graphmode","./interpolatedlabel","./expression-types","./getCLSymbolMap","./distribution-spec","./maybe-rational","core/lib/label","./functions","core/types/line-width","core/types/point-opacity","core/types/point-size","./evaluationstate","core/math/types","./cache-stats","./parsenode-from-value","./ir/features/action-to-latex"],function(require,e,t,i,a,s,r,n,o,l,p,d,c,u,h,f,m,v,y,g,_,x,b,D,S,P,O,E,T,F,w,R,M,A,C,I){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Context=void 0;var N="undefined"!=typeof performance?function(){return performance.now()}:function(){return Date.now()},k=t.Constant,L=t.Seed,G=t.FunctionCall,V=t.Image,z=t.Slider,W=t.Table,j=t.TableColumn,B=s.findIntersections,q={fourFunction:n.PolicyFourFunction,scientific:o.PolicyScientific,singleExpressionScientific:o.PolicySingleExpressionScientific,singleExpressionFourFunction:n.PolicySingleExpressionFourFunction,graphing:l.PolicyGraphing,graphing_3d:l.PolicyGraphing3D},H={fourFunction:p,singleExpressionFourFunction:p,scientific:d,singleExpressionScientific:c,graphing:u,graphing_3d:u};function U(e,i){var a=f.parse(e,i);return a.isError||a instanceof t.Expression?a:m.parseError()}function X(e){var t=e.rawTree.userData,i=e.rawTree.metaData;return!!(t.cdf&&t.cdf.show&&i.distributionSpec)}function Y(e){var t=e.evaluationState.expression_type,i=e.rawTree.userData;return!(!i.clickableInfo||!i.clickableInfo.enabled)&&(!!e.rawTree.isImage||e.getGraphMode()!==_.XYPOINT_MOVABLE&&b.isClickableExpressionType(t))}function J(e,t){for(var i="id"+e,a=0,s=t||[];a<s.length;a++){var r=s[a];i+="::"+r[0]+r[1]}return i}var K=k(P.maybeRational(0,1)),Q=k(P.maybeRational(1,1)),Z=k(NaN);function $(e,t){return e?"0"===e?K:"1"===e?Q:U(e,t):Z}function ee(e,t){if(e)return U(e,t)}function te(e){return"ans"!==e.slice(0,3)}function ie(e,t){var i=e.multiplyDefined,a=e.multiplyDefinedByTables,s=e.cyclicallyDefined;for(var r in i)i.hasOwnProperty(r)&&(t[r]=a[r]?m.multiplyDefinedByTables(r):m.multiplyDefined(r));for(var r in s)if(s.hasOwnProperty(r)){var n=e.tableDefined[r]&&!e.globallyDefined[r],o=s[r].filter(te);t[r]=n?m.tableCycleWithoutGlobalDefinition(o):m.cycle(o)}}function ae(e,t,i){for(var a=0,s=i;a<s.length;a++){var r=s[a];e[r]||(e[r]=[]),e[r].push(t)}}function se(e,t,i){if(i.extraDepNodes)for(var a=0,s=i.extraDepNodes;a<s.length;a++){var r=s[a];r&&ae(e,t,r.getDependencies())}i.clickHandler&&ae(e,t,i.clickHandler.getDependencies())}function re(e,t,i){var a=e.evaluationState,s=e.rawTree,r=s.metaData.cdfMin,n=s.metaData.cdfMax,o={},l=NaN,p=NaN,d="Assignment"===s.type?s._expression:s,c=d&&d.metaData&&d.metaData.distributionSpec;if(r){var u=r.tryGetConcreteTree(t,i);u.isConstant&&(l=+u.asValue());for(var h=0,f=u.getDependencies();h<f.length;h++){o[f[h]]=!0}}else l=-1/0;if(n){var v=n.tryGetConcreteTree(t,i);v.isConstant&&(p=+v.asValue());for(var y=0,g=v.getDependencies();y<g.length;y++){o[g[y]]=!0}}else p=1/0;var _=!0,x=!0;if(isNaN(l)&&(_=!1,l=NaN),isNaN(p)&&(x=!1,p=NaN),_?x?l>p&&(_=!1,x=!1,a.error=m.cdfMaxLessThanMin().getError()):a.error=m.cdfMaxInvalid().getError():a.error=m.cdfMinInvalid().getError(),_&&x){var b=G("cdf",[d,k(l),k(p)]);a.cdf_evaluation=+b.tryGetConcreteTree(t,i).asValue()}var D=-1/0,S=1/0;if(c&&(c.discrete&&(D=0),"binomialdist"===c.symbol&&d.args&&d.args[0])){var P=+d.args[0].asValue();isFinite(P)&&(S=P)}s.metaData.evaluatedCDFMin=l,s.metaData.evaluatedCDFMax=p,a.cdf_min_valid=_,a.cdf_max_valid=x,a.cdf_min_default=D,a.cdf_max_default=S,a.is_single_identifier=!1,R.addSliderPrompts(a,t,o)}var ne={lineWidth:{parseNode:"lineWidth",valueOutputProp:"computedLineWidth",formulaOutputProp:"",validOutputProp:"line_width_valid",default:function(){return T.DEFAULT},transform:void 0,shouldEvaluate:void 0,seed:"lw"},lineOpacity:{parseNode:"lineOpacity",valueOutputProp:"computedLineOpacity",formulaOutputProp:"",validOutputProp:"line_opacity_valid",default:void 0,transform:void 0,shouldEvaluate:void 0,seed:"lo"},pointOpacity:{parseNode:"pointOpacity",valueOutputProp:"computedPointOpacity",formulaOutputProp:"",validOutputProp:"point_opacity_valid",default:function(e,t,i){return e&&t&&e.getGraphMode(i,t)===_.XYPOINT_MOVABLE?1:F.DEFAULT},transform:void 0,shouldEvaluate:void 0,seed:"po"},pointSize:{parseNode:"pointSize",valueOutputProp:"computedPointSize",formulaOutputProp:"",validOutputProp:"point_size_valid",default:function(){return w.DEFAULT},shouldEvaluate:void 0,transform:void 0,seed:"ps"},fillOpacity:{parseNode:"fillOpacity",valueOutputProp:"computedFillOpacity",formulaOutputProp:"",validOutputProp:"fill_opacity_valid",default:void 0,transform:void 0,shouldEvaluate:function(e){if(!e)return!1;var t=e.evaluationState,i=t.expression_type,a=t.is_inequality;return!(i!==b.ExpressionType.POLYGON&&i!==b.ExpressionType.PARAMETRIC&&!a)},seed:"fo"},labelSize:{parseNode:"labelSize",valueOutputProp:"computedLabelSize",formulaOutputProp:"",validOutputProp:"label_size_valid",transform:void 0,default:function(){return 1},shouldEvaluate:void 0,seed:"ls"},labelAngle:{parseNode:"labelAngle",valueOutputProp:"computedLabelAngle",formulaOutputProp:"label_angle_value",validOutputProp:"label_angle_valid",default:function(){return 0},transform:function(e){return"-\\\\trigAngleMultiplier*("+e+")"},shouldEvaluate:void 0,seed:"la"}};function oe(e,t,i,a,s,r){var n,o=ne[r];e&&(n=e.tryGetConcreteTree(a,s));var l=o.default&&o.default(e,n,a),p=function(e,t,i,a){var s,r={},n=!0,o=NaN,l=!1;if(i){var p=i.tryGetConcreteTree(e,t);s=0===p.getDependencies().length?p.asValue():NaN,o=(l=Array.isArray(s))?s:+s;for(var d=0,c=p.getDependencies();d<c.length;d++)r[c[d]]=!0}if(l)for(var u=0,h=o;u<h.length;u++){var f=h[u];if(!isFinite(+f)){n=!1,o=NaN;break}}else isFinite(+o)||(n=!1,o=NaN);return i||(n=!0,void 0!==a&&(o=a)),{value:o,valid:n,missingVarsMap:r}}(a,s,i[o.parseNode],l);i[o.valueOutputProp]=p.value,o.formulaOutputProp&&(t[o.formulaOutputProp]=p.value),t[o.validOutputProp]=p.valid,R.addSliderPrompts(t,a,p.missingVarsMap)}function le(e,t,i,a){var s,r;if(e.rawTree.isTable&&e.evaluationState.column_data&&e.rawTree.columns)for(var n=0;n<e.evaluationState.column_data.length;n++)s=e.evaluationState.column_data[n],oe((r=e.rawTree.columns[n].header.metaData)[a],s,r,t,i,a);else s=e.evaluationState,oe((r=e.rawTree.metaData)[a],s,r,t,i,a)}function pe(e){return r.rgb(e[0],e[1],e[2]).formatHex()}function de(e,t,i,a,s){var r;if(e){var n=e.tryGetConcreteTree(a,s),o=n.getDependencies().length>0?void 0:n.asValue(),l=n.valueType;if(r=!(!o||l!==M.RGBColor&&l!==M.ListOfColor)){var p=n&&n.valueType===M.RGBColor?pe(o):o.map(pe);t.colorLatexValue=p,i.color_latex_value=p}}else r=!0;i.color_latex_valid=r}function ce(e,t,i){var a,s;if(e.rawTree.isTable&&e.evaluationState.column_data&&e.rawTree.columns)for(var r=0;r<e.evaluationState.column_data.length;r++)a=e.evaluationState.column_data[r],de((s=e.rawTree.columns[r].header.metaData).colorLatex,s,a,t,i);else a=e.evaluationState,de((s=e.rawTree.metaData).colorLatex,s,a,t,i)}function ue(e,t,i){var a=e.evaluationState,s={},r=e.rawTree.metaData.clickHandler;if(r){var n=r.tryGetConcreteTree(t,i);n.isError||n.valueType===M.Action||(n=m.eventHandlerTypeError(M.prettyPrint(n.valueType)));for(var o=0,l=n.getDependencies();o<l.length;o++){var p=l[o];t.validActionVariable(p)||(s[p]=!0)}var d=Object.keys(s);d.length>0&&(n=m.tooManyVariables(d).setDependencies(n.getDependencies())),n.isError&&!R.isErrorExportableActionDefinition(t,n)?a.click_handler={status:"error",error:n.getError()}:n.isEmptyAction?a.click_handler={status:"empty"}:a.click_handler={status:"maybe-valid"},R.addSliderPrompts(a,t,s)}}function he(e,t,i){var a=e.evaluationState,s=e.rawTree,r=a.expression_type===b.ExpressionType.POLAR?s.metaData.polarDomainMin:s.metaData.parametricDomainMin,n=a.expression_type===b.ExpressionType.POLAR?s.metaData.polarDomainMax:s.metaData.parametricDomainMax,o={},l=NaN,p=NaN,d=!1;if(r){d=!0;var c=r.tryGetConcreteTree(t,i);c.isConstant&&(l=+c.asValue());for(var u=0,h=c.getDependencies();u<h.length;u++){o[h[u]]=!0}}else l=0;if(n){d=!0;var f=n.tryGetConcreteTree(t,i);f.isConstant&&(p=+f.asValue());for(var v=0,y=f.getDependencies();v<y.length;v++){o[y[v]]=!0}}else a.expression_type===b.ExpressionType.PARAMETRIC?p=1:a.expression_type===b.ExpressionType.POLAR&&(p=12*Math.PI/+i.trigAngleMultiplier.asValue());var g=!0,_=!0;isFinite(l)||(g=!1,l=NaN),isFinite(p)||(_=!1,p=NaN),g?_?l>p&&(g=!1,_=!1,a.error=m.domainMaxLessThanMin().getError()):a.error=m.domainMaxInvalid().getError():a.error=m.domainMinInvalid().getError(),s.metaData.evaluatedDomainMin=l,s.metaData.evaluatedDomainMax=p,a.expression_type===b.ExpressionType.POLAR&&(s.metaData.isExplicitDomain=d),a.domain_min_number=l,a.domain_max_number=p,a.domain_min_valid=g,a.domain_max_valid=_,a.expression_type===b.ExpressionType.PARAMETRIC&&(delete o.t,R.addSliderPrompts(a,t,o))}function fe(e,t,i){var a=e.evaluationState,s=e.rawTree,r=s.metaData.vizAxisOffset,n=s.metaData.vizBreadth,o={},l=NaN,p=NaN;if(r){var d=r.tryGetConcreteTree(t,i);d.isConstant&&(l=+d.asValue());for(var c=0,u=d.getDependencies();c<u.length;c++){o[u[c]]=!0}}else l=1;if(n){var h=n.tryGetConcreteTree(t,i);h.isConstant&&(p=+h.asValue());for(var f=0,v=h.getDependencies();f<v.length;f++){o[v[f]]=!0}}else p=1;var y=!0,g=!0;isFinite(l)||(y=!1,l=NaN),isFinite(p)||(g=!1,p=NaN),y?g||(a.error=m.boxplotBreadthInvalid().getError()):a.error=m.boxplotOffsetInvalid().getError(),s.metaData.evaluatedAxisOffset=l,s.metaData.evaluatedBreadth=p,a.viz_values={axisOffset:l,breadth:p},a.viz_valids={axisOffset:y,breadth:g},R.addSliderPrompts(a,t,o)}function me(e,i,a){if(!e.isError&&!e.getDependencies().length&&e.valueType===M.Action){var s=e.asValue();if(s)for(var r in s.updateRules){i[r]=I.actionLatexForSymbol(s,r);var n=s.updateRules[r],o=n.value,l=n.valueType;a[r]=t.Assignment(r,C.parseNodeFromValue(l,o))}}}var ve=function(){function e(){this.getCLSymbolMap=D.getCLSymbolMap,this.statements={},this.analysis={},this.currentStatus={},this.currentLabel={},this.unpublishedIds={},this.dimensions={width:0,height:0},this.intersectId=void 0,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={},this.markedRegressionDirty=!1,this.use_degrees=!1,this.initialEvaluation=!1,this.globalEventCount=0,this.actions=!0,this.setEvaluationMode("graphing"),this.setRestrictedFunctions(!1),this.setForceEnableGeometryFunctions(!1),this.setFunctionDefinition(!0),this.setReplaceRoundWithReciprocal(!1),this.setDistributions(!0),this.invalidate()}return e.prototype.invalidate=function(){for(var e in this.statements)this.statements.hasOwnProperty(e)&&this.markAsDirtyRoot(e);this.currentStatus={},this.analysis={},this.parent_frame=H[this.evaluationMode].getFrame({restrictedFunctions:this.restrictedFunctions,forceEnableGeometryFunctions:this.forceEnableGeometryFunctions,replaceRoundWithReciprocal:this.replaceRoundWithReciprocal,distributions:this.distributions,additionalFunctions:this.additionalFunctions,trigAngleMultiplier:k(this.use_degrees?Math.PI/180:P.maybeRational(1,1)),initialEvaluation:k(this.initialEvaluation?1:0),globalEventCount:k(0),globalRandomSeed:L(this.globalRandomSeedString||""),width:q[this.evaluationMode].dimensionVarsEnabled()?k(P.maybeRational(this.dimensions.width,1)):m.variableUnsupported("width"),height:q[this.evaluationMode].dimensionVarsEnabled()?k(P.maybeRational(this.dimensions.height,1)):m.variableUnsupported("height")}),this.frame=Object.create(this.parent_frame),this.lastFrame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame),this.lastClockTickTime=void 0},e.prototype.processChangeSet=function(e){var t=N(),i={cacheWrites:0,cacheReads:0,cacheHits:0,cacheMisses:0};A.setCacheStatStore(i);var a={intersections:{},graphs:{}};e.isCompleteState&&(this.invalidate(),this.statements={},this.currentLabel={});var s=!!e.isCompleteState&&!e.isUndoRedoState;s!==this.initialEvaluation&&(this.initialEvaluation=s,this.invalidate()),e.viewState&&this.setViewState(e.viewState),e.hasOwnProperty("degreeMode")&&this.setDegreeMode(e.degreeMode),e.hasOwnProperty("globalRandomSeed")&&this.setGlobalRandomSeed(e.globalRandomSeed),e.hasOwnProperty("evaluationMode")&&this.setEvaluationMode(e.evaluationMode),e.hasOwnProperty("additionalFunctions")&&this.setAdditionalFunctions(e.additionalFunctions),e.hasOwnProperty("restrictedFunctions")&&this.setRestrictedFunctions(e.restrictedFunctions),e.hasOwnProperty("forceEnableGeometryFunctions")&&this.setForceEnableGeometryFunctions(e.forceEnableGeometryFunctions),e.hasOwnProperty("distributions")&&this.setDistributions(e.distributions),e.hasOwnProperty("functionDefinition")&&this.setFunctionDefinition(e.functionDefinition),e.hasOwnProperty("replaceRoundWithReciprocal")&&this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal),e.hasOwnProperty("pointsOfInterest")&&this.setWorkerConfigProperty("pointsOfInterest",e.pointsOfInterest),e.hasOwnProperty("plotSingleVariableImplicitEquations")&&this.setWorkerConfigProperty("plotSingleVariableImplicitEquations",e.plotSingleVariableImplicitEquations),e.hasOwnProperty("plotImplicits")&&this.setWorkerConfigProperty("plotImplicits",e.plotImplicits),e.hasOwnProperty("plotInequalities")&&this.setWorkerConfigProperty("plotInequalities",e.plotInequalities),e.hasOwnProperty("sliders")&&this.setWorkerConfigProperty("sliders",e.sliders),e.hasOwnProperty("actions")&&this.setActions(!!e.actions),e.hasOwnProperty("intersectId")&&(this.intersectId=e.intersectId),e.hasOwnProperty("dimensions")&&this.setDimensions(e.dimensions);var r=N();this.processStatements(e,a);var n=N();i.processStatements=n-r,r=n,this.updateAnalysis(),n=N(),i.updateAnalysis=n-r,r=n,e.hasOwnProperty("intersectId")&&this._updateIntersections(e.intersectId,a),n=N(),i.updateIntersections=n-r,r=n;var o=this._publishAllStatuses();n=N(),i.publishAllStatuses=n-r,r=n,this._computeAllLabels(),n=N(),i.computeAllLabels=n-r,r=n,this._computeAriaDescriptions(),n=N(),i.computeAriaDescriptions=n-r,r=n,this._graphAllChanged(a),n=N(),i.graphAllChanges=n-r;var l=this.processEvents(e.events);return this.unpublishedIds={},i.timeInWorker=n-t,{syncId:e.syncId,isCompleteState:e.isCompleteState,intersectionChanges:a.intersections,statusChanges:o,graphChanges:a.graphs,timingData:i,eventUpdates:l}},e.prototype.processStatements=function(e,t){if(e.removes)for(var i in e.removes){var a=void 0;if(!e.isCompleteState&&this.statements.hasOwnProperty(i)&&(a=this.statements[i].getAllIds()),this.removeStatement(i,t),!e.isCompleteState&&a)for(var s=0,r=a;s<r.length;s++){var n=r[s];t.graphs[n]=void 0}}if(e.statements)for(var i in e.statements){var o=e.statements[i];null===o||this.addStatement(o,t)}},e.prototype.setViewState=function(e){if(!y.isEqual(e,this.viewState))for(var t in this.viewState=e,this.statements)this.statements.hasOwnProperty(t)&&(this.unpublishedIds[t]=!0)},e.prototype.getViewState=function(){if(this.viewState){var e=Object.create(this.viewState);return this.parent_frame&&this.parent_frame.trigAngleMultiplier?e.trigAngleMultiplier=this.parent_frame.trigAngleMultiplier.asValue():e.trigAngleMultiplier=1,e}},e.prototype.setDegreeMode=function(e){this.use_degrees=e,this.invalidate()},e.prototype.setDimensions=function(e){void 0!==e&&(this.dimensions=e,this.invalidate())},e.prototype.setGlobalRandomSeed=function(e){this.globalRandomSeedString=e,this.parent_frame.globalRandomSeed=L(e),this.dirtyExportedSymbolRoots.globalRandomSeed=!0},e.prototype.setEvaluationMode=function(e){this.evaluationMode=e,this.policy=q[e],this.invalidate()},e.prototype.setAdditionalFunctions=function(e){this.additionalFunctions=e,this.invalidate()},e.prototype.setRestrictedFunctions=function(e){this.restrictedFunctions=e,this.invalidate()},e.prototype.setForceEnableGeometryFunctions=function(e){this.forceEnableGeometryFunctions=e,this.invalidate()},e.prototype.setDistributions=function(e){this.distributions=e,this.invalidate()},e.prototype.setFunctionDefinition=function(e){this.functionDefinition=e,this.invalidate()},e.prototype.setReplaceRoundWithReciprocal=function(e){this.replaceRoundWithReciprocal=e,this.invalidate()},e.prototype.setActions=function(e){e!==this.actions&&(this.actions=e,this.invalidate())},e.prototype.setWorkerConfigProperty=function(e,t){t!==a[e]&&(a[e]=t,this.invalidate())},e.prototype._publishAllStatuses=function(){var e={},t=this.currentStatus;for(var i in this.currentStatus={},this.unpublishedIds)if(this.analysis.hasOwnProperty(i)){var a=this.analysis[i].evaluationState;y.isEqual(a,t[i])||(e[i]=a),this.currentStatus[i]=a}return e},e.prototype._computeAllLabels=function(){for(var e in this.currentLabel){var t=this.statements[e];if(t){var i=t.tryGetConcreteTree(this.policy,this.frame),a=1;i.valueType===M.ListOfPoint&&(a=i.length);for(var s=[],r=0;r<a;r++)s.push(x.interpolate(this.currentLabel[e],this.frame,r));y.isEqual(s,t.computedLabels)||(t.computedLabels=s,this.unpublishedIds[e]=!0)}}},e.prototype._computeAriaDescriptions=function(){for(var e in this.analysis){var t=this.analysis[e],i=t.evaluationState,a=t.rawTree.userData;if(a.description&&""!==a.description){i.computed_description=[];var s=1;t.concreteTree.isList?s=t.concreteTree.length:i.dimensions&&i.dimensions.x&&Array.isArray(i.dimensions.x)&&(s=i.dimensions.x.length);for(var r=0;r<s;r++)i.computed_description.push(x.interpolate(x.parse(a.description),this.frame,r))}}},e.prototype._graphAllChanged=function(e){var t=this.getViewState(),i=!1;if(g.default.validateViewState(t)){for(var a in this.unpublishedIds)if(this.analysis.hasOwnProperty(a)){var s=this.analysis[a],r=s.evaluationState.expression_type,n=r===b.ExpressionType.SINGLE_POINT||r===b.ExpressionType.POINT_LIST;if(s.rawTree.isTable)for(var o=s.graph(t),l=0,p=s.rawTree.getAllIds();l<p.length;l++){var d=p[l];o[d]?this._notifyGraphComputed(d,o[d],e):this._notifyGraphRemoved(d,e)}else s.evaluationState.is_graphable&&(s.rawTree.userData.shouldGraph||s.rawTree.userData.showLabel&&n)?(this._notifyGraphComputed(a,s.graph(t),e),this.intersectId===a&&(i=!0)):this._notifyGraphRemoved(a,e)}y.keys(this.unpublishedIds).length&&void 0!==this.intersectId&&(this.unpublishedIds.hasOwnProperty(this.intersectId)||(i=!0)),i&&this._updateIntersections(this.intersectId,e)}},e.prototype._notifyGraphRemoved=function(e,t){t.graphs[e]=void 0},e.prototype._notifyGraphComputed=function(e,t,i){E.dehydrateGraphData(t),i.graphs[e]=t},e.prototype._updateIntersections=function(e,t){if(this.viewState)if(this.analysis[e]&&this.analysis[e].shouldIntersect()){var i=B(this.analysis,this.viewState,e);t.intersections[e]=i}else t.intersections[e]=[]},e.prototype.getDisabledFeatures=function(){var e=this.policy.disabledFeatures();!1===this.functionDefinition&&(e=e.concat("FunctionDefinition")),!1===this.actions&&(e=e.concat("UpdateRule"));var t=this.additionalFunctions||[];return e=e.filter(function(e){return("Exponent"!==e||-1===t.indexOf("exponent"))&&("PercentOf"!==e||-1===t.indexOf("percent"))})},e.prototype.areFractionsDisallowed=function(){var e=this.evaluationMode;return("fourFunction"===e||"singleExpressionFourFunction"===e)&&(!this.additionalFunctions||-1===this.additionalFunctions.indexOf("fraction"))},e.prototype.addStatement=function(e,i){var a=this;if(e){var s=e.id;this.markExportsDirty(s),this.markAsDirtyRoot(s);var r={index:this.policy.ansEnabled()?e.index:void 0,disabledFeatures:this.getDisabledFeatures(),disallowFrac:this.areFractionsDisallowed(),seedPrefix:J(s)},n={extraDepNodes:[]};switch(e.type){case"table":var o=[];this.statements.hasOwnProperty(s)&&(o=this.statements[s].getAllIds()),e.shouldGraph=!0;for(var l=e.columns,p=[],d=0,c=0,u=l;c<u.length;c++){var m=u[c];d=Math.max(m.values.length,d)}for(var v=0;v<l.length;v++){var y,g=void 0,_=void 0;m=l[v];y=f.parse(m.latex,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",0],["tc",v]])})),g=[];for(var b=-1,D=0;D<l[v].values.length;D++)m.values[D].replace(/\\\\space/g,"").match(/\\S/)?(g.push(f.parse(m.values[D],h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",D+1],["tc",v]])}))),b=D):g.push(k(NaN));if(g=g.slice(0,b+1),(_=j(y,d,g)).id=m.id,_.header){if(_.header.userData=m,_.header.metaData={extraDepNodes:[]},m.colorLatex){var P=U(m.colorLatex,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",0],["tc",v],["cl",v]])}));_.header.metaData.colorLatex=P,_.header.metaData.extraDepNodes.push(P)}if(m.pointSize){var O=U(m.pointSize,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",0],["tc",v],["ps",v]])}));_.header.metaData.pointSize=O,_.header.metaData.extraDepNodes.push(O)}if(m.pointOpacity){var E=U(m.pointOpacity,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",0],["tc",v],["po",v]])}));_.header.metaData.pointOpacity=E,_.header.metaData.extraDepNodes.push(E)}if(m.lineWidth){var T=U(m.lineWidth,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",0],["tc",v],["lw",v]])}));_.header.metaData.lineWidth=T,_.header.metaData.extraDepNodes.push(T)}if(m.lineOpacity){var F=U(m.lineOpacity,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["tr",0],["tc",v],["lo",v]])}));_.header.metaData.lineOpacity=F,_.header.metaData.extraDepNodes.push(F)}}p.push(_)}this.statements[s]=W(p);var w=this.statements[s].getAllIds();o.forEach(function(e){-1===w.indexOf(e)&&a._notifyGraphRemoved(e,i)});break;case"image":var R="-\\\\trigAngleMultiplier*("+e.angle+")",M=U(e.center,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["ic",s]])})),A=U(R,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["ia",s]])})),C=U(e.width,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["iw",s]])})),I=U(e.height,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["ih",s]])})),N=U(e.opacity,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["io",s]])}));this.statements[s]=V({center:M,radianAngle:A,width:C,height:I,opacity:N});break;case"ticker":this.statements[s]=t.Ticker({handler:U(e.handlerLatex,h.__assign(h.__assign({},r),{allowDt:!0})),minStep:U(e.minStepLatex||"0",r)});break;default:for(var L in e=e,this.statements[s]=f.parse(e.latex,r),ne){var G=L;if(e[G]){var B=ne[G],q=e[G];B.transform&&(q=B.transform(q));var H=$(q,h.__assign(h.__assign({},r),{seedPrefix:J(s,[[B.seed,s]])}));n[G]=H,n.extraDepNodes.push(H)}}if(e.colorLatex){H=ee(e.colorLatex,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["ac",s]])}));n.colorLatex=H,n.extraDepNodes.push(H)}if(e.polarDomain&&e.polarDomain.min&&(n.polarDomainMin=$(e.polarDomain.min,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lm",s]])})),n.extraDepNodes.push(n.polarDomainMin)),e.polarDomain&&e.polarDomain.max&&(n.polarDomainMax=$(e.polarDomain.max,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lM",s]])})),n.extraDepNodes.push(n.polarDomainMax)),e.parametricDomain&&e.parametricDomain.min&&(n.parametricDomainMin=$(e.parametricDomain.min,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lm",s]])})),n.extraDepNodes.push(n.parametricDomainMin)),e.parametricDomain&&e.parametricDomain.max&&(n.parametricDomainMax=$(e.parametricDomain.max,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lM",s]])})),n.extraDepNodes.push(n.parametricDomainMax)),e.vizProps&&(e.vizProps.axisOffset&&(n.vizAxisOffset=$(e.vizProps.axisOffset,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["vo",s]])})),n.extraDepNodes.push(n.vizAxisOffset)),e.vizProps.breadth&&(n.vizBreadth=$(e.vizProps.breadth,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["vb",s]])})),n.extraDepNodes.push(n.vizBreadth))),e.cdf&&e.cdf.show){var X=S.parseToplevelFunction(e.latex);X&&"distribution"===X.type&&(n.distributionSpec=X,n.cdfMin=ee(e.cdf.min,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lm",s]])})),n.extraDepNodes.push(n.cdfMin),n.cdfMax=ee(e.cdf.max,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lM",s]])})),n.extraDepNodes.push(n.cdfMax))}if(this.statements[s].shouldPromoteToSlider(this.policy)){var Y=e.slider,K=!(!Y||!Y.isPlayingOnce),Q=ee(Y&&Y.softMin,r),Z=ee(Y&&Y.softMax,r),te=ee(Y&&Y.min,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lm",s]])})),ie=ee(Y&&Y.max,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["lM",s]])})),ae=ee(Y&&Y.step,h.__assign(h.__assign({},r),{seedPrefix:J(s,[["ls",s]])}));this.statements[s]=z(this.statements[s],{sliderMin:te,sliderMax:ie,sliderStep:ae,sliderIsPlayingOnce:K,sliderSoftMin:Q,sliderSoftMax:Z})}}var se=e.clickableInfo;se&&se.enabled&&se.latex&&(n.clickHandler=U(se.latex,h.__assign(h.__assign({},r),{allowIndex:!0}))),this.statements[s].userData=e,this.statements[s].metaData=n;var re=e.label;if(re){var oe=this.currentLabel[s];oe&&oe.raw===re||(this.currentLabel[s]=x.parse(re))}else delete this.currentLabel[s]}},e.prototype.removeStatement=function(e,t){var i=this.statements[e];if(i){if(this.markExportsDirty(e),i.isTable){var a=this;i.getAllIds().forEach(function(e){a._notifyGraphRemoved(e,t)})}else this._notifyGraphRemoved(e,t);delete this.currentLabel[e],delete this.statements[e],delete this.analysis[e],delete this.currentStatus[e]}},e.prototype.markExportsDirty=function(e){if(this.statements[e]){this.statements[e].isRegression&&(this.markedRegressionDirty=!0);for(var t=0,i=this.statements[e].getLegalExports(this.policy);t<i.length;t++){var a=i[t];this.dirtyExportedSymbolRoots[a]=!0}}},e.prototype.markAsDirtyRoot=function(e){this.dirtyStatementRoots[e]=!0},e.prototype.getFrame=function(){return this.updateAnalysis(),this.frame},e.prototype.getAnalysis=function(){return this.updateAnalysis(),this.analysis},e.prototype.getEvaluationState=function(e){if(this.updateAnalysis(),this.analysis[e])return this.analysis[e].evaluationState},e.prototype._updateRegressions=function(e){var t=this.frame,i=this.lastFrame,a=this.regressionFrame,s=[];for(var r in e)e.hasOwnProperty(r)&&e[r].isRegression&&s.push(r);var n=this;s.sort(function(e,t){var i=n.statements[e].userData&&n.statements[e].userData.residualVariable,a=n.statements[t].userData&&n.statements[t].userData.residualVariable;return i&&!a?-1:a&&!i?1:0});var o=v.findDependencyOrder(this.policy,e,s);ie(o,a);for(var l={},p=0,d=o.resolved;p<d.length;p++){r=d[p];if(this.statements[r].isRegression)this.analysis[r]=e[r].analyze(this.policy,a,t,i,l),this.analysis[r].exportTo(this.policy,t),delete e[r];else{var c=e[r].tryGetConcreteTree(this.policy,a);e[r].exportTo(this.policy,c,a),l[r]={rawTree:e[r],concreteTree:c}}}},e.prototype.buildSymbolToExpressionDirtyMap=function(){var e={};for(var t in this.statements)if(this.statements.hasOwnProperty(t)){var i=this.statements[t],a=i.metaData;if(ae(e,t,i.getDependencies()),ae(e,t,i.getLegalExports(this.policy)),i.isRegression&&i.userData&&i.userData.residualVariable&&ae(e,t,[O.latexToIdentifier(i.userData.residualVariable)]),se(e,t,a),i.isTable&&i.columns)for(var s=0;s<i.columns.length;s++){var r=i.columns[s];r.header&&r.header.metaData&&se(e,t,r.header.metaData)}}return e},e.prototype.getDirtyIdsAndSymbols=function(e){var t={},i={},a=this.markedRegressionDirty,s=[],r=[];for(var n in this.dirtyStatementRoots)this.dirtyStatementRoots[n]&&(i[n]=!0,s.push(n));for(var o in this.dirtyExportedSymbolRoots)this.dirtyExportedSymbolRoots[o]&&(t[o]=!0,r.push(o));for(;s.length||r.length;){for(;s.length;){n=s.pop();var l=this.statements[n];if(l){l.isRegression&&(a=!0);for(var p=0,d=l.getLegalExports(this.policy);p<d.length;p++){t[o=d[p]]||(t[o]=!0,r.push(o))}}}for(;r.length;){var c=e[o=r.pop()];if(c)for(var u=0,h=c;u<h.length;u++){i[n=h[u]]||(i[n]=!0,s.push(n))}}}return{ids:i,symbols:t,hasDirtyRegression:a}},e.prototype.updateAnalysis=function(){var e=this.buildSymbolToExpressionDirtyMap(),t=this.getDirtyIdsAndSymbols(e),i={};if(t.hasDirtyRegression){for(var a in this.statements)this.statements[a]&&(i[a]=this.statements[a]);this.frame=Object.create(this.parent_frame),this.regressionFrame=Object.create(this.parent_frame)}else{var s=t.ids;for(var a in s)this.statements[a]&&(i[a]=this.statements[a]);var r=t.symbols;for(var n in r)r[n]&&(delete this.frame[n],delete this.regressionFrame[n])}for(var a in i)i[a]&&(this.unpublishedIds[a]=!0);this.markedRegressionDirty=!1,this.dirtyExportedSymbolRoots={},this.dirtyStatementRoots={};var o=this.analysis,l=this.frame;"graphing"===this.evaluationMode&&this._updateRegressions(i);var p=v.findDependencyOrder(this.policy,i);ie(p,l);for(var d=p.resolved,c=0,u=d;c<u.length;c++){a=u[c];switch(this.evaluationMode){case"fourFunction":case"singleExpressionFourFunction":o[a]=this.statements[a].analyzeFourFunction(this.policy,l,o),o[a].exportTo(this.policy,l);break;case"scientific":o[a]=this.statements[a].analyzeScientific(this.policy,l,o),o[a].exportTo(this.policy,l);break;case"singleExpressionScientific":o[a]=this.statements[a].analyzeSingleExpressionScientific(this.policy,l,o),o[a].exportTo(this.policy,l);break;case"graphing":case"graphing_3d":if(l.r){var h=Object.create(l);if(h.r=void 0,o[a]=this.statements[a].analyze(this.policy,h,o),o[a].getGraphMode()===_.POLAR){o[a].exportTo(this.policy,l);continue}}o[a]=this.statements[a].analyze(this.policy,l,o),o[a].exportTo(this.policy,l)}}if("graphing"===this.evaluationMode||"graphing_3d"===this.evaluationMode)for(var f=0,m=d;f<m.length;f++){a=m[f];var y=o[a],g=y.evaluationState.expression_type;for(var x in ne){var D=x,S=ne[D];S.shouldEvaluate&&!S.shouldEvaluate(y)||le(y,this.policy,l,D)}ce(y,this.policy,l),this.actions&&Y(y)&&ue(y,this.policy,l),g===b.ExpressionType.PARAMETRIC||g===b.ExpressionType.POLAR?he(y,this.policy,l):g===b.ExpressionType.BOXPLOT?fe(y,this.policy,l):X(y)&&re(y,this.policy,l)}for(var n in function(e){return e.globalRandomSeed||[]}(e).forEach(function(e){o[e].evaluationState.depends_on_random_seed=!0}),this.lastFrame=Object.create(this.parent_frame),l)l.hasOwnProperty(n)&&(this.lastFrame[n]=l[n])},e.prototype.processEvents=function(e){if(e&&this.actions){for(var i,a=Object.create(this.frame),s={},r=!1,n=!1,o=0,l=e;o<l.length;o++){var p=l[o];switch(this.globalEventCount+=1,a.globalEventCount=t.Constant(this.globalEventCount),p.type){case"step":if(!(d=this.statements[p.expressionId]))continue;n=!0,me(d.tryGetConcreteTree(this.policy,a),s,a);break;case"click":var d;if(!(d=this.statements[p.expressionId])||!d.metaData.clickHandler)continue;a.index=t.Constant(p.indexVar+1),n=!0,r=!0,me(d.metaData.clickHandler.tryGetConcreteTree(this.policy,a),s,a);break;case"clock-tick":(void 0===i||p.isFirstTick&&!i.isFirstTick)&&(i=p);break;default:return p}}if(i)if((d=this.statements[i.id])&&d instanceof t.Ticker){var c=d.minStep.tryGetConcreteTree(this.policy,a).asValue();if("number"==typeof c&&c>=0&&isFinite(c)){var u=this.lastClockTickTime;if(this.lastClockTickTime=Date.now(),!i.isFirstTick&&void 0!==u)a.dt=t.Constant(this.lastClockTickTime-u),me(d.handler.tryGetConcreteTree(this.policy,a),s,a)}}return{objectClicked:r,userAction:n,updates:s}}},e}();e.Context=ve});\ndefine(\'worker/workercore\',[\'require\',\'core/math/context\'],function(require){"use strict";var e=require("core/math/context").Context;return function(n){var t=new e;return{processChangeSet:function(e){var r=t.processChangeSet(e);n("processChangeSet",r)}}}});\ndefine(\'console\',[\'require\'],function(require){var o=function(){},n={};return["log","info","warn","error","assert","dir","clear","profile","profileEnd","time","timeEnd","group","groupCollapsed","groupEnd","trace"].forEach(function(e){"undefined"!=typeof window&&window.console&&window.console[e]?n[e]=function(){Function.prototype.apply.call(window.console[e],window.console,arguments)}:n[e]=o}),n});\ndefine(\'worker/worker\',[\'require\',\'worker/workercore\',\'console\'],function(require){"use strict";var e=require("worker/workercore"),a={};require("console").log=function(e){self.postMessage({log:JSON.stringify(e)})};var s=self;s.window=s,s.onmessage=function(o){var n=o.data&&o.data.connectionId;if(n)if("destroy"===o.data.originalMessage.type)delete a[n];else{var t=a[n];t||(t=e(function(e,a){s.postMessage({connectionId:n,originalMessage:{type:e,payload:a}})}),a[n]=t),t.processChangeSet(o.data.originalMessage)}},s.loadMessageQueue&&(s.loadMessageQueue.forEach(function(e){s.onmessage(e)}),delete s.loadMessageQueue)});\n!function(){"use strict";"undefined"==typeof window&&("undefined"==typeof requirejs&&(importScripts("../vendor/require.js"),importScripts("config.js")),self.loadMessageQueue=[],self.onmessage=function(e){self.loadMessageQueue.push(e)},requirejs(["worker/worker"]))}();\ndefine("toplevel/worker", function(){});\n\n'; });

define('worker_src', ['require', 'text!worker_src_underlying'], function (require) { "use strict"; return require("text!worker_src_underlying") });
define('worker/create_worker_url', ['require', 'worker_src'], function (require) { "use strict"; var e = require("worker_src"); return function () { if (!e.length) return "/assets/generated/combined/toplevel/worker.js"; var r; try { r = new Blob([e], { type: "application/javascript" }) } catch (i) { try { var t = new (window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder); t.append(e), r = t.getBlob("application/javascript") } catch (e) { return null } } return (window.URL || window.webkitURL).createObjectURL(r) } });
define('core/math/finddependencyorder', ["require", "exports", "core/math/builtinframe", "underscore"], function (require, e, r, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.findDependencyOrder = void 0, e.findDependencyOrder = function (e, i, t) { var l = [], o = {}, a = {}, p = {}, f = {}, s = {}, h = {}, u = {}, d = 0, v = [], c = []; if (!t) for (var y in t = [], i) i.hasOwnProperty(y) && t.push(y); for (var y in i) if (i.hasOwnProperty(y)) { for (var g = i[y].exportPenalty || 0; l.length < g + 1;)l.push([]); l[g].push(y) } for (var w = 0, k = l; w < k.length; w++) { for (var x = {}, D = 0, O = k[w]; D < O.length; D++) { y = O[D]; for (var P = i[y], b = (g = i[y].exportPenalty || 0, P.isTable), m = 0, M = P.getLegalExports(e); m < M.length; m++) { var q = M[m]; r[q] || (o[q] || (b && (s[q] = !0), 0 === g && (f[q] = !0), x[q] = x[q] || [], x[q].push(y), x[q].length > 1 && (!a[q] && b && (p[q] = !0), a[q] = !0))) } } for (var q in x) p[q] || (o[q] = x[q]) } for (var E = 0, L = t; E < L.length; E++) { q = L[E]; u.hasOwnProperty(q) || T(q) } function T(r) { u[r] = u[r] || {}; var t, l = u[r]; l.id = r, l.index = d, l.lowlink = d, v.push(l), l.instack = !0, d++; for (var a = 0, p = i[r].getDependencies(); a < p.length; a++) { var f = p[a]; if (o.hasOwnProperty(f)) for (var s = 0, y = o[f]; s < y.length; s++) { var g = y[s]; u.hasOwnProperty(g) ? (t = u[g]).instack && (l.lowlink = Math.min(l.lowlink, t.index)) : (T(g), t = u[g], l.lowlink = Math.min(l.lowlink, t.lowlink)) } } if (l.lowlink === l.index) if ((t = v.pop()).instack = !1, t === l) !function (e) { c.push(e.id) }(l); else { for (var w = [t]; (t = v.pop()).instack = !1, w.push(t), t !== l;); !function (r) { for (var t = [], l = r.length - 1; l >= 0; l--) { var o = r[l], a = i[o.id].getLegalExports(e); Array.prototype.push.apply(t, a), t.push(a[0]), c.push(o.id) } (t = n.unique(t)).sort(); for (var p = 0, f = t; p < f.length; p++) { var s = f[p]; h[s] = t } }(w) } } return { resolved: c, globallyDefined: f, tableDefined: s, multiplyDefined: a, multiplyDefinedByTables: p, cyclicallyDefined: h } } });
define('core/math/findIntersections', ['require', 'core/types/graphmode', './plotter', 'parsenodes', 'core/math/distance'], function (require) { "use strict"; var n = require("core/types/graphmode"), t = require("./plotter").default, e = require("parsenodes"), r = require("core/math/distance"); function i(n) { for (var t = [], e = 0; e < n; e++)t[e] = { x: [], y: [], intersects: [] }; return t } function o(t, e, r, i) { return r === n.X && i === n.X || r === n.Y && i === n.Y ? function (n) { return e(n) - t(n) } : (r === n.X && i === n.Y || r === n.Y && i === n.X) && function (n) { return n - e(t(n)) } } function s(n, t) { t instanceof e.SolvedEquation ? t = t._expression : t instanceof e.OptimizedRegression && (t = t.model); var r = [], i = []; return t instanceof e.DoubleInequality ? e.List.eachArgs(t._expressions, function (n) { r.push(n[0].getCompiledFunction()), i.push(n[0].isConstant && n[1].isNaN()), r.push(n[1].getCompiledFunction()), i.push(n[1].isConstant && n[1].isNaN()) }) : e.List.wrap(t).eachElement(function (n) { r.push(n.getCompiledFunction()), i.push(n.isConstant && n.isNaN()) }), { functions: r, skipIntersecting: i } } function p(n, t) { n.intersects = Array(n.x.length); for (var e = 0; e < n.x.length; e++)n.intersects[e] = t } function u(t, e) { if (e === n.X) { var r = t.y; t.y = t.x, t.x = r } } function c(n, t) { Array.prototype.push.apply(n.x, t.x), Array.prototype.push.apply(n.y, t.y), Array.prototype.push.apply(n.intersects, t.intersects) } function a(n, e, i) { var o = t.sampleXY(n, e), s = o.poi.zeros, p = o.poi.extrema, u = [], c = 0, a = 0; for (c = 0; c < s.x.length; c++) { for (; a < p.x.length && p.x[a] < s.x[c]; a++)r.approx(p.y[a], 0) && u.push(p.x[a]); u.push(s.x[c]) } for (; a < p.x.length; a++)r.approx(p.y[a], 0) && u.push(p.x[a]); return { x: u, y: u.map(i) } } return { findIntersections: function (n, e, r) { var f, h, g, l = n[r], y = l.getGraphInfo(), x = l.getGraphMode(); try { h = i((f = s(l.policy, l.concreteTree)).functions.length), g = function (n, t) { var e = []; for (var r in n) if (n.hasOwnProperty(r) && String(r) !== String(t) && n[r].shouldIntersect()) { var i = n[r], o = s(i.policy, i.concreteTree); e.push({ id: r, graphMode: i.getGraphMode(), functions: o.functions, skipIntersecting: o.skipIntersecting }) } return e }(n, r) } catch (n) { return i(0) } if (!g) return h; for (var d = 0, v = 0; v < g.length; v++)for (var m = g[v], I = 0; I < f.functions.length; I++)if (!f.skipIntersecting[I]) for (var C = f.functions[I].fn, N = t.computeDomain(e, y, C), X = 0; X < m.functions.length; X++)if (!g[v].skipIntersecting[X]) { var k = o(C, m.functions[X].fn, x, m.graphMode); if (k) { var A = a(k, N, C); if ((d += A.x.length) > 100) return i(f.functions.length); p(A, m.id), u(A, x), c(h[I], A) } } return h }, findIndicatorZeros: a } });
define('core/math/policyFourFunction', ["require", "exports"], function (require, n) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.PolicySingleExpressionFourFunction = n.PolicyFourFunction = void 0; var e = function () { function n(n) { this.singleExpression = n.singleExpression } return n.prototype.assignmentForbidden = function (n) { return "ans" !== n.slice(0, 3) }, n.prototype.isValidSlider = function (n) { return !1 }, n.prototype.sliderVariables = function () { return [] }, n.prototype.graphingEnabled = function () { return !1 }, n.prototype.ansEnabled = function () { return !this.singleExpression }, n.prototype.dimensionVarsEnabled = function () { return !1 }, n.prototype.disabledFeatures = function () { return ["Sum", "Product", "Integral", "List", "Derivative", "Piecewise", "Exponent", "PercentOf"] }, n }(); n.PolicyFourFunction = new e({ singleExpression: !1 }), n.PolicySingleExpressionFourFunction = new e({ singleExpression: !0 }) });
define('core/math/policyScientific', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.PolicySingleExpressionScientific = e.PolicyScientific = void 0; var i = function () { function e(e) { this.singleExpression = e.singleExpression } return e.prototype.assignmentForbidden = function (e) { return this.singleExpression ? "ans" !== e.slice(0, 3) : "tmp" === e.slice(0, 3) }, e.prototype.isValidSlider = function (e) { return !1 }, e.prototype.sliderVariables = function () { return [] }, e.prototype.graphingEnabled = function () { return !1 }, e.prototype.ansEnabled = function () { return !this.singleExpression }, e.prototype.dimensionVarsEnabled = function () { return !1 }, e.prototype.disabledFeatures = function () { return this.singleExpression ? ["Sum", "Product", "Integral", "Derivative", "Piecewise", "PercentOf"] : ["Sum", "Product", "Integral", "Derivative", "Piecewise"] }, e }(); e.PolicyScientific = new i({ singleExpression: !1 }), e.PolicySingleExpressionScientific = new i({ singleExpression: !0 }) });
define('core/math/frameFourFunction', ['require', 'core/math/builtinframe'], function (require) { "use strict"; var t = require("core/math/builtinframe"); return { getFrame: function (i) { var n = {}; return i.additionalFunctions && -1 !== i.additionalFunctions.indexOf("sqrt") && (n.sqrt = t.sqrt), i.width && (n.width = i.width), i.height && (n.height = i.height), n } } });
define('core/math/frameScientific', ['require', 'core/math/builtinframe'], function (require) { "use strict"; var r = require("core/math/builtinframe"), t = ["pi", "e", "trigAngleMultiplier"], n = ["sqrt", "nthroot", "abs", "ln", "sin", "cos", "tan", "log", "arcsin", "arccos", "arctan", "mean", "round", "stdev", "stdevp", "nCr", "nPr", "exp", "factorial"]; function e(r, t) { for (var n = 0; n < r.length; n++) { var e = r[n]; if (!t.hasOwnProperty(e)) throw new Error("Programming Error: key '" + e + "' does not exist in table. Must be one of:\n" + Object.keys(t).join("\n")) } } return e(t, r), e(n, r), { getFrame: function (e) { var i = {}; return t.forEach(function (t) { i[t] = r[t] }), n.forEach(function (t) { e.replaceRoundWithReciprocal && "round" === t || (i[t] = r[t]) }), e.trigAngleMultiplier && (i.trigAngleMultiplier = e.trigAngleMultiplier), e.width && (i.width = e.width), e.height && (i.height = e.height), i } } });
define('core/math/frameSingleExpressionScientific', ['require', 'core/math/builtinframe'], function (require) { "use strict"; var r = require("core/math/builtinframe"), t = ["pi", "e", "trigAngleMultiplier"], i = ["sqrt", "nthroot", "abs", "ln", "sin", "cos", "tan", "log", "arcsin", "arccos", "arctan", "exp", "factorial"]; function n(r, t) { for (var i = 0; i < r.length; i++) { var n = r[i]; if (!t.hasOwnProperty(n)) throw new Error("Programming Error: key '" + n + "' does not exist in table. Must be one of:\n" + Object.keys(t).join("\n")) } } return n(t, r), n(i, r), { getFrame: function (n) { var e = {}; return t.forEach(function (t) { e[t] = r[t] }), i.forEach(function (t) { e[t] = r[t] }), n.trigAngleMultiplier && (e.trigAngleMultiplier = n.trigAngleMultiplier), n.width && (e.width = n.width), n.height && (e.height = n.height), e } } });
define('core/math/frameGraphing', ['require', 'core/math/builtinframe'], function (require) { "use strict"; var t = require("core/math/builtinframe"), i = ["csc", "sec", "cot", "arccsc", "arcsec", "arccot", "csch", "sech", "coth", "arccsch", "arcsech", "arccoth", "mad", "cov", "distance", "midpoint"], e = ["erf", "ttest", "tscore", "ittest", "normaldist", "tdist", "poissondist", "binomialdist", "pdf", "cdf", "random", "histogram", "dotplot", "boxplot"], n = ["distance", "midpoint"], o = ["det", "inv", "transpose", "rref", "trace"]; function r(t, i) { for (var e = 0; e < t.length; e++) { var n = t[e]; if (!i.hasOwnProperty(n)) throw new Error("Programming Error: key '" + n + "' does not exist in table. Must be one of:\n" + Object.keys(i).join("\n")) } } return r(i, t), r(e, t), { getFrame: function (r) { var a, c = {}; for (a in t) t.hasOwnProperty(a) && (!0 !== r.restrictedFunctions || -1 === i.indexOf(a) || !0 === r.forceEnableGeometryFunctions && -1 !== n.indexOf(a)) && (!1 === r.distributions && -1 !== e.indexOf(a) || -1 === o.indexOf(a) && (c[a] = t[a])); return r.trigAngleMultiplier && (c.trigAngleMultiplier = r.trigAngleMultiplier), r.globalRandomSeed && (c.globalRandomSeed = r.globalRandomSeed), r.initialEvaluation && (c.initialEvaluation = r.initialEvaluation), r.globalEventCount && (c.globalEventCount = r.globalEventCount), r.width && (c.width = r.width), r.height && (c.height = r.height), c } } });
define('core/math/getCLSymbolMap', ["require", "exports", "underscore", "core/lib/label"], function (require, e, t, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.getCLSymbolMap = void 0, e.getCLSymbolMap = function () { var e = {}, a = {}, s = {}, i = []; for (var n in this.statements) { if (this.statements.hasOwnProperty(n)) switch ((u = this.statements[n]).type) { case "Error": break; case "Regression": s[n] = [], i.push(n); break; default: var o = u.getLegalExports(this.policy); if (o) { for (var p = 0, l = o; p < l.length; p++) { var c = l[p]; u.exportPenalty > 0 ? a[c] = n : e[c] = n } s[n] = t.difference(u.getDependencies(), u.getDummyDependencies(), o) } } } for (var d = 0, f = i; d < f.length; d++) { n = f[d]; var u = this.statements[n], h = r.latexToIdentifier(u.userData.residualVariable); h && (a[h] = n); var v = u.getDependencies().slice(), g = {}; for (c = void 0; c = v.pop();)if (!g[c]) { g[c] = !0; var y = e[c] || a[c]; y ? (v.push.apply(v, s[y]), s[n].push(c)) : a[c] = n } } return { exportMap: e, weakExportMap: a, dependencyMap: s } } });
define('core/math/context', ["require", "exports", "parsenodes", "./finddependencyorder", "./workerconfig", "./findIntersections", "core/vendor/d3-color", "./policyFourFunction", "./policyScientific", "./policyGraphing", "./frameFourFunction", "./frameScientific", "./frameSingleExpressionScientific", "./frameGraphing", "tslib", "core/math/parser", "core/math/errormsg", "core/math/finddependencyorder", "underscore", "./plotter", "core/types/graphmode", "./interpolatedlabel", "./expression-types", "./getCLSymbolMap", "./distribution-spec", "./maybe-rational", "core/lib/label", "./functions", "core/types/line-width", "core/types/point-opacity", "core/types/point-size", "./evaluationstate", "core/math/types", "./cache-stats", "./parsenode-from-value", "./ir/features/action-to-latex"], function (require, e, t, i, a, s, r, n, o, l, p, d, c, u, h, f, m, v, y, g, _, x, b, D, S, P, O, E, T, F, w, R, M, A, C, I) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Context = void 0; var N = "undefined" != typeof performance ? function () { return performance.now() } : function () { return Date.now() }, k = t.Constant, L = t.Seed, G = t.FunctionCall, V = t.Image, z = t.Slider, W = t.Table, j = t.TableColumn, B = s.findIntersections, q = { fourFunction: n.PolicyFourFunction, scientific: o.PolicyScientific, singleExpressionScientific: o.PolicySingleExpressionScientific, singleExpressionFourFunction: n.PolicySingleExpressionFourFunction, graphing: l.PolicyGraphing, graphing_3d: l.PolicyGraphing3D }, H = { fourFunction: p, singleExpressionFourFunction: p, scientific: d, singleExpressionScientific: c, graphing: u, graphing_3d: u }; function U(e, i) { var a = f.parse(e, i); return a.isError || a instanceof t.Expression ? a : m.parseError() } function X(e) { var t = e.rawTree.userData, i = e.rawTree.metaData; return !!(t.cdf && t.cdf.show && i.distributionSpec) } function Y(e) { var t = e.evaluationState.expression_type, i = e.rawTree.userData; return !(!i.clickableInfo || !i.clickableInfo.enabled) && (!!e.rawTree.isImage || e.getGraphMode() !== _.XYPOINT_MOVABLE && b.isClickableExpressionType(t)) } function J(e, t) { for (var i = "id" + e, a = 0, s = t || []; a < s.length; a++) { var r = s[a]; i += "::" + r[0] + r[1] } return i } var K = k(P.maybeRational(0, 1)), Q = k(P.maybeRational(1, 1)), Z = k(NaN); function $(e, t) { return e ? "0" === e ? K : "1" === e ? Q : U(e, t) : Z } function ee(e, t) { if (e) return U(e, t) } function te(e) { return "ans" !== e.slice(0, 3) } function ie(e, t) { var i = e.multiplyDefined, a = e.multiplyDefinedByTables, s = e.cyclicallyDefined; for (var r in i) i.hasOwnProperty(r) && (t[r] = a[r] ? m.multiplyDefinedByTables(r) : m.multiplyDefined(r)); for (var r in s) if (s.hasOwnProperty(r)) { var n = e.tableDefined[r] && !e.globallyDefined[r], o = s[r].filter(te); t[r] = n ? m.tableCycleWithoutGlobalDefinition(o) : m.cycle(o) } } function ae(e, t, i) { for (var a = 0, s = i; a < s.length; a++) { var r = s[a]; e[r] || (e[r] = []), e[r].push(t) } } function se(e, t, i) { if (i.extraDepNodes) for (var a = 0, s = i.extraDepNodes; a < s.length; a++) { var r = s[a]; r && ae(e, t, r.getDependencies()) } i.clickHandler && ae(e, t, i.clickHandler.getDependencies()) } function re(e, t, i) { var a = e.evaluationState, s = e.rawTree, r = s.metaData.cdfMin, n = s.metaData.cdfMax, o = {}, l = NaN, p = NaN, d = "Assignment" === s.type ? s._expression : s, c = d && d.metaData && d.metaData.distributionSpec; if (r) { var u = r.tryGetConcreteTree(t, i); u.isConstant && (l = +u.asValue()); for (var h = 0, f = u.getDependencies(); h < f.length; h++) { o[f[h]] = !0 } } else l = -1 / 0; if (n) { var v = n.tryGetConcreteTree(t, i); v.isConstant && (p = +v.asValue()); for (var y = 0, g = v.getDependencies(); y < g.length; y++) { o[g[y]] = !0 } } else p = 1 / 0; var _ = !0, x = !0; if (isNaN(l) && (_ = !1, l = NaN), isNaN(p) && (x = !1, p = NaN), _ ? x ? l > p && (_ = !1, x = !1, a.error = m.cdfMaxLessThanMin().getError()) : a.error = m.cdfMaxInvalid().getError() : a.error = m.cdfMinInvalid().getError(), _ && x) { var b = G("cdf", [d, k(l), k(p)]); a.cdf_evaluation = +b.tryGetConcreteTree(t, i).asValue() } var D = -1 / 0, S = 1 / 0; if (c && (c.discrete && (D = 0), "binomialdist" === c.symbol && d.args && d.args[0])) { var P = +d.args[0].asValue(); isFinite(P) && (S = P) } s.metaData.evaluatedCDFMin = l, s.metaData.evaluatedCDFMax = p, a.cdf_min_valid = _, a.cdf_max_valid = x, a.cdf_min_default = D, a.cdf_max_default = S, a.is_single_identifier = !1, R.addSliderPrompts(a, t, o) } var ne = { lineWidth: { parseNode: "lineWidth", valueOutputProp: "computedLineWidth", formulaOutputProp: "", validOutputProp: "line_width_valid", default: function () { return T.DEFAULT }, transform: void 0, shouldEvaluate: void 0, seed: "lw" }, lineOpacity: { parseNode: "lineOpacity", valueOutputProp: "computedLineOpacity", formulaOutputProp: "", validOutputProp: "line_opacity_valid", default: void 0, transform: void 0, shouldEvaluate: void 0, seed: "lo" }, pointOpacity: { parseNode: "pointOpacity", valueOutputProp: "computedPointOpacity", formulaOutputProp: "", validOutputProp: "point_opacity_valid", default: function (e, t, i) { return e && t && e.getGraphMode(i, t) === _.XYPOINT_MOVABLE ? 1 : F.DEFAULT }, transform: void 0, shouldEvaluate: void 0, seed: "po" }, pointSize: { parseNode: "pointSize", valueOutputProp: "computedPointSize", formulaOutputProp: "", validOutputProp: "point_size_valid", default: function () { return w.DEFAULT }, shouldEvaluate: void 0, transform: void 0, seed: "ps" }, fillOpacity: { parseNode: "fillOpacity", valueOutputProp: "computedFillOpacity", formulaOutputProp: "", validOutputProp: "fill_opacity_valid", default: void 0, transform: void 0, shouldEvaluate: function (e) { if (!e) return !1; var t = e.evaluationState, i = t.expression_type, a = t.is_inequality; return !(i !== b.ExpressionType.POLYGON && i !== b.ExpressionType.PARAMETRIC && !a) }, seed: "fo" }, labelSize: { parseNode: "labelSize", valueOutputProp: "computedLabelSize", formulaOutputProp: "", validOutputProp: "label_size_valid", transform: void 0, default: function () { return 1 }, shouldEvaluate: void 0, seed: "ls" }, labelAngle: { parseNode: "labelAngle", valueOutputProp: "computedLabelAngle", formulaOutputProp: "label_angle_value", validOutputProp: "label_angle_valid", default: function () { return 0 }, transform: function (e) { return "-\\trigAngleMultiplier*(" + e + ")" }, shouldEvaluate: void 0, seed: "la" } }; function oe(e, t, i, a, s, r) { var n, o = ne[r]; e && (n = e.tryGetConcreteTree(a, s)); var l = o.default && o.default(e, n, a), p = function (e, t, i, a) { var s, r = {}, n = !0, o = NaN, l = !1; if (i) { var p = i.tryGetConcreteTree(e, t); s = 0 === p.getDependencies().length ? p.asValue() : NaN, o = (l = Array.isArray(s)) ? s : +s; for (var d = 0, c = p.getDependencies(); d < c.length; d++)r[c[d]] = !0 } if (l) for (var u = 0, h = o; u < h.length; u++) { var f = h[u]; if (!isFinite(+f)) { n = !1, o = NaN; break } } else isFinite(+o) || (n = !1, o = NaN); return i || (n = !0, void 0 !== a && (o = a)), { value: o, valid: n, missingVarsMap: r } }(a, s, i[o.parseNode], l); i[o.valueOutputProp] = p.value, o.formulaOutputProp && (t[o.formulaOutputProp] = p.value), t[o.validOutputProp] = p.valid, R.addSliderPrompts(t, a, p.missingVarsMap) } function le(e, t, i, a) { var s, r; if (e.rawTree.isTable && e.evaluationState.column_data && e.rawTree.columns) for (var n = 0; n < e.evaluationState.column_data.length; n++)s = e.evaluationState.column_data[n], oe((r = e.rawTree.columns[n].header.metaData)[a], s, r, t, i, a); else s = e.evaluationState, oe((r = e.rawTree.metaData)[a], s, r, t, i, a) } function pe(e) { return r.rgb(e[0], e[1], e[2]).formatHex() } function de(e, t, i, a, s) { var r; if (e) { var n = e.tryGetConcreteTree(a, s), o = n.getDependencies().length > 0 ? void 0 : n.asValue(), l = n.valueType; if (r = !(!o || l !== M.RGBColor && l !== M.ListOfColor)) { var p = n && n.valueType === M.RGBColor ? pe(o) : o.map(pe); t.colorLatexValue = p, i.color_latex_value = p } } else r = !0; i.color_latex_valid = r } function ce(e, t, i) { var a, s; if (e.rawTree.isTable && e.evaluationState.column_data && e.rawTree.columns) for (var r = 0; r < e.evaluationState.column_data.length; r++)a = e.evaluationState.column_data[r], de((s = e.rawTree.columns[r].header.metaData).colorLatex, s, a, t, i); else a = e.evaluationState, de((s = e.rawTree.metaData).colorLatex, s, a, t, i) } function ue(e, t, i) { var a = e.evaluationState, s = {}, r = e.rawTree.metaData.clickHandler; if (r) { var n = r.tryGetConcreteTree(t, i); n.isError || n.valueType === M.Action || (n = m.eventHandlerTypeError(M.prettyPrint(n.valueType))); for (var o = 0, l = n.getDependencies(); o < l.length; o++) { var p = l[o]; t.validActionVariable(p) || (s[p] = !0) } var d = Object.keys(s); d.length > 0 && (n = m.tooManyVariables(d).setDependencies(n.getDependencies())), n.isError && !R.isErrorExportableActionDefinition(t, n) ? a.click_handler = { status: "error", error: n.getError() } : n.isEmptyAction ? a.click_handler = { status: "empty" } : a.click_handler = { status: "maybe-valid" }, R.addSliderPrompts(a, t, s) } } function he(e, t, i) { var a = e.evaluationState, s = e.rawTree, r = a.expression_type === b.ExpressionType.POLAR ? s.metaData.polarDomainMin : s.metaData.parametricDomainMin, n = a.expression_type === b.ExpressionType.POLAR ? s.metaData.polarDomainMax : s.metaData.parametricDomainMax, o = {}, l = NaN, p = NaN, d = !1; if (r) { d = !0; var c = r.tryGetConcreteTree(t, i); c.isConstant && (l = +c.asValue()); for (var u = 0, h = c.getDependencies(); u < h.length; u++) { o[h[u]] = !0 } } else l = 0; if (n) { d = !0; var f = n.tryGetConcreteTree(t, i); f.isConstant && (p = +f.asValue()); for (var v = 0, y = f.getDependencies(); v < y.length; v++) { o[y[v]] = !0 } } else a.expression_type === b.ExpressionType.PARAMETRIC ? p = 1 : a.expression_type === b.ExpressionType.POLAR && (p = 12 * Math.PI / +i.trigAngleMultiplier.asValue()); var g = !0, _ = !0; isFinite(l) || (g = !1, l = NaN), isFinite(p) || (_ = !1, p = NaN), g ? _ ? l > p && (g = !1, _ = !1, a.error = m.domainMaxLessThanMin().getError()) : a.error = m.domainMaxInvalid().getError() : a.error = m.domainMinInvalid().getError(), s.metaData.evaluatedDomainMin = l, s.metaData.evaluatedDomainMax = p, a.expression_type === b.ExpressionType.POLAR && (s.metaData.isExplicitDomain = d), a.domain_min_number = l, a.domain_max_number = p, a.domain_min_valid = g, a.domain_max_valid = _, a.expression_type === b.ExpressionType.PARAMETRIC && (delete o.t, R.addSliderPrompts(a, t, o)) } function fe(e, t, i) { var a = e.evaluationState, s = e.rawTree, r = s.metaData.vizAxisOffset, n = s.metaData.vizBreadth, o = {}, l = NaN, p = NaN; if (r) { var d = r.tryGetConcreteTree(t, i); d.isConstant && (l = +d.asValue()); for (var c = 0, u = d.getDependencies(); c < u.length; c++) { o[u[c]] = !0 } } else l = 1; if (n) { var h = n.tryGetConcreteTree(t, i); h.isConstant && (p = +h.asValue()); for (var f = 0, v = h.getDependencies(); f < v.length; f++) { o[v[f]] = !0 } } else p = 1; var y = !0, g = !0; isFinite(l) || (y = !1, l = NaN), isFinite(p) || (g = !1, p = NaN), y ? g || (a.error = m.boxplotBreadthInvalid().getError()) : a.error = m.boxplotOffsetInvalid().getError(), s.metaData.evaluatedAxisOffset = l, s.metaData.evaluatedBreadth = p, a.viz_values = { axisOffset: l, breadth: p }, a.viz_valids = { axisOffset: y, breadth: g }, R.addSliderPrompts(a, t, o) } function me(e, i, a) { if (!e.isError && !e.getDependencies().length && e.valueType === M.Action) { var s = e.asValue(); if (s) for (var r in s.updateRules) { i[r] = I.actionLatexForSymbol(s, r); var n = s.updateRules[r], o = n.value, l = n.valueType; a[r] = t.Assignment(r, C.parseNodeFromValue(l, o)) } } } var ve = function () { function e() { this.getCLSymbolMap = D.getCLSymbolMap, this.statements = {}, this.analysis = {}, this.currentStatus = {}, this.currentLabel = {}, this.unpublishedIds = {}, this.dimensions = { width: 0, height: 0 }, this.intersectId = void 0, this.dirtyExportedSymbolRoots = {}, this.dirtyStatementRoots = {}, this.markedRegressionDirty = !1, this.use_degrees = !1, this.initialEvaluation = !1, this.globalEventCount = 0, this.actions = !0, this.setEvaluationMode("graphing"), this.setRestrictedFunctions(!1), this.setForceEnableGeometryFunctions(!1), this.setFunctionDefinition(!0), this.setReplaceRoundWithReciprocal(!1), this.setDistributions(!0), this.invalidate() } return e.prototype.invalidate = function () { for (var e in this.statements) this.statements.hasOwnProperty(e) && this.markAsDirtyRoot(e); this.currentStatus = {}, this.analysis = {}, this.parent_frame = H[this.evaluationMode].getFrame({ restrictedFunctions: this.restrictedFunctions, forceEnableGeometryFunctions: this.forceEnableGeometryFunctions, replaceRoundWithReciprocal: this.replaceRoundWithReciprocal, distributions: this.distributions, additionalFunctions: this.additionalFunctions, trigAngleMultiplier: k(this.use_degrees ? Math.PI / 180 : P.maybeRational(1, 1)), initialEvaluation: k(this.initialEvaluation ? 1 : 0), globalEventCount: k(0), globalRandomSeed: L(this.globalRandomSeedString || ""), width: q[this.evaluationMode].dimensionVarsEnabled() ? k(P.maybeRational(this.dimensions.width, 1)) : m.variableUnsupported("width"), height: q[this.evaluationMode].dimensionVarsEnabled() ? k(P.maybeRational(this.dimensions.height, 1)) : m.variableUnsupported("height") }), this.frame = Object.create(this.parent_frame), this.lastFrame = Object.create(this.parent_frame), this.regressionFrame = Object.create(this.parent_frame), this.lastClockTickTime = void 0 }, e.prototype.processChangeSet = function (e) { var t = N(), i = { cacheWrites: 0, cacheReads: 0, cacheHits: 0, cacheMisses: 0 }; A.setCacheStatStore(i); var a = { intersections: {}, graphs: {} }; e.isCompleteState && (this.invalidate(), this.statements = {}, this.currentLabel = {}); var s = !!e.isCompleteState && !e.isUndoRedoState; s !== this.initialEvaluation && (this.initialEvaluation = s, this.invalidate()), e.viewState && this.setViewState(e.viewState), e.hasOwnProperty("degreeMode") && this.setDegreeMode(e.degreeMode), e.hasOwnProperty("globalRandomSeed") && this.setGlobalRandomSeed(e.globalRandomSeed), e.hasOwnProperty("evaluationMode") && this.setEvaluationMode(e.evaluationMode), e.hasOwnProperty("additionalFunctions") && this.setAdditionalFunctions(e.additionalFunctions), e.hasOwnProperty("restrictedFunctions") && this.setRestrictedFunctions(e.restrictedFunctions), e.hasOwnProperty("forceEnableGeometryFunctions") && this.setForceEnableGeometryFunctions(e.forceEnableGeometryFunctions), e.hasOwnProperty("distributions") && this.setDistributions(e.distributions), e.hasOwnProperty("functionDefinition") && this.setFunctionDefinition(e.functionDefinition), e.hasOwnProperty("replaceRoundWithReciprocal") && this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal), e.hasOwnProperty("pointsOfInterest") && this.setWorkerConfigProperty("pointsOfInterest", e.pointsOfInterest), e.hasOwnProperty("plotSingleVariableImplicitEquations") && this.setWorkerConfigProperty("plotSingleVariableImplicitEquations", e.plotSingleVariableImplicitEquations), e.hasOwnProperty("plotImplicits") && this.setWorkerConfigProperty("plotImplicits", e.plotImplicits), e.hasOwnProperty("plotInequalities") && this.setWorkerConfigProperty("plotInequalities", e.plotInequalities), e.hasOwnProperty("sliders") && this.setWorkerConfigProperty("sliders", e.sliders), e.hasOwnProperty("actions") && this.setActions(!!e.actions), e.hasOwnProperty("intersectId") && (this.intersectId = e.intersectId), e.hasOwnProperty("dimensions") && this.setDimensions(e.dimensions); var r = N(); this.processStatements(e, a); var n = N(); i.processStatements = n - r, r = n, this.updateAnalysis(), n = N(), i.updateAnalysis = n - r, r = n, e.hasOwnProperty("intersectId") && this._updateIntersections(e.intersectId, a), n = N(), i.updateIntersections = n - r, r = n; var o = this._publishAllStatuses(); n = N(), i.publishAllStatuses = n - r, r = n, this._computeAllLabels(), n = N(), i.computeAllLabels = n - r, r = n, this._computeAriaDescriptions(), n = N(), i.computeAriaDescriptions = n - r, r = n, this._graphAllChanged(a), n = N(), i.graphAllChanges = n - r; var l = this.processEvents(e.events); return this.unpublishedIds = {}, i.timeInWorker = n - t, { syncId: e.syncId, isCompleteState: e.isCompleteState, intersectionChanges: a.intersections, statusChanges: o, graphChanges: a.graphs, timingData: i, eventUpdates: l } }, e.prototype.processStatements = function (e, t) { if (e.removes) for (var i in e.removes) { var a = void 0; if (!e.isCompleteState && this.statements.hasOwnProperty(i) && (a = this.statements[i].getAllIds()), this.removeStatement(i, t), !e.isCompleteState && a) for (var s = 0, r = a; s < r.length; s++) { var n = r[s]; t.graphs[n] = void 0 } } if (e.statements) for (var i in e.statements) { var o = e.statements[i]; null === o || this.addStatement(o, t) } }, e.prototype.setViewState = function (e) { if (!y.isEqual(e, this.viewState)) for (var t in this.viewState = e, this.statements) this.statements.hasOwnProperty(t) && (this.unpublishedIds[t] = !0) }, e.prototype.getViewState = function () { if (this.viewState) { var e = Object.create(this.viewState); return this.parent_frame && this.parent_frame.trigAngleMultiplier ? e.trigAngleMultiplier = this.parent_frame.trigAngleMultiplier.asValue() : e.trigAngleMultiplier = 1, e } }, e.prototype.setDegreeMode = function (e) { this.use_degrees = e, this.invalidate() }, e.prototype.setDimensions = function (e) { void 0 !== e && (this.dimensions = e, this.invalidate()) }, e.prototype.setGlobalRandomSeed = function (e) { this.globalRandomSeedString = e, this.parent_frame.globalRandomSeed = L(e), this.dirtyExportedSymbolRoots.globalRandomSeed = !0 }, e.prototype.setEvaluationMode = function (e) { this.evaluationMode = e, this.policy = q[e], this.invalidate() }, e.prototype.setAdditionalFunctions = function (e) { this.additionalFunctions = e, this.invalidate() }, e.prototype.setRestrictedFunctions = function (e) { this.restrictedFunctions = e, this.invalidate() }, e.prototype.setForceEnableGeometryFunctions = function (e) { this.forceEnableGeometryFunctions = e, this.invalidate() }, e.prototype.setDistributions = function (e) { this.distributions = e, this.invalidate() }, e.prototype.setFunctionDefinition = function (e) { this.functionDefinition = e, this.invalidate() }, e.prototype.setReplaceRoundWithReciprocal = function (e) { this.replaceRoundWithReciprocal = e, this.invalidate() }, e.prototype.setActions = function (e) { e !== this.actions && (this.actions = e, this.invalidate()) }, e.prototype.setWorkerConfigProperty = function (e, t) { t !== a[e] && (a[e] = t, this.invalidate()) }, e.prototype._publishAllStatuses = function () { var e = {}, t = this.currentStatus; for (var i in this.currentStatus = {}, this.unpublishedIds) if (this.analysis.hasOwnProperty(i)) { var a = this.analysis[i].evaluationState; y.isEqual(a, t[i]) || (e[i] = a), this.currentStatus[i] = a } return e }, e.prototype._computeAllLabels = function () { for (var e in this.currentLabel) { var t = this.statements[e]; if (t) { var i = t.tryGetConcreteTree(this.policy, this.frame), a = 1; i.valueType === M.ListOfPoint && (a = i.length); for (var s = [], r = 0; r < a; r++)s.push(x.interpolate(this.currentLabel[e], this.frame, r)); y.isEqual(s, t.computedLabels) || (t.computedLabels = s, this.unpublishedIds[e] = !0) } } }, e.prototype._computeAriaDescriptions = function () { for (var e in this.analysis) { var t = this.analysis[e], i = t.evaluationState, a = t.rawTree.userData; if (a.description && "" !== a.description) { i.computed_description = []; var s = 1; t.concreteTree.isList ? s = t.concreteTree.length : i.dimensions && i.dimensions.x && Array.isArray(i.dimensions.x) && (s = i.dimensions.x.length); for (var r = 0; r < s; r++)i.computed_description.push(x.interpolate(x.parse(a.description), this.frame, r)) } } }, e.prototype._graphAllChanged = function (e) { var t = this.getViewState(), i = !1; if (g.default.validateViewState(t)) { for (var a in this.unpublishedIds) if (this.analysis.hasOwnProperty(a)) { var s = this.analysis[a], r = s.evaluationState.expression_type, n = r === b.ExpressionType.SINGLE_POINT || r === b.ExpressionType.POINT_LIST; if (s.rawTree.isTable) for (var o = s.graph(t), l = 0, p = s.rawTree.getAllIds(); l < p.length; l++) { var d = p[l]; o[d] ? this._notifyGraphComputed(d, o[d], e) : this._notifyGraphRemoved(d, e) } else s.evaluationState.is_graphable && (s.rawTree.userData.shouldGraph || s.rawTree.userData.showLabel && n) ? (this._notifyGraphComputed(a, s.graph(t), e), this.intersectId === a && (i = !0)) : this._notifyGraphRemoved(a, e) } y.keys(this.unpublishedIds).length && void 0 !== this.intersectId && (this.unpublishedIds.hasOwnProperty(this.intersectId) || (i = !0)), i && this._updateIntersections(this.intersectId, e) } }, e.prototype._notifyGraphRemoved = function (e, t) { t.graphs[e] = void 0 }, e.prototype._notifyGraphComputed = function (e, t, i) { E.dehydrateGraphData(t), i.graphs[e] = t }, e.prototype._updateIntersections = function (e, t) { if (this.viewState) if (this.analysis[e] && this.analysis[e].shouldIntersect()) { var i = B(this.analysis, this.viewState, e); t.intersections[e] = i } else t.intersections[e] = [] }, e.prototype.getDisabledFeatures = function () { var e = this.policy.disabledFeatures(); !1 === this.functionDefinition && (e = e.concat("FunctionDefinition")), !1 === this.actions && (e = e.concat("UpdateRule")); var t = this.additionalFunctions || []; return e = e.filter(function (e) { return ("Exponent" !== e || -1 === t.indexOf("exponent")) && ("PercentOf" !== e || -1 === t.indexOf("percent")) }) }, e.prototype.areFractionsDisallowed = function () { var e = this.evaluationMode; return ("fourFunction" === e || "singleExpressionFourFunction" === e) && (!this.additionalFunctions || -1 === this.additionalFunctions.indexOf("fraction")) }, e.prototype.addStatement = function (e, i) { var a = this; if (e) { var s = e.id; this.markExportsDirty(s), this.markAsDirtyRoot(s); var r = { index: this.policy.ansEnabled() ? e.index : void 0, disabledFeatures: this.getDisabledFeatures(), disallowFrac: this.areFractionsDisallowed(), seedPrefix: J(s) }, n = { extraDepNodes: [] }; switch (e.type) { case "table": var o = []; this.statements.hasOwnProperty(s) && (o = this.statements[s].getAllIds()), e.shouldGraph = !0; for (var l = e.columns, p = [], d = 0, c = 0, u = l; c < u.length; c++) { var m = u[c]; d = Math.max(m.values.length, d) } for (var v = 0; v < l.length; v++) { var y, g = void 0, _ = void 0; m = l[v]; y = f.parse(m.latex, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", 0], ["tc", v]]) })), g = []; for (var b = -1, D = 0; D < l[v].values.length; D++)m.values[D].replace(/\\space/g, "").match(/\S/) ? (g.push(f.parse(m.values[D], h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", D + 1], ["tc", v]]) }))), b = D) : g.push(k(NaN)); if (g = g.slice(0, b + 1), (_ = j(y, d, g)).id = m.id, _.header) { if (_.header.userData = m, _.header.metaData = { extraDepNodes: [] }, m.colorLatex) { var P = U(m.colorLatex, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", 0], ["tc", v], ["cl", v]]) })); _.header.metaData.colorLatex = P, _.header.metaData.extraDepNodes.push(P) } if (m.pointSize) { var O = U(m.pointSize, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", 0], ["tc", v], ["ps", v]]) })); _.header.metaData.pointSize = O, _.header.metaData.extraDepNodes.push(O) } if (m.pointOpacity) { var E = U(m.pointOpacity, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", 0], ["tc", v], ["po", v]]) })); _.header.metaData.pointOpacity = E, _.header.metaData.extraDepNodes.push(E) } if (m.lineWidth) { var T = U(m.lineWidth, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", 0], ["tc", v], ["lw", v]]) })); _.header.metaData.lineWidth = T, _.header.metaData.extraDepNodes.push(T) } if (m.lineOpacity) { var F = U(m.lineOpacity, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["tr", 0], ["tc", v], ["lo", v]]) })); _.header.metaData.lineOpacity = F, _.header.metaData.extraDepNodes.push(F) } } p.push(_) } this.statements[s] = W(p); var w = this.statements[s].getAllIds(); o.forEach(function (e) { -1 === w.indexOf(e) && a._notifyGraphRemoved(e, i) }); break; case "image": var R = "-\\trigAngleMultiplier*(" + e.angle + ")", M = U(e.center, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["ic", s]]) })), A = U(R, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["ia", s]]) })), C = U(e.width, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["iw", s]]) })), I = U(e.height, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["ih", s]]) })), N = U(e.opacity, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["io", s]]) })); this.statements[s] = V({ center: M, radianAngle: A, width: C, height: I, opacity: N }); break; case "ticker": this.statements[s] = t.Ticker({ handler: U(e.handlerLatex, h.__assign(h.__assign({}, r), { allowDt: !0 })), minStep: U(e.minStepLatex || "0", r) }); break; default: for (var L in e = e, this.statements[s] = f.parse(e.latex, r), ne) { var G = L; if (e[G]) { var B = ne[G], q = e[G]; B.transform && (q = B.transform(q)); var H = $(q, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [[B.seed, s]]) })); n[G] = H, n.extraDepNodes.push(H) } } if (e.colorLatex) { H = ee(e.colorLatex, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["ac", s]]) })); n.colorLatex = H, n.extraDepNodes.push(H) } if (e.polarDomain && e.polarDomain.min && (n.polarDomainMin = $(e.polarDomain.min, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lm", s]]) })), n.extraDepNodes.push(n.polarDomainMin)), e.polarDomain && e.polarDomain.max && (n.polarDomainMax = $(e.polarDomain.max, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lM", s]]) })), n.extraDepNodes.push(n.polarDomainMax)), e.parametricDomain && e.parametricDomain.min && (n.parametricDomainMin = $(e.parametricDomain.min, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lm", s]]) })), n.extraDepNodes.push(n.parametricDomainMin)), e.parametricDomain && e.parametricDomain.max && (n.parametricDomainMax = $(e.parametricDomain.max, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lM", s]]) })), n.extraDepNodes.push(n.parametricDomainMax)), e.vizProps && (e.vizProps.axisOffset && (n.vizAxisOffset = $(e.vizProps.axisOffset, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["vo", s]]) })), n.extraDepNodes.push(n.vizAxisOffset)), e.vizProps.breadth && (n.vizBreadth = $(e.vizProps.breadth, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["vb", s]]) })), n.extraDepNodes.push(n.vizBreadth))), e.cdf && e.cdf.show) { var X = S.parseToplevelFunction(e.latex); X && "distribution" === X.type && (n.distributionSpec = X, n.cdfMin = ee(e.cdf.min, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lm", s]]) })), n.extraDepNodes.push(n.cdfMin), n.cdfMax = ee(e.cdf.max, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lM", s]]) })), n.extraDepNodes.push(n.cdfMax)) } if (this.statements[s].shouldPromoteToSlider(this.policy)) { var Y = e.slider, K = !(!Y || !Y.isPlayingOnce), Q = ee(Y && Y.softMin, r), Z = ee(Y && Y.softMax, r), te = ee(Y && Y.min, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lm", s]]) })), ie = ee(Y && Y.max, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["lM", s]]) })), ae = ee(Y && Y.step, h.__assign(h.__assign({}, r), { seedPrefix: J(s, [["ls", s]]) })); this.statements[s] = z(this.statements[s], { sliderMin: te, sliderMax: ie, sliderStep: ae, sliderIsPlayingOnce: K, sliderSoftMin: Q, sliderSoftMax: Z }) } }var se = e.clickableInfo; se && se.enabled && se.latex && (n.clickHandler = U(se.latex, h.__assign(h.__assign({}, r), { allowIndex: !0 }))), this.statements[s].userData = e, this.statements[s].metaData = n; var re = e.label; if (re) { var oe = this.currentLabel[s]; oe && oe.raw === re || (this.currentLabel[s] = x.parse(re)) } else delete this.currentLabel[s] } }, e.prototype.removeStatement = function (e, t) { var i = this.statements[e]; if (i) { if (this.markExportsDirty(e), i.isTable) { var a = this; i.getAllIds().forEach(function (e) { a._notifyGraphRemoved(e, t) }) } else this._notifyGraphRemoved(e, t); delete this.currentLabel[e], delete this.statements[e], delete this.analysis[e], delete this.currentStatus[e] } }, e.prototype.markExportsDirty = function (e) { if (this.statements[e]) { this.statements[e].isRegression && (this.markedRegressionDirty = !0); for (var t = 0, i = this.statements[e].getLegalExports(this.policy); t < i.length; t++) { var a = i[t]; this.dirtyExportedSymbolRoots[a] = !0 } } }, e.prototype.markAsDirtyRoot = function (e) { this.dirtyStatementRoots[e] = !0 }, e.prototype.getFrame = function () { return this.updateAnalysis(), this.frame }, e.prototype.getAnalysis = function () { return this.updateAnalysis(), this.analysis }, e.prototype.getEvaluationState = function (e) { if (this.updateAnalysis(), this.analysis[e]) return this.analysis[e].evaluationState }, e.prototype._updateRegressions = function (e) { var t = this.frame, i = this.lastFrame, a = this.regressionFrame, s = []; for (var r in e) e.hasOwnProperty(r) && e[r].isRegression && s.push(r); var n = this; s.sort(function (e, t) { var i = n.statements[e].userData && n.statements[e].userData.residualVariable, a = n.statements[t].userData && n.statements[t].userData.residualVariable; return i && !a ? -1 : a && !i ? 1 : 0 }); var o = v.findDependencyOrder(this.policy, e, s); ie(o, a); for (var l = {}, p = 0, d = o.resolved; p < d.length; p++) { r = d[p]; if (this.statements[r].isRegression) this.analysis[r] = e[r].analyze(this.policy, a, t, i, l), this.analysis[r].exportTo(this.policy, t), delete e[r]; else { var c = e[r].tryGetConcreteTree(this.policy, a); e[r].exportTo(this.policy, c, a), l[r] = { rawTree: e[r], concreteTree: c } } } }, e.prototype.buildSymbolToExpressionDirtyMap = function () { var e = {}; for (var t in this.statements) if (this.statements.hasOwnProperty(t)) { var i = this.statements[t], a = i.metaData; if (ae(e, t, i.getDependencies()), ae(e, t, i.getLegalExports(this.policy)), i.isRegression && i.userData && i.userData.residualVariable && ae(e, t, [O.latexToIdentifier(i.userData.residualVariable)]), se(e, t, a), i.isTable && i.columns) for (var s = 0; s < i.columns.length; s++) { var r = i.columns[s]; r.header && r.header.metaData && se(e, t, r.header.metaData) } } return e }, e.prototype.getDirtyIdsAndSymbols = function (e) { var t = {}, i = {}, a = this.markedRegressionDirty, s = [], r = []; for (var n in this.dirtyStatementRoots) this.dirtyStatementRoots[n] && (i[n] = !0, s.push(n)); for (var o in this.dirtyExportedSymbolRoots) this.dirtyExportedSymbolRoots[o] && (t[o] = !0, r.push(o)); for (; s.length || r.length;) { for (; s.length;) { n = s.pop(); var l = this.statements[n]; if (l) { l.isRegression && (a = !0); for (var p = 0, d = l.getLegalExports(this.policy); p < d.length; p++) { t[o = d[p]] || (t[o] = !0, r.push(o)) } } } for (; r.length;) { var c = e[o = r.pop()]; if (c) for (var u = 0, h = c; u < h.length; u++) { i[n = h[u]] || (i[n] = !0, s.push(n)) } } } return { ids: i, symbols: t, hasDirtyRegression: a } }, e.prototype.updateAnalysis = function () { var e = this.buildSymbolToExpressionDirtyMap(), t = this.getDirtyIdsAndSymbols(e), i = {}; if (t.hasDirtyRegression) { for (var a in this.statements) this.statements[a] && (i[a] = this.statements[a]); this.frame = Object.create(this.parent_frame), this.regressionFrame = Object.create(this.parent_frame) } else { var s = t.ids; for (var a in s) this.statements[a] && (i[a] = this.statements[a]); var r = t.symbols; for (var n in r) r[n] && (delete this.frame[n], delete this.regressionFrame[n]) } for (var a in i) i[a] && (this.unpublishedIds[a] = !0); this.markedRegressionDirty = !1, this.dirtyExportedSymbolRoots = {}, this.dirtyStatementRoots = {}; var o = this.analysis, l = this.frame; "graphing" === this.evaluationMode && this._updateRegressions(i); var p = v.findDependencyOrder(this.policy, i); ie(p, l); for (var d = p.resolved, c = 0, u = d; c < u.length; c++) { a = u[c]; switch (this.evaluationMode) { case "fourFunction": case "singleExpressionFourFunction": o[a] = this.statements[a].analyzeFourFunction(this.policy, l, o), o[a].exportTo(this.policy, l); break; case "scientific": o[a] = this.statements[a].analyzeScientific(this.policy, l, o), o[a].exportTo(this.policy, l); break; case "singleExpressionScientific": o[a] = this.statements[a].analyzeSingleExpressionScientific(this.policy, l, o), o[a].exportTo(this.policy, l); break; case "graphing": case "graphing_3d": if (l.r) { var h = Object.create(l); if (h.r = void 0, o[a] = this.statements[a].analyze(this.policy, h, o), o[a].getGraphMode() === _.POLAR) { o[a].exportTo(this.policy, l); continue } } o[a] = this.statements[a].analyze(this.policy, l, o), o[a].exportTo(this.policy, l) } } if ("graphing" === this.evaluationMode || "graphing_3d" === this.evaluationMode) for (var f = 0, m = d; f < m.length; f++) { a = m[f]; var y = o[a], g = y.evaluationState.expression_type; for (var x in ne) { var D = x, S = ne[D]; S.shouldEvaluate && !S.shouldEvaluate(y) || le(y, this.policy, l, D) } ce(y, this.policy, l), this.actions && Y(y) && ue(y, this.policy, l), g === b.ExpressionType.PARAMETRIC || g === b.ExpressionType.POLAR ? he(y, this.policy, l) : g === b.ExpressionType.BOXPLOT ? fe(y, this.policy, l) : X(y) && re(y, this.policy, l) } for (var n in function (e) { return e.globalRandomSeed || [] }(e).forEach(function (e) { o[e].evaluationState.depends_on_random_seed = !0 }), this.lastFrame = Object.create(this.parent_frame), l) l.hasOwnProperty(n) && (this.lastFrame[n] = l[n]) }, e.prototype.processEvents = function (e) { if (e && this.actions) { for (var i, a = Object.create(this.frame), s = {}, r = !1, n = !1, o = 0, l = e; o < l.length; o++) { var p = l[o]; switch (this.globalEventCount += 1, a.globalEventCount = t.Constant(this.globalEventCount), p.type) { case "step": if (!(d = this.statements[p.expressionId])) continue; n = !0, me(d.tryGetConcreteTree(this.policy, a), s, a); break; case "click": var d; if (!(d = this.statements[p.expressionId]) || !d.metaData.clickHandler) continue; a.index = t.Constant(p.indexVar + 1), n = !0, r = !0, me(d.metaData.clickHandler.tryGetConcreteTree(this.policy, a), s, a); break; case "clock-tick": (void 0 === i || p.isFirstTick && !i.isFirstTick) && (i = p); break; default: return p } } if (i) if ((d = this.statements[i.id]) && d instanceof t.Ticker) { var c = d.minStep.tryGetConcreteTree(this.policy, a).asValue(); if ("number" == typeof c && c >= 0 && isFinite(c)) { var u = this.lastClockTickTime; if (this.lastClockTickTime = Date.now(), !i.isFirstTick && void 0 !== u) a.dt = t.Constant(this.lastClockTickTime - u), me(d.handler.tryGetConcreteTree(this.policy, a), s, a) } } return { objectClicked: r, userAction: n, updates: s } } }, e }(); e.Context = ve });
define('worker/workercore', ['require', 'core/math/context'], function (require) { "use strict"; var e = require("core/math/context").Context; return function (n) { var t = new e; return { processChangeSet: function (e) { var r = t.processChangeSet(e); n("processChangeSet", r) } } } });
define('worker/fakeworker', ['require', 'worker/workercore'], function (require) { "use strict"; var e = require("worker/workercore"); return function (n) { var t = {}, r = e(function (e, t) { n({ type: e, payload: t }) }); return t.postMessage = function (e) { setTimeout(function () { r.processChangeSet(e) }, 0) }, t } });
define('worker/workerpool', ['require', 'console', './create_worker_url', 'pjs', 'underscore_model', './fakeworker', 'underscore', 'lib/urlparser'], function (require) { "use strict"; var r = require("console"), e = require("./create_worker_url"), n = require("pjs"), o = require("underscore_model").UnderscoreModel, t = require("./fakeworker"), i = require("underscore"), s = require("lib/urlparser"), a = ""; try { void 0 === (a = s.getParameter(window.location.search, "workerThrottle")) && (a = s.getParameter(window.top.location.search, "workerThrottle")) } catch (r) { } var c = parseInt(a, 10), u = 0; function k(r) { return c ? function (e) { u = Math.max(Date.now(), u) + c, setTimeout(r, u - Date.now(), e) } : r } return n(o, function (n, o) { n.init = function (r) { o.init.call(this), this.workers = [], this.maxWorkers = r, this.workerURL = e() }, n.allowedToSpawnWorker = function () { return this.workerURL && this.workers.length < this.maxWorkers }, n.killWorker = function (r) { -1 !== i.indexOf(this.workers, r) && (r.terminate(), this.workers = i.without(this.workers, r), i.shuffle(i.values(r.__connections)).forEach(function (r) { r && r.onWorkerKilled && r.onWorkerKilled() })) }, n.spawnWorker = function () { try { var e = new Worker(this.workerURL); return e.__connections = {}, e.__isFake = !1, e.onerror = function (e) { r.log(e) }, e.addEventListener("message", k(function (r) { var n = r.data; if ((!n || !n.log) && n && n.connectionId) { var o = e.__connections[n.connectionId]; o && o.onResponse(n.originalMessage) } })), this.workers.push(e), e } catch (r) { return null } }, n.spawnFakeWorker = function () { var r = t(k(function (e) { var n = i.values(r.__connections)[0]; n && n.onResponse(e) })); return r.__isFake = !0, r.__connections = {}, r }, n.findLeastUsedWorker = function () { return i.sortBy(this.workers, function (r) { return i.size(r.__connections) })[0] }, n.allocateWorker = function () { var r = null; return this.allowedToSpawnWorker() && (r = this.spawnWorker()), r || (r = this.findLeastUsedWorker()), r || (r = this.spawnFakeWorker()), r } }) });
define('main/evaluator', ["require", "exports", "worker/workerpoolconnection", "worker/workerpool", "core/lib/deepCopy", "core/math/functions", "underscore"], function (require, e, t, n, o, s, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Evaluator = void 0; var a = function () { function e(e) { this.__ticksEnabled = !0, this.listeners = { processChangeSet: function (e) { var t = {}, n = {}; for (var o in e.graphChanges) { var i = e.graphChanges[o]; void 0 === i ? n[o] = !0 : (s.rehydrateGraphData(i), t[o] = i) } var a = {}; for (var o in e.intersectionChanges) n[o] || (a[o] = e.intersectionChanges[o]); var r = !!this.changeSet; this.onEvaluatorResults({ evaluationStates: e.statusChanges, graphData: { addedGraphs: t, removedGraphs: n, intersections: a }, renderSlowly: !!e.isCompleteState, timingData: e.timingData, eventUpdates: e.eventUpdates }); for (var h = e.syncId; this.syncRequests.length && void 0 !== h && this.syncRequests[0].id <= h;) { this.syncRequests.shift().callback() } this.markJobFinished(), r && this._processChangeSet() } }, this.__state = {}, this.changeSet = null, this.cumulativeChangeSet = {}, this.syncId = 1, this.syncRequests = [], e || (e = n()), this.workerPool = e, this.createWorkerPoolConnection() } return e.prototype.createWorkerPoolConnection = function () { var e = this; this.workerPoolConnection && (this.workerPoolConnection.onResponse = function () { }, this.workerPoolConnection.onWorkerKilled = function () { }), this.workerPoolConnection = t(this.workerPool), this.markJobFinished(), this.workerPoolConnection.onResponse = function (t) { e.shouldIgnoreWorkerMessage(t) ? "processChangeSet" === t.type && (e.markJobFinished(), e._processChangeSet()) : e.listeners[t.type].call(e, t.payload) }, this.workerPoolConnection.onWorkerKilled = function () { var t = e.hasJobInWorker(); e.createWorkerPoolConnection(), t ? (e.changeSet = o.default(e.cumulativeChangeSet), e.__state.changed = !0, e.__state.droppedMessage = !0) : (e.changeSet = o.default(e.cumulativeChangeSet), e.__state.changed = !1), e.processChangeSet() } }, e.prototype.destroy = function () { this.workerPoolConnection && (this.workerPoolConnection.onResponse = function () { }, this.workerPoolConnection.onWorkerKilled = function () { }, this.workerPoolConnection.destroy()) }, e.prototype.shouldIgnoreWorkerMessage = function (e) { return !!this.__suspendUntilSyncId && (!e || !e.payload || !(e.payload.syncId >= this.__suspendUntilSyncId)) }, e.prototype.suspend = function () { var e = this; this.changeSet && this.changeSet.syncId || (this.syncId++, this.applyToChangeSets(function (t) { t.syncId = e.syncId })), this.__suspendUntilSyncId = this.changeSet.syncId }, e.prototype.markJobFinished = function () { this.__state.droppedMessage = !1, this.__jobStartTime = -1, this.__suspendUntilSyncId = void 0 }, e.prototype.startJobTimer = function () { this.__jobStartTime = (new Date).getTime() }, e.prototype.hasJobInWorker = function () { return -1 !== this.__jobStartTime }, e.prototype.getJobElapsedTime = function () { return this.hasJobInWorker() ? (new Date).getTime() - this.__jobStartTime : NaN }, e.prototype.setTicksEnabled = function (e) { this.__ticksEnabled = e }, e.prototype.tick = function () { this.__ticksEnabled && this._processChangeSet() }, e.prototype.processChangeSet = function () { this.__processChangeSetRequested = !0 }, e.prototype._processChangeSet = function () { if (this._syncEvaluatorConfig(), this.__processChangeSetRequested) { var e = this.getJobElapsedTime() >= 4e3; if (this.__state.droppedMessage && e) this.workerPoolConnection.killWorker(); else if (this.__state.changed && this.changeSet) if (this.changeSet.syncId || (this.syncId++, this.changeSet.syncId = this.syncId), this.hasJobInWorker()) this.changeSet.isCompleteState && e && this.workerPoolConnection.killWorker(); else { var t = this.changeSet; this.changeSet = null, this.__state.changed = !1, this.startJobTimer(), this.workerPoolConnection.sendMessage(t), this.__processChangeSetRequested = !1 } } }, e.prototype.notifyWhenSynced = function (e) { var t = this; this._syncEvaluatorConfig(), this.hasJobInWorker() || this.changeSet ? (this.syncId++, this.syncRequests.push({ id: this.syncId, callback: e }), this.applyToChangeSets(function (e) { e.syncId = t.syncId })) : setTimeout(e, 0) }, e.prototype.applyToChangeSets = function (e) { this.__state.changed = !0, this.changeSet || (this.changeSet = {}), this.cumulativeChangeSet || (this.cumulativeChangeSet = {}), e(this.changeSet), e(this.cumulativeChangeSet), this.processChangeSet() }, e.prototype.clearStatementsAndStartCompleteState = function () { this.hasJobInWorker() && this.suspend(), this.applyToChangeSets(function (e) { e.isCompleteState = !0, delete e.statements }) }, e.prototype.markUndoRedoState = function () { this.applyToChangeSets(function (e) { e.isUndoRedoState = !0 }) }, e.prototype.addStatement = function (e) { this.applyToChangeSets(function (t) { t.statements || (t.statements = {}), t.statements[e.id] = o.default(e) }) }, e.prototype.removeStatement = function (e) { this.applyToChangeSets(function (t) { t.statements || (t.statements = {}), t.removes || (t.removes = {}), delete t.statements[e], t.removes[e] = !0 }) }, e.prototype.addActionStepEvent = function (e) { this.applyToChangeSets(function (t) { t.events || (t.events = []), t.events.push({ type: "step", expressionId: e }) }) }, e.prototype.addClockTickEvent = function (e, t) { this.applyToChangeSets(function (n) { n.events || (n.events = []), n.events.push({ type: "clock-tick", id: e, isFirstTick: t }) }) }, e.prototype.addClickEvent = function (e, t) { this.applyToChangeSets(function (n) { n.events || (n.events = []), void 0 === t && (t = 0), n.events.push({ type: "click", expressionId: e, indexVar: t }) }) }, e.prototype._syncEvaluatorConfig = function () { if (this.readEvaluatorConfig) { var e = this.readEvaluatorConfig(); for (var t in e) this._applyIfChanged(e, t) } }, e.prototype._applyIfChanged = function (e, t) { var n = this.cumulativeChangeSet && this.cumulativeChangeSet[t], o = e[t]; i.isEqual(n, o) || this.applyToChangeSets(function (e) { e[t] = o }) }, e }(); e.Evaluator = a });
define('api/util', ["require", "exports", "lib/console"], function (require, e, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.validateLanguage = void 0, e.validateLanguage = function (e) { return "es-ES" === e ? (a.warn("{language: 'es-ES'} has been deprecated. Proceeding with {language: 'es'}"), "es") : e } });

define('loadcss!tour', function () { });

define('loadcss!calculator_embed', function () { });

define('loadcss!buttons', function () { });

define('loadcss!dcg-normalize', function () { });

define('loadcss!projector_mode', function () { });

define('loadcss!desmos-icons', function () { });

define('loadcss!popovers', function () { });
define('main/calc_embed', ["require", "exports", "main/graph_settings", "tours/tour_manager", "tslib", "jquery", "main/controller", "dcgview", "main/instancehotkeys", "lib/console", "underscore", "lib/defocus-mobile", "graphing-calc/views/main", "underscore_model", "graphing/viewport", "main/evaluator", "graphing/grapher", "core/lib/color-helpers", "api/util", "lib/parse-query-params", "loadcss!tour", "loadcss!calculator_embed", "loadcss!buttons", "loadcss!dcg-normalize", "loadcss!projector_mode", "loadcss!desmos-icons", "loadcss!popovers"], function (require, e, t, o, s, r, a, n, i, l, p, c, d, h, g, u, f, w, m, b) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var v = 0, y = function () { function e(e, s, l, c) { var g = this; e || (e = document.createElement("div")); var w = document.createElement("div"); w.className = "dcg-wrapper", w.style.width = "100%", w.style.height = "100%", e.appendChild(w), this.__id = v++; var m = new t; for (var b in this.graphSettings = m, l) m.config.setProperty(b, l[b]); var y = new a.default(m); this.controller = y, c && y.dispatch({ type: "ui/container-resized", size: c }), this.rootElt = w, this.view = n.mountToNode(d.default, this.rootElt, { controller: n.const(y) }); var x = new u.Evaluator(s); this.controller.setEvaluator(x), this.controller.setRootElt(this.rootElt); var C = y.find$(".dcg-grapher"), k = new f.Grapher(C, m, this.controller, x); this.controller.setGrapher(k), m.registerCallbacks(k, x), this.controller.initStateStack(), m.config.redrawSlowly || (k.redrawSlowly = k.redrawAllLayers), x.readEvaluatorConfig = function () { return { evaluationMode: "graphing", globalRandomSeed: m.randomSeed, degreeMode: m.degreeMode, viewState: y.getViewState(), intersectId: y.getIntersectId(), restrictedFunctions: m.config.restrictedFunctions, forceEnableGeometryFunctions: m.config.forceEnableGeometryFunctions, distributions: m.config.distributions, pointsOfInterest: m.config.pointsOfInterest, plotSingleVariableImplicitEquations: m.config.plotSingleVariableImplicitEquations, plotImplicits: m.config.plotImplicits, plotInequalities: m.config.plotInequalities, sliders: m.config.sliders, actions: !!m.config.actions, dimensions: y.getGrapherDimensions() } }, x.onEvaluatorResults = function (e) { g.controller.dispatch({ type: "on-evaluator-changes", changes: e.evaluationStates, timingData: e.timingData, graphData: e.graphData, eventUpdates: e.eventUpdates }), e.renderSlowly ? k.redrawSlowly() : k.redrawAllLayers() }, this.unsubFunc = this.controller.subToChanges(function () { g.controller.doesDOMHaveSize() && (g.view.update(), k.update()); var e = !1; (function () { var e = !1, t = y.computeMajorLayout(), o = { left: t.grapher.left, right: t.grapher.left + t.grapher.width, width: t.grapher.width, top: t.grapher.top, bottom: t.grapher.top + t.grapher.height, height: t.grapher.height }, s = k.getCurrentViewport(), r = { top: s.ymax, bottom: s.ymin, left: s.xmin, right: s.xmax, width: s.xmax - s.xmin, height: s.ymax - s.ymin }; p.isEqual(r, S.mathCoordinates) || (S.setProperty("mathCoordinates", r), e = !0); o.height > 0 && o.width > 0 && !p.isEqual(o, S.pixelCoordinates) && (S.setProperty("pixelCoordinates", o), e = !0); return e })() && (e = !0), function () { var e = !1, t = k.getProjection(), o = k.viewportController.isZoomRestored(); o !== m.zoomedDefault && (m.setProperty("zoomedDefault", o), e = !0); var s = t.viewport.isSquare(t.screen); s !== m.squareAxes && (m.setProperty("squareAxes", s), e = !0); return e }() && (e = !0), e && g.controller.doesDOMHaveSize() && (g.view.update(), k.update()) }); var S = new h.UnderscoreModel; S.setProperties({ pixelCoordinates: { top: 0, bottom: 0, left: 0, right: 0, width: 0, height: 0 }, mathCoordinates: { top: 0, bottom: 0, left: 0, right: 0, width: 0, height: 0 } }), this.graphpaperBounds = S, r(this.rootElt).on("keydown.calculator-" + this.__id, function (e) { g.grapher && g.grapher.audioGraph.handleKeydown(e), g.instanceHotkeys.handleKeydown(e) }), r(window).on("dcg-tapstart.calculator-" + this.__id, function (e) { var t = r(e.target), o = !!t.closest(g.rootElt).length, s = e.wasHandled("create-expression-with-keyboard"), a = !!t.closest(".dcg-api-shared-keypad-root").length, n = !!t.hasClass("dcg-shell"); if (o || a || n || s || y.dispatch({ type: "set-none-selected" }), e.wasHandled("do-not-clear-poi-labels") || (k.traceLayer.clearOpenedPOI(), k.redrawAllLayers()), y.isInEditListMode()) { var i = 0 === t.closest(".dcg-exppanel").length && 0 === t.closest(".dcg-options-menu").length && 0 === t.closest(".dcg-expression-top-bar").length && 0 === t.closest(".dcg-keypad").length; o && !i || y.dispatch({ type: "set-edit-list-mode", isEditListMode: !1, focusExpressionList: !1 }) } }), this.grapher = k, this.evaluator = x, this.tourManager = o({ evaluator: x }), this.controller.dispatch({ type: "set-blank" }); var O = {};["degreeMode"].forEach(function (e) { void 0 !== l[e] && (O[e] = l[e]) }), m.setGraphSettings(O), m.config.expressionsCollapsed && this.setOptions({ expressionsCollapsed: !0 }), m.config.capExpressionSize && this.setOptions({ capExpressionSize: !0 }), m.config.hasOwnProperty("pointsOfInterest") && this.setOptions({ pointsOfInterest: m.config.pointsOfInterest }), m.config.hasOwnProperty("backgroundColor") && this.setOptions({ backgroundColor: m.config.backgroundColor }), m.config.hasOwnProperty("textColor") && this.setOptions({ textColor: m.config.textColor }), m.config.observe("language", function () { var e = g.controller.getState(); g.controller.dispatch({ type: "set-state", state: e }), g.tourManager && (g.tourManager.closingMsg = function (e, t) { return "<b>" + e + "</b><br>" + g.controller.s("graphing-tours-label-self-destruct", { seconds: t }) }) }), m.config.observe("forceLogModeRegressions", function () { m.config.forceLogModeRegressions && g.controller.setAllRegressionsToLogMode() }), this.instanceHotkeys = new i.default(y) } return e.prototype.setOption = function (e, t) { this.controller.getGraphSettings().config.setProperty(e, t) }, e.prototype.setOptions = function (e) { var t, o = this.controller.getGraphSettings().config, r = s.__assign({}, e); function a(e) { var t = e.notes, o = e.folders, s = e.images; return !1 === t || !1 === o || !1 === s } e.hasOwnProperty("backgroundColor") && (w.isValidHexColor(e.backgroundColor) || (l.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"), delete r.backgroundColor)), e.hasOwnProperty("textColor") && (w.isValidHexColor(e.textColor) || (l.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"), delete r.textColor)), e.hasOwnProperty("menus") && (l.warn("Deprecated option: menus. Setting settingsMenu and expressionsTopbar instead."), e.hasOwnProperty("settingsMenu") || (r.settingsMenu = !!e.menus), e.hasOwnProperty("expressionsTopbar") || (r.expressionsTopbar = !!e.menus)), e.hasOwnProperty("solutions") && (l.warn("Deprecated option: solutions. Setting pointsOfInterest instead."), e.hasOwnProperty("pointsOfInterest") || (r.pointsOfInterest = !!e.solutions)), e.hasOwnProperty("singleVariableSolutions") && l.warn("Deprecated option: singleVariableSolutions has been removed."), !1 === e.graphpaper && (e.expressionsCollapsed && (r.expressionsCollapsed = !1, l.warn("Cannot set graphpaper: false with expressionsCollapsed: true. Proceeding with expressionsCollapsed: false.")), o.expressionsCollapsed && (r.expressionsCollapsed = !1, l.warn("Disabling the graphpaper with the expressions list collapsed is not supported.Setting expressionsCollapsed: false.")), e.zoomButtons && (r.zoomButtons = !1, l.warn("Cannot set graphpaper: false with zoomButtons: true. Proceeding with zoomButtons: false.")), e.showResetButtonOnGraphpaper && (r.showResetButtonOnGraphpaper = !1, l.warn("Cannot set graphpaper: false with showResetButtonOnGraphpaper: true. Proceeding with showResetButtonOnGraphpaper: false.")), o.zoomButtons && (r.zoomButtons = !1, l.warn("Disabling the graphpaper with the zoomButtons visible is not supported. Setting zoomButtons: false.")), o.showResetButtonOnGraphpaper && (r.showResetButtonOnGraphpaper = !1, l.warn("Disabling the graphpaper with the reset button visible is not supported. Setting showResetButtonOnGraphpaper: false."))), !1 === o.graphpaper && (e.expressionsCollapsed || e.zoomButtons || e.showResetButtonOnGraphpaper) && (r.graphpaper = !0, l.warn("Must have visible graphpaper to proceed. Setting graphpaper: true.")), e.lockViewport && e.zoomButtons && (r.zoomButtons = !1, l.warn("Cannot set zoomButtons: true and lockViewport: true. Proceeding with zoomButtons: false.")), o.lockViewport && e.zoomButtons && (r.lockViewport = !1, l.warn("Cannot set zoomButtons: true while the viewport is locked. Setting lockViewport: false.")), o.zoomButtons && e.lockViewport && (r.zoomButtons = !1, l.warn("Cannot lock the viewport without hiding the zoom buttons. Setting zoomButtons: false.")); var n = a(e), i = a(s.__assign(s.__assign({}, o), e)), p = o.pasteGraphLink, c = e.pasteGraphLink; for (t in n ? (c || p) && (r.pasteGraphLink = !1, l.warn("Cannot disable creating note, folder, or image expressions without disabling graph link pasting. Setting pasteGraphLink: false.")) : c && i && (r.notes = !0, r.folders = !0, r.images = !0, l.warn("Cannot enable graph link pasting while the creation of notes, folders, or images is disable. Setting notes: true, folders: true, images: true.")), e.language && (r.language = m.validateLanguage(e.language)), r) if (r.hasOwnProperty(t)) switch (t) { case "expressionsCollapsed": this.setOption("expressionsCollapsed", !!r.expressionsCollapsed), r.expressionsCollapsed ? this.controller.dispatch({ type: "hide-expressions-list", focusShowIcon: !1 }) : this.controller.dispatch({ type: "show-expressions-list", focusHideIcon: !1 }); break; case "qwertyKeyboard": this.setOption("qwertyKeyboard", !!r.qwertyKeyboard), this.controller.isLetterKeypadOpen() && this.controller.dispatch({ type: "keypad/abc" }); break; case "degreeMode": this.setOption("degreeMode", !!r.degreeMode), this.controller.getGraphSettings().setGraphSettings({ degreeMode: !!r.degreeMode }); break; case "actions": if (void 0 === (d = r[t]) || d === this.controller.getGraphSettings().config.actions) break; this.setOption(t, d), this.setState(this.getState(), { allowUndo: !0 }); break; case "keypad": case "graphpaper": case "expressions": case "settingsMenu": case "zoomButtons": case "showResetButtonOnGraphpaper": case "expressionsTopbar": case "pointsOfInterest": case "trace": case "border": case "lockViewport": case "administerSecretFolders": case "advancedStyling": case "images": case "imageUploadCallback": case "folders": case "notes": case "sliders": case "links": case "restrictedFunctions": case "forceEnableGeometryFunctions": case "distributions": case "pasteGraphLink": case "pasteTableData": case "clearIntoDegreeMode": case "autosize": case "plotSingleVariableImplicitEquations": case "plotImplicits": case "plotInequalities": case "colors": case "branding": case "disableScrollFix": case "invertedColors": case "fontSize": case "projectorMode": case "language": case "redrawSlowly": case "onlyTraceSelected": case "disableMouseInteractions": case "nativeOnscreenKeypad": case "functionDefinition": case "plaidMode": case "pasteGraphLinkCallback": case "editOnWeb": case "crossOriginSaveTest": case "backgroundColor": case "textColor": case "enableTabindex": case "audioTraceReverseExpressions": case "showHamburger": case "decimalToFraction": case "capExpressionSize": case "transparentBackground": case "pauseWhenOffscreen": case "brailleMode": case "sixKeyInput": case "brailleControls": case "zoomFit": case "forceLogModeRegressions": case "audio": var d; void 0 !== (d = r[t]) && this.setOption(t, d); break; default: return t } }, e.prototype.setViewport = function (e) { this.grapher.viewportController.setViewport(new g.Viewport(e[0], e[1], e[2], e[3])) }, e.prototype.resize = function (e) { e && this.controller.dispatch({ type: "ui/container-resized", size: e }) }, e.prototype.interceptTouch = function () { var e = r(this.rootElt), t = e.find(".dcg-expression-top-bar"); t.add(e.find(".dcg-keypad")), t.length && (t.on("touchstart", function (e) { r(e.target).is("input, textarea") || e.preventDefault() }), t.on("touchend", function (e) { r(e.target).closest(".dcg-do-not-blur").length > 0 || c.default() })) }, e.prototype.destroy = function () { r(window).off(".calculator-" + this.__id); var e = r(this.rootElt); e.off(".calculator-" + this.__id), this.unsubFunc(), this.graphSettings.unobserveAll(), this.evaluator && this.evaluator.destroy(), this.grapher && this.grapher.remove(), n.unmountFromNode(this.rootElt), e.remove() }, e.prototype.tick = function (e, t) { t || (this.controller.handleTick(e), this.controller.updateRenderShellsAfterDispatch()), this.evaluator.tick(), this.grapher && this.grapher.tick(e) }, e.prototype.getState = function (e) { return this.controller.getState(e) }, e.prototype.setBlank = function (e) { this.controller.dispatch({ type: "set-blank", opts: e || {} }) }, e.prototype.setState = function (e, t) { this.controller.dispatch({ type: "set-state", state: e, opts: t || {} }) }, e }(); function x() { var e = r('<div style="z-index:99999; position: absolute; left: 0; top: 0;background:#FFF">waiting...</div>').appendTo("body"), t = window, o = []; t.Calc.controller.onEvaluatorChangesSpy = function () { o.push(Date.now()) }, setInterval(function () { for (var t = Date.now(); t - o[0] > 1e3;)o.shift(); e.text(o.length + " fps") }, 100) } function C() { var e, t = r('<div style="z-index:99999; position: absolute; left: 0; top: 0;background:#FFF">waiting...</div>').appendTo("body"), o = window, s = [], a = 0; o.Calc.controller.onEvaluatorChangesSpy = function (e, t) { var o = t.timeInWorker; s[a % 100] = o, a += 1 }, function o() { cancelAnimationFrame(e), e = requestAnimationFrame(o), function () { for (var e = 0, o = 0, r = s; o < r.length; o++)e += r[o]; var a = e / s.length; t.text(a.toFixed(1) + " ms") }() }() } if (e.default = y, !!b.getQueryParams().simulationFPS) var k = setInterval(function () { window.Calc && (clearInterval(k), setTimeout(x, 1e3)) }, 1); if (!!b.getQueryParams().timeInWorker) k = setInterval(function () { window.Calc && (clearInterval(k), setTimeout(C, 1e3)) }, 1) });
define('lib/dom-change-detector', ["require", "exports", "tslib", "jquery"], function (require, t, e, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.checkAllWatchingDetectors = t.testFixture = void 0; var s = 1, h = {}, n = !1; function r() { n = !0, requestAnimationFrame(d) } function d() { for (var e in t.testFixture.rafSPY && t.testFixture.rafSPY(), n = !1, h) h[e].detectAndEnqueueEvent(), n = !0; if (n) for (var e in r(), h) h[e].dispatchQueuedEvent() } t.testFixture = {}, t.checkAllWatchingDetectors = d; var a = function () { function t(t, e) { this.elt = t, this.cb = e, this.destroyed = !1, this.lastOffscreen = !1, this.id = s.toString(), this.appliedScale = { x: 1, y: 1 }, s++ } return t.prototype.stopWatching = function () { delete h[this.id] }, t.prototype.startWatching = function () { this.checkForChanges(), h[this.id] = this, n || r() }, t.prototype.resetAppliedScalingAndGetBoundingClientRect = function () { var t = this.elt.getBoundingClientRect(), e = { x: t.width / this.elt.offsetWidth, y: t.height / this.elt.offsetHeight }; if (e.x === this.appliedScale.x && e.y === this.appliedScale.y) return t; var s = i(this.elt).children(".dcg-wrapper")[0]; return s && (this.appliedScale = e, i(s).css({ transform: "scale(" + 1 / this.appliedScale.x + "," + 1 / this.appliedScale.y + ")", width: 100 * this.appliedScale.x + "%", height: 100 * this.appliedScale.y + "%", "transform-origin": "0 0" })), t }, t.prototype.detectAndEnqueueEvent = function () { if (!this.destroyed) { var t = !0; if (document.body && document.body.contains(this.elt)) { var i = this.resetAppliedScalingAndGetBoundingClientRect(); t = i.top > window.innerHeight || i.bottom < 0 || i.left > window.innerWidth || i.right < 0, this.lastSize ? i.width === this.lastSize.width && i.height === this.lastSize.height || (this.lastSize.width = i.width, this.lastSize.height = i.height, this.queuedEvent = { type: "resized", target: this.elt, size: e.__assign({}, this.lastSize), isOffscreen: t }) : (this.lastSize = { width: i.width, height: i.height }, this.queuedEvent = { type: "added", target: this.elt, size: e.__assign({}, this.lastSize), isOffscreen: t }) } else this.lastSize && (this.lastSize = void 0, this.queuedEvent = { type: "removed", target: this.elt, isOffscreen: !0 }); t !== this.lastOffscreen && (this.lastOffscreen = t, this.queuedEvent || (this.queuedEvent = { type: "offscreen-noop", target: this.elt, isOffscreen: t })) } }, t.prototype.dispatchQueuedEvent = function () { var t = this.queuedEvent; t && (this.queuedEvent = void 0, this.cb(t)) }, t.prototype.checkForChanges = function () { this.detectAndEnqueueEvent(), this.dispatchQueuedEvent() }, t.prototype.destroy = function () { for (var t in this.stopWatching(), this) this.hasOwnProperty(t) && delete this[t]; this.destroyed = !0 }, t }(); t.default = a });
define('graphing/compute-async-screenshot-bounds', ["require", "exports", "lib/console"], function (require, t, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.computeBoundsFromScreenshotOpts = void 0, t.computeBoundsFromScreenshotOpts = function (t) { var e = t.mode, i = t.width, r = t.height, h = t.currentBounds, p = t.graphpaperAspectRatio, f = t.mathAspectRatio, m = t.mathBounds, l = i / r, b = h.left + h.width / 2, g = h.bottom + h.height / 2; if (void 0 === m.left != (void 0 === m.right) || void 0 === m.bottom != (void 0 === m.top)) return o.warn('asyncScreenshot: cannot specify "left" bound without "right" or "bottom" bound without "top". Got: ' + m), h; var n, d, s, u, c, a, v, w, y, x = void 0 !== m.left && void 0 !== m.right, B = void 0 !== m.bottom && void 0 !== m.top, O = x && B; switch (e) { case "stretch": return O ? m : x ? { left: m.left, right: m.right, bottom: h.bottom, top: h.top } : B ? { left: h.left, right: h.right, bottom: m.bottom, top: m.top } : h; case "contain": return O ? (s = m.right - m.left, u = m.top - m.bottom, c = { x: m.left + s / 2, y: m.bottom + u / 2 }, l > s / u ? (n = (d = u / r) * f, { left: c.x - n * i / 2, right: c.x + n * i / 2, bottom: m.bottom, top: m.top }) : (d = (n = s / i) / f, { left: m.left, right: m.right, bottom: c.y - d * r / 2, top: c.y + d * r / 2 })) : x ? (a = m.right - m.left, v = m.left + a / 2, l > a / h.height ? { left: v - (n = (d = h.height / r) * f) * i / 2, right: v + n * i / 2, bottom: h.bottom, top: h.top } : (d = (n = a / i) / f, { left: m.left, right: m.right, bottom: g - d * r / 2, top: g + d * r / 2 })) : B ? (w = m.top - m.bottom, y = m.bottom + w / 2, l > h.width / w ? { left: b - (n = (d = w / r) * f) * i / 2, right: b + n * i / 2, bottom: m.bottom, top: m.top } : (d = (n = h.width / i) / f, { left: h.left, right: h.right, bottom: y - d * r / 2, top: y + d * r / 2 })) : l > p ? { left: b - (n = (d = h.height / r) * f) * i / 2, right: b + n * i / 2, bottom: h.bottom, top: h.top } : (d = (n = h.width / i) / f, { left: h.left, right: h.right, bottom: g - d * r / 2, top: g + d * r / 2 }); case "preserveX": return O ? (s = m.right - m.left, u = m.top - m.bottom, c = { x: m.left + s / 2, y: m.bottom + u / 2 }, s / u, d = (n = s / i) / f, { left: m.left, right: m.right, bottom: c.y - d * r / 2, top: c.y + d * r / 2 }) : B ? (w = m.top - m.bottom, y = m.bottom + w / 2, h.width / w, d = (n = h.width / i) / f, { left: h.left, right: h.right, bottom: y - d * r / 2, top: y + d * r / 2 }) : x ? (d = (n = (a = m.right - m.left) / i) / f, { left: m.left, right: m.right, bottom: g - d * r / 2, top: g + d * r / 2 }) : (d = (n = (a = h.right - h.left) / i) / f, { left: h.left, right: h.right, bottom: g - d * r / 2, top: g + d * r / 2 }); case "preserveY": return O ? ((s = m.right - m.left) / (u = m.top - m.bottom), n = (d = u / r) * f, { left: (c = { x: m.left + s / 2, y: m.bottom + u / 2 }).x - n * i / 2, right: c.x + n * i / 2, bottom: m.bottom, top: m.top }) : x ? (a = m.right - m.left, v = m.left + a / 2, a / h.height, { left: v - (n = (d = h.height / r) * f) * i / 2, right: v + n * i / 2, bottom: h.bottom, top: h.top }) : B ? { left: b - (n = (d = (w = m.top - m.bottom) / r) * f) * i / 2, right: b + n * i / 2, bottom: m.bottom, top: m.top } : { left: b - (n = (d = (w = h.top - h.bottom) / r) * f) * i / 2, right: b + n * i / 2, bottom: h.bottom, top: h.top }; default: return h } } });
define('dcgview-helpers/mathquill-proxy', ["require", "exports", "dcgview-helpers/mathquill-view"], function (require, t, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.MathQuillProxy = void 0; var i = function () { function t(t) { this.mq = t, this.id = t.id, this.data = t.data } return t.prototype.simulateUserChangedLatex = function () { e.default.simulateUserChangedLatex(this.mq) }, t.prototype.simulateKeypress = function (t) { e.default.simulateKeypress(this.mq, t) }, t.prototype.latex = function (t) { return void 0 === t ? this.mq.latex() : (this.mq.latex(t), this.simulateUserChangedLatex(), this) }, t.prototype.reflow = function () { this.mq.reflow() }, t.prototype.el = function () { return this.mq.el() }, t.prototype.getAriaLabel = function () { return this.mq.getAriaLabel() }, t.prototype.setAriaLabel = function (t) { return this.mq.setAriaLabel(t) }, t.prototype.html = function () { return this.mq.html() }, t.prototype.mathspeak = function () { return this.mq.mathspeak() }, t.prototype.text = function () { return this.mq.text() }, t.prototype.selection = function () { return this.mq.selection() }, t.prototype.select = function () { return this.mq.select(), this }, t.prototype.moveToRightEnd = function () { return this.mq.moveToRightEnd(), this }, t.prototype.moveToLeftEnd = function () { return this.mq.moveToLeftEnd(), this }, t.prototype.cmd = function (t) { return this.mq.cmd(t), this.simulateUserChangedLatex(), this }, t.prototype.write = function (t) { return this.mq.write(t), this.simulateUserChangedLatex(), this }, t.prototype.keystroke = function (t) { return this.simulateKeypress(t), this }, t.prototype.typedText = function (t) { return this.mq.typedText(t), this.simulateUserChangedLatex(), this }, t.prototype.clearSelection = function () { return this.mq.clearSelection(), this }, t.prototype.getAriaPostLabel = function () { return this.mq.getAriaPostLabel() }, t.prototype.setAriaPostLabel = function (t, e) { return this.mq.setAriaPostLabel(t, e), this }, t.prototype.blur = function () { return this.mq.blur(), this }, t.prototype.focus = function () { return this.mq.focus(), this }, t.prototype.revert = function () { return this.mq.revert() }, t.prototype.ignoreNextMousedown = function (t) { return this.mq.ignoreNextMousedown(t), this }, t.prototype.clickAt = function (t, e, i) { return this.mq.clickAt(t, e, i), this }, t }(); t.MathQuillProxy = i });
define('main/shared-worker-pool', ["require", "exports", "worker/workerpool", "lib/urlparser"], function (require, e, r, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var t = o.getParameter(location.search, "nworkers"), a = 4; t && (a = parseInt(t, 10)), e.default = new r(a) });
define('graphing-calc/json/config-options', ["require", "exports", "tslib", "core/lib/color-helpers", "lib/console", "main/font_sizes", "expressions/colors", "expressions/image_file_to_data_url", "core/lib/deepCopy", "api/util"], function (require, e, o, a, s, n, t, i, r, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.validateConfigOptions = e.isConfigOption = e.publicConfigOptions = void 0; var p = { keypad: !0, graphpaper: !0, expressions: !0, settingsMenu: !0, zoomButtons: !0, showResetButtonOnGraphpaper: !1, expressionsTopbar: !0, capExpressionSize: !1, pointsOfInterest: !0, trace: !0, border: !0, lockViewport: !1, expressionsCollapsed: !1, administerSecretFolders: !1, advancedStyling: !1, images: !0, imageUploadCallback: i.imageFileToDataURL, folders: !0, notes: !0, sliders: !0, links: !0, qwertyKeyboard: !0, restrictedFunctions: !1, forceEnableGeometryFunctions: !1, pasteGraphLink: !1, pasteTableData: !0, degreeMode: !1, clearIntoDegreeMode: !1, autosize: !0, plotSingleVariableImplicitEquations: !0, plotImplicits: !0, plotInequalities: !0, colors: { RED: t.RED, BLUE: t.BLUE, GREEN: t.GREEN, ORANGE: t.ORANGE, PURPLE: t.PURPLE, BLACK: t.BLACK }, invertedColors: !1, functionDefinition: !0, projectorMode: !1, decimalToFraction: !0, fontSize: n.MEDIUM, language: "en", backgroundColor: "#fff", textColor: "#000", distributions: !0, brailleMode: "none", sixKeyInput: !1, brailleControls: !0, zoomFit: !0, forceLogModeRegressions: !1, actions: "auto", audio: !0 }; e.publicConfigOptions = Object.keys(p); var c = { showHamburger: !1, disableScrollFix: !1, branding: !0, redrawSlowly: !1, onlyTraceSelected: !1, disableMouseInteractions: !1, nativeOnscreenKeypad: !1, plaidMode: !1, pasteGraphLinkCallback: void 0, editOnWeb: !1, crossOriginSaveTest: !1, enableTabindex: !0, audioTraceReverseExpressions: !1, transparentBackground: !1, pauseWhenOffscreen: !1 }, d = { solutions: !0, menus: !0, singleVariableSolutions: !0, clickableObjects: !1 }, u = o.__assign(o.__assign({}, p), c); e.isConfigOption = function (e) { return !!p.hasOwnProperty(e) || (!!c.hasOwnProperty(e) || !!d.hasOwnProperty(e)) }, e.validateConfigOptions = function (e) { var o = r.default(u); for (var n in e) o.hasOwnProperty(n) && (o[n] = e[n]); return a.isValidHexColor(o.backgroundColor) || (o.backgroundColor = u.backgroundColor, s.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)")), a.isValidHexColor(o.textColor) || (o.textColor = u.textColor, s.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)")), !0 !== o.actions && !1 !== o.actions && "auto" !== o.actions && (o.actions = u.actions, s.warn("Invalid actions setting. Must be true, false, or 'auto'.")), void 0 === e.zoomButtons && (o.graphpaper && !o.lockViewport || (o.zoomButtons = !1)), void 0 === e.images && (o.graphpaper || (o.images = !1)), e.hasOwnProperty("menus") && (s.warn("As of API version 0.4, the 'menus' option is deprecated and has been split into 'settingsMenu' (boolean) and 'expressionsTopbar' (boolean)."), e.hasOwnProperty("settingsMenu") || (o.settingsMenu = !!e.menus), e.hasOwnProperty("expressionsTopbar") || (o.expressionsTopbar = !!e.menus)), e.hasOwnProperty("solutions") && (s.warn("As of API v1.0, the 'solutions' option is deprecated and has been replaced with 'pointsOfInterest' (boolean)."), e.hasOwnProperty("pointsOfInterest") || (o.pointsOfInterest = !!e.solutions)), e.hasOwnProperty("singleVariableSolutions") && s.warn("As of API v1.0, the 'singleVariableSolutions' has been removed. The calculator no longer displays solutions to single variable equations."), e.hasOwnProperty("clickableObjects") && (s.warn("As of API v1.7, the 'clickableObjects' option is deprecated and has been replaced with 'actions'."), !0 !== e.clickableObjects || e.hasOwnProperty("actions") || (o.actions = !0)), o.graphpaper || (o.expressionsCollapsed && (o.expressionsCollapsed = !1, s.warn("Desmos API initialized with bad options. graphpaper: false and expressionsCollapsed: true are incompatible. Proceeding with expressionsCollapsed: false.")), o.zoomButtons && (o.zoomButtons = !1, s.warn("Desmos API initialized with bad options. graphpaper: false and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")), o.showResetButtonOnGraphpaper && (o.showResetButtonOnGraphpaper = !1, s.warn("Desmos API initialized with bad options. graphpaper: false and showResetButtonOnGraphpaper: true are incompatible. Proceeding with showResetButtonOnGraphpaper: false."))), o.lockViewport && o.zoomButtons && (o.zoomButtons = !1, s.warn("Desmos API initialized with bad options. lockViewport: true and zoomButtons: true are incompatible. Proceeding with zoomButtons: false.")), !1 !== o.notes && !1 !== o.folders && !1 !== o.images || !0 !== o.pasteGraphLink || (o.pasteGraphLink = !1, s.warn("Desmos API initialized with bad options. pasteGraphLink: true is incompatible with disabling the creation of note, folder, or image expressions. Proceeding with pasteGraphLink: false.")), o.language && (o.language = l.validateLanguage(o.language)), o } });
define('api/graphing', ["require", "exports", "tslib", "lib/i18n", "main/calc_embed", "core/lib/deepCopy", "underscore_model", "core/math/recttransformation", "lib/dom-change-detector", "graphing/compute-async-screenshot-bounds", "graphing-calc/api/sanitize-expression", "dcgview-helpers/mathquill-view", "dcgview-helpers/mathquill-proxy", "lib/console", "underscore", "main/shared-clock-bus", "main/shared-worker-pool", "core/graphing-calc/json/graph-settings", "graphing-calc/json/config-options", "core/lib/random-seed", "../lib/underscore-shim"], function (require, e, t, o, r, n, i, s, a, p, c, l, h, d, u, g, f, y, m, v, b) { "use strict"; function x(e, t) { var o = {}, r = {}; for (var n in e) m.isConfigOption(n) ? o[n] = e[n] : y.isGraphSetting(n) ? r[n] = e[n] : t || d.warn("Unrecognized setting: " + n + ". Ignoring."); return { configOptions: o, settingsOptions: r } } function _(e, t) { var o = {}; return t.hasOwnProperty("x") && (o.x = e.mapX(t.x)), t.hasOwnProperty("y") && (o.y = e.mapY(t.y)), o } var w; Object.defineProperty(e, "__esModule", { value: !0 }); var S = [], C = !1; function O() { if (!C) { for (var e; (e = S.shift()) && e.api._destroyed;); if (e) { var t = e; C = !0; var o = t.options, r = t.mathBounds, n = t.state, i = t.callback; w || (w = new B); var s = w; s.setState(n), s.setMathBounds(r);["majorAxisOpacity", "minorAxisOpacity", "axisLineOffset", "axisLineWidth", "labelSize", "graphLineWidth", "pointLineWidth"].forEach(function (e) { "axisLineWidth" === e ? s._calc.grapher.settings.setProperty(e, t.api._calc.grapher.settings[e]) : s._calc.grapher.settings[e] = t.api._calc.grapher.settings[e] }); var a = s._calc.evaluator, p = function () { s._calc.grapher.asyncScreenshot(o, function (e) { C = !1, O(), i(e) }) }, c = t.api._calc.controller, l = g.subscribe(function () { c.areAnyImagesLoading() || (g.unsubscribe(l), a.notifyWhenSynced(p)) }) } } } var B = function (e) { function b(t, o, n) { var i = e.call(this) || this; if (i._destroyed = !1, i.isOffscreen = !1, !(i instanceof b)) return new b(t, o, n); var s = x(o || {}, !0), p = m.validateConfigOptions(s.configOptions), c = s.settingsOptions; return i._calc = new r.default(t, f.default, p), i._calc.interceptTouch(), i.controller = i._calc.controller, i.controller.onEventsEmitted = function (e) { var t = i.controller.getSelectedItem(); i.setProperty("isAnyExpressionSelected", !!t), i.setProperty("selectedExpressionId", t ? t.id : void 0), i.setProperty("expressionAnalysis", i.controller.getExpressionAnalysis()); var o = l.default.getFocusedMathquill(); for (var r in i.setProperty("focusedMathQuill", o ? new h.MathQuillProxy(o) : void 0), e) e.hasOwnProperty(r) && e[r] && i.triggerEvent(r, void 0) }, i._calc.graphpaperBounds.observeAndSync("mathCoordinates", i._syncGraphpaperBounds.bind(i)), i._calc.graphpaperBounds.observeAndSync("pixelCoordinates", i._syncGraphpaperBounds.bind(i)), i.colors = i.controller.getColors(), i._initGraphSettings(), i.updateSettings(c), i._sharedClockBusToken = g.subscribe(function (e) { var t = i._calc.grapher.settings.config.pauseWhenOffscreen && i.isOffscreen; i._calc.tick(e, t) }), i.domChangeDetector = new a.default(t, function (e) { switch (i.isOffscreen = e.isOffscreen, e.type) { case "offscreen-noop": break; case "added": i._calc.resize(e.size); break; case "removed": break; case "resized": i._calc.resize(e.size) } }), p.autosize ? i.domChangeDetector.startWatching() : i.domChangeDetector.checkForChanges(), "function" == typeof n && n(i), i } return t.__extends(b, e), b.prototype.destroy = function () { function e(e) { d.warn("You've destroyed this API instance. You can no longer call ." + e + "()") } for (var t in this._calc.destroy(), this.controller.onEventsEmitted = function () { }, g.unsubscribe(this._sharedClockBusToken), this.domChangeDetector.destroy(), this) "function" == typeof this[t] ? this[t] = e.bind(this, t) : this.hasOwnProperty(t) && delete this[t]; this.destroy = function () { }, this._destroyed = !0 }, b.prototype._syncGraphpaperBounds = function () { var e = this; this.controller.runAfterDispatch(function () { e.setProperty("graphpaperBounds", { mathCoordinates: e._calc.graphpaperBounds.mathCoordinates, pixelCoordinates: e._calc.graphpaperBounds.pixelCoordinates }) }) }, b.prototype._initGraphSettings = function () { var e = this, t = new i.UnderscoreModel; this.settings = this.graphSettings = t, y.publicGraphSettings.forEach(function (o) { e._calc.grapher.settings.observeAndSync(o, function () { e.controller.runAfterDispatch(function () { t.setProperty(o, e._calc.grapher.settings[o]) }) }) }), m.publicConfigOptions.forEach(function (o) { e._calc.grapher.settings.config.observeAndSync(o, function () { e.controller.runAfterDispatch(function () { t.setProperty(o, e._calc.grapher.settings.config[o]) }) }) }) }, b.prototype.updateSettings = function (e) { var t = x(e, !1), o = t.configOptions, r = t.settingsOptions; u.isEmpty(o) || this._calc.setOptions(o), u.isEmpty(r) || this._calc.grapher.settings.setGraphSettings(r), this.notifyControllerOfAPICall() }, b.prototype.setGraphSettings = function (e) { d.warn("As of API v0.8 the 'setGraphSettings' method is deprecated and has been renamed 'updateSettings.'"), this.updateSettings(e), this.setGraphSettings = this.updateSettings, this.notifyControllerOfAPICall() }, b.prototype.fetchLanguage = function (e) { return o.fetchLanguage(e) }, b.prototype.setDefaultState = function (e) { this._calc.grapher.settings.setProperty("defaultState", e), this.notifyControllerOfAPICall() }, b.prototype.mathToPixels = function (e) { return _(s.RT.fromRects(this.graphpaperBounds.mathCoordinates, this.graphpaperBounds.pixelCoordinates), e) }, b.prototype.pixelsToMath = function (e) { return _(s.RT.fromRects(this.graphpaperBounds.pixelCoordinates, this.graphpaperBounds.mathCoordinates), e) }, b.prototype.notifyControllerOfAPICall = function () { this.controller.dispatch({ type: "render" }) }, b.prototype.setExpression = function (e) { var t = this.controller.getItemModel(e.id), o = t && t.type, r = c.validateItem(e, o, this.controller); if (r) if (o) this.controller.dispatch({ type: "set-expression-properties-from-api", id: r.id, properties: r }); else { if ("image" === r.type) return; this.controller.dispatch({ type: "add-item-to-end-from-api", state: r }) } }, b.prototype.setExpressions = function (e) { e.forEach(this.setExpression.bind(this)) }, b.prototype.removeExpression = function (e) { var t = e.id.toString(); this.controller.dispatch({ type: "remove-item-by-id", id: t }) }, b.prototype.removeExpressions = function (e) { e.forEach(this.removeExpression.bind(this)) }, b.prototype.removeSelected = function () { var e = this.controller.getSelectedItem(); if (e) { var t = e.id; return this.controller.dispatch({ type: "remove-item-by-id", id: t }), t } }, b.prototype.setMathBounds = function (e) { e && e.left < e.right && e.bottom < e.top ? this._calc.setViewport([e.left, e.right, e.bottom, e.top]) : d.warn("Invalid bounds argument. Expected a bounds object with bounds.bottom < bounds.top, and bounds.left < bounds.right. Got " + JSON.stringify(e)), this.notifyControllerOfAPICall() }, b.prototype.setViewport = function (e) { 4 == e.length && e[1] > e[0] && e[3] > e[2] ? this._calc.setViewport(e) : d.warn("Invalid viewport.  Expected [xmin, xmax, ymin, ymax].  Got " + e), this.notifyControllerOfAPICall() }, b.prototype.resize = function () { this.domChangeDetector.checkForChanges() }, b.prototype.getState = function (e) { return this.controller.getState(e) }, b.prototype.getExpressions = function () { return this.getState({ stripDefaults: !1 }).expressions.list.map(c.sanitizeItem) }, b.prototype.setBlank = function (e) { this.controller.dispatch({ type: "set-blank", opts: e || {} }) }, b.prototype.setState = function (e, t) { this.controller.dispatch({ type: "set-state", state: e, opts: t || {} }) }, b.prototype.undo = function () { this.controller.dispatch({ type: "undo" }) }, b.prototype.redo = function () { this.controller.dispatch({ type: "redo" }) }, b.prototype.clearHistory = function () { this.controller.dispatch({ type: "clear-undoredo-history" }) }, b.prototype.newRandomSeed = function () { this.updateSettings({ randomSeed: v.default() }) }, b.prototype.screenshot = function (e) { return e || (e = {}), e = this._validateBrailleScreenshotOptions(e), this._calc.grapher.screenshot(e) }, b.prototype._getMathAspectRatio = function () { var e = this.graphpaperBounds.mathCoordinates, t = this._calc.grapher.getProjection().pixelCoordinates, o = t.right - t.left, r = t.bottom - t.top; return e.width / o / (e.height / r) }, b.prototype.isProjectionUniform = function () { return !!this._calc.grapher.getProjection().settings.squareAxes }, b.prototype._validateBrailleScreenshotOptions = function (e) { var t = (e = n.default(e)).braille; if (t) { var o = t.embosserModel; if (!o) return d.warn("Screenshot braille options requires an embosser model to be specified. "), d.warn("Continuing with non-braille screenshot."), delete e.braille, e; if ("etc" === o && (t.embosserModel = "etc11"), "vpmax" === o && (t.embosserModel = "vpmax11"), "etc8" !== t.embosserModel && "etc11" !== t.embosserModel && "vpmax8" !== t.embosserModel && "vpmax11" !== t.embosserModel) return d.warn('Unknown screenshot braille embosser model. Valid models are "etc" and "vpmax".'), d.warn("Continuing with non-braille screenshot."), delete e.braille, e; "nemeth" !== t.brailleMode && "ueb" !== t.brailleMode && (d.warn("Screenshot options braille.brailleMode must be nemeth or ueb. Proceeding with nemeth."), t.brailleMode = "nemeth"), e.width && (d.warn("Screenshot width option is ignored when exporting Braille."), delete e.width), e.height && (d.warn("Screenshot height option is ignored when exporting Braille."), delete e.height), e.targetPixelRatio && (d.warn("Screenshot targetPixelRatio option is ignored when exporting Braille."), delete e.targetPixelRatio), e.preserveAxisNumbers && (d.warn("Screenshot preserveAxisNumbers option is ignored when exporting Braille."), delete e.preserveAxisNumbers) } return e }, b.prototype._validateAsyncScreenshotOpts = function (e) { var o = (e = n.default(e)).mode || "contain", r = e.width || e.height || this.graphpaperBounds.pixelCoordinates.width, i = e.height || e.width || this.graphpaperBounds.pixelCoordinates.height, s = e.targetPixelRatio || 1; s < 1 && (s = 1); var a = e.preserveAxisNumbers; e.hasOwnProperty("format") || (e.svg ? (e.format = "svg", delete e.svg) : e.format = "png"); var c = e.mathBounds || {}, l = this._getMathAspectRatio(), h = this.graphpaperBounds.pixelCoordinates.width / this.graphpaperBounds.pixelCoordinates.height, d = p.computeBoundsFromScreenshotOpts({ mode: o, width: r, height: i, currentBounds: this.graphpaperBounds.mathCoordinates, graphpaperAspectRatio: h, mathAspectRatio: l, mathBounds: c }); return { opts: t.__assign(t.__assign({}, e), { width: r, height: i, targetPixelRatio: s, preserveAxisNumbers: a }), mathBounds: d } }, b.prototype.asyncScreenshot = function (e, t) { if (arguments.length) { if (1 === arguments.length) { if ("function" != typeof e) return void d.warn("asyncScreenshot expects a callback"); t = e, e = {} } e || (e = {}), e = this._validateBrailleScreenshotOptions(e); var o = this._validateAsyncScreenshotOpts(e), r = o.opts, n = o.mathBounds; S.push({ api: this, options: r, mathBounds: n, state: this.getState(), callback: t }), O() } else d.warn("asyncScreenshot expects a callback") }, b.prototype.setOptions = function (e) { var t = this._calc.setOptions(e); return this.notifyControllerOfAPICall(), t }, b.prototype.focusFirstExpression = function () { var e = this.controller.getItemModelByIndex(0); e && this.controller.dispatch({ type: "move-focus-to-item", id: e.id, where: "end" }) }, b.prototype.HelperExpression = function (e) { var t = e && e.latex || "", o = new i.UnderscoreModel; return o.latex = t, this.controller.dispatch({ type: "add-helper-expression", state: { type: "helper-expression", id: this.controller.generateId(), latex: t, proxy: o } }), o }, b }(b.UnderscoreModelShim); e.default = B });
define('main/calc_headless', ["require", "exports", "main/graph_settings", "main/evaluator", "underscore_model", "main/controller"], function (require, t, e, o, i, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.HeadlessCalc = void 0; var r = function () { function t(t, r) { var a = this, s = new e; for (var l in r) s.config.setProperty(l, r[l]); this.controller = new n.default(s); var c = new o.Evaluator(t); this.controller.setEvaluator(c), c.readEvaluatorConfig = function () { return { evaluationMode: "graphing", globalRandomSeed: s.randomSeed, degreeMode: s.degreeMode, restrictedFunctions: s.config.restrictedFunctions, distributions: s.config.distributions, pointsOfInterest: s.config.pointsOfInterest, plotSingleVariableImplicitEquations: s.config.plotSingleVariableImplicitEquations, plotImplicits: s.config.plotImplicits, plotInequalities: s.config.plotInequalities, sliders: s.config.sliders, actions: s.config.actions } }, c.onEvaluatorResults = function (t) { a.controller.dispatch({ type: "on-evaluator-changes", changes: t.evaluationStates, timingData: t.timingData, eventUpdates: t.eventUpdates }) }; var d = new i.UnderscoreModel; d.setProperties({ pixelCoordinates: { top: 0, bottom: 0, left: 0, right: 0, width: 0, height: 0 }, mathCoordinates: { top: 0, bottom: 0, left: 0, right: 0, width: 0, height: 0 } }), this.graphpaperBounds = d, this.evaluator = c, this.setBlank() } return t.prototype.setBlank = function (t) { this.controller.dispatch({ type: "set-blank", opts: t }) }, t.prototype.tick = function () { this.evaluator.tick() }, t.prototype.destroy = function () { this.evaluator.destroy() }, t }(); t.HeadlessCalc = r });
define('api/headless', ["require", "exports", "main/calc_headless", "graphing-calc/json/config-options", "main/shared-clock-bus", "main/shared-worker-pool", "graphing-calc/api/sanitize-expression", "underscore_model", "lib/console"], function (require, t, e, o, s, i, r, n, p) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function t() { var r = this; if (!(this instanceof t)) return new t; this._calc = new e.HeadlessCalc(i.default, o.validateConfigOptions({})), this.controller = this._calc.controller, this._sharedClockBusToken = s.subscribe(function () { r._calc.tick() }) } return t.prototype.destroy = function () { function t(t) { p.warn("You've destroyed this API instance. You can no longer call ." + t + "()") } for (var e in this._calc.destroy(), s.unsubscribe(this._sharedClockBusToken), this) "function" == typeof this[e] ? this[e] = t.bind(this, e) : this.hasOwnProperty(e) && delete this[e]; this.destroy = function () { } }, t.prototype.setExpression = function (t) { var e = this.controller.getItemModel(t.id), o = e && e.type, s = r.validateItem(t, o, this.controller); if (s) if (o) this.controller.dispatch({ type: "set-expression-properties-from-api", id: s.id, properties: s }); else { if ("image" === s.type) return; this.controller.dispatch({ type: "add-item-to-end-from-api", state: s }) } }, t.prototype.setExpressions = function (t) { t.forEach(this.setExpression.bind(this)) }, t.prototype.removeExpression = function (t) { var e = t.id.toString(); this.controller.dispatch({ type: "remove-item-by-id", id: e }) }, t.prototype.removeExpressions = function (t) { t.forEach(this.removeExpression.bind(this)) }, t.prototype.getState = function (t) { return this.controller.getState(t) }, t.prototype.getExpressions = function () { return this.getState({ stripDefaults: !1 }).expressions.list.map(r.sanitizeItem) }, t.prototype.setBlank = function (t) { this.controller.dispatch({ type: "set-blank", opts: t || {} }) }, t.prototype.setState = function (t, e) { this.controller.dispatch({ type: "set-state", state: t, opts: e || {} }) }, t.prototype.HelperExpression = function (t) { var e = t && t.latex || "", o = new n.UnderscoreModel; return o.latex = e, this.controller.dispatch({ type: "add-helper-expression", state: { type: "helper-expression", id: this.controller.generateId(), latex: e, proxy: o } }), o }, t.prototype.resize = function () { }, t }(); t.default = a });
define('api/abstract', ["require", "exports", "lib/console", "underscore_model", "ipad.scrollfix", "lib/dom-change-detector"], function (require, e, t, o, n, i) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = function () { function e(e) { if (this.rootElt = e, this.eventModel = new o.UnderscoreModel, !e) throw new Error("must pass an HTMLElement to the API") } return e.prototype.setupDomChangeDetector = function (e) { var t = this; this.autoSize = e, n.limitScrollOnElement(this.rootElt), this.domChangeDetector = new i.default(this.rootElt, function (e) { switch (e.type) { case "added": t.view = t.onCreateView(), t.onResizeView(e.size); break; case "removed": t.onDestroyView(), t.view = void 0; break; case "resized": t.onResizeView(e.size) } }), !1 !== this.autoSize ? this.domChangeDetector.startWatching() : this.domChangeDetector.checkForChanges() }, e.prototype.detach = function () { t.warn(".detach() is deprecated. It should no longer be necessary") }, e.prototype.destroy = function () { function e(e) { t.warn("You've destroyed this API instance. You can no longer call ." + e + "()") } for (var o in this.view && this.onDestroyView(), this.domChangeDetector.destroy(), this) "function" == typeof this[o] ? this[o] = e.bind(this, o) : this.hasOwnProperty(o) && delete this[o]; this.destroy = function () { } }, e.prototype.resize = function () { this.domChangeDetector.checkForChanges() }, e.prototype.updateView = function () { this.view && document.body && document.body.contains(this.rootElt) && this.view.update() }, e.prototype.triggerEvent = function (e, t) { this.eventModel.triggerEvent(e, t) }, e.prototype.observeEvent = function (e, t) { this.eventModel.observeEvent(e, t) }, e.prototype.unobserveEvent = function (e) { this.eventModel.unobserveEvent(e) }, e }(); e.default = r });
define('immutable-store', ['require', 'underscore', 'core/lib/deepCopy'], function (require) { "use strict"; var t = require("underscore"), e = require("core/lib/deepCopy").default; function s(e) { return t.clone(e) } function i(t) { this.setState(t) } return i.prototype.setState = function (t) { this.state = t }, i.prototype.getState = function () { return this.state }, i.prototype.set = function (t, e) { if (1 !== arguments.length) { if ("string" == typeof t) return this.state = s(this.state), void (this.state[t] = e); var i, a = t.length - 2, r = t[a + 1]; this.state = i = s(this.state); for (var n = 0; n <= a; n++) { var h = t[n]; i = i[h] = s(i[h]) } i[r] = e } else this.state = t }, i.prototype.deepMutate = function (t, i) { if (1 === arguments.length) return i = t, this.state = e(this.state), void i(this.state); if ("string" == typeof t) return this.state = s(this.state), this.state[t] = e(this.state[t]), void i(this.state[t]); for (var a = t.length - 2, r = t[a + 1], n = this.state = s(this.state), h = 0; h <= a; h++) { var o = t[h]; n = n[o] = s(n[o]) } i(n = n[r] = e(n[r])) }, i.prototype.shallowMutate = function (t, e) { if (1 === arguments.length) return e = t, this.state = s(this.state), void e(this.state); if ("string" == typeof t) return this.state = s(this.state), this.state[t] = s(this.state[t]), void e(this.state[t]); for (var i = t.length - 1, a = this.state = s(this.state), r = 0; r <= i; r++) { var n = t[r]; a = a[n] = s(a[n]) } e(a) }, i.areShallowEqual = function (t, e) { }, i.areDeepEqual = function (t, e) { }, { default: i } });
define('basic/model', ["require", "exports", "immutable-store", "main/shared-clock-bus", "core/lib/label", "main/evaluator", "core/lib/label", "underscore"], function (require, t, e, o, s, i, n, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function () { function t(t) { var s = this, i = t.evaluationMode, n = t.additionalFunctions, r = t.functionDefinition, a = t.replaceRoundWithReciprocal, u = t.workerPool; this._evaluations = {}, this._nextObjectId = 0, this.store = new e.default({ expressions: { 1: { id: "1", latex: "", braille: "", type: "latex", displayAsFraction: !1 } }, order: ["1"], settings: { degreeMode: !1 }, ui: { focus: void 0 } }), this.evaluationMode = i, this.additionalFunctions = n, this.functionDefinition = r, this.replaceRoundWithReciprocal = a, this.workerPool = u, this._setupEvaluator(), this.clear(), this._sharedClockBusToken = o.subscribe(function () { s._evaluator.tick() }) } return t.prototype.isSingleExpression = function () { return "singleExpressionScientific" === this.evaluationMode || "singleExpressionFourFunction" === this.evaluationMode }, t.prototype.destroy = function () { o.unsubscribe(this._sharedClockBusToken) }, t.prototype.generateObjectId = function () { return (this._nextObjectId++).toString() }, t.prototype.updateNextObjectId = function () { var t = this.store.getState().order; this._nextObjectId = 0; for (var e = /^[0-9]+$/, o = 0, s = t; o < s.length; o++) { var i = s[o]; if (e.test(i)) { var n = parseInt(i, 10); n >= this._nextObjectId && (this._nextObjectId = n + 1) } } }, t.prototype.clearShouldDebounceUndoRedo = function () { this._shouldDebounceUndoRedo = !1 }, t.prototype.markShouldDebounceUndoRedo = function () { this._shouldDebounceUndoRedo = !0 }, t.prototype.getShouldDebounceUndoRedo = function () { return this._shouldDebounceUndoRedo }, t.prototype.clearCachedBrailleValues = function () { for (var t = 0, e = this.getExpressionOrder(); t < e.length; t++) { var o = e[t]; this.store.set(["expressions", o, "braille"], "") } }, t.prototype.getState = function () { return this.store.getState() }, t.prototype.getPersistedState = function () { var t = this.getState(), e = t.expressions, o = t.order, s = t.settings; return { expressions: { list: o.map(function (t) { var o = e[t]; return { id: o.id, latex: o.latex, displayAsFraction: o.displayAsFraction } }) }, settings: s } }, t.prototype.setState = function (t) { this.store.set(t), this._updateIndexes(), this.updateNextObjectId() }, t.prototype.setStateFromAPI = function (t) { var e = [], o = {}; t.expressions.list.forEach(function (t) { e.push(t.id), o[t.id] = { id: t.id, latex: t.latex, braille: "", type: "latex", displayAsFraction: !!t.displayAsFraction } }), this.setState({ expressions: o, order: e, settings: t.settings, ui: { focus: void 0 } }) }, t.prototype.canClear = function () { if (this.getNumberOfExpressions() > 1) return !0; var t = this.getExpressionOrder()[0]; return "" !== this.getExpressionLatex(t) }, t.prototype.clear = function () { this.setState({ expressions: { 1: { id: "1", type: "latex", latex: "", braille: "", displayAsFraction: !1 } }, ui: { focus: void 0 }, order: ["1"], settings: this.getState().settings }) }, t.prototype.getExpressionOrder = function () { return this.store.getState().order }, t.prototype.getNumberOfExpressions = function () { return this.getExpressionOrder().length }, t.prototype.getExpressionById = function (t) { return this.getState().expressions[t] }, t.prototype.getExpressionIndex = function (t) { return this._indexes[t] }, t.prototype._getExpressionByIndex = function (t) { var e = this.getExpressionOrder()[t]; return this.getExpressionById(e) }, t.prototype._updateIndexes = function () { this._indexes = {}; for (var t = 0, e = 0, o = this.getExpressionOrder(); e < o.length; e++) { var s = o[e]; this._indexes[s] = t, t += 1 } this._evaluate() }, t.prototype._usesAnsById = function (t) { return -1 !== this.getExpressionById(t).latex.indexOf("\\operatorname{ans}") }, t.prototype._getPreviousExpById = function (t) { var e = this.getExpressionIndex(t); return this._getExpressionByIndex(e - 1) }, t.prototype.createBlankAfterId = function (t) { if (!this.isSingleExpression() && this.getExpressionById(t).latex) { var e = this.getExpressionIndex(t), o = this.generateObjectId(); this.store.shallowMutate("order", function (t) { t.splice(e + 1, 0, o) }), this.store.shallowMutate("expressions", function (t) { t[o] = { id: o, latex: "", braille: "", type: "latex", displayAsFraction: !1 } }), this._updateIndexes(), this.setFocusedById(o, !0) } }, t.prototype.conditionallyCopyPrevious = function (t) { var e = this._getPreviousExpById(t), o = this.getExpressionById(t); null != e && "" === o.latex && this._usesAnsById(e.id) && this.setLatexById(t, e.latex) }, t.prototype.backspaceAtFrontOfId = function (t) { if ("" === this.getExpressionById(t).latex && 1 !== this.getNumberOfExpressions()) { var e = this.getExpressionIndex(t); this.store.shallowMutate("order", function (t) { t.splice(e, 1) }), this.store.shallowMutate("expressions", function (e) { delete e[t] }), this._updateIndexes(), this._setFocusedByIndex(Math.max(e - 1, 0), !0) } }, t.prototype.setLatexById = function (t, e) { this.store.set(["expressions", t, "latex"], e), this.store.set(["expressions", t, "braille"], ""), "" === e && this.setFractionEvaluation(t, !1), this._evaluate() }, t.prototype.setLatexAndBrailleById = function (t, e, o) { this.store.set(["expressions", t, "latex"], e), this.store.set(["expressions", t, "braille"], o), "" === e && this.setFractionEvaluation(t, !1), this._evaluate() }, t.prototype.setFractionEvaluation = function (t, e) { this.store.set(["expressions", t, "displayAsFraction"], e) }, t.prototype.setLatexOfFocusedExpression = function (t) { var e = this.getFocusedExpressionId(); e && this.setLatexById(e, t) }, t.prototype.isExpressionFocused = function (t) { return this.getFocusedExpressionId() === t }, t.prototype.getExpressionLatex = function (t) { return this.getExpressionById(t).latex }, t.prototype.getExpressionError = function (t) { var e = this._evaluations[t]; return e ? e.error : "" }, t.prototype.getExpressionValue = function (t) { var e = this._evaluations[t]; if (e) return e.value }, t.prototype.getExpressionAns = function (t) { var e = this._evaluations[t]; if (e) return e.ans }, t.prototype.getExpressionAnsId = function (t) { var e = this._evaluations[t]; if (e) return e.ansId }, t.prototype.shouldShowEvaluationForExpression = function (t) { var e = this._evaluations[t]; return !!e && e.showEvaluation }, t.prototype.isRationalizableConstant = function (t) { var e = this._evaluations[t]; return !!e && e.isRationalizableConstant }, t.prototype.canDisplayEvaluationAsFraction = function (t) { var e = this.getExpressionValue(t); return !!e && n.canDisplayAsFraction(e) }, t.prototype._setFocusedByIndex = function (t, e) { var o = this._getExpressionByIndex(t), s = this.store.getState().ui.focus, i = e ? { type: "latex-expression", id: o.id } : void 0; if (!r.isEqual(s, i)) { if (s) { var n = s.id; this.store.deepMutate("expressions", function (t) { var e = t[n]; e && (e.braille = "") }) } (e || this.getFocusedExpressionId() === o.id) && this.store.shallowMutate("ui", function (t) { t.focus = i }) } }, t.prototype.setFocusedById = function (t, e) { var o = this.getExpressionIndex(t); this._setFocusedByIndex(o, e) }, t.prototype.focusPrevById = function (t) { var e = this.getExpressionIndex(t) - 1; e >= 0 && this._setFocusedByIndex(e, !0) }, t.prototype.focusNextById = function (t) { var e = this.getExpressionIndex(t) + 1; e < this.getNumberOfExpressions() ? this._setFocusedByIndex(e, !0) : this.createAtEnd() }, t.prototype.getFocusedExpression = function () { var t = this.getFocusedExpressionId(); return t ? this.getExpressionById(t) : void 0 }, t.prototype.getFocusedExpressionId = function () { var t = this.getState().ui.focus; return t && t.id }, t.prototype.clearFocusedExpression = function () { var t = this.getFocusedExpression(); t && this.setLatexById(t.id, "") }, t.prototype.shouldShowClear = function () { if (1 === this.getNumberOfExpressions()) return !1; var t = this.getFocusedExpression(); return !!t && !!t.latex }, t.prototype.getLastExpression = function () { return this._getExpressionByIndex(this.getNumberOfExpressions() - 1) }, t.prototype.isLastExpressionEmpty = function () { return !!this.getLastExpression().latex }, t.prototype.createAtEnd = function () { this.createBlankAfterId(this.getLastExpression().id) }, t.prototype.focusLastExpression = function () { this._setFocusedByIndex(this.getNumberOfExpressions() - 1, !0) }, t.prototype.focusFirstExpression = function () { this._setFocusedByIndex(0, !0) }, t.prototype.getDegreeMode = function () { return this.getState().settings.degreeMode }, t.prototype.setDegreeMode = function (t) { this.store.set(["settings", "degreeMode"], !!t), this._evaluate() }, t.prototype._cleanupLatex = function (t) { return "=" === (t = s.trimLatex(t)).substr(t.length - 1) && (t = t.substr(0, t.length - 1)), t }, t.prototype._evaluate = function () { var t = this; this._evaluator.clearStatementsAndStartCompleteState(), this.getExpressionOrder().forEach(function (e) { return t._evaluator.addStatement({ id: e, index: t.getExpressionIndex(e), latex: t._cleanupLatex(t.getExpressionLatex(e)), shouldGraph: !1, type: "statement" }) }) }, t.prototype._setupEvaluator = function () { var t = this; this._evaluator = new i.Evaluator(this.workerPool), this._evaluator.readEvaluatorConfig = function () { return { degreeMode: t.getDegreeMode(), evaluationMode: t.evaluationMode, additionalFunctions: t.additionalFunctions, functionDefinition: t.functionDefinition, replaceRoundWithReciprocal: t.replaceRoundWithReciprocal, actions: !1 } }, this._evaluator.onEvaluatorResults = function (e) { var o = e.evaluationStates; for (var s in t._evaluations = {}, o) { var i = o[s]; if (t.getExpressionById(s)) { var r = i.constant_value; void 0 === r && i.zero_values && i.zero_values.length && (r = i.zero_values[0].val); var a = i.hasOwnProperty("constant_value") && n.canDisplayAsFraction(i.constant_value), u = !i.is_evaluable && a, p = !!i.is_evaluable || u || Array.isArray(r); t._evaluations[s] = { error: i.error, ans: void 0, ansId: void 0, value: r, showEvaluation: p, isRationalizableConstant: u } } } for (var d = void 0, c = void 0, l = 0, h = t.getExpressionOrder(); l < h.length; l++) { s = h[l]; var x = t._evaluations[s]; if (d && x) { var f = d.value; "number" == typeof f ? (x.ans = f, x.ansId = c) : Array.isArray(f) && (x.ans = "[...]") } d = x, c = s } "function" == typeof t.onEvaluationUpdate && t.onEvaluationUpdate() } }, t.prototype.reloadState = function () { this.setState(this.getState()) }, t.prototype.getFunctionDefinition = function () { return !!this.functionDefinition }, t.prototype.enableFunctionDefinition = function () { this.functionDefinition = !0, this.reloadState() }, t.prototype.disableFunctionDefinition = function () { this.functionDefinition = !1, this.reloadState() }, t.prototype.getReplaceRoundWithReciprocal = function () { return !!this.replaceRoundWithReciprocal }, t.prototype.enableReplaceRoundWithReciprocal = function () { this.replaceRoundWithReciprocal = !0, this.reloadState() }, t.prototype.disableReplaceRoundWithReciprocal = function () { this.replaceRoundWithReciprocal = !1, this.reloadState() }, t }(); t.default = a });
define('basic/controller', ["require", "exports", "tslib", "flux", "underscore", "./model", "lib/state-stack", "keypad/mq-commands", "lib/i18n", "dcgview-helpers/mathquill-view", "lib/console", "bugsnag", "core/lib/color-helpers"], function (require, e, t, o, s, i, n, r, a, c, l, p, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var d = function () { function e(e, t) { var s = this; this.keyboardMode = "main", this.fontSize = 16, this.invertedColors = !1, this.backgroundColor = "", this.textColor = "", this.projectorMode = !1, this.capExpressionSize = !1, this.decimalToFraction = !0, this.settingsMenu = !0, this.settingsMenuOpen = !1, this.language = "en", this.brailleMode = "none", this.sixKeyInput = !1, this.brailleControls = !0, this.brailleExpressionDownload = !0, this.replaceCommaWith10Exp = !1, this.typingAsteriskWritesTimesSymbol = !1, this.stateStack = new n.default, this.dispatcher = new o.Dispatcher, this.s = a.createDictionaryLookupFunction(function () { return s.language }), this.dispatch = function (e) { var t; for (p.leaveBreadcrumb("dispatch", { type: e.type }), s.dispatcher.dispatch(e); t = s._queuedCallbacks.shift();)t() }, this._queuedCallbacks = [], this.stateStack = new n.default, this.dispatcher = new o.Dispatcher, this.options = e, this.model = new i.default({ evaluationMode: this.options.evaluationMode, additionalFunctions: this.options.additionalFunctions, functionDefinition: this.options.functionDefinition, replaceRoundWithReciprocal: this.options.replaceRoundWithReciprocal, workerPool: t.workerPool }), this.model = this.model, this.model.setDegreeMode(e.degreeMode), this.setLanguage(e.language), this.setBrailleMode(e.brailleMode), this.setSixKeyInput(e.sixKeyInput), this.setBrailleControls(e.brailleControls), this.setBrailleExpressionDownload(e.brailleExpressionDownload), this.setReplaceCommaWith10Exp(e.replaceCommaWith10Exp), this.setReplaceRoundWithReciprocal(e.replaceRoundWithReciprocal), this.setTypingAsteriskWritesTimesSymbol(e.typingAsteriskWritesTimesSymbol), this.setProjectorMode(e.projectorMode), this.setCapExpressionSize(e.capExpressionSize), this.setDecimalToFraction(e.decimalToFraction), this.invertedColors = e.invertedColors, this.backgroundColor = e.backgroundColor, this.textColor = e.textColor, this.settingsMenu = e.settingsMenu, this.model.onEvaluationUpdate = function () { return s.dispatch({ type: "render" }) }, this.settingsProxy = t.settingsProxy, this.syncPublicSettings(), this.hookUpDispatcher(), this.containerSize = { width: 0, height: 0 } } return e.prototype.runAfterDispatch = function (e) { this._queuedCallbacks.push(e) }, e.prototype.enqueueEvent = function (e) { var t = this; this.runAfterDispatch(function () { t.onEventEmitted && t.onEventEmitted(e) }) }, e.prototype.getFunctionDefinition = function () { return this.options.functionDefinition }, e.prototype.getSettingsMenu = function () { return this.settingsMenu }, e.prototype.getBrailleMode = function () { return this.brailleMode }, e.prototype.renderAsBraille = function () { return "none" !== this.brailleMode }, e.prototype.setBrailleMode = function (e) { this.brailleMode = e }, e.prototype.getSixKeyInput = function () { return this.sixKeyInput }, e.prototype.setSixKeyInput = function (e) { this.sixKeyInput = e }, e.prototype.getBrailleControls = function () { return this.brailleControls }, e.prototype.setBrailleControls = function (e) { this.brailleControls = e }, e.prototype.getBrailleExpressionDownload = function () { return this.brailleExpressionDownload }, e.prototype.setBrailleExpressionDownload = function (e) { this.brailleExpressionDownload = e }, e.prototype.getRestrictedEditing = function () { return this.options.restrictedEditing }, e.prototype.getKeyboardMode = function () { return this.keyboardMode }, e.prototype.getFontSize = function () { return this.fontSize }, e.prototype.getInvertedColors = function () { return this.invertedColors }, e.prototype.hasBackgroundColor = function () { return "#ffffff" !== this.getBackgroundColor() }, e.prototype.getBackgroundColor = function () { var e = u.normalizeColor(this.backgroundColor || "#fff"); return this.getInvertedColors() && "#ffffff" !== e ? u.invertColor(e) : e }, e.prototype.getTextColor = function () { var e = u.normalizeColor(this.textColor || "#000"); return this.getInvertedColors() && "#000000" !== e ? u.invertColor(e) : e }, e.prototype.getAdditionalFunctions = function () { return this.options.additionalFunctions }, e.prototype.getTypingSlashWritesDivisionSymbol = function () { return this.options.typingSlashWritesDivisionSymbol }, e.prototype.setTypingAsteriskWritesTimesSymbol = function (e) { this.typingAsteriskWritesTimesSymbol = e }, e.prototype.getTypingAsteriskWritesTimesSymbol = function () { return this.typingAsteriskWritesTimesSymbol }, e.prototype.setProjectorMode = function (e) { this.projectorMode = e }, e.prototype.isProjectorMode = function () { return this.projectorMode }, e.prototype.getReplaceCommaWith10Exp = function () { return this.replaceCommaWith10Exp }, e.prototype.setReplaceCommaWith10Exp = function (e) { this.replaceCommaWith10Exp = e }, e.prototype.getReplaceRoundWithReciprocal = function () { return this.model.getReplaceRoundWithReciprocal() }, e.prototype.setReplaceRoundWithReciprocal = function (e) { e ? this.model.enableReplaceRoundWithReciprocal() : this.model.disableReplaceRoundWithReciprocal() }, e.prototype.setCapExpressionSize = function (e) { this.capExpressionSize = e }, e.prototype.getCapExpressionSize = function () { return this.capExpressionSize }, e.prototype.setDecimalToFraction = function (e) { this.decimalToFraction = e }, e.prototype.setLanguage = function (e) { "en" !== e && -1 === Desmos.supportedLanguages.indexOf(e) ? l.warn("Translation for '" + e + "' isn't currently available. Using '" + this.language + "' instead.") : this.language = e }, e.prototype.getLanguage = function () { return this.language }, e.prototype.getDecimalToFraction = function () { return this.decimalToFraction }, e.prototype.isScientificCalc = function () { var e = this.options.evaluationMode; return "scientific" === e || "singleExpressionScientific" === e }, e.prototype.isFourFunctionCalc = function () { return "fourFunction" === this.options.evaluationMode || "singleExpressionFourFunction" === this.options.evaluationMode }, e.prototype.getAllowLinks = function () { return this.options.links }, e.prototype.canUndo = function () { return this.stateStack.canUndo() }, e.prototype.canRedo = function () { return this.stateStack.canRedo() }, e.prototype.undo = function (e) { if (this.canUndo()) { this.stateStack.undo(); var o = this.stateStack.getState(); if (!e.restoreFocus) { var s = { focus: void 0 }; o = t.__assign(t.__assign({}, o), { ui: s }) } this.model.setState(o), this.enqueueEvent("change") } }, e.prototype.redo = function (e) { if (this.canRedo()) { this.stateStack.redo(); var o = this.stateStack.getState(); if (!e.restoreFocus) { var s = { focus: void 0 }; o = t.__assign(t.__assign({}, o), { ui: s }) } this.model.setState(o), this.enqueueEvent("change") } }, e.prototype.clearHistory = function () { this.stateStack.clear() }, e.prototype.canBackspace = function () { var e = this.model.getFocusedExpression(); return e && (e.latex.length > 0 || this.model.getNumberOfExpressions() > 1) }, e.prototype.focusLastExpression = function () { this.model.focusLastExpression() }, e.prototype.shouldRender = function () { return this.containerSize.width > 0 && this.containerSize.height > 0 }, e.prototype.canClear = function () { return this.model.canClear() }, e.prototype.shouldShowClear = function () { return this.model.shouldShowClear() }, e.prototype.enableSettingsMenu = function () { this.settingsMenu = !0 }, e.prototype.disableSettingsMenu = function () { this.closeSettingsMenu(), this.settingsMenu = !1 }, e.prototype.closeSettingsMenu = function () { this.settingsMenuOpen = !1 }, e.prototype.toggleSettingsMenu = function () { this.settingsMenuOpen = !this.settingsMenuOpen }, e.prototype.isSettingsMenuOpen = function () { return this.settingsMenuOpen }, e.prototype.isLastExpressionEmpty = function () { return this.model.isLastExpressionEmpty() }, e.prototype.createAtEnd = function () { this.model.createAtEnd() }, e.prototype.clearFocusedExpression = function () { this.model.clearFocusedExpression() }, e.prototype.setLatexById = function (e, t) { this.model.setLatexById(e, t) }, e.prototype.setLatexAndBrailleById = function (e, t, o) { this.model.setLatexAndBrailleById(e, t, o) }, e.prototype.setLatexOfFocusedExpression = function (e) { this.model.setLatexOfFocusedExpression(e) }, e.prototype.toggleFractionEvaluationById = function (e) { this.model.setFractionEvaluation(e, !this.model.getExpressionById(e).displayAsFraction) }, e.prototype.conditionallyCopyPrevious = function (e) { this.model.conditionallyCopyPrevious(e) }, e.prototype.createBlankAfterId = function (e) { this.model.createBlankAfterId(e) }, e.prototype.backspaceAtFrontOfId = function (e) { this.model.backspaceAtFrontOfId(e) }, e.prototype.areStatesDifferentEnoughForUndoRedo = function (e, o) { var i = { focus: void 0 }; return s.isEqual(t.__assign(t.__assign({}, e), { ui: i }), t.__assign(t.__assign({}, o), { ui: i })) }, e.prototype.commitUndoRedoDebounced = function () { var e = this.model.getState(), t = this.stateStack.getState(); if (!this.areStatesDifferentEnoughForUndoRedo(e, t)) { var o = (new Date).getTime(); o - this._lastDebouncedTime < 1e3 ? this.stateStack.replaceState(e) : this.stateStack.addState(e), this._lastDebouncedTime = o, this.enqueueEvent("change") } }, e.prototype.commitUndoRedoSynchronously = function () { var e = this.model.getState(), t = this.stateStack.getState(); this.areStatesDifferentEnoughForUndoRedo(e, t) || (this._lastDebouncedTime = 0, this.stateStack.addState(e), this.enqueueEvent("change")) }, e.prototype.updateKeyboardMode = function (e) { this.keyboardMode = e }, e.prototype.getFocusedMathquill = function () { if (this.model.getFocusedExpressionId()) return c.default.getFocusedMathquill() }, e.prototype.ensureMathquillIsFocusedAndReturnFocusedMathquill = function () { var e = this.getFocusedMathquill(); return e || (this.isLastExpressionEmpty() && !this.model.isSingleExpression() ? this.createAtEnd() : this.focusLastExpression(), this.onEventEmitted && this.onEventEmitted("render"), this.getFocusedMathquill()) }, e.prototype.typeIntoFocusedMathquill = function (e) { e = e.replace(/\r|\n/g, ""); var t = this.ensureMathquillIsFocusedAndReturnFocusedMathquill(); t && c.default.canAcceptText(t, this.getCapExpressionSize(), e) && (t.typedText(e), this.setLatexOfFocusedExpression(t.latex()), this.model.markShouldDebounceUndoRedo()) }, e.prototype.pressKeyInFocusedMathquill = function (e, t) { if ("none" === this.getBrailleMode()) { var o = this.ensureMathquillIsFocusedAndReturnFocusedMathquill(); if (o) if ("Up" === e || "Down" === e || "Left" === e || "Right" === e) c.default.applyArrowKeyAndReturnIfWasAtBounds(o, e, t) && this.moveFocusInDirection(e); else "Enter" === e ? (t && (t.preventDefault(), t.stopPropagation()), this.handleEnter()) : "Backspace" === e && this.attemptToMoveFocusWithBackspace() || (o.keystroke(e, t), this.setLatexOfFocusedExpression(o.latex())) } }, e.prototype.moveFocusInDirection = function (e) { var t = this.model.getFocusedExpressionId(); t && ("Up" === e ? this.model.focusPrevById(t) : "Down" === e && this.model.focusNextById(t)) }, e.prototype.handleEnter = function () { if (!this.model.isSingleExpression()) { var e = this.model.getFocusedExpressionId(); e && (this.conditionallyCopyPrevious(e), this.createBlankAfterId(e)) } }, e.prototype.attemptToMoveFocusWithBackspace = function () { var e = this.model.getFocusedExpression(); if (!e) return !1; var t = e.latex, o = e.id; return "" === t && (this.backspaceAtFrontOfId(o), !0) }, e.prototype.executeCommandInFocusedMathquill = function (e) { var t = this.ensureMathquillIsFocusedAndReturnFocusedMathquill(); t && (r.execute(t, e), this.setLatexOfFocusedExpression(t.latex())) }, e.prototype.syncPublicSettings = function () { this.settingsProxy.setProperty("language", this.language), this.settingsProxy.setProperty("fontSize", this.fontSize), this.settingsProxy.setProperty("degreeMode", this.model.getDegreeMode()), this.settingsProxy.setProperty("invertedColors", this.invertedColors), this.settingsProxy.setProperty("backgroundColor", this.backgroundColor), this.settingsProxy.setProperty("textColor", this.textColor), this.settingsProxy.setProperty("brailleMode", this.brailleMode), this.settingsProxy.setProperty("sixKeyInput", this.sixKeyInput), this.settingsProxy.setProperty("brailleControls", this.brailleControls), this.settingsProxy.setProperty("brailleExpressionDownload", this.brailleExpressionDownload), this.settingsProxy.setProperty("projectorMode", this.projectorMode), this.settingsProxy.setProperty("capExpressionSize", this.capExpressionSize), this.settingsProxy.setProperty("decimalToFraction", this.decimalToFraction), this.settingsProxy.setProperty("qwertyKeyboard", this.options.qwertyKeyboard), this.settingsProxy.setProperty("links", this.options.links), this.settingsProxy.setProperty("settingsMenu", this.settingsMenu), this.settingsProxy.setProperty("functionDefinition", this.model.getFunctionDefinition()), this.settingsProxy.setProperty("replaceCommaWith10Exp", this.replaceCommaWith10Exp), this.settingsProxy.setProperty("replaceRoundWithReciprocal", this.model.getReplaceRoundWithReciprocal()), this.settingsProxy.setProperty("typingAsteriskWritesTimesSymbol", this.typingAsteriskWritesTimesSymbol) }, e.prototype.hookUpDispatcher = function () { var e = this; this.dispatcher.register(function (o) { e.enqueueEvent("render"); var s = !1, i = e.getRestrictedEditing(); switch (o.type) { case "update-options": e.options = t.__assign(t.__assign({}, e.options), o.options); break; case "keypad/shift": var n = void 0; switch (e.keyboardMode) { case "qwerty": n = "capitalQwerty"; break; case "capitalQwerty": n = "qwerty"; break; case "letters": n = "capitalLetters"; break; case "capitalLetters": n = "letters"; break; default: n = "qwerty" }e.updateKeyboardMode(n); break; case "undo": i || (e.undo({ restoreFocus: "keyboard-shortcut" === o.source }), s = !0); break; case "redo": i || (e.redo({ restoreFocus: "keyboard-shortcut" === o.source }), s = !0); break; case "clear-history": e.clearHistory(); break; case "set-state-from-api": o.opts.allowUndo || e.clearHistory(), e.model.setStateFromAPI(o.state); break; case "main": e.updateKeyboardMode("main"); break; case "ABC": e.options.qwertyKeyboard ? e.updateKeyboardMode("qwerty") : e.updateKeyboardMode("letters"); break; case "functions": e.updateKeyboardMode("functions"); break; case "degrees": e.model.setDegreeMode(!e.model.getDegreeMode()); break; case "update-degree-mode": e.model.setDegreeMode(!!o.mode); break; case "update-font-size": var r = o.size; if ("number" != typeof r && (r = parseInt(r, 10)), isNaN(r)) return; e.fontSize = r; break; case "update-inverted-colors": e.invertedColors = !!o.mode; break; case "update-background-color": e.backgroundColor = o.color; break; case "update-text-color": e.textColor = o.color; break; case "update-projector-mode": e.setProjectorMode(!!o.mode); break; case "update-cap-expression-size": e.setCapExpressionSize(!!o.mode); break; case "update-decimal-to-fraction": e.setDecimalToFraction(!!o.mode); break; case "update-language": e.setLanguage(o.language); break; case "set-blank": o.opts.allowUndo || e.clearHistory(), e.model.clear(), e.focusLastExpression(); break; case "clear": e.model.clearFocusedExpression(); break; case "set-braille-mode": var a = o.mode; "nemeth" !== a && "ueb" !== a && "none" !== a ? l.warn("Valid Braille modes are 'nemeth', 'none', and 'ueb'. You passed '" + a + "'.") : (e.model.clearCachedBrailleValues(), e.setBrailleMode(o.mode)); break; case "set-six-key-input": e.setSixKeyInput(!!o.mode); break; case "set-braille-controls": e.setBrailleControls(!!o.value); break; case "set-braille-expression-download": e.setBrailleExpressionDownload(!!o.mode); break; case "set-replace-comma-with-10-exp": e.setReplaceCommaWith10Exp(!!o.replace); break; case "set-replace-round-with-reciprocal": e.setReplaceRoundWithReciprocal(!!o.replace); break; case "set-typing-asterisk-writes-times-symbol": e.setTypingAsteriskWritesTimesSymbol(!!o.mode); break; case "update-latex": e.model.markShouldDebounceUndoRedo(), e.setLatexById(o.id, o.latex); break; case "update-latex-from-braille": e.model.markShouldDebounceUndoRedo(), e.setLatexAndBrailleById(o.id, o.latex, o.braille); break; case "focusin": e.model.setFocusedById(o.id, !0); break; case "focusout": e.model.setFocusedById(o.id, !1); break; case "focus-first-expression": e.model.focusFirstExpression(); break; case "focus-prev-expression": e.moveFocusInDirection("Up"); break; case "focus-next-expression": e.moveFocusInDirection("Down"); break; case "focus-last-expression": e.model.focusLastExpression(); break; case "insert-blank-expression": e.handleEnter(); break; case "backspace-from-braille": e.attemptToMoveFocusWithBackspace(); break; case "keypad/type-text": e.typeIntoFocusedMathquill(o.text); break; case "keypad/press-key": e.pressKeyInFocusedMathquill(o.key, o.evt); break; case "keypad/custom-command": e.executeCommandInFocusedMathquill(o.command); break; case "keypad/123": case "keypad/abc": case "keypad/audio-trace": break; case "enable-settings-menu": e.enableSettingsMenu(); break; case "disable-settings-menu": e.disableSettingsMenu(); break; case "toggle-settings-menu": e.toggleSettingsMenu(); break; case "close-settings-menu": e.closeSettingsMenu(); break; case "render": break; case "ui/container-resized": e.containerSize = o.size; break; case "toggle-fraction-evaluation": e.toggleFractionEvaluationById(o.id); break; default: return o }e.runAfterDispatch(function () { return e.syncPublicSettings() }), s || (e.model.getShouldDebounceUndoRedo() ? (e.commitUndoRedoDebounced(), e.model.clearShouldDebounceUndoRedo()) : e.commitUndoRedoSynchronously()) }) }, e }(); e.default = d });
define('basic/dcgview-basic', ["require", "exports", "tslib", "dcgview"], function (require, t, i, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DCGViewBasic = void 0; var s = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return i.__extends(e, t), e.prototype.init = function () { this.controller = this.props.controller(), this.model = this.controller.model, this.dispatch = this.controller.dispatch, this.s = this.controller.s }, e }(e.Class); t.DCGViewBasic = s });

define('loadcss!keypad/control-bar', function () { });
define('keypad/control-bar', ["require", "exports", "tslib", "dcgview", "./dcgview-keypad", "loadcss!./control-bar"], function (require, e, t, r, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var o = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { var e = this; return r.createElement("div", { class: r.const("dcg-keypad-control-bar dcg-do-not-blur"), role: r.const("group"), "aria-label": function () { return e.controller.s("shared-calculator-narration-keypad-controlbar") } }, r.createElement("div", { class: r.const("dcg-keypad-control-bar-contents") }, this.children)) }, n }(n.default); e.default = o });

define('loadcss!keypad/control-btn', function () { });
define('keypad/control-btn', ["require", "exports", "tslib", "dcgview", "loadcss!./control-btn"], function (require, t, e, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return e.__extends(s, t), s.prototype.template = function () { var t = this; return i.createElement("div", { class: function () { return { "dcg-keypad-control-btn": !0, "dcg-disabled": t.isDisabled(), "dcg-selected": !t.isDisabled() && t.isSelected(), "dcg-selectable-btn": !t.isDisabled() && t.isSelectable(), "dcg-narrow-control-btn": t.props.narrowButton && t.props.narrowButton() } }, didMount: this.bindFn(this.didMount), role: i.const("button"), "aria-disabled": function () { return t.isDisabled() || void 0 }, "aria-label": function () { return t.getAriaLabel() }, "dcg-command": this.props.command, onTap: this.bindFn(this.handleTap), "aria-pressed": function () { return t.hasPopup() || t.isDisabled() || !t.isSelectable() ? void 0 : t.isSelected() }, "aria-expanded": function () { return t.hasPopup() && !t.isDisabled() ? t.isSelected() : void 0 }, tabindex: this.bindFn(this.getTabIndex) }, this.children) }, s.prototype.getTabIndex = function () { return this.isDisabled() ? void 0 : this.props.ignoreInTabOrder && this.props.ignoreInTabOrder() ? -1 : 0 }, s.prototype.handleTap = function (t) { this.isDisabled() || this.props.onTap(t) }, s.prototype.getAriaLabel = function () { return this.props.ariaLabel ? this.props.ariaLabel() : this.props.command() }, s.prototype.hasPopup = function () { return !!this.props.ariaPopup && this.props.ariaPopup() }, s.prototype.isDisabled = function () { return !!this.props.disabled && this.props.disabled() }, s.prototype.isSelected = function () { return !!this.props.selected && this.props.selected() }, s.prototype.isSelectable = function () { return !!this.props.selectable && this.props.selectable() }, s.prototype.didMount = function (t) { this.props.didMount && this.props.didMount(t) }, s }(i.Class); t.default = s });

define('loadcss!dcgview-helpers/download-button', function () { });
define('dcgview-helpers/download-button', ["require", "exports", "tslib", "dcgview", "browser", "loadcss!./download-button"], function (require, t, o, n, e) { "use strict"; function i() { return !e.IS_IE && !function () { if (!e.IS_SAFARI) return !1; var t = navigator.userAgent.match(/Version\/(\d+)/); return !(!t || !t[1]) && parseFloat(t[1]) < 11 }() && void 0 !== document.createElement("a").download } Object.defineProperty(t, "__esModule", { value: !0 }), t.canDownload = void 0, t.canDownload = function () { return i() || void 0 !== navigator.msSaveBlob }; var d = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return o.__extends(e, t), e.prototype.init = function () { this.supportsDirectDownload = i() }, e.prototype.template = function () { var t = this; return n.createElement("a", { role: n.const("button"), tabindex: function () { return t.props.enabled() ? 0 : -1 }, "aria-disabled": function () { return !t.props.enabled() }, class: function () { return { "dcg-download-button": !0, "dcg-disabled": !t.props.enabled(), "dcg-braille-equations": t.props.isBraille, "dcg-svg-button": t.props.isSvg } }, didMount: this.bindFn(this.didMountDownload), didUnmount: this.bindFn(this.didUnmountDownload), didUpdate: this.bindFn(this.didUpdate), download: function () { return t.supportsDirectDownload ? t.props.filename() : void 0 }, onTap: function (o) { if (!t.supportsDirectDownload && navigator.msSaveOrOpenBlob) { var n = t.props.data(); n && (navigator.msSaveOrOpenBlob(n, t.props.filename()), o.preventDefault()) } } }, n.createElement("i", { class: n.const("dcg-icon-download"), "aria-hidden": n.const("true") }), n.createElement("span", null, function () { return t.props.text() })) }, e.prototype.didMountDownload = function (t) { this.downloadLink = t, this.didUpdate() }, e.prototype.didUnmountDownload = function () { this.revokeBlobURL() }, e.prototype.didUpdate = function () { this.updateDownloadURL(), this.cachedObjectURL && (this.downloadLink.href = this.cachedObjectURL) }, e.prototype.updateDownloadURL = function () { if (this.revokeBlobURL(), this.supportsDirectDownload) { var t = this.props.data(); t && (this.cachedObjectURL = URL.createObjectURL(t)) } }, e.prototype.revokeBlobURL = function () { this.cachedObjectURL && URL.revokeObjectURL(this.cachedObjectURL) }, e }(n.Class); t.default = d });
define('lib/export-braille-equations', ["require", "exports", "abraham", "graphing-calc/models/expression", "expressions/regression_view", "core/lib/number-to-latex"], function (require, e, r, t, s, a) { "use strict"; function n(e, t, s) { if (void 0 === s && (s = !1), s && (e = e.replace(/ /g, "\\ ")), "none" === t) return e; var a = "nemeth" === t ? r.latexToNemeth(e) : r.latexToUeb(e); return a.isError ? "" : r.UnicodeBraille.toBrailleAscii(a.value) } function o(e) { var r = "--------------------"; return r + "\n" + e + "\n" + r } function i(e, r) { var t = "" + e; return "nemeth" === r ? n(t, r, !1) + "_4" : "ueb" === r ? n(t + ".", r, !1) : "" } Object.defineProperty(e, "__esModule", { value: !0 }), e.getBrailleEquationsBasic = e.getBrailleEquationsGraphing = void 0, e.getBrailleEquationsGraphing = function (e, r) { if ("none" === r) return ""; var u = []; u.push(n("Expression List", r, !0)), u.push(""), u.push(""); for (var l = "", p = e.getItemCount(), d = 0; d < p; d++) { var h = e.getItemModelByIndex(d); if (h && !h.secret) { "" !== l && "folder" !== h.type && l !== h.folderId && (u.push(o(n("End Folder", r, !0))), l = ""); var c = ""; switch (h.type) { case "expression": if (!h.hidden) { var g = i(h.displayIndex, r); c = h.latex; var v = [], f = h.formula; if (f && !t.isEmpty(h)) if (e.shouldShowEvaluationForItem(h.id)) { var x = f.zero_values && f.zero_values.length ? f.zero_values[0].val : f.constant_value; Array.isArray(x) ? c += "\\ " + x.length + "\\ element\\ list" : c += "=" + x } else if (t.shouldShowCDFFooter(h)) v.push(n("Min=" + t.getCDFMin(h), r, !1)), v.push(n("Max=" + t.getCDFMax(h), r, !1)), t.isCDFMaxValid(h) && t.isCDFMinValid(h) && v.push(n("CDF=" + t.getCDFEvaluation(h), r, !1)); else if (t.isTTest(h)) { var m = t.getTTestResults(h); m && (v.push(n("<" + a.numberToStatsConfidenceLatex(m.lessThan, 5), r, !1)), v.push(n(">" + a.numberToStatsConfidenceLatex(m.greaterThan, 5), r, !1)), v.push(n("\\ne" + a.numberToStatsConfidenceLatex(m.notEqual, 5), r, !1))) } else if (f.is_regression && f.regression) { var E = f.regression, b = E.statistics, y = E.parameters; for (var S in b.hasOwnProperty("Rsquared") && v.push(n("R^2=" + s.getRoundedStat(E, "Rsquared"), r, !1)), b.hasOwnProperty("rsquared") && v.push(n("r^2=" + s.getRoundedStat(E, "rsquared"), r, !1)), b.hasOwnProperty("r") && v.push(n("r=" + s.getRoundedStat(E, "r"), r, !1)), b.hasOwnProperty("RMSE") && v.push(n("\\operatorname{RMSE}=" + s.getRoundedStat(E, "RMSE"), r, !1)), y) v.push(n(S + "=" + s.getRoundedParam(E, S), r, !1)) } u.push(g + "  " + n(c, r, !1)), u.push.apply(u, v) } break; case "text": u.push(n(h.text, r, !0)); break; case "folder": h.collapsed ? c = "Collapsed Folder " + h.title : (c = "Start Folder " + h.title, l = h.id), u.push(o(n(c, r, !0))); break; case "image": u.push(n("Image", r, !1)); break; case "table": u.push(o(n("Start Table", r, !0))); for (var F = 0, T = h.rowModels; F < T.length; F++) { for (var C = [], M = 0, R = T[F].cells; M < R.length; M++) { var q = R[M], w = ""; if ("header" === q.type) w = q.latex || ""; else if ("cell" === q.type) { var B = q.column.index, _ = q.row.index - 1; w = q.column.disabled ? q.column.computedValues[_] || "" : h.columns[B].values[_] || "" } C.push(n(w, r)) } var I = C.join("\t"); /^\t/.test(I) || u.push(I) } u.push(o(n("End Table", r, !0))); break; default: return h } } } return "" !== l && u.push(o(n("End Folder", r, !0))), u.join("\n") }, e.getBrailleEquationsBasic = function (e, r) { if ("none" === r) return ""; var t = []; t.push(n("Expression List", r, !0)), t.push(""), t.push(""); for (var s = 0, a = e.getExpressionOrder(); s < a.length; s++) { var o = a[s], u = i(e.getExpressionIndex(o) + 1, r), l = e.getExpressionLatex(o), p = e.getExpressionValue(o); void 0 !== p && (l += "=" + p), t.push(u + "  " + n(l, r, !1)) } return t.join("\n") } });

define('loadcss!basic/settings-menu', function () { });
define('basic/settings-menu', ["require", "exports", "tslib", "browser", "keys", "dcgview", "./dcgview-basic", "jquery", "dcgview-helpers/download-button", "lib/export-braille-equations", "loadcss!./settings-menu"], function (require, e, t, n, o, r, c, l, i, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SettingsMenu = void 0; var a = r.Components.If, d = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.template = function () { var e = this; return r.createElement("div", { class: function () { return { "dcg-settings-dropdown": !0, "dcg-popover": !0, "dcg-has-background-color": e.controller.hasBackgroundColor(), "dcg-point-left": e.controller.containerSize.height <= 420 } }, role: r.const("complementary"), "aria-label": r.const("Settings Menu"), didMount: this.bindFn(this.didMountSettingsDropdown), didUnmount: this.bindFn(this.didUnmountSettingsDropdown) }, r.createElement("div", { class: r.const("dcg-popover-interior"), style: function () { return { background: e.controller.getBackgroundColor() } } }, r.createElement("div", { class: function () { return { "dcg-settings-menu-option": !0, "dcg-displaysize-container": !0 } } }, r.createElement("div", { class: r.const("dcg-group-title") }, function () { return e.controller.s("shared-calculator-label-settings-display") }), r.createElement("div", { role: r.const("group"), "aria-label": function () { return e.controller.s("shared-calculator-narration-settings-display-size") }, class: r.const("dcg-displaysize-buttons dcg-segmented-control-container") }, r.createElement("span", { class: function () { return { "dcg-displaysize-option": !0, "dcg-displaysize-default": !0, "dcg-segmented-control-btn": !0, "dcg-dark-gray-segmented-control-btn": !0, "dcg-selected": !e.getProjectorMode() } }, role: r.const("button"), onTap: this.bindFn(this.setDefaultDisplaySize), tabindex: r.const(0), "aria-label": function () { return e.controller.s("shared-calculator-narration-settings-display-size-default") }, "aria-pressed": function () { return !e.getProjectorMode() } }, r.const("A")), r.createElement("span", { class: function () { return { "dcg-displaysize-option": !0, "dcg-displaysize-large": !0, "dcg-segmented-control-btn": !0, "dcg-dark-gray-segmented-control-btn": !0, "dcg-selected": e.getProjectorMode() } }, role: r.const("button"), onTap: this.bindFn(this.setLargeDisplaySize), tabindex: r.const(0), "aria-label": function () { return e.controller.s("shared-calculator-narration-settings-display-size-large") }, "aria-pressed": this.bindFn(this.getProjectorMode) }, r.const("A")))), r.createElement("div", { role: r.const("checkbox"), tabindex: r.const(0), onTap: this.bindFn(this.onToggleInvertedColors), "aria-checked": function () { return e.controller.getInvertedColors() }, "aria-label": function () { return e.controller.s("basic-calculator-narration-reverse-contrast") }, class: function () { return { "dcg-settings-menu-option": !0, "dcg-do-not-blur": !0, "dcg-checked": e.controller.getInvertedColors(), "dcg-checkbox-container": !0, "dcg-reverse-contrast": !0 } }, handleEvent: r.const(!0) }, r.createElement("span", { class: r.const("dcg-checkbox-box") }, r.createElement("i", { class: r.const("dcg-icon-check"), "aria-hidden": r.const("true") })), r.createElement("span", { class: r.const("dcg-checkbox-label") }, function () { return e.controller.s("basic-calculator-label-reverse-contrast") })), r.createElement(a, { predicate: function () { return e.controller.getBrailleControls() } }, function () { return r.createElement("div", null, r.createElement("div", { role: r.const("checkbox"), tabindex: r.const(0), onTap: e.bindFn(e.onToggleBrailleMode), "aria-checked": function () { return e.controller.renderAsBraille() }, "aria-label": function () { return e.controller.s("basic-calculator-narration-braille-mode") }, class: function () { return { "dcg-settings-menu-option": !0, "dcg-do-not-blur": !0, "dcg-checked": e.controller.renderAsBraille(), "dcg-checkbox-container": !0, "dcg-braille-mode": !0 } }, handleEvent: r.const(!0) }, r.createElement("span", { class: r.const("dcg-checkbox-box") }, r.createElement("i", { class: r.const("dcg-icon-check"), "aria-hidden": r.const("true") })), r.createElement("span", { class: r.const("dcg-checkbox-label") }, function () { return e.controller.s("basic-calculator-label-braille-mode") })), r.createElement(a, { predicate: function () { return e.controller.renderAsBraille() } }, function () { return r.createElement("div", { class: function () { return { "dcg-settings-menu-option": !0, "dcg-braille-container": !0 } } }, r.createElement("div", { role: r.const("group"), "aria-label": function () { return e.controller.s("basic-calculator-label-braille-mode") }, class: r.const("dcg-braille-options-buttons dcg-segmented-control-container") }, r.createElement("span", { class: function () { return { "dcg-braille-option": !0, "dcg-segmented-control-btn": !0, "dcg-dark-gray-segmented-control-btn": !0, "dcg-selected": e.isNemeth() } }, role: r.const("button"), onTap: function () { return e.setBrailleMode("nemeth") }, tabindex: r.const(0), "aria-label": function () { return e.controller.s("basic-calculator-narration-nemeth") }, "aria-pressed": function () { return e.isNemeth() } }, function () { return e.controller.s("basic-calculator-button-nemeth") }), r.createElement("span", { class: function () { return { "dcg-braille-option": !0, "dcg-segmented-control-btn": !0, "dcg-dark-gray-segmented-control-btn": !0, "dcg-selected": e.isUEB() } }, role: r.const("button"), onTap: function () { return e.setBrailleMode("ueb") }, tabindex: r.const(0), "aria-label": function () { return e.controller.s("basic-calculator-narration-ueb") }, "aria-pressed": function () { return e.isUEB() } }, function () { return e.controller.s("basic-calculator-button-ueb") })), r.createElement("div", { class: r.const("dcg-braille-options-container") }, r.createElement("div", { role: r.const("checkbox"), tabindex: r.const(0), onTap: function () { return e.onToggleSixKeyInput() }, "aria-checked": function () { return e.controller.getSixKeyInput() }, "aria-label": function () { return e.controller.s("basic-calculator-narration-six-key-input") }, class: function () { return { "dcg-settings-menu-option": !0, "dcg-do-not-blur": !0, "dcg-six-key-checkbox": !0, "dcg-checked": e.controller.getSixKeyInput(), "dcg-checkbox-container": !0 } }, handleEvent: r.const(!0) }, r.createElement("span", { class: r.const("dcg-checkbox-box") }, r.createElement("i", { class: r.const("dcg-icon-check"), "aria-hidden": r.const("true") })), r.createElement("span", { class: r.const("dcg-checkbox-label") }, function () { return e.controller.s("basic-calculator-label-six-key-input") })), r.createElement("a", { href: r.const("https://www.desmos.com/accessibility#braille"), class: r.const("dcg-six-key-info"), target: r.const("_blank") }, r.createElement("i", { class: r.const("dcg-icon-question-sign"), "aria-hidden": r.const("true") })), r.createElement(a, { predicate: function () { return !n.IS_MOBILE && i.canDownload() && e.controller.getBrailleExpressionDownload() } }, function () { return r.createElement(i.default, { data: function () { var t = s.getBrailleEquationsBasic(e.model, e.controller.getBrailleMode()); return new Blob([t], { type: "text/plain" }) }, enabled: e.const(!0), filename: e.const("desmos-equations.brl"), text: function () { return e.controller.s("basic-calculator-link-download-braille-equations") }, isBraille: e.const(!0) }) }))) })) }), r.createElement(a, { predicate: function () { return !!e.getVersionNumber() } }, function () { return r.createElement("div", { class: r.const("dcg-version-number") }, r.const("Version: "), function () { return e.getVersionNumber() }) }))) }, c.prototype.getVersionNumber = function () { var e = window; if (e && e.AppBridge) return e.AppBridge.versionNumber }, c.prototype.didUnmountSettingsDropdown = function () { l(document).off(".dcg-settings-view") }, c.prototype.didMountSettingsDropdown = function (e) { var t = this; this.settingsGroupNode = e, l(document).on("dcg-tapstart.dcg-settings-view", function (e) { 0 === l(e.target).closest(".dcg-basic-settings-container").length && t.controller.dispatch({ type: "close-settings-menu" }) }), l(document).on("keydown.dcg-settings-view", function (e) { if ("Esc" === o.lookup(e) && (t.controller.dispatch({ type: "close-settings-menu" }), t.controller.dispatch({ type: "focus-last-expression" })), "Tab" === o.lookup(e) && !e.altKey && !e.metaKey && !e.ctrlKey) { var n = document.activeElement, r = l(t.props.settingsButtonNode()), c = l(t.settingsGroupNode).find(".dcg-settings-menu-option:last"); e.shiftKey || n !== c[0] ? e.shiftKey && n === r[0] && (c.trigger("focus"), e.preventDefault(), e.stopPropagation()) : (r.trigger("focus"), e.preventDefault(), e.stopPropagation()) } }) }, c.prototype.setBrailleMode = function (e) { this.controller.dispatch({ type: "set-braille-mode", mode: e }) }, c.prototype.onToggleBrailleMode = function () { this.controller.dispatch({ type: "set-braille-mode", mode: this.controller.renderAsBraille() ? "none" : "nemeth" }) }, c.prototype.isNemeth = function () { return "nemeth" === this.controller.getBrailleMode() }, c.prototype.isUEB = function () { return "ueb" === this.controller.getBrailleMode() }, c.prototype.isLatex = function () { return "none" === this.controller.getBrailleMode() }, c.prototype.onToggleSixKeyInput = function () { var e = !this.controller.getSixKeyInput(); this.controller.dispatch({ type: "set-six-key-input", mode: e }) }, c.prototype.onToggleInvertedColors = function () { var e = !this.controller.getInvertedColors(); this.controller.dispatch({ type: "update-inverted-colors", mode: e }) }, c.prototype.getProjectorMode = function () { return this.controller.isProjectorMode() }, c.prototype.setDefaultDisplaySize = function () { this.controller.dispatch({ type: "update-projector-mode", mode: !1 }) }, c.prototype.setLargeDisplaySize = function () { this.controller.dispatch({ type: "update-projector-mode", mode: !0 }) }, c }(c.DCGViewBasic); e.SettingsMenu = d });

define('loadcss!basic/keypad/settings-control-button', function () { });
define('basic/keypad/settings-control-button', ["require", "exports", "tslib", "dcgview", "keypad/control-btn", "basic/dcgview-basic", "basic/settings-menu", "loadcss!./settings-control-button"], function (require, t, e, n, o, i, s) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = n.Components.If, c = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return e.__extends(i, t), i.prototype.template = function () { var t = this, e = this.props.controller(); return n.createElement("div", { class: n.const("dcg-basic-settings-container") }, n.createElement(o.default, { didMount: function (e) { return t.settingsButtonNode = e }, command: this.const("settings"), ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-settings") }, onTap: this.bindFn(this.onToggleSettingsMenu), selected: function () { return t.controller.isSettingsMenuOpen() }, ariaPopup: this.const(!0) }, n.createElement("i", { class: n.const("dcg-icon-wrench"), "aria-hidden": n.const("true") })), n.createElement(r, { predicate: function () { return t.controller.isSettingsMenuOpen() } }, function () { return n.createElement(s.SettingsMenu, { controller: t.props.controller, settingsButtonNode: function () { return t.settingsButtonNode } }) })) }, i.prototype.onToggleSettingsMenu = function () { this.controller.dispatch({ type: "toggle-settings-menu" }) }, i }(i.DCGViewBasic); t.default = c });
define('basic/keypad/fourfunction-control-bar', ["require", "exports", "tslib", "dcgview", "keypad/control-bar", "keypad/control-btn", "./settings-control-button", "basic/dcgview-basic"], function (require, t, e, n, r, c, a, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var l = n.Components, i = l.If, u = l.IfElse, s = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.template = function () { var t = this, e = this.props.controller(); return n.createElement(r.default, { controller: this.props.controller }, n.createElement(i, { predicate: function () { return !t.controller.getRestrictedEditing() } }, function () { return n.createElement(c.default, { command: t.const("undo"), disabled: function () { return !e.canUndo() }, ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-undo") }, onTap: function (t) { return e.dispatch({ type: "undo", source: "keyboard" === t.device ? "button-keyboard" : "button-tap" }) } }, n.createElement("i", { class: n.const("dcg-icon-undo"), "aria-hidden": n.const("true") })) }), n.createElement(i, { predicate: function () { return !t.controller.getRestrictedEditing() } }, function () { return n.createElement(c.default, { command: t.const("redo"), disabled: function () { return !e.canRedo() }, ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-redo") }, onTap: function (t) { return e.dispatch({ type: "redo", source: "keyboard" === t.device ? "button-keyboard" : "button-tap" }) } }, n.createElement("i", { class: n.const("dcg-icon-redo"), "aria-hidden": n.const("true") })) }), u(function () { return e.shouldShowClear() }, { true: function () { return n.createElement(c.default, { command: t.const("clear"), ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-clear") }, onTap: function () { return e.dispatch({ type: "clear" }) } }, function () { return e.s("basic-calculator-button-controlbar-clear") }) }, false: function () { return n.createElement(c.default, { command: t.const("clearall"), disabled: function () { return !e.canClear() }, ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-clear-all") }, onTap: function () { return e.dispatch({ type: "set-blank", opts: { allowUndo: !0 } }) } }, function () { return e.s("basic-calculator-button-controlbar-clear-all") }) } }), n.createElement(i, { predicate: function () { return t.controller.getRestrictedEditing() } }, function () { return n.createElement("div", { class: n.const("dcg-spacer-2") }) }), n.createElement(i, { predicate: function () { return "none" === e.getBrailleMode() } }, function () { return n.createElement(c.default, { command: t.const("backspace"), ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-backspace") }, disabled: function () { return !e.canBackspace() }, onTap: function () { return e.dispatch({ type: "keypad/press-key", key: "Backspace" }) } }, n.createElement("i", { class: n.const("dcg-icon-delete"), "aria-hidden": n.const("true") })) }), n.createElement(i, { predicate: function () { return t.props.controller().getSettingsMenu() } }, function () { return n.createElement(a.default, { controller: t.props.controller }) })) }, o.prototype.onToggleSettingsMenu = function () { this.controller.dispatch({ type: "toggle-settings-menu" }) }, o }(o.DCGViewBasic); t.default = s });
define('basic/keypad/single-expression-fourfunction-control-bar', ["require", "exports", "tslib", "dcgview", "keypad/control-bar", "keypad/control-btn", "basic/dcgview-basic"], function (require, e, t, n, r, c, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var o = n.Components.If, i = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.template = function () { var e = this, t = this.props.controller(); return n.createElement(r.default, { controller: this.props.controller }, n.createElement(o, { predicate: function () { return !e.controller.getRestrictedEditing() } }, function () { return n.createElement(c.default, { command: e.const("undo"), disabled: function () { return !t.canUndo() }, ariaLabel: function () { return t.s("basic-calculator-narration-controlbar-undo") }, onTap: function (e) { return t.dispatch({ type: "undo", source: "keyboard" === e.device ? "button-keyboard" : "button-tap" }) } }, n.createElement("i", { class: n.const("dcg-icon-undo"), "aria-hidden": n.const("true") })) }), n.createElement(o, { predicate: function () { return !e.controller.getRestrictedEditing() } }, function () { return n.createElement(c.default, { command: e.const("redo"), disabled: function () { return !t.canRedo() }, ariaLabel: function () { return t.s("basic-calculator-narration-controlbar-redo") }, onTap: function (e) { return t.dispatch({ type: "redo", source: "keyboard" === e.device ? "button-keyboard" : "button-tap" }) } }, n.createElement("i", { class: n.const("dcg-icon-redo"), "aria-hidden": n.const("true") })) }), n.createElement(c.default, { command: this.const("clear"), ariaLabel: function () { return t.s("basic-calculator-narration-controlbar-clear") }, onTap: function () { return t.dispatch({ type: "clear" }) } }, function () { return t.s("basic-calculator-button-controlbar-clear") }), n.createElement(o, { predicate: function () { return e.controller.getRestrictedEditing() } }, function () { return n.createElement("div", { class: n.const("dcg-spacer-2") }) }), n.createElement(o, { predicate: function () { return "none" === t.getBrailleMode() } }, function () { return n.createElement(c.default, { command: e.const("backspace"), ariaLabel: function () { return t.s("basic-calculator-narration-controlbar-backspace") }, disabled: function () { return !t.canBackspace() }, onTap: function () { return t.dispatch({ type: "keypad/press-key", key: "Backspace" }) } }, n.createElement("i", { class: n.const("dcg-icon-delete"), "aria-hidden": n.const("true") })) })) }, a }(a.DCGViewBasic); e.default = i });

define('loadcss!keypad/control-toggle', function () { });
define('keypad/control-toggle', ["require", "exports", "tslib", "lib/aria", "core/lib/color-helpers", "dcgview", "./dcgview-keypad", "loadcss!./control-toggle"], function (require, t, e, o, r, l, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = function (t) { function a() { return null !== t && t.apply(this, arguments) || this } return e.__extends(a, t), a.prototype.template = function () { var t = this; return l.createElement("div", { class: function () { return { "dcg-keypad-control-toggle": !0, "dcg-toggled": t.props.toggled() } }, role: l.const("button"), tabindex: l.const("0"), "aria-label": this.bindFn(this.getAriaLabel), onTap: this.bindFn(this.handleTap) }, l.createElement("div", { class: l.const("dcg-ctrl-toggle-option") }, this.props.defaultOption), l.createElement("div", { class: l.const("dcg-ctrl-toggle-option") }, this.props.toggledOption), l.createElement("div", { class: l.const("dcg-ctrl-toggle-cover"), style: function () { return { background: r.shadeColor(t.controller.getBackgroundColor(), -.1) } } })) }, a.prototype.getAriaLabel = function () { var t = { toggled: this.props.toggledAriaLabel(), default: this.props.defaultAriaLabel() }; return this.props.toggled() ? this.controller.s("shared-calculator-narration-control-toggle-switch-to-default", t) : this.controller.s("shared-calculator-narration-control-toggle-switch-to-toggled", t) }, a.prototype.handleTap = function () { this.props.toggled() ? o.alert(this.props.defaultAriaLabel()) : o.alert(this.props.toggledAriaLabel()), this.props.onTap(this.props.command()) }, a }(a.default); t.default = n });
define('basic/keypad/scientific-control-bar', ["require", "exports", "tslib", "dcgview", "keypad/control-bar", "keypad/control-btn", "basic/dcgview-basic", "keypad/control-toggle", "./settings-control-button"], function (require, t, n, e, r, o, a, c, l) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = e.Components, u = i.If, s = i.IfElse, d = function (t) { function a() { return null !== t && t.apply(this, arguments) || this } return n.__extends(a, t), a.prototype.template = function () { var t = this, n = this.props.controller(); return e.createElement(r.default, { controller: this.props.controller }, e.createElement(o.default, { command: this.const("main"), selected: function () { return "main" === n.getKeyboardMode() }, disabled: function () { return t.controller.renderAsBraille() }, ignoreInTabOrder: this.const(!0), selectable: this.const(!0), onTap: function () { return n.dispatch({ type: "main" }) }, ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-main") } }, function () { return n.s("basic-calculator-button-controlbar-main") }), e.createElement(o.default, { command: this.const("ABC"), selected: function () { return -1 !== ["qwerty", "capitalQwerty", "letters"].indexOf(n.getKeyboardMode()) }, disabled: function () { return t.controller.renderAsBraille() }, ignoreInTabOrder: this.const(!0), selectable: this.const(!0), ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-abc") }, onTap: function () { return n.dispatch({ type: "ABC" }) } }, function () { return n.s("basic-calculator-button-controlbar-abc") }), e.createElement(o.default, { command: this.const("functions"), selected: function () { return -1 !== ["functions", "restrictedFunctions"].indexOf(n.getKeyboardMode()) }, ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-functions") }, disabled: function () { return t.controller.renderAsBraille() }, ignoreInTabOrder: this.const(!0), selectable: this.const(!0), onTap: function () { return n.dispatch({ type: "functions" }) } }, function () { return n.s("basic-calculator-button-controlbar-func") }), e.createElement(c.default, { command: this.const("degrees"), toggled: function () { return t.model.getDegreeMode() }, defaultOption: function () { return n.s("basic-calculator-label-controlbar-rad") }, toggledOption: function () { return n.s("basic-calculator-label-controlbar-deg") }, defaultAriaLabel: function () { return n.s("basic-calculator-narration-controlbar-radians") }, toggledAriaLabel: function () { return n.s("basic-calculator-narration-controlbar-degrees") }, onTap: function () { return n.dispatch({ type: "degrees" }) }, controller: this.props.controller }), e.createElement(u, { predicate: function () { return !t.controller.getRestrictedEditing() } }, function () { return e.createElement(o.default, { command: t.const("undo"), disabled: function () { return !n.canUndo() }, ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-undo") }, onTap: function (t) { return n.dispatch({ type: "undo", source: "keyboard" === t.device ? "button-keyboard" : "button-tap" }) } }, e.createElement("i", { class: e.const("dcg-icon-undo"), "aria-hidden": e.const("true") })) }), e.createElement(u, { predicate: function () { return !t.controller.getRestrictedEditing() } }, function () { return e.createElement(o.default, { command: t.const("redo"), disabled: function () { return !n.canRedo() }, ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-redo") }, onTap: function (t) { return n.dispatch({ type: "redo", source: "keyboard" === t.device ? "button-keyboard" : "button-tap" }) } }, e.createElement("i", { class: e.const("dcg-icon-redo"), "aria-hidden": e.const("true") })) }), s(function () { return n.shouldShowClear() }, { true: function () { return e.createElement(o.default, { command: t.const("clear"), ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-clear") }, onTap: function () { return n.dispatch({ type: "clear" }) } }, function () { return n.s("basic-calculator-button-controlbar-clear") }) }, false: function () { return e.createElement(o.default, { command: t.const("clearall"), disabled: function () { return !n.canClear() }, ariaLabel: function () { return n.s("basic-calculator-narration-controlbar-clear-all") }, onTap: function () { return n.dispatch({ type: "set-blank", opts: { allowUndo: !0 } }) } }, function () { return n.s("basic-calculator-button-controlbar-clear-all") }) } }), e.createElement(u, { predicate: function () { return t.props.controller().getSettingsMenu() } }, function () { return e.createElement(l.default, { controller: t.props.controller }) })) }, a }(a.DCGViewBasic); t.default = d });
define('basic/keypad/single-expression-scientific-control-bar', ["require", "exports", "tslib", "dcgview", "keypad/control-bar", "keypad/control-btn", "basic/dcgview-basic", "keypad/control-toggle"], function (require, t, e, n, r, a, c, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var i = n.Components.If, l = function (t) { function c() { return null !== t && t.apply(this, arguments) || this } return e.__extends(c, t), c.prototype.template = function () { var t = this, e = this.props.controller(); return n.createElement(r.default, { controller: this.props.controller }, n.createElement(o.default, { command: this.const("degrees"), toggled: function () { return t.model.getDegreeMode() }, defaultOption: function () { return e.s("basic-calculator-label-controlbar-rad") }, toggledOption: function () { return e.s("basic-calculator-label-controlbar-deg") }, defaultAriaLabel: function () { return e.s("basic-calculator-narration-controlbar-radians") }, toggledAriaLabel: function () { return e.s("basic-calculator-narration-controlbar-degrees") }, onTap: function () { return e.dispatch({ type: "degrees" }) }, controller: this.props.controller }), n.createElement("div", { class: n.const("dcg-spacer") }), n.createElement(i, { predicate: function () { return !t.controller.getRestrictedEditing() } }, function () { return n.createElement(a.default, { command: t.const("undo"), disabled: function () { return !e.canUndo() }, ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-undo") }, onTap: function (t) { return e.dispatch({ type: "undo", source: "keyboard" === t.device ? "button-keyboard" : "button-tap" }) } }, n.createElement("i", { class: n.const("dcg-icon-undo"), "aria-hidden": n.const("true") })) }), n.createElement(i, { predicate: function () { return !t.controller.getRestrictedEditing() } }, function () { return n.createElement(a.default, { command: t.const("redo"), disabled: function () { return !e.canRedo() }, ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-redo") }, onTap: function (t) { return e.dispatch({ type: "redo", source: "keyboard" === t.device ? "button-keyboard" : "button-tap" }) } }, n.createElement("i", { class: n.const("dcg-icon-redo"), "aria-hidden": n.const("true") })) }), n.createElement("div", { class: n.const("dcg-spacer") }), n.createElement(a.default, { narrowButton: this.const(!0), command: this.const("clear"), ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-clear") }, onTap: function () { return e.dispatch({ type: "clear" }) } }, function () { return e.s("basic-calculator-button-controlbar-clear") }), n.createElement(a.default, { narrowButton: this.const(!0), command: this.const("backspace"), ariaLabel: function () { return e.s("basic-calculator-narration-controlbar-backspace") }, onTap: function () { return e.dispatch({ type: "keypad/press-key", key: "Backspace" }) } }, n.createElement("i", { class: n.const("dcg-icon-delete"), "aria-hidden": n.const("true") }))) }, c }(c.DCGViewBasic); t.default = l });
define('basic/keypad/fourfunction-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, t, e, i, l, n, s, h) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function (t) { function l() { return null !== t && t.apply(this, arguments) || this } return e.__extends(l, t), l.prototype.template = function () { var t = this; return i.createElement("div", { role: i.const("group"), "aria-label": function () { return t.s("basic-calculator-narration-keypad") } }, i.createElement(s.default, { controller: this.props.controller }, i.createElement(h.default, null, n.view(this, "(", { colspan: this.parenColspan() }), n.view(this, ")", { colspan: this.parenColspan() }), this.makeAdditionalFunctionKey(0), this.makeAdditionalFunctionKey(1), n.view(this, "division")), i.createElement(h.default, null, n.view(this, "7", { style: "highlight" }), n.view(this, "8", { style: "highlight" }), n.view(this, "9", { style: "highlight" }), n.view(this, "multiplication")), i.createElement(h.default, null, n.view(this, "4", { style: "highlight" }), n.view(this, "5", { style: "highlight" }), n.view(this, "6", { style: "highlight" }), n.view(this, "-")), i.createElement(h.default, null, n.view(this, "1", { style: "highlight" }), n.view(this, "2", { style: "highlight" }), n.view(this, "3", { style: "highlight" }), n.view(this, "+")), i.createElement(h.default, null, n.view(this, "0", { style: "highlight" }), n.view(this, ".", { style: "highlight" }), n.view(this, "ans"), n.view(this, "enter", { style: "blue" })))) }, l.prototype.parenColspan = function () { return this.controller.getAdditionalFunctions().length > 1 ? .5 : 1 }, l.prototype.makeAdditionalFunctionKey = function (t) { var e = this.controller.getAdditionalFunctions()[t]; return "exponent" === e ? n.view(this, "a^b") : "percent" === e ? n.view(this, "%") : "sqrt" === e ? n.view(this, "sqrt") : "fraction" === e ? n.view(this, "a/b") : void 0 }, l }(l.DCGViewBasic); t.default = a });
define('basic/keypad/single-expression-fourfunction-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, t, e, i, l, n, s, h) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var o = function (t) { function l() { return null !== t && t.apply(this, arguments) || this } return e.__extends(l, t), l.prototype.template = function () { var t = this; return i.createElement("div", { role: i.const("group"), "aria-label": function () { return t.s("basic-calculator-narration-keypad") } }, i.createElement(s.default, { controller: this.props.controller }, i.createElement(h.default, null, n.view(this, "(", { colspan: this.parenColspan() }), n.view(this, ")", { colspan: this.parenColspan() }), this.makeAdditionalFunctionKey(1)), i.createElement(h.default, null, n.view(this, "7", { style: "highlight" }), n.view(this, "8", { style: "highlight" }), n.view(this, "9", { style: "highlight" }), n.view(this, "division")), i.createElement(h.default, null, n.view(this, "4", { style: "highlight" }), n.view(this, "5", { style: "highlight" }), n.view(this, "6", { style: "highlight" }), n.view(this, "multiplication")), i.createElement(h.default, null, n.view(this, "1", { style: "highlight" }), n.view(this, "2", { style: "highlight" }), n.view(this, "3", { style: "highlight" }), n.view(this, "-")), i.createElement(h.default, null, n.view(this, "0", { style: "highlight" }), n.view(this, ".", { style: "highlight", colspan: this.dotColspan() }), this.makeAdditionalFunctionKey(0), n.view(this, "+")))) }, l.prototype.parenColspan = function () { return 2 === this.controller.getAdditionalFunctions().length ? 1.5 : 2 }, l.prototype.dotColspan = function () { return this.controller.getAdditionalFunctions().length ? 1 : 2 }, l.prototype.makeAdditionalFunctionKey = function (t) { var e = this.controller.getAdditionalFunctions()[t]; return "exponent" === e ? n.view(this, "a^b") : "percent" === e ? n.view(this, "%") : "sqrt" === e ? n.view(this, "sqrt") : void 0 }, l }(l.DCGViewBasic); t.default = o });
define('basic/keypad/single-expression-scientific-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, l, h, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var c = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(h.default, { controller: this.props.controller }, t.createElement(a.default, null, l.view(this, "("), l.view(this, ")"), l.view(this, "x^2"), l.view(this, "sqrt"), t.createElement("div", { class: t.const("dcg-partition-placeholder") }), l.view(this, "x^3"), l.view(this, "x^y"), l.view(this, "ythroot")), t.createElement(a.default, null, l.view(this, "7", { style: "highlight" }), l.view(this, "8", { style: "highlight" }), l.view(this, "9", { style: "highlight" }), l.view(this, "division"), t.createElement("div", { class: t.const("dcg-partition-placeholder") }), l.view(this, "pi"), l.view(this, "e^x"), l.view(this, "!")), t.createElement(a.default, null, l.view(this, "4", { style: "highlight" }), l.view(this, "5", { style: "highlight" }), l.view(this, "6", { style: "highlight" }), l.view(this, "multiplication"), t.createElement("div", { class: t.const("dcg-partition-placeholder") }), l.view(this, "log"), l.view(this, "ln"), l.view(this, "|x|")), t.createElement(a.default, null, l.view(this, "1", { style: "highlight" }), l.view(this, "2", { style: "highlight" }), l.view(this, "3", { style: "highlight" }), l.view(this, "-"), t.createElement("div", { class: t.const("dcg-partition-placeholder") }), l.view(this, "sin"), l.view(this, "cos"), l.view(this, "tan")), t.createElement(a.default, null, l.view(this, "0", { style: "highlight" }), l.view(this, ".", { style: "highlight" }), l.view(this, "x/y"), l.view(this, "+"), t.createElement("div", { class: t.const("dcg-partition-placeholder") }), l.view(this, "arcsin"), l.view(this, "arccos"), l.view(this, "arctan"))) }, s }(s.DCGViewBasic); e.default = c });
define('basic/keypad/sci-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, t, i, l, s, h, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var a = i.Components.IfElse, c = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return t.__extends(l, e), l.prototype.template = function () { var e = this; return i.createElement(h.default, { controller: this.props.controller }, i.createElement(n.default, null, s.view(this, "a^2"), s.view(this, "a^b"), s.view(this, "|a|"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "7", { style: "highlight" }), s.view(this, "8", { style: "highlight" }), s.view(this, "9", { style: "highlight" }), s.view(this, "division"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "%"), s.view(this, "a/b")), i.createElement(n.default, null, s.view(this, "sqrt"), s.view(this, "nthroot"), s.view(this, "pi"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "4", { style: "highlight" }), s.view(this, "5", { style: "highlight" }), s.view(this, "6", { style: "highlight" }), s.view(this, "multiplication"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "left", { style: "highlight" }), s.view(this, "right", { style: "highlight" })), i.createElement(n.default, null, s.view(this, "sin"), s.view(this, "cos"), s.view(this, "tan"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "1", { style: "highlight" }), s.view(this, "2", { style: "highlight" }), s.view(this, "3", { style: "highlight" }), s.view(this, "-"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.spacer(.5), s.view(this, "backspace", { style: "highlight", colspan: 1.5 })), i.createElement(n.default, null, s.view(this, "("), s.view(this, ")"), a(function () { return e.controller.getReplaceCommaWith10Exp() }, { true: function () { return s.view(e, "10^n") }, false: function () { return s.view(e, ",") } }), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "0", { style: "highlight" }), s.view(this, ".", { style: "highlight" }), s.view(this, "ans"), s.view(this, "+"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "enter", { style: "blue", colspan: 2 }))) }, l }(l.DCGViewBasic); e.default = c });
define('basic/keypad/sci-qwerty-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var w = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(v.default, null, h.view(this, "q"), h.view(this, "w"), h.view(this, "e"), h.view(this, "r"), h.view(this, "t"), h.view(this, "y"), h.view(this, "u"), h.view(this, "i"), h.view(this, "o"), h.view(this, "p")), t.createElement(v.default, null, t.createElement("div", { class: t.const("dcg-half-width-placeholder") }), h.view(this, "a"), h.view(this, "s"), h.view(this, "d"), h.view(this, "f"), h.view(this, "g"), h.view(this, "h"), h.view(this, "j"), h.view(this, "k"), h.view(this, "l"), t.createElement("div", { class: t.const("dcg-half-width-placeholder") })), t.createElement(v.default, null, h.view(this, "=", { style: "highlight" }), h.view(this, "z"), h.view(this, "x"), h.view(this, "c"), h.view(this, "v"), h.view(this, "b"), h.view(this, "n"), h.view(this, "m"), h.view(this, ","), h.view(this, "backspace", { style: "highlight" })), t.createElement(v.default, null, h.view(this, "shift", { style: "highlight", colspan: 1.5 }), h.view(this, "("), h.view(this, ")"), h.view(this, "["), h.view(this, "]"), h.view(this, "!"), h.view(this, "'"), h.view(this, "pi"), h.view(this, "enter", { style: "blue", colspan: 1.5 }))) }, s }(s.DCGViewBasic); e.default = w });
define('basic/keypad/sci-letters-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, v, w) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var l = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(v.default, { controller: this.props.controller }, t.createElement(w.default, null, h.view(this, "a"), h.view(this, "b"), h.view(this, "c"), h.view(this, "d"), h.view(this, "e"), h.view(this, "f"), h.view(this, "g"), h.view(this, "h"), h.view(this, "i"), h.view(this, "j")), t.createElement(w.default, null, h.view(this, "k"), h.view(this, "l"), h.view(this, "m"), h.view(this, "n"), h.view(this, "o"), h.view(this, "p"), h.view(this, "q"), h.view(this, "r"), h.view(this, "s"), h.view(this, "t")), t.createElement(w.default, null, h.view(this, "=", { style: "highlight" }), h.view(this, ","), h.view(this, "u"), h.view(this, "v"), h.view(this, "w"), h.view(this, "x"), h.view(this, "y"), h.view(this, "z"), h.view(this, "pi"), h.view(this, "backspace", { style: "highlight" })), t.createElement(w.default, null, h.view(this, "shift", { style: "highlight", colspan: 2 }), h.view(this, "("), h.view(this, ")"), h.view(this, "["), h.view(this, "]"), h.view(this, "!"), h.view(this, "'"), h.view(this, "enter", { style: "blue", colspan: 2 }))) }, s }(s.DCGViewBasic); e.default = l });
define('basic/keypad/sci-capital-qwerty-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var w = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(v.default, null, h.view(this, "Q"), h.view(this, "W"), h.view(this, "E"), h.view(this, "R"), h.view(this, "T"), h.view(this, "Y"), h.view(this, "U"), h.view(this, "I"), h.view(this, "O"), h.view(this, "P")), t.createElement(v.default, null, t.createElement("div", { class: t.const("dcg-half-width-placeholder") }), h.view(this, "A"), h.view(this, "S"), h.view(this, "D"), h.view(this, "F"), h.view(this, "G"), h.view(this, "H"), h.view(this, "J"), h.view(this, "K"), h.view(this, "L"), t.createElement("div", { class: t.const("dcg-half-width-placeholder") })), t.createElement(v.default, null, h.view(this, "=", { style: "highlight" }), h.view(this, "Z"), h.view(this, "X"), h.view(this, "C"), h.view(this, "V"), h.view(this, "B"), h.view(this, "N"), h.view(this, "M"), h.view(this, ","), h.view(this, "backspace", { style: "highlight" })), t.createElement(v.default, null, h.view(this, "shift", { style: "highlight", colspan: 1.5 }), h.view(this, "("), h.view(this, ")"), h.view(this, "["), h.view(this, "]"), h.view(this, "!"), h.view(this, "'"), h.view(this, "pi"), h.view(this, "enter", { style: "blue", colspan: 1.5 }))) }, s }(s.DCGViewBasic); e.default = w });
define('basic/keypad/sci-capital-letters-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, v, w) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var l = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(v.default, { controller: this.props.controller }, t.createElement(w.default, null, h.view(this, "A"), h.view(this, "B"), h.view(this, "C"), h.view(this, "D"), h.view(this, "E"), h.view(this, "F"), h.view(this, "G"), h.view(this, "H"), h.view(this, "I"), h.view(this, "J")), t.createElement(w.default, null, h.view(this, "K"), h.view(this, "L"), h.view(this, "M"), h.view(this, "N"), h.view(this, "O"), h.view(this, "P"), h.view(this, "Q"), h.view(this, "R"), h.view(this, "S"), h.view(this, "T")), t.createElement(w.default, null, h.view(this, "=", { style: "highlight" }), h.view(this, ","), h.view(this, "U"), h.view(this, "V"), h.view(this, "W"), h.view(this, "X"), h.view(this, "Y"), h.view(this, "Z"), h.view(this, "pi"), h.view(this, "backspace", { style: "highlight" })), t.createElement(w.default, null, h.view(this, "shift", { style: "highlight", colspan: 2 }), h.view(this, "("), h.view(this, ")"), h.view(this, "["), h.view(this, "]"), h.view(this, "!"), h.view(this, "'"), h.view(this, "enter", { style: "blue", colspan: 2 }))) }, s }(s.DCGViewBasic); e.default = l });
define('basic/keypad/sci-functions-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, t, i, s, n, l, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = i.Components.IfElse, a = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-sci-func-keypad") }, i.createElement(l.default, { controller: this.props.controller }, i.createElement(c.default, null, n.view(this, "sin"), n.view(this, "cos"), n.view(this, "tan"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), n.view(this, "a^b"), n.view(this, "sqrt"), n.view(this, "nthroot")), i.createElement(c.default, null, n.view(this, "arcsin"), n.view(this, "arccos"), n.view(this, "arctan"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), n.view(this, "e^x"), n.view(this, "abs"), r(function () { return e.controller.getReplaceRoundWithReciprocal() }, { true: function () { return n.view(e, "a^{-1}") }, false: function () { return n.view(e, "round") } })), i.createElement(c.default, null, n.view(this, "mean"), n.view(this, "stdev"), n.view(this, "stdevp"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), n.view(this, "ln"), n.view(this, "log"), n.view(this, "backspace", { style: "highlight" })), i.createElement(c.default, null, n.view(this, "nPr"), n.view(this, "nCr"), n.view(this, "!"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), n.view(this, "e"), n.view(this, "pi"), n.view(this, "enter", { style: "blue" })))) }, s }(s.DCGViewBasic); e.default = a });
define('basic/keypad/scientific-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "./sci-keypad", "./sci-qwerty-keypad", "./sci-letters-keypad", "./sci-capital-qwerty-keypad", "./sci-capital-letters-keypad", "./sci-functions-keypad"], function (require, e, t, r, n, o, l, c, a, i, u) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var s = r.Components.SwitchUnion, p = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { var e = this; return r.createElement("div", { role: r.const("group"), "aria-label": function () { return e.s("basic-calculator-narration-keypad") } }, s(function () { return e.controller.getKeyboardMode() }, { qwerty: function () { return r.createElement(l.default, { controller: e.props.controller }) }, letters: function () { return r.createElement(c.default, { controller: e.props.controller }) }, capitalQwerty: function () { return r.createElement(a.default, { controller: e.props.controller }) }, capitalLetters: function () { return r.createElement(i.default, { controller: e.props.controller }) }, functions: function () { return r.createElement(u.default, { controller: e.props.controller }) }, main: function () { return r.createElement(o.default, { controller: e.props.controller }) } })) }, n }(n.DCGViewBasic); e.default = p });

define('loadcss!basic/keypad/braille-example-row', function () { });
define('basic/keypad/braille-example-row', ["require", "exports", "tslib", "dcgview", "dcgview-helpers/static-mathquill-view", "abraham", "loadcss!./braille-example-row"], function (require, e, t, r, l, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.BrailleExampleRow = void 0; var i = r.Components.For, a = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.template = function () { var e = this; return r.createElement("tr", null, r.createElement(i, { each: function () { return e.getBrailleAscii(e.props.latex()) }, key: function (e) { return e.key } }, r.createElement("td", null, function (e) { return r.createElement("span", { class: r.const("dcg-key-press") }, function () { return e.char }) })), r.createElement("td", { class: r.const("dcg-braille-font") }, function () { return e.getBrailleUnicode(e.props.latex()) }), r.createElement("td", null, r.createElement(l.default, { config: this.const({}), latex: function () { return e.props.latex() } }))) }, a.prototype.getBrailleAscii = function (e) { for (var t = n.UnicodeBraille.toExpandedBrailleAscii(this.getBrailleUnicode(e)), r = [], l = 0; l < t.length; l++)r.push({ char: t[l], key: l + ")" + t[l] }); return r }, a.prototype.getBrailleUnicode = function (e) { var t; return "nemeth" === this.props.brailleMode() ? t = n.latexToNemeth(e) : "ueb" === this.props.brailleMode() && (t = n.latexToUeb(e)), t && t.value ? t.value : "" }, a }(r.Class); e.BrailleExampleRow = a });

define('loadcss!basic/keypad/braille-keypad', function () { });
define('basic/keypad/braille-keypad', ["require", "exports", "tslib", "dcgview", "basic/dcgview-basic", "./braille-example-row", "loadcss!./braille-keypad"], function (require, e, t, l, r, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var a = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return l.createElement("div", { class: function () { return { "dcg-braille-io-keypad-container": !0, "dcg-has-background-color": e.controller.hasBackgroundColor() } } }, l.createElement("div", { class: l.const("dcg-braille-io-keypad") }, l.createElement("div", { class: l.const("dcg-braille-description") }, l.createElement("div", { class: l.const("dcg-braille-title") }, function () { return e.controller.s("basic-calculator-text-braille-mode-is-on", { mode: e.brailleType() }) }), l.createElement("div", { class: l.const("dcg-braille-info-text") }, function () { return e.controller.s("basic-calculator-text-how-to-type-braille") }), l.createElement("div", { class: l.const("dcg-blue-btn"), role: l.const("button"), tabindex: l.const(0), onTap: function () { return e.controller.dispatch({ type: "set-braille-mode", mode: "none" }) } }, function () { return e.controller.s("basic-calculator-button-turn-braille-mode-off", { mode: e.brailleType() }) })), l.createElement("div", { class: l.const("dcg-braille-examples-table-container") }, l.createElement("table", { class: l.const("dcg-braille-examples-table") }, l.createElement("tr", null, l.createElement("th", null, function () { return e.controller.s("basic-calculator-heading-braille-table-type-this") }), l.createElement("th", null, function () { return e.brailleType() }), l.createElement("th", null, function () { return e.controller.s("basic-calculator-heading-braille-table-typeset") })), l.createElement(n.BrailleExampleRow, { brailleMode: function () { return e.controller.getBrailleMode() }, latex: this.const("2+2") }), l.createElement(n.BrailleExampleRow, { brailleMode: function () { return e.controller.getBrailleMode() }, latex: this.const("\\frac{1}{2}") }), l.createElement(n.BrailleExampleRow, { brailleMode: function () { return e.controller.getBrailleMode() }, latex: this.const("\\sqrt{4}") })), l.createElement("div", { class: l.const("dcg-more-examples-link") }, l.createElement("a", { href: function () { return "https://www.desmos.com/braille-examples?" + e.controller.getBrailleMode() }, target: l.const("_blank") }, function () { return e.controller.s("basic-calculator-link-view-braille-examples") }))))) }, r.prototype.brailleType = function () { return "nemeth" === this.controller.getBrailleMode() ? "Nemeth" : "ueb" === this.controller.getBrailleMode() ? "UEB" : "" }, r }(r.DCGViewBasic); e.default = a });
define('lib/abraham-helpers', ["require", "exports", "abraham"], function (require, e, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.brailleToLatex = e.latexToBraille = void 0, e.latexToBraille = function (e, o) { return "nemeth" === o ? r.latexToNemeth(e) : "ueb" === o ? r.latexToUeb(e) : { isError: !0, error: "Braille mode should be 'nemeth' or 'ueb'" } }, e.brailleToLatex = function (e, o) { return "nemeth" === o ? r.nemethToLatex(e) : "ueb" === o ? r.uebToLatex(e) : { isError: !0, error: "Braille mode should be 'nemeth' or 'ueb'" } } });

define('loadcss!Abraham', function () { });

define('loadcss!basic/expression-view', function () { });
define('basic/expression-view', ["require", "exports", "tslib", "keys", "core/lib/label", "dcgview", "lib/i18n", "jquery", "dcgview-helpers/static-mathquill-view", "dcgview-helpers/mathquill-view", "./dcgview-basic", "abraham", "../shared-components/tooltip", "../lib/abraham-helpers", "main/mathquill-operators", "../shared-components/braille-input", "../core/lib/count-latex-tokens", "loadcss!Abraham", "loadcss!./expression-view"], function (require, t, e, n, i, o, r, a, s, l, c, u, d, p, h, g, f) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var y = o.Components, E = y.If, v = y.Input, b = y.Textarea, m = function (t) { function c() { return null !== t && t.apply(this, arguments) || this } return e.__extends(c, t), c.prototype.getAriaLabel = function () { var t = this.getIndex() + 1 + ""; return this.s("shared-calculator-narration-expression-index", { index: t }) }, c.prototype.didUpdate = function () { this.renderAnsValue() }, c.prototype.didMountMQ = function (t) { this.$mq = a(t) }, c.prototype.getExp = function () { return this.model.getExpressionById(this.props.id()) }, c.prototype.getAns = function () { return this.model.getExpressionAns(this.props.id()) }, c.prototype.getAnsId = function () { return this.model.getExpressionAnsId(this.props.id()) }, c.prototype.getLatex = function () { return this.getExp().latex }, c.prototype.getValue = function () { return this.model.getExpressionValue(this.props.id()) }, c.prototype.getBraille = function () { var t = this.getExp().braille; if ("" !== t) return t; var e = p.latexToBraille(this.getLatex(), this.controller.getBrailleMode()); return e.isError ? "" : u.UnicodeBraille.toExpandedBrailleAscii(e.value) }, c.prototype.getIndex = function () { return this.model.getExpressionIndex(this.props.id()) }, c.prototype.getShowEvaluation = function () { return this.model.shouldShowEvaluationForExpression(this.props.id()) }, c.prototype.isFractionEvaluation = function () { return this.getExp().displayAsFraction }, c.prototype.canDisplayEvaluationAsFraction = function () { return this.controller.getDecimalToFraction() && this.model.canDisplayEvaluationAsFraction(this.props.id()) }, c.prototype.shouldDisplayEvaluationAsFraction = function () { return this.canDisplayEvaluationAsFraction() && this.getExp().displayAsFraction }, c.prototype.toggleFractionEvaluation = function () { this.dispatch({ type: "toggle-fraction-evaluation", id: this.props.id() }) }, c.prototype.getFractionDisplayAriaLabel = function () { return this.shouldDisplayEvaluationAsFraction() ? this.controller.s("basic-calculator-narration-convert-to-decimal") : this.controller.s("basic-calculator-narration-convert-to-fraction") }, c.prototype.getError = function () { var t = this.model.getExpressionError(this.props.id()); return t && this.getLatex().length > 0 ? r.unpack(t, this.controller.getLanguage()) : "" }, c.prototype.showError = function () { return !!this.getError() }, c.prototype.getFractionMessage = function () { return this.shouldDisplayEvaluationAsFraction() ? this.s("basic-calculator-label-convert-to-decimal") : this.s("basic-calculator-label-convert-to-fraction") }, c.prototype.getIsFocused = function () { return !this.controller.isSettingsMenuOpen() && this.model.isExpressionFocused(this.props.id()) }, c.prototype.onFocusedChanged = function (t) { this.getExp() && (t ? this.dispatch({ type: "focusin", id: this.props.id() }) : this.dispatch({ type: "focusout", id: this.props.id() })) }, c.prototype.onMQReflow = function () { this.renderedAnsData = void 0, this.renderAnsValue() }, c.prototype.renderAnsValue = function () { var t = this; if (this.$mq) { var e = this.getAns(), n = !1, o = this.getAnsId(); if (o) { var r = this.model.getExpressionById(o); n = r && r.displayAsFraction } this.renderedAnsData && this.renderedAnsData.value == e && this.renderedAnsData.displayAsFraction === n || (this.renderedAnsData = { value: e, displayAsFraction: n }, this.$mq.find(".dcg-mq-ans").each(function (o, r) { var s, l = a(r); "number" == typeof e ? s = i.truncatedHTMLLabel(e, { digits: t.getEvaluationDigits(), bigCutoff: 1e9, displayAsFraction: n }) : "string" == typeof e && (s = e), s ? l.removeClass("dcg-invalid").html(s) : l.addClass("dcg-invalid").html('<i class="dcg-icon-error" aria-hidden="true"></i>') })) } }, c.prototype.getEvaluationLatex = function () { var t = this.getValue(); if (void 0 === t && (t = NaN), this.model.isRationalizableConstant(this.props.id()) && !this.shouldDisplayEvaluationAsFraction()) return ""; if (!Array.isArray(t)) { var e = i.truncatedLatexLabel(t, { digits: this.getEvaluationDigits(), bigCutoff: 1e9, displayAsFraction: this.shouldDisplayEvaluationAsFraction() }); return "undefined" === e ? "=\\mathrm{undefined}" : "=" + e } return "\\mathrm{" + t.length + "\\ element\\ list}" }, c.prototype.getEvaluationBraille = function () { var t = this.getEvaluationLatex(), e = p.latexToBraille(t, this.controller.getBrailleMode()); return e.isError ? "" : u.UnicodeBraille.toExpandedBrailleAscii(e.value) }, c.prototype.didMountBrailleInput = function (t) { this.brailleInputNode = t }, c.prototype.didUnmountBrailleInput = function () { this.brailleInputNode = void 0 }, c.prototype.handleBrailleFocus = function (t) { var e = t.target; e && setTimeout(function () { e.setSelectionRange(0, 0) }) }, c.prototype.handleBrailleKeydown = function (t) { t.altKey || t.ctrlKey || t.metaKey || t.shiftKey || (n.lookup(t) === n.UP ? (this.forceModelFocus(), this.dispatch({ type: "focus-prev-expression" }), t.preventDefault()) : n.lookup(t) === n.DOWN ? (this.forceModelFocus(), this.dispatch({ type: "focus-next-expression" }), t.preventDefault()) : n.lookup(t) === n.ENTER ? (this.forceModelFocus(), this.dispatch({ type: "insert-blank-expression" }), t.preventDefault()) : n.lookup(t) === n.BACKSPACE && document.activeElement === this.brailleInputNode && "" === this.getBraille() && (this.dispatch({ type: "backspace-from-braille" }), t.preventDefault())) }, c.prototype.forceModelFocus = function () { document.activeElement !== this.brailleInputNode && this.onFocusedChanged(!0) }, c.prototype.focusBrailleInput = function () { this.brailleInputNode && document.activeElement !== this.brailleInputNode && this.brailleInputNode.focus() }, c.prototype.getPostLabel = function () { if (this.showError()) return this.getError(); if (this.getShowEvaluation()) { var t = this.getValue(); return void 0 === t && (t = NaN), Array.isArray(t) ? t.length + " element list" : "equals " + i.truncatedAriaLabel(t, { digits: this.getEvaluationDigits(), bigCutoff: 1e9, displayAsFraction: this.shouldDisplayEvaluationAsFraction() }) } return "" }, c.prototype.onBrailleInput = function (t) { this.controller.isSettingsMenuOpen() && this.controller.dispatch({ type: "close-settings-menu" }); var e = p.brailleToLatex(u.UnicodeBraille.coerceToSixDotCells(t), this.controller.getBrailleMode()), n = e.isError ? "" : e.value; (!this.controller.getCapExpressionSize() || f.countLatexTokens(n) <= l.EXPRESSION_TOKEN_LIMIT) && this.controller.dispatch({ type: "update-latex-from-braille", latex: n, braille: t, id: this.props.id() }) }, c.prototype.getIndexSubscript = function () { return "_{" + (this.getIndex() + 1) + "}" }, c.prototype.getEvaluationDigits = function () { return this.controller.isScientificCalc() ? 10 : 7 }, c.prototype.onMountContainer = function (t) { this.containerNode = t }, c.prototype.onTapContainer = function (t) { t.target !== this.containerNode || this.getShowEvaluation() || this.showError() || this.forceModelFocus() }, c.prototype.template = function () { var t = this; return o.createElement("div", { class: function () { return { "dcg-basic-expression": !0, "dcg-focused": t.getIsFocused(), "dcg-braille-io": t.controller.renderAsBraille() } }, onTap: this.bindFn(this.onTapContainer), onMount: this.bindFn(this.onMountContainer) }, o.createElement(E, { predicate: function () { return t.controller.renderAsBraille() } }, function () { return o.createElement("div", { class: o.const("dcg-braille-input") }, o.createElement(g.default, { ariaLabel: function () { var e = p.latexToBraille("eq" + t.getIndexSubscript(), t.controller.getBrailleMode()); return e.isError ? "" : u.UnicodeBraille.toExpandedBrailleAscii(e.value) }, didMount: t.bindFn(t.didMountBrailleInput), didUnmount: t.bindFn(t.didUnmountBrailleInput), onFocusedChanged: t.bindFn(t.onFocusedChanged), shouldFocus: t.bindFn(t.getIsFocused), onKeydown: t.bindFn(t.handleBrailleKeydown), onInput: t.bindFn(t.onBrailleInput), sixKeyInput: function () { return t.controller.getSixKeyInput() }, value: function () { return t.getBraille() }, isStatic: t.const(!1) })) }), o.createElement(E, { predicate: function () { return t.controller.renderAsBraille() } }, function () { return o.createElement("div", { class: o.const("dcg-braille-evaluation-container") }, o.createElement(E, { predicate: function () { return t.getShowEvaluation() } }, function () { return o.createElement("div", { class: o.const("dcg-braille-evaluation") }, o.createElement(v, { readonly: t.const("true"), class: t.const("dcg-braille-evaluation-inner"), value: function () { return t.getEvaluationBraille() }, onFocus: t.bindFn(t.handleBrailleFocus), onKeydown: t.bindFn(t.handleBrailleKeydown), onInput: function () { } })) }), o.createElement(E, { predicate: function () { return t.showError() } }, function () { return o.createElement("div", { class: o.const("dcg-braille-error") }, o.createElement("div", { class: o.const("dcg-basic-expression-error") }, o.createElement("i", { class: o.const("dcg-icon-error"), "aria-hidden": o.const("true") })), o.createElement(b, { readonly: t.const("true"), class: t.const("dcg-braille-error-inner"), value: function () { return t.getError() }, onFocus: t.bindFn(t.handleBrailleFocus), onKeydown: t.bindFn(t.handleBrailleKeydown), onInput: function () { } })) })) }), o.createElement(E, { predicate: function () { return t.controller.renderAsBraille() } }, function () { return o.createElement("div", { class: o.const("dcg-exp-mathquill-container"), didMount: t.bindFn(t.didMountMQ), onTap: t.bindFn(t.forceModelFocus) }, o.createElement(s.default, { latex: function () { return t.getLatex() }, config: t.const({}), onReflow: t.bindFn(t.onMQReflow) })) }), o.createElement(E, { predicate: function () { return !t.controller.renderAsBraille() } }, function () { return o.createElement("div", { class: o.const("dcg-exp-mathquill-container"), didMount: t.bindFn(t.didMountMQ) }, o.createElement(l.default, { latex: function () { return t.getLatex() }, onReflow: t.bindFn(t.onMQReflow), isFocused: t.bindFn(t.getIsFocused), capExpressionSize: function () { return t.controller.getCapExpressionSize() }, config: t.bindFn(t.getMQConfig), getAriaLabel: function () { return t.getAriaLabel() }, getAriaPostLabel: function () { return t.getPostLabel() }, hasError: function () { return !1 }, onUserPressedKey: function (e, n) { t.controller.isSettingsMenuOpen() && t.controller.dispatch({ type: "close-settings-menu" }), t.dispatch({ type: "keypad/press-key", key: e, evt: n }) }, onUserTypedText: function (e) { return t.dispatch({ type: "keypad/type-text", text: e }) }, onUserChangedLatex: function (e) { t.dispatch({ type: "update-latex", id: t.props.id(), latex: e }) }, onFocusedChanged: t.bindFn(t.onFocusedChanged), disableSpace: function () { return t.controller.getRestrictedEditing() } })) }), o.createElement("div", { class: o.const("dcg-exp-output-container") }, o.createElement(E, { predicate: function () { return t.showError() && !t.controller.renderAsBraille() } }, function () { return o.createElement(d.Tooltip, { tooltip: t.bindFn(t.getError), gravity: t.const("w"), sticky: t.const(!0) }, o.createElement("div", { class: o.const("dcg-basic-expression-error") }, o.createElement("i", { class: o.const("dcg-icon-error"), "aria-hidden": o.const("true") }))) }), o.createElement(E, { predicate: function () { return t.getShowEvaluation() } }, function () { return o.createElement("div", { class: function () { return { "dcg-basic-expression-value": !0, "dcg-basic-evaluation-gray": Array.isArray(t.getValue()) } } }, o.createElement(s.default, { config: t.const({}), latex: function () { return t.getEvaluationLatex() } }), o.createElement(E, { predicate: t.bindFn(t.canDisplayEvaluationAsFraction) }, function () { return o.createElement(d.Tooltip, { tooltip: t.bindFn(t.getFractionMessage), gravity: t.const("sw") }, o.createElement("span", { role: o.const("button"), tabindex: o.const("0"), "aria-label": t.bindFn(t.getFractionDisplayAriaLabel), class: function () { return { "dcg-basic-fraction-toggle": !0, "dcg-selected": t.isFractionEvaluation() } }, onTap: t.bindFn(t.toggleFractionEvaluation) }, o.createElement("i", { class: o.const("dcg-icon-fraction"), "aria-hidden": o.const("true") }))) })) }))) }, c.prototype.getMQConfig = function () { var t = this.controller, e = t.getAdditionalFunctions(), n = t.isFourFunctionCalc() && (!e || -1 === e.indexOf("fraction")); return { typingAsteriskWritesTimesSymbol: t.getTypingAsteriskWritesTimesSymbol(), typingSlashWritesDivisionSymbol: t.getTypingSlashWritesDivisionSymbol(), disableCopyPaste: t.getRestrictedEditing(), autoCommands: h.getAutoCommands({ disallowFrac: n }) } }, c }(c.DCGViewBasic); t.default = m });

define('loadcss!basic/basic-list-view', function () { });
define('basic/basic-list-view', ["require", "exports", "tslib", "scroll_helpers", "dcgview", "./dcgview-basic", "./expression-view", "jquery", "lib/conditional_blur", "loadcss!./basic-list-view"], function (require, e, t, n, i, r, o, s, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var d = i.Components, l = d.For, a = d.If, u = function (e) { function r() { var t = null !== e && e.apply(this, arguments) || this; return t.didShowAnswerHint = !1, t.didHideAnswerHint = !1, t } return t.__extends(r, e), r.prototype.template = function () { var e = this; return i.createElement("div", { class: i.const("dcg-basic-list-container"), role: i.const("complementary"), "aria-label": function () { return e.controller.s("basic-calculator-narration-expression-list") }, didMount: this.bindFn(this.didMountContainer) }, i.createElement("div", { class: i.const("dcg-basic-list-placeholder"), didMount: this.bindFn(this.didMountPlaceholder) }, i.createElement(a, { predicate: this.bindFn(this.showAnswerHint) }, function () { return i.createElement("div", { class: i.const("dcg-answer-hint") }, function () { return e.controller.s("basic-calculator-label-answer-hint") }) })), i.createElement(l, { each: function () { return e.model.getExpressionOrder() } }, i.createElement("div", { class: function () { return { "dcg-basic-list": !0, "dcg-projector-mode": e.controller.isProjectorMode() } } }, function (t) { return i.createElement(o.default, { controller: e.props.controller, id: e.const(t) }) }))) }, r.prototype.didMountPlaceholder = function (e) { s(e).on("dcg-tap", c.default) }, r.prototype.showAnswerHint = function () { if (this.didHideAnswerHint) return !1; var e = this.model.getExpressionOrder()[0]; return !(!this.model.shouldShowEvaluationForExpression(e) && !this.didShowAnswerHint) && (this.didShowAnswerHint = !0, !(this.model.getNumberOfExpressions() > 1 || "" === this.model.getExpressionLatex(e)) || (this.didHideAnswerHint = !0, !1)) }, r.prototype.didUpdate = function () { if (this.$container) { var e = this.$container.find(".dcg-focused"); e.length > 0 && n.scrollVisible(e, this.$container, 50) } }, r.prototype.didMountContainer = function (e) { this.$container = s(e) }, r }(r.DCGViewBasic); e.default = u });

define('loadcss!basic/main', function () { });
define('basic/main', ["require", "exports", "tslib", "browser", "keys", "dcgview", "./dcgview-basic", "jquery", "./keypad/fourfunction-control-bar", "./keypad/single-expression-fourfunction-control-bar", "./keypad/scientific-control-bar", "./keypad/single-expression-scientific-control-bar", "./keypad/fourfunction-keypad", "./keypad/single-expression-fourfunction-keypad", "./keypad/single-expression-scientific-keypad", "./keypad/scientific-keypad", "./keypad/braille-keypad", "./basic-list-view", "lib/aria", "touchtracking", "loadcss!desmos-icons", "loadcss!./main", "loadcss!dcg-normalize"], function (require, e, r, t, n, o, l, c, i, a, s, u, d, p, f, m, y, h, g, E) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var b = o.Components, k = b.If, v = b.IfElse, C = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return r.__extends(l, e), l.prototype.template = function () { var e = this; return o.createElement(k, { predicate: function () { return e.controller.shouldRender() } }, function () { return o.createElement("div", { class: o.const("dcg-calculator-api-container"), style: o.const("width: 100%; height: 100%; position: relative;") }, o.createElement("div", { class: function () { return { "dcg-calc-basic-main-wrapper": !0, "dcg-narrow": e.controller.containerSize.width < 570, "dcg-short": e.controller.containerSize.height <= 540, "dcg-scientific-calculator": e.controller.isScientificCalc(), "dcg-four-function-calculator": e.controller.isFourFunctionCalc(), "dcg-container": !0 } }, onKeydown: e.bindFn(e.handleRootKeydown), didMount: e.bindFn(e.didMountRoot), "x-ms-format-detection": o.const("none") }, o.createElement("div", { role: o.const("application"), "aria-label": function () { return e.controller.isScientificCalc() ? e.controller.s("basic-calculator-narration-calc-description-scientific") : e.controller.isFourFunctionCalc() ? e.controller.s("basic-calculator-narration-calc-description-fourfunction") : "" }, class: function () { return { "dcg-calc-basic-main": !0, "dcg-inverted-colors": e.controller.getInvertedColors(), "dcg-projector-mode": e.controller.isProjectorMode(), "dcg-ipad": t.IS_IPAD, "dcg-has-background-color": e.controller.hasBackgroundColor(), "dcg-no-hyperlinks": !e.controller.getAllowLinks() } }, style: function () { return { "font-size": e.controller.getFontSize() + "px", background: e.controller.getBackgroundColor(), color: e.controller.getTextColor(), filter: e.controller.getInvertedColors() ? "invert(100%)" : "none" } } }, o.createElement(h.default, { controller: e.props.controller }), o.createElement(k, { predicate: function () { return e.controller.isScientificCalc() && e.model.isSingleExpression() } }, function () { return o.createElement("div", null, o.createElement(u.default, { controller: e.props.controller }), o.createElement("div", { class: o.const("dcg-basic-keypad-container") }, v(function () { return e.controller.renderAsBraille() }, { true: function () { return o.createElement(y.default, { controller: e.props.controller }) }, false: function () { return o.createElement(f.default, { controller: e.props.controller }) } }))) }), o.createElement(k, { predicate: function () { return e.controller.isScientificCalc() && !e.model.isSingleExpression() } }, function () { return o.createElement("div", null, o.createElement(s.default, { controller: e.props.controller }), o.createElement("div", { class: o.const("dcg-basic-keypad-container") }, v(function () { return e.controller.renderAsBraille() }, { true: function () { return o.createElement(y.default, { controller: e.props.controller }) }, false: function () { return o.createElement(m.default, { controller: e.props.controller }) } }))) }), o.createElement(k, { predicate: function () { return e.controller.isFourFunctionCalc() && e.model.isSingleExpression() } }, function () { return o.createElement("div", null, o.createElement(a.default, { controller: e.props.controller }), o.createElement("div", { class: o.const("dcg-basic-keypad-container") }, v(function () { return e.controller.renderAsBraille() }, { true: function () { return o.createElement(y.default, { controller: e.props.controller }) }, false: function () { return o.createElement(p.default, { controller: e.props.controller }) } }))) }), o.createElement(k, { predicate: function () { return e.controller.isFourFunctionCalc() && !e.model.isSingleExpression() } }, function () { return o.createElement("div", null, o.createElement(i.default, { controller: e.props.controller }), o.createElement("div", { class: o.const("dcg-basic-keypad-container") }, v(function () { return e.controller.renderAsBraille() }, { true: function () { return o.createElement(y.default, { controller: e.props.controller }) }, false: function () { return o.createElement(d.default, { controller: e.props.controller }) } }))) })))) }) }, l.prototype.didMountRoot = function (e) { E.monitor(e) }, l.prototype.handleRootKeydown = function (e) { if (n.isUndo(e)) return this.dispatch({ type: "undo", source: "keyboard-shortcut" }), !1; if (n.isRedo(e)) return this.dispatch({ type: "redo", source: "keyboard-shortcut" }), !1; if (!e.metaKey && !e.shiftKey) if (e.ctrlKey || e.altKey || n.lookup(e) !== n.BACKSPACE) { if (e.ctrlKey === t.IS_APPLE && e.altKey === !t.IS_APPLE) { var r = n.lookupChar(e); if ("N" === r) { if (!this.controller.getBrailleControls()) return; return this.dispatch({ type: "set-braille-mode", mode: "nemeth" }), g.alert(this.controller.s("basic-calculator-narration-hotkey-nemeth")), !1 } if ("U" === r) { if (!this.controller.getBrailleControls()) return; return this.dispatch({ type: "set-braille-mode", mode: "ueb" }), g.alert(this.controller.s("basic-calculator-narration-hotkey-ueb")), !1 } if ("Q" === r || "X" === r) { if (!this.controller.getBrailleControls()) return; return this.dispatch({ type: "set-braille-mode", mode: "none" }), g.alert(this.controller.s("basic-calculator-narration-hotkey-braille-off")), !1 } if ("6" === r) { if (!this.controller.getBrailleControls()) return; var o = !this.controller.getSixKeyInput(); return this.dispatch({ type: "set-six-key-input", mode: o }), g.alert(o ? this.controller.s("basic-calculator-narration-hotkey-six-key-input-on") : this.controller.s("basic-calculator-narration-hotkey-six-key-input-off")), !1 } } } else if (!document.activeElement || E.elIsFocusable(c(document.activeElement))) return !1; return !0 }, l }(l.DCGViewBasic); e.default = C });
define('api/basic', ["require", "exports", "tslib", "dcgview", "./abstract", "main/shared-worker-pool", "basic/controller", "basic/main", "core/lib/color-helpers", "underscore_model", "./util", "core/lib/deepCopy", "lib/console"], function (require, e, t, o, r, i, n, a, s, l, c, d, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.BasicCalculator = void 0; var u = function (e) { function r(t) { return e.call(this, t) || this } return t.__extends(r, e), r.prototype.init = function (e) { var o = this; (e = d.default(e)).backgroundColor && !s.isValidHexColor(e.backgroundColor) && (p.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"), delete e.backgroundColor), e.textColor && !s.isValidHexColor(e.textColor) && (p.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"), delete e.textColor); var r = t.__assign({ language: "en", qwertyKeyboard: !0, links: !0, degreeMode: !1, settingsMenu: !0, invertedColors: !1, backgroundColor: "#fff", textColor: "#000", brailleMode: "none", sixKeyInput: !1, brailleControls: !0, brailleExpressionDownload: !0, projectorMode: !1, capExpressionSize: !1, functionDefinition: !0, autosize: !0, evaluationMode: "scientific", restrictedEditing: !1, additionalFunctions: ["sqrt"], typingSlashWritesDivisionSymbol: !1, typingAsteriskWritesTimesSymbol: !1, decimalToFraction: !0, replaceCommaWith10Exp: !1, replaceRoundWithReciprocal: !1 }, e); this.settings = new l.UnderscoreModel; var a = { workerPool: i.default, settingsProxy: this.settings }; this.controller = new n.default(r, a), this.controller.onEventEmitted = function (e) { "render" === e && o.updateView(), o.triggerEvent(e, void 0) }, this.setupDomChangeDetector(r.autosize) }, r.prototype.onCreateView = function () { return o.mountToNode(a.default, this.rootElt, { controller: o.const(this.controller) }) }, r.prototype.setState = function (e, t) { t || (t = {}), this.controller.dispatch({ type: "set-state-from-api", state: e, opts: { allowUndo: !!t.allowUndo } }) }, r.prototype.getState = function () { return d.default(this.controller.model.getPersistedState()) }, r.prototype.undo = function () { this.controller.dispatch({ type: "undo", source: "api" }) }, r.prototype.redo = function () { this.controller.dispatch({ type: "redo", source: "api" }) }, r.prototype.clearHistory = function () { this.controller.dispatch({ type: "clear-history" }) }, r.prototype.setBlank = function (e) { e || (e = {}), this.controller.dispatch({ type: "set-blank", opts: { allowUndo: !!e.allowUndo } }) }, r.prototype.updateSettings = function (e) { if (null != e) for (var t in e) switch (t) { case "fontSize": var o = e[t]; if (void 0 === o) continue; this.controller.dispatch({ type: "update-font-size", size: o }); break; case "invertedColors": var r = e[t]; if (void 0 === r) continue; this.controller.dispatch({ type: "update-inverted-colors", mode: r }); break; case "backgroundColor": var i = e[t]; if (void 0 === i || !s.isValidHexColor(i)) { p.warn("Invalid backgroundColor. Background color must be a 3- or 6-character hex color (e.g. #cde or #ffaaaa)"); continue } this.controller.dispatch({ type: "update-background-color", color: i }); break; case "textColor": var n = e[t]; if (void 0 === n || !s.isValidHexColor(n)) { p.warn("Invalid textColor. Text color must be a 3- or 6-character hex color (e.g. #000 or #001111)"); continue } this.controller.dispatch({ type: "update-text-color", color: n }); break; case "degreeMode": var a = e[t]; if (void 0 === a) continue; this.controller.dispatch({ type: "update-degree-mode", mode: a }); break; case "brailleMode": var l = e[t]; this.controller.dispatch({ type: "set-braille-mode", mode: l }); break; case "sixKeyInput": var d = e[t]; if (void 0 === d) continue; this.controller.dispatch({ type: "set-six-key-input", mode: d }); break; case "brailleControls": var u = e[t]; if (void 0 === u) continue; this.controller.dispatch({ type: "set-braille-controls", value: u }); break; case "brailleExpressionDownload": var h = e[t]; if (void 0 === h) continue; this.controller.dispatch({ type: "set-braille-expression-download", mode: h }); break; case "projectorMode": var y = e[t]; if (void 0 === y) continue; this.controller.dispatch({ type: "update-projector-mode", mode: y }); break; case "capExpressionSize": var f = e[t]; if (void 0 === f) continue; this.controller.dispatch({ type: "update-cap-expression-size", mode: f }); break; case "language": var b = e[t]; if (void 0 === b) continue; this.controller.dispatch({ type: "update-language", language: c.validateLanguage(b) }); break; case "settingsMenu": e.settingsMenu ? this.controller.dispatch({ type: "enable-settings-menu" }) : this.controller.dispatch({ type: "disable-settings-menu" }); break; case "qwertyKeyboard": this.controller.dispatch({ type: "update-options", options: { qwertyKeyboard: !!e.qwertyKeyboard } }); var v = this.controller.getKeyboardMode(); "qwerty" !== v && "letters" !== v || this.controller.dispatch({ type: "ABC" }); break; case "functionDefinition": e.functionDefinition ? this.controller.model.enableFunctionDefinition() : this.controller.model.disableFunctionDefinition(); break; case "links": this.controller.dispatch({ type: "update-options", options: { links: !!e.links } }); break; case "decimalToFraction": var g = e[t]; if (void 0 === g) continue; this.controller.dispatch({ type: "update-decimal-to-fraction", mode: g }); break; case "replaceCommaWith10Exp": var m = e[t]; if (void 0 === m) continue; this.controller.dispatch({ type: "set-replace-comma-with-10-exp", replace: m }); break; case "replaceRoundWithReciprocal": var k = e[t]; if (void 0 === k) continue; this.controller.dispatch({ type: "set-replace-round-with-reciprocal", replace: k }); break; case "restrictedEditing": this.controller.dispatch({ type: "update-options", options: { restrictedEditing: !!e.restrictedEditing } }); break; case "typingAsteriskWritesTimesSymbol": var x = e[t]; if (void 0 === x) continue; this.controller.dispatch({ type: "set-typing-asterisk-writes-times-symbol", mode: x }) } }, r.prototype.focusFirstExpression = function () { this.controller.dispatch({ type: "focus-first-expression" }) }, r.prototype.onResizeView = function (e) { this.controller.dispatch({ type: "ui/container-resized", size: e }) }, r.prototype.onDestroyView = function () { o.unmountFromNode(this.rootElt) }, r.prototype.destroy = function () { this.controller.model.destroy(), e.prototype.destroy.call(this) }, r }(r.default); e.BasicCalculator = u });
define('api/fourfunction', ["require", "exports", "tslib", "./basic", "core/lib/deepCopy", "lib/console", "./util"], function (require, n, t, i, e, o, a) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }); var s = function (n) { function i(t, s) { var r = n.call(this, t) || this; return r instanceof i ? (r.init(function (n) { (n = e.default(n)).hasOwnProperty("typingSlashWritesDivisionSymbol") || (n.typingSlashWritesDivisionSymbol = !0); n.hasOwnProperty("typingAsteriskWritesTimesSymbol") || (n.typingAsteriskWritesTimesSymbol = !0); n.exponentButtonForSquareRoot && (o.warn("As of API version 1.0, the 'exponentButtonForSquareRoot' option is deprecated.Use 'additionalFunctions: \"exponent\"' instead."), n.additionalFunctions = ["exponent"]); if (n.additionalFunctions) { var t = n.additionalFunctions; "string" == typeof t && (t = [t]), t.length > 2 && (o.warn("additionalFunctions can only take up to 2 new functions. Using the first two."), t = t.slice(0, 2)); for (var i = !0, s = 0; s < t.length; s++)-1 === ["sqrt", "exponent", "percent", "fraction"].indexOf(t[s]) && (o.warn("Unrecognized value: '" + t[s] + "' for 'additionalFunction'. Valid values are 'sqrt', 'percent', 'exponent', or 'fraction'. Using default (\"sqrt\")"), i = !1); n.additionalFunctions = i ? t : ["sqrt"] } n.additionalFunctions && n.additionalFunctions.length || (n.additionalFunctions = ["sqrt"]); n.singleExpression ? n.evaluationMode = "singleExpressionFourFunction" : n.evaluationMode = "fourFunction"; delete n.singleExpression, n.hasOwnProperty("decimalToFraction") || (n.decimalToFraction = !1); n.language && (n.language = a.validateLanguage(n.language)); return n }(s || {})), r) : new i(t, s) } return t.__extends(i, n), i }(i.BasicCalculator); n.default = s });
define('api/scientific', ["require", "exports", "tslib", "./basic", "core/lib/deepCopy", "./util"], function (require, e, i, n, t, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var l = function (e) { function n(i, l) { var s = e.call(this, i) || this; return s instanceof n ? (s.init(function (e) { (e = t.default(e)).singleExpression ? e.evaluationMode = "singleExpressionScientific" : e.evaluationMode = "scientific"; delete e.singleExpression, e.language && (e.language = a.validateLanguage(e.language)); return e }(l || {})), s) : new n(i, l) } return i.__extends(n, e), n }(n.BasicCalculator); e.default = l });
define('pillow-keypad/controller', ["require", "exports", "flux", "keypad/mq-commands", "lib/i18n", "dcgview-helpers/mathquill-view"], function (require, e, t, a, i, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var o = function () { function e(e) { var a = this; this.keypadType = "scientific", this.scientificKeyboardMode = "main", this.dispatcher = new t.Dispatcher, this.s = i.createDictionaryLookupFunction(function () { return "en" }), this.dispatch = function (e) { var t; for (a.dispatcher.dispatch(e); t = a._queuedCallbacks.shift();)t() }, this._queuedCallbacks = [], this.keypadType = null != e ? e : "scientific", this.dispatcher = new t.Dispatcher, this.hookUpDispatcher() } return e.prototype.getBackgroundColor = function () { return "does-not-matter" }, e.prototype.runAfterDispatch = function (e) { this._queuedCallbacks.push(e) }, e.prototype.enqueueEvent = function (e) { var t = this; this.runAfterDispatch(function () { t.onEventEmitted && t.onEventEmitted(e) }) }, e.prototype.getKeypadType = function () { return this.keypadType }, e.prototype.getScientificKeyboardMode = function () { return this.scientificKeyboardMode }, e.prototype.updateKeyboardMode = function (e) { this.scientificKeyboardMode = e }, e.prototype.typeIntoFocusedMathquill = function (e) { e = e.replace(/\r|\n/g, ""); var t = this.activeMQ; t && (t.typedText(e), n.default.simulateUserChangedLatex(t)) }, e.prototype.pressKeyInFocusedMathquill = function (e, t) { var a = this.activeMQ; if (a) return "Enter" === e ? (t && (t.preventDefault(), t.stopPropagation()), void this.enqueueEvent("enter")) : void a.keystroke(e, t) }, e.prototype.executeCommandInFocusedMathquill = function (e) { var t = this.activeMQ; t && a.execute(t, e) }, e.prototype.hookUpDispatcher = function () { var e = this; this.dispatcher.register(function (t) { switch (e.enqueueEvent("render"), t.type) { case "hide-keypad": e.enqueueEvent("hide-keypad"); break; case "set-active-mq": e.activeMQ = t.mq; break; case "set-keypad-type": e.keypadType = t.keypadType; break; case "keypad/shift": e.updateKeyboardMode("capitalQwerty" === e.scientificKeyboardMode ? "qwerty" : "capitalQwerty"); break; case "main": e.updateKeyboardMode("main"); break; case "ABC": e.updateKeyboardMode("qwerty"); break; case "functions": e.updateKeyboardMode("functions"); break; case "keypad/type-text": e.typeIntoFocusedMathquill(t.text); break; case "keypad/press-key": e.pressKeyInFocusedMathquill(t.key, t.evt); break; case "keypad/custom-command": e.executeCommandInFocusedMathquill(t.command); break; case "keypad/123": case "keypad/abc": case "keypad/audio-trace": break; default: return t } }) }, e }(); e.default = o });
define('pillow-keypad/dcgview-pillow-keypad', ["require", "exports", "tslib", "dcgview"], function (require, t, e, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.DCGViewPillowKeypad = void 0; var o = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return e.__extends(i, t), i.prototype.init = function () { this.controller = this.props.controller(), this.dispatch = this.controller.dispatch, this.s = this.controller.s }, i }(i.Class); t.DCGViewPillowKeypad = o });
define('pillow-keypad/main-keypad', ["require", "exports", "tslib", "dcgview", "keypad/keys", "keypad/keypad", "keypad/row", "./dcgview-pillow-keypad"], function (require, e, t, i, l, h, s, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var c = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.template = function () { return i.createElement(h.default, { controller: this.props.controller }, i.createElement(s.default, null, l.view(this, "a^2"), l.view(this, "a^b"), l.view(this, "|a|"), l.view(this, "a/b"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "7", { style: "highlight" }), l.view(this, "8", { style: "highlight" }), l.view(this, "9", { style: "highlight" }), l.view(this, "/"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "x"), l.view(this, "y")), i.createElement(s.default, null, l.view(this, "("), l.view(this, ")"), l.view(this, "<"), l.view(this, ">"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "4", { style: "highlight" }), l.view(this, "5", { style: "highlight" }), l.view(this, "6", { style: "highlight" }), l.view(this, "*"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "left", { style: "highlight" }), l.view(this, "right", { style: "highlight" })), i.createElement(s.default, null, l.view(this, "sqrt"), l.view(this, ","), l.view(this, "<="), l.view(this, ">="), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "1", { style: "highlight" }), l.view(this, "2", { style: "highlight" }), l.view(this, "3", { style: "highlight" }), l.view(this, "-"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.spacer(.5), l.view(this, "backspace", { style: "highlight", colspan: 1.5 })), i.createElement(s.default, null, l.view(this, "nthroot"), l.view(this, "pi"), l.view(this, "%"), l.view(this, "a_b"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "0", { style: "highlight" }), l.view(this, ".", { style: "highlight" }), l.view(this, "="), l.view(this, "+"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), l.view(this, "enter", { colspan: 2, style: "blue" }))) }, a }(a.DCGViewPillowKeypad); e.default = c });
define('pillow-keypad/qwerty-keypad', ["require", "exports", "tslib", "dcgview", "keypad/keys", "keypad/keypad", "keypad/row", "./dcgview-pillow-keypad"], function (require, e, i, t, s, h, l, w) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var v = function (e) { function w() { return null !== e && e.apply(this, arguments) || this } return i.__extends(w, e), w.prototype.template = function () { return t.createElement(h.default, { controller: this.props.controller }, t.createElement(l.default, null, s.view(this, "q"), s.view(this, "w"), s.view(this, "e"), s.view(this, "r"), s.view(this, "t"), s.view(this, "y"), s.view(this, "u"), s.view(this, "i"), s.view(this, "o"), s.view(this, "p")), t.createElement(l.default, null, t.createElement("div", { class: t.const("dcg-half-width-placeholder") }), s.view(this, "a"), s.view(this, "s"), s.view(this, "d"), s.view(this, "f"), s.view(this, "g"), s.view(this, "h"), s.view(this, "j"), s.view(this, "k"), s.view(this, "l"), t.createElement("div", { class: t.const("dcg-half-width-placeholder") })), t.createElement(l.default, null, s.view(this, "shift", { style: "highlight" }), s.view(this, "z"), s.view(this, "x"), s.view(this, "c"), s.view(this, "v"), s.view(this, "b"), s.view(this, "n"), s.view(this, "m"), s.view(this, ":"), s.view(this, "backspace", { style: "highlight" })), t.createElement(l.default, null, s.view(this, "~"), s.view(this, "{"), s.view(this, "}"), s.view(this, "["), s.view(this, "]"), s.view(this, "!"), s.view(this, "'"), s.view(this, "obelus"), s.view(this, "enter", { style: "blue" }))) }, w }(w.DCGViewPillowKeypad); e.default = v });
define('pillow-keypad/capital-qwerty-keypad', ["require", "exports", "tslib", "dcgview", "./dcgview-pillow-keypad", "keypad/keys", "keypad/keypad", "keypad/row"], function (require, e, i, t, s, h, l, w) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var v = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return i.__extends(s, e), s.prototype.template = function () { return t.createElement(l.default, { controller: this.props.controller }, t.createElement(w.default, null, h.view(this, "Q"), h.view(this, "W"), h.view(this, "E"), h.view(this, "R"), h.view(this, "T"), h.view(this, "Y"), h.view(this, "U"), h.view(this, "I"), h.view(this, "O"), h.view(this, "P")), t.createElement(w.default, null, t.createElement("div", { class: t.const("dcg-half-width-placeholder") }), h.view(this, "A"), h.view(this, "S"), h.view(this, "D"), h.view(this, "F"), h.view(this, "G"), h.view(this, "H"), h.view(this, "J"), h.view(this, "K"), h.view(this, "L"), t.createElement("div", { class: t.const("dcg-half-width-placeholder") })), t.createElement(w.default, null, h.view(this, "shift", { style: "highlight" }), h.view(this, "Z"), h.view(this, "X"), h.view(this, "C"), h.view(this, "V"), h.view(this, "B"), h.view(this, "N"), h.view(this, "M"), h.view(this, ","), h.view(this, "backspace", { style: "highlight" })), t.createElement(w.default, null, h.view(this, "="), h.view(this, "("), h.view(this, ")"), h.view(this, "["), h.view(this, "]"), h.view(this, "!"), h.view(this, "'"), h.view(this, "obelus"), h.view(this, "enter", { style: "blue" }))) }, s }(s.DCGViewPillowKeypad); e.default = v });
define('pillow-keypad/functions-keypad', ["require", "exports", "tslib", "dcgview", "keypad/keys", "keypad/keypad", "keypad/row", "./dcgview-pillow-keypad"], function (require, e, t, i, s, l, n, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.template = function () { return i.createElement(l.default, { controller: this.props.controller }, i.createElement(n.default, null, s.view(this, "sin"), s.view(this, "cos"), s.view(this, "tan"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "ln"), s.view(this, "log"), s.view(this, "backspace", { style: "highlight" })), i.createElement(n.default, null, s.view(this, "arcsin"), s.view(this, "arccos"), s.view(this, "arctan"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "e^x"), s.view(this, "abs"), s.view(this, "round")), i.createElement(n.default, null, s.view(this, "mean"), s.view(this, "stdev"), s.view(this, "stdevp"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "a^b"), s.view(this, "sqrt"), s.view(this, "nthroot")), i.createElement(n.default, null, s.view(this, "nPr"), s.view(this, "nCr"), s.view(this, "!"), i.createElement("div", { class: i.const("dcg-partition-placeholder") }), s.view(this, "e"), s.view(this, "%"), s.view(this, "enter", { style: "blue" }))) }, a }(a.DCGViewPillowKeypad); e.default = r });
define('pillow-keypad/fourfunction-keypad', ["require", "exports", "tslib", "dcgview", "keypad/keys", "keypad/keypad", "keypad/row", "./dcgview-pillow-keypad"], function (require, e, i, t, h, l, s, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var a = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return i.__extends(n, e), n.prototype.template = function () { var e = this; return t.createElement(l.default, { controller: this.props.controller }, t.createElement(s.default, null, h.view(this, "1", { style: "highlight" }), h.view(this, "2", { style: "highlight" }), h.view(this, "3", { style: "highlight" }), h.view(this, "4", { style: "highlight" }), h.view(this, "5", { style: "highlight" }), h.view(this, "6", { style: "highlight" }), h.view(this, "7", { style: "highlight" }), h.view(this, "8", { style: "highlight" }), h.view(this, "9", { style: "highlight" }), h.view(this, "0", { style: "highlight" }), t.createElement("div", { class: t.const("dcg-partition-placeholder") }), h.view(this, "left", { style: "highlight" }), h.view(this, "right", { style: "highlight" }), t.createElement("div", { class: t.const("dcg-inline-hide-keypad-button"), "dcg-command": t.const("hide-keypad"), onTap: function () { return e.props.controller().dispatch({ type: "hide-keypad" }) } }, t.createElement("div", { class: t.const("dcg-inline-hide-keypad-button-inner") }, t.createElement("i", { class: t.const("dcg-icon-hide"), "aria-hidden": t.const("true") })))), t.createElement(s.default, null, h.spacer(2), h.view(this, "."), h.view(this, "="), h.view(this, "+"), h.view(this, "-"), h.view(this, "multiplication"), h.view(this, "obelus"), h.spacer(3), h.view(this, "backspace", { style: "highlight", colspan: 1.5 }), h.spacer(1)), t.createElement(s.default, null, h.spacer(2), h.view(this, "a/b"), h.view(this, ","), h.view(this, "("), h.view(this, ")"), h.view(this, "<"), h.view(this, ">"), h.spacer(2.5), h.view(this, "enter", { colspan: 2, style: "blue" }), h.spacer(1))) }, n }(n.DCGViewPillowKeypad); e.default = a });
define('pillow-keypad/control-bar', ["require", "exports", "tslib", "dcgview", "keypad/control-bar", "keypad/control-btn", "./dcgview-pillow-keypad"], function (require, t, e, n, c, r, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var a = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.template = function () { var t = this.props.controller(); return n.createElement(c.default, { controller: this.props.controller }, n.createElement(r.default, { command: this.const("main"), selected: function () { return "main" === t.getScientificKeyboardMode() }, ignoreInTabOrder: this.const(!0), selectable: this.const(!0), onTap: function () { return t.dispatch({ type: "main" }) } }, function () { return t.s("basic-calculator-button-controlbar-main") }), n.createElement(r.default, { command: this.const("ABC"), selected: function () { return -1 !== ["qwerty", "capitalQwerty"].indexOf(t.getScientificKeyboardMode()) }, ignoreInTabOrder: this.const(!0), selectable: this.const(!0), ariaLabel: function () { return t.s("basic-calculator-narration-controlbar-abc") }, onTap: function () { return t.dispatch({ type: "ABC" }) } }, function () { return t.s("basic-calculator-button-controlbar-abc") }), n.createElement(r.default, { command: this.const("functions"), selected: function () { return -1 !== ["functions", "restrictedFunctions"].indexOf(t.getScientificKeyboardMode()) }, ariaLabel: function () { return t.s("basic-calculator-narration-controlbar-functions") }, ignoreInTabOrder: this.const(!0), selectable: this.const(!0), onTap: function () { return t.dispatch({ type: "functions" }) } }, function () { return t.s("shared-calculator-button-controlbar-functions") }), n.createElement("div", { class: n.const("dcg-hide-keypad-button"), "dcg-command": n.const("hide-keypad"), onTap: function () { return t.dispatch({ type: "hide-keypad" }) } }, n.createElement("i", { class: n.const("dcg-icon-hide"), "aria-hidden": n.const("true") }))) }, o }(o.DCGViewPillowKeypad); t.default = a });

define('loadcss!pillow-keypad/main', function () { });
define('pillow-keypad/main', ["require", "exports", "tslib", "dcgview", "./dcgview-pillow-keypad", "./main-keypad", "./qwerty-keypad", "./capital-qwerty-keypad", "./functions-keypad", "./fourfunction-keypad", "./control-bar", "touchtracking", "loadcss!./main"], function (require, e, t, n, r, o, i, l, c, a, u, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var p = n.Components, d = p.Switch, f = p.SwitchUnion, y = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { return n.createElement("div", { class: n.const("dcg-calculator-api-container"), style: n.const("width: 100%; height: 100%; position: relative;") }, n.createElement("div", { class: n.const("dcg-do-not-blur dcg-container dcg-api-shared-keypad-root"), didMount: this.bindFn(this.didMountRoot) }, this.children)) }, r.prototype.didMountRoot = function (e) { s.monitor(e) }, r }(r.DCGViewPillowKeypad), h = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return n.createElement(y, t.__assign({}, this.props), n.createElement("div", { class: n.const("dcg-fourfunction-keypad-container"), role: n.const("group"), "aria-label": function () { return e.s("shared-calculator-narration-keypad") } }, n.createElement(a.default, { controller: this.props.controller }))) }, r }(r.DCGViewPillowKeypad), m = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return n.createElement(y, t.__assign({}, this.props), n.createElement(u.default, { controller: this.props.controller }), n.createElement("div", { role: n.const("group"), "aria-label": function () { return e.s("shared-calculator-narration-keypad") } }, n.createElement(d, { key: function () { return e.controller.getScientificKeyboardMode() } }, function (t) { switch (t) { case "qwerty": return n.createElement(i.default, { controller: e.props.controller }); case "capitalQwerty": return n.createElement(l.default, { controller: e.props.controller }); case "functions": return n.createElement(c.default, { controller: e.props.controller }); default: return n.createElement(o.default, { controller: e.props.controller }) } }))) }, r }(r.DCGViewPillowKeypad), w = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return f(function () { return e.controller.getKeypadType() }, { fourfunction: function () { return n.createElement(h, t.__assign({}, e.props)) }, scientific: function () { return n.createElement(m, t.__assign({}, e.props)) } }) }, r }(r.DCGViewPillowKeypad); e.default = w });
define('api/pillow-keypad', ["require", "exports", "tslib", "dcgview", "./abstract", "pillow-keypad/controller", "pillow-keypad/main"], function (require, t, e, o, n, i, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var p = function (t) { function n(e, o) { var i = t.call(this, e) || this; return i instanceof n ? (i.init(o), i) : new n(e, o) } return e.__extends(n, t), n.prototype.init = function (t) { var e = this; this.controller = new i.default(t), this.controller.onEventEmitted = function (t) { "render" === t && e.updateView(), e.triggerEvent(t, void 0) }, this.setupDomChangeDetector(!0) }, n.prototype.setActiveMathquill = function (t) { this.controller.dispatch({ type: "set-active-mq", mq: t }) }, n.prototype.setKeypadType = function (t) { this.controller.dispatch({ type: "set-keypad-type", keypadType: t }) }, n.prototype.onCreateView = function () { return o.mountToNode(r.default, this.rootElt, { controller: o.const(this.controller) }) }, n.prototype.onResizeView = function (t) { }, n.prototype.onDestroyView = function () { o.unmountFromNode(this.rootElt) }, n.prototype.destroy = function () { t.prototype.destroy.call(this) }, n }(n.default); t.default = p });
define('core/cl-calculator', ["require", "exports", "core/graphing-calc/migrate-state", "core/graphing-calc/json/expression", "core/graphing-calc/json/table"], function (require, e, t, a, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.CLCalculator = void 0, e.CLCalculator = function (e) { var s = t.migrateToLatest(e), o = {}, n = s.graph.degreeMode, i = s.randomSeed; function c(e) { switch (e.type) { case void 0: case "expression": var t = a.computeParsableState(a.inflateDefaults(e)); o[t.id] = t; break; case "table": t = r.computeParsableState(r.inflateDefaults(e)); o[t.id] = t; break; case "folder": case "text": case "image": break; default: return e } } for (var l = 0, u = s.expressions.list; l < u.length; l++) { c(u[l]) } return { setExpression: function (e) { c(e) }, getChangeSet: function () { return { statements: o, isCompleteState: !0, degreeMode: n, globalRandomSeed: i } } } } });
define('core/math/tree-queries/count-numbers', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.countNumbers = void 0, e.countNumbers = function e(a, s) { switch (a.type) { case "Mul": case "Div": case "Prime": case "Call": case "ImplicitCall": case "Dot": case "Pipes": case "Sqrt": case "Nthroot": case "Frac": case "Derivative": case "Integral": case "EmptyIntegral": case "Sum": case "Product": case "Piecewise": case "Paren": case "Juxt": case "Superscript": case "Bang": case "Index": case "Equals": case "Inequality": case "Tilde": case "Pos": case "Neg": case "Add": case "Sub": case "List": case "Seq": case "Colon": case "Ellipsis": case "PercentOf": case "RightArrow": case "For": for (var c = 0, r = 0, t = a.args; r < t.length; r++) { c += e(t[r], s) } return c; case "Decimal": return void 0 === s || parseFloat(a.val) === s ? 1 : 0; case "MixedNumber": if (void 0 === s) return 3; c = 0; return parseFloat(a.whole) === s && (c += 1), parseFloat(a.num) === s && (c += 1), parseFloat(a.den) === s && (c += 1), c; case "Letter": case "EmptyPiecewise": case "Cmd": case "EmptyRangeEnd": return 0; case "Subscript": return e(a.args[0], s); case "InequalityChain": c = 0; c += e(a.first, s); for (var i = 0, n = a.chain; i < n.length; i++) { c += e(n[i].args[0], s) } return c; default: throw "Unexpected surface node " + a.type + "." } } });
define('core/graphing-calc/diffs/longest-subsequence', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.findLongestSubsequence = void 0, e.findLongestSubsequence = function (e) { for (var r = e.length, n = new Array(r), i = new Array(r + 1), o = 0, t = 0; t < r; t++) { var u = void 0; if (e[i[o]] < e[t]) u = o + 1; else { for (var a = 1, f = o - 1; a <= f;) { var s = Math.ceil((a + f) / 2); e[i[s]] < e[t] ? a = s + 1 : f = s - 1 } u = a } n[t] = i[u - 1], i[u] = t, u > o && (o = u) } var v = new Array(o), c = i[o]; for (t = o - 1; t >= 0; t--)v[t] = e[c], c = n[c]; return v } });
define('core/graphing-calc/diffs/calculate-diff', ["require", "exports", "underscore", "./longest-subsequence"], function (require, r, e, i) { "use strict"; var n; function t(r, e, i) { var n = {}; for (var t in r) if (r.hasOwnProperty(t)) if (e.hasOwnProperty(t)) { var f = u(r[t], e[t], i, t); f && (n[t] = f) } else n[t] = { d: 1 }; for (var t in e) e.hasOwnProperty(t) && !r.hasOwnProperty(t) && (n[t] = { s: e[t] }); return n } function u(r, u, s, a) { if (e.isArray(r) && e.isArray(u)) { if (s === n.EXPRESSIONS && "list" === a || s === n.TABLE_EXPRESSION && "columns" === a) return function (r, u) { for (var s = {}, a = {}, o = 0; o < r.length; o++) { if (void 0 !== a[r[o].id]) return { s: u }; a[r[o].id] = o } var E = {}; for (o = 0; o < u.length; o++) { if (void 0 !== E[u[o].id]) return { s: u }; E[u[o].id] = o } for (var l = function (r, e, n) { for (var t = {}, u = e.filter(function (r) { return void 0 !== n[r.id] }).map(function (r) { return n[r.id] }), f = i.findLongestSubsequence(u), s = 0, a = f; s < a.length; s++) { t[r[a[s]].id] = !0 } return t }(r, u, a), O = 0, c = 0; c < r.length; c++) { var d = r[c]; if (l[d.id]) { var S = E[d.id], v = u[S], R = {}; if (O !== S && (R.a = u.slice(O, S).map(function (e) { return f(r, a, e) })), !e.isEqual(d, v)) { var p = "table" === d.type && "table" === v.type; R.e = t(d, v, p ? n.TABLE_EXPRESSION : n.OTHER) } e.isEmpty(R) || (s[c] = R), O = S + 1 } else s[c] = { d: 1 } } O < u.length && (s[r.length] = { a: u.slice(O, u.length).map(function (e) { return f(r, a, e) }) }); if (!e.isEmpty(s)) return { l: s }; return }(r, u); if (!e.isEqual(r, u)) return { s: u } } else if (e.isObject(r) && e.isObject(u)) { var o = t(r, u, function (r, e) { return r === n.ROOT && "expressions" === e ? n.EXPRESSIONS : n.OTHER }(s, a)); if (!e.isEmpty(o)) return { e: o } } else if (!e.isEqual(r, u)) return { s: u } } function f(r, i, u) { if (i[u.id]) { var f = r[i[u.id]], s = { f: i[u.id] }; return e.isEqual(f, u) || (s.e = t(f, u, n.OTHER)), { m: s } } return { s: u } } Object.defineProperty(r, "__esModule", { value: !0 }), r.calculateDiff = void 0, function (r) { r[r.ROOT = 0] = "ROOT", r[r.EXPRESSIONS = 1] = "EXPRESSIONS", r[r.TABLE_EXPRESSION = 2] = "TABLE_EXPRESSION", r[r.OTHER = 3] = "OTHER" }(n || (n = {})), r.calculateDiff = function (r, e) { return t(r, e, n.ROOT) } });
define('core/graphing-calc/diffs/apply-diff', ["require", "exports", "underscore", "../../lib/deepCopy"], function (require, e, r, n) { "use strict"; function t(e, n) { for (var o = 0, i = r.keys(n); o < i.length; o++) { var h = i[o], l = n[h]; p(l) ? e[h] = l.s : a(l) ? delete e[h] : s(l) ? e[h] = u(e[h], l.l) : f(l) && (e[h] = t(e[h], l.e)) } return e } function u(e, r) { for (var n = [], u = 0; u < e.length; u++) { var p = r[u]; p && p.a && n.push.apply(n, o(e, p.a)), p && p.e ? n.push(t(e[u], p.e)) : p && p.d || n.push(e[u]) } var a = r[e.length]; return a && a.a && n.push.apply(n, o(e, a.a)), n } function o(e, r) { for (var n = [], u = 0, o = r; u < o.length; u++) { var p = o[u]; if (p.hasOwnProperty("s")) n.push(p.s); else if (i(p)) { var a = e[p.m.f]; p.m.e ? n.push(t(a, p.m.e)) : n.push(a) } } return n } function p(e) { return e.hasOwnProperty("s") } function a(e) { return e.hasOwnProperty("d") } function s(e) { return e.hasOwnProperty("l") } function f(e) { return e.hasOwnProperty("e") } function i(e) { return e.hasOwnProperty("m") } Object.defineProperty(e, "__esModule", { value: !0 }), e.applyDiff = void 0, e.applyDiff = function (e, r) { return t(n.default(e), r) } });
define('core/graphing-calc/translation/common', ["require", "exports"], function (require, t) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.mutateString = t.deserializeTranslationKey = t.serializeTranslationKey = void 0, t.serializeTranslationKey = function (t) { return "expression" === t.location || "object" === t.location ? t.location + ":" + t.id + ":" + t.path : t.location + ":" + t.path }, t.deserializeTranslationKey = function (t) { var e = function () { return new Error("Invalid key: " + t) }, i = t.split(":"), n = i[0]; if (!n) throw e(); if ("expression" != n && "settings" != n && "object" != n) throw e(); if ("settings" == n) { if (2 != i.length) throw e(); return { location: n, path: i[1] } } if (3 != i.length) throw e(); return { location: n, id: i[1], path: i[2] } }, t.mutateString = function (t, e, i) { if (t) for (var n = e.split("."), r = t, o = 0; o < n.length; o++) { var a = n[o]; if (!r[a]) break; o == n.length - 1 && "string" == typeof r[a] ? r[a] = i : r = r[a] } } });
define('core/graphing-calc/translation/translator', ["require", "exports", "tslib", "../../lib/deepCopy", "./common"], function (require, e, i, a, t) { "use strict"; function r(e, a) { return function (r, s, l, o) { if (r) { var n = t.serializeTranslationKey(i.__assign(i.__assign({}, a), { path: s })); e[n] = { value: r, type: l, context: o } } } } function s(e) { var i, a, t = {}, s = r(t, { location: "expression", id: e.id }); switch (e.type) { case "expression": s(e.label, "label", "interpolated-string", "expression-list-expression-label"), s(e.description, "description", "string", "expression-list-expression-clickable-description"); break; case "image": s(e.image_url, "image_url", "image", "expression-list-image-url"), s(e.description, "description", "string", "expression-list-image-clickable-description"), s(null === (i = e.clickableInfo) || void 0 === i ? void 0 : i.hoveredImage, "clickableInfo.hoveredImage", "image", "expression-list-image-clickable-hovered"), s(null === (a = e.clickableInfo) || void 0 === a ? void 0 : a.depressedImage, "clickableInfo.depressedImage", "image", "expression-list-image-clickable-depressed"); break; case "text": s(e.text, "text", "string", "expression-list-note-text"); break; case "folder": s(e.title, "title", "string", "expression-list-folder-title") }return t } Object.defineProperty(e, "__esModule", { value: !0 }), e.applyLocalizationMap = e.extractLocalizationMap = void 0, e.extractLocalizationMap = function (e) { var i, a, t, l = {}; if ("graph" == e.type) { for (var o = 0, n = e.graphState.expressions.list; o < n.length; o++) { var c = s(n[o]); for (var p in c) l[p] = c[p] } var g = function (e) { var i = {}, a = r(i, { location: "settings" }); return a(e.graph.xAxisLabel, "xAxisLabel", "string", "settings-xaxis-label"), a(e.graph.yAxisLabel, "yAxisLabel", "string", "settings-yaxis-label"), i }(e.graphState); for (var p in g) l[p] = g[p] } else { var d = e.geometryState.objects; for (var v in d) { var u = (i = d[v], a = void 0, t = void 0, (t = r(a = {}, { location: "object", id: i.id }))(i.label, "label", "string", "geometry-object-label"), "image" === i.type && t(i.url, "url", "image", "geometry-object-image-url"), a); for (var p in u) l[p] = u[p] } } return l }, e.applyLocalizationMap = function (e, i, r) { var s, l, o = a.default(e); if ("graph" === r) { for (var n = {}, c = 0, p = null !== (l = null === (s = o.expressions) || void 0 === s ? void 0 : s.list) && void 0 !== l ? l : []; c < p.length; c++) { var g = p[c]; n[g.id] = g } for (var d in i) { "expression" == (v = t.deserializeTranslationKey(d)).location ? t.mutateString(n[v.id], v.path, i[d].value) : t.mutateString(o.graph, v.path, i[d].value) } } else if (o.objects) for (var d in i) { var v; "object" == (v = t.deserializeTranslationKey(d)).location && t.mutateString(o.objects[v.id], v.path, i[d].value) } return o } });
define('core/math/render-latex', ["require", "exports"], function (require, r) { "use strict"; function e(r) { switch (r.type) { case "Equals": return t(r.args, "="); case "Inequality": return t(r.args, r.symbol); case "InequalityChain": return e(r.first) + r.chain.map(e).join(""); case "TrailingInequalityPiece": return r.symbol + e(r.args[0]); case "Tilde": return t(r.args, "~"); case "Pos": return "+" + e(r.args[0]); case "Neg": return "-" + e(r.args[0]); case "Add": return t(r.args, "+"); case "Sub": return t(r.args, "-"); case "Mul": return t(r.args, "*"); case "Div": return t(r.args, "/"); case "Bang": return e(r.args[0]) + "!"; case "Call": var u = c(r.args); return u ? u.script + "\\left(" + u.arg + "\\right)" : e(r.args[0]) + "\\left(" + e(r.args[1]) + "\\right)"; case "Paren": return "\\left(" + e(r.args[0]) + "\\right)"; case "List": return "\\left[" + r.args.map(e).join(",") + "\\right]"; case "Pipes": return "\\left|" + e(r.args[0]) + "\\right|"; case "Index": return e(r.args[0]) + "\\left[" + e(r.args[1]) + "\\right]"; case "Subscript": return t(r.args, "_", !0); case "Superscript": return t(r.args, "^", !0); case "Prime": if ("Call" === r.args[0].type) { var i = c(r.args[0].args); return i ? i.script + g(r.nprimes) + "\\left(" + i.arg + "\\right)" : e(r.args[0].args[0]) + g(r.nprimes) + "\\left(" + e(r.args[0].args[1]) + "\\right)" } return e(r.args[0]) + g(r.nprimes); case "Seq": return r.args.map(e).join(","); case "Sqrt": return "\\sqrt" + a(e(r.args[0])); case "Nthroot": return "\\sqrt\\left[" + e(r.args[0]) + "\\right]" + a(e(r.args[1])); case "Frac": return "\\frac{" + e(r.args[0]) + "}{" + e(r.args[1]) + "}"; case "Derivative": return "\\frac{d}{d" + e(r.args[0]) + "}" + e(r.args[1]); case "Integral": case "EmptyIntegral": if ("Cmd" !== r.args[0].type) throw new Error("Expected first argument of an integral to be the variable"); var l = "d" + r.args[0].val; if (3 === r.args.length) return s("int", r.args[1], r.args[2]) + l; var o = e(r.args[3]); return s("int", r.args[1], r.args[2]) + o + l; case "Sum": return n(r.args, "sum"); case "Product": return n(r.args, "prod"); case "Piecewise": return "\\{" + e(r.args[0]) + "\\}"; case "EmptyPiecewise": return "\\{\\}"; case "Colon": return t(r.args, ":"); case "Ellipsis": return t(r.args, "..."); case "For": return t(r.args, "\\for "); case "Dot": return t(r.args, "."); case "PercentOf": return t(r.args, "\\% \\of "); case "RightArrow": return t(r.args, "->"); case "Juxt": case "ImplicitCall": var f = c(r.args); return f ? f.script + f.arg : t(r.args, ""); case "MixedNumber": return r.whole + "\\frac{" + r.num + "}{" + r.den + "}"; case "Letter": case "Decimal": case "Alphanumeric": return r.val; case "Cmd": return "\\" + r.val; case "EmptyRangeEnd": return "EmptyRangeEnd"; case "Err": throw r.error; default: return r } } function a(r) { return r.length > 1 ? "{" + r + "}" : r } function s(r, s, t) { var n = a(e(s)); return t ? "\\" + r + "_" + n + "^" + a(e(t)) : "\\" + r + "_" + n } function t(r, s, t) { return void 0 === t && (t = !1), e(r[0]) + s + (t ? a(e(r[1])) : e(r[1])) } function n(r, a) { var t = e(r[0]); return s(a, r[1], r[2]) + t } function g(r) { for (var e = "", a = 0; a < r; a++)e += "'"; return e } function u(r) { return "Cmd" === r.type && "logbase" === r.val } function c(r) { var a, t = r[1]; return "Seq" === r[1].type && 2 === r[1].args.length && (t = r[1].args[1], a = r[1].args[0]), "Superscript" === r[0].type && u(r[0].args[0]) ? { script: s("log", t, r[0].args[1]), arg: a ? e(a) : "" } : u(r[0]) ? { script: s("log", t), arg: a ? e(a) : "" } : void 0 } Object.defineProperty(r, "__esModule", { value: !0 }), r.renderLatex = void 0, r.renderLatex = e });
define('core/math/format-latex', ["require", "exports", "tslib", "../mathtools", "./parser/surface-node", "./render-latex"], function (require, e, r, a, s, n) { "use strict"; function t(e) { switch (e.type) { case "Letter": case "Decimal": case "Cmd": return "0" === e.val; default: return !1 } } function i(e) { switch (e.type) { case "Letter": case "Decimal": case "Cmd": return "1" === e.val; default: return !1 } } function u(e) { return { isPseudoSurfaceNode: !0, type: "Decimal", span: e, val: "0" } } function p(e, r) { return { isPseudoSurfaceNode: !0, type: "Neg", span: r, args: [e] } } function g(e, r) { return { isPseudoSurfaceNode: !0, type: "Paren", span: r, args: [e] } } function c(e, a) { return r.__assign(r.__assign({}, e), { span: a }) } function f(e) { var a; switch (e.type) { case "Add": var n = f(e.args[0]), o = f(e.args[1]); if (t(n)) return c(o, e.span); if (t(o)) return c(n, e.span); var d = void 0; if ("Neg" === o.type ? d = f(o.args[0]) : "Paren" === o.type && "Neg" === o.args[0].type && (d = f(o.args[0].args[0])), void 0 !== d) return { isPseudoSurfaceNode: !0, type: "Sub", span: e.span, args: [n, d] }; a = [n, o]; break; case "Sub": var y = f(e.args[0]), v = f(e.args[1]); if (t(y)) return p(v, e.span); if (t(v)) return c(y, e.span); d = void 0; if ("Neg" === v.type ? d = v.args[0] : "Paren" === v.type && "Neg" === v.args[0].type && (d = v.args[0].args[0]), d) return { isPseudoSurfaceNode: !0, type: "Add", span: e.span, args: [y, d] }; a = [y, v]; break; case "Mul": var P = f(e.args[0]), l = f(e.args[1]); if (i(P)) return c(l, e.span); if (i(l)) return c(P, e.span); if (t(P)) return u(e.span); if (t(l)) return u(e.span); a = [P, l]; break; case "Juxt": var N = f(e.args[0]), _ = f(e.args[1]); if (i(N)) return c(_, e.span); if (i(_)) return c(N, e.span); if (function (e) { return "Neg" === e.type && i(e.args[0]) }(N)) return p(_, e.span); if (t(N)) return u(e.span); if (t(_)) return u(e.span); if ("Paren" === e.args[0].type && "Paren" !== N.type && (N = g(N, e.span)), "Juxt" === e.type && "Paren" === e.args[1].type && "Paren" !== _.type && (_ = g(_, e.span)), "Neg" === N.type) return p(r.__assign(r.__assign({}, e), { type: "Juxt", isPseudoSurfaceNode: !0, args: [N.args[0], _] }), e.span); a = [N, _]; break; case "Frac": case "Div": var m = f(e.args[0]), x = f(e.args[1]); if (i(x)) return c(m, e.span); a = [m, x]; break; case "Superscript": var b = f(e.args[0]), S = f(e.args[1]); if (i(S)) return c(b, e.span); a = [b, S]; break; case "Paren": var k = f(e.args[0]); if (s.isIdentifier(k)) return c(k, e.span); var h = "args" in k ? k.args : void 0; if ((!h || h.length <= 1) && "Neg" !== k.type) return c(k, e.span); a = [k]; break; case "Pos": return c(k = f(e.args[0]), e.span); case "Neg": var L = "args" in (k = f(e.args[0])) ? k.args[0] : void 0; if ("Paren" === k.type && L && "Neg" === L.type && L.args[0]) return c(f(L.args[0]), e.span); if ("Neg" === k.type && L) return c(L, e.span); a = [k]; break; case "Cmd": case "Letter": case "Decimal": case "MixedNumber": case "EmptyRangeEnd": case "EmptyPiecewise": case "InequalityChain": return r.__assign(r.__assign({}, e), { isPseudoSurfaceNode: !0 }); default: a = e.args.map(function (e) { return function (e) { return e.isPseudoSurfaceNode }(e) ? e : "Alphanumeric" === e.type ? r.__assign(r.__assign({}, e), { isPseudoSurfaceNode: !0 }) : f(e) }) }return r.__assign(r.__assign({}, e), { isPseudoSurfaceNode: !0, args: a }) } Object.defineProperty(e, "__esModule", { value: !0 }), e.formatLatex = void 0, e.formatLatex = function (e) { var r = a.expressionParser.parse(e.latex); if ("Err" != r.type) { for (var s = f(r); "Paren" === s.type;)s = s.args[0]; return t(s) ? { latex: e.latex } : { latex: n.renderLatex(s) } } } });
define('core/mathtools', ["require", "exports", "core/math/builtinframe", "parsenodes", "tslib", "core/math/parser", "core/math/context", "core/cl-calculator", "core/math/parser/latex-parser", "core/math/parser/expression-parser", "core/math/tree-queries/count-numbers", "core/lib/color-helpers", "core/math/policyGraphing", "core/math/policyScientific", "core/math/policyFourFunction", "./math/parser/surface-node-error", "core/lib/label", "core/graphing-calc/diffs/calculate-diff", "core/graphing-calc/diffs/apply-diff", "core/graphing-calc/migrate-state", "core/math/types", "core/graphing-calc/translation/translator", "./math/parser/input-span", "core/lib/number-to-latex", "core/lib/number-to-latex", "./lib/latex-search-helpers", "./math/format-latex"], function (require, e, r, t, a, n, i, o, c, l, p, u, s, f, m, b, g, h, d, y, x, L, P, j, O, D, T) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.formatLatex = e.replaceIdentifierWithLatex = e.numberToLatex = e.numberToDecimalString = e.applyLocalizationMap = e.extractLocalizationMap = e.migrateToLatest = e.applyDiff = e.calculateDiff = e.CLCalculator = e.colorHelpers = e.policies = e.parseNodes = e.types = e.builtInFrame = e.context = e.treeQueries = e.expressionParser = e.parser = e.Label = void 0, Object.defineProperty(e, "CLCalculator", { enumerable: !0, get: function () { return o.CLCalculator } }), e.colorHelpers = u, e.Label = g, Object.defineProperty(e, "calculateDiff", { enumerable: !0, get: function () { return h.calculateDiff } }), Object.defineProperty(e, "applyDiff", { enumerable: !0, get: function () { return d.applyDiff } }), Object.defineProperty(e, "migrateToLatest", { enumerable: !0, get: function () { return y.migrateToLatest } }), Object.defineProperty(e, "extractLocalizationMap", { enumerable: !0, get: function () { return L.extractLocalizationMap } }), Object.defineProperty(e, "applyLocalizationMap", { enumerable: !0, get: function () { return L.applyLocalizationMap } }), Object.defineProperty(e, "numberToDecimalString", { enumerable: !0, get: function () { return j.numberToDecimalString } }), e.numberToLatex = O.default, Object.defineProperty(e, "replaceIdentifierWithLatex", { enumerable: !0, get: function () { return D.replaceIdentifierWithLatex } }), Object.defineProperty(e, "formatLatex", { enumerable: !0, get: function () { return T.formatLatex } }), e.parser = { parse: function (e, r) { return null == e && (e = ""), n.parse(e, r) } }, e.expressionParser = { parse: function (r) { if (null != r) try { var t = c.parse(r); return l.parse(t) } catch (t) { var n = t instanceof e.parseNodes.Base ? t.getInputSpan() : P.Span(r, 0, r.length), i = a.__assign(a.__assign({}, b.UnexpectedParseError()), { originalError: t }); return b.Err(n, i) } } }, e.treeQueries = { countNumbers: p.countNumbers }, e.context = i.Context, e.builtInFrame = r, e.types = x, e.parseNodes = t, e.policies = { graphing: s.PolicyGraphing, scientific: f.PolicyScientific, fourFunction: m.PolicyFourFunction } });

define('loadcss!mygraphs/load-graph-view', function () { });
define('mygraphs/load-graph-view', ["require", "exports", "tslib", "dcgview", "loadcss!./load-graph-view"], function (require, e, n, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LoadGraphView = void 0; var r = t.Components.If, c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return n.__extends(c, e), c.prototype.template = function () { var e = this; return t.createElement("div", { class: t.const("dcg-loading-container") }, t.createElement(r, { predicate: function () { return !e.props.didDataLoadFail() } }, function () { return t.createElement("div", { class: t.const("dcg-graph-loading") }, t.createElement("div", { class: t.const("pulsing-message") }, function () { return e.props.s("account-shell-text-mygraphs-loading") }), t.createElement("div", { role: t.const("link"), tabindex: t.const("0"), class: t.const("dcg-cancel-while-loading"), onTap: e.props.onCancel }, function () { return e.props.s("account-shell-button-mygraphs-cancel") })) }), t.createElement(r, { predicate: function () { return e.props.didDataLoadFail() } }, function () { return t.createElement("div", { class: t.const("dcg-graph-loading-error"), "aria-live": t.const("assertive"), "aria-atomic": t.const("true") }, t.createElement("div", { class: t.const("dcg-graph-loading-error-title") }, function () { return e.props.s("account-shell-error-mygraphs-error-loading") }), t.createElement("div", { class: t.const("dcg-graph-loading-error-subtitle") }, function () { return e.props.s("account-shell-error-mygraphs-check-connection") }), t.createElement("div", { class: t.const("dcg-graph-loading-error-options") }, t.createElement("span", { role: t.const("button"), tabindex: t.const("0"), class: t.const("dcg-action-try-again dcg-btn-blue dcg-btn-medium"), onTap: e.props.requestLoadGraphData }, function () { return e.props.s("account-shell-button-mygraphs-try-again") }), t.createElement(r, { predicate: function () { return !!e.props.onCancel } }, function () { return t.createElement("span", null, function () { return e.props.s("account-shell-text-mygraphs-or") }) }), t.createElement(r, { predicate: function () { return !!e.props.onCancel } }, function () { return t.createElement("span", { role: t.const("button"), tabindex: t.const("0"), class: t.const("dcg-action-cancel dcg-btn-light-gray dcg-btn-medium"), onTap: e.props.onCancel }, function () { return e.props.s("account-shell-button-mygraphs-cancel") }) }))) })) }, c }(t.Class); e.LoadGraphView = c });
define('main/async_load_state', ["require", "exports", "dcgview", "mygraphs/load-graph-view", "jquery"], function (require, e, t, o, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.asyncLoadStateAtStartup = void 0, e.asyncLoadStateAtStartup = function (e, n) { var r = a.Deferred(); if (e && e.state) r.resolve(e); else if (e && "string" == typeof e.stateUrl) { var i = !1, s = function () { i || (i = !0, a.getJSON(e.stateUrl).done(function (t) { e.state = t, r.resolve(e) }).fail(function () { !function (e, a) { var n = document.createElement("div"); n.style.zIndex = "999999", n.style.position = "fixed", n.style.bottom = "50px", n.style.left = "0", n.style.right = "0", document.body.append(n), t.mountToNode(o.LoadGraphView, n, { s: a, didDataLoadFail: function () { return !0 }, requestLoadGraphData: function () { n.remove(), e() } }) }(s, n) }).always(function () { i = !1 })) }; s() } else r.resolve(); return r } });
define('api/calculator', ["require", "exports", "mathquill", "tslib", "main/mathquill-operators", "graphing/clipping", "graphing/canvas-labels", "core/constants", "main/shared-clock-bus", "core/math/parser", "lib/i18n", "expressions/colors", "graphing-calc/api/sanitize-expression", "core/graphing-calc/json/graph-settings", "main/font_sizes", "expressions/image_file_to_data_url", "./graphing", "./headless", "./fourfunction", "./scientific", "./pillow-keypad", "core/mathtools", "abraham", "../core/graphing-calc/extract-slider-value-from-latex", "main/async_load_state"], function (require, a, e, o, t, l, i, r, n, s, c, u, d, p, m, g, C, f, h, S, D, A, P, F) { "use strict"; var L; function b(a) { var e = L.enabledFeatures; return !e || e[a] } function y(e) { a.DesmosAPI[e] = function () { throw new Error("The Desmos " + e + " is not enabled for this API key.") } } for (var w in Object.defineProperty(a, "__esModule", { value: !0 }), a.Calculator = a.HeadlessGraphingCalculator = a.PillowKeypad = a.FourFunctionCalculator = a.ScientificCalculator = a.GraphingCalculator = a.DesmosAPI = void 0, "undefined" != typeof Desmos ? L = Desmos : (L = {}, window.Desmos = L), a.GraphingCalculator = C.default, a.HeadlessGraphingCalculator = f.default, a.FourFunctionCalculator = h.default, a.ScientificCalculator = S.default, a.PillowKeypad = D.default, a.DesmosAPI = { version: r.CURRENT_API_VERSION, Colors: { RED: u.RED, BLUE: u.BLUE, GREEN: u.GREEN, ORANGE: u.ORANGE, PURPLE: u.PURPLE, BLACK: u.BLACK }, imageFileToDataURL: g.imageFileToDataURL, supportedLanguages: ["en"].concat(L.localeData ? Object.keys(L.localeData) : L.locales ? Object.keys(L.locales) : []), Styles: o.__assign(o.__assign({}, d.SanitizedLineStyle), d.SanitizedPointStyle), ColumnModes: d.SanitizedColumnMode, DragModes: d.SanitizedDragMode, AxisArrowModes: p.AxisArrowModes, FontSizes: m, LabelSizes: d.SanitizedLabelSize, LabelOrientations: d.SanitizedLabelOrientation, GraphingCalculator: C.default, Calculator: C.default, FourFunctionCalculator: h.default, ScientificCalculator: S.default, Private: { Abraham: P, Mathtools: A, Graphtools: { getClippingGraphType: l.getClippingGraphType, mapSegmentToCanvas: l.mapSegmentToCanvas, computeDrawingCommandsForDOMLabel: i.computeDrawingCommandsForDOMLabel, drawCommandsToCtx: i.drawCommandsToCtx }, MathquillConfig: { getAutoCommands: t.getAutoCommands, getAutoOperators: t.getAutoOperators }, SharedClockBus: n, Parser: s, extractSliderValueFromLatex: F.extractSliderValueFromLatex, i18n: c }, MathQuill: e, PillowKeypad: D.default, HeadlessGraphingCalculator: f.default }, b("GraphingCalculator") || (y("GraphingCalculator"), y("Calculator")), b("FourFunctionCalculator") || y("FourFunctionCalculator"), b("ScientificCalculator") || y("ScientificCalculator"), a.DesmosAPI) a.DesmosAPI.hasOwnProperty(w) && (L[w] = a.DesmosAPI[w]); a.Calculator = C.default });
define('main/external-login-popup', ["require", "exports", "./backend"], function (require, e, o) { "use strict"; function n(e, o) { e.closed ? o.askServerIfLoggedIn() : setTimeout(function () { n(e, o) }, 1e3) } function l(e) { var o = window.open(e.url, "login_window", "width=650,height=530,resizable,scrollbars"); o ? n(o, e.userController) : alert(e.blockedMessage) } Object.defineProperty(e, "__esModule", { value: !0 }), e.listenForLoginRequests = void 0, e.listenForLoginRequests = function (e, n) { window.userController = e, e.observeEvent("googleLogin", function (t, i) { l({ url: o.getGoogleLoginURL(i), userController: e, blockedMessage: n("account-shell-text-login-window-blocked-google") }) }), e.observeEvent("appleLogin", function (t, i) { l({ url: o.getAppleLoginURL(i), userController: e, blockedMessage: n("account-shell-text-login-window-blocked-apple") }) }) } });
define('analytics/uuid', ["require", "exports"], function (require, x) { "use strict"; Object.defineProperty(x, "__esModule", { value: !0 }), x.uuid = void 0, x.uuid = function () { return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, function (x) { var e = 16 * Math.random() | 0; return ("x" == x ? e : 3 & e | 8).toString(16) }) } });
define('analytics/batch-log-sender', ["require", "exports", "tslib", "underscore", "jquery"], function (require, t, e, s, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.BatchLogSender = void 0; var a = function () { function t(t, e) { var a = this; this.apiUrl = t, this.staticData = e, this.throttledFlushBatchedLogs = s.throttle(function () { if (!a.requestInFlight && 0 != a.batchedLogs.length) { var t = a.batchedLogs.splice(0, 50); a.requestInFlight = !0, i.ajax({ url: a.apiUrl, type: "POST", contentType: "application/json", data: JSON.stringify({ events: t }) }).always(function () { a.requestInFlight = !1, a.throttledFlushBatchedLogs() }) } }, 1e3, { leading: !1 }), this.batchedLogs = [], this.requestInFlight = !1 } return t.prototype.log = function (t) { this.batchedLogs.push(e.__assign(e.__assign({}, this.staticData), t)), this.throttledFlushBatchedLogs() }, t }(); t.BatchLogSender = a });
define('analytics/looker', ["require", "exports", "tslib", "./uuid", "./batch-log-sender"], function (require, e, a, o, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.logPageLoad = e.logJSON = e.logNumber = e.log = e.getPageLoadId = void 0; var n = { eventType: "eventType", pageLoadId: window.pageLoadId || o.uuid(), source: "browser", app: "knox", userAgent: navigator.userAgent }; e.getPageLoadId = function () { return n.pageLoadId }; var g, t = new r.BatchLogSender("/data-events", n); function d(e) { t.log(a.__assign({ url: document.location.href }, e)) } function u(e, a) { d({ eventType: e, payloadJSON: JSON.stringify(a) }) } e.log = d, e.logNumber = function (e, a) { d({ eventType: e, payloadNumber: a }) }, e.logJSON = u; var i = !0; e.logPageLoad = function (e) { var o = document.location.href, r = navigator.userLanguage || navigator.language, n = document.referrer, t = a.__assign({ browserLang: r, referrer: n }, e); g !== o && (g = o, i ? (u("page-load", t), i = !1) : (delete t.referrer, u("page-spa-load", t))) } });
define('analytics/usage-client', ["require", "exports", "./uuid", "./batch-log-sender"], function (require, e, a, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.logUsageData = void 0; var t = { eventType: "eventType", pageLoadId: window.pageLoadId || a.uuid(), source: "browser", app: "knox", userAgent: navigator.userAgent }, n = new o.BatchLogSender("/usage-stats", t); e.logUsageData = function (e, a) { n.log({ eventType: e, url: document.location.href, payloadJSON: JSON.stringify(a) }) } });
define('analytics/queries/basic-controller', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.isDegreeMode = e.isProjectorMode = void 0, e.isProjectorMode = function (e) { return e.isProjectorMode() }, e.isDegreeMode = function (e) { return e.model.getDegreeMode() } });
define('analytics/queries/frontend-controller', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.isLoggedIn = void 0, e.isLoggedIn = function (e) { return e.userController.isLoggedIn() } });
define('analytics/queries/graph-feature', ["require", "exports", "graphing-calc/models/expression", "../../core/lib/dragmode"], function (require, e, t, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.expressionErrors = e.textCount = e.tableCount = e.imageCount = e.folderCount = e.expressionCount = e.hasCustomColors = e.hasMovablePoints = e.hasAction = e.hasRegression = e.hasSlider = void 0, e.hasSlider = function (e) { return e.getAllModelsWithSliders().length > 0 }, e.hasRegression = function (e) { for (var r = 0, n = e.getAllItemModels(); r < n.length; r++) { var o = n[r]; if ("expression" === o.type && t.isRegression(o)) return !0 } return !1 }, e.hasAction = function (e) { if (e.getListModel().ticker.open) return !0; for (var t = 0, r = e.getAllItemModels(); t < r.length; t++) { var n = r[t]; if (n && "formula" in n && n.formula) { if ("expression" !== n.type && "image" !== n.type) continue; var o = n.formula; if (o.hasOwnProperty("action_value") || o.hasOwnProperty("click_handler")) return !0 } } return !1 }, e.hasMovablePoints = function (e) { return e.getAllItemModels().some(function (e) { return "expression" === e.type && e.reconciledDragMode !== r.DragMode.NONE }) }, e.hasCustomColors = function (e) { for (var r = 0, n = e.getAllItemModels(); r < n.length; r++) { var o = n[r]; if ("expression" === o.type) if (t.getAssignment(o)) { var i = e.getEvaluationValueForItem(o.id); if ("string" == typeof i || Array.isArray(i) && "string" == typeof i[0]) return !0 } } return !1 }, e.expressionCount = function (e) { return e.getAllItemModels().filter(function (e) { return "expression" === e.type }).length }, e.folderCount = function (e) { return e.getAllItemModels().filter(function (e) { return "folder" === e.type }).length }, e.imageCount = function (e) { return e.getAllItemModels().filter(function (e) { return "image" === e.type }).length }, e.tableCount = function (e) { return e.getAllItemModels().filter(function (e) { return "table" === e.type }).length }, e.textCount = function (e) { return e.getAllItemModels().filter(function (e) { return "text" === e.type }).length }, e.expressionErrors = function (e) { for (var t = [], r = 0, n = e.getAllItemModels(); r < n.length; r++) { var o = n[r]; if ("expression" === o.type && o.error) { var i = o.error.key; "shared-calculator-error-blank-expression" !== i && t.push(i) } } return t } });
define('analytics/usage-monitor', ["require", "exports", "tslib", "./usage-client", "./queries/basic-controller", "./queries/frontend-controller", "./queries/graph-feature"], function (require, t, e, o, r, a, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var n = 1 / 60, s = function () { function t(t) { var e = this; void 0 === t && (t = {}), this.samplingInterval = 6e4, this.samplingProbability = n, this.lastConsideredTime = Date.now(), this.pageLoadTime = Date.now(), this.graphLoadTime = Date.now(), this.basicController = t.basicController, this.frontendController = t.frontendController, this.calcController = t.calcController, this.graphsController = t.graphsController, this.featureQueryMap = { "basic-controller-feature": [], "frontend-controller-feature": [], "graph-feature": [] }, this.focused = !0, this.focusIntervalStart = Date.now(), this.totalTimeFocused = 0, window.addEventListener("focus", function () { e.focused = !0, e.focusIntervalStart = Date.now() }), window.addEventListener("blur", function () { e.focused = !1, e.addTimeFocused() }), this.visibleIntervalStart = Date.now(), this.totalTimeVisible = 0, document.addEventListener("visibilitychange", function () { document.hidden ? e.addTimeVisible() : e.visibleIntervalStart = Date.now() }), this.graphsController && this.graphsController.observeEvent("onLoadGraph", function () { e.graphLoadTime = Date.now() }) } return t.prototype.getUsageData = function () { return e.__assign(e.__assign(e.__assign(e.__assign({}, this.getBasicUsageData()), this.getBasicControllerUsageData()), this.getFrontendControllerUsageData()), this.getGraphFeatureUsageData()) }, t.prototype.getBasicUsageData = function () { var t = { timeSincePageload: this.getTimeSincePageload(), totalTimeFocused: this.getTotalTimeFocused(), totalTimeVisible: this.getTotalTimeVisible(), samplingInterval: 6e4, samplingProbability: n }; return this.graphsController && (t.timeSinceGraphLoaded = Date.now() - this.graphLoadTime), t }, t.prototype.getDataFromController = function (t, e, o) { for (var r = {}, a = 0, i = this.featureQueryMap[t]; a < i.length; a++) { var n = i[a], s = e[n]; if (!s) throw new Error("'" + n + "' is not a valid feature name."); var l = s(o); (Array.isArray(l) && l.length > 0 || "boolean" == typeof l && l || "number" == typeof l) && (r[n] = l) } return r }, t.prototype.getBasicControllerUsageData = function () { return this.getDataFromController("basic-controller-feature", r, this.basicController) }, t.prototype.getFrontendControllerUsageData = function () { return this.getDataFromController("frontend-controller-feature", a, this.frontendController) }, t.prototype.getGraphFeatureUsageData = function () { return this.getDataFromController("graph-feature", i, this.calcController) }, t.prototype.callLogger = function () { var t = Date.now(); t - this.lastConsideredTime > this.samplingInterval && (this.lastConsideredTime = t, Math.random() < this.samplingProbability && o.logUsageData("usage-ping", this.getUsageData())) }, t.prototype.addTimeFocused = function () { var t = Date.now() - this.focusIntervalStart; this.totalTimeFocused += t }, t.prototype.addTimeVisible = function () { var t = Date.now() - this.visibleIntervalStart; this.totalTimeVisible += t }, t.prototype.getTotalTimeFocused = function () { return this.focused ? (this.addTimeFocused(), this.focusIntervalStart = Date.now(), this.totalTimeFocused) : this.totalTimeFocused }, t.prototype.getTotalTimeVisible = function () { return document.hidden || (this.addTimeVisible(), this.visibleIntervalStart = Date.now()), this.totalTimeVisible }, t.prototype.start = function () { setInterval(this.callLogger.bind(this)) }, t.prototype.trackFeatureUsage = function (t, e) { if (!this.calcController) throw new Error("Monitoring graph feature usage requires a calculator controller."); this.featureQueryMap[t].push(e) }, t.prototype.getTimeSincePageload = function () { return Date.now() - this.pageLoadTime }, t }(); t.default = s });
define('shared-header/hamburger', ["require", "exports", "tslib", "browser", "dcgview", "../shared-components/tooltip"], function (require, e, t, r, n, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Hamburger = void 0; var p = function (e) { function p() { return null !== e && e.apply(this, arguments) || this } return t.__extends(p, e), p.prototype.template = function () { var e = this; return n.createElement("span", { role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return e.openGraphText() }, class: n.const("dcg-header-btn dcg-action-opendrawer dcg-tooltip"), tooltip: function () { return e.openGraphText() }, onTap: function (t) { return e.props.controller().dispatch({ type: "open-mygraphs", device: t.device }) } }, n.createElement(o.Tooltip, { tooltip: function () { return e.openGraphText() }, disabled: function () { return !e.props.tooltip() }, gravity: this.const("se"), offset: function () { return { top: 12 } } }, n.createElement("i", { class: n.const("dcg-icon-hamburger"), "aria-hidden": n.const("true") }))) }, p.prototype.openGraphText = function () { var e = this.props.controller().getOpenText(); return r.IS_APPLE ? this.props.controller().s("account-shell-label-open-graph-mac", { open_graph: e }) : this.props.controller().s("account-shell-label-open-graph-pc", { open_graph: e }) }, p }(n.Class); e.Hamburger = p });
define('shared-header/accounts', ["require", "exports", "tslib", "dcgview", "jquery"], function (require, n, e, t, c) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.Accounts = void 0; var o = t.Components.If, r = function (n) { function r() { return null !== n && n.apply(this, arguments) || this } return e.__extends(r, n), r.prototype.template = function () { var n = this, e = this.props.controller().userController; return t.createElement("span", null, t.createElement(o, { predicate: function () { return e.isLoggedIn() && !n.props.disableAccounts() } }, function () { return t.createElement("span", null, t.createElement(o, { predicate: function () { return e.isLoggingOut() } }, function () { return t.createElement("span", { class: t.const("logout-progress-notice") }, t.createElement("span", { class: t.const("dcg-spinner-dark") })) }), t.createElement(o, { predicate: function () { return !e.isLoggingOut() && !n.props.disableAccounts() } }, function () { return t.createElement("span", { class: t.const("dcg-account-link"), "dcg-menu-button": t.const("account"), role: t.const("button"), tabindex: t.const(0), "aria-haspopup": t.const("true"), "aria-expanded": t.const("false"), "aria-label": t.const("Account Information"), onTap: function (e) { if (n.props.controller().dispatch({ type: "toggle-menu", payload: "account" }), "keyboard" == e.device) { var t = "account" === n.props.controller().getOpenMenu(); c(t ? ".dcg-action-accountsettings" : ".dcg-account-link").trigger("focus") } } }, t.createElement("span", { class: t.const("email") }, t.createElement("div", { class: t.const("header-account-name dcg-variable-name") }, function () { return e.getFirstName() }), t.createElement("i", { class: t.const("dcg-icon-caret-down"), "aria-hidden": t.const("true") }))) })) }), t.createElement(o, { predicate: function () { return !e.isLoggedIn() && !n.props.disableAccounts() } }, function () { return t.createElement("span", { class: t.const("dcg-login") }, t.createElement("a", { role: t.const("link"), tabindex: t.const(0), class: t.const("dcg-sign-in dcg-action-login dcg-btn-white-outline"), onTap: function (e) { n.props.controller().dispatch({ type: "show-modal", modal: "login", device: e.device }) } }, function () { return n.props.controller().s("account-shell-button-log-in") }), function () { return n.props.controller().s("account-shell-text-or") }, t.createElement("a", { role: t.const("link"), tabindex: t.const(0), class: t.const("dcg-create-account dcg-btn dcg-btn-primary dcg-dark-background dcg-action-createaccount"), onTap: function (e) { n.props.controller().dispatch({ type: "show-modal", modal: "signup", device: e.device }) } }, function () { return n.props.controller().s("account-shell-button-sign-up") })) })) }, r }(t.Class); n.Accounts = r });
define('shared-header/header-toast', ["require", "exports", "tslib", "dcgview", "main/toast-view"], function (require, t, e, r, s) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.HeaderToast = void 0; var o = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.template = function () { var t = this; return r.createElement(s.ToastView, { message: this.bindFn(this.getMessage), s: this.bindFn(this.s), onClose: function () { return t.graphsController().dismissSaveError() }, showUndo: this.const(!1), showLearnMore: this.const(!1), toastStyle: this.bindFn(this.getStyle), noAria: this.const(!1), showClose: this.bindFn(this.showClose) }) }, o.prototype.s = function (t, e) { return this.props.controller().s(t, e) }, o.prototype.graphsController = function () { return this.props.controller().graphsController }, o.prototype.getStyle = function () { return this.graphsController().didSaveFail() ? "error" : void 0 }, o.prototype.showClose = function () { return this.graphsController().didSaveFail() }, o.prototype.getMessage = function () { return this.graphsController().isSaving() ? this.props.controller().s("shared-calculator-label-saving") : this.graphsController().didSaveSucceed() ? this.props.controller().s("shared-calculator-label-saved") : this.graphsController().didSaveFail() ? this.props.controller().raw(this.graphsController().getSaveFailureMessage()) : "" }, o }(r.Class); t.HeaderToast = o });
define('calculator-shell/header-icon', ["require", "exports", "tslib", "dcgview", "../shared-components/tooltip"], function (require, t, e, n, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.HeaderIcon = void 0; var r = function (t) { function r() { return null !== t && t.apply(this, arguments) || this } return e.__extends(r, t), r.prototype.init = function () { this.controller = this.props.controller() }, r.prototype.template = function () { var t = this; return this.controller = this.props.controller(), n.createElement(o.Tooltip, { tooltip: this.props.tooltip, gravity: this.bindFn(this.getGravity), offset: function () { return { top: 12 } } }, n.createElement("span", { role: n.const("button"), tabindex: n.const(0), "aria-haspopup": n.const("true"), "aria-label": function () { return t.props.label() }, "aria-expanded": function () { return t.isMenuOpen() }, class: function () { var e; return (e = { "dcg-header-btn": !0 })["dcg-action-" + t.props.name()] = !0, e["dcg-tooltip"] = !0, e["dcg-active"] = t.isMenuOpen(), e }, "dcg-menu-button": this.props.name, onTap: this.props.onTap.bind(this) }, n.createElement("i", { class: this.props.icon, "aria-hidden": n.const("true") }))) }, r.prototype.getGravity = function () { return this.props.gravity ? this.props.gravity() : "s" }, r.prototype.isMenuOpen = function () { return this.controller.getOpenMenu() === this.props.label().toLowerCase() }, r }(n.Class); t.HeaderIcon = r });
define('calculator-shell/save-button', ["require", "exports", "tslib", "dcgview", "browser", "../shared-components/tooltip"], function (require, e, t, n, o, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SaveButton = void 0; var s = n.Components.IfElse, l = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return t.__extends(l, e), l.prototype.init = function () { this.controller = this.props.controller(), this.graphsController = this.controller.graphsController }, l.prototype.template = function () { var e = this; return s(function () { return e.graphsController.isSaving() }, { true: function () { return n.createElement("span", { class: n.const("dcg-if-user save-btn-container") }, n.createElement("span", { class: n.const("saving-notice") }, n.createElement("span", { class: n.const("dcg-spinner-dark") }))) }, false: function () { return n.createElement("span", { class: function () { return { "dcg-if-user save-btn-container": !0 } } }, n.createElement(r.Tooltip, { tooltip: function () { return e.controller.isSaveEnabled() ? e.saveChangesText() : e.controller.s("account-shell-label-no-unsaved-changes") }, offset: function () { return { top: 7 } } }, n.createElement("span", { role: n.const("button"), class: function () { return { "dcg-action-save": !0, "tooltip-offset": !0, "dcg-btn-white-outline": e.controller.isSaveEnabled(), "dcg-disabled": !e.controller.isSaveEnabled() } }, onTap: function (t) { e.controller.isSaveEnabled() && e.controller.simpleSave(t.device) } }, function () { return e.controller.s("account-shell-button-save") }))) } }) }, l.prototype.saveChangesText = function () { return o.IS_APPLE ? this.controller.s("account-shell-label-save-changes-mac") : this.controller.s("account-shell-label-save-changes-pc") }, l }(n.Class); e.SaveButton = l });
define('calculator-shell/graph-title', ["require", "exports", "tslib", "dcgview", "jquery", "./save-button"], function (require, t, o, e, r, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.GraphTitle = void 0; var l = e.Components.If, i = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return o.__extends(i, t), i.prototype.init = function () { this.controller = this.props.controller(), this.userController = this.controller.userController, this.graphsController = this.controller.graphsController }, i.prototype.template = function () { var t = this; return e.createElement("span", { class: e.const("title-div") }, e.createElement("span", { role: e.const("button"), class: e.const("dcg-variable-title-container"), "dcg-menu-button": function () { return t.shouldShowDropdown() ? "graph-actions" : void 0 }, tabindex: e.const(0), onTap: function (o) { t.shouldShowDropdown() ? t.openGraphActionsDropdown(o) : t.shouldOpenSaveDialog() && t.controller.dispatch({ type: "edit-title" }) }, "aria-haspopup": function () { return t.shouldShowDropdown() }, "aria-expanded": function () { return "graph-actions" == t.props.controller().getOpenMenu() }, "aria-label": function () { return t.shouldShowDropdown() ? t.controller.s("account-shell-label-graph-actions") : void 0 } }, e.createElement("span", { class: function () { return { "dcg-variable-title dcg-tooltip": !0, "dcg-action-savedialog": t.shouldOpenSaveDialog() } } }, function () { return t.graphsController.getCurrentGraphTitle() || t.graphsController.getUntitledString() }), e.createElement(l, { predicate: this.bindFn(this.shouldShowDropdown) }, function () { return e.createElement("span", { class: e.const("dcg-graph-actions-dropdown-anchor") }, e.createElement("i", { class: e.const("dcg-icon-caret-down"), "aria-hidden": e.const("true") })) })), e.createElement(l, { predicate: function () { return t.userController.isLoggedIn() && !t.controller.getPreviewParams() && !t.controller.isInMaintenanceMode() } }, function () { return e.createElement(n.SaveButton, { controller: t.props.controller }) })) }, i.prototype.shouldOpenSaveDialog = function () { return "geometry" === this.controller.product }, i.prototype.shouldShowDropdown = function () { return "geometry" !== this.controller.product && this.graphsController.wasCurrentGraphEverSaved() }, i.prototype.openGraphActionsDropdown = function (t) { this.props.controller().dispatch({ type: "toggle-menu", payload: "graph-actions" }), t && "keyboard" === t.device && "share" !== this.controller.getOpenMenu() && r(".dcg-graph-actions-container .dropdown-choice:not(.dropdown-choice-disabled):eq(0)").trigger("focus") }, i }(e.Class); t.GraphTitle = i });
define('frontpage/desmos-svg-logo', ["require", "exports", "tslib", "dcgview", "lib/i18n"], function (require, c, n, e, t) { "use strict"; Object.defineProperty(c, "__esModule", { value: !0 }), c.DesmosSVGLogo = void 0; var s = function (c) { function s() { return null !== c && c.apply(this, arguments) || this } return n.__extends(s, c), s.prototype.template = function () { return e.createElement("span", { onMount: this.bindFn(this.addSVGLogo) }) }, s.prototype.addSVGLogo = function (c) { c.innerHTML = '\n    <svg version="1.1" class="dcg-desmos-svg-logo" id="svg-desmos" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"\n    viewBox="0 0 909.3 188.4" style="enable-background:new 0 0 909.3 188.4;" xml:space="preserve">\n    <title>' + t.s("frontpage-narration-shared-desmos-logo") + '</title>\n    <g>\n      <path d="M129.6,0c-6.8,0-12.4,5.5-12.4,12.4v48c-27.7-25.4-70.6-24-96.7,3.1c-27.4,28.4-27.4,73.4,0,101.8\n        c26.1,27.1,69.1,28.4,96.8,3v8.8c2,6.5,9,10.2,15.5,8.2c3.9-1.2,7-4.3,8.2-8.2V12.4C141.1,5.9,136.1,0.5,129.6,0z M103.9,148.7\n        c-17.3,18.2-46.1,18.9-64.3,1.6c-0.6-0.5-1.1-1.1-1.6-1.6c-18.4-19.2-18.4-49.5,0-68.7c17.3-18.2,46.1-18.9,64.3-1.6\n        c0.6,0.5,1.1,1.1,1.6,1.6C122.3,99.3,122.3,129.6,103.9,148.7z"/>\n      <path d="M298.3,124c2.2-2.3,3.4-5.3,3.5-8.4c-0.1-19-7.6-37.2-20.9-50.7c-26.6-27.6-70.6-28.4-98.2-1.8c-0.6,0.6-1.2,1.2-1.8,1.8\n        c-27.4,28.4-27.4,73.4,0,101.8c21.8,22.6,56.2,27.7,83.7,12.4c10-5.6,18.5-13.5,24.8-23.1c3.4-5.5,1.9-12.7-3.3-16.5\n        c-5.5-3.3-12.6-1.7-16.4,3.5c-4.2,6.4-9.9,11.6-16.6,15.4c-6.8,3.8-14.4,5.8-22.2,5.8c-12.5,0-24.4-5.1-33.1-14.1\n        c-6-6.3-10.3-14-12.4-22.4h104C292.7,127.6,296,126.3,298.3,124z M231.3,67.2c12.4,0.1,24.3,5.2,33,14.1\n        c6.1,6.3,10.4,14.1,12.4,22.6h-90.7c2.1-8.5,6.3-16.3,12.4-22.6C207,72.4,218.8,67.3,231.3,67.2z"/>\n      <path d="M763.5,63c-26.7-28.1-71.1-29.2-99.2-2.5c-0.8,0.8-1.7,1.6-2.5,2.5c-13.7,13.9-21.3,32.7-20.9,52.2\n        c-0.2,19.3,7.2,37.8,20.7,51.6c27.7,28.2,73.1,28.7,101.3,0.9c0.3-0.3,0.6-0.6,0.9-0.9c13.4-13.8,20.9-32.4,20.7-51.7\n        c0.2-19.4-7.3-38.2-21.1-51.9 M712.8,66.7c12.4,0,24.2,5.2,32.5,14.4c8.9,9.2,13.8,21.5,13.6,34.3c0.2,12.7-4.6,25-13.5,34.1\n        c-8.5,9.2-20.5,14.2-33,13.9c-12.3,0.3-24.2-4.7-32.5-13.8c-8.8-9.1-13.6-21.4-13.3-34.1c-0.3-12.9,4.7-25.4,13.8-34.6\n        c8.2-9.3,20-14.6,32.4-14.4"/>\n      <path d="M623.8,92.6v81.9c0.3,6.8-4.9,12.7-11.8,13c-6.8,0.3-12.7-4.9-13-11.8V93.1c0-7.5-3-14.6-8.3-19.8\n        c-4.3-4.7-10.2-7.6-16.5-8.1h-1.9c-7-0.1-13.6,2.9-18.2,8.2c-4.8,4.9-7.5,11.5-7.7,18.3v2l0,0v81.1c0,6.8-5.5,12.4-12.4,12.4\n        c-6.5,0-11.9-4.9-12.4-11.4V91.5c-0.6-4.3-1.8-8.4-3.5-12.4c-1.2-2.3-2.6-4.5-4.3-6.4c-4.7-5.2-11.3-8.3-18.3-8.3\n        c-7,0-13.6,3-18.1,8.3c-5.1,5.2-8,12.3-7.9,19.6V176c-0.8,6.3-6.1,11-12.4,10.9c-6.8,0-12.4-5.5-12.4-12.4V52.9\n        c-0.7-6.8,4.2-12.9,11-13.6c5.9-0.6,11.4,3,13.1,8.7l2.9-1.9c7.4-3.9,15.6-6,23.9-5.9c12.3-0.1,24.1,4.3,33.3,12.4\n        c1.1,0.9,2.1,2,3,3.1c0.9,0.7,1.7,1.5,2.5,2.4l2.2-2.4c0.9-1.1,1.9-2.2,3-3.1c9.2-8.1,21-12.5,33.2-12.4h4.3\n        c10.8,0.8,21,5.1,29,12.4c0.9,1,2,1.9,3,2.9C618.9,65.3,624,78.7,623.8,92.6"/>\n      <path d="M427.2,145.4c0.1,23.4-18.6,42.5-42,43h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4H384c10-0.2,17.9-8.4,17.8-18.3\n        c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4c1.2-22,18.8-39.6,40.8-40.8h50.2\n        c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.1c-10,0.8-17.5,9.6-16.7,19.7c0.7,8.9,7.8,15.9,16.7,16.7H385\n        c5.9,0,11.8,1.2,17.2,3.7C417.7,112.8,427.2,128.4,427.2,145.4"/>\n      <path d="M908.9,145.2c0,23.4-18.3,42.7-41.6,43.3h-50.8c-6.8,0-12.4-5.5-12.4-12.4s5.5-12.4,12.4-12.4h50.2\n        c10-0.2,17.9-8.4,17.8-18.3c0.1-9.9-7.9-18-17.8-18.1c0,0-0.1,0-0.1,0h-24.8c-23.8-1.3-42-21.6-40.8-45.4\n        c1.2-22,18.8-39.6,40.8-40.8h49.6c6.8,0,12.4,5.5,12.4,12.4s-5.5,12.4-12.4,12.4h-49.6c-10.1,0-18.2,8.2-18.2,18.2c0,0,0,0,0,0\n        c0,9.9,8,18,17.8,18.1h24.8c5.9,0,11.8,1.3,17.2,3.7C898.9,112.8,908.9,128.2,908.9,145.2"/>\n    </g>\n    </svg>\n    ' }, s }(e.Class); c.DesmosSVGLogo = s });

define('loadcss!shared-header/header-bar', function () { });

define('loadcss!calculator-shell/calculator-shell', function () { });

define('loadcss!spinner', function () { });
define('calculator-shell/view', ["require", "exports", "tslib", "dcgview", "jquery", "lib/i18n", "shared-header/hamburger", "shared-header/accounts", "shared-header/header-toast", "./header-icon", "./graph-title", "../shared-components/tooltip", "frontpage/desmos-svg-logo", "loadcss!shared-header/header-bar", "loadcss!./calculator-shell", "loadcss!spinner"], function (require, e, t, n, r, o, c, l, a, s, i, u, d) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.HeaderBar = void 0; var p = n.Components.If, h = function (e) { function h() { return null !== e && e.apply(this, arguments) || this } return t.__extends(h, e), h.prototype.init = function () { this.controller = this.props.controller(), this.userController = this.controller.userController }, h.prototype.template = function () { var e = this, t = this.controller.isInMaintenanceMode(), r = this.controller.getPreviewParams(); return n.createElement("div", { class: n.const("dcg-header") }, n.createElement("div", { class: n.const("dcg-header-desktop") }, n.createElement("div", { class: n.const("align-left-container") }, n.createElement(c.Hamburger, { controller: this.props.controller, tooltip: n.const(!0) }), n.createElement(i.GraphTitle, { controller: this.props.controller })), n.createElement("div", { class: n.const("align-center-container") }, n.createElement("a", { href: n.const("/"), target: n.const("_blank"), class: n.const("dcg-home-link") }, n.createElement(d.DesmosSVGLogo, null))), n.createElement(a.HeaderToast, { controller: this.props.controller }), n.createElement(p, { predicate: function () { return e.userController.didLogoutFail() } }, function () { return n.createElement("div", { class: n.const("dcg-toast-container") }, n.createElement("div", { class: n.const("dcg-toast") }, function () { return e.controller.s("account-shell-error-logging-out") })) }), n.createElement("div", { class: n.const("align-right-container") }, n.createElement(l.Accounts, { controller: this.props.controller, disableAccounts: function () { return null != r || t } }), n.createElement(p, { predicate: function () { return e.controller.isArtContestEnabled() } }, function () { return n.createElement(u.Tooltip, { tooltip: function () { return o.s("account-shell-label-math-art-contest") }, gravity: e.const("s"), offset: function () { return { top: 12 } } }, n.createElement("span", { role: n.const("button"), tabindex: n.const(0), "aria-haspopup": n.const("true"), "aria-label": function () { return o.s("account-shell-label-math-art-contest") }, class: n.const("dcg-header-btn dcg-action-contest dcg-tooltip"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "contest-submission", device: t.device }) } }, n.const("ð"))) }), n.createElement(s.HeaderIcon, { controller: this.props.controller, label: function () { return o.s("account-shell-label-share") }, tooltip: function () { return e.controller.s("account-shell-label-share-graph") }, icon: n.const("dcg-icon-share"), name: function () { return "share" }, onTap: function (t) { if (e.controller.dispatch({ type: "toggle-menu", payload: "share" }), t && "keyboard" === t.device && "share" !== e.controller.getOpenMenu()) return e.focusElement(".dcg-action-share") } }), n.createElement(s.HeaderIcon, { controller: this.props.controller, label: function () { return o.s("account-shell-label-help") }, tooltip: function () { return e.controller.s("account-shell-label-help") }, icon: n.const("dcg-icon-question-sign"), name: n.const("help"), onTap: function (t) { if (e.controller.dispatch({ type: "toggle-menu", payload: "help" }), "keyboard" === t.device) { var n = "help" === e.controller.getOpenMenu() ? '.dcg-feature[href="/calculator?tour=sliders"]' : ".dcg-action-help"; return e.focusElement(n) } } }), n.createElement(s.HeaderIcon, { controller: this.props.controller, gravity: this.const("sw"), label: function () { return o.s("account-shell-label-language") }, tooltip: function () { return e.controller.s("account-shell-label-language") }, icon: n.const("dcg-icon-world"), name: n.const("language"), onTap: function (t) { if (e.controller.dispatch({ type: "toggle-menu", payload: "language" }), "keyboard" === t.device) { var n = "language" === e.controller.getOpenMenu() ? ".dcg-language-option.dcg-selected" : ".dcg-action-language"; return e.focusElement(n) } } }))), n.createElement(p, { predicate: function () { return null != r || t } }, function () { return n.createElement("div", { class: n.const("dcg-toast-container") }, n.createElement("span", { class: n.const("dcg-toast dcg-maintenance-toast") }, n.createElement("span", { class: n.const("dcg-msg") }, n.createElement(p, { predicate: function () { return t } }, function () { return n.createElement("span", null, function () { return e.controller.s("account-shell-text-maintenance-mode") }) }), n.createElement(p, { predicate: function () { return null != r } }, function () { return n.createElement("span", null, function () { return null != r ? r.message : void 0 }) })), n.createElement(p, { predicate: function () { return t } }, function () { return n.createElement("a", { class: n.const("undo"), target: n.const("_blank"), href: n.const("http://desmos.zendesk.com/entries/25429616-What-is-Maintenance-Mode-/") }, function () { return e.controller.s("account-shell-link-learn-more") }) }), n.createElement(p, { predicate: function () { return null != r } }, function () { return n.createElement("a", { class: n.const("undo"), target: n.const("_blank"), href: function () { return null != r ? r.url : void 0 } }, function () { return e.controller.s("account-shell-link-share-thoughts") }) }))) })) }, h.prototype.focusElement = function (e) { r(e).trigger("focus") }, h }(n.Class); e.HeaderBar = h });
define('calculator-shell/menu', ["require", "exports", "tslib", "dcgview", "jquery"], function (require, t, e, o, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.Menu = void 0; var n = o.Components.If, i = function (t) { function i() { return null !== t && t.apply(this, arguments) || this } return e.__extends(i, t), i.prototype.init = function () { this.controller = this.props.controller() }, i.prototype.template = function () { var t = this; return o.createElement("div", { class: function () { var e; return (e = { "dcg-popover": !0, "dcg-bottom": !0, "dcg-constrained-height-popover": !0 })["dcg-" + t.props.type() + "-container"] = !0, e["dcg-product-" + t.props.controller().getProduct()] = !0, e }, style: function () { return t.props.left ? { display: "block", left: t.props.left(), right: "auto" } : { display: "block" } }, role: o.const("complementary"), label: function () { return t.props.label() } }, o.createElement("div", { class: o.const("dcg-popover-interior") }, o.createElement(n, { predicate: function () { return !("function" != typeof t.props.title || !t.props.title()) } }, function () { return o.createElement("div", { class: o.const("dcg-popover-title") }, function () { return t.props.title() }) }), this.children), o.createElement("div", { class: o.const("dcg-arrow"), style: function () { return t.props.arrowLeft ? { left: t.props.arrowLeft(), right: "auto" } : {} } })) }, i.prototype.didMount = function () { var t = this, e = this.props.type(); this.guid = "menu-" + e, r("body").on("dcg-tapstart." + this.guid, function (o) { var n = r(o.target), i = !!n.closest(".dcg-popover").length, p = !!n.closest("[dcg-menu-button=" + e + "]").length; i || p || t.controller.dispatch({ type: "toggle-menu", payload: "none" }) }) }, i.prototype.didUnmount = function () { r("body").off("dcg-tapstart." + this.guid) }, i }(o.Class); t.Menu = i });

define('loadcss!shared-components/language-picker', function () { });

define('loadcss!shared-components/btn-styles', function () { });
define('shared-components/language-picker', ["require", "exports", "tslib", "dcgview", "loadcss!./language-picker", "loadcss!./btn-styles"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LanguagePicker = void 0; var r = n.Components, o = r.For, i = r.If, s = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.init = function () { this.i18n = this.props.i18n() }, r.prototype.template = function () { var e = this; return n.createElement("div", { class: function () { return { "dcg-language-picker": !0, "dcg-two-columns": e.getLanguages().length > 7 } } }, n.createElement("div", { class: n.const("dcg-language-header"), role: n.const("heading"), "aria-level": n.const("2") }, function () { return e.i18n.s("shared-title-language-menu") }), n.createElement(o, { each: function () { return e.getLanguages() } }, n.createElement("div", { class: n.const("dcg-languages-list"), role: n.const("list") }, function (t) { return n.createElement("div", { class: n.const("dcg-listitem"), role: n.const("listitem") }, n.createElement("div", { class: function () { return { "dcg-language-option": !0, "dcg-selected": e.isLanguageSelected(t) } }, lang: e.const(e.getLangCode(t)), role: n.const("link"), tabindex: n.const("0"), "aria-current": function () { return e.isLanguageSelected(t) }, onTap: function () { return e.updateLang(t) } }, function () { return e.i18n.raw(e.getLanguageDisplayName(t)) })) })), n.createElement(i, { predicate: function () { return e.shouldShowFooterLink() } }, function () { return n.createElement("a", { class: n.const("dcg-language-footer-link dcg-shared-blue-link"), href: function () { return e.getFooterLinkURL() } }, function () { return e.getFooterLinkText() }) })) }, r.prototype.shouldShowFooterLink = function () { return !(!this.props.footerLink || !this.props.footerLink()) }, r.prototype.getFooterLinkURL = function () { var e = this.props.footerLink && this.props.footerLink(); if (e) return e.url }, r.prototype.getFooterLinkText = function () { var e = this.props.footerLink && this.props.footerLink(); return e ? e.text : this.i18n.raw("") }, r.prototype.getCurrentLang = function () { return this.props.currentLang() }, r.prototype.getLanguages = function () { return Object.keys(this.props.getAllLangs()) }, r.prototype.getLanguageDisplayName = function (e) { return this.props.getAllLangs()[e].display_name }, r.prototype.updateLang = function (e) { var t = this.props.getAllLangs()[e].code; return this.props.onLangChosen(t) }, r.prototype.getLangCode = function (e) { return this.props.getAllLangs()[e].code }, r.prototype.isLanguageSelected = function (e) { return this.getLangCode(e) === this.getCurrentLang() }, r }(n.Class); e.LanguagePicker = s });

define('loadcss!calculator-shell/language', function () { });
define('calculator-shell/language-menu', ["require", "exports", "tslib", "dcgview", "./menu", "shared-components/language-picker", "../lib/enabled-languages", "loadcss!./language"], function (require, e, n, t, r, o, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.LanguageMenu = void 0; var a = l.buildSupportedLanguagesMap(), u = function (e) { function l() { return null !== e && e.apply(this, arguments) || this } return n.__extends(l, e), l.prototype.init = function () { this.controller = this.props.controller(), this.languageController = this.controller.languageController }, l.prototype.template = function () { var e = this; return t.createElement(r.Menu, { type: function () { return "language" }, label: function () { return e.controller.s("account-shell-narration-language-menu") }, controller: this.props.controller }, t.createElement("div", { class: t.const("dcg-popover-content") }, t.createElement(o.LanguagePicker, { getAllLangs: function () { return a }, currentLang: function () { return e.languageController.getLanguage() }, onLangChosen: function (n) { e.languageController.fetchAndSetLanguage(n), e.controller.dispatch({ type: "toggle-menu", payload: "none" }) }, i18n: this.props.controller }))) }, l }(t.Class); e.LanguageMenu = u });
define('core/math/conics', ['require', 'numeric', 'core/math/distance', 'core/math/qr'], function (require) { "use strict"; var r = require("numeric"), n = require("core/math/distance"), e = require("core/math/qr"); function t(r, t) { return n.approx(1 / e.conditionNumber(e.qr(r)), 0, t) } var i = { isLine: function (r, n, e, i, o, a) { return t([[r, n, 1], [e, i, 1], [o, a, 1]]) }, isCircle: function (r, n, e, i, o, a, c, u) { return t([[r * r + n * n, r, n, 1], [e * e + i * i, e, i, 1], [o * o + a * a, o, a, 1], [c * c + u * u, c, u, 1]]) }, isConic: function (r, n, e, i, o, a, c, u, f, l, s, h) { return t([[r * r, n * n, 2 * r * n, r, n, 1], [e * e, i * i, 2 * e * i, e, i, 1], [o * o, a * a, 2 * o * a, o, a, 1], [c * c, u * u, 2 * c * u, c, u, 1], [f * f, l * l, 2 * f * l, f, l, 1], [s * s, h * h, 2 * s * h, s, h, 1]]) }, conicQuadraticParameters: function (n, e, t, i, o, a, c, u, f, l) { return { a: r.det([[e * e, 2 * n * e, n, e, 1], [i * i, 2 * t * i, t, i, 1], [a * a, 2 * o * a, o, a, 1], [u * u, 2 * c * u, c, u, 1], [l * l, 2 * f * l, f, l, 1]]), b: r.det([[n * n, e * e, n, e, 1], [t * t, i * i, t, i, 1], [o * o, a * a, o, a, 1], [c * c, u * u, c, u, 1], [f * f, l * l, f, l, 1]]), c: -r.det([[n * n, 2 * n * e, n, e, 1], [t * t, 2 * t * i, t, i, 1], [o * o, 2 * o * a, o, a, 1], [c * c, 2 * c * u, c, u, 1], [f * f, 2 * f * l, f, l, 1]]) } }, classifyConic: function (r, n, e, o, a, c, u, f, l, s, h, b) { if (i.isLine(r, n, a, c, h, b)) return "line"; if (i.isCircle(r, n, e, o, l, s, h, b)) return "circle"; if (!i.isConic(r, n, e, o, a, c, u, f, l, s, h, b)) return "none"; var d = i.conicQuadraticParameters(r, n, e, o, a, c, u, f, l, s); return t([[d.a, d.b], [d.b, d.c]], 20) ? "parabola" : d.b * d.b > d.a * d.c ? "hyperbola" : "ellipse" }, classifyBranchConic: function (r) { var n, e; if (1 === r.length && 4 === r[0].length) return "line"; for (var t = 0; t < r.length; t++) { var o = r[t], a = o.length; if (a < 12) return "unknown"; if ("none" === (e = i.classifyConic(o[0], o[1], o[2 * Math.floor(1 * a / 12)], o[2 * Math.floor(1 * a / 12) + 1], o[2 * Math.floor(2 * a / 12)], o[2 * Math.floor(2 * a / 12) + 1], o[2 * Math.floor(3 * a / 12)], o[2 * Math.floor(3 * a / 12) + 1], o[2 * Math.floor(4 * a / 12)], o[2 * Math.floor(4 * a / 12) + 1], o[a - 2], o[a - 1]))) return "none"; if (n && e !== n) return "none"; n = e } return n } }; return i });
define('predicates/common', ['require', 'core/math/parser', 'core/math/conics', 'graphing-calc/models/expression', 'graphing-calc/models/list'], function (require) { "use strict"; var e = require("core/math/parser"), n = require("core/math/conics"), r = require("graphing-calc/models/expression"), t = require("graphing-calc/models/list"); return { FOCUSED_EXP: function (e, n) { return t.isItemSelected(e) && "expression" === e.type }, FOCUSED_OR_EMPTY_EXP: function (e, n) { return !(!t.isItemSelected(e) || "expression" !== e.type) || "expression" === e.type && r.isEmpty(e) }, COMPLEX_EXP: function (e, t) { return "expression" === e.type && r.isGraphable(e) && t && t.branches[0] && "line" !== n.classifyBranchConic(t.branches[0].segments) }, TABLEABLE_EXP: function (e, n) { return r.isGraphable(e) && e.formula.is_tableable }, EXP: function (e, n) { return "expression" === e.type }, GRAPHABLE_EXP: function (e, n) { return r.isGraphable(e) }, HAS_ERROR: function (e, n) { return e.error && ("expression" !== e.type || !r.isEmpty(e)) }, DEPENDS_ON: function (n) { return function (r, t) { return !!r.latex && e.parse(r.latex).getDependencies().indexOf(n) >= 0 } }, DEFINES: function (n) { return function (r, t) { return !!r.latex && e.parse(r.latex).getExports().indexOf(n) >= 0 } }, HAS_N_DEPENDENCIES: function (e) { return function (n, r) { return "expression" === n.type && n.formula && n.formula.variables && n.formula.variables.length >= e } }, NONCONSTANT_LINE: function (e, r) { return r && "line" === n.classifyBranchConic(r.branches[0].segments) && !isFinite(e.formula.constant_value) }, RESTRICTED_LINE: function (e, n) { return this.NONCONSTANT_LINE(e, n) && this.RESTRICTED(e, n) }, EXP_NOT_RESTRICTED_LINE: function (e, n) { return this.EXP(e, n) && !this.RESTRICTED_LINE(e, n) }, PARABOLA: function (e, r) { return r && r.branches && r.branches.some(function (e) { return "parabola" === n.classifyBranchConic(e.segments) }) }, RESTRICTED: function (e, n) { return !(!e || !e.latex) && !!e.latex.match(/\\left\\{(.+)\\right\\}/) }, SHIFTED_PARABOLA: function (e, n) { if (!this.PARABOLA(e, n)) return !1; var r = n.branches[0].compiled.fn; return 0 !== r(0) || 1 !== r(1) }, EVALUATION: function (e, n) { return e.formula && e.formula.is_evaluable && isFinite(e.formula.constant_value) }, HAS_DEPENDENT_Y: function (e, n) { return "y" === e.formula.assignment }, SLIDER: function (e, n) { return !!e.sliderExists && !r.isGraphable(e) }, ANIMATING_SLIDER: function (e, n) { return e.sliderExists && e.slider.isPlaying }, SLID_SLIDER: function (e, n) { return e.sliderExists && !r.isGraphable(e) && 1 !== r.getSliderValue(e) }, TABLE: function (e, n) { return "table" === e.type }, REGRESSION: function (e, n) { return e.formula && e.formula.regression }, HAS_DATA_COLUMN: function (e, n) { if (!this.TABLE(e, n)) return !1; for (var r = 1; r < e.columnModels.length; r++)if (e.columnModels[r].discrete) return !0; return !1 }, HAS_FUNCTION_COLUMN: function (e, n) { if (!this.TABLE(e, n)) return !1; for (var r = 1; r < e.columnModels.length; r++)if (!1 === e.columnModels[r].discrete) return !0; return !1 } } });
define('tours/base_tour', ['require', 'pjs', 'jquery', '../predicates/common', 'graphing-calc/models/abstract-item'], function (require) { "use strict"; var e = require("pjs"), t = require("jquery"), r = require("../predicates/common"), n = require("graphing-calc/models/abstract-item"); return e(function (e) { e.init = function (e) { this.Calc = e, this.controller = this.Calc.controller }, e.expressionsVisible = function () { return this.controller.isListVisible() }, e.s = function (e, t) { return this.controller.s(e, t) }, e.requireExpressionsVisible = function () { return { position: "e", content: this.s("graphing-tours-label-require-expressions-visible"), sel: t(".dcg-show-expressions-tab"), delayBeforeEnter: 400, delayBeforeExit: 400 } }, e.resourcesOpen = function () { return t("body").hasClass("resources-open") }, e.requireResourcesNotOpen = function () { return { position: "e", content: this.s("graphing-tours-label-require-resources-not-open"), sel: t(".dcg-action-opendrawer"), delayBeforeEnter: 400, delayBeforeExit: 400 } }, e.editListMode = function () { return this.controller.isInEditListMode() }, e.requireNotEditListMode = function () { return { position: "s", content: this.s("graphing-tours-label-require-not-edit-list-mode"), sel: t(".dcg-action-toggle-edit") } }, e.expressionCount = function () { return this.controller.getItemCount() }, e.getExpSketch = function (e) { var t = this.Calc.grapher.graphSketches[e.id]; if (!t || t.visible) return t }, e.getAvailableExp = function (e) { var t = this.getMatchingExpSelector(r.FOCUSED_OR_EMPTY_EXP, e); return t || ".dcg-new-math-div" }, e.expList = function () { return t(this.Calc.rootElt).find(".dcg-exppanel") }, e.getSelectorById = function (e) { return this.controller.getItemSelectorById(e) }, e.getModelById = function (e) { return this.controller.getItemModel(e) }, e.expMatches = function (e, t) { if (!e) return !1; if ("function" == typeof t) return t.call(r, e, this.getExpSketch(e)); for (var n = 0; n < t.length; n++)if (!t[n].call(r, e, this.getExpSketch(e))) return !1; return !0 }, e.getMatchingExpId = function (e, t) { var r, i, o = {}, s = this.controller.getAllItemModels(); for (r = 0; r < s.length; r++)i = s[r], "render" === n.getDisplayState(i) && (o[i.id] = !0); for (var c in t) delete o[c]; var l = this.controller.getSelectedItem(); if (l && o[l.id] && this.expMatches(l, e)) return l.id; for (r = 0; r < s.length; r++)if (o[(i = s[r]).id] && this.expMatches(i, e)) return i.id; return null }, e.getMatchingExpSelector = function (e, t) { var r = this.getMatchingExpId(e, t); return r ? this.getSelectorById(r) : r }, e.getMatchingExpModel = function (e, t) { var r = this.getMatchingExpId(e, t); return r ? this.getModelById(r) : r } }) });
define('tours/sliders', ['require', 'pjs', './base_tour', 'predicates/common'], function (require) { "use strict"; var e = require("pjs"), s = require("./base_tour"), t = require("predicates/common"); return e(s, function (e, s) { e.sliderHasSlid = !1, e.shouldPopup = function () { return !!this.getMatchingExpSelector(t.SLIDER) }, e.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.editListMode()) return this.requireNotEditListMode(); var e, s = this.getMatchingExpSelector(t.GRAPHABLE_EXP), i = this.getMatchingExpSelector(t.SLIDER), r = this.getMatchingExpSelector(t.ANIMATING_SLIDER), n = this.getMatchingExpSelector(t.SLID_SLIDER); if (s && r) return { final: !0, position: "s", endingMsg: this.s("graphing-tours-label-sliders-pro"), sel: r.find(".dcg-circular-icon") }; if (s && n) return n.find(".dcg-depressed").length ? { doNotUpdate: !0 } : { position: "s", content: "<b>" + this.s("graphing-tours-label-sliders-hands-free") + "</b><br>" + this.s("graphing-tours-label-sliders-press-play"), sel: n.find(".dcg-circular-icon") }; if (s && i) { var o = i.find(".dcg-thumb .dcg-graphic"); return 1 === o.length ? { position: "s", content: this.s("graphing-tours-label-sliders-drag-handle"), sel: o } : { position: "e", content: this.s("graphing-tours-label-sliders-change-value"), sel: i } } return (e = this.expressionCount() > 1 ? this.getMatchingExpSelector(t.HAS_N_DEPENDENCIES(1)) : this.getMatchingExpSelector(t.HAS_N_DEPENDENCIES(2))) ? { position: "s", content: "<b>" + this.s("graphing-tours-label-awesome") + "</b> " + this.s("graphing-tours-label-sliders-add"), sel: e.find(".dcg-slider-btn-container:last .dcg-btn-blue") } : (e = this.getMatchingExpSelector(t.FOCUSED_OR_EMPTY_EXP)) ? { position: "e", content: "<b>" + this.s("graphing-tours-label-sliders-make-sliders") + "</b><br>" + this.s("graphing-tours-label-sliders-try-typing", { sample_expression: '<span class="trip-math">y=mx+b</span>' }), sel: e, delayBeforeExit: 600 } : { position: "e", content: this.s("graphing-tours-label-sliders-blank-expression"), sel: ".dcg-action-newmath" } } }) });
define('tours/scatter_plot', ['require', 'pjs', 'jquery', './base_tour', 'predicates/common', 'graphing-calc/models/table'], function (require) { "use strict"; var t = require("pjs"), e = require("jquery"), s = require("./base_tour"), o = require("predicates/common"), i = require("graphing-calc/models/table"); return t(s, function (t, s) { t.shouldPopup = function () { return !!this.getMatchingExpSelector(o.TABLE) }, t.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.editListMode()) return this.requireNotEditListMode(); var t = this.getMatchingExpId(o.HAS_DATA_COLUMN), s = this.getSelectorById(t), n = this.getModelById(t); if (!s) { var r = e(".dcg-action-newtable:visible"); return 0 === r.length ? { position: "e", content: "<b>" + this.s("graphing-tours-label-tables-start") + "</b><br>" + this.s("graphing-tours-label-new-item"), sel: e(".dcg-add-expression-btn") } : { position: "e", content: this.s("graphing-tours-label-tables-select-table"), sel: r, delayBeforeExit: 300 } } for (var l, c, g, a = n, h = i.getSelectedCell(a), p = a.columnModels[0].cells.length, d = 0, b = 0; b < p && b < 3; b++) { var f = s.find(".dcg-row:nth-of-type(" + (b + 2) + ") .dcg-cell:nth-of-type(1)"), u = s.find(".dcg-row:nth-of-type(" + (b + 2) + ") .dcg-cell:nth-of-type(2)"); f.is(":not(.dcg-empty, .dcg-error)") && u.is(":not(.dcg-empty, .dcg-error)") && d++ } if (3 === d) { var y = a.columnModels[1].points && a.columnModels[1].lines, w = e(".dcg-table-column-menu").length > 0; return y && !w ? { final: !0, position: "e", endingMsg: this.s("graphing-tours-label-tables-whiz"), sel: s } : y ? { position: "e", content: this.s("graphing-tours-label-tables-close-options"), sel: s } : w ? { content: this.s("graphing-tours-label-tables-dots"), position: "e", sel: ".dcg-toggle-switch:eq(1)" } : { content: ["<b>" + this.s("graphing-tours-label-tables-last-trick") + "</b><br>", this.s("graphing-tours-label-tables-open-options")].join(""), position: "e", sel: s.find(".dcg-row:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon") } } for (l = 0; l < p; l++)for (c = 0; c < 2; c++)if ((g = s.find(".dcg-row:nth-of-type(" + (l + 2) + ") .dcg-cell:nth-of-type(" + (c + 1) + ")")).is(".dcg-error")) return { position: "e", content: this.s("graphing-tours-label-tables-valid-number"), sel: g }; if (!h) return { position: "e", content: this.s("graphing-tours-label-tables-back"), sel: s.find(".dcg-row:nth-of-type(" + l + ") .dcg-cell:nth-of-type(2)") }; if (2 === p && 1 === d && h && 1 === h.row) return { position: "e", content: this.s("graphing-tours-label-tables-next-row"), sel: s.find(".dcg-row:nth-of-type(" + (h.row + 1) + ") .dcg-cell:nth-of-type(2)") }; if (3 === p && 2 === d && h && 3 !== h.row) return { position: "e", content: "<b>" + this.s("graphing-tours-label-awesome") + "</b><br>" + this.s("graphing-tours-label-tables-enter"), sel: s.find(".dcg-row:nth-of-type(" + (h.row + 1) + ") .dcg-cell:nth-of-type(2)") }; for (l = 0; l < p; l++)for (c = 0; c < 2; c++)if ((g = s.find(".dcg-row:nth-of-type(" + (l + 2) + ") .dcg-cell:nth-of-type(" + (c + 1) + ")")).is(".dcg-empty")) { var m = this.s("graphing-tours-label-tables-fill-row"); return 2 === l && 1 === c && (m = this.s("graphing-tours-label-tables-fill-another")), 0 === l && 1 === c && (m = "<b>" + this.s("graphing-tours-label-tables-fill-cell") + "</b><br>" + this.s("graphing-tours-label-tables-type-number")), { position: "e", content: m, sel: s.find(".dcg-row:nth-of-type(" + (l + 2) + ") .dcg-cell:nth-of-type(2)") } } } }) });
define('tours/function_table', ['require', 'pjs', './base_tour', 'jquery', 'predicates/common', 'graphing-calc/models/table'], function (require) { "use strict"; var e = require("pjs"), t = require("./base_tour"), s = require("jquery"), n = require("predicates/common"), i = require("graphing-calc/models/table"); return e(t, function (e, t) { e.shouldPopup = function () { return !!this.getMatchingExpSelector(n.TABLE) }, e.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); var e = this.getMatchingExpId(n.HAS_FUNCTION_COLUMN), t = this.getSelectorById(e), o = this.getModelById(e), a = this.getMatchingExpSelector(n.FOCUSED_OR_EMPTY_EXP), l = this.getMatchingExpSelector([n.COMPLEX_EXP, n.TABLEABLE_EXP]); if (t) { var r = o, c = "POINTS" === r.columnModels[1].columnMode, d = s(".dcg-table-column-menu").length > 0, p = r.columnModels.length > 3 && !1 === r.columnModels[2].discrete, h = i.getSelectedCell(r); return p ? { final: !0, position: "e", endingMsg: this.s("graphing-tours-label-advanced-tables-wizard"), sel: t } : h && 0 === h.row && 2 === h.column ? { position: "e", content: this.s("graphing-tours-label-advanced-tables-type-function", { sample_expression: '<span class="trip-math">cos\\left(x\\right)</span>' }), sel: t.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(3)") } : !h || 0 === h.row && 2 === h.column ? c && !h ? { position: "e", content: this.s("graphing-tours-label-advanced-tables-continue"), sel: t.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(2)") } : d ? { content: this.s("graphing-tours-label-advanced-tables-dots"), position: "e", sel: ".dcg-table-points" } : { content: this.s("graphing-tours-label-advanced-tables-options"), position: "e", sel: t.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(2) .dcg-circular-icon") } : { position: "e", content: this.s("graphing-tours-label-advanced-tables-new-column"), sel: t.find("tr:nth-of-type(1) .dcg-cell:nth-of-type(3)") } } return l ? this.editListMode() ? { position: "e", content: this.s("graphing-tours-label-advanced-tables-create"), sel: ".dcg-action-createtable", delayBeforeExit: 400 } : { position: "s", content: "<b>" + this.s("graphing-tours-label-advanced-tables-convert") + "</b><br>" + this.s("graphing-tours-label-advanced-tables-edit-list"), sel: ".dcg-action-toggle-edit" } : a ? { position: "e", content: ["<b>" + this.s("graphing-tours-label-advanced-tables-graph") + "</b><br>", this.s("graphing-tours-label-advanced-tables-type-function", { sample_expression: '<span class="trip-math">y=sin\\left(x\\right)</span>' })].join(""), sel: a } : { position: "e", content: this.s("graphing-tours-label-advanced-tables-start"), sel: ".dcg-new-math-div" } } }) });
define('tours/restrictions', ['require', 'pjs', './base_tour', 'predicates/common'], function (require) { "use strict"; var s = require("pjs"), t = require("./base_tour"), e = require("predicates/common"); return s(t, function (s) { s.shouldPopup = function () { return !!this.getMatchingExpSelector(e.RESTRICTED) }, s.restrictedLineTour = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); var s = this.getMatchingExpSelector(e.RESTRICTED_LINE), t = this.getMatchingExpSelector(e.EXP_NOT_RESTRICTED_LINE); if (s) return t ? (this.phaseOn++, this.update()) : { position: "e", content: "<b>" + this.s("graphing-tours-label-brilliant") + "</b><br>" + this.s("graphing-tours-label-restrictions-new-expression"), sel: ".dcg-new-math-div" }; var i = this.getMatchingExpId(e.FOCUSED_OR_EMPTY_EXP), r = this.getSelectorById(i), n = this.getModelById(i); if (r) { var a = this.expMatches(n, e.NONCONSTANT_LINE); return this.expMatches(n, e.HAS_ERROR) ? { doNotUpdate: !0 } : a ? { position: "e", content: ["<b>" + this.s("graphing-tours-label-awesome") + "</b><br>", this.s("graphing-tours-label-restrictions-domain", { sample_expression: '<span class="trip-math">\\left\\{x<0\\right\\}</span>' }), "<br><i>" + this.s("graphing-tours-label-restrictions-abc", { buttons: "{ }" }) + "</i>"].join(""), sel: r } : { position: "e", content: ["<b>" + this.s("graphing-tours-label-restrictions-start") + "</b><br>", this.s("graphing-tours-label-restrictions-straight-line", { sample_expression: '<span class="trip-math">y=2x</span>' })].join(""), sel: r } } return { position: "e", content: this.s("graphing-tours-label-restrictions-blank-expression"), sel: ".dcg-new-math-div" } }, s.restrictedParabolaTour = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.getMatchingExpSelector([e.RESTRICTED, e.PARABOLA])) return { final: !0, position: "e", endingMsg: this.s("graphing-tours-label-restrictions-star"), sel: ".dcg-exppanel-container" }; var s = this.getMatchingExpId([e.EXP_NOT_RESTRICTED_LINE, e.FOCUSED_EXP]), t = this.getSelectorById(s), i = this.getModelById(s); if (t) { var r = this.expMatches(i, [e.PARABOLA, e.HAS_DEPENDENT_Y]), n = this.expMatches(i, e.SHIFTED_PARABOLA), a = this.expMatches(i, e.PARABOLA); return this.expMatches(i, e.HAS_ERROR) ? { doNotUpdate: !0 } : a ? r ? n ? { position: "e", content: ["<b>" + this.s("graphing-tours-label-nice") + "</b><br>" + this.s("graphing-tours-label-restrictions-range", { sample_expression: '<span class="trip-math">\\left\\{y<4\\right\\}</span>' })].join(""), sel: t } : { position: "e", content: ["<b>" + this.s("graphing-tours-label-restrictions-move-parabola") + "</b><br>", this.s("graphing-tours-label-restrictions-change-equation", { sample_expression: '<span class="trip-math">y=x^2-2</span>' })].join(""), sel: t } : { position: "e", content: ["<b>" + this.s("graphing-tours-label-restrictions-dont-forget") + "</b><br>", this.s("graphing-tours-label-restrictions-type-all", { sample_expression: '<span class="trip-math">y=x^2</span>' })].join(""), sel: t } : { position: "e", content: [this.s("graphing-tours-label-restrictions-graph-parabola", { sample_expression: '<span class="trip-math">y=x^2</span>' }) + "<br><i>" + this.s("graphing-tours-label-restrictions-typing-hint", { suggestion1: "y=x^2", suggestion2: '<span class="trip-math">a^2</span>' }) + "</i>"].join(""), sel: t } } return { position: "e", content: this.s("graphing-tours-label-restrictions-blank-expression"), sel: ".dcg-new-math-div" } }, s.phaseOn = 0, s.phases = [s.restrictedLineTour, s.restrictedParabolaTour], s.update = function () { return this.phases[this.phaseOn].call(this) } }) });

define('loadcss!regression-tour', function () { });
define('tours/regressions', ['require', 'pjs', 'jquery', './base_tour', 'loadcss!regression-tour', 'browser', 'predicates/common'], function (require) { "use strict"; var t = require("pjs"), e = require("jquery"), s = require("./base_tour"); require("loadcss!regression-tour"); var i = require("browser"), r = require("predicates/common"); return t(s, function (t, s) { t.shouldPopup = function () { return !!this.getMatchingExpSelector(r.TABLE) }, t.hasCreatedLinearRegression = !1, t.hasInitiallyRenderedSampleDataLink = !1, t.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.editListMode()) return this.requireNotEditListMode(); var t = this.getMatchingExpId(r.REGRESSION) || this.getMatchingExpId(r.EXP), s = this.getSelectorById(t), a = this.getModelById(t), n = this.getMatchingExpId(r.HAS_DATA_COLUMN), o = this.getSelectorById(n), l = this.getModelById(n); if (!o || !l.columnModels[1]) { var d = e(".dcg-action-newtable:visible"), g = !i.IS_IPAD && !i.IS_MOBILE; return 0 === d.length && g ? this.hasInitiallyRenderedSampleDataLink ? { doNotUpdate: !0 } : (this.hasInitiallyRenderedSampleDataLink = !0, { position: "e", content: '<div class="trip-title">' + this.s("graphing-tours-label-regressions-data") + "</div>" + this.s("graphing-tours-label-regressions-docs", { sample_data_link: '<a class="trip-link" target="_blank" href="https://docs.google.com/spreadsheets/d/1h4kYwWka_1PvI5G-hPYz_QBe1FrYLo9Gb1XvxJz-QYE/edit#gid=0">' + this.s("graphing-tours-label-regressions-sample-data") + "</a>" }) + ' <div class="trip-hint"><br>' + this.s("graphing-tours-label-regressions-own-data", { plus_icon: '<i class="dcg-icon-plus" aria-hidden="true"></i>' }) + "</div>", sel: s || e(".dcg-exppanel") }) : 0 === d.length ? { position: "e", content: '<div class="trip-title">' + this.s("graphing-tours-label-regressions-data-2") + "</div>" + this.s("graphing-tours-label-new-item"), sel: e(".dcg-add-expression-btn"), delayBeforeExit: 150 } : { position: "e", content: this.s("graphing-tours-label-regressions-new-table"), sel: d, delayBeforeExit: 250 } } if (o.find(".dcg-row .dcg-cell:nth-of-type(2):not(.dcg-table-header):not(.dcg-empty)").length < 5) return { position: "e", content: '<div class="trip-title">' + this.s("graphing-tours-label-regressions-fill-sample-data") + "</div><table class='dcg-regression-tour-table'><tr><td><span class='trip-math'>x_1</span></td><td><span class='trip-math'>y_1</span></td></tr><tr><td>1</td><td>0.8</td></tr><tr><td>2</td><td>2.7</td></tr><tr><td>3</td><td>3.9</td></tr><tr><td>4</td><td>4.6</td></tr><tr><td>5</td><td>5</td></tr></table>", sel: o.find(".dcg-row:nth-of-type(2) .dcg-cell:nth-of-type(2)") }; if ("expression" !== (this.getMatchingExpModel(r.REGRESSION) || this.getMatchingExpModel(r.FOCUSED_EXP) || this.controller.getItemModelByIndex(0)).type) { var p = e(".dcg-action-newexpression:visible"); return 0 === p.length ? { position: "e", content: '<div class="trip-title">' + this.s("graphing-tours-label-awesome") + "</div>" + this.s("graphing-tours-label-new-item"), sel: e(".dcg-add-expression-btn"), delayBeforeExit: 150 } : { position: "e", content: this.s("graphing-tours-label-regressions-expression-option"), sel: p, delayBeforeExit: 150 } } var h = a.formula, c = h ? h.regression : void 0, u = c ? c.statistics : void 0, b = c ? c.parameters : void 0; if (u && u.r && (this.hasCreatedLinearRegression = !0), !this.hasCreatedLinearRegression) return { position: "e", content: this.s("graphing-tours-label-regressions-equation", { equation: "<span class='trip-math'>y_1\\sim mx_1+b</span>" }) + "<div class='trip-hint'>" + this.s("graphing-tours-label-regressions-hint-1", { y_1: "<span class='trip-math'>y_1</span>", y1: "<span class='trip-math'>y1</span>" }) + "</div><div class='trip-hint'>" + this.s("graphing-tours-label-regressions-hint-2", { twiddle: "<span class='trip-math'>~</span>" }) + "</div>", sel: s, delayBeforeExit: 150 }; var v = e(".dcg-residual-suggestion.dcg-visible"); return v.length ? { position: "e", content: "<div class='trip-title'>" + this.s("graphing-tours-label-regressions-check-model") + "</div>" + this.s("graphing-tours-label-regressions-residuals"), sel: v, delayBeforeExit: 250 } : u && (u.Rsquared >= .99 || u.r >= .99 || b && b.a && b.k && b.h) ? { final: !0, position: "e", endingMsg: "<div class='trip-title'>" + this.s("graphing-tours-label-regressions-keep-exploring") + "</div>", sel: e(".dcg-exppanel") } : { position: "e", content: "<div class='trip-title'>" + this.s("graphing-tours-label-regressions-new-model") + "</div>" + this.s("graphing-tours-label-regressions-better-fit", { equation: "<span class='trip-math'>y_1~a(x_1-h)^2+b</span>" }), sel: s, delayBeforeExit: 300 } } }) });
define('tours/list_predicates', ['require', 'predicates/common', 'core/math/parser', 'graphing-calc/models/expression'], function (require) { "use strict"; var e = require("predicates/common"), n = require("core/math/parser"), t = require("graphing-calc/models/expression"), r = function (e) { return function (r, i) { if (!r.latex) return !1; var s = n.parse(r.latex); if (!s._expression) return !1; if ("List" !== s._expression.type && "Range" !== s._expression.type) return !1; if (e.dependent && e.dependent !== t.getAssignment(r)) return !1; var u = s.getConcreteTree(); return !e.minLength || !(void 0 === u.length || u.length < e.minLength) } }; return { ANY_LIST: r({}), A_LIST: r({ dependent: "a", minLength: 3 }), B_LIST: r({ dependent: "b", minLength: 5 }), C_LIST: r({ dependent: "c", minLength: 10 }), A_DEP: function (n, t) { return e.GRAPHABLE_EXP(n, t) && e.DEPENDS_ON("a")(n, t) }, B_DEP: function (n, t) { return e.GRAPHABLE_EXP(n, t) && e.DEPENDS_ON("b")(n, t) }, C_DEP: function (n, t) { return e.DEPENDS_ON("c")(n, t) && e.EVALUATION(n, t) } } });
define('tours/lists', ['require', 'pjs', './base_tour', './list_predicates'], function (require) { "use strict"; var t = require("pjs"), i = require("./base_tour"), s = require("./list_predicates"); return t(i, function (t, i) { t.shouldPopup = function () { return !!this.getMatchingExpSelector(s.ANY_LIST) }, t.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.editListMode()) return this.requireNotEditListMode(); var t = this.getMatchingExpId(s.A_LIST), i = this.getMatchingExpId(s.B_LIST), e = this.getMatchingExpId(s.C_LIST), a = this.getMatchingExpId(s.A_DEP), n = this.getMatchingExpId(s.B_DEP), l = this.getMatchingExpSelector(s.C_DEP); return t ? a ? i ? e ? n ? l ? { final: !0, position: "e", endingMsg: this.s("graphing-tours-label-great-job"), sel: l.find(".dcg-evaluation"), scrollContainer: this.expList() } : { position: "e", content: "<b>" + this.s("graphing-tours-label-last-thing") + "</b> " + this.s("graphing-tours-label-list-computation", { equation: "<span class='trip-math'>total\\left(c\\right)</span>" }) + "<div class='trip-hint'>", sel: this.getAvailableExp([t, i, a, e, n]), scrollContainer: this.expList(), delayBeforeExit: 600 } : { position: "e", content: "<b>" + this.s("graphing-tours-label-lists-graph-points") + "</b> " + this.s("graphing-tours-label-lists-point-equation", { equation: "<span class='trip-math'>\\left(b, sin\\left(b\\right)\\right)</span>" }) + "<div class='trip-hint'>" + this.s("graphing-tours-label-lists-hint-plot-points") + "</div>", sel: this.getAvailableExp([t, i, a, e]), scrollContainer: this.expList() } : { position: "e", content: this.s("graphing-tours-label-lists-count-by", { equation: "<span class='trip-math'>c=\\left[10, 15, ..., 95\\right]</span>" }), sel: this.getAvailableExp([t, i, a]), scrollContainer: this.expList(), delayBeforeExit: 600 } : { position: "e", content: "<b>" + this.s("graphing-tours-label-awesome") + "</b> " + this.s("graphing-tours-label-lists-create-range", { equation: "<span class='trip-math'>b=\\left[0...8\\right]</span>" }), sel: this.getAvailableExp([t, a]), scrollContainer: this.expList(), delayBeforeExit: 600 } : { position: "e", content: "<b>" + this.s("graphing-tours-label-lists-put-to-work") + "</b> " + this.s("graphing-tours-label-lists-graph-equation", { equation: "<span class='trip-math'>y=x^2+a</span>" }) + "<div class='trip-hint'>" + this.s("graphing-tours-label-lists-hint-superscript", { suggestion1: "y=x^2+a", suggestion2: "a<sup>2</sup>" }) + "</div>", sel: this.getAvailableExp([t]), scrollContainer: this.expList() } : { position: "e", content: "<b>" + this.s("graphing-tours-label-lists-are-powerful") + "</b><br>" + this.s("graphing-tours-label-lists-begin-equation", { equation: "<span class='trip-math'>a=\\left[1,2,3\\right]</span>" }) + "<div class='trip-hint'>" + this.s("graphing-tours-label-lists-hint-abc"), sel: this.getAvailableExp(), scrollContainer: this.expList(), delayBeforeExit: 600 } } }) });
define('tours/folders', ['require', 'pjs', './base_tour', 'jquery', 'graphing-calc/models/expression'], function (require) { "use strict"; var e = require("pjs"), t = require("./base_tour"), i = require("jquery"), s = require("graphing-calc/models/expression"), n = function (e, t) { return "folder" == e.type }, r = function (e, t) { return s.isGraphable(e) && !e.folderId }; return e(t, function (e, t) { e.shouldPopup = function () { return !!this.getMatchingExpSelector(n) }, e.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.editListMode()) return this.requireNotEditListMode(); var e = this.getMatchingExpId(n), t = this.getSelectorById(e), s = this.getModelById(e), o = this.getMatchingExpSelector(r); if (!s) { var l = i(".dcg-action-newfolder:visible"); return 0 === l.length ? { position: "e", content: "<b>" + this.s("graphing-tours-label-folders-start") + "</b><br>" + this.s("graphing-tours-label-new-item"), sel: i(".dcg-add-expression-btn") } : { position: "e", content: this.s("graphing-tours-label-folders-option"), sel: l } } return this.cachedTitle != s.title && (this.cachedTitle = s.title, this.lastChange = new Date), !this.cachedTitle || new Date - this.lastChange < 1e3 ? { position: "e", content: this.s("graphing-tours-label-folders-name"), sel: t } : 0 === s.controller.getNumberOfItemsInFolder(s.id) ? o ? { position: "e", content: this.s("graphing-tours-label-folders-grab") + "<div class='trip-hint'>" + this.s("graphing-tours-label-folders-indicator") + "</div>", scrollContainer: this.expList(), sel: o } : { position: "e", content: "<b>" + this.s("graphing-tours-label-awesome") + "</b> " + this.s("graphing-tours-label-folders-new-equation", { equation: "<span class='trip-math'>x+y=3</span>" }), scrollContainer: this.expList(), sel: this.getAvailableExp(), delayBeforeExit: 500 } : s.collapsed ? s.hidden ? { final: !0, position: "e", endingMsg: this.s("graphing-tours-label-great-job"), sel: ".dcg-exppanel-container", scrollContainer: this.expList() } : { position: "s", content: "<b>" + this.s("graphing-tours-label-folders-did-you-know") + "</b>" + this.s("graphing-tours-label-folders-hide"), scrollContainer: this.expList(), sel: t.find(".dcg-circular-icon") } : { position: "e", content: "<b>" + this.s("graphing-tours-label-folders-great-start") + "</b> " + this.s("graphing-tours-label-folders-collapse"), scrollContainer: this.expList(), sel: t.find(".dcg-caret-container") } } }) });
define('tours/derivatives_predicates', ['require', 'predicates/common'], function (require) { "use strict"; var E = require("predicates/common"), n = function (E, n) { return E.latex.indexOf("\\frac{d}{dx}") >= 0 }; return { DEFINE_F: function (n, r) { return !!E.DEFINES("f")(n, r) && !!E.COMPLEX_EXP(n, r) }, DEFINE_G: function (r, t) { return !!E.DEFINES("g")(r, t) && (!!E.DEPENDS_ON("f")(r, t) && (!!E.GRAPHABLE_EXP(r, t) && n(r))) }, INLINE_DERIVATIVE: function (r, t) { return !!E.COMPLEX_EXP(r, t) && (!E.DEPENDS_ON("f")(r, t) && n(r)) } } });
define('tours/derivatives', ['require', 'pjs', './base_tour', './derivatives_predicates'], function (require) { "use strict"; var t = require("pjs"), i = require("./base_tour"), e = require("./derivatives_predicates"); return t(i, function (t, i) { t.shouldPopup = function () { return !1 }, t.update = function () { if (this.resourcesOpen()) return this.requireResourcesNotOpen(); if (!this.expressionsVisible()) return this.requireExpressionsVisible(); if (this.editListMode()) return this.requireNotEditListMode(); var t = this.getMatchingExpId(e.DEFINE_F), i = this.getMatchingExpId(e.DEFINE_G), s = this.getMatchingExpSelector(e.INLINE_DERIVATIVE); return t ? i ? s ? { final: !0, position: "e", endingMsg: this.s("graphing-tours-label-great-job"), sel: s, scrollContainer: this.expList() } : { position: "e", content: this.s("graphing-tours-label-derivative-one-more", { equation: "<span class='trip-math'>\\frac{d}{dx}\\ln \\left(x\\right)</span>" }), sel: this.getAvailableExp([t, i]), scrollContainer: this.expList() } : { position: "e", content: this.s("graphing-tours-label-derivative-graph-derivative", { equation: "<span class='trip-math'>g\\left(x\\right)=\\frac{d}{dx}f\\left(x\\right)</span>" }) + "<div class='trip-hint'>" + this.s("graphing-tours-label-derivative-hint-type-derivative") + "</div>", sel: this.getAvailableExp([t]), scrollContainer: this.expList() } : { position: "e", content: "<b>" + this.s("graphing-tours-label-derivative-start-graph") + "</b><br>" + this.s("graphing-tours-label-derivative-start-function", { equation: "<span class='trip-math'>f\\left(x\\right)=x\\sin \\left(x\\right)</span>" }), sel: this.getAvailableExp(), scrollContainer: this.expList() } } }) });
define('tours/all_tours', ['require', 'tours/sliders', 'tours/scatter_plot', 'tours/function_table', 'tours/restrictions', 'tours/regressions', 'tours/lists', 'tours/folders', 'tours/derivatives', 'underscore'], function (require) { "use strict"; var e = require("tours/sliders"), t = require("tours/scatter_plot"), r = require("tours/function_table"), s = { sliders: { tour: e, titleKey: "graphing-tours-heading-sliders" }, tables: { tour: t, titleKey: "graphing-tours-heading-tables" }, restrictions: { tour: require("tours/restrictions"), titleKey: "graphing-tours-heading-restrictions" }, functiontable: { tour: r, hideInHelp: !0, titleKey: "graphing-tours-heading-advanced-tables" }, regressions: { tour: require("tours/regressions"), titleKey: "graphing-tours-heading-regressions" }, lists: { tour: require("tours/lists"), titleKey: "graphing-tours-heading-lists", hideInHelp: !0 }, folders: { tour: require("tours/folders"), titleKey: "graphing-tours-heading-folders", hideInHelp: !0 }, derivatives: { tour: require("tours/derivatives"), titleKey: "graphing-tours-heading-derivatives", hideInHelp: !0 } }; return require("underscore").each(s, function (e, t) { e.name = t }), s });
define('calculator-shell/tour-links', ["require", "exports", "tours/all_tours", "tslib", "dcgview", "underscore"], function (require, t, e, r, n, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.TourLinks = void 0; var l = n.Components, u = l.For, c = l.If, i = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return r.__extends(e, t), e.prototype.init = function () { this.controller = this.props.controller(), this.tourController = this.controller.tourController }, e.prototype.template = function () { var t = this; return n.createElement("a", { class: n.const("dcg-feature"), href: function () { return "/calculator?tour=" + t.props.name() }, target: n.const("_blank"), ignoreRealClick: function () { return !t.tourController.shouldPopupTour(t.props.name()) }, onTap: function (e) { if (!t.tourController.shouldPopupTour(t.props.name())) return e.originalEvent.preventDefault(), t.controller.dispatch({ type: "toggle-menu", payload: "none" }), t.controller.tourController.startTour(t.props.name(), "help") } }, n.createElement("span", { class: function () { return "dcg-thumb dcg-" + t.props.name() } }), function () { return t.controller.s(t.props.titleKey()) }) }, e }(n.Class), s = function (t) { function l() { return null !== t && t.apply(this, arguments) || this } return r.__extends(l, t), l.prototype.template = function () { var t = this; return n.createElement(u, { each: function () { return o.keys(e) } }, n.createElement("div", { class: n.const("dcg-popover-content dcg-tours-content"), role: n.const("group"), "aria-label": n.const("Tours") }, function (r) { return n.createElement(c, { predicate: function () { return !e[r].hideInHelp } }, function () { return n.createElement(i, { name: function () { return null != e[r] ? e[r].name : void 0 }, titleKey: function () { return null != e[r] ? e[r].titleKey : void 0 }, controller: t.props.controller }) }) })) }, l }(n.Class); t.TourLinks = s });
define('calculator-shell/resource-links', ["require", "exports", "tslib", "dcgview", "../lib/enabled-languages"], function (require, e, t, n, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ResourceLinks = void 0; var r = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement("a", { href: function () { return e.props.href() }, target: n.const("_blank"), class: n.const("dcg-resource-link") }, n.createElement("i", { class: function () { return e.props.icon() }, "aria-hidden": n.const("true") }), n.createElement("span", null, function () { return e.props.title() }, n.const(" "))) }, o }(n.Class), c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller() }, c.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-popover-content dcg-resources-content"), role: n.const("group"), "aria-label": n.const("Resources") }, n.createElement(r, { href: n.const("https://help.desmos.com/hc/en-us/articles/4406040715149-Getting-Started-Desmos-Graphing-Calculator"), icon: n.const("dcg-icon-rocket"), title: function () { return e.controller.s("account-shell-link-getting-started") } }), n.createElement(r, { href: n.const("https://www.youtube.com/playlist?list=PLfM6zMGnbgOGLZc-_Yj3QVK3Vz_L4Cw59"), icon: n.const("dcg-icon-film"), title: function () { return e.controller.s("account-shell-link-video-tutorials") } }), n.createElement(r, { href: function () { var t = e.controller.languageController.getLanguage(); return o.ENABLED_LANGUAGES[t] ? o.ENABLED_LANGUAGES[t].userGuideURL : o.ENABLED_LANGUAGES.en.userGuideURL }, icon: n.const("dcg-icon-book"), title: function () { return e.controller.s("account-shell-link-user-guide") } }), n.createElement(r, { href: n.const("https://help.desmos.com/"), icon: n.const("dcg-icon-comments"), title: function () { return e.controller.s("account-shell-link-help-center") } }), n.createElement("div", { class: n.const("dcg-resource-link dcg-action-show-hotkeys"), role: n.const("link"), tabindex: n.const(0), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "hotkeys", device: t.device }) } }, n.createElement("i", { class: n.const("dcg-icon-keyboard"), "aria-hidden": n.const("true") }), n.createElement("span", null, function () { return e.controller.s("account-shell-link-keyboard-shortcuts") }))) }, c }(n.Class); e.ResourceLinks = c });
define('main/calculator_backend', ["require", "exports", "main/graph", "./backend"], function (require, r, e, a) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.clearRecoveryGraphsForTests = r.removeGraph = r.getRecoveryGraphs = r.getGraphs = r.emailFeedback = r.saveGraph = void 0, r.saveGraph = function (r, t) { if (!t.hasOwnProperty("myGraphs")) throw new Error("Argument Error: saveGraph options must specify myGraphs"); if (!t.hasOwnProperty("isUpdate")) throw new Error("Argument Error: saveGraph options must specify isUpdate"); var o = { parent_hash: r.parentHash, recovery_parent_hash: r.recoveryParentHash, thumb_data: r.thumbURL, graph_hash: r.hash, my_graphs: t.myGraphs, is_update: t.isUpdate, recovery: t.recovery, title: r.title || void 0, calc_state: r.graphData, lang: t.lang }; return a.post("/api/v1/calculator/save", o).then(function (a) { return e.updateFromSync(r, a), r }) }, r.emailFeedback = function (r) { return a.post("/api/v1/calculator/email_feedback", r) }, r.getGraphs = function (r) { return a.getJSON("/api/v1/calculator/my_graphs", r) }, r.getRecoveryGraphs = function (r) { return a.getJSON("/api/v1/calculator/recovery_graphs", r) }, r.removeGraph = function (r) { return a.post("/api/v1/calculator/my_graphs/remove", r) }, r.clearRecoveryGraphsForTests = function () { return a.post("/api/v1/calculator/recovery_graphs/clear") } });
define('lib/parse-json-errors', ["require", "exports"], function (require, r) { "use strict"; function e(r) { if (0 === r.status) return [{ message: "Connection failed. Check your internet connection?" }]; try { return JSON.parse(r.responseText).errors } catch (r) { return [{ message: "Unexpected server error. Try again, or e-mail calculator@desmos.com." }] } } Object.defineProperty(r, "__esModule", { value: !0 }), r.parseJSONErrors = r.rawParseJSONErrors = void 0, r.rawParseJSONErrors = e, r.parseJSONErrors = function (r) { return e(r).map(function (r) { return r.message }) } });
define('calculator-shell/contact-form', ["require", "exports", "main/calculator_backend", "tslib", "dcgview", "jquery", "lib/parse-json-errors"], function (require, e, t, n, o, r, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ContactForm = void 0; var c = o.Components, a = c.If, l = c.For, i = c.Input, u = c.Textarea, d = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return n.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller(), this.userController = this.controller.userController, this.formErrors = [], this.feedbackInProgress = !1, this.feedbackFromName = this.userController.getEmail(), this.didSendFeedbackEmail = !1 }, c.prototype.template = function () { var e = this; return o.createElement("div", { class: o.const("dcg-suggestions") }, o.createElement("div", { class: o.const("template-errors") }, o.createElement(a, { predicate: function () { return !!e.formErrors.length } }, function () { return o.createElement(l, { each: function () { return e.formErrors } }, o.createElement("span", null, function (e) { return o.createElement("div", { class: o.const("errors") }, o.createElement("span", null, function () { return e })) })) })), o.createElement("form", { didMount: this.didMountContactForm.bind(this), class: o.const("dcg-action-submit") }, o.createElement("div", { class: o.const("dcg-feedback-message-label") }, function () { return e.controller.s("account-shell-label-feedback-message") }), o.createElement(u, { placeholder: function () { return e.controller.s("account-shell-label-feedback-placeholder") }, didMount: this.didMountTextArea.bind(this), disabled: function () { return !e.shouldAllowSubmission() }, class: o.const("dcg-shared-input-blue-outline"), name: o.const("message"), value: function () { return e.controller.getFeedbackMessage() }, onInput: function (t) { if (e.controller.setFeedbackMessage(t), !e.unmounted) return e.update() } }), o.createElement("div", { class: o.const("dcg-suggestions-expansion") }, o.createElement("div", { class: o.const("dcg-feedback-email-label") }, function () { return e.controller.s("account-shell-label-feedback-email") }), o.createElement(i, { name: o.const("anonymous-email"), class: o.const("dcg-anonymous-email dcg-shared-input-blue-outline"), placeholder: function () { return e.controller.s("account-shell-label-email-placeholder") }, disabled: function () { return !e.shouldAllowSubmission() }, type: o.const("email"), value: function () { return e.feedbackFromName }, onInput: function (t) { if (e.feedbackFromName = t, !e.unmounted) return e.update() } }), o.createElement("div", { class: o.const("dcg-feedback-action-container") }, o.createElement(a, { predicate: function () { return e.feedbackInProgress } }, function () { return o.createElement("div", { class: o.const("dcg-template-processing") }, o.createElement("span", { class: o.const("dcg-spinner") }), function () { return e.controller.s("account-shell-label-feedback-sending") }) }), o.createElement(a, { predicate: function () { return e.didSendFeedbackEmail } }, function () { return o.createElement("div", { class: o.const("dcg-template-sent") }, o.createElement("i", { class: o.const("dcg-icon-check"), "aria-hidden": o.const("true") }), function () { return e.controller.s("account-shell-text-feedback-sent") }) }), o.createElement(a, { predicate: this.bindFn(this.shouldAllowSubmission) }, function () { return o.createElement("span", { class: o.const("dcg-feedback-btns") }, o.createElement("a", { role: o.const("link"), tabindex: o.const(0), class: o.const("dcg-action-closesuggestion"), onTap: e.bindFn(e.onCancel) }, function () { return e.controller.s("account-shell-button-cancel") }), o.createElement("button", { class: o.const("dcg-shared-btn-blue"), name: o.const("submit"), type: o.const("submit") }, function () { return e.controller.s("account-shell-button-contact-us") })) }))))) }, c.prototype.didMountContactForm = function (e) { var t = this; return r(e).on("submit", function (e) { return e.preventDefault(), t.submitForm() }) }, c.prototype.didMountTextArea = function (e) { this.unmounted || e.focus() }, c.prototype.didUnmount = function () { this.unmounted = !0 }, c.prototype.shouldAllowSubmission = function () { return !this.feedbackInProgress && !this.didSendFeedbackEmail }, c.prototype.onCancel = function () { this.controller.setFeedbackMessage(""), this.controller.dispatch({ type: "show-contact-form", showForm: !1 }) }, c.prototype.submitForm = function () { var e = this; this.didSendFeedbackEmail = !1, this.feedbackInProgress = !0, this.formErrors = []; var n = r.trim(r('textarea[name="message"]').val()); if (n.length || (this.formErrors = [this.controller.s("account-shell-error-feedback-empty")]), this.formErrors.length) return this.feedbackInProgress = !1, void (this.unmounted || this.update()); var o = { message: n, state: JSON.stringify(this.controller.api.getState()), userAgent: navigator.userAgent, "anonymous-email": r('input[name="anonymous-email"]').val() }; t.emailFeedback(o).done(function () { e.didSendFeedbackEmail = !0, e.controller.setFeedbackMessage(""), e.feedbackFromName = e.userController.getEmail(), setTimeout(function () { e.didSendFeedbackEmail = !1, e.unmounted || e.update() }, 2e3) }).fail(function (t) { e.formErrors = s.parseJSONErrors(t).map(function (t) { return e.controller.raw(t) }) }).always(function () { e.feedbackInProgress = !1, e.unmounted || e.update() }), this.unmounted || this.update() }, c }(o.Class); e.ContactForm = d });
define('calculator-shell/contact-us', ["require", "exports", "tslib", "dcgview", "./contact-form"], function (require, t, e, n, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.ContactUs = void 0; var c = n.Components.IfElse, r = function (t) { function r() { return null !== t && t.apply(this, arguments) || this } return e.__extends(r, t), r.prototype.handleClick = function () { this.props.controller().dispatch({ type: "show-contact-form", showForm: !0 }) }, r.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-popover-content dcg-hide-on-mobile"), role: n.const("group"), "aria-label": n.const("Feedback") }, c(function () { return t.props.controller().requestedContactForm() }, { true: function () { return n.createElement("div", { class: n.const("dcg-resources-content dcg-feedback-content") }, n.createElement(o.ContactForm, { controller: t.props.controller })) }, false: function () { return n.createElement("div", { class: n.const("dcg-contact-us") }, n.createElement("a", { class: n.const("dcg-contact-link"), onTap: t.bindFn(t.handleClick) }, n.createElement("i", { class: n.const("dcg-icon-mail"), "aria-hidden": n.const("true") }), n.createElement("span", null, function () { return t.props.controller().s("account-shell-link-email-support") }))) } })) }, r }(n.Class); t.ContactUs = r });

define('loadcss!calculator-shell/help', function () { });
define('calculator-shell/help-menu', ["require", "exports", "tslib", "dcgview", "./menu", "./tour-links", "./resource-links", "./contact-us", "loadcss!./help"], function (require, e, t, r, n, o, l, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.HelpMenu = void 0; var s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.init = function () { this.controller = this.props.controller() }, s.prototype.template = function () { var e = this; return r.createElement(n.Menu, { title: function () { return e.controller.s("account-shell-heading-tours") }, type: function () { return "help" }, label: function () { return e.controller.s("account-shell-label-help-menu") }, controller: this.props.controller }, r.createElement(o.TourLinks, { controller: this.props.controller }), r.createElement("div", { class: r.const("dcg-popover-title"), "aria-hidden": r.const("true") }, function () { return e.controller.s("account-shell-heading-resources") }), r.createElement(l.ResourceLinks, { controller: this.props.controller }), r.createElement("div", { class: r.const("dcg-popover-title dcg-interior-title dcg-hide-on-mobile"), "aria-hidden": r.const("true") }, function () { return e.controller.s("account-shell-heading-contact-us") }), r.createElement(c.ContactUs, { controller: this.props.controller })) }, s }(r.Class); e.HelpMenu = s });

define('loadcss!lib/selectable-input', function () { });
define('lib/selectable-input', ["require", "exports", "tslib", "dcgview", "browser", "jquery", "loadcss!./selectable-input"], function (require, t, e, n, r, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SelectableInput = void 0; var c = n.Components, a = c.Input, i = c.Switch, s = function (t) { function c() { var e = null !== t && t.apply(this, arguments) || this; return e.unmounted = !1, e } return e.__extends(c, t), c.prototype.didUnmount = function () { this.unmounted = !0 }, c.prototype.template = function () { var t = this; return n.createElement("div", { class: n.const("dcg-selectable-input-container") }, n.createElement(a, { class: this.const("dcg-permalink select-all dcg-variable-permalink"), "aria-label": function () { return t.props.controller().s("graphing-calculator-narration-share-graph-link") }, name: function () { return t.props.controller().s("graphing-calculator-text-share-graph-link") }, value: this.props.link, didMount: function (e) { t.inputEl = e, r.IS_MOBILE || t.inputEl.focus() }, onTap: function () { return t.inputEl.select() }, onInput: function () { } }), n.createElement("div", { role: n.const("button"), tabindex: n.const(0), class: n.const("dcg-copy-button"), onTap: this.bindFn(this.copyLink) }, n.createElement(i, { key: function () { return t.copyStatus } }, function (e) { return "success" == e ? n.createElement("span", { "aria-label": function () { return t.props.controller().s("graphing-calculator-narration-share-graph-link-copied") } }, n.createElement("i", { class: n.const("dcg-icon-check"), "aria-hidden": n.const("true") })) : "error" == e ? n.createElement("span", { "aria-label": function () { return t.props.controller().s("graphing-calculator-narration-share-graph-link-unable-to-copy") } }, n.createElement("i", { class: n.const("dcg-icon-error"), "aria-hidden": n.const("true") })) : n.createElement("span", { class: n.const("dcg-copy-text") }, function () { return t.props.controller().s("graphing-calculator-button-share-graph-link-copy") }) }))) }, c.prototype.copyLink = function () { var t = this; if (this.inputEl) { o(this.inputEl).trigger("focus").trigger("select"), this.copyStatus = "success"; try { document.execCommand("copy") } catch (t) { this.copyStatus = "error" } this.unmounted || (this.update(), clearTimeout(this.copyStatusTimeout), this.copyStatusTimeout = setTimeout(function () { t.copyStatus = null, t.unmounted || t.update() }, 2500)) } }, c }(n.Class); t.SelectableInput = s });

define('loadcss!calculator-shell/share-menu', function () { });
define('calculator-shell/share-menu', ["require", "exports", "main/calculator_backend", "tslib", "dcgview", "jquery", "lib/selectable-input", "./menu", "analytics/looker", "shared/dcgviews/localize", "loadcss!./share-menu"], function (require, e, t, n, r, o, c, s, a, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ShareMenu = void 0; var i = r.Components, u = i.If, d = i.Textarea, p = function (e) { function t() { return null !== e && e.apply(this, arguments) || this } return n.__extends(t, e), t.prototype.init = function () { this.controller = this.props.controller(), this.graphsController = this.controller.graphsController, this.graph = null, this.shareInProgress = !0, this.didSharingFail = !1, a.logJSON("user-action::open-share-dropdown", {}) }, t.prototype.template = function () { var e = this; return r.createElement(s.Menu, { title: function () { return e.controller.s("account-shell-heading-share-graph") }, type: r.const("share"), label: function () { return e.controller.s("account-shell-narration-share-options") }, controller: this.props.controller }, r.createElement("div", { class: r.const("dcg-popover-content") }, r.createElement(u, { predicate: function () { return e.shareInProgress } }, function () { return r.createElement("div", { class: r.const("dcg-loading") }, r.createElement("span", { class: r.const("dcg-spinner") }), function () { return e.controller.s("account-shell-label-loading") }) }), r.createElement(u, { predicate: function () { return e.didSharingFail } }, function () { return r.createElement("div", { class: r.const("dcg-failed") }, r.createElement("span", { "aria-live": r.const("assertive"), "aria-atomic": r.const(!0) }, function () { return e.controller.s("account-shell-error-sharing-link") + " " }), r.createElement("span", { role: r.const("button"), tabindex: r.const(0), class: r.const("dcg-action-retry"), onTap: function () { return e.controller.dispatch({ type: "toggle-menu", payload: "none" }), e.controller.dispatch({ type: "toggle-menu", payload: "share" }) } }, function () { return e.controller.s("account-shell-button-retry-now") }), function () { return " " + e.controller.s("account-shell-text-or") + " " }, r.createElement("span", { role: r.const("button"), tabindex: r.const(0), class: r.const("dcg-action-close"), onTap: function () { return e.controller.dispatch({ type: "toggle-menu", payload: "share" }) } }, function () { return e.controller.s("account-shell-button-cancel") }), r.const(".")) }), r.createElement(u, { predicate: function () { return !e.shareInProgress && !e.didSharingFail } }, function () { return r.createElement("div", { class: r.const("dcg-loaded"), didMount: e.didMountLoaded.bind(e) }, function () { return e.controller.s("account-shell-label-share-link") }, r.createElement(c.SelectableInput, { controller: e.props.controller, link: function () { return e.getGraphPath() } }), r.createElement(u, { predicate: function () { return !e.controller.shouldDisablePrintAndExport() } }, function () { return r.createElement("div", { class: r.const("dcg-share-actions") }, r.createElement("span", { class: r.const("dcg-print-link"), onTap: e.print.bind(e), tabindex: r.const(0), role: r.const("link") }, r.createElement("i", { class: r.const("dcg-icon-print"), "aria-hidden": r.const("true") }), r.createElement("span", null, function () { return e.controller.s("account-shell-button-print") })), r.createElement("span", { class: r.const("dcg-export-image-link"), onTap: e.exportImage.bind(e), tabindex: r.const(0), role: r.const("link") }, r.createElement("i", { class: r.const("dcg-icon-export"), "aria-hidden": r.const("true") }), r.createElement("span", null, function () { return e.controller.s("account-shell-button-export-image") })), r.createElement("span", { class: function () { return { "dcg-embed-link": !0, "dcg-selected": e.embedVisible } }, onTap: e.toggleEmbedVisible.bind(e), tabindex: r.const(0), role: r.const("button"), "aria-pressed": function () { return e.embedVisible } }, r.createElement("i", { class: r.const("dcg-icon-embed"), "aria-hidden": r.const("true") }), r.createElement("span", null, function () { return e.controller.s("account-shell-button-embed") }))) }), r.createElement(u, { predicate: function () { return e.embedVisible } }, function () { return r.createElement("div", { class: r.const("dcg-embed-div share-div"), didMount: e.didMountTextarea.bind(e) }, r.createElement(d, { rows: r.const("6"), class: r.const("select-all first-input dcg-variable-htmlembedcode"), value: function () { return e.getGraphEmbedCode() }, onInput: function () { } })) }), r.createElement(u, { predicate: function () { return e.controller.shouldShowArtContestNudge() } }, function () { return r.createElement("div", { class: r.const("dcg-art-contest-container") }, r.createElement("span", { class: r.const("dcg-trophy-icon") }, r.const("ð")), r.createElement(l.Localize, { i18n: e.const(e.controller), key: e.const("account-shell-text-share-submit-to-contest") }, r.createElement("span", { class: r.const("dcg-contest-submit-message") }, r.const("Submit this graph to the"), r.const(" "), r.createElement("span", { class: r.const("dcg-bold-text") }, r.const("Global Math Art Contest!")))), r.createElement("div", { class: r.const("dcg-enter-btn"), role: r.const("button"), tabindex: r.const(0), onTap: function (t) { return e.controller.state.artContestURLFromShareMenu = e.getGraphPath(), e.controller.dispatch({ type: "show-modal", modal: "contest-submission", device: t.device }) } }, function () { return e.controller.s("account-shell-button-submit") })) })) }))) }, t.prototype.didMountTextarea = function (e) { o(e).find("textarea").trigger("focus").trigger("select") }, t.prototype.toggleEmbedVisible = function () { this.embedVisible = !this.embedVisible, this.unmounted || this.update() }, t.prototype.didMountLoaded = function () { this.embedVisible = !1 }, t.prototype.print = function () { window.print() }, t.prototype.exportImage = function (e) { this.controller.dispatch({ type: "show-modal", modal: "export-image", device: e.device }) }, t.prototype.getGraphPath = function () { return null != this.graph ? this.graph.getURL() : void 0 }, t.prototype.getGraphEmbedCode = function () { if (!this.graph) return ""; return '<iframe src="' + (this.getGraphPath() + "?embed") + '" width="500" height="500" style="border: 1px solid #ccc" frameborder=0></iframe>' }, t.prototype.didUnmount = function () { this.unmounted = !0 }, t.prototype.didMount = function () { var e = this; return this.graphsController.shareGraph().done(function (t) { e.graph = t }).fail(function () { e.didSharingFail = !0 }).always(function () { e.shareInProgress = !1, e.unmounted || e.update() }) }, t }(r.Class); e.ShareMenu = p });

define('loadcss!calculator-shell/account-menu', function () { });
define('calculator-shell/account-menu', ["require", "exports", "tslib", "dcgview", "./menu", "loadcss!./account-menu"], function (require, t, n, e, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.AccountMenu = void 0; var r = e.Components.If, c = function (t) { function c() { return null !== t && t.apply(this, arguments) || this } return n.__extends(c, t), c.prototype.init = function () { this.controller = this.props.controller(), this.userController = this.controller.userController }, c.prototype.template = function () { var t = this; return e.createElement(r, { predicate: function () { return t.userController.isLoggedIn() } }, function () { return e.createElement(o.Menu, { type: function () { return "account" }, label: function () { return t.controller.s("account-shell-label-account-information") }, left: t.props.left, arrowLeft: t.props.arrowLeft, controller: t.props.controller }, e.createElement("div", { class: e.const("user-info") }, e.createElement("span", { class: e.const("account-name") }, function () { return t.userController.getFullName() }), e.createElement("span", { class: e.const("account-email") }, function () { return t.userController.getEmail() }), e.createElement("a", { class: e.const("dcg-action-accountsettings"), role: e.const("link"), tabindex: e.const(0), onTap: function (n) { return t.controller.dispatch({ type: "show-modal", modal: "account-settings", device: n.device }) } }, function () { return t.controller.s("account-shell-link-account-settings") })), e.createElement("a", { class: e.const("dcg-action-logout"), role: e.const("link"), tabindex: e.const(0), onTap: function () { return t.logout() } }, function () { return t.controller.s("account-shell-link-sign-out") })) }) }, c.prototype.logout = function () { this.controller.dispatch({ type: "toggle-menu", payload: "none" }), this.userController.logout() }, c }(e.Class); t.AccountMenu = c });

define('loadcss!shared-components/shared-dropdown-popover', function () { });
define('shared-components/shared-dropdown-popover', ["require", "exports", "tslib", "dcgview", "jquery", "lib/i18n", "underscore", "loadcss!./shared-dropdown-popover"], function (require, o, n, t, e, i, r) { "use strict"; Object.defineProperty(o, "__esModule", { value: !0 }), o.DropdownPopover = void 0; var p = t.Components.If, s = function (o) { function s() { return null !== o && o.apply(this, arguments) || this } return n.__extends(s, o), s.prototype.init = function () { if (this.showDropdown = !1, !this.children || 1 !== this.children.length || "function" != typeof this.children[0]) throw new Error("<DropdownPopover> expects a single child that is a function") }, s.prototype.template = function () { var o = this; return t.createElement("div", { class: function () { var n; return (n = { "dcg-shared-dropdown-popover-container": !0 })[void 0 === o.props.class ? "" : o.props.class()] = void 0 !== o.props.class, n }, didMount: this.bindFn(this.didMountDropdown), didUnmount: this.bindFn(this.didUnmountDropdown) }, t.createElement("div", { role: t.const("link"), tabindex: t.const(0), "aria-label": this.bindFn(this.getTitle), "aria-expanded": this.bindFn(this.isDropdownOpen), class: function () { return { "anchor-container": !0, isOpen: o.isDropdownOpen() } }, onTap: function (n) { o.openedFromKeyboard = "keyboard" === n.device, o.setDropdownOpen(!o.isDropdownOpen()) } }, this.props.anchor()), t.createElement(p, { predicate: this.bindFn(this.isDropdownOpen) }, function () { return t.createElement("div", { class: function () { return { "dropdown-container": !0, "dropdown-pops-up": o.props.popUp && o.props.popUp(), "dropdown-pops-right": o.props.popRight && o.props.popRight() } }, style: function () { var n = o.props.rightPosition && o.props.rightPosition(); return n ? { right: n + "px" } : {} }, didMount: function (n) { o.props.dropdownDidMount && o.props.dropdownDidMount(n) } }, o.children[0]()) })) }, s.prototype.didMountDropdown = function (o) { var n = this; this.listenerId = r.uniqueId("dropdown-container"), e(document.body).on("dcg-tap." + this.listenerId, function (t) { if (t.target !== o && !e.contains(o, t.target)) if (n.isDropdownOpen()) { var i = e(o).find(".dropdown-container")[0]; if (e.contains(i, t.target)) return; var r = i.getBoundingClientRect(); if (void 0 !== t.clientX && void 0 !== t.clientY && t.clientX > r.left && t.clientX < r.right && t.clientY > r.top && t.clientY < r.bottom) return; n.setDropdownOpen(!1) } else; }), e(document).on("scroll." + this.listenerId, function () { !n.openedFromKeyboard && n.isDropdownOpen() && n.setDropdownOpen(!1) }) }, s.prototype.didUnmountDropdown = function () { this.showDropdown = !1, e(document.body).off("." + this.listenerId), e(document).off("." + this.listenerId) }, s.prototype.getTitle = function () { return this.props.title ? this.props.title() : i.s("shared-button-more-options-menu") }, s.prototype.isDropdownOpen = function () { return this.props.controlled ? this.props.controlled().isOpen : this.showDropdown }, s.prototype.setDropdownOpen = function (o) { this.props.disabled && this.props.disabled() || (this.props.controlled ? this.props.controlled().setDropdownOpen(o) : (this.showDropdown = o, this.update())) }, s }(t.Class); o.DropdownPopover = s });

define('loadcss!shared-components/shared-options-dropdown', function () { });
define('shared-components/shared-options-dropdown', ["require", "exports", "tslib", "lib/i18n", "dcgview", "./shared-dropdown-popover", "loadcss!./shared-options-dropdown"], function (require, n, t, e, o, r) { "use strict"; Object.defineProperty(n, "__esModule", { value: !0 }), n.OptionsDropdown = n.OptionsDropdownList = void 0; var i = o.Components, s = i.For, c = i.If, a = i.IfDefined, p = i.Switch, l = function (n) { function r() { return null !== n && n.apply(this, arguments) || this } return t.__extends(r, n), r.prototype.template = function () { var n = this; return o.createElement(s, { each: this.props.options, key: function (n) { return (n.key ? n.key : n.title()) + (n.disabled ? "-disabled" : "") } }, o.createElement("div", { role: o.const("list"), class: function () { var t; return (t = { "dcg-shared-options-dropdown": !0 })[void 0 === n.props.class ? "" : n.props.class()] = void 0 !== n.props.class, t } }, function (t) { return o.createElement("div", { role: o.const("listitem"), class: o.const("dropdown-option-container") }, o.createElement(p, { key: function () { return t } }, function (t) { return "href" in t ? o.createElement("a", { "aria-disabled": function () { return t.disabled }, class: function () { var n; return (n = {})[t.class || ""] = !!t.class, n["dropdown-choice"] = !0, n["dropdown-choice-disabled"] = t.disabled, n }, onTap: function () { return !t.disabled && n.props.onTap(t) }, href: function () { return t.href }, target: function () { return void 0 !== t.target ? t.target : "" }, rel: function () { return t.noreferrer ? "noreferrer noopener" : "" } }, o.createElement(c, { predicate: function () { return null != t.icon } }, function () { return o.createElement("div", { class: o.const("option-icon-container") }, o.createElement("i", { "aria-hidden": o.const("true"), class: function () { return t.icon + " option-icon" } })) }), t.title) : o.createElement("div", { role: o.const("link"), tabindex: o.const(0), "aria-disabled": function () { return t.disabled }, class: function () { var n; return (n = {})[t.class || ""] = !!t.class, n["dropdown-choice"] = !0, n["dropdown-choice-disabled"] = t.disabled, n }, onTap: function () { return !t.disabled && n.props.onTap(t) } }, o.createElement(c, { predicate: function () { return null != t.icon } }, function () { return o.createElement("div", { class: o.const("option-icon-container") }, o.createElement("i", { "aria-hidden": o.const("true"), class: function () { return t.icon + " option-icon" } })) }), o.createElement("span", { class: o.const("option-title") }, t.title), a(function () { return t.subtitle && t.subtitle() }, function (n) { return o.createElement("span", { class: o.const("option-subtitle") }, n) })) }), o.createElement(c, { predicate: function () { return !!t.explanations } }, function () { return o.createElement(s, { each: function () { return t.explanations || [] }, key: function (n) { return n.flag } }, o.createElement("div", { class: o.const("dropdown-explanations") }, function (n) { return o.createElement("div", { class: o.const("explanation") }, function () { return n.explanation }, o.const(" "), o.createElement(c, { predicate: function () { return !!n.link } }, function () { return o.createElement("a", { class: o.const("learn-more"), href: function () { return void 0 !== n.link ? n.link : "" }, target: o.const("_blank") }, function () { return n.linkText ? n.linkText : e.s("shared-button-learn-more-capitalized") }) })) })) })) })) }, r }(o.Class); n.OptionsDropdownList = l; var d = function (n) { function e() { return null !== n && n.apply(this, arguments) || this } return t.__extends(e, n), e.prototype.init = function () { this.showDropdown = !1 }, e.prototype.template = function () { var n = this; return o.createElement(r.DropdownPopover, { dropdownDidMount: this.props.dropdownDidMount, anchor: this.props.anchor, class: this.props.class, controlled: this.props.controlled || function () { return { isOpen: n.showDropdown, setDropdownOpen: n.bindFn(n.setDropdownOpen) } }, title: this.props.title, disabled: this.props.disabled }, function () { return o.createElement(l, t.__assign({}, n.props, { onTap: n.bindFn(n.tapOption) })) }) }, e.prototype.tapOption = function (n) { var t = this; void 0 !== n.action && n.action(), n.preventClose || ("href" in n ? n.isDeepLink && setTimeout(function () { return t.setDropdownOpen(!1) }, 0) : this.setDropdownOpen(!1)) }, e.prototype.setDropdownOpen = function (n) { this.props.controlled ? this.props.controlled().setDropdownOpen(n) : (this.showDropdown = n, this.update()) }, e }(o.Class); n.OptionsDropdown = d });

define('loadcss!calculator-shell/graph-actions-menu', function () { });
define('calculator-shell/graph-actions-menu', ["require", "exports", "tslib", "dcgview", "./menu", "../shared-components/shared-options-dropdown", "jquery", "loadcss!./graph-actions-menu"], function (require, t, o, e, n, r, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.GraphActionsMenu = void 0; var s = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return o.__extends(s, t), s.prototype.template = function () { var t = this; return e.createElement(n.Menu, { type: this.const("graph-actions"), label: function () { return t.props.controller().s("account-shell-label-graph-actions") }, controller: this.props.controller, left: function () { return t.left }, arrowLeft: function () { return t.arrowLeft } }, e.createElement(r.OptionsDropdownList, { class: this.const("dcg-graph-actions-list"), options: this.bindFn(this.getOptions), onTap: this.bindFn(this.tapOption) })) }, s.prototype.didMount = function () { var t, o, e, n, r = i(".dcg-graph-actions-dropdown-anchor"), s = (null !== (o = null === (t = r.offset()) || void 0 === t ? void 0 : t.left) && void 0 !== o ? o : 0) + (null !== (e = r.width()) && void 0 !== e ? e : 0) / 2, c = (null !== (n = i(".dcg-graph-actions-container").width()) && void 0 !== n ? n : 0) - 14 - 10; s <= c + 4 ? (this.left = "4px", this.arrowLeft = s - 4 + "px") : (this.left = s - c + "px", this.arrowLeft = c + "px"), this.update() }, s.prototype.getOptions = function () { var t = this, o = []; return o.push({ title: function () { return t.props.controller().s("account-shell-button-rename") }, icon: "dcg-icon-pencil", class: "blue-link", action: function () { t.props.controller().dispatch({ type: "show-modal", modal: "rename", device: "mouse" }) } }), this.props.controller().graphsController.wasCurrentGraphEverSaved() && o.push({ title: function () { return t.props.controller().s("account-shell-button-duplicate") }, icon: "dcg-icon-duplicate", action: function () { return t.props.controller().dispatch({ type: "show-modal", modal: "duplicate", device: "mouse" }) } }, { title: function () { return t.props.controller().s("account-shell-button-delete") }, icon: "dcg-icon-remove", class: "red-link", action: function () { t.props.controller().dispatch({ type: "show-modal", modal: "delete", device: "mouse" }) } }), o }, s.prototype.tapOption = function (t) { var o = this; void 0 !== t.action && t.action(), t.preventClose || ("href" in t ? t.isDeepLink && setTimeout(function () { return o.closeMenu() }) : this.closeMenu()) }, s.prototype.closeMenu = function () { this.props.controller().dispatch({ type: "toggle-menu", payload: "graph-actions" }) }, s }(e.Class); t.GraphActionsMenu = s });
define('calculator-shell/wrapper', ["require", "exports", "tslib", "dcgview", "./view", "./language-menu", "./help-menu", "./share-menu", "./account-menu", "./graph-actions-menu"], function (require, e, n, r, t, o, l, c, u, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.ViewWrapper = void 0; var i = r.Components.SwitchUnion, a = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return n.__extends(a, e), a.prototype.init = function () { this.controller = this.props.controller() }, a.prototype.template = function () { var e = this; return r.createElement("div", null, r.createElement(t.HeaderBar, { controller: this.props.controller }), i(function () { return e.getMenu() }, { language: function () { return r.createElement(o.LanguageMenu, { controller: e.props.controller }) }, help: function () { return r.createElement(l.HelpMenu, { controller: e.props.controller }) }, share: function () { return r.createElement(c.ShareMenu, { controller: e.props.controller }) }, account: function () { return r.createElement(u.AccountMenu, { controller: e.props.controller }) }, "graph-actions": function () { return r.createElement(p.GraphActionsMenu, { controller: e.props.controller }) }, none: function () { return r.createElement("span", null) } })) }, a.prototype.getMenu = function () { return this.controller.mygraphsController.isMygraphsOpen() ? "none" : this.controller.getOpenMenu() }, a }(r.Class); e.ViewWrapper = a });
define('calculator-shell/modal', ["require", "exports", "tslib", "dcgview"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Modal = void 0; var o = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement("div", { class: function () { return { modal_section: !0, "dcg-hotkeys-dialog": "hotkeys" === e.props.controller().getOpenModal() } } }, this.children) }, o }(n.Class); e.Modal = o });
define('calculator-shell/save-dialog', ["require", "exports", "tslib", "dcgview", "./modal", "jquery"], function (require, t, e, n, l, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SaveDialog = void 0; var o = n.Components, a = o.Input, i = o.Checkbox, c = o.If, s = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return e.__extends(o, t), o.prototype.init = function () { this.controller = this.props.controller(), this.graphsController = this.controller.graphsController, this.lastSavedTitle = this.graphsController.getCurrentGraphTitle(), "duplicate" === this.controller.getOpenModal() ? this.newSaveTitle = this.controller.s("account-shell-text-copy-of-title", { originalTitle: this.lastSavedTitle }) : this.newSaveTitle = this.lastSavedTitle || this.graphsController.getUntitledString(), null == this.controller.state.saveDialog && (this.controller.state.saveDialog = { copyOnSave: !0 }) }, o.prototype.template = function () { var t = this; return n.createElement(l.Modal, { controller: this.props.controller }, n.createElement("div", { id: n.const("save-dialog") }, n.createElement("h1", null, function () { return t.getTitle() }), n.createElement("div", { class: n.const("dcg-clear") }), n.createElement("form", { didMount: this.didMountForm.bind(this) }, n.createElement("label", { class: n.const("input-label") }, n.createElement("div", { class: n.const("graph-title-title") }, function () { return t.controller.s("account-shell-label-graph-title") }, n.const("Â ")), n.createElement(a, { class: n.const("title-input dcg-input-blue-outline"), name: n.const("title"), placeholder: function () { return t.graphsController.getUntitledString() }, value: function () { return t.newSaveTitle }, maxlength: n.const("140"), onInput: function (e) { return t.newSaveTitle = e }, didMount: function (t) { return r(t).trigger("focus").trigger("select") } })), n.createElement("div", null, n.createElement("button", { type: n.const("submit"), class: n.const("dcg-btn dcg-btn-primary pull-right dcg-action-save") }, function () { return t.controller.s("account-shell-button-save") }), n.createElement(c, { predicate: function () { return t.shouldShowDuplicateOption() && t.graphsController.wasCurrentGraphEverSaved() } }, function () { return n.createElement("label", { class: n.const("dcg-new-copy pull-right") }, n.createElement(i, { checked: function () { return t.controller.state.saveDialog.copyOnSave }, onChange: function (e) { if (t.controller.state.saveDialog.copyOnSave = e, !t.unmounted) return t.update() } }), n.createElement("span", { class: n.const("duplicate-label") }, function () { return t.getDuplicateLabel() })) }))))) }, o.prototype.didUnmount = function () { this.unmounted = !0 }, o.prototype.didMountForm = function (t) { var e = this; r(t).on("submit", function (t) { var n; t.preventDefault(), "" === e.newSaveTitle && (e.newSaveTitle = "Untitled Graph"), n = e.shouldShowDuplicateOption() ? e.controller.state.saveDialog.copyOnSave : "rename" !== e.controller.getOpenModal(), e.controller.dispatch({ type: "save-graph", payload: { title: e.newSaveTitle, saveAs: n }, device: "mouse" }) }) }, o.prototype.getTitle = function () { if ("geometry" === this.controller.product) return this.controller.s("account-shell-heading-save-construction"); switch (this.controller.getOpenModal()) { case "rename": return this.controller.s("account-shell-heading-rename-graph"); case "save": return this.controller.s("account-shell-heading-save-graph"); case "duplicate": return this.controller.s("account-shell-heading-duplicate-graph"); default: return "" } }, o.prototype.getDuplicateLabel = function () { return "geometry" === this.controller.product ? this.controller.s("account-shell-heading-duplicate-construction") : this.controller.s("account-shell-heading-duplicate-graph") }, o.prototype.shouldShowDuplicateOption = function () { if ("geometry" === this.controller.product) return !0; var t = this.controller.getModalState(); return !("save" !== t.modal || !t.fromSaveInProgress) }, o }(n.Class); t.SaveDialog = s });
define('lib/evt-delegator', ["require", "exports", "jquery", "underscore"], function (require, e, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Delegator = void 0; var t = function () { function e() { var e = this; this.handlers = [], n(document).on("keydown.delegator", function (n) { return e.handleEvent(n) }) } return e.prototype.push = function (e) { var n = this, t = r.uniqueId("delegator_"); return this.handlers.push({ token: t, handler: e }), function () { return n.handlers = r.filter(n.handlers, function (e) { return e.token != t }) } }, e.prototype.handleEvent = function (e) { if (!e.isDefaultPrevented() && this.handlers.length) for (var n = !1, r = function () { return n = !0 }, t = 0, o = this.handlers.slice().reverse(); t < o.length; t++) { if ((0, o[t].handler)(e, r), n) return } }, e }(); e.Delegator = new t });
define('lib/restrict-focus', ["require", "exports", "keys", "jquery"], function (require, e, t, r) { "use strict"; function i(e) { return e.find(':input:enabled, [tabindex="0"], a[href]').filter(":visible:not([aria-hidden=true]):not([aria-disabled=true])") } Object.defineProperty(e, "__esModule", { value: !0 }), e.createRestrictFocusHandler = e.getFocusableElements = void 0, e.getFocusableElements = i, e.createRestrictFocusHandler = function (e) { return function (n) { if (t.lookup(n) == t.TAB) { var u = i(r(e)); if (0 === u.length) return; var s = u.first(), o = u.last(); n.shiftKey && s.is(":focus") ? (n.preventDefault(), o.trigger("focus")) : (!n.shiftKey && o.is(":focus") || document.activeElement && !u.is(":focus")) && (n.preventDefault(), s.trigger("focus")) } } } });

define('loadcss!shared-components/modal', function () { });

define('loadcss!shared-components/dcg-shared-icons', function () { });
define('shared-components/modal', ["require", "exports", "tslib", "dcgview", "jquery", "keys", "lib/evt-delegator", "lib/restrict-focus", "./tooltip", "loadcss!./modal", "loadcss!./dcg-shared-icons"], function (require, e, t, s, o, n, r, i, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Modal = void 0; var l = s.Components.If, a = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.init = function () { this.i18n = this.props.i18n(), this.isMounted = !1 }, a.prototype.template = function () { var e = this; return s.createElement("div", { class: function () { var t; return (t = { "dcg-shared-modal-container": !0 })[e.props.class ? e.props.class() : ""] = !!e.props.class, t }, didMount: this.bindFn(this.didMount), didUnmount: this.bindFn(this.didUnmount) }, s.createElement("div", { class: function () { return { "dcg-shared-modal-cover": !0, "dcg-shared-has-close-button": e.showX(), "dcg-shared-modal-fullscreen": "fullscreen" === e.props.size(), "dcg-shared-modal-wide": "wide" === e.props.size(), "dcg-shared-modal-medium": "medium" === e.props.size(), "dcg-shared-modal-narrow": "narrow" === e.props.size() } } }, s.createElement("div", { class: s.const("dcg-shared-modal-background"), onTap: this.props.onClose }), s.createElement("div", { class: s.const("dcg-shared-modal-transition-container") }, s.createElement("div", { class: s.const("dcg-shared-modal"), role: s.const("dialog"), "aria-label": function () { var t = ""; return e.props.ariaLabel ? t = e.props.ariaLabel() : e.props.title && (t = e.props.title()), t } }, s.createElement(l, { predicate: function () { return e.showX() } }, function () { return s.createElement("div", { class: s.const("dcg-shared-close-cross-container") }, s.createElement(c.Tooltip, { tooltip: function () { return e.i18n.s("shared-button-close-dialog") } }, s.createElement("div", { role: s.const("link"), tabindex: s.const("0"), "aria-label": function () { return e.i18n.s("shared-button-close-dialog") }, class: s.const("dcg-shared-close-cross"), onTap: e.props.onClose }, s.createElement("i", { class: s.const("dcg-shared-icon-remove"), "aria-hidden": s.const("true") })))) }), s.createElement("div", { class: s.const("dcg-shared-modal-contents-wrapper") }, s.createElement(l, { predicate: function () { return !!e.props.title && !!e.props.title() } }, function () { return s.createElement("h1", { class: function () { return { "dcg-shared-modal-title": !0, "dcg-shared-left-align-title": e.leftAlignTitle() } } }, function () { return e.props.title() }) }), s.createElement("div", { class: s.const("dcg-shared-modal-scrollable-content") }, this.children)))))) }, a.prototype.showX = function () { return !!this.props.showX && this.props.showX() }, a.prototype.leftAlignTitle = function () { return !!this.props.leftAlignTitle && this.props.leftAlignTitle() }, a.prototype.didMount = function () { var e = this; if (!this.isMounted) { this.isMounted = !0; var t = i.createRestrictFocusHandler(".dcg-shared-modal-container:visible"); this.unsub = r.Delegator.push(function (s, o) { n.lookup(s) == n.ESCAPE && (e.onClose(), o()), t(s) }) } }, a.prototype.didUpdate = function () { !this.handledCloseFocus && this.showX() && this.props.focusCloseLink && this.props.focusCloseLink() && o(".dcg-shared-modal-container:visible").find(".dcg-shared-close-cross").trigger("focus"), this.handledCloseFocus = !0 }, a.prototype.onClose = function () { this.props.onClose && this.props.onClose() }, a.prototype.didUnmount = function () { this.isMounted && (this.isMounted = !1, this.unsub()) }, a }(s.Class); e.Modal = a });
define('shared-components/shared-cookie-notice', ["require", "exports", "tslib", "dcgview", "shared/dcgviews/localize"], function (require, e, t, s, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var n = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return t.__extends(n, e), n.prototype.template = function () { return s.createElement("div", { class: s.const("dcg-shared-cookie-notice") }, s.createElement(o.Localize, { key: this.const("shared-message-cookie-notice"), i18n: this.props.i18n }, s.createElement("b", null, s.const("Note:")), s.const(" "), s.const("Desmos uses cookies to enable persistence when you are signed"), s.const(" "), s.const("in. If you do not wish to use cookies, please use Desmos without"), s.const(" "), s.const("logging in."), s.const(" "), s.createElement("a", { class: s.const("dcg-shared-cookie-notice-learn-more dcg-shared-blue-link"), href: s.const("/privacy"), target: s.const("_blank") }, s.const("Learn More.")))) }, n }(s.Class); e.default = n });

define('loadcss!shared-components/shared-checkbox', function () { });
define('shared-components/shared-checkbox', ["require", "exports", "tslib", "dcgview", "jquery", "loadcss!./shared-checkbox", "loadcss!./dcg-shared-icons"], function (require, e, s, r, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedCheckbox = void 0; var a = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return s.__extends(a, e), a.prototype.template = function () { var e = this; return r.createElement("div", { class: function () { return { "dcg-shared-component-checkbox": !0, "dcg-shared-checked": e.props.checked(), "dcg-shared-disabled": e.props.disabled && e.props.disabled(), "dcg-shared-small": e.props.small && e.props.small(), "dcg-shared-green": e.props.green && e.props.green() } }, onTap: this.bindFn(this.onChange) }, r.createElement("span", { tabindex: r.const(0), class: r.const("dcg-shared-checkbox"), role: r.const("checkbox"), "aria-label": this.props.ariaLabel, "aria-disabled": function () { return e.props.disabled && e.props.disabled() }, "aria-checked": this.props.checked }, r.createElement("i", { class: r.const("dcg-shared-icon-check"), "aria-hidden": r.const("true") })), r.createElement("span", { class: r.const("dcg-shared-checkbox-children") }, this.children)) }, a.prototype.onChange = function (e) { e.target && c(e.target).attr("href") || this.props.disabled && this.props.disabled() || this.props.onChange(!this.props.checked()) }, a }(r.Class); e.SharedCheckbox = a });

define('loadcss!shared-components/shared-account-modal-errors', function () { });
define('shared-components/shared-account-modal-errors', ["require", "exports", "tslib", "dcgview", "loadcss!./shared-account-modal-errors"], function (require, e, r, t) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedAccountModalErrors = void 0; var n = t.Components, o = n.If, c = n.For, s = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return r.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller }, n.prototype.template = function () { var e = this; return t.createElement(o, { predicate: function () { return !!e.props.errors().length } }, function () { return t.createElement(c, { each: e.props.errors }, t.createElement("span", null, function (r) { return t.createElement("div", { class: t.const("dcg-shared-account-modal-errors"), role: t.const("alert") }, t.createElement("span", null, function () { return e.i18n.raw(r) })) })) }) }, n }(t.Class); e.SharedAccountModalErrors = s });

define('loadcss!shared-components/shared-account-modal', function () { });

define('loadcss!shared-components/shared-signup-modal', function () { });
define('shared-components/shared-signup-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "jquery", "underscore", "shared/dcgviews/localize", "./shared-cookie-notice", "./shared-checkbox", "./shared-account-modal-errors", "loadcss!./shared-account-modal", "loadcss!./shared-signup-modal"], function (require, e, t, n, r, o, i, s, a, c, l) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedSignupModal = void 0; var d = n.Components, u = d.If, h = d.Input, p = d.Switch, m = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller }, r.prototype.template = function () { var e = this; return n.createElement(u, { predicate: this.bindFn(this.canChangeRole) }, function () { return n.createElement("span", { class: n.const("dcg-shared-dark-gray-link"), role: n.const("link"), tabindex: n.const("0"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: e.props.teacher() ? "signup" : "teacher-signup", device: t.device }) } }, function () { return e.props.teacher() ? e.i18n.s("shared-button-i-am-not-a-teacher") : e.i18n.s("shared-button-sign-up-as-a-teacher") }) }) }, r.prototype.canChangeRole = function () { return !this.controller.getLimitedSignupRole() }, r }(n.Class), g = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { return n.createElement("span", { class: n.const("dcg-shared-terms-notice") }, n.createElement(s.Localize, { key: this.const("shared-message-privacy-notice"), i18n: this.props.i18n }, n.const("I have read, understand, and accept the"), n.const(" "), n.createElement("a", { href: n.const("/terms"), target: n.const("_blank"), class: n.const("dcg-shared-blue-link") }, n.const("Terms of Service")), n.const(" "), n.const("and"), n.const(" "), n.createElement("a", { href: n.const("/privacy"), target: n.const("_blank"), class: n.const("dcg-shared-blue-link") }, n.const("Privacy Policy")), n.const("."))) }, r }(n.Class), f = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.selectedView = 0, this.givenName = "", this.familyName = "", this.email = "", this.password = "", this.consentChecked = !1, this.isSubmittingForm = !1, this.formErrors = [], this.breakPoint = 660, this.measureWindow(), this.controller.getModalStartingError() && this.formErrors.push(this.controller.getModalStartingError()) }, s.prototype.template = function () { var e = this; return n.createElement(r.Modal, { title: this.bindFn(this.getModalTitle), size: this.const("narrow"), showX: this.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, n.createElement("div", { class: function () { return { "dcg-shared-signup-dialog": !0, "dcg-shared-account-dialog": !0, "dcg-shared-teacher-signup-dialog": e.props.teacher() } } }, n.createElement("div", { class: n.const("dcg-shared-switch-account-message") }, function () { return e.i18n.s("shared-prompt-already-have-account") }, this.const(this.i18n.raw(" ")), n.createElement("a", { role: n.const("link"), tabindex: n.const("0"), class: n.const("dcg-shared-dark-gray-link"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "login", device: t.device }) } }, function () { return e.i18n.s("shared-button-login") }), n.const(".")), n.createElement("div", { class: n.const("dcg-shared-navigation-tabs"), role: n.const("tablist") }, n.createElement("div", { role: n.const("tab"), tabindex: n.const("0"), "aria-selected": this.bindFn(this.isGoogleSelected), class: function () { return { "dcg-shared-tab-gray-underline": !0, "dcg-shared-tab-always-underline": !0, "dcg-shared-profile-view-button": !0, "dcg-selected": e.isGoogleSelected() } }, onTap: function () { return e.updateView(0) } }, this.bindFn(this.externalTitle)), n.createElement("div", { role: n.const("tab"), tabindex: n.const("0"), "aria-selected": this.bindFn(this.isDesmosSelected), class: function () { return { "dcg-shared-tab-gray-underline": !0, "dcg-shared-tab-always-underline": !0, "dcg-shared-password-view-button": !0, "dcg-selected": e.isDesmosSelected() } }, onTap: function () { return e.updateView(1) } }, this.bindFn(this.desmosTitle))), n.createElement("div", { class: n.const("dcg-shared-account-content-container") }, n.createElement(p, { key: function () { return e.selectedView } }, function (t) { return 0 === t ? n.createElement("div", { class: n.const("dcg-shared-notice-checkbox-google") }, n.createElement(c.SharedCheckbox, { ariaLabel: e.bindFn(e.consentText), checked: function () { return e.consentChecked }, disabled: e.const(!1), onChange: function () { if (e.consentChecked = !e.consentChecked, !e.unmounted) return e.update() } }, e.bindFn(e.consentText)), n.createElement(c.SharedCheckbox, { ariaLabel: function () { return e.i18n.s("shared-narration-privacy-policy-agreement") }, checked: function () { return e.privacyChecked }, disabled: e.const(!1), onChange: function () { if (e.privacyChecked = !e.privacyChecked, !e.unmounted) return e.update() } }, n.createElement(g, { i18n: e.const(e.i18n) })), n.createElement(u, { predicate: function () { return window.googleAuthConnectionFailed } }, function () { return n.createElement("div", { class: n.const("dcg-shared-google-auth-unavailable") }, function () { return e.i18n.s("shared-message-google-login-not-available") }) }), n.createElement(u, { predicate: function () { return !window.googleAuthConnectionFailed } }, function () { return n.createElement("div", { class: function () { return { "dcg-shared-btn-gray-outline": !0, "dcg-shared-google-login": !0, "dcg-disabled": e.hasNotConsented() } }, role: n.const("button"), tabindex: function () { return e.hasNotConsented() ? "-1" : "0" }, "aria-disabled": e.bindFn(e.hasNotConsented), onTap: function () { return e.googleLogin() } }, n.createElement("div", { class: n.const("dcg-shared-google-icon dcg-shared-external-login-logo") }), n.createElement("span", null, e.bindFn(e.getGoogleLoginText))) }), n.createElement(u, { predicate: function () { return e.controller.allowSignInWithApple() } }, function () { return n.createElement("div", { class: function () { return { "dcg-shared-btn-gray-outline": !0, "dcg-shared-apple-login": !0, "dcg-disabled": e.hasNotConsented() } }, role: n.const("button"), tabindex: function () { return e.hasNotConsented() ? "-1" : "0" }, "aria-disabled": e.bindFn(e.hasNotConsented), onTap: function () { return e.appleLogin() } }, n.createElement("div", { class: n.const("dcg-shared-apple-icon dcg-shared-external-login-logo") }), n.createElement("span", null, e.bindFn(e.getAppleLoginText))) }), n.createElement("div", { class: n.const("dcg-shared-switch-account-type") }, n.createElement(m, { controller: e.props.controller, teacher: e.props.teacher }))) : 1 === t ? n.createElement("div", null, n.createElement(l.SharedAccountModalErrors, { controller: e.props.controller, errors: function () { return e.formErrors } }), n.createElement("form", { class: n.const("dcg-shared-action-submit"), onSubmit: e.bindFn(e.onSubmit), didMount: e.bindFn(e.didMountForm) }, n.createElement("div", { class: n.const("dcg-shared-email-form-container") }, n.createElement("label", null, n.createElement("span", { class: n.const("dcg-shared-input-title") }, function () { return e.i18n.s("shared-label-email") }), n.createElement(h, { type: n.const("email"), name: n.const("email"), class: n.const("dcg-shared-input-blue-outline"), required: n.const("required"), "aria-describedby": n.const("email-description"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, value: function () { return e.email }, onInput: function (t) { if (e.email = t, !e.unmounted) return e.update() } })), n.createElement("div", { class: n.const("dcg-shared-name-container") }, n.createElement("div", { class: n.const("dcg-shared-name-input") }, n.createElement("label", null, n.createElement("span", { class: n.const("dcg-shared-input-title") }, function () { return e.i18n.s("shared-label-given-name-or-nickname") }), n.createElement(h, { type: n.const("text"), name: n.const("given-name"), class: n.const("dcg-shared-input-blue-outline"), required: n.const("required"), "aria-describedby": n.const("given-name-description"), didMount: function (t) { if (e.controller.wasModalOpenedWithKeyboard()) return t.focus() }, value: function () { return e.givenName }, onInput: function (t) { if (e.givenName = t, !e.unmounted) return e.update() } }))), n.createElement("div", { class: n.const("dcg-shared-name-input") }, n.createElement("label", null, n.createElement("span", { class: n.const("dcg-shared-input-title") }, function () { return e.i18n.s("shared-label-family-name") }), n.createElement(h, { type: n.const("text"), name: n.const("family-name"), class: n.const("dcg-shared-input-blue-outline"), "aria-describedby": n.const("family-name-description"), value: function () { return e.familyName }, onInput: function (t) { if (e.familyName = t, !e.unmounted) return e.update() } })))), n.createElement("label", null, n.createElement("span", null, function () { return e.i18n.s("shared-label-password") }), n.createElement(h, { type: n.const("password"), class: n.const("dcg-shared-input-blue-outline"), name: n.const("password"), required: n.const("required"), value: function () { return e.password }, onInput: function (t) { if (e.password = t, !e.unmounted) return e.update() } })), n.createElement("div", { class: n.const("dcg-shared-notice-checkbox-email") }, n.createElement(c.SharedCheckbox, { ariaLabel: e.bindFn(e.consentText), checked: function () { return e.consentChecked }, disabled: e.const(!1), onChange: function () { if (e.consentChecked = !e.consentChecked, !e.unmounted) return e.update() } }, e.bindFn(e.consentText))), n.createElement(c.SharedCheckbox, { ariaLabel: function () { return e.i18n.s("shared-narration-privacy-policy-agreement") }, checked: function () { return e.privacyChecked }, disabled: e.const(!1), onChange: function () { if (e.privacyChecked = !e.privacyChecked, !e.unmounted) return e.update() } }, n.createElement(g, { i18n: e.const(e.i18n) })), n.createElement("div", { class: n.const("dcg-shared-sign-in-options") }, n.createElement(u, { predicate: function () { return e.isSubmittingForm } }, function () { return n.createElement("div", { class: n.const("dcg-shared-progress-indicator dcg-shared-create-account-progress") }, n.createElement("div", { class: n.const("dcg-shared-spinner") })) }), n.createElement(u, { predicate: function () { return !e.isSubmittingForm } }, function () { return n.createElement("div", { class: n.const("dcg-shared-submit-container") }, n.createElement(m, { controller: e.props.controller, teacher: e.props.teacher }), n.createElement("button", { type: n.const("submit"), class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": !e.submitEnabled() } }, "aria-disabled": function () { return !e.submitEnabled() }, tabindex: function () { return e.submitEnabled() ? "0" : "-1" } }, function () { return e.i18n.s("shared-button-create-account") })) }))))) : n.createElement("span", null) }), n.createElement(a.default, { i18n: this.const(this.i18n) })))) }, s.prototype.canSwitchRoles = function () { return !this.controller.getLimitedSignupRole() }, s.prototype.getModalTitle = function () { return this.props.teacher() ? this.i18n.s("shared-title-teacher-signup") : this.i18n.s("shared-title-signup") }, s.prototype.didMountForm = function (e) { this.$form = o(e) }, s.prototype.submitEnabled = function () { if (!this.consentChecked || !this.privacyChecked) return !1; if (!this.$form) return !1; var e = this.$form.find('[name="password"]').val(), t = this.$form.find('[name="email"]').val(), n = this.$form.find('[name="given-name"]').val(); return !!(e && t && n) }, s.prototype.onSubmit = function (e) { e.preventDefault(), this.submitEnabled() && this.submitForm() }, s.prototype.googleLogin = function () { this.controller.dispatch({ type: "close-modal" }), this.controller.userController.googleLogin({ fromUI: "create", teacher: this.props.teacher() }) }, s.prototype.appleLogin = function () { this.controller.dispatch({ type: "close-modal" }), this.controller.userController.appleLogin({ fromUI: "create", teacher: this.props.teacher() }) }, s.prototype.getGoogleLoginText = function () { return this.consentChecked && this.privacyChecked ? this.i18n.s("shared-prompt-sign-up-with-google") : this.i18n.s("shared-prompt-please-consent-to-sign-up-with-google") }, s.prototype.getAppleLoginText = function () { return this.consentChecked && this.privacyChecked ? this.i18n.s("shared-prompt-sign-up-with-apple") : this.i18n.s("shared-prompt-please-consent-to-sign-up-with-apple") }, s.prototype.submitForm = function () { var e = this; this.formErrors = [], this.isSubmittingForm = !0, this.unmounted || this.update(), this.controller.userController.createAccount({ userProvidedName: { given: this.givenName, family: this.familyName.length ? this.familyName : void 0 }, email: this.email, password: this.password, teacher: this.props.teacher(), lang: this.controller.getLanguage() }).done(function () { if (!e.unmounted) return e.controller.dispatch({ type: "close-modal" }) }).fail(function (t) { e.formErrors = e.controller.parseJSONErrors(t) }).always(function () { e.isSubmittingForm = !1, e.unmounted || e.update() }) }, s.prototype.updateView = function (e) { this.selectedView = e, this.unmounted || this.update() }, s.prototype.externalTitle = function () { return this.controller.allowSignInWithApple() ? this.windowWidth > this.breakPoint ? this.i18n.s("shared-button-external-account-wide") : this.i18n.s("shared-button-external-account-narrow") : this.windowWidth > this.breakPoint ? this.i18n.s("shared-button-google-account-wide") : this.i18n.s("shared-button-google-account-narrow") }, s.prototype.desmosTitle = function () { return this.windowWidth > this.breakPoint ? this.i18n.s("shared-button-email-address-wide") : this.i18n.s("shared-button-email-address-narrow") }, s.prototype.measureWindow = function () { return this.windowWidth = o(window).width() }, s.prototype.didMount = function () { var e = this; o(window).on("resize.create-account", i.throttle(function () { e.measureWindow(), e.update() }, 200)) }, s.prototype.didUnmount = function () { o(window).off("resize.create-account"), this.unmounted = !0 }, s.prototype.consentText = function () { return this.i18n.s("shared-message-consent-text") }, s.prototype.isGoogleSelected = function () { return 0 === this.selectedView }, s.prototype.isDesmosSelected = function () { return 1 === this.selectedView }, s.prototype.hasNotConsented = function () { return !this.consentChecked || !this.privacyChecked }, s }(n.Class); e.SharedSignupModal = f });

define('loadcss!shared-components/shared-login-modal', function () { });
define('shared-components/shared-login-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "./shared-cookie-notice", "shared/dcgviews/localize", "./shared-account-modal-errors", "loadcss!./shared-account-modal", "loadcss!./shared-login-modal"], function (require, e, t, n, o, r, s, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedLoginModal = void 0; var c = n.Components, i = c.If, l = c.Input, d = c.IfElse, u = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.email = "", this.password = "", this.isSubmittingForm = !1, this.formErrors = [], this.controller.getModalStartingError() && this.formErrors.push(this.controller.getModalStartingError()) }, c.prototype.template = function () { var e = this; return n.createElement(o.Modal, { title: function () { return e.i18n.s("shared-title-login") }, size: this.const("narrow"), showX: this.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, n.createElement("div", { class: n.const("dcg-shared-login-dialog dcg-shared-account-dialog") }, d(function () { return e.canChooseRole() }, { true: function () { return n.createElement("div", { class: n.const("dcg-shared-switch-account-message") }, n.createElement(s.Localize, { key: e.const("shared-prompt-new-to-desmos-teacher-or-student"), i18n: e.props.controller }, n.const("New to Desmos? Sign up as a"), n.const(" "), n.createElement("a", { role: n.const("link"), tabindex: n.const("0"), class: n.const("dcg-shared-dark-gray-link"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "teacher-signup", device: t.device }) } }, n.const("teacher")), n.const(" "), n.const("or"), n.const(" "), n.createElement("a", { role: n.const("link"), tabindex: n.const("0"), class: n.const("dcg-shared-dark-gray-link"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "signup", device: t.device }) } }, n.const("student.")))) }, false: function () { return n.createElement("div", { class: n.const("dcg-shared-switch-account-message") }, n.createElement(s.Localize, { key: e.const("shared-prompt-new-to-desmos-sign-up-here"), i18n: e.props.controller }, n.const("New to Desmos?"), n.const(" "), n.createElement("a", { role: n.const("link"), tabindex: n.const("0"), class: n.const("dcg-shared-dark-gray-link"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "teacher" === e.controller.getLimitedSignupRole() ? "teacher-signup" : "signup", device: t.device }) } }, n.const("Sign up")), n.const("."))) } }), n.createElement("div", { class: n.const("dcg-shared-account-content-container") }, n.createElement(i, { predicate: function () { return window.googleAuthConnectionFailed } }, function () { return n.createElement("div", { class: n.const("dcg-shared-google-auth-unavailable") }, function () { return e.i18n.s("shared-message-google-login-not-available") }) }), n.createElement(i, { predicate: function () { return !window.googleAuthConnectionFailed } }, function () { return n.createElement("div", { class: n.const("dcg-shared-btn-gray-outline dcg-shared-google-login"), role: n.const("button"), tabindex: n.const("0"), onTap: function () { return e.googleLogin() } }, n.createElement("div", { class: n.const("dcg-shared-google-icon dcg-shared-external-login-logo") }), n.createElement("span", null, function () { return e.i18n.s("shared-button-login-with-google") })) }), n.createElement(i, { predicate: function () { return e.controller.allowSignInWithApple() } }, function () { return n.createElement("div", { class: n.const("dcg-shared-btn-gray-outline dcg-shared-apple-login"), role: n.const("button"), tabindex: n.const("0"), onTap: function () { return e.appleLogin() } }, n.createElement("div", { class: n.const("dcg-shared-apple-icon dcg-shared-external-login-logo") }), n.createElement("span", null, function () { return e.i18n.s("shared-button-login-with-apple") })) })), n.createElement("div", { class: n.const("dcg-shared-bg-line") }, n.createElement("span", null, function () { return e.i18n.s("shared-message-or-login-with-desmos") })), n.createElement(a.SharedAccountModalErrors, { controller: this.props.controller, errors: function () { return e.formErrors } }), n.createElement("form", { class: n.const("dcg-shared-action-submit"), onSubmit: this.bindFn(this.onSubmit) }, n.createElement("div", { class: n.const("dcg-shared-email-form-container") }, n.createElement("label", null, n.createElement("span", { class: n.const("dcg-shared-input-title") }, function () { return e.i18n.s("shared-label-email") }), n.createElement(l, { type: n.const("email"), name: n.const("email"), class: n.const("dcg-shared-input-blue-outline"), "aria-label": function () { return e.i18n.s("shared-label-email") }, "aria-required": n.const("true"), required: n.const("required"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, value: function () { return e.email }, onInput: function (t) { e.email = t, e.unmounted || e.update() } })), n.createElement("div", { class: n.const("dcg-shared-password-container") }, n.createElement("label", { for: n.const("password") }, n.createElement("span", null, function () { return e.i18n.s("shared-label-password") }), n.createElement(l, { type: n.const("password"), class: n.const("dcg-shared-input-blue-outline"), "aria-label": function () { return e.i18n.s("shared-label-password") }, "aria-required": n.const("true"), required: n.const("required"), value: function () { return e.password }, name: this.const("password"), onInput: function (t) { if (e.password = t, !e.unmounted) return e.update() } }), n.createElement("span", { class: n.const("dcg-shared-password-recovery-link") }, n.createElement("a", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-shared-action-password"), onTap: function (t) { return e.controller.dispatch({ type: "show-modal", modal: "recover-password", device: t.device }) } }, function () { return e.i18n.s("shared-prompt-forgot-your-password") })))), n.createElement("div", { class: n.const("dcg-shared-sign-in-options") }, n.createElement(i, { predicate: function () { return e.isSubmittingForm } }, function () { return n.createElement("div", { class: n.const("dcg-shared-progress-indicator dcg-shared-create-account-progress") }, n.createElement("div", { class: n.const("dcg-shared-spinner") })) }), n.createElement(i, { predicate: function () { return !e.isSubmittingForm } }, function () { return n.createElement("div", { class: n.const("dcg-shared-submit-container") }, n.createElement("button", { type: n.const("submit"), class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": !e.submitEnabled() } }, "aria-disabled": function () { return !e.submitEnabled() }, tabindex: function () { return e.submitEnabled() ? "0" : "-1" } }, function () { return e.i18n.s("shared-button-login-capitalized") })) })), n.createElement(r.default, { i18n: this.const(this.i18n) }))))) }, c.prototype.canChooseRole = function () { return !this.controller.getLimitedSignupRole() }, c.prototype.didUnmount = function () { this.unmounted = !0 }, c.prototype.onSubmit = function (e) { e.preventDefault(), this.submitForm() }, c.prototype.googleLogin = function () { this.controller.dispatch({ type: "close-modal" }), this.controller.userController.googleLogin({ fromUI: "login" }) }, c.prototype.appleLogin = function () { this.controller.dispatch({ type: "close-modal" }), this.controller.userController.appleLogin({ fromUI: "login" }) }, c.prototype.submitEnabled = function () { return !(!this.email || !this.password) }, c.prototype.submitForm = function () { var e = this; this.submitEnabled() && (this.isSubmittingForm = !0, this.formErrors = [], this.controller.userController.checkPendingDeletion({ email: this.email, lang: this.controller.getLanguage() }).done(function (t) { e._pendingDeletion = t.pendingDeletion }).fail(function () { e._pendingDeletion = !1 }).always(function () { e.unmounted || (e.unmounted || e.update(), e.controller.userController.desmosLogin({ email: e.email, password: e.password, lang: e.controller.getLanguage() }).done(function () { e.unmounted || (e._pendingDeletion ? e.controller.dispatch({ type: "show-modal", modal: "account-reenabled", device: "mouse" }) : e.controller.dispatch({ type: "close-modal" })) }).fail(function (t) { e.formErrors = e.controller.parseJSONErrors(t) }).always(function () { e.unmounted || (e.isSubmittingForm = !1, e.controller.dispatch({ type: "render" })) })) })) }, c }(n.Class); e.SharedLoginModal = u });
define('shared-components/shared-recover-password-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "./shared-account-modal-errors", "loadcss!./shared-account-modal"], function (require, e, t, r, n, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedRecoverPasswordModal = void 0; var s = r.Components, i = s.If, c = s.Input, a = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.email = this.controller.userController.getEmail(), this.formErrors = [], this.isSubmittingForm = !1, this.didSendRecoveryEmail = !1 }, s.prototype.template = function () { var e = this; return r.createElement(n.Modal, { title: function () { return e.i18n.s("shared-title-recover-password") }, size: this.const("narrow"), showX: this.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, r.createElement("div", { class: r.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog") }, r.createElement(o.SharedAccountModalErrors, { controller: this.props.controller, errors: function () { return e.formErrors } }), r.createElement(i, { predicate: function () { return e.didSendRecoveryEmail } }, function () { return r.createElement("div", { role: r.const("alert"), class: r.const("dcg-shared-account-paragraph") }, function () { return e.i18n.s("shared-message-check-email-for-password-recovery-link") }, r.const(" "), r.createElement("a", { href: r.const("#"), class: r.const("dcg-shared-blue-link"), onTap: function (t) { return e.didSendRecoveryEmail = !1, e.controller.dispatch({ type: "show-modal", modal: "recover-password", device: t.device }) } }, function () { return e.i18n.s("shared-button-try-again") })) }), r.createElement(i, { predicate: function () { return !e.didSendRecoveryEmail } }, function () { return r.createElement("form", { class: r.const("dcg-shared-email-form-container"), onSubmit: e.bindFn(e.onSubmit) }, r.createElement("div", { class: r.const("dcg-shared-account-paragraph") }, function () { return e.i18n.s("shared-prompt-enter-email-for-password-recovery-link") }), r.createElement("label", null, r.createElement("span", { class: r.const("dcg-shared-input-title") }, function () { return e.i18n.s("shared-label-email") }), r.createElement(c, { type: r.const("email"), name: r.const("email"), class: r.const("dcg-shared-input-blue-outline"), "aria-label": function () { return e.i18n.s("shared-label-email") }, "aria-required": r.const("true"), required: r.const("required"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, value: function () { return e.email }, onInput: function (t) { e.email = t, e.unmounted || e.update() } })), r.createElement("div", { class: r.const("dcg-shared-sign-in-options") }, r.createElement(i, { predicate: function () { return e.isSubmittingForm } }, function () { return r.createElement("div", { class: r.const("dcg-shared-progress-indicator dcg-shared-create-account-progress") }, r.createElement("div", { class: r.const("dcg-shared-spinner") })) }), r.createElement(i, { predicate: function () { return !e.isSubmittingForm } }, function () { return r.createElement("button", { class: function () { return { "dcg-shared-btn-blue": !0 } }, type: r.const("submit") }, function () { return e.i18n.s("shared-button-recover-password") }) }))) }))) }, s.prototype.didUnmount = function () { this.unmounted = !0 }, s.prototype.onSubmit = function (e) { e.preventDefault(), this.submitForm() }, s.prototype.submitForm = function () { var e = this; this.formErrors = [], this.isSubmittingForm = !0, this.controller.userController.recoverPassword({ email: this.email, lang: this.controller.getLanguage() }).done(function () { e.didSendRecoveryEmail = !0 }).fail(function (t) { e.formErrors = e.controller.parseJSONErrors(t) }).always(function () { e.isSubmittingForm = !1, e.unmounted || e.update() }) }, s }(r.Class); e.SharedRecoverPasswordModal = a });

define('loadcss!calculator-shell/hotkeys-dialog', function () { });
define('calculator-shell/hotkeys-dialog', ["require", "exports", "tslib", "dcgview", "./modal", "browser", "dcgview-helpers/static-mathquill-view", "jquery", "loadcss!./hotkeys-dialog"], function (require, c, e, t, n, s, o, a) { "use strict"; Object.defineProperty(c, "__esModule", { value: !0 }), c.HotkeysDialog = void 0; var r = t.Components.If, l = function (c) { function l() { return null !== c && c.apply(this, arguments) || this } return e.__extends(l, c), l.prototype.init = function () { this.controller = this.props.controller(), null == this.controller.state.hotkeysDialog && (this.controller.state.hotkeysDialog = { shortcutOS: s.IS_APPLE ? "mac" : "windows" }) }, l.prototype.template = function () { var c = this; return t.createElement(n.Modal, { controller: this.props.controller }, t.createElement("div", { id: t.const("dcg-hotkeys-dialog") }, t.createElement("h1", null, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts") }), t.createElement("div", { class: t.const("dcg-toggle-container") }, t.createElement("span", { class: function () { return { "dcg-action-toggleos": !0, "dcg-windows-option": !0, "dcg-selected": "windows" === c.getShortcutOS() } }, role: t.const("button"), tabindex: t.const(0), "aria-pressed": function () { return "windows" === c.getShortcutOS() }, onTap: function () { return c.setShortcutOS("windows") } }, function () { return c.controller.s("shared-calculator-button-windows-chrome") }), t.createElement("span", { class: function () { return { "dcg-action-toggleos": !0, "dcg-mac-option": !0, "dcg-selected": "mac" === c.getShortcutOS() } }, role: t.const("button"), tabindex: t.const(0), "aria-pressed": function () { return "mac" === c.getShortcutOS() }, onTap: function () { return c.setShortcutOS("mac") } }, function () { return c.controller.s("shared-calculator-button-mac") })), t.createElement("div", { class: t.const("dcg-hotkey-container") }, t.createElement("div", { class: t.const("dcg-hotkey-section") }, t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-common-actions") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, function () { return c.controller.s("shared-calculator-heading-mac-table-column-header") })), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-close-a-dialog") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Esc"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Esc")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-open-a-graph") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-save-a-graph") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S")))), t.createElement("tr", { class: t.const("hotkey-table-row") }, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-print-a-graph") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("P"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("P")))), t.createElement("tr", { class: t.const("hotkey-table-row") }, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-show-or-hide-expression-list") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("E"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("E")))), t.createElement("tr", { class: t.const("hotkey-table-row") }, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-focus-expression-list") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("E"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("E")))), t.createElement("tr", { class: t.const("hotkey-table-row") }, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-open-expression-options") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O")))), t.createElement("tr", { class: t.const("hotkey-table-row") }, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-delete-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("D"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("D")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-add-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("X"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("X")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-add-note") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-collapse-folder") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-expand-folder") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-collapse-all-folders") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-expand-all-folders") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-add-folder") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("F"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("F")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-add-image") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("I"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("I")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-add-table") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("T"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("T")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-undo") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Z"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Z")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-redo") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Z"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Z")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-edit-list-mode") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("D"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("OPTION")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("D")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-graph-settings-menu") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("G"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("G")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-account-menu") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("A"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("A")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-help-menu") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("H"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("H")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-language-menu") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-share-menu") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S"))))), t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-expression-entry-and-navigation") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, t.const("Mac Shortcut"))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-previous-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-next-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-remove-empty-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Backspace"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Delete")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-previous-character") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-next-character") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-move-to-numerator") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-move-to-denominator") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-exit-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-beginning-of-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Home"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-end-of-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("End"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-beginning-of-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Home"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-end-of-expression") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("End"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-selection-left") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-selection-right") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-delete-selection") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Backspace"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Delete")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-select-all") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("A"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("A")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-parent-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-focused-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-left-adjacent-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-right-adjacent-block") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-selection") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-answer") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("="))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement(r, { predicate: function () { return c.controller.isDecimalToFractionEnabled() } }, function () { return t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-show-answer-as-decimal-or-fraction") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("F"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("F")))) })), t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-graphs-with-interactive-points") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, t.const("Mac Shortcut"))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-focus-first-interactive-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("P"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("COMMAND")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("P")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-next-interactive-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-previous-interactive-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-x") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-decrease-x") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-y") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-decrease-y") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-x-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-decrease-x-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-y-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-decrease-y-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-x") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("X"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("X")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-y") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Y"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Y")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-label") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-color") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("C"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("C"))))), t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-braille") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, function () { return c.controller.s("shared-calculator-heading-mac-table-column-header") })), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-nemeth-mode") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("N"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("N")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-ueb-mode") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("U"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("U")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-print-mode") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Q"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Q")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-braille-typing") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("6"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("6")))))), t.createElement("div", { class: t.const("dcg-hotkey-section") }, t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-symbols") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, t.const("Mac Shortcut"))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("a^b") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("^")), function () { return "(" + c.controller.s("shared-calculator-text-keyboard-shortcut-usually") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("6")), t.const(")")), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("^")), function () { return "(" + c.controller.s("shared-calculator-text-keyboard-shortcut-usually") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("6")), t.const(")"))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("a_b") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("_")), function () { return "(" + c.controller.s("shared-calculator-text-keyboard-shortcut-usually") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("-")), t.const(")")), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("_")), function () { return "(" + c.controller.s("shared-calculator-text-keyboard-shortcut-usually") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("-")), t.const(")"))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\le") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("<")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("="))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("<")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("=")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\ge") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const(">")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("="))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const(">")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("=")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("a'") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("'"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("'")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\frac{a}{b}") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("f")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("a")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("c"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("f")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("a")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("c")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\sqrt{a}") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("s")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("q")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("s")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("q")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\sqrt[3]{a}") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("c")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("b")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("c")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("b")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\sqrt[n]{a}") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("n")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("h")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("o")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("o")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("n")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("h")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("o")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("o")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\sum_{n=a}^b") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("s")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("u")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("m"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("s")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("u")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("m")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\int_a^b") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("i")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("n")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("i")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("n")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\prod_{n=a}^b") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("p")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("o")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("d"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("p")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("r")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("o")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("d")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\pi") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("p")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("i"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("p")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("i")))), t.createElement("tr", null, t.createElement("td", null, t.createElement(o.default, { config: this.const({}), latex: this.const("\\theta") })), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("h")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("e")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("a"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("h")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("e")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("t")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("a")))), t.createElement("tr", null, t.createElement("td", null, this.const("â")), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("-")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const(">"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("-")), t.createElement("span", { class: t.const("dcg-key-command") }, t.const(">"))))), t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-audio-tracing") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, t.const("Mac Shortcut"))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-audio-trace") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("T"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("T")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-summarize-graph") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-previous-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("J"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("J")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-next-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-previous-poi") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Page Up")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("K"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("K")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-next-poi") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Page Down")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("I"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("I")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-first-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Home")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("U"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("U")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-last-point") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("End")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("N"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("N")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-poi-count") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("P"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("P")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-x") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("X"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("X")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-y") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Y"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Y")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-color") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("C"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("C")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-branch") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("B"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("B")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-speak-point-type") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("T"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("T")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-move-to-origin") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("O")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-previous-curve") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("OPTION")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-next-curve") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("OPTION")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-hear-graph") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("H"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("H")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-hear-specific-branch") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("1")), t.const("-"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("0"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("1")), t.const("-"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("0")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-adjust-playback-speed") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("ALT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("1")), t.const("-"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("5"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Option")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("1")), t.const("-"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("5")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-increase-volume") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("V"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("V")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-decrease-volume") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("V"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("V")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-announce-slider-animations") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("A"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("A")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-toggle-slider-trace") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("S")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-decrease") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("J"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("J")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-decrease-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Page Down"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-increase") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("L")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-increase-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Page Up"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-minimum") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Home")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("U"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("U")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-maximum") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("End")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("N"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")), t.const("or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("N")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-next-slider") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("K"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("K")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-trace-previous-slider") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("I"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")), t.const(","), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")), t.const(", or"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("I"))))), t.createElement("h2", { class: t.const("dcg-hotkey-section-header") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-sliders") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, t.const("Mac Shortcut"))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-decrease") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-decrease-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Page Down"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-increase") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-increase-larger") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Page Up"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-minimum") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Home"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-slider-maximum") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("End"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Fn")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))))), t.createElement("h2", { class: t.const("dcg-hotkey-section-header tables-section") }, function () { return c.controller.s("shared-calculator-heading-keyboard-shortcuts-tables") }), t.createElement("table", null, t.createElement("tr", null, t.createElement("th", null, function () { return c.controller.s("shared-calculator-heading-function-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-windows") }, function () { return c.controller.s("shared-calculator-heading-windows-chrome-table-column-header") }), t.createElement("th", { class: t.const("dcg-os-mac") }, t.const("Mac Shortcut"))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-previous-cell") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("SHIFT")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-next-cell") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Tab")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-previous-row") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-next-row") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-previous-column") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-next-column") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-first-row") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Up Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-last-row") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Down Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-first-column") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Left Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-last-column") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("Right Arrow")))), t.createElement("tr", null, t.createElement("td", null, function () { return c.controller.s("shared-calculator-text-keyboard-shortcut-table-speak-column-header") }), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-windows") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("H"))), t.createElement("td", { class: t.const("dcg-keyboard-shortcut dcg-os-mac") }, t.createElement("span", { class: t.const("dcg-key-command") }, t.const("CTRL")), t.const("+"), t.createElement("span", { class: t.const("dcg-key-command") }, t.const("H"))))))))) }, l.prototype.getShortcutOS = function () { return this.controller.state.hotkeysDialog.shortcutOS }, l.prototype.setShortcutOS = function (c) { this.controller.state.hotkeysDialog.shortcutOS = c, this.unmounted || this.update() }, l.prototype.didMount = function () { this.updateVisibleShortcuts() }, l.prototype.didUnmount = function () { this.unmounted = !0 }, l.prototype.didUpdate = function () { this.updateVisibleShortcuts() }, l.prototype.updateVisibleShortcuts = function () { var c = this.getShortcutOS(), e = a(".dcg-os-mac"), t = a(".dcg-os-windows"); "mac" === c ? (e.show(), t.hide()) : "windows" === c && (e.hide(), t.show()) }, l }(t.Class); c.HotkeysDialog = l });
define('calculator-shell/unsupported-browser', ["require", "exports", "tslib", "dcgview", "./modal"], function (require, e, t, n, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.UnsupportedBrowserDialog = void 0; var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.init = function () { this.controller = this.props.controller() }, r.prototype.template = function () { var e = this; return n.createElement(o.Modal, { controller: this.props.controller }, n.createElement("div", { id: n.const("unsupported-browser") }, n.createElement("div", { id: n.const("unsupported-browser-title"), style: n.const("color:black; font-size:150%;") }, function () { return e.controller.s("account-shell-heading-unsupported-browser") }), n.createElement("div", { style: n.const("padding:20px 0px; color:#666") }, function () { return e.controller.s("account-shell-text-unsupported-browser-android") }, n.createElement("br", null), n.createElement("br", null), n.createElement("a", { href: n.const("https://play.google.com/store/apps/details?id=com.android.chrome") }, function () { return e.controller.s("account-shell-link-download-chrome") }, n.createElement("br", null), n.createElement("br", null)), n.createElement("div", { style: n.const("text-align: center; margin-top: 25px; margin-bottom:-16px") }, n.createElement("a", { role: n.const("link"), tabindex: n.const("0"), class: n.const("dcg-btn dcg-action-hide dcg-do-not-blur"), onTap: function () { return e.controller.dispatch({ type: "close-modal" }) } }, function () { return e.controller.s("account-shell-button-hide-browser-warning") }))))) }, r }(n.Class); e.UnsupportedBrowserDialog = r });

define('loadcss!shared-components/shared-account-settings-modal', function () { });
define('shared-components/shared-delete-account', ["require", "exports", "tslib", "dcgview", "shared/dcgviews/localize", "./shared-account-modal-errors", "loadcss!./shared-account-settings-modal", "loadcss!shared-components/btn-styles"], function (require, e, t, n, o, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedDeleteAccount = void 0; var c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.formErrors = [] }, c.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-shared-delete-account dcg-shared-account-settings-section") }, n.createElement("h1", { class: n.const("dcg-shared-left-align-title") }, function () { return e.i18n.s("shared-title-delete-account") }), n.createElement("div", { class: n.const("dcg-shared-account-paragraph") }, n.createElement(o.Localize, { key: this.const("shared-message-delete-account-notice"), i18n: this.props.controller }, n.const("When you delete your account,"), n.const(" "), n.createElement("b", null, n.const("we will retain your data for 30 days.")), n.const(" "), n.const("You can reactivate your account at any time during those 30 days by logging back in."), n.const(" "), n.const("If there's something about Desmos we can improve, please"), n.const(" "), n.createElement("a", { href: n.const("mailto:support@desmos.com"), class: n.const("dcg-shared-blue-link") }, n.const("let us know.")))), n.createElement("div", { class: n.const("dcg-shared-account-paragraph") }, function () { return e.i18n.s("shared-message-delete-account-will-send-email", { email: e.i18n.raw(e.controller.userController.getEmail()) }) }), n.createElement("form", { onSubmit: this.bindFn(this.onSubmit) }, n.createElement(r.SharedAccountModalErrors, { controller: this.props.controller, errors: function () { return e.formErrors } }), n.createElement("div", { class: n.const("dcg-shared-modal-actions-container") }, n.createElement("div", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-shared-dark-gray-link"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, onTap: function () { return e.controller.logJSON("shared-delete-account", { action: "cancel-delete-account" }), e.props.hideForm() } }, function () { return e.i18n.s("shared-button-cancel") }), n.createElement("button", { class: function () { return { "dcg-shared-btn-red": !0, "dcg-disabled": e.disabled } }, "aria-disabled": function () { return e.disabled }, tabindex: function () { return e.disabled ? "-1" : "0" }, type: n.const("submit") }, function () { return e.i18n.s("shared-button-send-delete-account-email") })))) }, c.prototype.onAccountDeleted = function () { return this.props.submitForm() }, c.prototype.onAccountDeletionFailed = function () { if (this.formErrors = [this.controller.getSomethingWentWrongText()], !this.unmounted) return this.update() }, c.prototype.doDeleteAccount = function () { this.disabled || (this.controller.logJSON("shared-delete-account", { action: "send-delete-account-email" }), this.controller.userController.initiateAccountDeletion({ lang: this.controller.getLanguage() }).done(this.bindFn(this.onAccountDeleted)).fail(this.bindFn(this.onAccountDeletionFailed))) }, c.prototype.didUnmount = function () { return this.unmounted = !0 }, c.prototype.onSubmit = function (e) { e.preventDefault(), this.doDeleteAccount() }, c }(n.Class); e.SharedDeleteAccount = c });
define('shared-components/shared-email-settings', ["require", "exports", "tslib", "dcgview", "./shared-account-modal-errors", "loadcss!./shared-account-settings-modal", "loadcss!shared-components/btn-styles"], function (require, e, t, n, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedEmailSettings = void 0; var r = n.Components.If, i = function (e) { function i() { return null !== e && e.apply(this, arguments) || this } return t.__extends(i, e), i.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.formStatus = 0, this.emailDisabled = null }, i.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-shared-email-field-container") }, n.createElement(r, { predicate: function () { return 0 === e.formStatus } }, function () { return n.createElement("div", { class: n.const("dcg-shared-email-field") }, n.createElement("div", { class: n.const("dcg-shared-profile-info-container") }, n.createElement("span", { class: n.const("dcg-shared-profile-info-title"), role: n.const("heading"), "aria-level": n.const("1") }, function () { return e.i18n.s("shared-title-email-settings") }), n.createElement("div", { class: n.const("dcg-shared-profile-info-content") }, function () { return e.i18n.raw(e.controller.userController.getEmail()) }, n.createElement("div", { class: n.const("dcg-shared-message-container") }, n.createElement("div", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-shared-blue-link"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, onTap: function () { return e.setFormStatus(1) } }, function () { return e.i18n.s("shared-button-change-email-address") }))))) }), n.createElement(r, { predicate: function () { return 1 === e.formStatus } }, function () { return n.createElement("div", { class: n.const("dcg-shared-change-email-container") }, n.createElement("div", { class: n.const("dcg-shared-change-email-description") }, function () { return e.i18n.s("shared-message-email-settings-will-send-email", { emailAddress: e.i18n.raw(e.controller.userController.getEmail()) }) }), n.createElement(s.SharedAccountModalErrors, { controller: e.props.controller, errors: function () { return e.formErrors } }), n.createElement("div", { class: n.const("dcg-shared-modal-actions-container") }, n.createElement("span", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-shared-dark-gray-link"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, onTap: function () { return e.setFormStatus(0) } }, function () { return e.i18n.s("shared-button-cancel") }), n.createElement("button", { class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": e.emailDisabled } }, "aria-disabled": function () { return e.disabled }, tabindex: function () { return e.disabled ? "-1" : "0" }, type: n.const("submit"), onTap: function () { return e.emailDisabled || e.sendChangeEmail() } }, function () { return e.i18n.s("shared-button-send-email") }))) }), n.createElement(r, { predicate: function () { return 3 === e.formStatus } }, function () { return n.createElement("div", { "aria-live": n.const("assertive"), "aria-atomic": n.const("true"), class: n.const("dcg-shared-confirmation-message-container") }, n.createElement("div", { class: n.const("dcg-shared-confirmation-message") }, n.createElement("i", { class: function () { return { "dcg-shared-icon-check": !0, "dcg-success-marker": !0 } }, "aria-hidden": n.const("true") }), function () { return e.i18n.s("shared-message-email-sent") }), n.createElement("div", null, function () { return e.i18n.s("shared-message-check-email-for-link", { emailAddress: e.i18n.raw(e.controller.userController.getEmail()) }) })) })) }, i.prototype.didUnmount = function () { this.unmounted = !0 }, i.prototype.setToast = function (e) { var t = this; this.toastMessage || (this.toastMessage = e, this.unmounted || this.update(), setTimeout(function () { t.toastMessage = null, t.unmounted || t.update() }, 5e3), 2 === this.formStatus && setTimeout(function () { t.setFormStatus(0), t.unmounted || t.update() }, 5200)) }, i.prototype.setFormStatus = function (e) { this.formStatus = e, this.toastMessage = null, this.formErrors = [], this.update() }, i.prototype.onEmailSent = function () { var e = this; this.formStatus = 3, this.emailDisabled = null, this.unmounted || this.update(), setTimeout(function () { e.formStatus = 0, e.unmounted || e.update() }, 5e3), setTimeout(function () { e.formStatus = 0, e.unmounted || e.update() }, 5200) }, i.prototype.onEmailSendingFailed = function () { this.formErrors = [this.controller.getSomethingWentWrongText()], this.emailDisabled = null, this.unmounted || this.update() }, i.prototype.sendChangeEmail = function () { this.emailDisabled = !0, this.unmounted || this.update(), this.controller.userController.initiateEmailChange({ lang: this.controller.getLanguage() }).done(this.bindFn(this.onEmailSent)).fail(this.bindFn(this.onEmailSendingFailed)) }, i }(n.Class); e.SharedEmailSettings = i });

define('loadcss!shared-components/shared-profile-info', function () { });
define('shared-components/shared-profile-info', ["require", "exports", "tslib", "dcgview", "./shared-delete-account", "./shared-email-settings", "loadcss!./shared-profile-info"], function (require, e, t, n, o, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedProfileInfo = void 0; var i = n.Components, r = i.If, s = i.Input, c = i.Switch, l = i.SwitchUnion, u = function (e) { function i() { return null !== e && e.apply(this, arguments) || this } return t.__extends(i, e), i.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.deleteAccount = 0 }, i.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-shared-profile-info dcg-shared-account-settings-section") }, n.createElement(c, { key: function () { return e.deleteAccount } }, function (t) { switch (t) { case 0: return n.createElement("div", null, n.createElement("div", { class: n.const("dcg-shared-email-form-container") }, n.createElement(d, { controller: e.props.controller })), n.createElement(a.SharedEmailSettings, { controller: e.props.controller }), n.createElement("div", { role: n.const("link"), tabindex: n.const(0), class: n.const("dcg-shared-dark-gray-link dcg-shared-delete-link"), onTap: function () { return e.confirmDeletion() } }, function () { return e.i18n.s("shared-button-delete-account-question") })); case 1: return n.createElement(o.SharedDeleteAccount, { hideForm: function () { return e.setDeleteAccount(0) }, submitForm: function () { return e.setDeleteAccount(2) }, controller: e.props.controller }); case 2: return n.createElement("div", { "aria-live": n.const("assertive"), "aria-atomic": n.const("true"), class: n.const("dcg-shared-confirmation-message-container") }, n.createElement("div", { class: n.const("dcg-shared-confirmation-message") }, n.createElement("i", { class: function () { return { "dcg-shared-icon-check": !0, "dcg-success-marker": !0 } }, "aria-hidden": n.const("true") }), function () { return e.i18n.s("shared-message-email-sent") }), n.createElement("div", null, function () { return e.i18n.s("shared-message-check-email-for-delete-link", { emailAddress: e.i18n.raw(e.controller.userController.getEmail()) }) })) } })) }, i.prototype.didUnmount = function () { this.unmounted = !0 }, i.prototype.setDeleteAccount = function (e) { var t = this; this.deleteAccount = e, 2 === e && setTimeout(function () { t.controller.userController.logout().done(function () { return t.controller.dispatch({ type: "close-modal" }) }) }, 5e3), this.unmounted || this.update() }, i.prototype.confirmDeletion = function () { this.controller.logJSON("shared-profile-info", { action: "delete-account" }), this.setDeleteAccount(1), this.unmounted || this.update() }, i }(n.Class); e.SharedProfileInfo = u; var d = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.init = function () { this.controller = this.props.controller(); var e = this.controller.userController.getNameDetail(); "legacy" == e.source ? this.state = { state: "legacy", name: e.given, previousName: e.given } : "parsed" == e.source ? this.state = { state: "name-detail", confirm: !0, given: e.given, family: e.family || "", previousGiven: "", previousFamily: "" } : this.state = { state: "name-detail", confirm: !1, given: e.given, family: e.family || "", previousGiven: e.given, previousFamily: e.family || "" } }, o.prototype.template = function () { var e = this; return l("state", function () { return e.state })({ legacy: function (o) { return n.createElement(p, { state: o, controller: e.props.controller, wasModalOpenedWithKeyboard: function () { return e.controller.wasModalOpenedWithKeyboard() }, onSaveName: e.bindFn(e.onSaveName), showSavedNotice: function () { return e.showSavedNotice }, updateState: function (n) { "legacy" == e.state.state && (e.state = t.__assign(t.__assign({}, e.state), n), e.unmounted || e.update()) } }) }, "name-detail": function (o) { return n.createElement(m, { state: o, controller: e.props.controller, wasModalOpenedWithKeyboard: function () { return e.controller.wasModalOpenedWithKeyboard() }, showSavedNotice: function () { return e.showSavedNotice }, onSaveName: e.bindFn(e.onSaveName), updateState: function (n) { "name-detail" == e.state.state && (e.state = t.__assign(t.__assign({}, e.state), n), e.unmounted || e.update()) } }) } }) }, o.prototype.onSaveName = function () { switch (this.state.state) { case "legacy": this.controller.userController.setNameLegacy({ name: this.state.name, lang: this.controller.getLanguage() }).done(this.bindFn(this.onSaved)); break; case "name-detail": this.controller.userController.setNameDetail({ given: this.state.given, family: this.state.family, lang: this.controller.getLanguage() }).done(this.bindFn(this.onSaved)) } }, o.prototype.maybeUpdate = function () { this.unmounted || this.update() }, o.prototype.onSaved = function () { var e = this; switch (this.state.state) { case "legacy": this.state.previousName = this.state.name; break; case "name-detail": this.state.previousGiven = this.state.given, this.state.previousFamily = this.state.family, this.state.confirm = !1 }this.showSavedNotice = !0, this.maybeUpdate(), setTimeout(function () { e.showSavedNotice = !1, e.maybeUpdate() }, 3e3) }, o.prototype.willUnmount = function () { this.unmounted = !0 }, o.prototype.didMount = function () { this.unmounted = !1 }, o }(n.Class), p = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller }, o.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-shared-name-field") }, n.createElement("div", { class: n.const("dcg-shared-profile-info-container") }, n.createElement("span", { class: n.const("dcg-shared-profile-info-title"), role: n.const("heading"), "aria-level": n.const("1") }, function () { return e.i18n.s("shared-label-name") }), n.createElement(s, { type: n.const("text"), name: n.const("name"), class: n.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"), didMount: this.bindFn(this.didMountName), onInput: this.bindFn(this.onNameInput), "aria-label": function () { return e.i18n.s("shared-label-name") }, value: function () { return e.props.state().name }, autocomplete: n.const("off") })), n.createElement("div", { class: n.const("dcg-shared-modal-actions-container") }, n.createElement(h, { showSavedNotice: this.props.showSavedNotice, i18n: this.props.controller }), n.createElement("div", { role: n.const("button"), "aria-disabled": this.bindFn(this.nameFieldDisabled), tabindex: function () { return e.nameFieldDisabled() ? "-1" : "0" }, class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": e.nameFieldDisabled() } }, onTap: this.bindFn(this.onSaveName) }, function () { return e.i18n.s("shared-button-save") }))) }, o.prototype.onNameInput = function (e) { this.props.updateState({ name: e }) }, o.prototype.didMountName = function (e) { this.props.wasModalOpenedWithKeyboard() && e.focus() }, o.prototype.onSaveName = function () { this.nameFieldDisabled() || this.props.onSaveName() }, o.prototype.nameFieldDisabled = function () { var e = this.props.state(); return !e.name || e.name === e.previousName }, o }(n.Class), m = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller }, o.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-shared-name-field") }, n.createElement("div", { class: function () { return { "dcg-shared-confirm-name": e.props.state().confirm } } }, n.createElement(r, { predicate: function () { return e.props.state().confirm } }, function () { return n.createElement("span", null, function () { return e.i18n.s("shared-message-please-review-name") }) }), n.createElement("div", { class: n.const("dcg-shared-profile-info-container") }, n.createElement("div", { class: n.const("dcg-shared-name-input") }, n.createElement("span", { class: n.const("dcg-shared-profile-info-title"), role: n.const("heading"), "aria-level": n.const("1") }, function () { return e.i18n.s("shared-label-given-name-or-nickname") }), n.createElement(s, { type: n.const("text"), name: n.const("given-name"), class: n.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"), didMount: this.bindFn(this.didMountName), onInput: function (t) { return e.props.updateState({ given: t }) }, "aria-label": function () { return e.i18n.s("shared-label-given-name-or-nickname") }, value: function () { return e.props.state().given }, autocomplete: n.const("off") })), n.createElement("div", { class: n.const("dcg-shared-name-input") }, n.createElement("span", { class: n.const("dcg-shared-profile-info-title"), role: n.const("heading"), "aria-level": n.const("1") }, function () { return e.i18n.s("shared-label-family-name") }), n.createElement(s, { type: n.const("text"), name: n.const("family-name"), class: n.const("dcg-shared-input-blue-outline dcg-shared-profile-info-content"), onInput: function (t) { return e.props.updateState({ family: t }) }, "aria-label": function () { return e.i18n.s("shared-label-family-name") }, value: function () { return e.props.state().family }, autocomplete: n.const("off") }))), n.createElement("div", { class: n.const("dcg-shared-modal-actions-container") }, n.createElement(h, { i18n: this.props.controller, showSavedNotice: this.props.showSavedNotice }), n.createElement("div", { role: n.const("button"), "aria-disabled": function () { return !e.canSubmit() }, tabindex: function () { return e.canSubmit() ? "0" : "-1" }, class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": !e.canSubmit() } }, onTap: this.bindFn(this.onSaveName) }, function () { return e.props.state().confirm ? e.i18n.s("shared-button-confirm-name") : e.i18n.s("shared-button-save") })))) }, o.prototype.didMountName = function (e) { this.props.wasModalOpenedWithKeyboard() && e.focus() }, o.prototype.onSaveName = function () { this.canSubmit() && this.props.onSaveName() }, o.prototype.canSubmit = function () { var e = this.props.state(); return !!e.given && (!!e.confirm || !(e.given === e.previousGiven && e.family === e.previousFamily)) }, o }(n.Class), h = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement(r, { predicate: function () { return e.props.showSavedNotice() } }, function () { return n.createElement("span", { "aria-live": n.const("assertive"), "aria-atomic": n.const("true"), class: n.const("dcg-shared-confirmation-message") }, n.createElement("i", { class: function () { return { "dcg-shared-icon-check": !0, "dcg-success-marker": !0 } }, "aria-hidden": n.const("true") }), function () { return e.props.i18n().s("shared-message-information-saved") }) }) }, o }(n.Class) });
define('shared-components/shared-change-password', ["require", "exports", "tslib", "dcgview", "./shared-account-modal-errors", "loadcss!./shared-account-settings-modal", "loadcss!shared-components/btn-styles"], function (require, e, t, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedChangePassword = void 0; var o = n.Components.If, s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.mode = 1, this.formErrors = [] }, s.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-shared-change-password dcg-shared-account-settings-section") }, n.createElement(o, { predicate: function () { return 1 === e.mode } }, function () { return n.createElement("div", { class: n.const("dcg-shared-reset-by-email") }, n.createElement("div", { class: n.const("dcg-shared-account-paragraph") }, function () { return e.i18n.s("shared-message-change-password-email-sent", { emailAddress: e.i18n.raw(e.controller.userController.getEmail()) }) }), n.createElement(r.SharedAccountModalErrors, { controller: e.props.controller, errors: function () { return e.formErrors } }), n.createElement("div", { class: n.const("dcg-shared-modal-actions-container") }, n.createElement("div", { role: n.const("button"), "aria-disabled": function () { return e.emailDisabled }, tabindex: function () { return e.emailDisabled ? "-1" : "0" }, class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": e.emailDisabled } }, didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, onTap: function () { return e.sendResetPasswordEmail() } }, function () { return e.i18n.s("shared-button-send-email") }))) }), n.createElement(o, { predicate: function () { return 2 === e.mode } }, function () { return n.createElement("div", { "aria-live": n.const("assertive"), "aria-atomic": n.const("true"), class: n.const("dcg-shared-confirmation-message-container") }, n.createElement("div", { class: n.const("dcg-shared-confirmation-message") }, n.createElement("i", { class: function () { return { "dcg-shared-icon-check": !0, "dcg-success-marker": !0 } }, "aria-hidden": n.const("true") }), function () { return e.i18n.s("shared-message-email-sent") }), n.createElement("div", null, function () { return e.i18n.s("shared-message-check-email-for-password-link", { emailAddress: e.i18n.raw(e.controller.userController.getEmail()) }) })) })) }, s.prototype.didUnmount = function () { this.unmounted = !0 }, s.prototype.onEmailSent = function () { var e = this; this.mode = 2, this.unmounted || this.update(), setTimeout(function () { e.mode = 0, e.unmounted || e.update() }, 5e3), setTimeout(function () { e.mode = 1, e.unmounted || e.update() }, 5200) }, s.prototype.onEmailSendingFailed = function () { this.formErrors = [this.controller.getSomethingWentWrongText()], this.unmounted || this.update() }, s.prototype.sendResetPasswordEmail = function () { this.controller.userController.recoverPassword({ email: this.controller.userController.getEmail(), lang: this.controller.getLanguage() }).done(this.bindFn(this.onEmailSent)).fail(this.bindFn(this.onEmailSendingFailed)) }, s }(n.Class); e.SharedChangePassword = s });
define('shared-components/shared-account-settings-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "./shared-profile-info", "./shared-change-password", "jquery", "underscore", "loadcss!./shared-account-settings-modal", "loadcss!shared-components/btn-styles"], function (require, t, e, n, i, s, o, r, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SharedAccountSettingsModal = t.CHANGE_PASS = t.PROFILE_INFO = void 0; var c = n.Components, l = c.For, d = c.Switch; t.PROFILE_INFO = "profile-info", t.CHANGE_PASS = "change-password"; var u = function (c) { function u() { return null !== c && c.apply(this, arguments) || this } return e.__extends(u, c), u.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.settingsView = this.props.initialTab && this.props.initialTab() || t.PROFILE_INFO, this.breakPoint = 660, this.measureWindow() }, u.prototype.template = function () { var e = this; return n.createElement(i.Modal, { title: function () { return e.i18n.s("shared-title-account-settings") }, size: this.const("wide"), showX: this.const(!0), leftAlignTitle: this.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, n.createElement("div", { class: n.const("dcg-shared-account-settings-dialog dcg-shared-account-dialog") }, n.createElement(l, { each: function () { return e.getTabs() }, key: function (t) { return "" + t.key } }, n.createElement("div", { class: n.const("dcg-shared-navigation-tabs"), role: n.const("tablist") }, function (t) { return n.createElement("div", { role: n.const("tab"), tabindex: n.const("0"), "aria-selected": function () { return e.settingsView === t.key }, didMount: function (n) { e.controller.wasModalOpenedWithKeyboard() && e.settingsView === t.key && n.focus() }, class: function () { var n; return (n = { "dcg-shared-tab-gray-underline": !0 })[t.class] = !0, n["dcg-selected"] = e.settingsView === t.key, n }, onTap: function () { return e.updateSettingsView(t.key) } }, t.label) })), n.createElement("div", { class: n.const("dcg-shared-content-container") }, n.createElement(d, { key: function () { return e.settingsView } }, function (i) { return i === t.PROFILE_INFO ? n.createElement(s.SharedProfileInfo, { controller: e.props.controller }) : i === t.CHANGE_PASS ? n.createElement(o.SharedChangePassword, { controller: e.props.controller }) : e.props.extraTabs ? n.createElement("div", { class: n.const("dcg-shared-profile-info dcg-shared-account-settings-section") }, e.props.extraTabs().createView(i)) : n.createElement("span", null) })))) }, u.prototype.getTabs = function () { var n = this, i = [{ key: t.PROFILE_INFO, label: this.bindFn(this.profileTitle), class: "profile-view-button" }, { key: t.CHANGE_PASS, label: this.bindFn(this.passwordTitle), class: "change-password-view-button" }]; return this.props.extraTabs ? e.__spreadArray(e.__spreadArray([], i), this.props.extraTabs().tabs.map(function (t) { var e = t.key, i = t.narrowLabel, s = t.wideLabel; return { key: e, label: function () { return n.windowWidth > n.breakPoint ? i() : s() }, class: t.class + "-button" } })) : i }, u.prototype.updateSettingsView = function (t) { this.settingsView = t, this.unmounted || this.update() }, u.prototype.profileTitle = function () { return this.windowWidth > this.breakPoint ? this.i18n.s("shared-title-profile-information-wide") : this.i18n.s("shared-title-profile-information-narrow") }, u.prototype.passwordTitle = function () { return this.windowWidth > this.breakPoint ? this.i18n.s("shared-title-change-password-wide") : this.i18n.s("shared-title-change-password-narrow") }, u.prototype.measureWindow = function () { return this.windowWidth = r(window).width() }, u.prototype.didMount = function () { var t = this; r(window).on("resize.account-dialog", a.throttle(function () { t.measureWindow(), t.unmounted || t.update() }, 200)) }, u.prototype.didUnmount = function () { r(window).off("resize.account-dialog"), this.unmounted = !0 }, u.prototype.isProfileSelected = function () { return this.settingsView === t.PROFILE_INFO }, u.prototype.isChangePasswordSelected = function () { return this.settingsView === t.CHANGE_PASS }, u }(n.Class); t.SharedAccountSettingsModal = u });
define('shared-components/shared-change-email-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "./shared-account-modal-errors", "loadcss!./shared-account-modal"], function (require, e, t, n, r, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedChangeEmailModal = void 0; var s = n.Components.Input, a = function (e) { function a() { return null !== e && e.apply(this, arguments) || this } return t.__extends(a, e), a.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.formErrors = [] }, a.prototype.template = function () { var e = this; return n.createElement(r.Modal, { title: function () { return e.i18n.s("shared-title-change-email-address") }, size: this.const("narrow"), showX: this.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, n.createElement("div", { class: n.const("dcg-shared-change-email dcg-shared-account-dialog") }, n.createElement("div", { class: n.const("dcg-shared-account-paragraph") }, function () { return e.i18n.s("shared-message-set-new-email-address") }), n.createElement("form", { onSubmit: this.bindFn(this.onSubmit), method: n.const("post"), class: n.const("dcg-shared-email-form-container") }, n.createElement("label", null, n.createElement("span", { class: n.const("dcg-shared-input-title") }, function () { return e.i18n.s("shared-label-new-email-address") }), n.createElement(s, { type: n.const("email"), name: n.const("newEmail"), class: n.const("dcg-shared-input-blue-outline"), "aria-label": function () { return e.i18n.s("shared-label-new-email-address") }, "aria-required": n.const("true"), required: n.const("required"), didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() }, value: function () { return e.newEmail }, onInput: function (t) { e.newEmail = t, e.unmounted || e.update() } })), n.createElement("label", { for: n.const("password") }, n.createElement("span", null, function () { return e.i18n.s("shared-label-password") }), n.createElement(s, { type: n.const("password"), class: n.const("dcg-shared-input-blue-outline"), "aria-label": function () { return e.i18n.s("shared-label-password") }, "aria-required": n.const("true"), required: n.const("required"), value: function () { return e.password }, name: this.const("password"), onInput: function (t) { if (e.password = t, !e.unmounted) return e.update() } })), n.createElement(o.SharedAccountModalErrors, { controller: this.props.controller, errors: function () { return e.formErrors } }), n.createElement("div", { class: n.const("dcg-shared-sign-in-options") }, n.createElement("button", { class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": !e.submitEnabled() } }, "aria-disabled": function () { return !e.submitEnabled() }, tabindex: function () { return e.submitEnabled() ? "0" : "-1" }, type: n.const("submit") }, function () { return e.i18n.s("shared-button-change-email-and-password") }))))) }, a.prototype.submitEnabled = function () { return !(!this.password || !this.newEmail) }, a.prototype.didUnmount = function () { this.unmounted = !0 }, a.prototype.onSubmit = function (e) { var t = this; e.preventDefault(), this.submitEnabled() && this.controller.userController.setEmail({ changeToken: this.getChangeToken(), password: this.password, newEmail: this.newEmail, lang: this.controller.getLanguage() }).done(function () { t.controller.dispatch({ type: "close-modal" }), history.replaceState(null, null, document.location.pathname) }).fail(function (e) { 409 === e.status ? t.formErrors = ["Sorry, someone has already registered with this email address."] : t.formErrors = [t.controller.getSomethingWentWrongText()], t.unmounted || t.update() }) }, a.prototype.getChangeToken = function () { return this.controller.userController.getEmailChangeToken() || "" }, a }(n.Class); e.SharedChangeEmailModal = a });
define('lib/data-uri-to-blob', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e) { for (var t = e.split(","), n = t[0].match(/:(.*?);/), r = null !== n ? n[1] : "", l = null !== t[1] ? atob(t[1]) : "", u = l.length, o = new Uint8Array(u); u--;)o[u] = l.charCodeAt(u); return new Blob([o], { type: r }) } });
define('lib/svg-string-to-blob', ["require", "exports"], function (require, e) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.default = function (e) { if (-1 === e.indexOf("xmlns=")) throw new Error('Programming error: <svg> elements require the "xmlns" attribute to render properly'); return new Blob([e], { type: "image/xml+svg;charset=utf-8" }) } });

define('loadcss!calculator-shell/export-image-size-options', function () { });
define('calculator-shell/export-image-size-options', ["require", "exports", "tslib", "dcgview", "jquery", "./export-image-dialog", "loadcss!./export-image-size-options"], function (require, e, t, n, o, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var i = n.Components.If, r = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.template = function () { var e = this; return n.createElement("div", { role: n.const("button"), tabindex: n.const("0"), "aria-pressed": function () { return e.isSelected() }, class: function () { return { "dcg-option": !0, "dcg-selected": e.isSelected() } }, onTap: function () { return e.selectSize() } }, function () { return s.sizes[e.props.size()].name(e.props.controller()) }) }, o.prototype.isSelected = function () { this.props.selectedSize(), this.props.size() }, o.prototype.selectSize = function () { this.props.onSelectSize(this.props.size()) }, o }(n.Class), c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.menuOpen = !1, this.unmounted = !1 }, c.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-export-image-size-options") }, n.createElement("div", { role: n.const("button"), tabindex: n.const("0"), "aria-haspopup": n.const("true"), "aria-expanded": function () { return e.menuOpen }, class: n.const("dcg-selected-option"), didMount: function (t) { e.menuElement = t, "keyboard" === e.props.controller().getModalDevice() && setTimeout(function () { e.menuElement.focus() }, 0) }, onTap: this.bindFn(this.toggleMenu) }, function () { return e.selected().name(e.props.controller()) }, n.createElement("i", { class: n.const("dcg-icon-caret-down"), "aria-hidden": n.const("true") })), n.createElement(i, { predicate: function () { return e.menuOpen } }, function () { return n.createElement("div", { class: n.const("dcg-options-positioning-container") }, n.createElement("div", { class: n.const("dcg-options-container"), role: n.const("group"), "aria-label": function () { return e.props.controller().s("account-shell-narration-size-options") } }, n.createElement(r, { controller: e.props.controller, size: e.const("small_square"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("medium_square"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("large_square"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("medium_rectangle"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("large_rectangle"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement("h3", { class: n.const("dcg-embosser-title") }, function () { return e.props.controller().s("account-shell-heading-embossers") }), n.createElement(r, { controller: e.props.controller, size: e.const("vpmax8"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("vpmax11"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("etc8"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }), n.createElement(r, { controller: e.props.controller, size: e.const("etc11"), selectedSize: e.props.selectedSize, onSelectSize: e.bindFn(e.selectSize) }))) })) }, c.prototype.closeMenu = function () { o(document).off(".export-image-size-options"), this.menuOpen = !1, this.unmounted || this.update() }, c.prototype.didUnmount = function () { o(document).off(".export-image-size-options"), this.unmounted = !0 }, c.prototype.toggleMenu = function () { var e = this; this.menuOpen ? this.closeMenu() : (this.menuOpen = !0, o(document).on("dcg-tap.export-image-size-options", function (t) { o(t.target).closest(".dcg-export-image-size-options").length || e.closeMenu() }), this.unmounted || this.update()) }, c.prototype.selectSize = function (e) { this.menuOpen = !1, this.props.selectSize(e), void 0 !== this.menuElement && "keyboard" === this.props.controller().getModalDevice() && this.menuElement.focus() }, c.prototype.selected = function () { return s.sizes[this.props.selectedSize()] }, c }(n.Class); e.default = c });

define('loadcss!calculator-shell/export-image-dialog', function () { });
define('calculator-shell/export-image-dialog', ["require", "exports", "api/calculator", "config", "tslib", "dcgview", "jquery", "lib/data-uri-to-blob", "lib/svg-string-to-blob", "dcgview-helpers/download-button", "./export-image-size-options", "lib/export-braille-equations", "graphing/braille-size-options", "./modal", "shared/dcgviews/localize", "browser", "loadcss!./export-image-dialog"], function (require, t, e, n, i, r, o, s, c, l, a, u, d, h, g, p) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.sizes = void 0; var m = r.Components, f = m.If, v = m.IfElse; t.sizes = {}; var b = { left: 0, top: 0, right: 0, bottom: 0 }; t.sizes.small_square = { width: 160, height: 160, margins: b, name: function (t) { return t.s("account-shell-label-export-size-small-square") } }, t.sizes.medium_square = { width: 400, height: 400, margins: b, name: function (t) { return t.s("account-shell-label-export-size-medium-square") } }, t.sizes.large_square = { width: 1e3, height: 1e3, margins: b, name: function (t) { return t.s("account-shell-label-export-size-large-square") } }, t.sizes.medium_rectangle = { width: 600, height: 400, margins: b, name: function (t) { return t.s("account-shell-label-export-size-medium-rectangle") } }, t.sizes.large_rectangle = { width: 1200, height: 800, margins: b, name: function (t) { return t.s("account-shell-label-export-size-large-rectangle") } }, t.sizes = i.__assign(i.__assign({}, t.sizes), d.brailleSizes); var w = function (d) { function m() { return null !== d && d.apply(this, arguments) || this } return i.__extends(m, d), m.prototype.init = function () { this.controller = this.props.controller(), this.thickness = "thin", this.size = "medium_square"; var t = this.controller.api.controller.getBrailleMode(); this.brailleMode = "none" !== t ? t : "nemeth", this.showDownloadButton = l.canDownload(), this.unmounted = !1, this.svgDropdownOpen = !1, this.markImagesDirty(), this.loaded = !1 }, m.prototype.template = function () { var t = this; return r.createElement(h.Modal, { controller: this.props.controller }, r.createElement("div", { id: r.const("export-image-dialog") }, r.createElement("h1", null, function () { return t.controller.s("account-shell-heading-export-graph") }), r.createElement("div", { class: r.const("dcg-offscreen-calculator"), didMount: this.bindFn(this.didMountOffscreenCalc), willUnmount: this.bindFn(this.willUnmountOffscreenCalc), "aria-hidden": r.const("true") }), r.createElement("div", { class: r.const("dcg-columns") }, r.createElement("div", { class: r.const("dcg-left-column") }, r.createElement("div", { class: function () { return { "dcg-graph-preview": !0, "dcg-preview-loading": t.pngDirty } } }, r.createElement(f, { predicate: function () { return t.loaded } }, function () { return r.createElement("img", { class: r.const("dcg-graph-image"), didMount: t.bindFn(t.didMountGraphPreview), src: function () { return t.previewDataURL }, alt: function () { return t.controller.s("account-shell-narration-graph-preview") } }) }), r.createElement(f, { predicate: function () { return t.pngDirty } }, function () { return r.createElement("span", { class: r.const("dcg-loading-message") }, r.createElement("span", { class: r.const("dcg-spinner") }), function () { return t.controller.s("account-shell-label-loading") }) }), r.createElement(f, { predicate: function () { return !t.pngDirty && !t.isExportingBraille() } }, function () { return r.createElement("span", { class: r.const("dcg-zoom-percentage") }, t.bindFn(t.getZoom)) }))), r.createElement("div", { class: r.const("dcg-right-column") }, r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-export-size") }), r.createElement(a.default, { controller: this.props.controller, selectedSize: function () { return t.size }, selectSize: this.bindFn(this.selectSize) }), r.createElement(f, { predicate: function () { return !t.isExportingBraille() } }, function () { return r.createElement("div", null, r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-line-thickness") }), r.createElement("div", { role: r.const("group"), "aria-label": function () { return t.controller.s("account-shell-heading-line-thickness") }, class: r.const("dcg-button-group") }, r.createElement("div", { role: r.const("button"), tabindex: r.const("0"), class: function () { return { "dcg-button": !0, "dcg-selected": "thin" === t.thickness } }, "aria-pressed": function () { return "thin" === t.thickness }, onTap: function () { return t.selectThickness("thin") } }, function () { return t.controller.s("account-shell-button-line-thin") }), r.createElement("div", { role: r.const("button"), tabindex: r.const("0"), class: function () { return { "dcg-button": !0, "dcg-selected": "medium" === t.thickness } }, "aria-pressed": function () { return "medium" === t.thickness }, onTap: function () { return t.selectThickness("medium") } }, function () { return t.controller.s("account-shell-button-line-medium") }), r.createElement("div", { role: r.const("button"), tabindex: r.const("0"), class: function () { return { "dcg-button": !0, "dcg-selected": "thick" === t.thickness } }, "aria-pressed": function () { return "thick" === t.thickness }, onTap: function () { return t.selectThickness("thick") } }, function () { return t.controller.s("account-shell-button-line-thick") }))) }), r.createElement(f, { predicate: function () { return t.isExportingBraille() } }, function () { return r.createElement("div", { class: r.const("braille-container") }, r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-braille-mode") }), r.createElement("div", { role: r.const("group"), "aria-label": function () { return t.controller.s("account-shell-heading-braille-mode") }, class: r.const("dcg-button-group") }, r.createElement("div", { role: r.const("button"), tabindex: r.const("0"), class: function () { return { "dcg-button": !0, "dcg-selected": "nemeth" === t.brailleMode } }, "aria-pressed": function () { return "nemeth" === t.brailleMode }, onTap: function () { return t.selectBrailleMode("nemeth") } }, function () { return t.controller.s("account-shell-button-braille-nemeth") }), r.createElement("div", { role: r.const("button"), tabindex: r.const("0"), class: function () { return { "dcg-button": !0, "dcg-selected": "ueb" === t.brailleMode } }, "aria-pressed": function () { return "ueb" === t.brailleMode }, onTap: function () { return t.selectBrailleMode("ueb") } }, function () { return t.controller.s("account-shell-button-braille-ueb") })), r.createElement("div", { class: r.const("braille-instructions") }, r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-embossing-instructions") }), r.createElement(f, { predicate: function () { return "vpmax8" === t.size || "vpmax11" === t.size } }, function () { return r.createElement("ul", null, r.createElement("li", null, function () { return t.controller.s("account-shell-text-embossing-vpmax-save") }), r.createElement("li", null, function () { return t.controller.s("account-shell-text-embossing-vpmax-print", { size: E(t.size) }) })) }), r.createElement(f, { predicate: function () { return "etc8" === t.size || "etc11" === t.size } }, function () { return r.createElement("ul", null, r.createElement("li", null, function () { return t.controller.s("account-shell-text-embossing-etc-save") }), r.createElement("li", null, function () { return t.controller.s("account-shell-text-embossing-etc-print", { size: E(t.size) }) })) }), r.createElement("div", { class: r.const("dcg-feedback-link") }, r.createElement(g.Localize, { i18n: t.const(t.controller), key: t.const("graphing-calculator-text-export-braille-email-accessibility") }, r.const("Feedback? Email"), r.const(" "), r.createElement("a", { class: r.const("blue-link"), href: r.const("mailto:accessibility@desmos.com") }, r.const("accessibility@desmos.com")), r.const("."))))) }), v(this.const(this.showDownloadButton), { true: function () { return r.createElement("div", null, r.createElement("div", { role: r.const("group"), "aria-label": function () { return t.controller.s("account-shell-narration-image-download") }, class: function () { return { "dcg-download-button-group": !0, "dcg-download-button-group-singleton": t.isExportingBraille() } } }, r.createElement(l.default, { data: function () { return t.previewBlob }, enabled: function () { return !t.pngDirty }, filename: t.const("desmos-graph.png"), text: function () { return t.controller.s("account-shell-button-download-png") } }), r.createElement(f, { predicate: function () { return !t.isExportingBraille() } }, function () { return r.createElement("div", { role: r.const("button"), tabindex: function () { return t.svgDirty ? -1 : 0 }, "aria-disabled": function () { return t.svgDirty }, "aria-expanded": function () { return t.svgDropdownOpen }, "aria-label": function () { return t.controller.s("account-shell-button-svg-options") }, class: function () { return { "dcg-svg-dropdown": !0, "dcg-button": !0, "dcg-disabled": t.svgDirty } }, onTap: t.bindFn(t.toggleSvgDropdown) }, r.createElement("i", { class: r.const("dcg-icon-caret-down"), "aria-hidden": r.const("true") })) })), r.createElement(f, { predicate: function () { return t.isExportingBraille() && !p.IS_MOBILE } }, function () { return r.createElement(l.default, { data: function () { return t.brailleBlob }, enabled: function () { return !t.pngDirty }, filename: t.const("desmos-equations.brl"), text: function () { return t.controller.s("account-shell-button-download-braille") }, isBraille: t.const(!0) }) }), r.createElement(f, { predicate: function () { return t.svgDropdownOpen } }, function () { return r.createElement("div", { class: r.const("dcg-svg-popover dcg-popover dcg-top"), didMount: t.bindFn(t.didMountSvgDropdown), willUnmount: t.bindFn(t.willUnmountSvgDropdown) }, r.createElement("div", { class: r.const("dcg-popover-interior") }, r.createElement(l.default, { data: function () { return t.svgBlob }, enabled: function () { return !t.svgDirty }, filename: t.const("desmos-graph.svg"), text: function () { return t.controller.s("account-shell-button-download-svg") }, isSvg: t.const(!0) }), r.createElement("div", { class: r.const("dcg-beta-tag") }, function () { return t.controller.s("account-shell-label-beta") })), r.createElement("div", { class: r.const("dcg-arrow") })) })) }, false: function () { return r.createElement(f, { predicate: function () { return !t.isExportingBraille() } }, function () { return r.createElement("div", { class: r.const("dcg-download-not-enabled-notice") }, r.createElement("div", { role: r.const("heading"), "aria-level": r.const("2"), class: r.const("dcg-title") }, function () { return t.controller.s("account-shell-heading-download-instructions") }), function () { return t.controller.s("account-shell-text-download-instructions") }) }) } }))))) }, m.prototype.didMountSvgDropdown = function (t) { var e = this; o(document).on("dcg-tap.svg-dropdown", function (n) { var i = n.target, r = o(".dcg-svg-dropdown")[0]; t && r && (r.contains(i) || t.contains(i) || e.closeSvgDropdown()) }) }, m.prototype.willUnmountSvgDropdown = function () { o(document).off(".svg-dropdown") }, m.prototype.didMountOffscreenCalc = function (t) { var n = this; this.calculator = new e.Calculator(t, { expressions: !1, keypad: !1, branding: !1, border: !1, enableTabindex: !1 }), this.calculator._calc.evaluator.notifyWhenSynced(function () { n.markImagesDirty(), n.updateIfMounted() }), this.calculator.setState(this.controller.api.getState()) }, m.prototype.willUnmountOffscreenCalc = function () { this.calculator && this.calculator.destroy() }, m.prototype.markImagesDirty = function () { this.pngDirty = !0, this.svgDirty = !0 }, m.prototype.selectSize = function (t) { this.size = t, this.markImagesDirty(), this.updateIfMounted() }, m.prototype.selectBrailleMode = function (t) { this.brailleMode = t, this.markImagesDirty(), this.updateIfMounted() }, m.prototype.getZoom = function () { return this.controller.s("account-shell-label-zoom", { value: Math.min(100, Math.round(4e4 / this.getWidth())) }) }, m.prototype.selectThickness = function (t) { this.thickness = t, this.markImagesDirty(), this.updateIfMounted() }, m.prototype.didMountGraphPreview = function (t) { this.previewImg = t }, m.prototype.getGridOpacity = function () { switch (this.thickness) { case "thick": return 1; case "medium": return .6; case "thin": return .4; default: return this.thickness } }, m.prototype.getAxisWeight = function () { switch (this.thickness) { case "thick": case "medium": return 2; case "thin": return 1.5; default: return this.thickness } }, m.prototype.getGraphThickness = function () { switch (this.thickness) { case "thick": return 5; case "medium": return 3.5; case "thin": return 2.5; default: return this.thickness } }, m.prototype.getLabelSize = function () { if ("small_square" === this.size) switch (this.thickness) { case "thick": return 14; case "medium": return 12; case "thin": return 10; default: return this.thickness } else switch (this.thickness) { case "thick": return 20; case "medium": return 17; case "thin": return 14; default: return this.thickness } }, m.prototype.updateViewSettings = function () { if (void 0 !== this.calculator && void 0 !== this.calculator._calc && void 0 !== this.calculator._calc.grapher && void 0 !== this.calculator._calc.grapher.settings) { var t = this.calculator._calc.grapher.settings; this.isExportingBraille() || (t.majorAxisOpacity = this.getGridOpacity(), t.minorAxisOpacity = this.getGridOpacity() / 2, t.axisLineOffset = 0, t.setProperty("axisLineWidth", this.getAxisWeight()), t.labelSize = this.getLabelSize(), t.graphLineWidth = this.getGraphThickness(), t.pointLineWidth = 3 * this.getGraphThickness()) } }, m.prototype.getBackgroundSize = function () { switch (this.size) { case "medium_rectangle": case "large_rectangle": return "contain"; case "small_square": return t.sizes.small_square.width + "px " + t.sizes.small_square.height + "px"; default: return "cover" } }, m.prototype.getHeight = function () { return t.sizes[this.size].height }, m.prototype.getWidth = function () { return t.sizes[this.size].width }, m.prototype.didUnmount = function () { this.unmounted = !0 }, m.prototype.updateIfMounted = function () { this.unmounted || this.update() }, m.prototype.updateGraphPreview = function () { var t = this; if ((this.pngDirty || this.svgDirty) && void 0 !== this.calculator && void 0 !== this.calculator._calc && void 0 !== this.calculator._calc.grapher && void 0 !== this.calculator._calc.grapher.settings) { this.updateViewSettings(); var e = { width: this.getWidth(), height: this.getHeight(), preserveAxisNumbers: !0, showLabels: !0, targetPixelRatio: 2 }, r = { braille: { embosserModel: this.size, brailleMode: this.brailleMode } }; if (this.pngDirty) { var o = this.isExportingBraille() ? r : e; this.calculator.asyncScreenshot(o, function (e) { t.previewDataURL = e, t.previewBlob = s.default(t.previewDataURL), t.pngDirty = !1, t.loaded = !0, t.updateIfMounted(), t.resizePreviewImg() }) } if (this.svgDirty) { var l = i.__assign(i.__assign({}, e), { svg: !0 }), a = n.get("worksheetSVG"); a && (l.targetPixelRatio = 1), this.calculator.asyncScreenshot(l, function (e) { a && (e = function (t) { var e = (new DOMParser).parseFromString(t, "text/xml"); function n(t, n) { e.querySelectorAll(t).forEach(n) } return n(".dcg-svg-region", function (t) { t.setAttribute("fill", "black") }), n(".dcg-svg-label *", function (t) { t.setAttribute("stroke", "none"), t.setAttribute("fill", "black") }), n(".dcg-svg-axis-value text", function (t) { "none" !== t.getAttribute("stroke") ? t.parentElement && t.parentElement.removeChild(t) : (t.setAttribute("font-family", "Helvetica Neue"), t.setAttribute("font-weight", "bold")) }), n(".dcg-svg-offcenter-axis-value", function (t) { t.parentElement && t.parentElement.removeChild(t) }), n(".dcg-svg-curve", function (t) { t.setAttribute("stroke", "black"), t.setAttribute("stroke-width", "5"), t.setAttribute("stroke-opacity", "1") }), n(".dcg-svg-point", function (t) { t.setAttribute("stroke", "black"), t.setAttribute("stroke-width", "10"), t.setAttribute("stroke-opacity", "1") }), n(".dcg-svg-background", function (t) { var n = parseFloat(t.getAttribute("width")), i = parseFloat(t.getAttribute("height")), r = 3, o = e.createElementNS("http://www.w3.org/2000/svg", "path"); o.setAttribute("d", "M" + (n - r) + "," + r + "v" + (i - 2 * r) + "H" + r + "V" + r + "H" + (n - r) + " M" + n + ",0H0v" + i + "h" + n + "V0L" + n + ",0z"), t.parentElement.appendChild(o) }), n(".dcg-svg-axis-line", function (t) { t.setAttribute("stroke", "black"), t.setAttribute("stroke-width", "4"), t.setAttribute("stroke-opacity", "1") }), n(".dcg-svg-minor-gridline, .dcg-svg-major-gridline", function (t) { t.setAttribute("stroke", "black"), t.setAttribute("stroke-width", "1"), t.setAttribute("stroke-opacity", "1") }), e.firstChild.outerHTML }(e)), t.svgBlob = c.default(e), t.svgDirty = !1, t.updateIfMounted(), t.resizePreviewImg() }) } } }, m.prototype.updateBrailleEquations = function () { if (this.isExportingBraille()) { var t = u.getBrailleEquationsGraphing(this.controller.api.controller, this.brailleMode); this.brailleBlob = new Blob([t], { type: "text/plain" }) } }, m.prototype.resizePreviewImg = function () { if (this.previewImg) { var t = 1; "etc8" !== this.size && "etc11" !== this.size || (t = 2), "vpmax8" !== this.size && "vpmax11" !== this.size || (t = 1.5); var e = Math.min(this.getWidth(), 400), n = this.getHeight() / this.getWidth() * e; this.previewImg.width = e * t, this.previewImg.height = n * t } }, m.prototype.willUpdate = function () { this.updateGraphPreview(), this.updateBrailleEquations() }, m.prototype.isExportingBraille = function () { return "vpmax8" === (t = this.size) || "vpmax11" === t || "etc8" === t || "etc11" === t; var t }, m.prototype.closeSvgDropdown = function () { this.svgDropdownOpen = !1, this.updateIfMounted() }, m.prototype.toggleSvgDropdown = function () { this.svgDropdownOpen = !this.svgDropdownOpen, this.updateIfMounted() }, m }(r.Class); function E(t) { switch (t) { case "etc8": return "8.5 x 11.0"; case "etc11": return "11.5 x 11.0"; case "vpmax8": return "8.5 x 11"; case "vpmax11": return "11.5 x 11"; default: return t } } t.default = w });

define('loadcss!shared-components/shared-consent-modal', function () { });
define('shared-components/shared-consent-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "./shared-account-modal-errors", "loadcss!./shared-consent-modal", "loadcss!./shared-account-modal", "loadcss!shared-components/btn-styles"], function (require, t, n, o, e, r) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SharedConsentModal = void 0; var s = function (t) { function s() { return null !== t && t.apply(this, arguments) || this } return n.__extends(s, t), s.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller, this.openTime = Date.now(), this.formErrors = [], this.controller.logJSON("shared-consent-modal", { action: "show-consent-modal" }) }, s.prototype.template = function () { var t = this; return o.createElement(e.Modal, { title: function () { return t.i18n.s("shared-title-consent") }, size: this.const("narrow"), onClose: function () { return t.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, o.createElement("div", { class: o.const("dcg-shared-consent-modal-container dcg-shared-account-dialog") }, o.createElement("div", { class: o.const("dcg-shared-consent-contents") }, function () { return t.i18n.s("shared-message-consent-information") }), o.createElement("div", { class: o.const("dcg-shared-consent-contents") }, function () { return t.i18n.s("shared-message-consent-delete-information") }), o.createElement("div", { class: o.const("dcg-shared-modal-actions-container") }, o.createElement("span", { role: o.const("button"), tabindex: o.const("0"), class: o.const("dcg-shared-dark-gray-link"), didMount: function (n) { t.controller.wasModalOpenedWithKeyboard() && n.focus() }, onTap: function (n) { return t.openAccountSettings(n.device) } }, function () { return t.i18n.s("shared-button-go-to-account-settings") }), o.createElement("div", { role: o.const("button"), tabindex: function () { return t.isConsentingToCollection() ? -1 : 0 }, "aria-disabled": function () { return t.isConsentingToCollection() }, class: function () { return { "dcg-shared-btn-blue": !0, "dcg-disabled": t.isConsentingToCollection() } }, onTap: this.bindFn(this.consentToCollection) }, function () { return t.i18n.s("shared-button-accept") }), o.createElement(r.SharedAccountModalErrors, { controller: this.props.controller, errors: function () { return t.formErrors } })))) }, s.prototype.willUpdate = function () { this.formErrors = [], this.controller.userController.didPrivacyConsentFail() && (this.formErrors = [this.controller.getSomethingWentWrongText()]) }, s.prototype.isConsentingToCollection = function () { return this.controller.userController.isConsentingToPrivacy() }, s.prototype.didPrivacyConsentFail = function () { return this.controller.userController.didPrivacyConsentFail() }, s.prototype.openAccountSettings = function (t) { this.controller.logJSON("shared-consent-modal", { action: "edit-account", ts: Date.now() - this.openTime }), this.controller.dispatch({ type: "show-modal", modal: "account-settings", device: t }) }, s.prototype.consentToCollection = function () { this.controller.logJSON("shared-consent-modal", { action: "consent", ts: Date.now() - this.openTime }), this.controller.userController.setPrivacyConsent({ lang: this.controller.getLanguage() }), this.controller.dispatch({ type: "close-modal" }) }, s }(o.Class); t.SharedConsentModal = s });

define('text!data/list-of-countries.json', [], function () { return '[\n  "Afganistan",\n  "Albania",\n  "Algeria",\n  "American Samoa",\n  "Andorra",\n  "Angola",\n  "Anguilla",\n  "Antigua & Barbuda",\n  "Argentina",\n  "Armenia",\n  "Aruba",\n  "Australia",\n  "Austria",\n  "Azerbaijan",\n  "Bahamas",\n  "Bahrain",\n  "Bangladesh",\n  "Barbados",\n  "Belarus",\n  "Belgium",\n  "Belize",\n  "Benin",\n  "Bermuda",\n  "Bhutan",\n  "Bolivia",\n  "Bonaire",\n  "Bosnia & Herzegovina",\n  "Botswana",\n  "Brazil",\n  "British Indian Ocean Ter",\n  "Brunei",\n  "Bulgaria",\n  "Burkina Faso",\n  "Burundi",\n  "Cambodia",\n  "Cameroon",\n  "Canada",\n  "Canary Islands",\n  "Cape Verde",\n  "Cayman Islands",\n  "Central African Republic",\n  "Chad",\n  "Channel Islands",\n  "Chile",\n  "China",\n  "Christmas Island",\n  "Cocos Island",\n  "Colombia",\n  "Comoros",\n  "Congo",\n  "Cook Islands",\n  "Costa Rica",\n  "Cote DIvoire",\n  "Croatia",\n  "Cuba",\n  "Curaco",\n  "Cyprus",\n  "Czech Republic",\n  "Denmark",\n  "Djibouti",\n  "Dominica",\n  "Dominican Republic",\n  "East Timor",\n  "Ecuador",\n  "Egypt",\n  "El Salvador",\n  "Equatorial Guinea",\n  "Eritrea",\n  "Estonia",\n  "Ethiopia",\n  "Falkland Islands",\n  "Faroe Islands",\n  "Fiji",\n  "Finland",\n  "France",\n  "French Guiana",\n  "French Polynesia",\n  "French Southern Ter",\n  "Gabon",\n  "Gambia",\n  "Georgia",\n  "Germany",\n  "Ghana",\n  "Gibraltar",\n  "Great Britain",\n  "Greece",\n  "Greenland",\n  "Grenada",\n  "Guadeloupe",\n  "Guam",\n  "Guatemala",\n  "Guinea",\n  "Guyana",\n  "Haiti",\n  "Hawaii",\n  "Honduras",\n  "Hong Kong",\n  "Hungary",\n  "Iceland",\n  "Indonesia",\n  "India",\n  "Iran",\n  "Iraq",\n  "Ireland",\n  "Isle of Man",\n  "Israel",\n  "Italy",\n  "Jamaica",\n  "Japan",\n  "Jordan",\n  "Kazakhstan",\n  "Kenya",\n  "Kiribati",\n  "Korea North",\n  "Korea Sout",\n  "Kuwait",\n  "Kyrgyzstan",\n  "Laos",\n  "Latvia",\n  "Lebanon",\n  "Lesotho",\n  "Liberia",\n  "Libya",\n  "Liechtenstein",\n  "Lithuania",\n  "Luxembourg",\n  "Macau",\n  "Macedonia",\n  "Madagascar",\n  "Malaysia",\n  "Malawi",\n  "Maldives",\n  "Mali",\n  "Malta",\n  "Marshall Islands",\n  "Martinique",\n  "Mauritania",\n  "Mauritius",\n  "Mayotte",\n  "Mexico",\n  "Midway Islands",\n  "Moldova",\n  "Monaco",\n  "Mongolia",\n  "Montserrat",\n  "Morocco",\n  "Mozambique",\n  "Myanmar",\n  "Nambia",\n  "Nauru",\n  "Nepal",\n  "Netherland Antilles",\n  "Netherlands",\n  "Nevis",\n  "New Caledonia",\n  "New Zealand",\n  "Nicaragua",\n  "Niger",\n  "Nigeria",\n  "Niue",\n  "Norfolk Island",\n  "Norway",\n  "Oman",\n  "Pakistan",\n  "Palau Island",\n  "Palestine",\n  "Panama",\n  "Papua New Guinea",\n  "Paraguay",\n  "Peru",\n  "Phillipines",\n  "Pitcairn Island",\n  "Poland",\n  "Portugal",\n  "Puerto Rico",\n  "Qatar",\n  "Republic of Montenegro",\n  "Republic of Serbia",\n  "Reunion",\n  "Romania",\n  "Russia",\n  "Rwanda",\n  "St Barthelemy",\n  "St Eustatius",\n  "St Helena",\n  "St Kitts-Nevis",\n  "St Lucia",\n  "St Maarten",\n  "St Pierre & Miquelon",\n  "St Vincent & Grenadines",\n  "Saipan",\n  "Samoa",\n  "Samoa American",\n  "San Marino",\n  "Sao Tome & Principe",\n  "Saudi Arabia",\n  "Senegal",\n  "Seychelles",\n  "Sierra Leone",\n  "Singapore",\n  "Slovakia",\n  "Slovenia",\n  "Solomon Islands",\n  "Somalia",\n  "South Africa",\n  "Spain",\n  "Sri Lanka",\n  "Sudan",\n  "Suriname",\n  "Swaziland",\n  "Sweden",\n  "Switzerland",\n  "Syria",\n  "Tahiti",\n  "Taiwan",\n  "Tajikistan",\n  "Tanzania",\n  "Thailand",\n  "Togo",\n  "Tokelau",\n  "Tonga",\n  "Trinidad & Tobago",\n  "Tunisia",\n  "Turkey",\n  "Turkmenistan",\n  "Turks & Caicos Is",\n  "Tuvalu",\n  "Uganda",\n  "United Kingdom",\n  "Ukraine",\n  "United Arab Erimates",\n  "United States",\n  "Uraguay",\n  "Uzbekistan",\n  "Vanuatu",\n  "Vatican City State",\n  "Venezuela",\n  "Vietnam",\n  "Virgin Islands (Brit)",\n  "Virgin Islands (USA)",\n  "Wake Island",\n  "Wallis & Futana Is",\n  "Yemen",\n  "Zaire",\n  "Zambia",\n  "Zimbabwe"\n]\n'; });


define('loadcss!dcgview-helpers/searchable-dropdown', function () { });
define('dcgview-helpers/searchable-dropdown', ["require", "exports", "tslib", "dcgview", "keys", "lib/aria", "loadcss!./searchable-dropdown"], function (require, t, e, o, n, i) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var s = o.Components, r = s.If, c = s.For, u = s.Input, a = function (t) { function s() { var e = null !== t && t.apply(this, arguments) || this; return e.filter = void 0, e.focusLocation = void 0, e.lastResultCount = 0, e } return e.__extends(s, t), s.prototype.template = function () { var t = this; return o.createElement("div", { class: o.const("dcg-search-container"), onKeydown: this.bindFn(this.onKeydown) }, o.createElement(r, { predicate: this.props.renderWithInput }, function () { return o.createElement("div", { role: o.const("search"), class: o.const("dcg-searchable-dropdown") }, o.createElement(u, { didMount: t.bindFn(t.didMountInput), onInput: t.bindFn(t.onInputChange), value: t.bindFn(t.getFilterString), placeholder: function () { return t.props.placeholder() }, manageFocus: t.const({ shouldBeFocused: t.bindFn(t.shouldFilterBeFocused), onFocusedChanged: t.bindFn(t.onFilterFocusChange) }) }), o.createElement(r, { predicate: function () { return t.shouldShowDeleteX() } }, function () { return o.createElement("div", { class: o.const("dcg-remove-x dcg-do-not-blur") }, o.createElement("span", { class: o.const("dcg-icon-remove"), onTap: t.bindFn(t.onDeleteXTapped) })) })) }), o.createElement(r, { predicate: function () { return t.getFilteredOptions().length > 0 } }, function () { return o.createElement("div", { class: o.const("dcg-searchable-dropdown-list-container") }, o.createElement(c, { each: function () { return t.getFilteredOptions() }, key: function (t) { return t.id + "-" + t.label } }, o.createElement("div", { class: function () { return { "dcg-searchable-dropdown-list": !0, "dcg-do-not-blur": !0, "dcg-no-input": !t.props.renderWithInput() } }, role: o.const("listbox"), "aria-label": o.const("Results") }, function (e) { return o.createElement("div", { class: o.const("dcg-searchable-dropdown-option"), role: o.const("option"), onTap: function (o) { return t.selectOption(e, "keyboard" === o.device) }, manageFocus: t.const({ shouldBeFocused: function () { return t.shouldOptionBeFocused(e) }, onFocusedChanged: function (o) { return t.onOptionFocusChange(e, o) } }), tabindex: o.const(0) }, t.const(e.label)) }))) }), o.createElement(r, { predicate: function () { return 0 === t.getFilteredOptions().length } }, function () { return o.createElement("div", { class: o.const("dcg-searchable-dropdown-list dcg-no-search-results") }, o.const("No results.")) })) }, s.prototype.didMountInput = function () { this.focusFilter() }, s.prototype.shouldShowDeleteX = function () { return !!this.getFilterString() }, s.prototype.onDeleteXTapped = function () { this.filter = void 0, this.focusFilter(), this.update() }, s.prototype.shouldFilterBeFocused = function () { return this.focusLocation && "filter" === this.focusLocation.type }, s.prototype.onFilterFocusChange = function (t) { t ? this.focusFilter() : (this.filter = void 0, this.focusLocation = void 0, this.update()) }, s.prototype.shouldOptionBeFocused = function (t) { return this.focusLocation && "option" === this.focusLocation.type && this.focusLocation.id === t.id }, s.prototype.focusFilter = function () { this.focusLocation = { type: "filter" }, this.update() }, s.prototype.focusOption = function (t) { this.focusLocation = { type: "option", id: t.id }, this.update() }, s.prototype.getFocusedOptionIndex = function () { if (!this.focusLocation) return -1; if ("option" !== this.focusLocation.type) return -1; for (var t = this.focusLocation.id, e = this.getFilteredOptions(), o = 0; o < e.length; o++) { if (e[o].id === t) return o } return -1 }, s.prototype.onOptionFocusChange = function (t, e) { e ? this.focusOption(t) : (this.focusLocation = void 0, this.update()) }, s.prototype.onKeydown = function (t) { switch (n.lookup(t)) { case n.ENTER: if (this.shouldFilterBeFocused()) { var e = this.getFilteredOptions(); 1 === e.length && this.selectOption(e[0], !0) } break; case n.UP: this.moveFocusInDirection(-1) && t.preventDefault(); break; case n.DOWN: this.moveFocusInDirection(1) && t.preventDefault(); break; case n.HOME: t.preventDefault(), this.focusFirstOption(); break; case n.END: t.preventDefault(), this.focusLastOption(); break; case n.ESCAPE: this.props.onCancel(); break; case n.TAB: t.shiftKey ? this.moveFocusInDirection(-1) && t.preventDefault() : this.moveFocusInDirection(1) && t.preventDefault() } }, s.prototype.moveFocusInDirection = function (t) { var e = this.getFilteredOptions(), o = this.getFocusedOptionIndex() + t; if (-1 == o && this.props.renderWithInput()) return this.focusFilter(), !0; var n = e[o]; return !!n && (this.focusOption(n), !0) }, s.prototype.focusFirstOption = function () { var t = this.getFilteredOptions(); 0 !== t.length && this.focusOption(t[0]) }, s.prototype.focusLastOption = function () { var t = this.getFilteredOptions(); 0 !== t.length && this.focusOption(t[t.length - 1]) }, s.prototype.onInputChange = function (t) { this.filter = t, this.update() }, s.prototype.getFilterString = function () { return this.filter || "" }, s.prototype.selectOption = function (t, e) { this.filter = void 0, this.focusLocation = void 0, this.update(), this.props.onChange({ value: t.id, fromKeyboard: e }) }, s.prototype.getFilteredOptions = function () { var t = this.props.options(), e = (this.filter || "").toLowerCase().trim(); return e && (t = t.filter(function (t) { return -1 !== t.label.toLowerCase().indexOf(e) })), t }, s.prototype.onUpdate = function () { var t = this.getFilteredOptions().length; if (this.focusLocation && "filter" === this.focusLocation.type && t !== this.lastResultCount) switch (t) { case 0: i.alert("No results"); break; case 1: i.alert("1 result"); break; default: i.alert(t + " results") }this.lastResultCount = t }, s }(o.Class); t.default = a });
define('main/account_backend', ["require", "exports", "jquery", "./backend"], function (require, n, t, e) { "use strict"; function r() { return e.post("/account/logout_xhr") } function o(n) { return e.getJSON("/account/user_info", n) } Object.defineProperty(n, "__esModule", { value: !0 }), n.submitArtContestEntry = n.setPrivacyConsent = n.updateFeatureFlags = n.setEmail = n.initiateEmailChange = n.initiateAccountDeletion = n.recoverPassword = n.setNameDetail = n.setName = n.registerUser = n.checkPendingDeletion = n.askServerIfLoggedIn = n.getUserInfo = n.fetchUser = n.logout = void 0, n.logout = r, n.fetchUser = function (n) { var t = function () { return e.post("/account/login_xhr", n) }; return r().then(t, t).then(function () { return o({ lang: n.lang }) }) }, n.getUserInfo = o, n.askServerIfLoggedIn = function () { var n = t.Deferred(); return e.getJSON("/account/user_info?no401").then(function (t) { t && !1 === t.loggedIn ? n.reject(t) : n.resolve(t) }, function (t) { n.reject(t) }), n.promise() }, n.checkPendingDeletion = function (n) { return e.post("/account/check_account_status", n) }, n.registerUser = function (n) { return e.post("/account/register_xhr", n).then(function () { return o({ lang: n.lang }) }) }, n.setName = function (n) { return e.post("/account/change_name", n).then(function () { return o({ lang: n.lang }) }) }, n.setNameDetail = function (n) { return e.post("/account/change_name_detail", { lang: n.lang, userProvidedName: { given: n.given, family: n.family } }).then(function () { return o({ lang: n.lang }) }) }, n.recoverPassword = function (n) { return e.post("/account/recover_xhr", n) }, n.initiateAccountDeletion = function (n) { return e.getJSON("/account/initiate_delete_account", n) }, n.initiateEmailChange = function (n) { return e.getJSON("/account/initiate_email_change", n) }, n.setEmail = function (n) { return e.post("/account/set_email", n).then(function () { return o({ lang: n.lang }) }) }, n.updateFeatureFlags = function (n) { return e.postJSON("/account/update_feature_flags", n).then(function () { return o({ lang: n.lang }) }) }, n.setPrivacyConsent = function (n) { return e.post("/account/set_privacy_consent", n).then(function () { return o({ lang: n.lang }) }) }, n.submitArtContestEntry = function (n) { return e.post("/account/submit_art_contest_entry", n) } });

define('loadcss!calculator-shell/contest-submission-dialog', function () { });
define('calculator-shell/contest-submission-dialog', ["require", "exports", "text!data/list-of-countries.json", "tslib", "dcgview", "analytics/looker", "../dcgview-helpers/searchable-dropdown", "dcgview-helpers/checkbox", "lib/aria", "./modal", "main/account_backend", "shared/dcgviews/localize", "loadcss!spinner", "loadcss!./contest-submission-dialog"], function (require, t, e, n, o, s, r, i, c, a, l, u) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); for (var d = o.Components, h = d.If, g = d.IfElse, m = d.Input, p = d.SwitchUnion, f = d.Textarea, b = JSON.parse(e).map(function (t) { return { id: t, label: t } }), y = [], v = 2020; v >= 1900; v--)y.push({ id: v + "", label: v + "" }); var S = { China: 14, "Hong Kong": 18, India: 18, Indonesia: 18, Phillipines: 18, Russia: 18, Austria: 14, Belgium: 13, Bulgaria: 14, Croatia: 16, Cyprus: 14, "Czech Republic": 15, Denmark: 13, Estonia: 13, Finland: 13, France: 15, Germany: 16, Greece: 15, Hungary: 16, Ireland: 16, Italy: 14, Latvia: 13, Lithuania: 14, Luxembourg: 16, Malta: 13, Netherlands: 16, Norway: 13, Poland: 16, Portugal: 13, Romania: 16, Slovakia: 16, Slovenia: 15, Spain: 14, Sweden: 13, Switzerland: 16, "United Kingdom": 13, Canada: 13, "United States": 13 }, E = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return n.__extends(e, t), e.prototype.didUnmount = function () { this.unmounted = !0 }, e.prototype.init = function () { this.controller = this.props.controller(), this.selectedData = {}, this.userOwnsGraph = !1, this.isSubmittingEntry = !1, this.isVerifyingEligility = !1, this.controller.state.artContestURLFromShareMenu && (this.overwriteGraphURL = this.controller.state.artContestURLFromShareMenu, this.controller.state.artContestURLFromShareMenu = void 0), s.logJSON("art-contest::open-modal", { from: this.overwriteGraphURL ? "share" : "top-bar" }) }, e.prototype.getScreen = function () { return this.shouldShowSaveAnimation() ? "saving" : this.shouldShowSaveFailed() ? "save-failed" : this.didSubmissionFail ? "submit-failed" : this.isSubmittingEntry ? "submitting" : this.didSubmissionSucceed ? "submitted" : this.isVerifyingEligility || this.userOwnsGraph && this.isLoggedIn() ? "form" : "ask-intention" }, e.prototype.template = function () { var t = this; return o.createElement(a.Modal, { controller: this.props.controller }, o.createElement("div", { class: o.const("dcg-contest-submission-dialog") }, p(function () { return t.getScreen() }, { saving: function () { return o.createElement("div", { class: o.const("dcg-save-animation-container") }, o.createElement("div", { class: o.const("dcg-saving") }, o.createElement("div", { class: o.const("dcg-save-animation"), "aria-live": o.const("polite"), "aria-atomic": o.const("true") }, o.createElement("span", { class: o.const("dcg-spinner") }), function () { return t.controller.s("account-shell-label-saving-graph") }))) }, "save-failed": function () { return o.createElement("div", { class: o.const("dcg-save-animation-container") }, o.createElement("div", { class: o.const("dcg-saving") }, o.createElement("div", { class: o.const("dcg-save-animation"), "aria-live": o.const("polite"), "aria-atomic": o.const("true") }, function () { return t.controller.s("account-shell-error-save-art-contest") }))) }, submitting: function () { return o.createElement("div", { class: o.const("dcg-save-animation-container") }, o.createElement("div", { class: o.const("dcg-saving") }, o.createElement("div", { class: o.const("dcg-save-animation"), "aria-live": o.const("polite"), "aria-atomic": o.const("true") }, o.createElement("span", { class: o.const("dcg-spinner") }), function () { return t.controller.s("account-shell-label-submitting") }))) }, "submit-failed": function () { return o.createElement("div", { class: o.const("dcg-save-animation-container") }, o.createElement("div", { class: o.const("dcg-saving") }, o.createElement("div", { class: o.const("dcg-save-animation"), "aria-live": o.const("polite"), "aria-atomic": o.const("true") }, function () { return t.controller.s("account-shell-error-submitting") }))) }, submitted: function () { return o.createElement("div", { class: o.const("dcg-save-animation-container") }, o.createElement("div", { class: o.const("dcg-art-contest-success-image") }, o.createElement("img", { src: o.const("/assets/img/contest/submitted.jpg"), alt: function () { return t.controller.s("account-shell-text-alt-text-success") } })), o.createElement("div", { class: o.const("dcg-save-success"), "aria-live": o.const("polite"), "aria-atomic": o.const("true") }, function () { return t.controller.s("account-shell-label-submission-received") }, o.createElement("div", { class: o.const("dcg-save-animation-content") }, o.createElement("div", null, o.createElement("div", { class: o.const("dcg-congrats-message") }, o.createElement(u.Localize, { i18n: t.const(t.controller), key: t.const("account-shell-text-art-contest-success-paragraph") }, o.const("If you'd like to revise your submission, feel free to resubmit anytime before"), o.createElement("span", { class: o.const("bold-text") }, o.const(" January 15th")), o.const(". We'll only look at the most recent submission."))), o.createElement("div", { class: o.const("dcg-congrats-message") }, function () { return t.controller.s("account-shell-text-art-contest-congratulations") }))))) }, "ask-intention": function () { return o.createElement("div", { class: o.const("dcg-art-contest-info-container") }, o.createElement("div", { class: o.const("dcg-art-contest-world-image") }, o.createElement("img", { src: o.const("/assets/img/contest/world.jpg"), alt: function () { return t.controller.s("account-shell-text-alt-text-art-contest") } })), o.createElement("div", { class: o.const("dcg-contest-about") }, o.createElement("div", { role: o.const("heading"), "aria-level": o.const("1"), class: o.const("dcg-contest-submission-title") }, function () { return t.controller.s("account-shell-heading-math-art-contest") }), o.createElement("div", { class: o.const("dcg-contest-text") }, o.createElement(u.Localize, { i18n: t.const(t.controller), key: t.const("account-shell-text-art-contest-about-paragraph") }, o.const("Want to share your awesome graph with the world? Students ages 13+ can enter the Desmos Global Math Art Contest before"), o.createElement("span", { class: o.const("bold-text") }, o.const(" January 15th ")), o.const("for a chance to be featured on our website and win other prizes!"), o.const(" "), o.createElement("a", { class: o.const("dcg-shared-blue-link dcg-learn-more-link"), href: function () { return t.getBlogPostURL() }, target: o.const("_blank"), didMount: function (t) { return t.focus() } }, o.const("Learn more")))), o.createElement("div", null, o.createElement("div", { class: function () { return { "dcg-btn-blue": !0, "dcg-submit-this-graph-btn": !0, "dcg-disabled": t.shouldDisableSubmitThisGraph() } }, onTap: t.bindFn(t.chooseSubmitThisGraph), tabindex: o.const(0), role: o.const("button") }, function () { return t.controller.s("account-shell-button-submit-graph") }), o.createElement(h, { predicate: function () { return !!t.getCannotSubmitReason() } }, function () { return o.createElement("div", { class: o.const("dcg-login-notice") }, function () { return t.getCannotSubmitReason() }) }), o.createElement("div", { class: o.const("age-check-container") }, function () { return t.controller.s("account-shell-text-contest-under-16") }, o.const(" "), o.createElement("a", { class: o.const("dcg-shared-blue-link"), onTap: t.bindFn(t.chooseVerifyEligibility) }, function () { return t.controller.s("account-shell-text-contest-verify-eligibility") })), o.createElement("div", { class: o.const("dcg-submit-for-others") }, function () { return t.controller.s("account-shell-text-contest-submit-by-teacher") }, o.const(" "), o.createElement("a", { class: o.const("dcg-shared-blue-link"), href: function () { return t.getABActivityURL() }, target: o.const("_blank") }, function () { return t.controller.s("account-shell-button-create-own-activity") }))))) }, form: function () { return o.createElement("div", null, o.createElement("div", { role: o.const("heading"), "aria-level": o.const("1"), class: o.const("dcg-contest-submission-title") }, function () { return t.controller.s("account-shell-heading-submit-graph") }), o.createElement("div", { class: o.const("dcg-submission-form") }, o.createElement("div", { class: o.const("dcg-country-and-year") }, o.createElement("div", { class: o.const("dcg-form-section") }, o.createElement("div", { class: o.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-country") }), o.createElement(h, { predicate: function () { return !!t.getSelectedCountry() } }, function () { return o.createElement("span", { class: o.const("dcg-shared-blue-link dcg-clear-country"), onTap: function () { return t.setSelectedCountry(void 0) }, tabindex: o.const(0), role: o.const("button"), "aria-label": function () { return t.controller.s("account-shell-narration-clear-selected-country") } }, function () { return t.controller.s("account-shell-button-clear") }) }), g(function () { return !!t.getSelectedCountry() }, { true: function () { return o.createElement("div", { class: o.const("dcg-your-country-name") }, function () { return t.getSelectedCountry() }) }, false: function () { return o.createElement(r.default, { options: function () { return t.getListOfCountries() }, onChange: function (e) { return t.setSelectedCountry(e.value) }, onCancel: function () { return t.setSelectedCountry(void 0) }, renderWithInput: function () { return !0 }, placeholder: function () { return t.controller.s("account-shell-label-country-placeholder") } }) } })), o.createElement(h, { predicate: function () { return t.shouldShowAgeOptions() } }, function () { return o.createElement("div", { class: o.const("dcg-form-section") }, o.createElement("div", { class: o.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-birth-year") }), g(function () { return !!t.getSelectedYear() }, { true: function () { return o.createElement("div", { class: o.const("dcg-your-birth-year") }, function () { return t.getSelectedYear() }) }, false: function () { return o.createElement(r.default, { options: function () { return t.getListOfYears() }, onChange: function (e) { return t.setSelectedYear(e.value) }, onCancel: function () { return t.setSelectedYear(void 0) }, renderWithInput: function () { return !0 }, placeholder: function () { return t.controller.s("account-shell-label-birth-year-placeholder") } }) } })) })), o.createElement(h, { predicate: function () { return t.shouldShowEligible() && !t.getCannotSubmitReason() } }, function () { return o.createElement("div", { class: o.const("dcg-eligible-message dcg-teal-notice") }, o.const("ð "), function () { return t.controller.s("account-shell-label-you-are-eligible") }) }), o.createElement(h, { predicate: function () { return t.shouldShowConsentOptions() } }, function () { return o.createElement("div", null, o.createElement("div", { class: o.const("dcg-form-section") }, o.createElement("div", { class: o.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-name-email") }), o.createElement(m, { class: t.const("dcg-shared-input-blue-outline"), onInput: function (e) { return t.setUserName(e) }, value: t.bindFn(t.getUserName), placeholder: function () { return t.controller.s("account-shell-label-full-name") }, disabled: function () { return !1 } }), o.createElement(m, { class: t.const("dcg-shared-input-blue-outline"), onInput: function (e) { return t.setUserEmail(e) }, value: t.bindFn(t.getUserEmail), placeholder: function () { return t.controller.s("account-shell-label-email-address") }, disabled: function () { return !1 } })), o.createElement("div", { class: o.const("dcg-form-section") }, o.createElement("div", { class: o.const("dcg-section-title") }, function () { return t.controller.s("account-shell-heading-artist-statement") }), o.createElement("div", { class: o.const("dcg-section-subtitle") }, function () { return t.controller.s("account-shell-label-artiist-statement-description") }), o.createElement(f, { class: t.const("dcg-shared-input-blue-outline dcg-artist-statement-input"), onInput: function (e) { return t.setArtistStatement(e) }, value: t.bindFn(t.getArtistStatement), maxlength: t.const(900), placeholder: function () { return t.controller.s("account-shell-label-artist-statement-placeholder") } })), o.createElement(i.Checkbox, { checked: t.bindFn(t.getConsentTicked), onChange: t.bindFn(t.toggleConsent), ariaLabel: function () { return t.controller.s("account-shell-text-art-contest-copyright-agreement") } }, function () { return t.controller.s("account-shell-text-art-contest-copyright-agreement") }), o.createElement("div", { class: function () { return { "dcg-btn-blue": !0, "dcg-disabled": t.isSubmitButtonDisabled(), "dcg-submit-this-graph-btn": !0 } }, onTap: t.bindFn(t.submitEntry), tabindex: o.const(0) }, function () { return t.controller.s("account-shell-button-submit-graph") })) }), o.createElement(h, { predicate: function () { return t.shouldShowEligible() && !!t.getCannotSubmitReason() } }, function () { return o.createElement("div", { class: o.const("dcg-login-notice dcg-teal-notice") }, o.const("ð "), function () { return t.controller.s("account-shell-label-you-are-eligible") }, o.const(" "), function () { return t.getCannotSubmitReason() }) }), o.createElement(h, { predicate: function () { return t.shouldShowIneligible() } }, function () { return o.createElement("div", { class: o.const("dcg-ineligible-container") }, o.createElement("i", { class: o.const("dcg-icon-error"), "aria-hidden": o.const("true") }), o.createElement(u.Localize, { i18n: t.const(t.controller), key: t.const("account-shell-text-artcontest-ineligible") }, o.createElement("div", { class: o.const("dcg-ineligible-text-container") }, o.createElement("div", { class: o.const("dcg-ineligible-text") }, o.const("Based on your age and location, we arenât able to accept a graph submission from you this year. Save it for another year, or ask your teacher to assign the art contest activity.")), o.createElement("div", { class: o.const("dcg-ineligible-text") }, o.const("Keep up the awesome graphing!"))))) }))) } }))) }, e.prototype.getABActivityURL = function () { return "https://teacher.desmos.com/activitybuilder/custom/618be410b284c40a2c7b9111" }, e.prototype.getBlogPostURL = function () { return "https://help.desmos.com/hc/en-us/articles/4413417019533" }, e.prototype.returnToOpeningScreen = function () { this.isVerifyingEligility = !1, this.userOwnsGraph = !1, this.selectedData = { email: this.selectedData.email, name: this.selectedData.name }, this.update() }, e.prototype.getGraphURL = function () { if (this.overwriteGraphURL) return this.overwriteGraphURL; var t = this.controller.graphsController.currentGraph; return "https://www.desmos.com/calculator/" + (t && t.hash || "") }, e.prototype.overwriteEntry = function () { this.selectedData.overwrite = !0, this.submitEntry() }, e.prototype.submitEntry = function () { var t = this; if (!this.isSubmitButtonDisabled()) { this.didSubmissionFail = !1, this.isSubmittingEntry = !0; var e = { name: this.getUserName(), email: this.getUserEmail(), url: this.getGraphURL(), year: this.getSelectedYear(), ageGroup: this.getSelectedAgeGroup(), country: this.getSelectedCountry(), artistStatement: this.getArtistStatement(), overwrite: !0, lang: this.controller.getLanguage() }; this.update(), s.logJSON("art-contest::submit-sending", e), l.submitArtContestEntry(e).done(function (e) { e.previousSubmissionURL || (e.success ? (t.didSubmissionSucceed = !0, s.logJSON("art-contest::submit-success", {})) : (t.didSubmissionFail = !0, s.logJSON("art-contest::submit-failed", {}), c.alert(t.controller.s("account-shell-error-submitting")))) }).fail(function () { c.alert(t.controller.s("account-shell-error-submitting")), t.didSubmissionFail = !0, s.logJSON("art-contest::submit-failed", {}) }).always(function () { t.isSubmittingEntry = !1, t.unmounted || t.update() }) } }, e.prototype.shouldShowSaveAnimation = function () { return !!this.saveInProgress }, e.prototype.shouldShowSaveFailed = function () { return !!this.didSaveFail }, e.prototype.chooseVerifyEligibility = function () { this.isVerifyingEligility = !0, this.update() }, e.prototype.chooseSubmitThisGraph = function () { var t = this; if (!this.shouldDisableSubmitThisGraph()) { if (this.isVerifyingEligility = !1, this.overwriteGraphURL || !this.controller.graphsController.hasUnsavedChanges()) return this.userOwnsGraph = !0, this.update(), void s.logJSON("art-contest::choose-form", {}); this.saveInProgress = !0, s.logJSON("art-contest::save-sending", {}), this.update(), this.controller.graphsController.shareGraph().done(function (e) { t.didSaveFail = !1, t.saveInProgress = !1, t.userOwnsGraph = !0, t.overwriteGraphURL = "https://www.desmos.com/calculator/" + e.hash, s.logJSON("art-contest::save-success", { url: t.overwriteGraphURL }) }).fail(function () { t.didSaveFail = !0, s.logJSON("art-contest::save-failed", {}) }).always(function () { t.saveInProgress = !1, t.unmounted || t.update() }) } }, e.prototype.isLoggedIn = function () { return this.controller.isLoggedIn() }, e.prototype.getCannotSubmitReason = function () { return this.isLoggedIn() ? this.controller.isGraphComplexEnoughForContest() ? "" : this.controller.s("account-shell-text-art-contest-notice-default") : this.controller.s("account-shell-text-art-contest-notice-login") }, e.prototype.shouldDisableSubmitThisGraph = function () { return !!this.getCannotSubmitReason() }, e.prototype.shouldShowSubmissionOptions = function () { return !this.isVerifyingEligility && (!this.userOwnsGraph || !this.isLoggedIn()) }, e.prototype.shouldShowCountryOptions = function () { return !this.shouldShowSubmissionOptions() }, e.prototype.shouldShowAgeOptions = function () { return !!this.shouldShowCountryOptions() && !!this.getSelectedCountry() }, e.prototype.shouldShowIneligible = function () { return !!this.getSelectedCountry() && (!!this.getSelectedYear() && !this.isSubmissionEligible()) }, e.prototype.shouldShowEligible = function () { return !!this.isVerifyingEligility && this.isSubmissionEligible() }, e.prototype.setArtistStatement = function (t) { this.selectedData.artistStatement = t, this.update() }, e.prototype.setSelectedYear = function (t) { this.selectedData.year !== t && (this.selectedData.year = t, this.update(), s.logJSON("art-contest::select-year", { year: t })) }, e.prototype.setSelectedCountry = function (t) { this.selectedData = { country: t, name: this.controller.userController.name, email: this.controller.userController.email }, this.update(), s.logJSON("art-contest::select-country", { country: t }) }, e.prototype.getArtistStatement = function () { return this.selectedData.artistStatement || "" }, e.prototype.getSelectedCountry = function () { return this.selectedData.country }, e.prototype.getSelectedYear = function () { return this.selectedData.year }, e.prototype.getUserAgeInYears = function () { return 2021 - parseFloat(this.selectedData.year || "") }, e.prototype.getSelectedAgeGroup = function () { var t = this.getUserAgeInYears(); return t >= 19 ? "19+" : t >= 17 ? "17-18" : t >= 15 ? "15-16" : t >= 13 ? "13-14" : "" }, e.prototype.getUserName = function () { return this.selectedData.name || "" }, e.prototype.setUserName = function (t) { this.selectedData.name = t, this.update() }, e.prototype.getUserEmail = function () { return this.selectedData.email || "" }, e.prototype.setUserEmail = function (t) { this.selectedData.email = t, this.update() }, e.prototype.getConsentTicked = function () { return !!this.selectedData.consent }, e.prototype.getOverwriteTicked = function () { return !!this.selectedData.overwrite }, e.prototype.toggleConsent = function () { this.selectedData.consent = !this.selectedData.consent, this.update(), s.logJSON("art-contest::toggle-consent", { consent: this.selectedData.consent }) }, e.prototype.isSubmitButtonDisabled = function () { return !!this.isSubmittingEntry || (!this.selectedData.country || (!this.selectedData.year || (!this.selectedData.email || (!this.selectedData.artistStatement || (!this.selectedData.name || !this.selectedData.consent))))) }, e.prototype.isSubmissionEligible = function () { if (!this.selectedData.country) return !1; if (!this.selectedData.year) return !1; var t = S[this.selectedData.country] || 16; return this.getUserAgeInYears() >= t }, e.prototype.shouldShowConsentOptions = function () { return (!this.isVerifyingEligility || !this.getCannotSubmitReason()) && this.isSubmissionEligible() }, e.prototype.getListOfCountries = function () { return b }, e.prototype.getListOfYears = function () { return y }, e }(o.Class); t.default = E });
define('shared-components/shared-account-reenabled-modal', ["require", "exports", "tslib", "dcgview", "shared-components/modal", "loadcss!./shared-account-modal"], function (require, e, t, n, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SharedAccountReenabledModal = void 0; var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.init = function () { this.controller = this.props.controller(), this.i18n = this.controller }, r.prototype.template = function () { var e = this; return n.createElement(o.Modal, { title: function () { return e.i18n.s("shared-title-account-reactivated") }, size: this.const("narrow"), showX: this.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: this.props.controller }, n.createElement("div", { class: n.const("dcg-shared-recover-password-dialog dcg-shared-account-dialog") }, n.createElement("div", { class: n.const("dcg-shared-account-paragraph") }, function () { return e.i18n.s("shared-message-account-reactivated") }), n.createElement("div", { class: n.const("dcg-shared-modal-actions-container") }, n.createElement("button", { class: function () { return { "dcg-shared-btn-blue": !0 } }, onTap: function () { return e.controller.dispatch({ type: "close-modal" }) }, didMount: function (t) { e.controller.wasModalOpenedWithKeyboard() && t.focus() } }, function () { return e.i18n.s("shared-button-continue-to-desmos") })))) }, r }(n.Class); e.SharedAccountReenabledModal = r });

define('loadcss!calculator-shell/advanced-settings', function () { });
define('calculator-shell/advanced-settings', ["require", "exports", "tslib", "dcgview", "../shared-components/shared-checkbox", "../shared-components/shared-account-modal-errors", "bugsnag", "underscore", "loadcss!./advanced-settings"], function (require, e, t, r, n, o, s, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.AdvancedSettings = void 0; var c = r.Components, i = c.IfDefined, l = c.For, u = { "dcg-actions": { label: "account-shell-label-feature-flag-actions", description: "account-shell-text-feature-flag-actions-description", learnMoreLink: "https://help.desmos.com/hc/en-us/articles/4407725009165" } }, d = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.init = function () { this.formErrors = [] }, c.prototype.template = function () { var e = this; return r.createElement("div", { class: r.const("dcg-advanced-settings") }, r.createElement("div", { class: r.const("dcg-shared-account-paragraph") }, function () { return e.props.controller().s("account-shell-text-advanced-preferences-instructions") }), r.createElement(l, { each: function () { return a.keys(u) } }, r.createElement("div", { class: r.const("dcg-feature-flag-list") }, function (t) { return r.createElement("div", null, r.createElement(n.SharedCheckbox, { ariaLabel: function () { return e.label(t) }, checked: function () { return e.isFeatureFlagEnabled(t) }, disabled: function () { return !!e.updateInFlight }, onChange: function (r) { return e.toggleFeatureFlag(t, r) } }, r.createElement("span", { class: r.const("dcg-feature-flag-label") }, function () { return e.label(t) })), r.createElement("div", { class: r.const("dcg-feature-flag-description") }, function () { return e.description(t) }, r.const(" "), r.createElement("a", { href: function () { return e.learnMoreLink(t) }, class: r.const("dcg-shared-blue-link"), target: r.const("_blank") }, function () { return e.props.controller().s("graphing-calculator-link-learn-more") }))) })), r.createElement(o.SharedAccountModalErrors, { controller: this.props.controller, errors: function () { return e.formErrors } }), i(this.bindFn(this.getSaveProgress), function (t) { return r.createElement("span", { "aria-live": r.const("assertive"), "aria-atomic": r.const("true"), class: r.const("dcg-shared-confirmation-message") }, r.createElement("i", { class: function () { return { "dcg-shared-icon-check": !0, "dcg-success-marker": !0, "dcg-saving": "saving" === t() } }, "aria-hidden": r.const("true") }), function () { return "saving" === t() ? e.props.controller().s("shared-calculator-label-saving") : e.props.controller().s("shared-message-information-saved") }) })) }, c.prototype.getSaveProgress = function () { return this.updateInFlight ? "saving" : this.showSuccessConfirmation ? "saved" : void 0 }, c.prototype.isFeatureFlagEnabled = function (e) { return this.updateInFlight && e in this.updateInFlight ? this.updateInFlight[e] : -1 !== this.props.controller().userController.getFeatureFlags().indexOf(e) }, c.prototype.toggleFeatureFlag = function (e, t) { var r, n = this; this.updateInFlight = ((r = {})[e] = t, r), this.props.controller().dispatch({ type: "render" }), this.props.controller().userController.updateFeatureFlags({ featureFlagsUpdate: this.updateInFlight, lang: this.props.controller().getLanguage() }).then(function () { n.showSuccessConfirmation = !0, setTimeout(function () { n.showSuccessConfirmation = !1, n.props.controller().dispatch({ type: "render" }) }, 3e3) }).fail(function (e) { s.notify(e), n.formErrors = [n.props.controller().s("account-shell-error-unknown")] }).always(function () { n.updateInFlight = void 0, n.props.controller().dispatch({ type: "render" }) }) }, c.prototype.learnMoreLink = function (e) { return u[e].learnMoreLink }, c.prototype.label = function (e) { return this.props.controller().s(u[e].label) }, c.prototype.description = function (e) { return this.props.controller().s(u[e].description) }, c }(r.Class); e.AdvancedSettings = d });

define('loadcss!calculator-shell/delete-modal', function () { });
define('calculator-shell/delete-modal', ["require", "exports", "tslib", "dcgview", "../lib/fluent-bundle-sequence", "../shared-components/modal", "loadcss!./delete-modal"], function (require, e, t, n, r, o) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.DeleteModal = void 0; var l = n.Components.IfDefined, s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.init = function () { this.controller = this.props.controller(), this.graphsController = this.controller.graphsController }, s.prototype.template = function () { var e = this; return n.createElement(o.Modal, { size: this.const("narrow"), onClose: function () { e.controller.dispatch({ type: "close-modal" }) }, i18n: this.const(this.controller), title: function () { return e.controller.s("account-shell-label-delete-graph-modal-title") }, class: this.const("dcg-delete-modal") }, n.createElement("div", { class: n.const("dcg-delete-modal-contents") }, n.createElement("div", { class: n.const("dcg-delete-confirmation-message") }, this.bindFn(this.getConfirmationMessage)), l(function () { return e.errorMessage }, function (e) { return n.createElement("div", { class: n.const("dcg-error-message") }, e) }), n.createElement("div", { class: n.const("dcg-action-buttons") }, n.createElement("span", { class: n.const("dcg-shared-dark-gray-link"), role: n.const("button"), tabindex: n.const("0"), "aria-label": function () { return e.controller.s("account-shell-button-cancel") }, onTap: function () { return e.controller.dispatch({ type: "close-modal" }) } }, function () { return e.controller.s("account-shell-button-cancel") }), n.createElement("div", { class: function () { return { "dcg-shared-btn-red dcg-action-delete": !0, "dcg-disabled": !!e.deleteInProgress } }, role: n.const("button"), tabindex: function () { return e.deleteInProgress ? -1 : 0 }, "aria-label": this.bindFn(this.getButtonText), "aria-disabled": function () { return !!e.deleteInProgress }, onTap: this.bindFn(this.deleteGraph) }, this.bindFn(this.getButtonText))))) }, s.prototype.deleteGraph = function () { var e = this; this.deleteInProgress = !0, this.graphsController._deleteGraph(this.graphsController.currentGraph).done(function () { e.graphsController.clearGraphByUserAction(), e.controller.dispatch({ type: "close-modal" }) }).fail(function () { e.deleteInProgress = !1, e.errorMessage = e.controller.s("account-shell-error-deletion-error"), e.controller.dispatch({ type: "render" }) }) }, s.prototype.getConfirmationMessage = function () { return this.controller.s("account-shell-text-delete-graphs-confirmation", { count: this.getGraphCount(), title: this.getTitle() }) }, s.prototype.getButtonText = function () { return this.controller.s("account-shell-button-confirm-delete", { count: this.getGraphCount() }) }, s.prototype.getGraphCount = function () { return new r.LocalizableNumericValue(1) }, s.prototype.getTitle = function () { return this.graphsController.getCurrentGraphTitle() || this.graphsController.getUntitledString() }, s }(n.Class); e.DeleteModal = s });

define('loadcss!modals', function () { });
define('calculator-shell/modals', ["require", "exports", "tslib", "dcgview", "./save-dialog", "shared-components/shared-signup-modal", "shared-components/shared-login-modal", "shared-components/shared-recover-password-modal", "./hotkeys-dialog", "./unsupported-browser", "shared-components/shared-account-settings-modal", "shared-components/shared-change-email-modal", "./export-image-dialog", "shared-components/shared-consent-modal", "./contest-submission-dialog", "shared-components/modal", "shared-components/shared-account-reenabled-modal", "./advanced-settings", "./delete-modal", "loadcss!modals"], function (require, e, o, t, n, r, l, c, a, s, i, d, p, u, m, h, g, f, E) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Modals = void 0; var v = t.Components, b = v.If, y = v.SwitchUnion, M = function (e) { function v() { return null !== e && e.apply(this, arguments) || this } return o.__extends(v, e), v.prototype.init = function () { this.controller = this.props.controller() }, v.prototype.template = function () { var e = this; return y("modal", function () { return e.controller.getModalState() })({ save: function () { return t.createElement(x, { controller: e.props.controller }, t.createElement(n.SaveDialog, { controller: e.props.controller })) }, rename: function () { return t.createElement(x, { controller: e.props.controller }, t.createElement(n.SaveDialog, { controller: e.props.controller })) }, duplicate: function () { return t.createElement(x, { controller: e.props.controller }, t.createElement(n.SaveDialog, { controller: e.props.controller })) }, "export-image": function () { return t.createElement(x, { controller: e.props.controller }, t.createElement(p.default, { controller: e.props.controller })) }, login: function () { return t.createElement(l.SharedLoginModal, { controller: e.props.controller }) }, signup: function () { return t.createElement(r.SharedSignupModal, { controller: e.props.controller, teacher: e.const(!1) }) }, "recover-password": function () { return t.createElement(c.SharedRecoverPasswordModal, { controller: e.props.controller }) }, hotkeys: function () { return t.createElement(x, { controller: e.props.controller }, t.createElement(a.HotkeysDialog, { controller: e.props.controller }), t.const(";")) }, "unsupported-browser": function () { return t.createElement(x, { controller: e.props.controller }, t.createElement(s.UnsupportedBrowserDialog, { controller: e.props.controller })) }, "account-settings": function (o) { return t.createElement(i.SharedAccountSettingsModal, { controller: e.props.controller, extraTabs: e.bindFn(e.getAccountSettingsExtraTabs), initialTab: function () { return o().initialTab } }) }, "change-email": function () { return t.createElement(d.SharedChangeEmailModal, { controller: e.props.controller }) }, "account-reenabled": function () { return t.createElement(g.SharedAccountReenabledModal, { controller: e.props.controller }) }, consent: function () { return t.createElement(u.SharedConsentModal, { controller: e.props.controller }) }, "contest-submission": function () { return t.createElement(h.Modal, { title: function () { return "" }, size: e.const("wide"), showX: e.const(!0), onClose: function () { return e.controller.dispatch({ type: "close-modal" }) }, i18n: e.props.controller }, t.createElement(m.default, { controller: e.props.controller })) }, delete: function () { return t.createElement(E.DeleteModal, { controller: e.props.controller }) }, "teacher-signup": function () { return t.createElement("div", null) }, none: function () { return t.createElement("div", null) } }) }, v.prototype.getAccountSettingsExtraTabs = function () { var e = this; return { tabs: [{ key: "advanced", wideLabel: function () { return e.props.controller().s("account-shell-label-advanced-preferences") }, narrowLabel: function () { return e.props.controller().s("account-shell-label-advanced-preferences") }, class: "advanced" }], createView: function (o) { return o ? "advanced" == o ? t.createElement(f.AdvancedSettings, { controller: e.props.controller }) : o : t.createElement("span", null) } } }, v }(t.Class); e.Modals = M; var x = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return o.__extends(n, e), n.prototype.init = function () { this.controller = this.props.controller() }, n.prototype.template = function () { var e = this; return t.createElement("div", { role: t.const("dialog"), class: function () { return { "dcg-modal-container": !0, "dcg-wide-modal": "hotkeys" === e.controller.getOpenModal(), "dcg-fixed-width-height": e.shouldBeFixedWidthHeight(), "dcg-export-modal": "export-image" === e.controller.getOpenModal() } } }, t.createElement("div", { class: t.const("dcg-modal-background"), onTap: function () { return e.controller.dispatch({ type: "close-modal" }) } }), t.createElement("div", { class: t.const("modal dcg-state-modals") }, t.createElement(b, { predicate: function () { return "consent" !== e.controller.getOpenModal() } }, function () { return t.createElement("span", { role: t.const("link"), tabindex: t.const(0), "aria-label": t.const("Close Dialog"), class: t.const("action-close-modal close-modal internal-close"), onTap: function () { return e.controller.dispatch({ type: "close-modal" }) }, didMount: function (o) { if ("hotkeys" === e.controller.getOpenModal()) return o.focus() } }, t.createElement("i", { class: t.const("dcg-icon-remove"), "aria-hidden": t.const("true") })) }), this.children), t.createElement("span", { role: t.const("link"), tabindex: t.const(0), onTap: function () { return e.controller.dispatch({ type: "close-modal" }) }, "aria-label": t.const("Close Dialog"), class: t.const("action-close-modal close-modal external-close") }, t.createElement("i", { class: t.const("dcg-icon-remove"), "aria-hidden": t.const("true") }))) }, n.prototype.shouldBeFixedWidthHeight = function () { var e = this.controller.getOpenModal(); return "export-image" === e || "contest-submission" === e }, n }(t.Class) });
define('vendor/fake-xml-http-request', [], function () { var e = function (e, t, s, n) { this.type = e, this.bubbles = t, this.cancelable = s, this.target = n }; e.prototype = { stopPropagation: function () { }, preventDefault: function () { this.defaultPrevented = !0 } }; var t = { 100: "Continue", 101: "Switching Protocols", 200: "OK", 201: "Created", 202: "Accepted", 203: "Non-Authoritative Information", 204: "No Content", 205: "Reset Content", 206: "Partial Content", 300: "Multiple Choice", 301: "Moved Permanently", 302: "Found", 303: "See Other", 304: "Not Modified", 305: "Use Proxy", 307: "Temporary Redirect", 400: "Bad Request", 401: "Unauthorized", 402: "Payment Required", 403: "Forbidden", 404: "Not Found", 405: "Method Not Allowed", 406: "Not Acceptable", 407: "Proxy Authentication Required", 408: "Request Timeout", 409: "Conflict", 410: "Gone", 411: "Length Required", 412: "Precondition Failed", 413: "Request Entity Too Large", 414: "Request-URI Too Long", 415: "Unsupported Media Type", 416: "Requested Range Not Satisfiable", 417: "Expectation Failed", 422: "Unprocessable Entity", 500: "Internal Server Error", 501: "Not Implemented", 502: "Bad Gateway", 503: "Service Unavailable", 504: "Gateway Timeout", 505: "HTTP Version Not Supported" }; var s = { "Accept-Charset": !0, "Accept-Encoding": !0, Connection: !0, "Content-Length": !0, Cookie: !0, Cookie2: !0, "Content-Transfer-Encoding": !0, Date: !0, Expect: !0, Host: !0, "Keep-Alive": !0, Referer: !0, TE: !0, Trailer: !0, "Transfer-Encoding": !0, Upgrade: !0, "User-Agent": !0, Via: !0 }; function n(e, t) { t.addEventListener(e, function (s) { var n = t["on" + e]; n && "function" == typeof n && n.call(s.target, s) }) } function r() { this._eventListeners = {}; for (var e = ["loadstart", "progress", "load", "error", "abort", "loadend"], t = e.length - 1; t >= 0; t--)n(e[t], this) } function i() { r.call(this), this.readyState = i.UNSENT, this.requestHeaders = {}, this.requestBody = null, this.status = 0, this.statusText = "", this.upload = new r } r.prototype = { addEventListener: function (e, t) { this._eventListeners[e] = this._eventListeners[e] || [], this._eventListeners[e].push(t) }, removeEventListener: function (e, t) { for (var s = this._eventListeners[e] || [], n = 0, r = s.length; n < r; ++n)if (s[n] == t) return s.splice(n, 1) }, dispatchEvent: function (e) { for (var t = e.type, s = this._eventListeners[t] || [], n = 0; n < s.length; n++)"function" == typeof s[n] ? s[n].call(this, e) : s[n].handleEvent(e); return !!e.defaultPrevented }, _progress: function (t, s, n) { var r = new e("progress"); r.target = this, r.lengthComputable = t, r.loaded = s, r.total = n, this.dispatchEvent(r) } }, i.prototype = new r, i.UNSENT = 0, i.OPENED = 1, i.HEADERS_RECEIVED = 2, i.LOADING = 3, i.DONE = 4; var o = { UNSENT: 0, OPENED: 1, HEADERS_RECEIVED: 2, LOADING: 3, DONE: 4, async: !0, withCredentials: !1, open: function (e, t, s, n, r) { this.method = e, this.url = t, this.async = "boolean" != typeof s || s, this.username = n, this.password = r, this.responseText = null, this.responseXML = null, this.requestHeaders = {}, this.sendFlag = !1, this._readyStateChange(i.OPENED) }, setRequestHeader: function (e, t) { if (h(this), s[e] || /^(Sec-|Proxy-)/.test(e)) throw new Error('Refused to set unsafe header "' + e + '"'); this.requestHeaders[e] ? this.requestHeaders[e] += "," + t : this.requestHeaders[e] = t }, send: function (t) { if (h(this), !/^(get|head)$/i.test(this.method)) { var s = !1; Object.keys(this.requestHeaders).forEach(function (e) { "content-type" === e.toLowerCase() && (s = !0) }), s || (t || "").toString().match("FormData") || (this.requestHeaders["Content-Type"] = "text/plain;charset=UTF-8"), this.requestBody = t } this.errorFlag = !1, this.sendFlag = this.async, this._readyStateChange(i.OPENED), "function" == typeof this.onSend && this.onSend(this), this.dispatchEvent(new e("loadstart", !1, !1, this)), i.onSend && i.onSend(this) }, abort: function () { this.aborted = !0, this.responseText = null, this.errorFlag = !0, this.requestHeaders = {}, this.readyState > i.UNSENT && this.sendFlag && (this._readyStateChange(i.DONE), this.sendFlag = !1), this.readyState = i.UNSENT, this.dispatchEvent(new e("abort", !1, !1, this)), "function" == typeof this.onerror && this.onerror() }, error: function () { this.responseText = null, this.errorFlag = !0, this.requestHeaders = {}, this.readyState > i.UNSENT && this.sendFlag && (this.sendFlag = !1), this.readyState = i.DONE, this.dispatchEvent(new e("error", !1, !1, this)), "function" == typeof this.onerror && this.onerror() }, getResponseHeader: function (e) { if (this.readyState < i.HEADERS_RECEIVED) return null; if (/^Set-Cookie2?$/i.test(e)) return null; for (var t in e = e.toLowerCase(), this.responseHeaders) if (t.toLowerCase() == e) return this.responseHeaders[t]; return null }, getAllResponseHeaders: function () { if (this.readyState < i.HEADERS_RECEIVED) return ""; var e = ""; for (var t in this.responseHeaders) this.responseHeaders.hasOwnProperty(t) && !/^Set-Cookie2?$/i.test(t) && (e += t + ": " + this.responseHeaders[t] + "\r\n"); return e }, overrideMimeType: function (e) { "string" == typeof e && (this.forceMimeType = e.toLowerCase()) }, _readyStateChange: function (t) { this.readyState = t, "function" == typeof this.onreadystatechange && this.onreadystatechange(new e("readystatechange")), this.dispatchEvent(new e("readystatechange")), this.readyState == i.DONE && (this.dispatchEvent(new e("load", !1, !1, this)), this.dispatchEvent(new e("loadend", !1, !1, this))) }, _setResponseHeaders: function (e) { for (var t in this.responseHeaders = {}, e) e.hasOwnProperty(t) && (this.responseHeaders[t] = e[t]); this.forceMimeType && (this.responseHeaders["Content-Type"] = this.forceMimeType), this.async ? this._readyStateChange(i.HEADERS_RECEIVED) : this.readyState = i.HEADERS_RECEIVED }, _setResponseBody: function (e) { !function (e) { if (e.readyState == i.DONE) throw new Error("Request done") }(this), function (e) { if (e.async && e.readyState != i.HEADERS_RECEIVED) throw new Error("No headers received") }(this), function (e) { if ("string" != typeof e) { var t = new Error("Attempted to respond to fake XMLHttpRequest with " + e + ", which is not a string."); throw t.name = "InvalidBodyException", t } }(e); var t = this.chunkSize || 10, s = 0; this.responseText = ""; do { this.async && this._readyStateChange(i.LOADING), this.responseText += e.substring(s, s + t), s += t } while (s < e.length); var n, r, o = this.getResponseHeader("Content-Type"); if (this.responseText && (!o || /(text\/xml)|(application\/xml)|(\+xml)/.test(o))) try { this.responseXML = (n = this.responseText, "undefined" != typeof DOMParser ? r = (new DOMParser).parseFromString(n, "text/xml") : ((r = new ActiveXObject("Microsoft.XMLDOM")).async = "false", r.loadXML(n)), r) } catch (e) { } this.async ? this._readyStateChange(i.DONE) : this.readyState = i.DONE }, respond: function (e, s, n) { this._setResponseHeaders(s || {}), this.status = "number" == typeof e ? e : 200, this.statusText = t[this.status], this._setResponseBody(n || "") } }; for (var a in o) i.prototype[a] = o[a]; function h(e) { if (e.readyState !== i.OPENED) throw new Error("INVALID_STATE_ERR"); if (e.sendFlag) throw new Error("INVALID_STATE_ERR") } return i });
define('lib/app-bridge', ['require', 'jquery', 'underscore_model', 'browser', 'lib/conditional_blur', 'vendor/fake-xml-http-request', 'pjs', 'console', 'main/backend'], function (require) { "use strict"; var e = require("jquery"), t = require("underscore_model").UnderscoreModel, n = require("browser"), o = require("lib/conditional_blur").default, i = require("vendor/fake-xml-http-request"), r = null, s = null, a = require("pjs"), d = require("console"), l = !1, u = require("main/backend"), c = {}, h = 0; if (n.IS_IOS) { var f = [], p = []; r = { loaded: !1, methods: {}, queuedMethodCalls: [] }, e(function () { var t = []; window.ObjC_callback = function (e) { r.loaded = !0, e.split(" ").forEach(function (e) { r.methods[e] = function (o, i) { var r, s, a = i ? (r = i, s = p.length ? p.pop() : f.length, f[s] = r, s) : -1; t.push("desmos:" + e + "/" + a + "/" + encodeURIComponent(o)), 1 === t.length && n.attr("src", t[0]) } }), this.ObjC_callback = function (e, o) { try { -1 !== e && (r = f[i = e], f[i] = null, p.push(i), r)(o) } finally { t.shift(), t.length > 0 && n.attr("src", t[0]) } var i, r }, r.methods.proxyXHR && (window.XMLHttpRequest = i, i.onSend = function (e) { var t = h + ""; h += 1, c[t] = e, r.methods.proxyXHR(JSON.stringify({ id: t, url: e.url, method: e.method, headers: e.requestHeaders, body: e.requestBody })) }), r.queuedMethodCalls.forEach(function (e) { m[e.methodName].apply(m, e.args) }) }; var n = e('<iframe id="objc-bridge" style="position:absolute; left: -1000px; z-index: -1" src="desmos:loaded"/>').appendTo(document.body) }) } else n.IS_ANDROID ? s = window.Android : l = !0; var m = new (a(t, function (e, t) { e.init = function () { t.init.call(this), this.heartbeatTimeout = null, this.observeEvent("started resumed", function (e) { this.gaEvent(e + ":" + this.versionNumber), this.incrementHeartbeat(0) }.bind(this)), -1 !== document.location.search.indexOf("simulateVersionNumber") && (this.versionNumber = "?.?.?") }, e.heartbeat = function (e) { clearTimeout(this.heartbeatTimeout), this.gaEvent("heartbeat-" + 10 * e), this.incrementHeartbeat(e) }, e.incrementHeartbeat = function (e) { clearTimeout(this.heartbeatTimeout), this.heartbeatTimeout = setTimeout(function () { this.heartbeat(e + 1) }.bind(this), 6e5) }, e._started = function (e, t) { this.appId = e, this.versionNumber = t, this.triggerEvent("started") }, e._resumed = function () { this.triggerEvent("resumed") }, e.handleAndroidBackButtonAndReturnIfShouldMoveToBackground = function () { var e = window.Calc && window.Calc.controller; return e && e.isKeypadOpen() ? (o(), "false") : (e = window.MainController) && e.handleAndroidBackButton() ? "false" : "true" }, e.isInApp = function () { return window.platform && "www" !== window.platform }, e.onGoogleAuthResult = function (e) { this.triggerEvent("onGoogleAuthResult", e) }, e.onAppleAuthResult = function (e) { this.triggerEvent("onAppleAuthResult", e) }, e.onObjCXHRProxyResult = function (e) { var t = e.id, n = c[t]; delete c[t], 0 === e.status ? n.error() : n.respond(e.status, e.headers, e.body) }, e.sendAnalyticsEvent = function (e, t) { this.sendSerializedAnalyticsEvent(JSON.stringify({ type: e, payload: t })) } })); return ["hideLoadingScreen", "gaEvent", "openGoogleLogin", "openAppleLogin", "logout", "saveCookies", "deleteCookies", "startSingleAppMode", "endSingleAppMode", "setWWWSubdomain", "sendSerializedAnalyticsEvent", "sendStoredLogsToDesmos"].forEach(function (e) { m[e] = function () { l || (s ? s[e] ? s[e].apply(s, arguments) : d.log("call to missing Android method", e, arguments) : r && (r.loaded ? r.methods[e] ? r.methods[e].apply(r, arguments) : d.log("call to missing ObjC method", e, arguments) : r.queuedMethodCalls.push({ methodName: e, args: arguments }))) } }), l || (window.AppBridge = m, document.addEventListener("click", function (t) { var n = e(t.target).closest("a[href]")[0]; if (n && "file:" === n.protocol) { var o = n.getAttribute("href"); "/" !== o[0] && (o = "/" + o), n.setAttribute("href", u.baseURL + o) } }, !0)), window.__dcgAppBridgeDefined = !0, m });

define('loadcss!mygraphs/item', function () { });
define('mygraphs/item', ["require", "exports", "tslib", "dcgview", "jquery", "../shared-components/tooltip", "loadcss!./item"], function (require, e, t, n, r, s) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Item = void 0; var o = n.Components.If, c = function (e) { function c() { return null !== e && e.apply(this, arguments) || this } return t.__extends(c, e), c.prototype.template = function () { var e = this; return n.createElement("div", { role: n.const("listitem"), class: function () { return { "saved-graph": !0, "graph-link-container": !0, "dcg-selected": e.props.isSelected() } }, onTap: function (t) { t.wasHandled() || e.props.onTap(t) } }, n.createElement(o, { predicate: function () { return !e.props.isDeletingGraph() && !e.props.didDeleteGraphFail() } }, function () { return n.createElement("div", { role: n.const("link"), tabindex: n.const(0), class: function () { return { "graph-link": !0, "dcg-action-preview-graph": !0, "example-graph": e.props.isExample() } }, didMount: e.bindFn(e.didMount) }, n.createElement("span", { class: n.const("dcg-thumb"), style: e.const({ "background-image": "url(" + e.props.getThumbURL() + ")" }) }), n.createElement("div", { class: n.const("dcg-graph-details") }, n.createElement("div", { class: n.const("dcg-title") }, e.props.getTitle), n.createElement("div", { class: n.const("dcg-subtitle dcg-graph-date") }, function () { return e.props.isExample() ? e.props.s("account-shell-label-mygraphs-example") : e.props.getDisplayDate() }))) }), n.createElement(o, { predicate: this.props.isDeletingGraph }, function () { return n.createElement("div", { "aria-live": n.const("assertive"), "aria-atomic": n.const("true"), class: n.const("deleting"), handleEvent: n.const("true"), onTap: function () { e.props.canCancelDelete() && e.props.cancelDeleteGraph() } }, function () { return e.props.s("account-shell-text-mygraphs-deleting") }, n.createElement(o, { predicate: e.props.canCancelDelete }, function () { return n.createElement("div", { role: n.const("button"), tabindex: n.const(0), class: n.const("cancel-delete") }, function () { return e.props.s("account-shell-button-mygraphs-cancel") }) })) }), n.createElement(o, { predicate: this.props.didDeleteGraphFail }, function () { return n.createElement("div", { "aria-live": n.const("assertive"), "aria-atomic": n.const("true"), class: n.const("retry-delete"), handleEvent: n.const("true") }, function () { return e.props.s("account-shell-error-mygraphs-error-deleting") }, n.createElement("a", { role: n.const("button"), tabindex: n.const(0), class: n.const("dcg-action-removegraph"), onTap: e.props.requestDeleteGraph }, function () { return e.props.s("account-shell-button-mygraphs-try-again") }), function () { return e.props.s("account-shell-text-mygraphs-or") }, n.createElement("a", { role: n.const("button"), tabindex: n.const(0), class: n.const("dcg-action-cancelremovegraph"), onTap: e.props.cancelDeleteGraph }, function () { return e.props.s("account-shell-button-mygraphs-cancel") })) }), n.createElement(o, { predicate: function () { return !e.props.isExample() && !e.props.isDeletingGraph() && !e.props.didDeleteGraphFail() } }, function () { return n.createElement("span", { class: n.const("actions"), handleEvent: n.const("true") }, n.createElement("span", { role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return e.props.s("account-shell-button-mygraphs-delete-title", { graphTitle: e.props.getTitle() }) }, class: n.const("dcg-action-removegraph"), onTap: e.props.requestDeleteGraph }, n.createElement(s.Tooltip, { tooltip: function () { return e.props.s("account-shell-button-mygraphs-delete-graph") }, gravity: e.const("e") }, n.createElement("i", { class: n.const("dcg-icon-remove"), "aria-hidden": n.const("true") })))) })) }, c.prototype.didUpdate = function () { this.props.isSelected() && this.$node.trigger("focus") }, c.prototype.didMount = function (e) { var t = this; this.$node = r(e), this.$node.on("focus", function () { t.props.isSelected() || t.props.onFocus() }) }, c }(n.Class); e.Item = c });

define('loadcss!mygraphs/save-btn', function () { });
define('mygraphs/save-btn', ["require", "exports", "tslib", "dcgview", "loadcss!./save-btn"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.SaveBtn = void 0; var r = n.Components.If, s = function (e) { function s() { return null !== e && e.apply(this, arguments) || this } return t.__extends(s, e), s.prototype.shouldShowSaveButton = function () { return !this.props.isSaving() && !this.props.didSaveRecentlySucceed() && !this.props.didSaveRecentlyFail() }, s.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("save-btn-container") }, n.createElement(r, { predicate: function () { return e.shouldShowSaveButton() } }, function () { return n.createElement("div", { role: n.const("button"), onTap: e.props.onTap, class: function () { return { "dcg-action-save": !0, "dcg-btn-primary": e.props.enabled(), "dcg-disabled": !e.props.enabled() } }, "aria-disabled": function () { return !e.props.enabled() }, tabindex: function () { return e.props.enabled() ? 0 : -1 } }, function () { return e.props.s("account-shell-button-mygraphs-save") }) }), n.createElement(r, { predicate: this.props.isSaving }, function () { return n.createElement("div", { class: n.const("save-saving") }, n.createElement("span", { class: n.const("dcg-spinner-dark") })) }), n.createElement(r, { predicate: this.props.didSaveRecentlyFail }, function () { return n.createElement("div", { class: n.const("save-error"), "aria-live": n.const("assertive"), "aria-atomic": n.const("true") }, n.createElement("i", { class: n.const("dcg-icon-remove"), "aria-hidden": n.const("true") }), n.const(" "), function () { return e.props.s("account-shell-text-error") }) }), n.createElement(r, { predicate: this.props.didSaveRecentlySucceed }, function () { return n.createElement("div", { class: n.const("save-success") }, n.createElement("i", { class: n.const("dcg-icon-check"), "aria-hidden": n.const("true") }), n.const(" "), function () { return e.props.s("account-shell-text-saved") }) })) }, s }(n.Class); e.SaveBtn = s });
define('mygraphs/graph-in-progress', ["require", "exports", "tslib", "dcgview", "./save-btn", "loadcss!./item"], function (require, e, s, t, a) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.GraphInProgress = void 0; var n = function (e) { function n() { return null !== e && e.apply(this, arguments) || this } return s.__extends(n, e), n.prototype.template = function () { var e = this; return t.createElement("div", { class: t.const("graph-link-container graph-in-progress") }, t.createElement("div", { role: t.const("link"), "aria-label": function () { return e.props.s("account-shell-button-mygraphs-save") }, class: t.const("graph-link dcg-action-preview-graph"), onTap: this.props.openSaveDialog }, t.createElement("span", { class: t.const("dcg-thumb"), style: function () { return { "background-image": "url(" + e.props.getThumbnail() + ")" } } }), t.createElement("div", { class: t.const("dcg-graph-details") }, t.createElement("div", { class: t.const("dcg-title") }, this.props.getTitle), t.createElement("div", { class: t.const("dcg-subtitle dcg-save-status") }, function () { return e.props.isSaveEnabled() ? e.props.wasCurrentGraphEverSaved() ? e.props.s("account-shell-label-mygraphs-last-saved", { date: e.props.getDisplayDate() }) : e.props.s("account-shell-label-mygraphs-unsaved-graph") : e.props.s("account-shell-label-mygraphs-no-unsaved-changes") })), t.createElement(a.SaveBtn, { enabled: this.props.isSaveEnabled, isSaving: this.props.isSaving, didSaveRecentlySucceed: this.props.didSaveRecentlySucceed, didSaveRecentlyFail: this.props.didSaveRecentlyFail, onTap: function () { }, s: this.props.s }))) }, n.prototype.shouldUpdate = function () { return this.props.isOpen() }, n }(t.Class); e.GraphInProgress = n });

define('loadcss!mygraphs/user-bar', function () { });
define('mygraphs/user-bar', ["require", "exports", "tslib", "dcgview", "jquery", "../calculator-shell/account-menu", "loadcss!./user-bar"], function (require, e, t, n, r, c) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.UserBar = void 0; var o = n.Components, a = o.Input, s = o.If, i = function (e) { function o() { return null !== e && e.apply(this, arguments) || this } return t.__extends(o, e), o.prototype.willUpdate = function () { this.props.isSearching() || this.setSearchValue("") }, o.prototype.setSearchValue = function (e) { this.searchValue !== e && (this.searchValue = e, this.props.updateFilter(e)) }, o.prototype.init = function () { this.controller = this.props.controller(), this.searchValue = "" }, o.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-user-bar") }, n.createElement(s, { predicate: function () { return !e.props.isSearching() } }, function () { return n.createElement("div", { class: n.const("dcg-account-link-container") }, n.createElement("div", { class: n.const("dcg-account-link"), "dcg-menu-button": n.const("account"), role: n.const("button"), tabindex: n.const(0), "aria-haspopup": n.const("true"), "aria-expanded": function () { return "account" === e.controller.getOpenMenu() }, "aria-label": n.const("Account Information"), onTap: function (t) { if (e.measureAccountDropdownArrowOffset(), e.props.controller().dispatch({ type: "toggle-menu", payload: "account" }), "keyboard" == t.device) { var n = "account" === e.props.controller().getOpenMenu(); r(n ? ".dcg-action-accountsettings" : ".dcg-account-link").trigger("focus") } } }, n.createElement("span", { class: n.const("dcg-variable-name") }, function () { return e.controller.userController.getFirstName() }), n.createElement("i", { class: n.const("dcg-icon-caret-down"), "aria-hidden": n.const("true") })), n.createElement(s, { predicate: function () { return "account" === e.controller.getOpenMenu() && e.controller.mygraphsController.isMygraphsOpen() } }, function () { return n.createElement(c.AccountMenu, { controller: e.const(e.controller), left: function () { return "4px" }, arrowLeft: function () { return e.accountDropdownArrowOffset - 4 + "px" } }) })) }), n.createElement(s, { predicate: function () { return !e.props.isSearching() } }, function () { return n.createElement("div", { role: n.const("link"), tabindex: n.const("0"), class: n.const("dcg-search-btn"), onTap: function (t) { t.preventDefault(), e.props.openSearch(), r(".search-container").find("input").trigger("focus") } }, n.createElement("i", { class: n.const("dcg-icon-search search-icon"), "aria-hidden": n.const("true") }), n.createElement("span", { class: n.const("dcg-menu-title") }, function () { return e.props.s("account-shell-heading-title-mygraphs-search") })) }), n.createElement(s, { predicate: function () { return e.props.isSearching() } }, function () { return n.createElement("div", { role: n.const("search"), class: n.const("search-container search-open") }, n.createElement("i", { class: n.const("dcg-icon-search search-icon"), "aria-hidden": n.const("true") }), n.createElement(a, { placeholder: function () { return e.props.s("account-shell-text-mygraphs-search-by-title") }, onInput: e.bindFn(e.setSearchValue), onFocus: e.props.openSearch, value: function () { return e.searchValue }, didMount: e.bindFn(e.didMountSearch) }), n.createElement("span", { role: n.const("button"), tabindex: n.const(0), "aria-label": function () { return e.props.s("account-shell-heading-title-mygraphs-search") }, class: n.const("dcg-icon-remove dcg-action-close-search"), onTap: function (t) { t.preventDefault(), e.props.closeSearch() } })) })) }, o.prototype.didMountDropdown = function (e) { r(e).on("touchstart", function (e) { return e.preventDefault() }) }, o.prototype.didMountSearch = function (e) { var t = this; r(e).on("blur", function () { r(e).val() || t.props.closeSearch() }) }, o.prototype.measureAccountDropdownArrowOffset = function () { var e, t, n, c = r(".dcg-user-bar .dcg-account-link i"), o = (null !== (t = null === (e = c.offset()) || void 0 === e ? void 0 : e.left) && void 0 !== t ? t : 0) + (null !== (n = c.width()) && void 0 !== n ? n : 0) / 2; this.accountDropdownArrowOffset = o }, o }(n.Class); e.UserBar = i });

define('loadcss!mygraphs/graph-preview', function () { });
define('mygraphs/graph-preview', ["require", "exports", "tslib", "dcgview", "jquery", "mygraphs/load-graph-view", "loadcss!./graph-preview"], function (require, t, e, r, o, a) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.GraphPreview = void 0; var i = r.Components.If, n = function (t) { function n() { return null !== t && t.apply(this, arguments) || this } return e.__extends(n, t), n.prototype.didMountGraphPreview = function (t) { return this.$graphPreview = o(t), this.updateGraphPreviewTop() }, n.prototype.didMountArrow = function (t) { return this.$arrow = o(t), this.updateArrowTop() }, n.prototype.didMountCalc = function (t) { return this.previewCalc = this.props.makeAPI(t), this.updatePreviewCalc() }, n.prototype.willUnmountCalc = function () { this.previewCalc && this.previewCalc.destroy && this.previewCalc.destroy() }, n.prototype.didUpdate = function () { return this.updateGraphPreviewTop(), this.updateArrowTop(), this.updatePreviewCalc() }, n.prototype.updateGraphPreviewTop = function () { return this.$graphPreview.css("top", this.getTopOffset() + "px") }, n.prototype.updateArrowTop = function () { this.$arrow.css("top", this.getArrowOffset() + "px") }, n.prototype.updatePreviewCalc = function () { var t = this.props.getGraphData(); t !== this.cachedGraphData && (this.cachedGraphData = t, this.previewCalc.setState(t), this.previewCalc.resize()) }, n.prototype.getMaxTop = function () { return o(window).height() - this.$graphPreview.outerHeight() - 10 }, n.prototype.getIdealTop = function () { var t = this.props.alignToNode(); return null == t ? null : o(t).offset().top + .5 * o(t).outerHeight() - 60 }, n.prototype.getTopOffset = function () { var t = this.getIdealTop(); if (null == t) return 0; var e = this.getMaxTop(); return Math.min(t, e) }, n.prototype.getArrowOffset = function () { var t = this.getIdealTop(); return null == t ? 60 : 60 + t - this.getTopOffset() }, n.prototype.template = function () { var t = this; return r.createElement("div", { class: r.const("graph-preview"), didMount: this.didMountGraphPreview.bind(this) }, r.createElement("div", { class: r.const("dcg-graph-preview-info") }, r.createElement("h4", { class: r.const("dcg-title") }, this.props.getTitle), r.createElement("span", { role: r.const("button"), tabindex: r.const("0"), class: r.const("dcg-action-cancel"), onTap: this.props.onCancel }, r.createElement("i", { class: r.const("dcg-icon-remove"), "aria-hidden": r.const("true") }))), r.createElement("div", { class: r.const("preview-graph-area") }, r.createElement(i, { predicate: function () { return !t.props.getGraphData() } }, function () { return r.createElement(a.LoadGraphView, { didDataLoadFail: t.props.didDataLoadFail, onCancel: t.props.onCancel, requestLoadGraphData: t.props.requestLoadGraphData, s: t.props.s.bind(t.props) }) }), r.createElement("div", { didMount: this.didMountCalc.bind(this), willUnmount: this.willUnmountCalc.bind(this), class: function () { return { "dcg-preview-calculator": !0, "dcg-visible": t.props.getGraphData() } } }), r.createElement("div", { class: function () { return { "screenshot-clickjack": !0, "dcg-action-open-graph": !0, "dcg-visible": t.props.getGraphData() } } }, r.createElement("span", { role: r.const("button"), tabindex: r.const("0"), class: r.const("dcg-action-open-graph dcg-open-graph-btn dcg-btn-primary"), onTap: this.props.onOpenGraph }, this.props.getOpenText))), r.createElement("div", { class: r.const("active-arrow"), didMount: this.didMountArrow.bind(this) }, r.createElement("div", { class: r.const("dcg-graphic") }))) }, n }(r.Class); t.GraphPreview = n });

define('loadcss!mygraphs/syncing-status-bar', function () { });
define('mygraphs/syncing-status-bar', ["require", "exports", "tslib", "dcgview", "loadcss!./syncing-status-bar"], function (require, t, e, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.SyncingStatusBar = void 0; var s = n.Components.If, r = function (t) { function r() { return null !== t && t.apply(this, arguments) || this } return e.__extends(r, t), r.prototype.template = function () { var t = this; return n.createElement("div", { class: function () { return { "syncing-status-bar": !0, visible: t.props.isSyncingGraphs() || t.props.didSyncFail() } } }, n.createElement(s, { predicate: this.props.isSyncingGraphs }, function () { return n.createElement("div", { class: n.const("syncing-status-text") }, n.createElement("span", { class: n.const("dcg-pulse") }, function () { return t.props.s("account-shell-text-mygraphs-updating-graphs") })) }), n.createElement(s, { predicate: function () { return !t.props.isSyncingGraphs() && !t.props.didSyncFail() } }, function () { return n.createElement("div", { class: n.const("success-status-text") }, n.createElement("i", { class: n.const("dcg-icon-check"), "aria-hidden": n.const("true") }), n.const(" "), function () { return t.props.s("account-shell-text-mygraphs-synced") }) }), n.createElement(s, { predicate: this.props.didSyncFail }, function () { return n.createElement("div", { class: n.const("error-status-text"), onTap: t.props.requestSyncGraphs }, function () { return t.props.s("account-shell-button-mygraphs-offline-try-again") }) })) }, r }(n.Class); t.SyncingStatusBar = r });

define('loadcss!mygraphs/account-reminder', function () { });
define('mygraphs/account-reminder', ["require", "exports", "tslib", "dcgview", "loadcss!./account-reminder"], function (require, t, n, e) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.AccountReminder = void 0; var o = function (t) { function o() { return null !== t && t.apply(this, arguments) || this } return n.__extends(o, t), o.prototype.init = function () { this.controller = this.props.controller() }, o.prototype.template = function () { var t = this; return e.createElement("div", { class: e.const("dcg-account-reminder") }, e.createElement("a", { role: e.const("link"), tabindex: e.const("0"), class: e.const("dcg-btn-white-outline dcg-action-createaccount"), onTap: this.props.onCreateAccount }, function () { return t.controller.s("account-shell-link-mygraphs-sign-up") }), function () { return t.controller.s("account-shell-text-mygraphs-or") }, e.createElement("a", { role: e.const("link"), tabindex: e.const("0"), class: e.const("dcg-action-login"), onTap: this.props.onSignIn }, function () { return t.controller.s("account-shell-link-mygraphs-log-in") }), e.createElement("div", null, function () { return t.getToSaveYourText() })) }, o.prototype.getToSaveYourText = function () { return "graphing" === this.controller.product ? this.controller.s("account-shell-text-mygraphs-to-save-graphs") : "geometry" === this.controller.product ? this.controller.s("account-shell-text-mygraphs-to-save-constructions") : "" }, o }(e.Class); t.AccountReminder = o });
define('mygraphs/heading', ["require", "exports", "tslib", "dcgview"], function (require, e, t, n) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var r = function (e) { function r() { return null !== e && e.apply(this, arguments) || this } return t.__extends(r, e), r.prototype.template = function () { var e = this; return n.createElement("div", { class: n.const("dcg-mygraphs-section-title-container") }, n.createElement("span", { role: n.const("heading"), "aria-level": n.const("1"), class: n.const("dcg-mygraphs-section-title") }, function () { return e.props.title() })) }, r }(n.Class); e.default = r });

define('loadcss!mygraphs/mygraphs', function () { });
define('mygraphs/mygraphs', ["require", "exports", "tslib", "dcgview", "jquery", "underscore", "mygraphs/item", "mygraphs/graph-in-progress", "mygraphs/user-bar", "mygraphs/graph-preview", "mygraphs/syncing-status-bar", "mygraphs/account-reminder", "mygraphs/load-graph-view", "scroll_helpers", "mygraphs/heading", "keys", "analytics/looker", "shared/dcgviews/localize", "loadcss!./mygraphs"], function (require, e, t, r, n, o, a, l, i, s, c, p, u, h, d, g, m, v) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Mygraphs = void 0; var f = r.Components, y = f.If, G = f.For, w = f.IfElse, E = "default", C = "search", b = function (e) { function f() { var t = null !== e && e.apply(this, arguments) || this; return t.state = "default", t } return t.__extends(f, e), f.prototype.didUpdate = function () { this.previewGraph && h.scrollVisible(n(this.getSelectedNode()), this.$scrollableNode, 60) && this.update() }, f.prototype.didMountScrollable = function (e) { var t = this; this.$scrollableNode = n(e), this.$scrollableNode.on("focusin", function (e) { if (null != t.previewGraph && !n(e.target).hasClass("graph-link")) return t.previewItem(null) }), n(window).on("keydown", function (e) { if (!t.props.isOpen()) return !0; switch (g.lookup(e)) { case g.UP: return t.selectUp(e); case g.DOWN: return t.selectDown(e) } }); var r = o.throttle(this.hidePreviewIfTooScrolled.bind(this), 200); this.$scrollableNode.on("scroll", r), this.debouncedFetchSelectedGraph = o.debounce(this.fetchSelectedGraph.bind(this), 200) }, f.prototype.fetchSelectedGraph = function () { return this.props.graphsController().loadDataForGraph(this.previewGraph) }, f.prototype.hidePreviewIfTooScrolled = function () { if (null != this.previewGraph) { var e = n(this.getSelectedNode()), t = n(this.findRootNode()).find(".active-arrow"), r = e.offset(), o = e.height(), a = t.offset(); if (void 0 !== r && void 0 !== o && void 0 !== a) { var l = r.top + .5 * o, i = a.top; Math.abs(l - i) > 10 && this.previewItem(null) } } }, f.prototype.openSearch = function () { this.state = C, this.previewItem(null) }, f.prototype.closeSearch = function () { this.state = E, this.previewItem(null) }, f.prototype.updateFilter = function (e) { this.filter = e, this.update() }, f.prototype.getMaxGraphs = function () { return this.maxGraphs || 50 }, f.prototype.getCountRemaining = function () { return this.getSavedGraphs().length - this.getMaxGraphs() }, f.prototype.showMoreGraphs = function (e) { var t = this.getMaxGraphs(); if (this.getCountRemaining() < 2 * t ? this.maxGraphs = 1 / 0 : this.maxGraphs = 2 * t, this.update(), "keyboard" === (null != e ? e.device : void 0)) { var r = this.getSavedAndExampleGraphs(), n = null != r ? r[t] : void 0; n && this.previewItem(n) } }, f.prototype.getSelectedNode = function () { return n(".dcg-mygraphs .graph-link-container.dcg-selected")[0] }, f.prototype.selectUp = function (e) { if (null != this.previewGraph) { e.preventDefault(); var t = this.getSavedAndExampleGraphs(); if (t.length) { var r = null != this.previewGraph ? this.previewGraph.hash : void 0, n = o.indexOf(o.pluck(t, "hash"), r), a = null != t ? t[n - 1] : void 0; a ? a && this.previewItem(a) : null != this.$newGraph && this.$newGraph.trigger("focus") } } }, f.prototype.selectDown = function (e) { if (null != this.previewGraph) { var t = this.getSavedAndExampleGraphs(); if (t.length) { e.preventDefault(); var r = null != this.previewGraph ? this.previewGraph.hash : void 0, n = o.indexOf(o.pluck(t, "hash"), r), a = null != t ? t[n + 1] : void 0; a && (!a.example && n + 1 >= this.getMaxGraphs() && this.showMoreGraphs(), this.previewItem(a)) } } }, f.prototype.getFilter = function () { return this.state === C && null != this.filter ? this.filter : "" }, f.prototype.getRecoveryGraphs = function () { return this.props.graphsController().getRecoveryGraphs() }, f.prototype.attemptRecovery = function () { this.logRecoveryClientEvent("ask"), this.controller.mygraphsController.recoveryAttempted = !0, this.controller.graphsController.fetchRecoveryGraphs(), this.update() }, f.prototype.hasAttemptedRecovery = function () { return this.controller.mygraphsController.hasAttemptedRecovery() && !this.isAttemptingRecovery() }, f.prototype.isAttemptingRecovery = function () { return this.controller.graphsController.isLoadingRecoveryGraphs }, f.prototype.shouldShowAttemptRecoveryText = function () { return !!this.graphsController.isRecoveryUIEnabledForProduct() && !this.hasAttemptedRecovery() }, f.prototype.getSavedGraphs = function () { return this.props.graphsController().getSavedGraphs() }, f.prototype.getExampleGraphs = function () { return this.props.graphsController().getExampleGraphs() }, f.prototype.getSavedAndExampleGraphs = function () { return this.props.graphsController().getSavedAndExampleGraphs() }, f.prototype.filterGraphs = function (e) { var t = this, r = this.getFilter().toLowerCase(); return r ? e.filter(function (e) { return t.sanitizeTitle(e).toLowerCase().indexOf(r) >= 0 }) : e }, f.prototype.sliceGraphs = function (e) { return e.slice(0, this.getMaxGraphs()) }, f.prototype.canShowMore = function (e) { return e.length > this.getMaxGraphs() }, f.prototype.onFocusGraph = function (e) { this.skipPreview() || this.previewItem(e) }, f.prototype.onTapGraph = function (e, t) { this.skipPreview() || "keyboard" === t.device ? this.openGraphWithCover(e) : this.previewGraph !== e && this.previewItem(e) }, f.prototype.previewItem = function (e) { this.previewGraph && (this.previewGraph = null), e && (this.previewGraph = e, this.debouncedFetchSelectedGraph()), this.update() }, f.prototype.skipPreview = function () { var e = window.platform; return n("body").width() < 650 || "ios" === e || "android" === e }, f.prototype.onOpenPreviewGraph = function () { if (null != this.previewGraph) { var e = this.previewGraph; this.previewItem(null), this.props.onOpenGraph(e) } }, f.prototype.openGraphWithCover = function (e) { var t = this; if (this.graphWithCover = e, this.previewItem(null), null != e) return setTimeout(function () { t.props.graphsController().loadGraphImmediately(e).done(function () { t.graphWithCover && t.props.openGraphBehindCover(e).then(function () { t.graphWithCover = null, t.update() }) }).always(function () { t.update() }) }, 250) }, f.prototype.cancelLoadGraphWithCover = function () { this.graphWithCover = null, this.update() }, f.prototype.didDataLoadFail = function (e) { return this.props.graphsController().didDataLoadFail(e) }, f.prototype.willUpdate = function () { this.props.isOpen() && this.controller.userController.isLoggedIn() || (this.state = E) }, f.prototype.didMountNewGraph = function (e) { var t = this; return this.$newGraph = n(e), this.$newGraph.on("keydown", function (e) { if (g.lookup(e) === g.DOWN) { var r = t.getSavedAndExampleGraphs(); return t.previewItem(r[0]), e.preventDefault(), e.stopPropagation() } }) }, f.prototype.sanitizeTitle = function (e) { return e.example ? this.controller.s(e.title) : e.title || this.graphsController.getUntitledString() }, f.prototype.init = function () { this.state = E, this.controller = this.props.controller(), this.graphsController = this.controller.graphsController }, f.prototype.template = function () { var e = this; return r.createElement("div", { class: function () { return { "dcg-mygraphs": !0, "logged-in": e.controller.userController.isLoggedIn(), "preview-mode": !!e.props.previewMode(), "maintenance-mode": !!e.props.maintenanceMode() } } }, r.createElement("div", { class: r.const("dcg-resources-container") }, r.createElement(y, { predicate: function () { return e.props.accountsEnabled() && !e.controller.userController.isLoggedIn() && !e.props.previewMode() && !e.props.maintenanceMode() } }, function () { return r.createElement(p.AccountReminder, { onCreateAccount: e.props.onCreateAccount, onSignIn: e.props.onSignIn, controller: e.props.controller }) }), r.createElement(y, { predicate: function () { return e.controller.userController.isLoggedIn() } }, function () { return r.createElement("div", null, r.createElement(y, { predicate: function () { return e.controller.userController.isLoggedIn() && e.state === E } }, function () { return r.createElement(c.SyncingStatusBar, { isSyncingGraphs: function () { return e.props.graphsController().isSyncing() }, didSyncFail: function () { return e.props.graphsController().didSyncFail() }, requestSyncGraphs: e.props.refreshGraphs, s: e.controller.s }) }), r.createElement(i.UserBar, { controller: e.props.controller, openSearch: e.openSearch.bind(e), closeSearch: e.closeSearch.bind(e), updateFilter: e.updateFilter.bind(e), isSearching: function () { return e.state === C }, s: e.controller.s })) }), r.createElement("div", { class: r.const("dcg-scrollable"), didMount: this.didMountScrollable.bind(this) }, r.createElement("div", { class: r.const("dcg-scrollable-interior") }, r.createElement(y, { predicate: this.props.maintenanceMode }, function () { return r.createElement("div", { class: r.const("maintenance-mode") }, function () { return e.controller.s("account-shell-text-mygraphs-maintenance-mode") }) }), r.createElement(y, { predicate: this.props.previewMode }, function () { return r.createElement("div", { class: r.const("maintenance-mode") }, function () { var t; return null === (t = e.props.previewMode()) || void 0 === t ? void 0 : t.message }, r.createElement("br", null), r.createElement("a", { tabindex: r.const("0"), class: r.const("dcg-btn-primary"), href: function () { var t; return null === (t = e.props.previewMode()) || void 0 === t ? void 0 : t.url }, target: r.const("_blank") }, function () { return e.controller.s("account-shell-text-mygraphs-share-thoughts") })) }), r.createElement(y, { predicate: function () { return e.state !== C && e.controller.shouldShowArtContestNudge() } }, function () { return r.createElement("div", { onTap: function (t) { e.controller.dispatch({ type: "show-modal", modal: "contest-submission", device: t.device }) }, class: r.const("dcg-sidebar-contest-submit") }, r.createElement("span", { class: r.const("dcg-trophy-icon") }, r.const("ð")), r.createElement(v.Localize, { i18n: e.const(e.controller), key: e.const("account-shell-text-mygraphs-submit-to-contest") }, r.createElement("span", { class: r.const("dcg-contest-submit-message") }, r.const("Submit this graph to the"), r.const(" "), r.createElement("span", { class: r.const("dcg-bold-text") }, r.const("Global Math Art Contest!"))))) }), r.createElement(y, { predicate: function () { return e.state !== C } }, function () { return r.createElement("div", { role: r.const("link"), tabindex: r.const("0"), class: r.const("new-blank-graph dcg-action-newblankgraph"), onTap: function () { return e.previewItem(null), e.props.openBlankGraph() }, didMount: e.didMountNewGraph.bind(e) }, r.createElement("div", { class: r.const("new-blank-graph-inner") }, r.createElement("span", { class: r.const("dcg-add-blank") }, r.createElement("i", { class: r.const("dcg-icon-plus"), "aria-hidden": r.const("true") })), r.createElement("span", { class: r.const("dcg-new-graph-title") }, function () { return "geometry" === e.props.controller().getProduct() ? e.controller.s("account-shell-text-mygraphs-new-construction") : e.controller.s("account-shell-text-mygraphs-new-blank-graph") }))) }), r.createElement(y, { predicate: function () { return !e.props.maintenanceMode() && !e.props.previewMode() && e.controller.userController.isLoggedIn() && e.state !== C } }, function () { return r.createElement("div", null, r.createElement(d.default, { title: function () { return "geometry" === e.props.controller().getProduct() ? e.controller.s("account-shell-text-mygraphs-current-construction") : e.controller.s("account-shell-text-mygraphs-current-graph") } }), r.createElement(l.GraphInProgress, { getTitle: function () { return e.getPreviewTitle() }, getDisplayDate: function () { return e.controller.unpack(e.props.graphsController().getCurrentDisplayDate()) }, isOpen: e.props.isOpen, getThumbnail: e.props.getThumbnail, isSaveEnabled: e.props.isSaveEnabled, simpleSave: function () { return e.props.simpleSave(), e.previewItem(null) }, openSaveDialog: function () { return e.props.openSaveDialog(), e.previewItem(null) }, wasCurrentGraphEverSaved: function () { return e.props.graphsController().wasCurrentGraphEverSaved() }, isSaving: function () { return e.props.graphsController().isSaving() }, didSaveRecentlySucceed: function () { return e.props.graphsController().didSaveSucceed() }, didSaveRecentlyFail: function () { return e.props.graphsController().didSaveFail() }, s: e.controller.s }), r.createElement(y, { predicate: e.bindFn(e.shouldShowAttemptRecoveryText) }, function () { return r.createElement("div", { class: r.const("dcg-lost-work-link") }, w(function () { return e.isAttemptingRecovery() }, { true: function () { return r.createElement("span", null, r.createElement("span", null, function () { return e.controller.s("account-shell-text-mygraphs-attempting-recovery") }), r.createElement("span", { class: r.const("dcg-spinner-dark") })) }, false: function () { return r.createElement("span", null, r.createElement("span", null, function () { return e.controller.s("account-shell-text-mygraphs-lost-work") + " " }), r.createElement("span", { tabIndex: r.const(0), role: r.const("link"), class: r.const("dcg-attempt-recovery"), onTap: e.bindFn(e.attemptRecovery) }, function () { return e.controller.s("account-shell-button-mygraphs-attempt-recovery") })) } })) })) }), r.createElement(y, { predicate: function () { return !e.props.maintenanceMode() && !e.props.previewMode() && e.controller.userController.isLoggedIn() && e.hasAttemptedRecovery() && e.state !== C } }, function () { return r.createElement("div", null, w(function () { return e.getRecoveryGraphs().length }, { true: function () { return r.createElement("div", { class: r.const("dcg-recovery-graphs-list") }, r.createElement(d.default, { title: function () { return e.controller.s("account-shell-heading-mygraphs-recovered-work") } }), r.createElement(G, { each: function () { return e.getRecoveryGraphs() }, key: function (e) { return e.getCollectionKey() } }, r.createElement("div", { role: r.const("list") }, function (t) { return r.createElement(a.Item, { onTap: function (r) { return e.onTapGraph(t, r) }, onFocus: function () { return e.onFocusGraph(t) }, cancelDeleteGraph: function () { return e.props.graphsController().cancelDeleteGraph(t) }, requestDeleteGraph: function () { return e.logRecoveryClientEvent("delete"), e.previewItem(null), e.props.graphsController().requestDeleteGraph(t) }, isDeletingGraph: function () { return e.props.graphsController().isDeletingGraph(t) }, canCancelDelete: function () { return e.props.graphsController().canCancelDelete(t) }, didDeleteGraphFail: function () { return e.props.graphsController().didDeleteGraphFail(t) }, isSelected: function () { return t === e.previewGraph }, isExample: r.const(!1), getDisplayDate: function () { return e.controller.unpack(t.displayDate()) }, getTitle: function () { return e.sanitizeTitle(t) }, getThumbURL: function () { return t.thumbURL }, s: e.controller.s }) }))) }, false: function () { return r.createElement("div", { class: r.const("dcg-no-recovery-graphs") }, function () { return e.controller.s("account-shell-text-mygraphs-no-unsaved-graphs") }) } })) }), r.createElement(y, { predicate: function () { return e.controller.userController.isLoggedIn() } }, function () { return r.createElement(d.default, { title: function () { return "geometry" === e.props.controller().getProduct() ? e.controller.s("account-shell-heading-mygraphs-saved-constructions") : e.controller.s("account-shell-heading-mygraphs-saved-graphs") } }) }), r.createElement(G, { each: function () { return e.sliceGraphs(e.filterGraphs(e.getSavedGraphs())) }, key: function (e) { return e.getCollectionKey() } }, r.createElement("div", { class: r.const("dcg-saved-graphs-list"), role: r.const("list") }, function (t) { return r.createElement(a.Item, { onTap: function (r) { return e.onTapGraph(t, r) }, onFocus: function () { return e.onFocusGraph(t) }, cancelDeleteGraph: function () { return e.props.graphsController().cancelDeleteGraph(t) }, requestDeleteGraph: function () { return e.previewItem(null), e.props.graphsController().requestDeleteGraph(t) }, isDeletingGraph: function () { return e.props.graphsController().isDeletingGraph(t) }, canCancelDelete: function () { return e.props.graphsController().canCancelDelete(t) }, didDeleteGraphFail: function () { return e.props.graphsController().didDeleteGraphFail(t) }, isSelected: function () { return t === e.previewGraph }, isExample: r.const(!1), getDisplayDate: function () { return e.controller.unpack(t.displayDate()) }, getTitle: function () { return e.sanitizeTitle(t) }, getThumbURL: function () { return t.thumbURL }, s: e.controller.s }) })), r.createElement(y, { predicate: function () { return e.controller.userController.isLoggedIn() && 0 === e.filterGraphs(e.getSavedGraphs()).length } }, function () { return r.createElement("div", { "aria-live": r.const("assertive"), "aria-atomic": r.const("true"), class: r.const("no-matches") }, function () { return e.state === C ? e.controller.s("account-shell-text-mygraphs-no-search-results") : e.controller.s("account-shell-text-mygraphs-no-saved-graphs") }) }), r.createElement(y, { predicate: function () { return e.canShowMore(e.filterGraphs(e.getSavedGraphs())) } }, function () { return r.createElement("div", { class: r.const("dcg-show-more-graphs"), onTap: e.showMoreGraphs.bind(e), role: r.const("button"), tabindex: r.const(0) }, function () { return e.controller.s("account-shell-text-mygraphs-count-more", { count: e.getCountRemaining() }) }) }), r.createElement(d.default, { title: function () { return e.controller.s("account-shell-heading-mygraphs-examples") } }), r.createElement(G, { each: function () { return e.filterGraphs(e.getExampleGraphs()) }, key: function (e) { return e.getCollectionKey() } }, r.createElement("div", { role: r.const("list") }, function (t) { return r.createElement(a.Item, { onTap: function (r) { return e.onTapGraph(t, r) }, onFocus: function () { return e.onFocusGraph(t) }, cancelDeleteGraph: function () { }, requestDeleteGraph: function () { }, isDeletingGraph: r.const(!1), didDeleteGraphFail: r.const(!1), canCancelDelete: r.const(!1), isSelected: function () { return t === e.previewGraph }, isExample: r.const(!0), getDisplayDate: function () { return e.controller.unpack(t.displayDate()) }, getTitle: function () { return e.sanitizeTitle(t) }, getThumbURL: function () { return t.thumbURL }, s: e.controller.s }) })), r.createElement(y, { predicate: function () { return !!e.getFilter() && 0 === e.filterGraphs(e.getExampleGraphs()).length } }, function () { return r.createElement("div", { "aria-live": r.const("assertive"), "aria-atomic": r.const("true"), class: r.const("no-matches") }, function () { return e.controller.s("account-shell-text-mygraphs-no-examples-match-search") }) }), r.createElement("div", { class: r.const("dcg-mygraphs-legal") }, r.createElement("a", { href: r.const("/terms"), target: r.const("_blank") }, function () { return e.controller.s("account-shell-link-terms") }), r.const("|"), r.createElement("a", { href: r.const("/privacy"), target: r.const("_blank") }, function () { return e.controller.s("account-shell-link-privacy") }), r.createElement(y, { predicate: function () { return !!e.props.versionNumber() } }, function () { return r.createElement("div", { class: r.const("dcg-version") }, function () { return e.controller.s("account-shell-text-mygraphs-version") }, r.const(" "), e.props.versionNumber) })))), r.createElement(y, { predicate: function () { return e.previewGraph } }, function () { return r.createElement(s.GraphPreview, { alignToNode: function () { return e.getSelectedNode() }, getTitle: function () { if (null != e.previewGraph) return e.sanitizeTitle(e.previewGraph) }, getGraphData: function () { return null != e.previewGraph ? e.previewGraph.graphData : void 0 }, onCancel: function () { return e.previewItem(null) }, didDataLoadFail: function () { return e.didDataLoadFail(e.previewGraph) }, requestLoadGraphData: e.fetchSelectedGraph.bind(e), onOpenGraph: e.onOpenPreviewGraph.bind(e), s: e.controller.s, makeAPI: e.props.makeAPI, getOpenText: function () { return e.controller.getOpenText() } }) })), r.createElement(y, { predicate: this.props.isOpen }, function () { return r.createElement("div", { role: r.const("link"), tabindex: r.const(0), class: r.const("dcg-resources-cover dcg-action-close-resources"), style: function () { return { opacity: null != e.previewGraph ? .6 : 0 } }, onTap: function () { return null != e.previewGraph ? e.previewItem(null) : e.props.closeDrawer() }, "aria-label": function () { return null != e.previewGraph ? e.controller.s("account-shell-button-mygraphs-close-graph-preview") : e.controller.s("account-shell-button-mygraphs-close-graph-list") } }) }), r.createElement(y, { predicate: function () { return null != e.graphWithCover } }, function () { return r.createElement("div", { class: r.const("dcg-fullscreen-loading-container") }, r.createElement(y, { predicate: function () { return null != (null != e.graphWithCover ? e.graphWithCover.graphData : void 0) } }, function () { return r.createElement("div", { "aria-live": r.const("assertive"), "aria-atomic": r.const("true"), class: r.const("dcg-graph-loading") }, r.createElement("div", { class: r.const("pulsing-message") }, function () { return e.controller.s("account-shell-text-mygraphs-opening") }), r.createElement("div", { class: r.const("slow-loading") }, function () { return e.getSlowLoadingText() })) }), r.createElement(y, { predicate: function () { return null == (null != e.graphWithCover ? e.graphWithCover.graphData : void 0) } }, function () { return r.createElement(u.LoadGraphView, { didDataLoadFail: function () { return e.didDataLoadFail(e.graphWithCover) }, onCancel: e.cancelLoadGraphWithCover.bind(e), requestLoadGraphData: function () { return e.openGraphWithCover(e.graphWithCover) }, s: e.controller.s }) })) })) }, f.prototype.getPreviewTitle = function () { return this.graphsController.getCurrentGraphTitle() || this.graphsController.getUntitledString() }, f.prototype.getSlowLoadingText = function () { return "graphing" === this.graphsController.product ? this.controller.s("account-shell-text-mygraphs-slow-big-graphs") : "geometry" === this.graphsController.product ? this.controller.s("account-shell-text-mygraphs-slow-big-constructions") : "" }, f.prototype.logRecoveryClientEvent = function (e) { m.logJSON("recovered-graph", { product: this.controller.graphsController.product, timeSincePageload: Date.now() - this.controller.mygraphsController.pageLoadTime, payloadJSON: { action: e } }) }, f }(r.Class); e.Mygraphs = b });
define('mygraphs/wrapper', ["require", "exports", "lib/app-bridge", "tslib", "dcgview", "./mygraphs"], function (require, r, n, e, o, t) { "use strict"; Object.defineProperty(r, "__esModule", { value: !0 }), r.MygraphsWrapper = void 0; var l = function (r) { function l() { return null !== r && r.apply(this, arguments) || this } return e.__extends(l, r), l.prototype.init = function () { this.controller = this.props.controller(), this.graphsController = this.controller.graphsController, this.mygraphsController = this.controller.mygraphsController }, l.prototype.template = function () { var r = this; return o.createElement(t.Mygraphs, { isOpen: function () { return r.mygraphsController.isMygraphsOpen() }, graphsController: function () { return r.graphsController }, maintenanceMode: function () { return r.controller.isInMaintenanceMode() }, previewMode: function () { return r.controller.getPreviewParams() }, accountsEnabled: this.const(!0), controller: function () { return r.controller }, closeDrawer: function () { return r.controller.dispatch({ type: "close-mygraphs" }) }, openBlankGraph: function () { return r.mygraphsController.openBlankGraph() }, onOpenGraph: function (n) { return r.mygraphsController.onOpenGraph(n) }, openGraphBehindCover: function (n) { return r.mygraphsController.openGraphBehindCover(n) }, onLogout: function () { return r.controller.userController.logout() }, onEditAccount: function () { return r.controller.dispatch({ type: "show-modal", modal: "account-settings", device: "mouse" }) }, onCreateAccount: function () { return r.controller.dispatch({ type: "show-modal", modal: "signup", device: "mouse" }) }, onSignIn: function () { return r.controller.dispatch({ type: "show-modal", modal: "login", device: "mouse" }) }, refreshGraphs: function () { return r.graphsController.refreshGraphs() }, getThumbnail: function () { return r.mygraphsController.getThumbnail() }, simpleSave: function () { return r.controller.simpleSave() }, openSaveDialog: function () { return r.controller.openSaveDialog({ fromSaveInProgress: !0 }) }, versionNumber: function () { return n.versionNumber }, isSaveEnabled: function () { return r.controller.isSaveEnabled() }, makeAPI: this.props.makeAPI }) }, l }(o.Class); r.MygraphsWrapper = l });
!function (e) { if ("object" == typeof exports && "undefined" != typeof module) module.exports = e(); else if ("function" == typeof define && define.amd) define('vendor/bugsnag', [], e); else { ("undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : this).bugsnag = e() } }(function () { var e = function (e, t, n) { for (var r = n, o = 0, i = e.length; o < i; o++)r = t(r, e[o], o, e); return r }, t = !{ toString: null }.propertyIsEnumerable("toString"), n = ["toString", "toLocaleString", "valueOf", "hasOwnProperty", "isPrototypeOf", "propertyIsEnumerable", "constructor"], r = function (e) { return e < 10 ? "0" + e : e }, o = function (t, n) { return e(t, function (e, t, r, o) { return e.concat(n(t, r, o)) }, []) }, i = e, a = function (t, n) { return e(t, function (e, t, r, o) { return n(t, r, o) ? e.concat(t) : e }, []) }, s = function (t, n) { return e(t, function (e, t, r, o) { return !0 === e || t === n }, !1) }, u = function (e) { return "[object Array]" === Object.prototype.toString.call(e) }, c = function () { var e = new Date; return e.getUTCFullYear() + "-" + r(e.getUTCMonth() + 1) + "-" + r(e.getUTCDate()) + "T" + r(e.getUTCHours()) + ":" + r(e.getUTCMinutes()) + ":" + r(e.getUTCSeconds()) + "." + (e.getUTCMilliseconds() / 1e3).toFixed(3).slice(2, 5) + "Z" }, f = { intRange: function (e, t) { return void 0 === e && (e = 1), void 0 === t && (t = 1 / 0), function (n) { return "number" == typeof n && parseInt("" + n, 10) === n && n >= e && n <= t } }, stringWithLength: function (e) { return "string" == typeof e && !!e.length } }, l = {}, d = a, g = i, p = function (e) { var r, o = []; for (r in e) Object.prototype.hasOwnProperty.call(e, r) && o.push(r); if (!t) return o; for (var i = 0, a = n.length; i < a; i++)Object.prototype.hasOwnProperty.call(e, n[i]) && o.push(n[i]); return o }, h = u, v = s, m = f.intRange, y = f.stringWithLength; function b() { return (b = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } l.schema = { apiKey: { defaultValue: function () { return null }, message: "is required", validate: y }, appVersion: { defaultValue: function () { return null }, message: "should be a string", validate: function (e) { return null === e || y(e) } }, appType: { defaultValue: function () { return null }, message: "should be a string", validate: function (e) { return null === e || y(e) } }, autoNotify: { defaultValue: function () { return !0 }, message: "should be true|false", validate: function (e) { return !0 === e || !1 === e } }, beforeSend: { defaultValue: function () { return [] }, message: "should be a function or array of functions", validate: function (e) { return "function" == typeof e || h(e) && d(e, function (e) { return "function" == typeof e }).length === e.length } }, endpoints: { defaultValue: function () { return { notify: "https://notify.bugsnag.com", sessions: "https://sessions.bugsnag.com" } }, message: "should be an object containing endpoint URLs { notify, sessions }. sessions is optional if autoCaptureSessions=false", validate: function (e, t) { return e && "object" == typeof e && y(e.notify) && (!1 === t.autoCaptureSessions || y(e.sessions)) && 0 === d(p(e), function (e) { return !v(["notify", "sessions"], e) }).length } }, autoCaptureSessions: { defaultValue: function (e, t) { return void 0 === t.endpoints || !!t.endpoints && !!t.endpoints.sessions }, message: "should be true|false", validate: function (e) { return !0 === e || !1 === e } }, notifyReleaseStages: { defaultValue: function () { return null }, message: "should be an array of strings", validate: function (e) { return null === e || h(e) && d(e, function (e) { return "string" == typeof e }).length === e.length } }, releaseStage: { defaultValue: function () { return "production" }, message: "should be a string", validate: function (e) { return "string" == typeof e && e.length } }, maxBreadcrumbs: { defaultValue: function () { return 20 }, message: "should be a number â¤40", validate: function (e) { return m(0, 40)(e) } }, autoBreadcrumbs: { defaultValue: function () { return !0 }, message: "should be true|false", validate: function (e) { return "boolean" == typeof e } }, user: { defaultValue: function () { return null }, message: "(object) user should be an object", validate: function (e) { return "object" == typeof e } }, metaData: { defaultValue: function () { return null }, message: "should be an object", validate: function (e) { return "object" == typeof e } }, logger: { defaultValue: function () { }, message: "should be null or an object with methods { debug, info, warn, error }", validate: function (e) { return !e || e && g(["debug", "info", "warn", "error"], function (t, n) { return t && "function" == typeof e[n] }, !0) } }, filters: { defaultValue: function () { return ["password"] }, message: "should be an array of strings|regexes", validate: function (e) { return h(e) && e.length === d(e, function (e) { return "string" == typeof e || e && "function" == typeof e.test }).length } } }, l.mergeDefaults = function (e, t) { if (!e || !t) throw new Error("opts and schema objects are required"); return g(p(t), function (n, r) { return n[r] = void 0 !== e[r] ? e[r] : t[r].defaultValue(e[r], e), n }, {}) }, l.validate = function (e, t) { if (!e || !t) throw new Error("opts and schema objects are required"); var n = g(p(t), function (n, r) { return t[r].validate(e[r], e) ? n : n.concat({ key: r, message: t[r].message, value: e[r] }) }, []); return { valid: !n.length, errors: n } }; var S = l.schema, w = o, O = { releaseStage: { defaultValue: function () { return /^localhost(:\d+)?$/.test(window.location.host) ? "development" : "production" }, message: "should be set", validate: f.stringWithLength }, logger: b({}, S.logger, { defaultValue: function () { return "undefined" != typeof console && "function" == typeof console.debug ? j() : void 0 } }) }, j = function () { var e = {}, t = console.log; return w(["debug", "info", "warn", "error"], function (n) { var r = console[n]; e[n] = "function" == typeof r ? r.bind(console, "[bugsnag]") : t.bind(console, "[bugsnag]") }), e }, E = c, N = function () { function e(e, t, n, r) { void 0 === e && (e = "[anonymous]"), void 0 === t && (t = {}), void 0 === n && (n = "manual"), void 0 === r && (r = E()), this.type = n, this.name = e, this.metaData = t, this.timestamp = r } return e.prototype.toJSON = function () { return { type: this.type, name: this.name, timestamp: this.timestamp, metaData: this.metaData } }, e }(), B = function (e) { return e.app && "string" == typeof e.app.releaseStage ? e.app.releaseStage : e.config.releaseStage }; var R = function (e) { switch (Object.prototype.toString.call(e)) { case "[object Error]": case "[object Exception]": case "[object DOMException]": return !0; default: return e instanceof Error } }, k = function (e, t) { return e.isIgnored() || !1 === t }, _ = {}; !function (e, t) { "use strict"; "object" == typeof _ ? _ = t() : e.StackFrame = t() }(this, function () { "use strict"; function e(e) { return !isNaN(parseFloat(e)) && isFinite(e) } function t(e) { return e.charAt(0).toUpperCase() + e.substring(1) } function n(e) { return function () { return this[e] } } var r = ["isConstructor", "isEval", "isNative", "isToplevel"], o = ["columnNumber", "lineNumber"], i = ["fileName", "functionName", "source"], a = r.concat(o, i, ["args"]); function s(e) { if (e instanceof Object) for (var n = 0; n < a.length; n++)e.hasOwnProperty(a[n]) && void 0 !== e[a[n]] && this["set" + t(a[n])](e[a[n]]) } s.prototype = { getArgs: function () { return this.args }, setArgs: function (e) { if ("[object Array]" !== Object.prototype.toString.call(e)) throw new TypeError("Args must be an Array"); this.args = e }, getEvalOrigin: function () { return this.evalOrigin }, setEvalOrigin: function (e) { if (e instanceof s) this.evalOrigin = e; else { if (!(e instanceof Object)) throw new TypeError("Eval Origin must be an Object or StackFrame"); this.evalOrigin = new s(e) } }, toString: function () { return (this.getFunctionName() || "{anonymous}") + ("(" + (this.getArgs() || []).join(",") + ")") + (this.getFileName() ? "@" + this.getFileName() : "") + (e(this.getLineNumber()) ? ":" + this.getLineNumber() : "") + (e(this.getColumnNumber()) ? ":" + this.getColumnNumber() : "") } }; for (var u = 0; u < r.length; u++)s.prototype["get" + t(r[u])] = n(r[u]), s.prototype["set" + t(r[u])] = function (e) { return function (t) { this[e] = Boolean(t) } }(r[u]); for (var c = 0; c < o.length; c++)s.prototype["get" + t(o[c])] = n(o[c]), s.prototype["set" + t(o[c])] = function (t) { return function (n) { if (!e(n)) throw new TypeError(t + " must be a Number"); this[t] = Number(n) } }(o[c]); for (var f = 0; f < i.length; f++)s.prototype["get" + t(i[f])] = n(i[f]), s.prototype["set" + t(i[f])] = function (e) { return function (t) { this[e] = String(t) } }(i[f]); return s }); var D = {}; !function (e, t) { "use strict"; "object" == typeof D ? D = t(_) : e.ErrorStackParser = t(e.StackFrame) }(this, function (e) { "use strict"; var t = /(^|@)\S+\:\d+/, n = /^\s*at .*(\S+\:\d+|\(native\))/m, r = /^(eval@)?(\[native code\])?$/; return { parse: function (e) { if (void 0 !== e.stacktrace || void 0 !== e["opera#sourceloc"]) return this.parseOpera(e); if (e.stack && e.stack.match(n)) return this.parseV8OrIE(e); if (e.stack) return this.parseFFOrSafari(e); throw new Error("Cannot parse given Error object") }, extractLocation: function (e) { if (-1 === e.indexOf(":")) return [e]; var t = /(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g, "")); return [t[1], t[2] || void 0, t[3] || void 0] }, parseV8OrIE: function (t) { return t.stack.split("\n").filter(function (e) { return !!e.match(n) }, this).map(function (t) { t.indexOf("(eval ") > -1 && (t = t.replace(/eval code/g, "eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g, "")); var n = t.replace(/^\s+/, "").replace(/\(eval code/g, "(").split(/\s+/).slice(1), r = this.extractLocation(n.pop()), o = n.join(" ") || void 0, i = ["eval", "<anonymous>"].indexOf(r[0]) > -1 ? void 0 : r[0]; return new e({ functionName: o, fileName: i, lineNumber: r[1], columnNumber: r[2], source: t }) }, this) }, parseFFOrSafari: function (t) { return t.stack.split("\n").filter(function (e) { return !e.match(r) }, this).map(function (t) { if (t.indexOf(" > eval") > -1 && (t = t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g, ":$1")), -1 === t.indexOf("@") && -1 === t.indexOf(":")) return new e({ functionName: t }); var n = /((.*".+"[^@]*)?[^@]*)(?:@)/, r = t.match(n), o = r && r[1] ? r[1] : void 0, i = this.extractLocation(t.replace(n, "")); return new e({ functionName: o, fileName: i[0], lineNumber: i[1], columnNumber: i[2], source: t }) }, this) }, parseOpera: function (e) { return !e.stacktrace || e.message.indexOf("\n") > -1 && e.message.split("\n").length > e.stacktrace.split("\n").length ? this.parseOpera9(e) : e.stack ? this.parseOpera11(e) : this.parseOpera10(e) }, parseOpera9: function (t) { for (var n = /Line (\d+).*script (?:in )?(\S+)/i, r = t.message.split("\n"), o = [], i = 2, a = r.length; i < a; i += 2) { var s = n.exec(r[i]); s && o.push(new e({ fileName: s[2], lineNumber: s[1], source: r[i] })) } return o }, parseOpera10: function (t) { for (var n = /Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i, r = t.stacktrace.split("\n"), o = [], i = 0, a = r.length; i < a; i += 2) { var s = n.exec(r[i]); s && o.push(new e({ functionName: s[3] || void 0, fileName: s[2], lineNumber: s[1], source: r[i] })) } return o }, parseOpera11: function (n) { return n.stack.split("\n").filter(function (e) { return !!e.match(t) && !e.match(/^Error created at/) }, this).map(function (t) { var n, r = t.split("@"), o = this.extractLocation(r.pop()), i = r.shift() || "", a = i.replace(/<anonymous function(: (\w+))?>/, "$2").replace(/\([^\)]*\)/g, "") || void 0; i.match(/\(([^\)]*)\)/) && (n = i.replace(/^[^\(]+\(([^\)]*)\)$/, "$1")); var s = void 0 === n || "[arguments not available]" === n ? void 0 : n.split(","); return new e({ functionName: a, args: s, fileName: o[0], lineNumber: o[1], columnNumber: o[2], source: t }) }, this) } } }); var x = D, L = function (e) { return !(!e || !e.stack && !e.stacktrace && !e["opera#sourceloc"] || "string" != typeof (e.stack || e.stacktrace || e["opera#sourceloc"]) || e.stack === e.name + ": " + e.message) }, q = {}; function C() { return (C = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } !function (e, t) { "use strict"; "object" == typeof q ? q = t(_) : e.StackGenerator = t(e.StackFrame) }(this, function (e) { return { backtrace: function (t) { var n = [], r = 10; "object" == typeof t && "number" == typeof t.maxStackSize && (r = t.maxStackSize); for (var o = arguments.callee; o && n.length < r && o.arguments;) { for (var i = new Array(o.arguments.length), a = 0; a < i.length; ++a)i[a] = o.arguments[a]; /function(?:\s+([\w$]+))+\s*\(/.test(o.toString()) ? n.push(new e({ functionName: RegExp.$1 || void 0, args: i })) : n.push(new e({ args: i })); try { o = o.caller } catch (e) { break } } return n } } }); var T = i, M = a, P = function () { function e(e, t, n, r, o) { void 0 === n && (n = []), void 0 === r && (r = H()), this.__isBugsnagReport = !0, this._ignored = !1, this._handledState = r, this.app = void 0, this.apiKey = void 0, this.breadcrumbs = [], this.context = void 0, this.device = void 0, this.errorClass = U(e, "[no error class]"), this.errorMessage = U(t, "[no error message]"), this.groupingHash = void 0, this.metaData = {}, this.request = void 0, this.severity = this._handledState.severity, this.stacktrace = T(n, function (e, t) { var n = A(t); try { return "{}" === JSON.stringify(n) ? e : e.concat(n) } catch (t) { return e } }, []), this.user = void 0, this.session = void 0, this.originalError = o } var t = e.prototype; return t.ignore = function () { this._ignored = !0 }, t.isIgnored = function () { return this._ignored }, t.updateMetaData = function (e) { var t, n; return e ? null === (arguments.length <= 1 ? void 0 : arguments[1]) ? this.removeMetaData(e) : null === (arguments.length <= 2 ? void 0 : arguments[2]) ? this.removeMetaData(e, arguments.length <= 1 ? void 0 : arguments[1], arguments.length <= 2 ? void 0 : arguments[2]) : ("object" == typeof (arguments.length <= 1 ? void 0 : arguments[1]) && (n = arguments.length <= 1 ? void 0 : arguments[1]), "string" == typeof (arguments.length <= 1 ? void 0 : arguments[1]) && ((t = {})[arguments.length <= 1 ? void 0 : arguments[1]] = arguments.length <= 2 ? void 0 : arguments[2], n = t), n ? (this.metaData[e] || (this.metaData[e] = {}), this.metaData[e] = C({}, this.metaData[e], n), this) : this) : this }, t.removeMetaData = function (e, t) { return "string" != typeof e ? this : t ? this.metaData[e] ? (delete this.metaData[e][t], this) : this : (delete this.metaData[e], this) }, t.toJSON = function () { return { payloadVersion: "4", exceptions: [{ errorClass: this.errorClass, message: this.errorMessage, stacktrace: this.stacktrace, type: "browserjs" }], severity: this.severity, unhandled: this._handledState.unhandled, severityReason: this._handledState.severityReason, app: this.app, device: this.device, breadcrumbs: this.breadcrumbs, context: this.context, user: this.user, metaData: this.metaData, groupingHash: this.groupingHash, request: this.request, session: this.session } }, e }(), A = function (e) { var t = { file: e.fileName, method: V(e.functionName), lineNumber: e.lineNumber, columnNumber: e.columnNumber, code: void 0, inProject: void 0 }; return t.lineNumber > -1 && !t.file && !t.method && (t.file = "global code"), t }, V = function (e) { return /^global code$/i.test(e) ? "global code" : e }, H = function () { return { unhandled: !1, severity: "warning", severityReason: { type: "handledException" } } }, U = function (e, t) { return "string" == typeof e && e ? e : t }; P.getStacktrace = function (e, t, n) { return void 0 === t && (t = 0), void 0 === n && (n = 0), L(e) ? x.parse(e).slice(t) : M(q.backtrace(), function (e) { return -1 === (e.functionName || "").indexOf("StackGenerator$$") }).slice(1 + n) }, P.ensureReport = function (e, t, n) { if (void 0 === t && (t = 0), void 0 === n && (n = 0), e.__isBugsnagReport) return e; try { var r = P.getStacktrace(e, t, 1 + n); return new P(e.name, e.message, r, void 0, e) } catch (t) { return new P(e.name, e.message, [], void 0, e) } }; var $ = P, F = function (e, t) { var n = "000000000" + e; return n.substr(n.length - t) }, K = "object" == typeof window ? window : self, I = 0; for (var X in K) Object.hasOwnProperty.call(K, X) && I++; var J = navigator.mimeTypes ? navigator.mimeTypes.length : 0, z = F((J + navigator.userAgent.length).toString(36) + I.toString(36), 4), G = function () { return z }, W = 0, Y = Math.pow(36, 4); function Z() { return F((Math.random() * Y << 0).toString(36), 4) } function Q() { return "c" + (new Date).getTime().toString(36) + F((W = W < Y ? W : 0, ++W - 1).toString(36), 4) + G() + (Z() + Z()) } Q.fingerprint = G; var ee = Q, te = c, ne = function () { function e() { this.id = ee(), this.startedAt = te(), this._handled = 0, this._unhandled = 0 } var t = e.prototype; return t.toJSON = function () { return { id: this.id, startedAt: this.startedAt, events: { handled: this._handled, unhandled: this._unhandled } } }, t.trackError = function (e) { this[e._handledState.unhandled ? "_unhandled" : "_handled"] += 1 }, e }(); function re() { return (re = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var oe = o, ie = s, ae = u, se = function () { function e(t) { if (!(t && t.name && t.version && t.url)) throw new Error("`notifier` argument is required"); this.notifier = t, this._configured = !1, this._opts = {}, this.config = {}, this._delivery = { sendSession: function () { }, sendReport: function () { } }, this._logger = { debug: function () { }, info: function () { }, warn: function () { }, error: function () { } }, this._plugins = {}, this._session = null, this.breadcrumbs = [], this.app = {}, this.context = void 0, this.device = void 0, this.metaData = void 0, this.request = void 0, this.user = {}, this.BugsnagClient = e, this.BugsnagReport = $, this.BugsnagBreadcrumb = N, this.BugsnagSession = ne; var n = this, r = this.notify; this.notify = function () { return r.apply(n, arguments) } } var t = e.prototype; return t.setOptions = function (e) { this._opts = re({}, this._opts, e) }, t.configure = function (e) { void 0 === e && (e = l.schema); var t = l.mergeDefaults(this._opts, e), n = l.validate(t, e); if (!0 == !n.valid) throw new Error(fe(n.errors)); return "function" == typeof t.beforeSend && (t.beforeSend = [t.beforeSend]), t.appVersion && (this.app.version = t.appVersion), t.appType && (this.app.type = t.appType), t.metaData && (this.metaData = t.metaData), t.user && (this.user = t.user), t.logger && this.logger(t.logger), this.config = re({}, this.config, t), this._configured = !0, this }, t.use = function (e) { if (!this._configured) throw new Error("client not configured"); e.configSchema && this.configure(e.configSchema); for (var t = arguments.length, n = new Array(t > 1 ? t - 1 : 0), r = 1; r < t; r++)n[r - 1] = arguments[r]; var o = e.init.apply(e, [this].concat(n)); return e.name && (this._plugins["~" + e.name + "~"] = o), this }, t.getPlugin = function (e) { return this._plugins["~" + e + "~"] }, t.delivery = function (e) { return this._delivery = e, this }, t.logger = function (e, t) { return this._logger = e, this }, t.sessionDelegate = function (e) { return this._sessionDelegate = e, this }, t.startSession = function () { return this._sessionDelegate ? this._sessionDelegate.startSession(this) : (this._logger.warn("No session implementation is installed"), this) }, t.leaveBreadcrumb = function (e, t, n, r) { if (!this._configured) throw new Error("client not configured"); if (n = "string" == typeof n ? n : void 0, r = "string" == typeof r ? r : void 0, t = "object" == typeof t && null !== t ? t : void 0, "string" == typeof (e = e || void 0) || t) { var o = new N(e, t, n, r); return this.breadcrumbs.push(o), this.breadcrumbs.length > this.config.maxBreadcrumbs && (this.breadcrumbs = this.breadcrumbs.slice(this.breadcrumbs.length - this.config.maxBreadcrumbs)), this } }, t.notify = function (e, t, n) { var r = this; if (void 0 === t && (t = {}), void 0 === n && (n = function () { }), !this._configured) throw new Error("client not configured"); var o = B(this), i = ue(e, t, this._logger), a = i.err, s = i.errorFramesToSkip, u = i._opts; u && (t = u), "object" == typeof t && null !== t || (t = {}); var c = $.ensureReport(a, s, 2); if (c.app = re({}, { releaseStage: o }, c.app, this.app), c.context = c.context || t.context || this.context || void 0, c.device = re({}, c.device, this.device, t.device), c.request = re({}, c.request, this.request, t.request), c.user = re({}, c.user, this.user, t.user), c.metaData = re({}, c.metaData, this.metaData, t.metaData), c.breadcrumbs = this.breadcrumbs.slice(0), this._session && (this._session.trackError(c), c.session = this._session), void 0 !== t.severity && (c.severity = t.severity, c._handledState.severityReason = { type: "userSpecifiedSeverity" }), ae(this.config.notifyReleaseStages) && !ie(this.config.notifyReleaseStages, o)) return this._logger.warn("Report not sent due to releaseStage/notifyReleaseStages configuration"), n(null, c); var f = c.severity, l = [].concat(t.beforeSend).concat(this.config.beforeSend), d = function (e) { r._logger.error("Error occurred in beforeSend callback, continuing anywayâ¦"), r._logger.error(e) }; !function (e, t, n) { var r = e.length, o = 0, i = function () { if (o >= r) return n(null, !1); t(e[o], function (e, t) { return e ? n(e, !1) : !0 === t ? n(null, !0) : (o++, void i()) }) }; i() }(l, function (e, t) { return function (n, r) { if ("function" != typeof n) return r(null, !1); try { if (2 !== n.length) { var o = n(e); return o && "function" == typeof o.then ? o.then(function (t) { return setTimeout(function () { return r(null, k(e, t)) }, 0) }, function (e) { setTimeout(function () { return t(e), r(null, !1) }) }) : r(null, k(e, o)) } n(e, function (n, o) { if (n) return t(n), r(null, !1); r(null, k(e, o)) }) } catch (e) { t(e), r(null, !1) } } }(c, d), function (e, t) { if (e && d(e), t) return r._logger.debug("Report not sent due to beforeSend callback"), n(null, c); r.config.autoBreadcrumbs && r.leaveBreadcrumb(c.errorClass, { errorClass: c.errorClass, errorMessage: c.errorMessage, severity: c.severity }, "error"), f !== c.severity && (c._handledState.severityReason = { type: "userCallbackSetSeverity" }), r._delivery.sendReport(r._logger, r.config, { apiKey: c.apiKey || r.config.apiKey, notifier: r.notifier, events: [c] }, function (e) { return n(e, c) }) }) }, e }(), ue = function (e, t, n) { var r, o, i = function (e) { var t = le(e); return n.warn("Usage error. " + t), new Error("Bugsnag usage error. " + t) }, a = 0; switch (typeof e) { case "string": "string" == typeof t ? (r = i("string/string"), o = { metaData: { notifier: { notifyArgs: [e, t] } } }) : (r = new Error(String(e)), a = 3); break; case "number": case "boolean": r = new Error(String(e)); break; case "function": r = i("function"); break; case "object": null !== e && (R(e) || e.__isBugsnagReport) ? r = e : null !== e && ce(e) ? ((r = new Error(e.message || e.errorMessage)).name = e.name || e.errorClass, a = 3) : r = i(null === e ? "null" : "unsupported object"); break; default: r = i("nothing") }return { err: r, errorFramesToSkip: a, _opts: o } }, ce = function (e) { return !("string" != typeof e.name && "string" != typeof e.errorClass || "string" != typeof e.message && "string" != typeof e.errorMessage) }, fe = function (e) { return "Bugsnag configuration error\n" + oe(e, function (e) { return '"' + e.key + '" ' + e.message + " \n    got " + de(e.value) }).join("\n\n") }, le = function (e) { return "notify() expected error/opts parameters, got " + e }, de = function (e) { return "object" == typeof e ? JSON.stringify(e) : String(e) }, ge = se, pe = function (e, t, n, r) { var o = r && r.filterKeys ? r.filterKeys : [], i = r && r.filterPaths ? r.filterPaths : []; return JSON.stringify(function (e, t, n) { var r = [], o = 0; function i(e, a) { function s() { return a.length > 8 && o > 25e3 } if (o++, a.length > 20) return he; if (s()) return he; if (null === e || "object" != typeof e) return e; if (function (e, t) { for (var n = 0, r = e.length; n < r; n++)if (e[n] === t) return !0; return !1 }(r, e)) return "[Circular]"; if (r.push(e), "function" == typeof e.toJSON) try { o--; var u = i(e.toJSON(), a); return r.pop(), u } catch (e) { return ve(e) } var c; if ((c = e) instanceof Error || /^\[object (Error|(Dom)?Exception)\]$/.test(Object.prototype.toString.call(c))) { o--; var f = i({ name: e.name, message: e.message }, a); return r.pop(), f } if (function (e) { return "[object Array]" === Object.prototype.toString.call(e) }(e)) { for (var l = [], d = 0, g = e.length; d < g; d++) { if (s()) { l.push(he); break } l.push(i(e[d], a.concat("[]"))) } return r.pop(), l } var p = {}; try { for (var h in e) if (Object.prototype.hasOwnProperty.call(e, h)) if (me(n, a.join(".")) && ye(t, h)) p[h] = "[Filtered]"; else { if (s()) { p[h] = he; break } p[h] = i(be(e, h), a.concat(h)) } } catch (e) { } return r.pop(), p } return i(e, []) }(e, o, i), t, n) }, he = "..."; function ve(e) { return "[Throws: " + (e ? e.message : "?") + "]" } function me(e, t) { for (var n = 0, r = e.length; n < r; n++)if (0 === t.indexOf(e[n])) return !0; return !1 } function ye(e, t) { for (var n = 0, r = e.length; n < r; n++) { if ("string" == typeof e[n] && e[n] === t) return !0; if (e[n] && "function" == typeof e[n].test && e[n].test(t)) return !0 } return !1 } function be(e, t) { try { return e[t] } catch (e) { return ve(e) } } var Se = {}, we = ["events.[].app", "events.[].metaData", "events.[].user", "events.[].breadcrumbs", "events.[].request", "events.[].device"], Oe = ["device", "app", "user"]; Se.report = function (e, t) { var n = pe(e, null, null, { filterPaths: we, filterKeys: t }); if (n.length > 1e6 && (delete e.events[0].metaData, e.events[0].metaData = { notifier: "WARNING!\nSerialized payload was " + n.length / 1e6 + "MB (limit = 1MB)\nmetaData was removed" }, (n = pe(e, null, null, { filterPaths: we, filterKeys: t })).length > 1e6)) throw new Error("payload exceeded 1MB limit"); return n }, Se.session = function (e, t) { var n = pe(e, null, null, { filterPaths: Oe, filterKeys: t }); if (n.length > 1e6) throw new Error("payload exceeded 1MB limit"); return n }; var je, Ee = c; je = function (e) { return void 0 === e && (e = window), { sendReport: function (t, n, r, o) { void 0 === o && (o = function () { }); var i = Ne(n, "notify", "4", e), a = new e.XDomainRequest; a.onload = function () { o(null) }, a.open("POST", i), setTimeout(function () { try { a.send(Se.report(r, n.filters)) } catch (e) { t.error(e), o(e) } }, 0) }, sendSession: function (t, n, r, o) { void 0 === o && (o = function () { }); var i = Ne(n, "sessions", "1", e), a = new e.XDomainRequest; a.onload = function () { o(null) }, a.open("POST", i), setTimeout(function () { try { a.send(Se.session(r, n.filters)) } catch (e) { t.error(e), o(e) } }, 0) } } }; var Ne = function (e, t, n, r) { return Be(e.endpoints[t], r.location.protocol) + "?apiKey=" + encodeURIComponent(e.apiKey) + "&payloadVersion=" + n + "&sentAt=" + encodeURIComponent(Ee()) }, Be = je._matchPageProtocol = function (e, t) { return "http:" === t ? e.replace(/^https:/, "http:") : e }, Re = c, ke = { init: function (e, t) { void 0 === t && (t = window), e.config.beforeSend.unshift(function (e) { e.context || (e.context = t.location.pathname) }) } }; function _e() { return (_e = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var De = c, xe = { init: function (e, t) { void 0 === t && (t = navigator); var n = { locale: t.browserLanguage || t.systemLanguage || t.userLanguage || t.language, userAgent: t.userAgent }; e.device = _e({}, n, e.device), e.config.beforeSend.unshift(function (e) { e.device = _e({}, e.device, { time: De() }) }) } }; function Le() { return (Le = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var qe = { init: function (e, t) { void 0 === t && (t = window), e.config.beforeSend.unshift(function (e) { e.request && e.request.url || (e.request = Le({}, e.request, { url: t.location.href })) }) } }; function Ce() { return (Ce = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var Te = u, Me = s, Pe = { init: function (e) { return e.sessionDelegate(Ae) } }, Ae = { startSession: function (e) { var t = e; t._session = new e.BugsnagSession; var n = B(t); return Te(t.config.notifyReleaseStages) && !Me(t.config.notifyReleaseStages, n) ? (t._logger.warn("Session not sent due to releaseStage/notifyReleaseStages configuration"), t) : t.config.endpoints.sessions ? (t._delivery.sendSession(t._logger, t.config, { notifier: t.notifier, device: t.device, app: Ce({}, { releaseStage: n }, t.app), sessions: [{ id: t._session.id, startedAt: t._session.startedAt, user: t.user }] }), t) : (t._logger.warn("Session not sent due to missing endpoints.sessions configuration"), t) } }; function Ve() { return (Ve = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var He = { init: function (e) { e.config.collectUserIp || e.config.beforeSend.push(function (e) { e.user && void 0 === e.user.id && delete e.user.id, e.user = Ve({ id: "[NOT COLLECTED]" }, e.user), e.request = Ve({ clientIp: "[NOT COLLECTED]" }, e.request) }) }, configSchema: { collectUserIp: { defaultValue: function () { return !0 }, message: "should be true|false", validate: function (e) { return !0 === e || !1 === e } } } }, Ue = {}, $e = o, Fe = i, Ke = a; Ue.init = function (e) { var t = /^dev(elopment)?$/.test(e.config.releaseStage), n = !1 === e.config.consoleBreadcrumbsEnabled, r = (!1 === e.config.autoBreadcrumbs || t) && !0 !== e.config.consoleBreadcrumbsEnabled; n || r || $e(Ie, function (t) { var n = console[t]; console[t] = function () { for (var r = arguments.length, o = new Array(r), i = 0; i < r; i++)o[i] = arguments[i]; e.leaveBreadcrumb("Console output", Fe(o, function (e, t, n) { var r = "[Unknown value]"; try { r = String(t) } catch (e) { } if ("[object Object]" === r) try { r = JSON.stringify(t) } catch (e) { } return e["[" + n + "]"] = r, e }, { severity: 0 === t.indexOf("group") ? "log" : t }), "log"), n.apply(console, o) }, console[t]._restore = function () { console[t] = n } }) }, Ue.configSchema = { consoleBreadcrumbsEnabled: { defaultValue: function () { }, validate: function (e) { return !0 === e || !1 === e || void 0 === e }, message: "should be true|false" } }; var Ie = Ke(["log", "debug", "info", "warn", "error"], function (e) { return "undefined" != typeof console && "function" == typeof console[e] }), Xe = {}, Je = i, ze = /^.*<script.*?>/, Ge = /<\/script>.*$/, We = (Xe = { init: function (e, t, n) { void 0 === t && (t = document), void 0 === n && (n = window); var r = "", o = !1, i = function () { return t.documentElement.outerHTML }, a = n.location.href; r = i(); var s = t.onreadystatechange; t.onreadystatechange = function () { "interactive" === t.readyState && (r = i(), o = !0), "function" == typeof s && s.apply(this, arguments) }, e.config.beforeSend.unshift(function (e) { var t = e.stacktrace[0]; if (!t || !t.file || !t.lineNumber) return t; if (t.file.replace(/#.*$/, "") !== a.replace(/#.*$/, "")) return t; o && r || (r = i()); var n = ["\x3c!-- DOC START --\x3e"].concat(r.split("\n")), s = We(n, t.lineNumber - 1), u = s.script, c = s.start, f = Je(u, function (e, n, r) { return Math.abs(c + r + 1 - t.lineNumber) > 10 || (e["" + (c + r + 1)] = n), e }, {}); t.code = f, e.updateMetaData("script", { content: u.join("\n") }) }) } }).extractScriptContent = function (e, t) { for (var n = t; n < e.length && !Ge.test(e[n]);)n++; for (var r = n; n > 0 && !ze.test(e[n]);)n--; var o = n, i = e.slice(o, r + 1); return i[0] = i[0].replace(ze, ""), i[i.length - 1] = i[i.length - 1].replace(Ge, ""), { script: i, start: o } }, Ye = { init: function (e, t) { if (void 0 === t && (t = window), "addEventListener" in t) { var n = !1 === e.config.interactionBreadcrumbsEnabled, r = !1 === e.config.autoBreadcrumbs && !0 !== e.config.interactionBreadcrumbsEnabled; n || r || t.addEventListener("click", function (n) { var r, o; try { r = Ze(n.target), o = Qe(n.target, t) } catch (t) { r = "[hidden]", o = "[hidden]", e._logger.error("Cross domain error when tracking click event. See docs: https://tinyurl.com/y94fq5zm") } e.leaveBreadcrumb("UI click", { targetText: r, targetSelector: o }, "user") }, !0) } }, configSchema: { interactionBreadcrumbsEnabled: { defaultValue: function () { }, validate: function (e) { return !0 === e || !1 === e || void 0 === e }, message: "should be true|false" } } }, Ze = function (e) { var t, n, r, o = e.textContent || e.innerText || ""; return o || "submit" !== e.type && "button" !== e.type || (o = e.value), o = o.replace(/^\s+|\s+$/g, ""), n = 140, r = "(...)", (t = o) && t.length <= n ? t : t.slice(0, n - r.length) + r }; function Qe(e, t) { var n = [e.tagName]; if (e.id && n.push("#" + e.id), e.className && e.className.length && n.push("." + e.className.split(" ").join(".")), !t.document.querySelectorAll || !Array.prototype.indexOf) return n.join(""); try { if (1 === t.document.querySelectorAll(n.join("")).length) return n.join("") } catch (e) { return n.join("") } if (e.parentNode.childNodes.length > 1) { var r = Array.prototype.indexOf.call(e.parentNode.childNodes, e) + 1; n.push(":nth-child(" + r + ")") } return 1 === t.document.querySelectorAll(n.join("")).length ? n.join("") : e.parentNode ? Qe(e.parentNode, t) + " > " + n.join("") : n.join("") } var et, tt, nt = { init: function (e, t) { if (void 0 === t && (t = window), "addEventListener" in t) { var n = !1 === e.config.navigationBreadcrumbsEnabled, r = !1 === e.config.autoBreadcrumbs && !0 !== e.config.navigationBreadcrumbsEnabled; if (!n && !r) { var o = function (t) { return function () { return e.leaveBreadcrumb(t, {}, "navigation") } }; t.addEventListener("pagehide", o("Page hidden"), !0), t.addEventListener("pageshow", o("Page shown"), !0), t.addEventListener("load", o("Page loaded"), !0), t.document.addEventListener("DOMContentLoaded", o("DOMContentLoaded"), !0), t.addEventListener("load", function () { return t.addEventListener("popstate", o("Navigated back"), !0) }), t.addEventListener("hashchange", function (n) { var r = n.oldURL ? { from: rt(n.oldURL, t), to: rt(n.newURL, t), state: it(t) } : { to: rt(t.location.href, t) }; e.leaveBreadcrumb("Hash changed", r, "navigation") }, !0), t.history.replaceState && ot(e, t.history, "replaceState", t), t.history.pushState && ot(e, t.history, "pushState", t), e.leaveBreadcrumb("Bugsnag loaded", {}, "navigation") } } }, configSchema: { navigationBreadcrumbsEnabled: { defaultValue: function () { }, validate: function (e) { return !0 === e || !1 === e || void 0 === e }, message: "should be true|false" } } }, rt = function (e, t) { var n = t.document.createElement("A"); return n.href = e, "" + n.pathname + n.search + n.hash }, ot = function (e, t, n, r) { var o = t[n]; t[n] = function (i, a, s) { e.leaveBreadcrumb("History " + n, function (e, t, n, r) { var o = rt(e.location.href, e); return { title: n, state: t, prevState: it(e), to: r || o, from: o } }(r, i, a, s), "navigation"), "function" == typeof e.refresh && e.refresh(), e.config.autoCaptureSessions && e.startSession(), o.apply(t, [i, a].concat(void 0 !== s ? s : [])) }, t[n]._restore = function () { t[n] = o } }, it = function (e) { try { return e.history.state } catch (e) { } }, at = {}, st = "request", ut = s, ct = function () { return [et.config.endpoints.notify, et.config.endpoints.sessions] }; at.init = function (e, t) { void 0 === t && (t = window); var n = !1 === e.config.networkBreadcrumbsEnabled, r = !1 === e.config.autoBreadcrumbs && !0 !== e.config.networkBreadcrumbsEnabled; n || r || (et = e, tt = t, ft(), gt()) }, at.configSchema = { networkBreadcrumbsEnabled: { defaultValue: function () { }, validate: function (e) { return !0 === e || !1 === e || void 0 === e }, message: "should be true|false" } }; var ft = function () { if ("addEventListener" in tt.XMLHttpRequest.prototype) { var e = tt.XMLHttpRequest.prototype.open; tt.XMLHttpRequest.prototype.open = function (t, n) { this["BS~~U"] = n, this["BS~~M"] = t, this["BS~~S"] && (this.removeEventListener("load", lt), this.removeEventListener("error", dt)), this.addEventListener("load", lt), this.addEventListener("error", dt), this["BS~~S"] = !0, e.apply(this, arguments) } } }; function lt() { if (!ut(ct(), this["BS~~U"])) { var e = { status: this.status, request: this["BS~~M"] + " " + this["BS~~U"] }; this.status >= 400 ? et.leaveBreadcrumb("XMLHttpRequest failed", e, st) : et.leaveBreadcrumb("XMLHttpRequest succeeded", e, st) } } function dt() { ut(ct(), this["BS~~U"]) || et.leaveBreadcrumb("XMLHttpRequest error", { request: this["BS~~M"] + " " + this["BS~~U"] }, st) } var gt = function () { if ("fetch" in tt) { var e = tt.fetch; tt.fetch = function () { for (var t = arguments.length, n = new Array(t), r = 0; r < t; r++)n[r] = arguments[r]; var o = n[0], i = n[1], a = "GET"; return i && i.method && (a = i.method), new Promise(function (t, r) { e.apply(void 0, n).then(function (e) { pt(e, a, o), t(e) }).catch(function (e) { ht(a, o), r(e) }) }) } } }, pt = function (e, t, n) { var r = { status: e.status, request: t + " " + n }; e.status >= 400 ? et.leaveBreadcrumb("fetch() failed", r, st) : et.leaveBreadcrumb("fetch() succeeded", r, st) }, ht = function (e, t) { et.leaveBreadcrumb("fetch() error", { request: e + " " + t }, st) }, vt = f.intRange, mt = { init: function (e) { var t = 0; e.config.beforeSend.push(function (n) { if (t >= e.config.maxEvents) return n.ignore(); t++ }), e.refresh = function () { t = 0 } }, configSchema: { maxEvents: { defaultValue: function () { return 10 }, message: "should be a positive integer â¤100", validate: function (e) { return vt(1, 100)(e) } } } }, yt = {}; function bt() { return (bt = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var St = o, wt = (yt = { init: function (e) { e.config.beforeSend.push(function (e) { e.stacktrace = St(e.stacktrace, function (e) { return bt({}, e, { file: wt(e.file) }) }) }) } })._strip = function (e) { return "string" == typeof e ? e.replace(/\?.*$/, "").replace(/#.*$/, "") : e }, Ot = { init: function (e, t) { void 0 === t && (t = window); var n = t.onerror; t.onerror = function (t, r, o, i, a) { if (0 === o && /Script error\.?/.test(t)) e._logger.warn("Ignoring cross-domain or eval script error. See docs: https://tinyurl.com/y94fq5zm"); else { var s, u = { severity: "error", unhandled: !0, severityReason: { type: "unhandledException" } }; if (a) a.name && a.message ? s = new e.BugsnagReport(a.name, a.message, jt(e.BugsnagReport.getStacktrace(a), r, o, i), u, a) : (s = new e.BugsnagReport("window.onerror", String(a), jt(e.BugsnagReport.getStacktrace(a, 1), r, o, i), u, a)).updateMetaData("window onerror", { error: a }); else if ("object" != typeof t || null === t || r && "string" == typeof r || o || i || a) (s = new e.BugsnagReport("window.onerror", String(t), jt(e.BugsnagReport.getStacktrace(a, 1), r, o, i), u, t)).updateMetaData("window onerror", { event: t }); else { var c = t.type ? "Event: " + t.type : "window.onerror", f = t.message || t.detail || ""; (s = new e.BugsnagReport(c, f, e.BugsnagReport.getStacktrace(new Error, 1).slice(1), u, t)).updateMetaData("window onerror", { event: t, extraParameters: r }) } e.notify(s) } "function" == typeof n && n.apply(this, arguments) } } }, jt = function (e, t, n, r) { var o = e[0]; return o ? (o.fileName || "string" != typeof t || o.setFileName(t), !o.lineNumber && Et(n) && o.setLineNumber(n), o.columnNumber || (Et(r) ? o.setColumnNumber(r) : window.event && Et(window.event.errorCharacter) && o.setColumnNumber(window.event.errorCharacter)), e) : e }, Et = function (e) { return "number" == typeof e && "NaN" !== String.call(e) }, Nt = {}, Bt = i; Nt.init = function (e, t) { void 0 === t && (t = window); var n = function (t) { var n = t.reason, r = !1; try { t.detail && t.detail.reason && (n = t.detail.reason, r = !0) } catch (e) { } var o, i = { severity: "error", unhandled: !0, severityReason: { type: "unhandledPromiseRejection" } }; if (n && L(n)) o = new e.BugsnagReport(n.name, n.message, x.parse(n), i, n), r && (o.stacktrace = Bt(o.stacktrace, _t(n), [])); else { (o = new e.BugsnagReport(n && n.name ? n.name : "UnhandledRejection", n && n.message ? n.message : 'Rejection reason was not an Error. See "Promise" tab for more detail.', [], i, n)).updateMetaData("promise", "rejection reason", kt(n)) } e.notify(o) }; "addEventListener" in t ? t.addEventListener("unhandledrejection", n) : t.onunhandledrejection = function (e, t) { n({ detail: { reason: e, promise: t } }) }, n }; var Rt, kt = function (e) { return null == e ? "undefined (or null)" : R(e) ? ((t = {})[Object.prototype.toString.call(e)] = { name: e.name, message: e.message, code: e.code, stack: e.stack }, t) : e; var t }, _t = function (e) { return function (t, n) { return n.file === e.toString() ? t : (n.method && (n.method = n.method.replace(/^\s+/, "")), t.concat(n)) } }; function Dt() { return (Dt = Object.assign || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e }).apply(this, arguments) } var xt = o, Lt = Dt({}, l.schema, O); return (Rt = function (e) { "string" == typeof e && (e = { apiKey: e }); var t = []; e.sessionTrackingEnabled && (t.push("deprecated option sessionTrackingEnabled is now called autoCaptureSessions"), e.autoCaptureSessions = e.sessionTrackingEnabled), !e.endpoint && !e.sessionEndpoint || e.endpoints || (t.push("deprecated options endpoint/sessionEndpoint are now configured in the endpoints object"), e.endpoints = { notify: e.endpoint, sessions: e.sessionEndpoint }), e.endpoints && e.endpoints.notify && !e.endpoints.sessions && t.push("notify endpoint is set but sessions endpoint is not. No sessions will be sent."); var n = new ge({ name: "Bugsnag JavaScript", version: "6.1.0", url: "https://github.com/bugsnag/bugsnag-js" }); return n.setOptions(e), n.delivery(window.XDomainRequest ? je() : function (e) { return void 0 === e && (e = window), { sendReport: function (t, n, r, o) { void 0 === o && (o = function () { }); try { var i = n.endpoints.notify, a = new e.XMLHttpRequest; a.onreadystatechange = function () { a.readyState === e.XMLHttpRequest.DONE && o(null) }, a.open("POST", i), a.setRequestHeader("Content-Type", "application/json"), a.setRequestHeader("Bugsnag-Api-Key", r.apiKey || n.apiKey), a.setRequestHeader("Bugsnag-Payload-Version", "4"), a.setRequestHeader("Bugsnag-Sent-At", Re()), a.send(Se.report(r, n.filters)) } catch (e) { t.error(e) } }, sendSession: function (t, n, r, o) { void 0 === o && (o = function () { }); try { var i = n.endpoints.sessions, a = new e.XMLHttpRequest; a.onreadystatechange = function () { a.readyState === e.XMLHttpRequest.DONE && o(null) }, a.open("POST", i), a.setRequestHeader("Content-Type", "application/json"), a.setRequestHeader("Bugsnag-Api-Key", n.apiKey), a.setRequestHeader("Bugsnag-Payload-Version", "1"), a.setRequestHeader("Bugsnag-Sent-At", Re()), a.send(Se.session(r, n.filters)) } catch (e) { t.error(e) } } } }()), n.configure(Lt), xt(t, function (e) { return n._logger.warn(e) }), n.use(xe), n.use(ke), n.use(qe), n.use(Xe), n.use(mt), n.use(Pe), n.use(He), n.use(yt), !1 !== n.config.autoNotify && (n.use(Ot), n.use(Nt)), n.use(nt), n.use(Ye), n.use(at), n.use(Ue), n._logger.debug("Loaded!"), n.config.autoCaptureSessions ? n.startSession() : n }).Bugsnag = { Client: ge, Report: $, Session: ne, Breadcrumb: N }, Rt.default = Rt, Rt });
define('main/user_controller', ["require", "exports", "tslib", "jquery", "lib/urlparser", "./account_backend", "lib/underscore-shim"], function (require, t, e, i, n, r, o) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }), t.computeFirstName = t.UserController = void 0; var s = function (t) { function o() { var e = t.call(this) || this; return e.loggedIn = !1, e.logoutFailed = !1, e.loggingOut = !1, e.consentingToPrivacy = !1, e.privacyConsentFailed = !1, e.userId = "", e.name = "", e.email = "", e.teacher = !1, e.featureFlags = [], e.verificationStatus = "", e.subscriptions = [], e.privacyConsent = null, i.ajaxSetup({ statusCode: { 401: function () { return e.logout() } } }), e } return e.__extends(o, t), o.prototype.desmosLogin = function (t) { return r.fetchUser(t).done(this.completeLogin.bind(this)) }, o.prototype.googleLogin = function (t) { this.triggerEvent("googleLogin", t) }, o.prototype.appleLogin = function (t) { this.triggerEvent("appleLogin", t) }, o.prototype.askServerIfLoggedIn = function () { return r.askServerIfLoggedIn().then(this.completeLogin.bind(this), this.logout.bind(this)) }, o.prototype.driveCallback = function () { return this.askServerIfLoggedIn() }, o.prototype.createAccount = function (t) { var i = e.__assign(e.__assign({}, t), { name: t.userProvidedName.given }); return !1 === i.teacher && delete i.teacher, r.registerUser(i).done(this.completeLogin.bind(this)) }, o.prototype.checkPendingDeletion = function (t) { return r.checkPendingDeletion(t) }, o.prototype.isTeacher = function () { return !!this.teacher }, o.prototype.setNameLegacy = function (t) { var e = this; return r.setName(t).done(function (t) { e.name = t.name || "", e.triggerEvent("userUpdated", void 0), e.triggerEvent("triggerRender", void 0) }) }, o.prototype.setNameDetail = function (t) { var e = this; return r.setNameDetail(t).done(function (t) { e.name = t.name || "", e.nameDetail = t.nameDetail, e.triggerEvent("userUpdated", void 0), e.triggerEvent("triggerRender", void 0) }) }, o.prototype.recoverPassword = function (t) { return r.recoverPassword(t) }, o.prototype.completeLogin = function (t) { this.loggedIn = !0, this.userId = t.userId || "", this.name = t.name || "", this.nameDetail = t.nameDetail, this.email = t.email || "", this.featureFlags = t.featureFlags || [], this.subscriptions = t.subscriptions || [], this.verificationStatus = t.verificationStatus || "", this.privacyConsent = t.privacyConsent, this.teacher = !!t.isTeacher, this.triggerEvent("loginChanged", void 0), this.triggerEvent("userUpdated", void 0), this.triggerEvent("triggerRender", void 0) }, o.prototype.logout = function () { var t = this; return this.loggingOut = !0, this.triggerEvent("logout", void 0), this.triggerEvent("triggerRender", void 0), r.logout().done(this.completeLogout.bind(this)).fail(this._onLogoutFailure.bind(this)).always(function () { t.loggingOut = !1, t.triggerEvent("triggerRender", void 0) }) }, o.prototype.completeLogout = function () { this.loggedIn = !1, this.logoutFailed = !1, this.userId = "", this.email = "", this.name = "", this.subscriptions = [], this.featureFlags = [], this.verificationStatus = "", this.privacyConsent = null, this.teacher = !1, this.triggerEvent("loginChanged", void 0), this.triggerEvent("userUpdated", void 0), this.triggerEvent("triggerRender", void 0) }, o.prototype._onLogoutFailure = function () { var t = this; this.logoutFailed = !0, this.triggerEvent("triggerRender", void 0), setTimeout(function () { t.logoutFailed = !1, t.triggerEvent("triggerRender", void 0) }, 2e3) }, o.prototype.initiateAccountDeletion = function (t) { return r.initiateAccountDeletion(t) }, o.prototype.getEmailChangeToken = function () { return n.getParameter(location.search, "changeToken") }, o.prototype.initiateEmailChange = function (t) { return r.initiateEmailChange(t) }, o.prototype.setEmail = function (t) { var e = this; return r.setEmail(t).done(function () { e.email = t.newEmail || "", e.verificationStatus = "VERIFYING", e.triggerEvent("userUpdated", void 0), e.triggerEvent("triggerRender", void 0) }) }, o.prototype.setPrivacyConsent = function (t) { var e = this; return this.consentingToPrivacy = !0, this.triggerEvent("triggerRender", void 0), r.setPrivacyConsent(t).done(this.completePrivacyConsent.bind(this)).fail(this.onPrivacyConsentFailure.bind(this)).always(function () { e.consentingToPrivacy = !1, e.triggerEvent("triggerRender", void 0) }) }, o.prototype.completePrivacyConsent = function (t) { this.privacyConsent = t.privacyConsent, this.triggerEvent("userUpdated", void 0), this.triggerEvent("triggerRender", void 0) }, o.prototype.onPrivacyConsentFailure = function () { var t = this; this.privacyConsentFailed = !0, this.triggerEvent("triggerRender", void 0), setTimeout(function () { t.privacyConsentFailed = !1, t.triggerEvent("triggerRender", void 0) }, 2e3) }, o.prototype.updateFeatureFlags = function (t) { var e = this; return r.updateFeatureFlags(t).then(function (t) { e.featureFlags = t.featureFlags, e.triggerEvent("userUpdated", void 0) }) }, o.prototype.getFeatureFlags = function () { return this.featureFlags }, o.prototype.hasFeatureFlag = function (t) { return this.featureFlags.some(function (e) { return e === t }) }, o.prototype.didPrivacyConsentFail = function () { return !!this.privacyConsentFailed }, o.prototype.isConsentingToPrivacy = function () { return !!this.consentingToPrivacy }, o.prototype.isLoggedIn = function () { return !!this.loggedIn }, o.prototype.isLoggingOut = function () { return !!this.loggingOut }, o.prototype.didLogoutFail = function () { return !!this.logoutFailed }, o.prototype.getEmail = function () { return this.email }, o.prototype.getFirstName = function () { return a(this.name) }, o.prototype.getFullName = function () { return this.name }, o.prototype.getNameDetail = function () { return this.nameDetail || { given: this.name, source: "legacy" } }, o.prototype.getUserId = function () { return this.userId }, o.prototype.getSubscriptions = function () { return this.subscriptions }, o.prototype.getVerificationStatus = function () { return this.verificationStatus }, o.prototype.hasConsentedToCollection = function () { return !!this.privacyConsent }, o.prototype.getUserAsJSON = function () { return this.isLoggedIn() ? { email: this.email, name: this.name, verificationStatus: this.verificationStatus, subscriptions: this.subscriptions, privacyConsent: this.privacyConsent } : void 0 }, o }(o.UnderscoreModelShim); function a(t) { if (!t) return ""; if (t.match(/[\d@_&\.\']/)) return t; var e = t.split(" "); return e[0].length >= 3 ? e[0] : t } t.UserController = s, t.computeFirstName = a });
define('main/calculator_3d_backend', ['require', 'main/graph', './backend'], function (require) { "use strict"; var r = require("main/graph"), a = require("./backend"); return { saveGraph: function (t, e) { if (!e.hasOwnProperty("myGraphs")) throw new Error("Argument Error: saveGraph options must specify myGraphs"); if (!e.hasOwnProperty("isUpdate")) throw new Error("Argument Error: saveGraph options must specify isUpdate"); var s = { parent_hash: t.parentHash, thumb_data: t.thumbURL, graph_hash: t.hash, my_graphs: e.myGraphs, is_update: e.isUpdate, title: t.title || void 0 }; return s.state = t.graphData, a.post("/api/v1/calculator_3d/save", s).then(function (a) { return r.updateFromSync(t, a), t }) }, getGraphs: function () { return a.getJSON("/api/v1/calculator_3d/my_graphs") }, removeGraph: function (r) { return a.post("/api/v1/calculator_3d/my_graphs/remove", { hash: r.hash }) } } });
define('main/geometry_backend', ['require', 'main/graph', './backend'], function (require) { "use strict"; var t = require("main/graph"), r = require("./backend"); return { saveConstruction: function (n, o) { if (!o.hasOwnProperty("myConstructions")) throw new Error("Argument Error: saveConstruction options must specify myConstructions"); if (!o.hasOwnProperty("isUpdate")) throw new Error("Argument Error: saveConstruction options must specify isUpdate"); var s = { state: n.graphData, parent_hash: n.parentHash, thumb_data: n.thumbURL, hash: n.hash, my_constructions: o.myConstructions, is_update: o.isUpdate, title: n.title || void 0 }; return r.post("/api/v1/geometry/save", s).then(function (r) { return t.updateFromSync(n, r), n }) }, getConstructions: function () { return r.getJSON("/api/v1/geometry/my_constructions") }, removeConstruction: function (t) { return r.post("/api/v1/geometry/my_constructions/remove", { hash: t.hash }) } } });
define('lib/random_hash', ['require', 'exports', 'module'], function (require, t) { "use strict"; function n(t) { this.bauArc4 = new e(function (t) { var n, r = t + "", e = [], i = 0; for (n = 0; n < r.length; n++)e[o(n)] = o((i ^= 19 * e[o(n)]) + r.charCodeAt(n)); return e }(t)) } n.prototype.g = function (t) { for (var n = Array(t), r = 0; r < t; r++)n[r] = this.bauArc4.g(1); return n }; var r = 256; function o(t) { return 255 & t } function e(t) { var n, e, i = this, a = t.length, u = 0, f = i.i = i.j = i.m = 0; for (i.S = [], i.c = [], a || (t = [a++]); u < r;)i.S[u] = u++; for (u = 0; u < r; u++)f = o(f + (n = i.S[u]) + t[u % a]), e = i.S[f], i.S[u] = e, i.S[f] = n; i.g = function (t) { var n = i.S, e = o(i.i + 1), a = n[e], u = o(i.j + a), f = n[u]; n[e] = f, n[u] = a; for (var c = n[o(a + f)]; --t;)e = o(e + 1), f = n[u = o(u + (a = n[e]))], n[e] = f, n[u] = a, c = c * r + n[o(a + f)]; return i.i = e, i.j = u, c }, i.g(r) } var i, a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".toLowerCase(), u = function (t) { if (!t || !t.length || t.length < 32) throw new Error("You must supply a seed to RandomHashFactory. It should have at least 128 bits of entropy, but was " + t); var r = new n(t); this.next = function () { for (var t, n = Array(10), o = 0; o < 10;)(t = r.g(1)[0] >> 2) < 62 && (n[o] = a[t], o++); return n.join("") }, this.nextSeed = function () { for (var t = r.g(16), n = Array(16), o = 0; o < 16; o++)n[o] = t[o].toString(16), 1 === n[o].length && (n[o] = "0" + n[o]); return n.join("") } }; return t.next = function () { if (!i) throw "Random Hash Factory not initialized"; return i.next() }, t.nextSeed = function () { if (!i) throw "Random Hash Factory not initialized"; return i.nextSeed() }, t.init = function (t) { i = new u(t) }, t });
define('main/graphs_controller', ["require", "exports", "main/graph", "main/calculator_3d_backend", "main/geometry_backend", "lib/random_hash", "tslib", "jquery", "underscore", "main/calculator_backend", "lib/parse-json-errors", "lib/underscore-shim", "bugsnag", "analytics/looker"], function (require, e, t, r, a, i, o, n, s, h, p, c, g, d) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.GraphsController = void 0; var u = function (e) { function c(r) { var a = r.api, o = r.s, n = r.getLanguage, h = r.examplesJSON, p = r.randomSeed, c = r.product, g = e.call(this) || this; g.product = c, g.api = a, g.s = o, g.getLanguage = n, g.previousGraph = void 0, g.recoveryParentHash = void 0, g.randomHash = i, g._seedRandom(p), g.__savedGraphs = [], g.__recoveryGraphs = []; var d = h.map(t.fromAjax); return g.__exampleGraphs = s.filter(d, function (e) { return !e.easterEgg }), g.__easterEggGraphs = s.filter(d, function (e) { return !!e.easterEgg }), g.__graphInfoCache = {}, g.__exampleGraphs.forEach(function (e) { g._addGraphToCache(e) }), g.__easterEggGraphs.forEach(function (e) { g._addGraphToCache(e) }), g.lastSync = void 0, g.lastSaveFailureMessage = "", g.recentSaveFailure = !1, g.recentSaveSuccess = !1, g.saving = !1, g.syncError = !1, g.isLoadingGraphs = !1, g.currentGraph = t(), g._enableLoadingGraphStates(), g.pageLoadTime = Date.now(), g } return o.__extends(c, e), c.prototype._seedRandom = function (e) { if (e) { var t = new Date, r = "" + e + t.getTime() + t.getMilliseconds(); this.randomHash.init(r) } else alert(this.s("account-shell-error-something-went-wrong", { error_num: "77361" })) }, c.prototype.requestDeleteGraph = function (e) { var t = this._getCachedGraphInfo(e); t.canCancelDelete = !0, t.deleteTimeout = setTimeout(this._deleteGraph.bind(this, e), 3e3), t.isDeletingGraph = !0, t.didDeleteGraphFail = !1, this.triggerEvent("listChanged", void 0), this.triggerEvent("triggerRender", void 0) }, c.prototype._removeSavedGraphByHash = function (e) { this.__savedGraphs = s.filter(this.__savedGraphs, function (t) { return t.hash !== e }) }, c.prototype._removeRecoveryGraphByHash = function (e) { this.__recoveryGraphs = s.filter(this.__recoveryGraphs, function (t) { return t.hash !== e }) }, c.prototype._deleteGraph = function (e) { var t, i = this, o = e.hash, n = this._getCachedGraphInfo(e); switch (n.canCancelDelete = !1, this.triggerEvent("listChanged", void 0), this.triggerEvent("triggerRender", void 0), this.product) { case "graphing": t = h.removeGraph({ hash: o, lang: this.getLanguage() }); break; case "graphing3d": t = r.removeGraph(e); break; case "geometry": t = a.removeConstruction(e) }return t.done(function () { i._removeSavedGraphByHash(o), i._removeRecoveryGraphByHash(o) }).fail(function () { n.didDeleteGraphFail = !0 }).always(function () { n.isDeletingGraph = !1, i.triggerEvent("listChanged", void 0), i.triggerEvent("triggerRender", void 0) }) }, c.prototype.cancelDeleteGraph = function (e) { var t = this._getCachedGraphInfo(e); clearTimeout(t.deleteTimeout), t.isDeletingGraph = !1, t.didDeleteGraphFail = !1, t.canCancelDelete = !1, this.triggerEvent("listChanged", void 0), this.triggerEvent("triggerRender", void 0) }, c.prototype.millisecondsSinceSync = function () { return this.lastSync ? Date.now() - this.lastSync : 1 / 0 }, c.prototype.clear = function () { this.lastSync = void 0, this.setSavedGraphsFromJSON([]), this.setRecoveryGraphsFromJSON([]) }, c.prototype.dismissSaveError = function () { this.recentSaveFailure = !1, this.triggerEvent("triggerRender", void 0) }, c.prototype._triggerSaveSuccess = function () { var e = this; this.saving = !1, this.recentSaveSuccess = !0, this.lastSaveFailureMessage = void 0, this.triggerEvent("triggerRender", void 0), this.recentSaveTimeout = setTimeout(function () { e.recentSaveSuccess = !1, e.triggerEvent("triggerRender", void 0) }, 3e3) }, c.prototype._triggerSaveError = function (e) { var t = e.length && e[0].message ? e[0].message : this.s("account-shell-error-unexpected-error"); this.saving = !1, this.recentSaveFailure = !0, this.lastSaveFailureMessage = t, this.triggerEvent("triggerRender", void 0), this.recentSaveTimeout = setTimeout(this.dismissSaveError.bind(this), 6e4) }, c.prototype._updateGraphData = function (e) { var t = JSON.stringify(this.api.getState()); e.setProperty("graphData", t), e.setProperty("parentHash", e.hash), e.setProperty("recoveryParentHash", this.recoveryParentHash); var r = this.randomHash.next(); e.setProperty("hash", r), this.recoveryParentHash = r; var a = this.api.screenshot({ width: 200, height: 200, targetPixelRatio: 2 }); e.setProperty("thumbURL", a) }, c.prototype._clearSaveTimeout = function () { this.recentSaveFailure = !1, this.recentSaveSuccess = !1, this.lastSaveFailureMessage = void 0, this.triggerEvent("triggerRender", void 0), clearTimeout(this.recentSaveTimeout) }, c.prototype.save = function (e) { var t = this, i = e && e.newTitle, o = !(!e || !e.saveCopy); i && (this.currentGraph.title = i), this._clearSaveTimeout(), this.saving = !0, this.triggerEvent("triggerRender", void 0); var n = this.currentGraph.copy(); n.recovery && (n.recovery = !1, d.logJSON("recovered-graph", { product: this.product, timeSincePageload: Date.now() - this.pageLoadTime, payloadJSON: { action: "save" } })), this._updateGraphData(n); var s, c = !o && this.wasCurrentGraphEverSaved(); switch (this.product) { case "graphing": s = h.saveGraph(n, { myGraphs: !0, isUpdate: c, lang: this.getLanguage() }); break; case "graphing3d": s = r.saveGraph(n, { myGraphs: !0, isUpdate: c }); break; case "geometry": s = a.saveConstruction(n, { myConstructions: !0, isUpdate: c }) }s.done(function (e) { t.currentGraph = e.copy(), t._onCurrentGraphChanged(), t.triggerEvent("clearUnsavedChanges", void 0), t.triggerEvent("triggerRender", void 0), c && t._removeSavedGraphByHash(e.parentHash), e.draft && t._removeRecoveryGraphByHash(e.parentHash), t.__savedGraphs.unshift(e), t._addGraphToCache(e), t.triggerEvent("listChanged", void 0), t.triggerEvent("triggerRender", void 0), t._triggerSaveSuccess() }).fail(function (e) { var r = 413 === e.status ? [{ message: t.s("account-shell-error-graph-too-large") }] : p.rawParseJSONErrors(e); t._triggerSaveError(r) }) }, c.prototype.shareGraph = function () { var e, t = this.currentGraph.copy(); switch (this._updateGraphData(t), this.product) { case "graphing": e = h.saveGraph(t, { myGraphs: !1, isUpdate: !1, lang: this.getLanguage() }); break; case "graphing3d": e = r.saveGraph(t, { myGraphs: !1, isUpdate: !1 }); break; case "geometry": e = a.saveConstruction(t, { myConstructions: !1, isUpdate: !1 }) }return e }, c.prototype.saveRecoveryGraph = function () { var e = this.currentGraph.copy(), t = JSON.stringify(this.api.getState()); e.setProperty("graphData", t), e.setProperty("parentHash", e.hash), e.setProperty("recoveryParentHash", this.recoveryParentHash); var r = this.randomHash.next() + this.randomHash.next(); e.setProperty("hash", r), this.recoveryParentHash = r; var a = this.api.screenshot({ width: 200, height: 200, targetPixelRatio: 2 }); return e.setProperty("thumbURL", a), h.saveGraph(e, { myGraphs: !1, isUpdate: !1, recovery: !0, lang: this.getLanguage() }) }, c.prototype.isCurrentGraphTitled = function () { return !!this.currentGraph.title }, c.prototype.isCurrentGraphARecoveryGraph = function () { var e = this.currentGraph; if (!e || !e.hash) return !1; var t = e.hash; return s.any(this.__recoveryGraphs, function (e) { return e.hash === t }) }, c.prototype.wasCurrentGraphEverSaved = function () { var e = this.currentGraph; if (!e || !e.hash) return !1; var t = e.hash; return s.any(this.__savedGraphs, function (e) { return e.hash === t }) }, c.prototype.isRecoveryUIEnabledForProduct = function () { return "graphing" === this.product }, c.prototype.fetchRecoveryGraphs = function () { var e, t = this, r = Date.now(); switch (this.isLoadingRecoveryGraphs = !0, clearTimeout(this.fetchDurationTimeout), this.triggerEvent("triggerRender", void 0), this.product) { case "graphing": e = h.getRecoveryGraphs({ lang: this.getLanguage() }); break; case "graphing3d": throw new Error("code error: should not fetchRecoveryGraphs for 3d"); case "geometry": throw new Error("code error: should not fetchRecoveryGraphs for geometry") }e.done(function (e) { t.setRecoveryGraphsFromJSON(e.recoveryGraphs || e.recoveryConstructions) }).fail(function () { t.triggerEvent("onRecoveryGraphsError", void 0) }).always(function () { var e = 2e3 - (Date.now() - r); t.isLoadingRecoveryGraphs = !1, e > 0 ? t.fetchDurationTimeout = setTimeout(function () { t.triggerEvent("triggerRender", void 0) }, e) : t.triggerEvent("triggerRender", void 0) }) }, c.prototype.clearRecoveryGraphsForTests = function () { return h.clearRecoveryGraphsForTests() }, c.prototype.refreshGraphs = function () { var e, t = this; switch (this.isLoadingGraphs = !0, this.syncError = !1, this.triggerEvent("triggerRender", void 0), this.product) { case "graphing": e = h.getGraphs({ lang: this.getLanguage() }); break; case "graphing3d": e = r.getGraphs(); break; case "geometry": e = a.getConstructions() }e.done(function (e) { t.lastSync = Date.now(), t.setSavedGraphsFromJSON(e.myGraphs || e.myConstructions) }).fail(function () { t.syncError = !0, t.triggerEvent("onSyncError", void 0) }).always(function () { t.isLoadingGraphs = !1, t.triggerEvent("triggerRender", void 0) }) }, c.prototype.getRecoveryGraphs = function () { return this.__recoveryGraphs.slice(0) }, c.prototype.getSavedGraphs = function () { return this.__savedGraphs.slice(0) }, c.prototype.getExampleGraphs = function () { return this.__exampleGraphs.slice(0) }, c.prototype.getEasterEggGraphs = function (e) { return s.filter(this.__easterEggGraphs, function (t) { return t.easterEgg === e }) }, c.prototype.getSavedAndExampleGraphs = function () { return this.__savedGraphs.concat(this.__exampleGraphs) }, c.prototype.setSavedGraphsFromJSON = function (e) { var r = this; e || (e = []), this.__savedGraphs = e.map(function (e) { var a = t.fromAjax(e), i = r._getCachedGraphInfo(a); return i ? i.graph : (r._addGraphToCache(a), a) }), this._lazyLoadGraphStates(), this.triggerEvent("listChanged", void 0), this.triggerEvent("triggerRender", void 0) }, c.prototype.setRecoveryGraphsFromJSON = function (e) { var r = this; e || (e = []), this.__recoveryGraphs = e.map(function (e) { var a = t.fromAjax(e); a.draft = !0, a.recovery = !0; var i = r._getCachedGraphInfo(a); return i ? i.graph : (r._addGraphToCache(a), a) }), this._lazyLoadGraphStates(), this.triggerEvent("listChanged", void 0), this.triggerEvent("triggerRender", void 0) }, c.prototype.getSavedGraphsAsJSON = function () { return this.__savedGraphs.map(t.toAjax) }, c.prototype._enableLoadingGraphStates = function () { var e = this; clearTimeout(this.__loadNextGraphStateTimeout); var t = function () { e._loadNextGraphState(), e.__loadNextGraphStateTimeout = setTimeout(t, 50) }; t() }, c.prototype._disableLoadingGraphStates = function () { clearTimeout(this.__loadNextGraphStateTimeout) }, c.prototype._loadNextGraphState = function () { var e = this; if (!this.__currentAjaxRequest) { var t = this._dequeueGraphInfo(); t && (this.__currentAjaxRequest = this.loadGraphImmediately(t.graph), this.__currentAjaxRequest.always(function () { e.__currentAjaxRequest = void 0 })) } }, c.prototype.loadGraphImmediately = function (e) { var t = this, r = n.Deferred(); if (!e.graphData) { var a = e.stateURL, i = this._getCachedGraphInfo(e); return i.isDataLoading = !0, n.getJSON(a).done(function (t) { e.graphData = t, i.didDataLoadFail = !1, r.resolve(t) }).fail(function (e) { i.didDataLoadFail = !0, r.reject(e) }).always(function (e) { i.isDataLoading = !1, t.triggerEvent("listChanged", void 0), t.triggerEvent("triggerRender", void 0) }) } return requestAnimationFrame(function () { r.resolve() }), r }, c.prototype._getCachedGraphInfo = function (e) { return e && this.__graphInfoCache[e.getCollectionKey()] }, c.prototype._addGraphToCache = function (e) { this.__graphInfoCache[e.getCollectionKey()] = { graph: e } }, c.prototype._enqueueGraphInfo = function (e) { this.__nextAjaxRequestPriority || (this.__nextAjaxRequestPriority = 0), e.ajaxPriority = ++this.__nextAjaxRequestPriority }, c.prototype._dequeueGraphInfo = function () { var e, t = -1 / 0; for (var r in this.__graphInfoCache) { var a = this.__graphInfoCache[r], i = a.ajaxPriority; void 0 !== i && i > t && (t = i, e = a) } return s.isObject(e) ? void 0 === e ? null : (delete e.ajaxPriority, e) : null }, c.prototype.loadDataForGraph = function (e) { if (e) { var t = this._getCachedGraphInfo(e); if (!t) throw new Error('graphsController does not have a reference to graph with hash "' + e.hash + '"'); t.graph.graphData || (t.isDataLoading = !0, t.didDataLoadFail = !1, this._enqueueGraphInfo(t), this.triggerEvent("triggerRender", void 0)) } }, c.prototype._lazyLoadGraphStates = function () { for (var e = this.getSavedAndExampleGraphs(), t = Math.min(20, e.length) - 1; t >= 0; t--)this.loadDataForGraph(e[t]) }, c.prototype.didDataLoadFail = function (e) { var t = this._getCachedGraphInfo(e); return !(!t || !t.didDataLoadFail) }, c.prototype.didDeleteGraphFail = function (e) { var t = this._getCachedGraphInfo(e); return !(!t || !t.didDeleteGraphFail) }, c.prototype.isDeletingGraph = function (e) { var t = this._getCachedGraphInfo(e); return !(!t || !t.isDeletingGraph) }, c.prototype.canCancelDelete = function (e) { var t = this._getCachedGraphInfo(e); return !(!t || !t.canCancelDelete) }, c.prototype.loadGraph = function (e, r) { this.previousGraph = this.currentGraph ? this.currentGraph.copy() : t(), this.previousGraph.graphData = JSON.stringify(this.api.getState()); var a = e.copy(); delete a.example, this.api.setState(a.graphData, { forceExpressionsOpen: !0, forceUnsavedChanges: !!a.recovery, allowUndo: r && r.allowUndo }), this.currentGraph = a, this._onCurrentGraphChanged(), this.recoveryParentHash = this.currentGraph.hash, r && r.allowUndo || this.triggerEvent("clearUndoRedo", void 0), a.recovery || this.triggerEvent("clearUnsavedChanges", void 0), this.triggerEvent("triggerRender", void 0), this.triggerEvent("onLoadGraph", void 0) }, c.prototype.restorePreviousGraph = function () { this.loadGraph(this.previousGraph || t()) }, c.prototype.clearGraph = function (e) { this.loadGraph(t(), e), this.triggerEvent("onClearGraph", void 0) }, c.prototype._onCurrentGraphChanged = function () { var e = this.currentGraph; e.title ? document.title = e.title : "graphing" === this.product ? document.title = this.s("account-shell-heading-graphingcalc-page-title") : "graphing3d" === this.product ? document.title = this.s("account-shell-heading-3dcalc-page-title") : document.title = this.s("account-shell-heading-geometry-page-title"), this._replaceState(e) }, c.prototype._replaceState = function (e) { if (window.history && history.replaceState) { var t = e.getURL(); t && (window.location.search && (t += window.location.search), t !== window.location.href && history.replaceState(e.hash, e.title, t)) } }, c.prototype.toast = function (e, t) { this.triggerEvent("toast", { message: e, opts: t }) }, c.prototype.clearGraphByUserAction = function () { var e, t = this; if (this.currentGraph.hash) return this.clearGraph(), e = "geometry" === this.product ? this.s("account-shell-text-new-construction-created") : this.s("account-shell-text-new-graph-created"), void this.toast(e, { undoCallback: function () { t.restorePreviousGraph(), t._replaceState(t.currentGraph) } }); var r = this.api.getState(); this.clearGraph({ allowUndo: !0 }), e = "geometry" === this.product ? this.s("account-shell-text-construction-cleared") : this.s("account-shell-text-graph-cleared"), this.toast(e, { undoCallback: function () { t.api.setState(r, { forceExpressionsOpen: !0, allowUndo: !0 }) } }) }, c.prototype.getSaveFailureMessage = function () { return this.lastSaveFailureMessage || "" }, c.prototype.isSaving = function () { return !!this.saving }, c.prototype.didSaveFail = function () { return !!this.recentSaveFailure }, c.prototype.didSaveSucceed = function () { return !!this.recentSaveSuccess }, c.prototype.isSyncing = function () { return !!this.isLoadingGraphs }, c.prototype.didSyncFail = function () { return !!this.syncError }, c.prototype.getCurrentDisplayDate = function () { return this.currentGraph.displayDate() }, c.prototype.getCurrentGraphTitle = function () { return this.currentGraph.title }, c.prototype.getUntitledString = function () { return "geometry" === this.product ? this.s("account-shell-text-untitled") : "graphing" === this.product || "graphing3d" === this.product ? this.s("account-shell-text-untitled-graph") : (g.notify("Unknown product: " + this.product), "Untitled") }, c.prototype.hasUnsavedChanges = function () { return this.api.hasUnsavedChanges() }, c }(c.UnderscoreModelShim); e.GraphsController = u });
define('main/language_controller', ["require", "exports", "lib/i18n", "lib/urlparser"], function (require, t, e, n) { "use strict"; Object.defineProperty(t, "__esModule", { value: !0 }); var r = function () { function t(t) { var n = this; this.s = e.createDictionaryLookupFunction(function () { return n._language }), this._language = e.detectLanguage(), this.Calc = t } return t.prototype.raw = function (t, n) { return e.raw(t, n) }, t.prototype.unpack = function (t) { return e.unpack(t, this._language) }, t.prototype.getLanguage = function () { return this._language }, t.prototype.updateUrl = function (t) { if (window.history && history.replaceState) { var e = location.origin, r = location.pathname, a = location.search, o = location.hash, i = "" + e + r + n.setParameter(a, "lang", t) + o; history.replaceState(null, "", i) } }, t.prototype.setHeaderController = function (t) { this.headerController = t }, t.prototype.fetchAndSetLanguage = function (t) { var n = this; e.fetchLanguage(t).then(function () { n._language = t, n.Calc.updateSettings({ language: t }), n.headerController && n.headerController.triggerRender(), n.updateUrl(t) }) }, t }(); t.default = r });
define('main/mygraphs_controller', ['require', 'pjs', 'jquery', 'underscore_model', 'lib/aria', 'lib/conditional_blur', 'analytics/looker'], function (require) { "use strict"; var t = require("pjs"), e = require("jquery"), r = require("underscore_model").UnderscoreModel, o = require("lib/aria"), n = require("lib/conditional_blur").default, i = require("analytics/looker").logJSON; return t(r, function (t, r) { t.init = function (t, e, o) { r.init.call(this), this.graphsController = t, this.api = e, this.s = o, this.recoveryAttempted = !1, this.isOpen = !1, this.pageLoadTime = Date.now() }, t.isMygraphsOpen = function () { return this.isOpen }, t.hasAttemptedRecovery = function () { return this.recoveryAttempted }, t.openMygraphs = function (t) { this.recoveryAttempted = !1, this.isOpen = !0, e("body").addClass("resources-open"), i("user-action::open-my-graphs", { product: this.graphsController.product }), o.alert(this.s("account-shell-narration-mygraphs-open-graph")), n(), t && "keyboard" === t.device && e(".dcg-action-newblankgraph").focus(), this.triggerEvent("onOpenMygraphs") }, t.closeMygraphs = function () { this.isOpen = !1, e("body").removeClass("resources-open") }, t.openBlankGraph = function () { this.closeMygraphs(), this.graphsController.clearGraphByUserAction(), this.triggerEvent("triggerRender") }, t.onOpenGraph = function (t) { t.example || (t.recovery ? i("recovered-graph", { product: this.graphsController.product, timeSincePageload: Date.now() - this.pageLoadTime, payloadJSON: { action: "open" } }) : i("user-action::open-saved", { product: this.graphsController.product, timeSincePageload: Date.now() - this.pageLoadTime })); var e = this.copyGraphWithTranslation(t); this.graphsController.loadGraph(e), this._concludeOpenGraph(e) }, t.toast = function (t, e) { this.triggerEvent("toast", { message: t, opts: e }) }, t._concludeOpenGraph = function (t) { var e = t.title || this.graphsController.getUntitledString(), r = this.s("account-shell-text-mygraphs-opened-graph", { graphTitle: e }); this.toast(r, { undoCallback: function () { this.graphsController.restorePreviousGraph() }.bind(this) }), this.closeMygraphs(), this.triggerEvent("triggerRender") }, t.copyGraphWithTranslation = function (t) { var e = t.copy(); return t.example && (e.title = this.s(t.title)), e }, t.openGraphBehindCover = function (t) { var r = this.copyGraphWithTranslation(t); this.graphsController.loadGraph(r); var o = e.Deferred(); return "graphing" === this.graphsController.product || "graphing3d" === this.graphsController.product ? (this.api._calc.evaluator.notifyWhenSynced(function () { o.resolve() }), setTimeout(function () { o.resolve() }, 6e3)) : "geometry" === this.graphsController.product && o.resolve(), o.then(function () { this._concludeOpenGraph(r) }.bind(this)), o.promise() }, t.getThumbnail = function () { return this.api.screenshot({ width: 200, height: 200, targetPixelRatio: 2 }) } }) });
define('tours/tour_controller', ['require', 'pjs', 'tours/all_tours', 'lib/urlparser', 'jquery'], function (require) { "use strict"; var t = require("pjs"), r = require("tours/all_tours"), o = require("lib/urlparser"), u = require("jquery"); return t(function (t, s) { t.init = function (t) { this.tourManager = t._calc.tourManager, this.Calc = t._calc, this.tourManager.closingMsg = function (t, r) { return "<b>" + t + "</b><br>" + this.Calc.controller.s("graphing-tours-label-self-destruct", { seconds: r }) }.bind(this) }, t.shouldPopupTour = function (t) { if (this.Calc.controller.getItemCount() > 3) return !0; var o = r[t].tour(this.Calc); return !!o.shouldPopup && o.shouldPopup() }, t.startTour = function (t, o) { if (t && r[t]) { var u = r[t].tour(this.Calc); this.tourManager.currentTour && this.tourManager.stopTour(), this.tourManager.startTour(u) } }, t.startTourFromUrl = function () { if (u(".dcg-expressionitem").length < 2) setTimeout(this.startTourFromUrl.bind(this), 100); else { var t = o.getParameter(location.search, "tour"); this.startTour(t, "url") } }, t.setCalc = function (t) { this.Calc = t } }) });
define('calculator-shell/controller', ["require", "exports", "config", "jquery", "underscore", "flux", "browser", "keys", "bugsnag", "lib/i18n", "../analytics/looker", "../lib/parse-json-errors", "../lib/parse-query-params", "../api/graphing"], function (require, e, t, o, r, n, s, i, a, l, c, h, u, p) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }), e.Controller = void 0; var d = 3e5; u.getQueryParams().fastAutoSave && (d = 5e3); var g = function () { function e(e) { var t = this; this.defaultModalDevice = "mouse", this.userControllerState = "uninitialized", this.lastIsShowingActionsUI = !1, this.userController = e.userController, this.graphsController = e.graphsController, this.tourController = e.tourController, this.languageController = e.languageController, this.mygraphsController = e.mygraphsController, this.api = e.api, this.raw = e.raw, this.s = e.s, this.getLanguage = e.getLanguage, this.unpack = e.unpack, this.product = e.product, this.SOMETHING_WENT_WRONG = this.s("account-shell-error-unknown"), this._openMenu = "none", this._requestedContactForm = !1, this._feedbackMessage = "", this.state = {}, this.countryCode = o("body").attr("data-country"), this.languageController && this.languageController.setHeaderController(this), this.hookupControllers(), this.hookupHotkeys(), this.dispatcher = new n.Dispatcher, this.dispatch = function (e) { return a.leaveBreadcrumb("dispatch::header-controller", { type: e.type }), t.dispatcher.dispatch(e) }, this.dispatcher.register(function (e) { switch (e.type) { case "save-graph": t.saveGraph(e.device, e.payload); break; case "edit-title": t.launchEditTitle(); break; case "close-modal": t.closeModal(); break; case "toggle-menu": t.setOpenMenu(e.payload); break; case "open-mygraphs": t.mygraphsController.openMygraphs(e); break; case "close-mygraphs": t.mygraphsController.closeMygraphs(); break; case "render": break; case "show-modal": t.showModal(e); break; case "show-contact-form": t._requestedContactForm = e.showForm; break; default: return e }return t.triggerRender() }), this.lastRecoveryState = {}, this.checkRecoveryState() } return e.prototype.triggerRender = function () { }, e.prototype.hookupControllers = function () { var e = this; this.mygraphsController.observeEvent("onOpenMygraphs", function () { if (e.isLoggedIn() && e.graphsController.millisecondsSinceSync() > 12e4) return e.graphsController.refreshGraphs() }), this.mygraphsController.observeEvent("triggerRender", function () { e.triggerRender() }), this.userController.observeEvent("loginChanged", function () { e.userControllerState = "initialized", e.mygraphsController.recoveryAttempted = !1, e.isLoggedIn() ? e.graphsController.refreshGraphs() : e.graphsController.clear(), e.mustConsentToCollection() && e.showModal({ modal: "consent", device: e.defaultModalDevice }) }), this.userController.observeEvent("userUpdated", function () { "consent" === e.getOpenModal() && e.closeModal(), void 0 === t.get("actions") && e.api instanceof p.default && e.api._calc.setOption("actions", !!e.isActionsFlagEnabled() || "auto") }), this.userController.observeEvent("triggerRender", function () { e.triggerRender() }), this.graphsController.observeEvent("triggerRender", function () { e.triggerRender() }), this.api instanceof p.default && this.api._calc.controller.subToChanges(function () { return e.maybeShowAdvancedFeaturesToast() }) }, e.prototype.hookupHotkeys = function () { var e = this; o(document).on("keydown", function (t) { var o = t.altKey, r = t.ctrlKey, n = t.metaKey, a = t.shiftKey; if (s.IS_APPLE ? !r && n && !o && !a : r && !n && !o && !a) switch (i.lookupChar(t)) { case "S": return e.simpleSave("keyboard"), !1; case "O": return e.dispatch({ type: "open-mygraphs", device: "keyboard" }), !1 } }) }, e.prototype.disablePrintAndExport = function () { this._disablePrintAndExport = !0 }, e.prototype.shouldDisablePrintAndExport = function () { return !!this._disablePrintAndExport }, e.prototype.getOpenMenu = function () { return this._openMenu }, e.prototype.getModalState = function () { return this._openModal || { modal: "none" } }, e.prototype.getOpenModal = function () { var e, t; return null !== (t = null === (e = this._openModal) || void 0 === e ? void 0 : e.modal) && void 0 !== t ? t : "none" }, e.prototype.hasOpenModal = function () { return !!this._openModal }, e.prototype.getModalDevice = function () { var e; return null === (e = this._openModal) || void 0 === e ? void 0 : e.device }, e.prototype.getModalStartingError = function () { var e; return (null === (e = this._openModal) || void 0 === e ? void 0 : e.error) || "" }, e.prototype.closeModal = function () { this._openModal = this.mustConsentToCollection() ? { modal: "consent", device: this.defaultModalDevice } : void 0, this.triggerRender() }, e.prototype.closeMenu = function () { this._openMenu = "none", this.maybeResetContactForm() }, e.prototype.showModal = function (e) { this.closeMenu(), this._openModal = e, this.defaultModalDevice = e.device }, e.prototype.setOpenMenu = function (e) { var t = this.getOpenMenu(); this._openMenu = e === t ? "none" : e, this.maybeResetContactForm() }, e.prototype.getFeedbackMessage = function () { return this._feedbackMessage }, e.prototype.setFeedbackMessage = function (e) { this._feedbackMessage = e }, e.prototype.maybeResetContactForm = function () { "help" !== this.getOpenMenu() && (this.getFeedbackMessage().trim().length || (this.setFeedbackMessage(""), this._requestedContactForm = !1)) }, e.prototype.getProduct = function () { return this.product }, e.prototype.saveRecoveryState = function () { var e = o.Deferred(); e.reject(); var t = e.promise(); if (!this.userController.isLoggedIn() || !this.graphsController.hasUnsavedChanges()) return t; var n = this.graphsController.api.getState(); if (r.isEqual(n, this.lastRecoveryState)) return t; var s = this.graphsController.saveRecoveryGraph(); return this.lastRecoveryState = n, s }, e.prototype.checkRecoveryState = function () { var e = this; setTimeout(function () { e.checkRecoveryState(), e.saveRecoveryState() }, d) }, e.prototype.isLoggedIn = function () { return this.userController.isLoggedIn() }, e.prototype.hasConsentedToCollection = function () { return this.userController.hasConsentedToCollection() }, e.prototype.isInMaintenanceMode = function () { return t.get("maintenance") }, e.prototype.getPreviewParams = function () { return t.get("previewMode") ? { url: t.get("previewFeedbackUrl"), message: t.get("previewMessage") } : null }, e.prototype.isDecimalToFractionEnabled = function () { return !!t.get("decimalToFraction") }, e.prototype.isSaveEnabled = function () { return !this.graphsController.wasCurrentGraphEverSaved() || this.graphsController.hasUnsavedChanges() }, e.prototype.saveGraph = function (e, t) { this.isLoggedIn() ? (this.graphsController.save({ newTitle: null == t ? void 0 : t.title, saveCopy: !!(null == t ? void 0 : t.saveAs) }), this.closeModal(), this.closeMenu()) : this.showModal({ modal: "signup", device: e }) }, e.prototype.simpleSave = function (e) { void 0 === e && (e = this.defaultModalDevice), this.graphsController.isCurrentGraphTitled() ? (this.saveGraph(e || "mouse"), this.dispatch({ type: "render" })) : this.openSaveDialog({ device: e }) }, e.prototype.openSaveDialog = function (e) { void 0 === e && (e = {}), this.showModal({ modal: "save", device: e.device || this.defaultModalDevice, fromSaveInProgress: e.fromSaveInProgress }), this.dispatch({ type: "render" }) }, e.prototype.launchEditTitle = function () { this.closeMenu(), null != this.getPreviewParams() || this.isInMaintenanceMode() || (this.isLoggedIn() ? "geometry" === this.product ? this.showModal({ modal: "save", device: this.defaultModalDevice }) : this.showModal({ modal: "rename", device: this.defaultModalDevice }) : this.showModal({ modal: "signup", device: this.defaultModalDevice })) }, e.prototype.getOpenText = function () { return "graphing" === this.product || "graphing3d" === this.product ? this.s("account-shell-button-open-graph") : "geometry" === this.product ? this.s("account-shell-button-open-construction") : "" }, e.prototype.isConsentingToCollection = function () { return this.userController.isConsentingToPrivacy() }, e.prototype.privacyConsentFailed = function () { return this.userController.didPrivacyConsentFail() }, e.prototype.mustConsentToCollection = function () { return this.isLoggedIn() && !this.hasConsentedToCollection() }, e.prototype.isArtContestEnabled = function () { return !1 }, e.prototype.isGraphComplexEnoughForContest = function () { if (!(this.api instanceof p.default)) return !1; var e = this.api.getState().expressions.list; return 1 !== e.length || ("expression" !== e[0].type || !!e[0].latex) }, e.prototype.shouldShowArtContestNudge = function () { return !!this.isArtContestEnabled() && (this.isGraphComplexEnoughForContest() && this.isLoggedIn()) }, e.prototype.getLimitedSignupRole = function () { return "student" }, e.prototype.wasModalOpenedWithKeyboard = function () { var e; return "keyboard" === (null === (e = this._openModal) || void 0 === e ? void 0 : e.device) }, e.prototype.allowSignInWithApple = function () { return !0 }, e.prototype.getSomethingWentWrongText = function () { return this.s("account-shell-error-unknown") }, e.prototype.logJSON = function (e, t) { c.logJSON(e, t) }, e.prototype.parseJSONErrors = function (e) { return h.parseJSONErrors(e) }, e.prototype.requestedContactForm = function () { return this._requestedContactForm }, e.prototype.isActionsFlagEnabled = function () { return this.userController.hasFeatureFlag("dcg-actions") }, e.prototype.maybeShowAdvancedFeaturesToast = function () { var e = this, t = this.api; if (t instanceof p.default) { var o = t._calc.controller.areActionsEnabled(); if (o && "uninitialized" === this.userControllerState) return this.userControllerState = "loading", void this.userController.askServerIfLoggedIn().then(function () { e.userControllerState = "initialized", e.maybeShowAdvancedFeaturesToast() }); "loading" !== this.userControllerState && (this.isActionsFlagEnabled() || (o && !this.lastIsShowingActionsUI && this.userController.isLoggedIn() && t._calc.controller.runAfterDispatch(function () { t._calc.controller.dispatch({ type: "toast/show", toast: { message: l.s("account-shell-text-graph-uses-advanced-features"), hideAfter: 0, learnMoreCallback: function () { e.dispatch({ type: "show-modal", modal: "account-settings", initialTab: "advanced", device: e.defaultModalDevice }) } } }) }), this.lastIsShowingActionsUI = o)) } }, e }(); e.Controller = g });
define('main/globalhotkeys', ["require", "exports", "browser", "keys", "jquery", "lib/aria"], function (require, e, t, o, n, r) { "use strict"; Object.defineProperty(e, "__esModule", { value: !0 }); var i = 0, a = function () { function e(e, t, o) { this.__id = i++, this.controller = e, this.headerController = t, this.userController = t.userController, this.mygraphsController = t.mygraphsController, this.instanceHotkeys = o, this.startListening() } return e.prototype.remove = function () { this.stopListening() }, e.prototype.startListening = function () { var e = this; this.isListening || (n(document).on("keydown.dcg-global-keyboard-listener-" + this.__id, function (t) { return e.handleGlobalKeydown(t) }), this.isListening = !0) }, e.prototype.stopListening = function () { this.isListening && (n(document).off("keydown.dcg-global-keyboard-listener-" + this.__id), this.isListening = !1) }, e.prototype.handleGlobalKeydown = function (e) { var t = !1; if (o.isUndo(e) || o.isRedo(e)) { var r = this.controller.getRootElt(); (!r || document.activeElement && document.activeElement != document.body && !n(document.activeElement).closest(r).length) && (t = !0) } else if (e.ctrlKey || e.altKey || e.metaKey || e.shiftKey || o.lookup(e) !== o.ESCAPE) { if (o.isHelp(e)) e.preventDefault(), e.stopPropagation(), t = !0, this.headerController.dispatch({ type: "show-modal", modal: "hotkeys", device: "keyboard" }); else if (e.ctrlKey && (e.altKey || e.metaKey) && !e.shiftKey) if ("A" === o.lookupChar(e)) if (e.preventDefault(), e.stopPropagation(), t = !0, this.userController.isLoggedIn()) this.focusElement(n(document).find(".dcg-header .dcg-account-link"), this.controller.s("graphing-calculator-narration-unable-to-activate-account-menu")); else { var i = n(document).find(".dcg-sign-in"); this.triggerKeyboardTapEvent(i) } else "L" === o.lookupChar(e) ? (e.preventDefault(), e.stopPropagation(), t = !0, this.focusElement(n(document).find(".dcg-action-language"), this.controller.s("graphing-calculator-narration-unable-to-activate-language-menu"))) : "H" === o.lookupChar(e) ? (e.preventDefault(), e.stopPropagation(), t = !0, this.focusElement(n(document).find(".dcg-action-help"), this.controller.s("graphing-calculator-narration-unable-to-activate-help-menu"))) : "S" === o.lookupChar(e) && (e.preventDefault(), e.stopPropagation(), t = !0, this.focusElement(n(document).find(".dcg-action-share"), this.controller.s("graphing-calculator-narration-unable-to-activate-share-menu"))) } else t = this.handleEscape(e); t || this.instanceHotkeys.handleKeydown(e) }, e.prototype.handleEscape = function (e) { var o = !1, r = "none" !== this.headerController.getModalState().modal, i = "none" !== this.headerController.getOpenMenu(), a = !!n(".graph-preview").length, l = this.mygraphsController.isMygraphsOpen(), s = !1; if (r ? (this.headerController.dispatch({ type: "close-modal" }), s = !0) : i ? (this.headerController.dispatch({ type: "toggle-menu", payload: "none" }), s = !0) : a ? (this.triggerKeyboardTapEvent(n(".dcg-action-close-resources:visible")), s = !0) : l && (this.headerController.dispatch({ type: "close-mygraphs" }), s = !0), s) { if (!t.IS_MOBILE) if (a || r && l) r && l && n(".new-blank-graph").trigger("focus"); else { var c = this.controller.getSelectedItem(); if (c) this.controller.dispatch({ type: "move-focus-to-item", id: c.id }); else { var h = this.controller.getItemModelByIndex(0); h && this.controller.dispatch({ type: "move-focus-to-item", id: h.id }) } } e.preventDefault(), e.stopPropagation(), o = !0 } return o }, e.prototype.triggerKeyboardTapEvent = function (e) { var t = n.Event("dcg-tap"); t.device = "keyboard", e.trigger(t) }, e.prototype.focusElement = function (e, t) { e.length ? this.triggerKeyboardTapEvent(e) : t && r.alert(t) }, e }(); e.default = a });

define('loadcss!main', function () { });
define('main/instantiate-top-level-components', ['require', 'config', 'underscore', 'main/user_controller', 'main/graphs_controller', 'main/language_controller', 'main/mygraphs_controller', 'tours/tour_controller', 'calculator-shell/controller', 'main/globalhotkeys', 'browser', 'ipad.scrollfix', 'loadcss!main', 'api/calculator'], function (require) { "use strict"; var e = require("config"), r = require("underscore"), o = require("main/user_controller").UserController, a = require("main/graphs_controller").GraphsController, t = require("main/language_controller").default, n = require("main/mygraphs_controller"), l = require("tours/tour_controller"), s = require("calculator-shell/controller").Controller, c = require("main/globalhotkeys").default, i = require("browser"), h = require("ipad.scrollfix"); require("loadcss!main"); var d = require("api/calculator"); return function (g) { var p = e.all(), u = JSON.parse(g.exampleGraphsRaw); p.disableScrollFix || h.limitScrollOnDocument(), p.redrawSlowly = !i.IS_MOBILE, p.border = !1, p.disableScrollFix = !0, p.showHamburger = !0, g.calcOptions && (p = r.extend(p, g.calcOptions)); var v = document.getElementById("graph-container"), m = d.Calculator(v, p, g.onCalcReady), b = l(m); window.tourController = b; var w = new t(m), y = new o, C = w.s.bind(w), f = w.raw.bind(w), _ = w.unpack.bind(w), E = new a({ api: m, s: C, getLanguage: w.getLanguage.bind(w), examplesJSON: u, randomSeed: g.seed, product: "graphing" }); E.observeEvent("driveAccessError", function (e, r) { m._calc.controller.dispatch({ type: "toast/show", toast: { message: 'Error saving. <a href="' + r.authorizeUrl + '" target="_blank" class="dcg-action-hide">Click here</a> to re-authorize Desmos to save graphs to Google Drive.', toastStyle: "error", hideAfter: 0 } }) }); var S = n(E, m, C); E.observeEvent("onClearGraph", function () { m.focusFirstExpression() }), S.observeEvent("toast", function (e, r) { var o = { message: r.message }; for (var a in r.opts) r.opts.hasOwnProperty(a) && (o[a] = r.opts[a]); m._calc.controller.dispatch({ type: "toast/show", toast: o }) }), E.observeEvent("toast", function (e, r) { var o = { message: r.message }; for (var a in r.opts) r.opts.hasOwnProperty(a) && (o[a] = r.opts[a]); m._calc.controller.dispatch({ type: "toast/show", toast: o }) }), E.observeEvent("clearUnsavedChanges", function () { m._calc.controller.dispatch({ type: "clear-unsaved-changes" }) }), E.observeEvent("clearUndoRedo", function () { m._calc.controller.dispatch({ type: "clear-undoredo-history" }) }); var k, G = !1; m._calc.controller.subToChanges(function () { var e = m._calc.controller.hasUnsavedChanges(); e !== G && x.triggerRender(), G = e }), m.hasUnsavedChanges = function () { return m._calc.controller.hasUnsavedChanges() }, m.controller.triggerEasterEgg = function (e) { var r = "betchacant" === e ? m.controller.s("account-shell-label-betchacant-loading") : m.controller.s("account-shell-label-loading"), o = E.getEasterEggGraphs(e); 0 !== o.length && (k = Math.floor(Math.random() * o.length), m.controller.dispatch({ type: "toast/show", toast: { message: r, hideAfter: 0, toastStyle: "cover" } }), E.loadGraphImmediately(o[k]).done(function () { S.openGraphBehindCover(o[k]) })) }, !1 !== e.get("expressions") && (m.controller.triggerClearGraph = function () { E.clearGraphByUserAction() }, m.observeEvent("openDrawer", function () { x.dispatch({ type: "open-mygraphs" }) })); var x = new s({ userController: y, graphsController: E, tourController: b, languageController: w, mygraphsController: S, api: m, s: C, raw: f, unpack: _, getLanguage: w.getLanguage.bind(w), product: "graphing" }); return m._calc.globalHotkeys = new c(m._calc.controller, x, m._calc.instanceHotkeys), m._calc.controller.setCanShowKeyboardShortcuts(!0), m.observeEvent("showHotkeysModal", function () { x.dispatch({ type: "show-modal", modal: "hotkeys", device: "keyboard" }) }), window.userController = y, window.headerController = x, { Calc: m, userController: y, graphsController: E, tourController: b, headerController: x } } });
define('main/calc_desktop', ['require', 'jquery', 'browser', 'main/load_data', 'config', 'loadcss!print', 'lib/i18n', 'main/graph', 'text!example_graphs', 'api/calculator', 'main/external-login-popup', 'analytics/looker', 'analytics/usage-monitor', 'dcgview', 'calculator-shell/wrapper', 'calculator-shell/modals', 'mygraphs/wrapper', 'main/async_load_state', 'main/disable-dragdrop-events', 'vendor/bugsnag', 'bugsnag', './instantiate-top-level-components'], function (require) { "use strict"; var e = require("jquery"), a = require("browser"), t = require("main/load_data"), r = require("config"); require("loadcss!print"); var o = require("lib/i18n"), n = require("main/graph"), s = require("text!example_graphs"), l = require("api/calculator"), i = require("main/external-login-popup"), c = require("analytics/looker").logPageLoad, u = require("analytics/usage-monitor").default, d = require("dcgview"), p = require("calculator-shell/wrapper").ViewWrapper, g = require("calculator-shell/modals").Modals, h = require("mygraphs/wrapper").MygraphsWrapper, m = require("main/async_load_state").asyncLoadStateAtStartup, f = require("main/disable-dragdrop-events").default, w = require("vendor/bugsnag"), y = require("bugsnag"); function v(w) { var v = require("./instantiate-top-level-components")({ seed: t.seed, modalContainer: "body", exampleGraphsRaw: s, calcOptions: { pasteGraphLink: !0 } }), C = v.Calc, x = C._calc.controller; x.setBugsnagContext("main-controller"), C.updateSettings({ language: w }); var k = v.userController, F = v.graphsController, S = v.tourController, I = v.headerController; function b(e, a) { return x.s(e, a) } y.setBeforeSendCB(function (e) { var a = x.stateStack; a && a.serializeForBugsnag && (e.metaData.states = a.serializeForBugsnag()) }); var U = new u({ calcController: x, graphsController: F }); (U.trackFeatureUsage("graph-feature", "hasSlider"), U.trackFeatureUsage("graph-feature", "hasRegression"), U.trackFeatureUsage("graph-feature", "hasAction"), U.trackFeatureUsage("graph-feature", "expressionErrors"), U.trackFeatureUsage("graph-feature", "expressionCount"), U.trackFeatureUsage("graph-feature", "folderCount"), U.trackFeatureUsage("graph-feature", "imageCount"), U.trackFeatureUsage("graph-feature", "tableCount"), U.trackFeatureUsage("graph-feature", "textCount"), U.start(), i.listenForLoginRequests(k, b), r.get("no_navigation_warning") || e(window).on("beforeunload", function () { if (C.hasUnsavedChanges()) return b("account-shell-text-confirm-leave") }), t.user && k.completeLogin(t.user, "load"), t.graph || (F.clearGraph(), t.latex && C.setExpression({ latex: t.latex })), c({ userId: k.getUserId(), desmosLang: w }), S.startTourFromUrl(), k.getEmailChangeToken() && I.dispatch({ type: "show-modal", modal: "change-email", device: "mouse" }), I.triggerRender = function () { C.viewWrapper && C.viewWrapper.update(), C.modalsView && C.modalsView.update(), C.myGraphsWrapper && C.myGraphsWrapper.update(), k.getEmailChangeToken() && "change-email" !== I.getOpenModal() && history.replaceState(null, null, document.location.pathname) }, C.viewWrapper = d.mountToNode(p, document.getElementById("dcg-header-container"), { controller: function () { return I } }), C.modalsView = d.mountToNode(g, document.getElementById("dcg-modal-container"), { controller: function () { return I } }), C.myGraphsWrapper = d.mountToNode(h, document.getElementById("mygraphs-container"), { controller: d.const(I), makeAPI: function (e) { return new l.Calculator(e, { settingsMenu: !1, keypad: !1, zoomButtons: !1, branding: !1, border: !1, disableScrollFix: !0, expressions: !1 }) } }), !a.IS_ANDROID || a.IS_CHROME || a.IS_FIREFOX || I.dispatch({ type: "show-modal", modal: "unsupported-browser" }), document.location.search.match(/(\?|\&)create_account/) ? (history.replaceState(null, null, document.location.pathname), k.isLoggedIn() ? x.dispatch({ type: "toast/show", toast: { message: b("account-shell-text-logged-in") } }) : I.dispatch({ type: "show-modal", modal: "signup", device: "mouse" })) : document.location.search.match(/(\?|\&)login/) ? (history.replaceState(null, null, document.location.pathname), k.isLoggedIn() ? x.dispatch({ type: "toast/show", toast: { message: b("account-shell-text-logged-in") } }) : I.dispatch({ type: "show-modal", modal: "login" })) : document.location.search.match(/(\?|\&)reset_password/) && (history.replaceState(null, null, document.location.pathname), I.dispatch({ type: "show-modal", modal: "recover-password" })), window.matchMedia) && window.matchMedia("print").addListener(function (e) { e.matches ? x.dispatch({ type: "enter-printmode" }) : x.dispatch({ type: "exit-printmode" }) }); return f(e(document)), m(t.graph, o.s).then(function (e) { return e && e.state && F.loadGraph(n.fromAjax(e)), C }) } r.get("testing") || y.init(w); var C = o.detectLanguage(); return o.fetchLanguage(C).then(function () { return v(C) }, function () { return v("en") }) });
define('main/noconflict', ['require', 'jquery', 'underscore'], function (require) { "use strict"; var e = require("jquery"), s = require("underscore"); return "undefined" == typeof Desmos && (Desmos = {}), function () { Desmos.$ = e, Desmos._ = s, Desmos.$.noConflict(!0) } });
define("toplevel/calculator_desktop", ['require', 'testbridge', 'touchtracking', 'main/calc_desktop', 'main/noconflict'], function (require) { "use strict"; require("testbridge"), require("touchtracking").monitor(document.body); var t = require("main/calc_desktop"); return require("main/noconflict")(), t });
